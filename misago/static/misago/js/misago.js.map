{"version":3,"file":"misago.js","mappings":"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","sources":["webpack://misago/webpack/runtime/chunk loaded","webpack://misago/webpack/runtime/load script","webpack://misago/./src/components/reset-password-form.js","webpack://misago/./src/initializers/components/reset-password-form.js","webpack://misago/./src/components/form.js","webpack://misago/./src/services/auth.js","webpack://misago/./src/components/SignInModalAutoOpen.js","webpack://misago/./src/components/Navbar/NavbarBranding.jsx","webpack://misago/./src/components/Navbar/NavbarExtraMenu.jsx","webpack://misago/./src/components/NotificationsDropdown/NotificationsDropdownBody.jsx","webpack://misago/./src/components/NotificationsDropdown/index.js","webpack://misago/./src/components/NotificationsDropdown/NotificationsDropdown.jsx","webpack://misago/./src/components/Navbar/NavbarNotificationsToggle.jsx","webpack://misago/./src/components/Navbar/NavbarNotificationsDropdown.jsx","webpack://misago/./src/components/Navbar/NavbarPrivateThreads.jsx","webpack://misago/./src/components/Navbar/NavbarSearchToggle.jsx","webpack://misago/./src/components/Navbar/NavbarSearchDropdown.jsx","webpack://misago/./src/components/Navbar/NavbarSiteNavToggle.jsx","webpack://misago/./src/components/Navbar/NavbarSiteNavDropdown.jsx","webpack://misago/./src/components/Navbar/NavbarUserNavToggle.jsx","webpack://misago/./src/components/Navbar/NavbarUserNavDropdown.jsx","webpack://misago/./src/components/Navbar/Navbar.jsx","webpack://misago/./src/components/Navbar/index.js","webpack://misago/./src/initializers/components/navbar.js","webpack://misago/./src/components/search/SearchResultsList.jsx","webpack://misago/./src/components/search/SearchMessage.jsx","webpack://misago/./src/components/search/SearchResultPost.jsx","webpack://misago/./src/components/search/SearchResultUser.jsx","webpack://misago/./src/components/search/SearchResults.jsx","webpack://misago/./src/components/search/SearchResultsEmpty.jsx","webpack://misago/./src/components/search/SearchResultsError.jsx","webpack://misago/./src/components/search/SearchResultsLoading.jsx","webpack://misago/./src/components/search/SearchFetch.jsx","webpack://misago/./src/components/search/SearchInput.jsx","webpack://misago/./src/components/search/SearchQuery.jsx","webpack://misago/./src/components/search/SearchDropdown.jsx","webpack://misago/./src/components/search/SearchOverlay.jsx","webpack://misago/./src/initializers/polls.js","webpack://misago/./src/components/Timestamp/Timestamp.jsx","webpack://misago/./src/components/Timestamp/index.js","webpack://misago/./src/components/PageHeader/PageHeader.jsx","webpack://misago/./src/components/PageHeader/PageHeaderBanner.jsx","webpack://misago/./src/components/PageHeader/PageHeaderContainer.jsx","webpack://misago/./src/components/PageHeader/PageHeaderDetails.jsx","webpack://misago/./src/components/PageHeader/PageHeaderPlain.jsx","webpack://misago/./src/initializers/auth.js","webpack://misago/./src/services/mobile-navbar-dropdown.js","webpack://misago/./src/initializers/mobile-navbar-dropdown.js","webpack://misago/./src/services/posting.js","webpack://misago/./src/initializers/reducers/snackbar.js","webpack://misago/./src/reducers/threads.js","webpack://misago/./src/initializers/reducers/threads.js","webpack://misago/./src/components/search-route/form.js","webpack://misago/./src/components/search-route/sidenav.js","webpack://misago/./src/components/search-route/page.js","webpack://misago/./src/components/search-route/threads/results.js","webpack://misago/./src/components/search-route/threads/index.js","webpack://misago/./src/components/search-route/users/index.js","webpack://misago/./src/components/search-route/index.js","webpack://misago/./src/initializers/components/search.js","webpack://misago/./src/initializers/reducers/tick.js","webpack://misago/./src/components/snackbar.js","webpack://misago/./src/initializers/components/snackbar.js","webpack://misago/./src/services/local-storage.js","webpack://misago/./src/utils/file-size.js","webpack://misago/./src/scrollTo.js","webpack://misago/./src/utils/getRandomString.js","webpack://misago/./src/initializers/reducers/auth.js","webpack://misago/./src/initializers/captcha.js","webpack://misago/./src/utils/escape-html.js","webpack://misago/./src/components/request-activation-link.js","webpack://misago/./src/initializers/components/request-activation-link.js","webpack://misago/./src/components/FlexRow/FlexRow.jsx","webpack://misago/./src/components/FlexRow/FlexRowCol.jsx","webpack://misago/./src/components/FlexRow/FlexRowSection.jsx","webpack://misago/./src/services/polls.js","webpack://misago/./src/reducers/overlay.js","webpack://misago/./src/services/zxcvbn.js","webpack://misago/./src/components/sign-in.js","webpack://misago/./src/initializers/store.js","webpack://misago/./src/initializers/zxcvbn.js","webpack://misago/./src/components/Dropdown/Dropdown.jsx","webpack://misago/./src/components/Dropdown/DropdownDivider.jsx","webpack://misago/./src/components/Dropdown/DropdownFooter.jsx","webpack://misago/./src/components/Dropdown/DropdownHeader.jsx","webpack://misago/./src/components/Dropdown/DropdownMenuItem.jsx","webpack://misago/./src/components/Dropdown/DropdownPills.jsx","webpack://misago/./src/components/Dropdown/DropdownSubheader.jsx","webpack://misago/./src/components/users/UsersNav.js","webpack://misago/./src/components/users/active-posters/list-empty.js","webpack://misago/./src/components/users/active-posters/list-item-preview.js","webpack://misago/./src/components/users/active-posters/list-preview.js","webpack://misago/./src/components/users/active-posters/list-item.js","webpack://misago/./src/components/users/active-posters/list-ready.js","webpack://misago/./src/components/users/active-posters/root.js","webpack://misago/./src/components/page-lead.js","webpack://misago/./src/utils/string-count.js","webpack://misago/./src/components/users/rank/RankUsersList.js","webpack://misago/./src/components/users/rank/RankUsersListLoader.js","webpack://misago/./src/components/users/rank/RankUsersLeft.jsx","webpack://misago/./src/components/users/rank/RankUsersPagination.jsx","webpack://misago/./src/components/users/rank/RankUsersToolbar.jsx","webpack://misago/./src/components/users/rank/root.js","webpack://misago/./src/components/users/root.js","webpack://misago/./src/initializers/components/users.js","webpack://misago/./src/initializers/reducers/overlay.js","webpack://misago/./src/components/modal-loader.js","webpack://misago/./src/components/loader.js","webpack://misago/./src/utils/batch.js","webpack://misago/./src/reducers/thread.js","webpack://misago/./src/services/snackbar.js","webpack://misago/./src/components/avatar.js","webpack://misago/./src/initializers/reducers/participants.js","webpack://misago/./src/reducers/search.js","webpack://misago/./src/utils/random.js","webpack://misago/./src/components/modal-message.js","webpack://misago/./src/components/posting/PostingQuoteSelection.jsx","webpack://misago/./src/components/posting/getQuoteMarkup.js","webpack://misago/./src/components/posting/globalState.js","webpack://misago/./src/components/posting/utils/attachments.js","webpack://misago/./src/components/MarkupEditor/MarkupAttachmentModal.jsx","webpack://misago/./src/components/MarkupEditor/operations.js","webpack://misago/./src/components/MarkupEditor/MarkupEditorAttachment.jsx","webpack://misago/./src/components/MarkupEditor/MarkupEditorAttachments.jsx","webpack://misago/./src/components/MarkupEditor/MarkupEditorFooter.jsx","webpack://misago/./src/components/MarkupEditor/MarkupCodeModal.jsx","webpack://misago/./src/components/MarkupEditor/MarkupFormattingHelpModal.jsx","webpack://misago/./src/components/MarkupEditor/isUrl.js","webpack://misago/./src/components/MarkupEditor/MarkupImageModal.jsx","webpack://misago/./src/components/MarkupEditor/MarkupLinkModal.jsx","webpack://misago/./src/components/MarkupEditor/MarkupQuoteModal.jsx","webpack://misago/./src/components/MarkupEditor/MarkupEditorButton.jsx","webpack://misago/./src/components/MarkupEditor/uploadFile.js","webpack://misago/./src/components/MarkupEditor/MarkupEditorToolbar.jsx","webpack://misago/./src/components/MarkupEditor/MarkupEditor.jsx","webpack://misago/./src/components/MarkupEditor/index.js","webpack://misago/./src/components/posting/PostingDialog.jsx","webpack://misago/./src/components/posting/PostingDialogBody.jsx","webpack://misago/./src/components/posting/PostingDialogError.jsx","webpack://misago/./src/components/posting/PostingDialogHeader.jsx","webpack://misago/./src/components/posting/PostingThreadOptions.jsx","webpack://misago/./src/components/posting/start.js","webpack://misago/./src/components/posting/utils/usernames.js","webpack://misago/./src/components/posting/start-private.js","webpack://misago/./src/components/posting/reply.js","webpack://misago/./src/components/posting/edit.js","webpack://misago/./src/components/posting/index.js","webpack://misago/./src/services/one-box.js","webpack://misago/./src/components/misago-markup.js","webpack://misago/./node_modules/moment/locale/ sync ^\\.\\/.*$","webpack://misago/./src/initializers/components/search-overlay.js","webpack://misago/./src/services/captcha.js","webpack://misago/./src/reducers/username-history.js","webpack://misago/./src/focusOn.js","webpack://misago/./src/components/button.js","webpack://misago/./src/reducers/selection.js","webpack://misago/./src/utils/sets.js","webpack://misago/./src/initializers/reducers/selection.js","webpack://misago/./src/services/page-title.js","webpack://misago/./src/components/change-avatar/index.js","webpack://misago/./src/components/change-avatar/crop.js","webpack://misago/./src/components/change-avatar/upload.js","webpack://misago/./src/components/change-avatar/gallery.js","webpack://misago/./src/components/change-avatar/root.js","webpack://misago/./src/components/UserNav/logout.js","webpack://misago/./src/components/UserNav/UserNavMenu.jsx","webpack://misago/./src/components/UserNav/UserNavDropdown.jsx","webpack://misago/./src/components/UserNav/UserNavOverlay.jsx","webpack://misago/./src/initializers/reducers/profile-hydrate.js","webpack://misago/./src/components/user-status.js","webpack://misago/./src/components/password-strength.js","webpack://misago/./src/components/register.js","webpack://misago/./src/components/RegisterButton/index.js","webpack://misago/./src/components/RegisterButton/RegisterButton.jsx","webpack://misago/./src/components/posting/utils/validators.js","webpack://misago/./src/initializers/components/site-nav-overlay.js","webpack://misago/./src/components/StartSocialAuth.js","webpack://misago/./src/components/PageContainer.jsx","webpack://misago/./src/components/users-list/card/stats.js","webpack://misago/./src/components/users-list/card/user-title.js","webpack://misago/./src/components/users-list/card/index.js","webpack://misago/./src/components/users-list/preview/card.js","webpack://misago/./src/components/users-list/preview/index.js","webpack://misago/./src/components/users-list/index.js","webpack://misago/./src/initializers/reducers/posts.js","webpack://misago/./src/reducers/posts.js","webpack://misago/./src/initializers/moment-locale.js","webpack://misago/./src/reducers/poll.js","webpack://misago/./src/initializers/tick-start.js","webpack://misago/./src/components/category-select.js","webpack://misago/./src/initializers/local-storage.js","webpack://misago/./src/services/store.js","webpack://misago/./src/initializers/ajax.js","webpack://misago/./src/initializers/reducers/username-history.js","webpack://misago/./src/components/panel-loader.js","webpack://misago/./src/components/profile/ban-details.js","webpack://misago/./src/components/edit-details/blankslate.js","webpack://misago/./src/components/edit-details/loader.js","webpack://misago/./src/components/edit-details/field-input.js","webpack://misago/./src/components/edit-details/fieldset.js","webpack://misago/./src/components/edit-details/form.js","webpack://misago/./src/components/edit-details/index.js","webpack://misago/./src/components/profile/details/form.js","webpack://misago/./src/components/profile/details/empty-message.js","webpack://misago/./src/components/profile/details/field-value.js","webpack://misago/./src/components/profile/details/field.js","webpack://misago/./src/components/profile/details/group.js","webpack://misago/./src/components/profile/details/groups-list.js","webpack://misago/./src/components/profile/details/header.js","webpack://misago/./src/data/profile-details.js","webpack://misago/./src/components/profile/details/index.js","webpack://misago/./src/components/profile/feed/route.js","webpack://misago/./src/components/quick-search.js","webpack://misago/./src/components/profile/followers.js","webpack://misago/./src/components/profile/follows.js","webpack://misago/./src/components/username-history/list-empty.js","webpack://misago/./src/components/username-history/change.js","webpack://misago/./src/components/username-history/list-ready.js","webpack://misago/./src/components/username-history/change-preview.js","webpack://misago/./src/components/username-history/list-preview.js","webpack://misago/./src/components/username-history/root.js","webpack://misago/./src/components/profile/username-history.js","webpack://misago/./src/components/profile/follow-button.js","webpack://misago/./src/components/profile/message-button.js","webpack://misago/./src/components/profile/moderation/avatar-controls.js","webpack://misago/./src/components/profile/moderation/change-username.js","webpack://misago/./src/components/profile/moderation/delete-account.js","webpack://misago/./src/components/profile/moderation/nav.js","webpack://misago/./src/components/profile/ProfileDataList.jsx","webpack://misago/./src/components/profile/ProfileHeader.jsx","webpack://misago/./src/components/profile/ProfileNav.js","webpack://misago/./src/components/profile/root.js","webpack://misago/./src/components/profile/feed/index.js","webpack://misago/./src/initializers/components/profile.js","webpack://misago/./src/components/NotificationsOverlay/NotificationsOverlayBody.jsx","webpack://misago/./src/components/NotificationsOverlay/NotificationsOverlay.jsx","webpack://misago/./src/components/NotificationsOverlay/index.js","webpack://misago/./src/initializers/components/notifications-overlay.js","webpack://misago/./src/initializers/posting.js","webpack://misago/./src/initializers/snackbar.js","webpack://misago/./src/components/NotificationsFetch/index.js","webpack://misago/./src/components/auth-message.js","webpack://misago/./src/initializers/components/auth-message.js","webpack://misago/./src/components/request-password-reset.js","webpack://misago/./src/initializers/components/request-password-reset.js","webpack://misago/./src/reducers/auth.js","webpack://misago/./src/initializers/components/user-nav-overlay.js","webpack://misago/./src/components/Overlay/Overlay.jsx","webpack://misago/./src/components/Overlay/OverlayHeader.jsx","webpack://misago/./src/components/Notifications/NotificationsHeader.jsx","webpack://misago/./src/components/PageTitle/index.js","webpack://misago/./src/components/PageTitle/PageTitle.jsx","webpack://misago/./src/components/PillsNav/PillsNav.jsx","webpack://misago/./src/components/PillsNav/PillsNavLink.jsx","webpack://misago/./src/components/Notifications/NotificationsPills.jsx","webpack://misago/./src/components/Notifications/NotificationsPagination.jsx","webpack://misago/./src/components/Notifications/NotificationsToolbar.jsx","webpack://misago/./src/components/Notifications/NotificationsRoute.jsx","webpack://misago/./src/components/Notifications/index.js","webpack://misago/./src/components/Notifications/Notifications.jsx","webpack://misago/./src/initializers/components/notifications.js","webpack://misago/./src/initializers/include.js","webpack://misago/./src/components/Api/ApiFetch.jsx","webpack://misago/./src/components/Api/ApiMutation.jsx","webpack://misago/./src/components/ListGroup/ListGroup.jsx","webpack://misago/./src/components/ListGroup/ListGroupItem.jsx","webpack://misago/./src/components/ListGroup/ListGroupEmpty.jsx","webpack://misago/./src/components/ListGroup/ListGroupError.jsx","webpack://misago/./src/components/ListGroup/ListGroupLoading.jsx","webpack://misago/./src/components/ListGroup/ListGroupMessage.jsx","webpack://misago/./src/initializers/reducers/users.js","webpack://misago/./src/components/SignInButton/index.js","webpack://misago/./src/components/SignInButton/SignInButton.jsx","webpack://misago/./src/initializers/reducers/profile.js","webpack://misago/./src/components/add-participant.js","webpack://misago/./src/components/participants/add-participant.js","webpack://misago/./src/components/participants/cards-list/make-owner.js","webpack://misago/./src/components/participants/cards-list/actions.js","webpack://misago/./src/components/participants/cards-list/remove.js","webpack://misago/./src/components/participants/cards-list/card.js","webpack://misago/./src/components/participants/cards-list/index.js","webpack://misago/./src/components/participants/index.js","webpack://misago/./src/components/participants/utils.js","webpack://misago/./src/components/poll/results/chart.js","webpack://misago/./src/components/poll/results/modal.js","webpack://misago/./src/components/poll/results/options.js","webpack://misago/./src/components/poll/info.js","webpack://misago/./src/components/poll/results/index.js","webpack://misago/./src/components/poll/voting/help.js","webpack://misago/./src/components/poll/voting/select.js","webpack://misago/./src/components/poll/voting/utils.js","webpack://misago/./src/components/poll/voting/index.js","webpack://misago/./src/components/poll/poll.js","webpack://misago/./src/components/poll/form/choices-control.js","webpack://misago/./src/components/poll/form/index.js","webpack://misago/./src/components/posts-list/event/icon.js","webpack://misago/./src/components/posts-list/event/controls.js","webpack://misago/./src/components/posts-list/event/info.js","webpack://misago/./src/components/posts-list/event/message.js","webpack://misago/./src/components/posts-list/event/unread-label.js","webpack://misago/./src/components/posts-list/waypoint.js","webpack://misago/./src/components/posts-list/event/index.js","webpack://misago/./src/components/posts-list/post/attachments/attachment.js","webpack://misago/./src/components/posts-list/post/attachments/index.js","webpack://misago/./src/components/posts-list/post/body.js","webpack://misago/./src/components/posts-list/post/flags.js","webpack://misago/./src/components/posts-list/post/controls/actions.js","webpack://misago/./src/components/post-likes.js","webpack://misago/./src/components/posts-list/post/footer.js","webpack://misago/./src/components/posts-list/post/controls/move.js","webpack://misago/./src/components/post-changelog/diff.js","webpack://misago/./src/components/post-changelog/footer.js","webpack://misago/./src/components/post-changelog/toolbar.js","webpack://misago/./src/components/post-changelog/index.js","webpack://misago/./src/components/post-changelog/utils.js","webpack://misago/./src/components/posts-list/post/controls/split.js","webpack://misago/./src/components/posts-list/post/controls/dropdown.js","webpack://misago/./src/components/posts-list/post/controls/index.js","webpack://misago/./src/components/posts-list/post/select.js","webpack://misago/./src/components/posts-list/post/header.js","webpack://misago/./src/components/posts-list/post/post-side/anonymous.js","webpack://misago/./src/components/posts-list/post/post-side/has-visible-title.js","webpack://misago/./src/components/posts-list/post/post-side/user-postcount.js","webpack://misago/./src/components/posts-list/post/post-side/user-status.js","webpack://misago/./src/components/posts-list/post/post-side/user-title.js","webpack://misago/./src/components/posts-list/post/post-side/registered.js","webpack://misago/./src/components/posts-list/post/post-side/index.js","webpack://misago/./src/components/posts-list/post/index.js","webpack://misago/./src/components/posts-list/post/preview.js","webpack://misago/./src/components/posts-list/index.js","webpack://misago/./src/components/ThreadFlags.jsx","webpack://misago/./src/components/ThreadReplies.jsx","webpack://misago/./src/components/ThreadStarterCard.jsx","webpack://misago/./src/components/thread/moderation/thread/ThreadChangeTitleModal.jsx","webpack://misago/./src/components/merge-conflict.js","webpack://misago/./src/components/thread/moderation/thread/merge.js","webpack://misago/./src/components/thread/moderation/thread/move.js","webpack://misago/./src/components/thread/moderation/thread/controls.js","webpack://misago/./src/components/thread/moderation/thread/index.js","webpack://misago/./src/components/thread/ThreadModeration.jsx","webpack://misago/./src/components/thread/ThreadWatchButton.jsx","webpack://misago/./src/components/Breadcrumbs/Breadcrumbs.jsx","webpack://misago/./src/components/Breadcrumbs/BreadcrumbsCategory.jsx","webpack://misago/./src/components/Breadcrumbs/BreadcrumbsRootCategory.jsx","webpack://misago/./src/components/thread/ThreadHeader/ThreadHeaderBreadcrumbs.jsx","webpack://misago/./src/components/thread/ThreadHeader/ThreadHeader.jsx","webpack://misago/./src/components/thread/ThreadHeader/index.js","webpack://misago/./src/components/thread/ThreadPaginator.jsx","webpack://misago/./src/components/thread/moderation/posts/errors-list.js","webpack://misago/./src/components/thread/moderation/posts/actions.js","webpack://misago/./src/components/thread/moderation/posts/move.js","webpack://misago/./src/components/thread/moderation/posts/split.js","webpack://misago/./src/components/thread/moderation/posts/dropdown.js","webpack://misago/./src/components/thread/ThreadPostsModeration.jsx","webpack://misago/./src/components/thread/ThreadReplyButton.jsx","webpack://misago/./src/components/thread/ThreadToolbarBottom.jsx","webpack://misago/./src/components/thread/ThreadToolbarThird.jsx","webpack://misago/./src/components/thread/ThreadPollButton.jsx","webpack://misago/./src/components/thread/ThreadShortcutsButton.jsx","webpack://misago/./src/components/thread/ThreadToolbarTop.jsx","webpack://misago/./src/components/thread/route.js","webpack://misago/./src/components/thread/root.js","webpack://misago/./src/initializers/components/thread.js","webpack://misago/./src/services/include.js","webpack://misago/./src/services/modal.js","webpack://misago/./src/reducers/tick.js","webpack://misago/./src/reducers/snackbar.js","webpack://misago/./src/initializers/reducers/search.js","webpack://misago/./src/components/yes-no-switch.js","webpack://misago/./src/utils/ordered-list.js","webpack://misago/./src/AjaxLoader.js","webpack://misago/./src/BulkModeration.js","webpack://misago/./src/Autocomplete/ControlShadow.js","webpack://misago/./src/Autocomplete/AnchorInput.js","webpack://misago/./src/Autocomplete/Autocomplete.js","webpack://misago/./src/Autocomplete/SelectUser.js","webpack://misago/./src/getHttpResponseErrorMessage.js","webpack://misago/./src/snackbars.js","webpack://misago/./src/Autocomplete/sources.js","webpack://misago/./src/animations.js","webpack://misago/./src/formValidators.js","webpack://misago/./src/htmxErrors.js","webpack://misago/./src/htmxExtensionLoaderTpl.js","webpack://misago/./src/timestamps.js","webpack://misago/./src/lightbox.js","webpack://misago/./src/Mention.js","webpack://misago/./src/csrf.js","webpack://misago/./src/renderTemplate.js","webpack://misago/./src/editor/uploader.js","webpack://misago/./src/getRandomString.js","webpack://misago/./src/editor/modals.js","webpack://misago/./src/editor/editor.js","webpack://misago/./src/editor/index.js","webpack://misago/./src/PollChoicesControl.js","webpack://misago/./src/pagination.js","webpack://misago/./src/Quote/QuoteCursorPosition.js","webpack://misago/./src/Quote/QuoteSelection.js","webpack://misago/./src/Quote/Ruleset.js","webpack://misago/./src/Quote/getQuotedCode.js","webpack://misago/./src/Quote/extractor.js","webpack://misago/./src/Quote/postprocess.js","webpack://misago/./src/Quote/escape.js","webpack://misago/./src/Quote/renderer.js","webpack://misago/./src/Quote/tether.js","webpack://misago/./src/Quote/index.js","webpack://misago/./src/Quote/Quote.js","webpack://misago/./src/richtext.js","webpack://misago/./src/TabGroups.js","webpack://misago/./src/UserMultipleChoice.js","webpack://misago/./src/index.js","webpack://misago/./src/components/banned-page.js","webpack://misago/./src/utils/banned-page.js","webpack://misago/./src/initializers/reducers/profile-details.js","webpack://misago/./src/initializers/reducers/poll.js","webpack://misago/./src/components/panel-message.js","webpack://misago/./src/formats.js","webpack://misago/./src/initializers/reducers/thread.js","webpack://misago/./src/initializers/components/banned-page.js","webpack://misago/./src/components/NotificationsFetch/NotificationsFetch.jsx","webpack://misago/./src/components/post-feed/post/body.js","webpack://misago/./src/components/post-feed/post/header.js","webpack://misago/./src/components/post-feed/post/post-side/button.js","webpack://misago/./src/components/post-feed/post/post-side/anonymous.js","webpack://misago/./src/components/post-feed/post/post-side/user-title.js","webpack://misago/./src/components/post-feed/post/post-side/registered.js","webpack://misago/./src/components/post-feed/post/post-side/index.js","webpack://misago/./src/components/post-feed/post/index.js","webpack://misago/./src/components/post-feed/preview.js","webpack://misago/./src/components/post-feed/index.js","webpack://misago/./src/reducers/profile-details.js","webpack://misago/./src/components/form-group.js","webpack://misago/./src/components/RegisterLegalFootnote.js","webpack://misago/./src/initializers/page-title.js","webpack://misago/./src/components/accept-agreement.js","webpack://misago/./src/initializers/components/accept-agreement.js","webpack://misago/./src/components/with-dropdown.js","webpack://misago/./src/components/select.js","webpack://misago/./src/utils/concat-unique.js","webpack://misago/./src/utils/routed-component.js","webpack://misago/./src/initializers/modal.js","webpack://misago/./src/reducers/participants.js","webpack://misago/./src/utils/validators.js","webpack://misago/./src/components/SiteNav/SiteNavMenu.jsx","webpack://misago/./src/components/SiteNav/SiteNavDropdown.jsx","webpack://misago/./src/components/SiteNav/SiteNavOverlay.jsx","webpack://misago/./src/initializers/auth-sync.js","webpack://misago/./src/services/ajax.js","webpack://misago/./src/components/li.js","webpack://misago/./src/utils/mount-component.js","webpack://misago/./src/reducers/post.js","webpack://misago/./src/components/NotificationsList/NotificationsListEmpty.jsx","webpack://misago/./src/components/NotificationsList/NotificationsListGroup.jsx","webpack://misago/./src/components/NotificationsList/NotificationsListItemActor.jsx","webpack://misago/./src/components/NotificationsList/NotificationsListItemMessage.jsx","webpack://misago/./src/components/NotificationsList/NotificationsListItemReadStatus.jsx","webpack://misago/./src/components/NotificationsList/NotificationsListItemTimestamp.jsx","webpack://misago/./src/components/NotificationsList/NotificationsListItem.jsx","webpack://misago/./src/components/NotificationsList/NotificationsList.jsx","webpack://misago/./src/components/NotificationsList/NotificationsListError.jsx","webpack://misago/./src/components/NotificationsList/NotificationsListLoading.jsx","webpack://misago/./src/reducers/profile.js","webpack://misago/./src/reducers/users.js","webpack://misago/./src/components/Toolbar/Toolbar.jsx","webpack://misago/./src/components/Toolbar/ToolbarItem.jsx","webpack://misago/./src/components/Toolbar/ToolbarSection.jsx","webpack://misago/./src/components/Toolbar/ToolbarSpacer.jsx","webpack://misago/./src/components/social-auth/header.js","webpack://misago/./src/components/social-auth/register.js","webpack://misago/./src/components/social-auth/complete.js","webpack://misago/./src/components/social-auth/index.js","webpack://misago/./src/initializers/components/social-auth.js","webpack://misago/webpack/bootstrap","webpack://misago/webpack/runtime/compat get default export","webpack://misago/webpack/runtime/define property getters","webpack://misago/webpack/runtime/ensure chunk","webpack://misago/webpack/runtime/get javascript chunk filename","webpack://misago/webpack/runtime/get mini-css chunk filename","webpack://misago/webpack/runtime/global","webpack://misago/webpack/runtime/harmony module decorator","webpack://misago/webpack/runtime/hasOwnProperty shorthand","webpack://misago/webpack/runtime/make namespace object","webpack://misago/webpack/runtime/node module decorator","webpack://misago/webpack/runtime/publicPath","webpack://misago/webpack/runtime/jsonp chunk loading","webpack://misago/webpack/startup"],"sourcesContent":["var deferred = [];\n__webpack_require__.O = (result, chunkIds, fn, priority) => {\n\tif(chunkIds) {\n\t\tpriority = priority || 0;\n\t\tfor(var i = deferred.length; i > 0 && deferred[i - 1][2] > priority; i--) deferred[i] = deferred[i - 1];\n\t\tdeferred[i] = [chunkIds, fn, priority];\n\t\treturn;\n\t}\n\tvar notFulfilled = Infinity;\n\tfor (var i = 0; i < deferred.length; i++) {\n\t\tvar [chunkIds, fn, priority] = deferred[i];\n\t\tvar fulfilled = true;\n\t\tfor (var j = 0; j < chunkIds.length; j++) {\n\t\t\tif ((priority & 1 === 0 || notFulfilled >= priority) && Object.keys(__webpack_require__.O).every((key) => (__webpack_require__.O[key](chunkIds[j])))) {\n\t\t\t\tchunkIds.splice(j--, 1);\n\t\t\t} else {\n\t\t\t\tfulfilled = false;\n\t\t\t\tif(priority < notFulfilled) notFulfilled = priority;\n\t\t\t}\n\t\t}\n\t\tif(fulfilled) {\n\t\t\tdeferred.splice(i--, 1)\n\t\t\tvar r = fn();\n\t\t\tif (r !== undefined) result = r;\n\t\t}\n\t}\n\treturn result;\n};","var inProgress = {};\nvar dataWebpackPrefix = \"misago:\";\n// loadScript function to load a script via script tag\n__webpack_require__.l = (url, done, key, chunkId) => {\n\tif(inProgress[url]) { inProgress[url].push(done); return; }\n\tvar script, needAttach;\n\tif(key !== undefined) {\n\t\tvar scripts = document.getElementsByTagName(\"script\");\n\t\tfor(var i = 0; i < scripts.length; i++) {\n\t\t\tvar s = scripts[i];\n\t\t\tif(s.getAttribute(\"src\") == url || s.getAttribute(\"data-webpack\") == dataWebpackPrefix + key) { script = s; break; }\n\t\t}\n\t}\n\tif(!script) {\n\t\tneedAttach = true;\n\t\tscript = document.createElement('script');\n\n\t\tscript.charset = 'utf-8';\n\t\tscript.timeout = 120;\n\t\tif (__webpack_require__.nc) {\n\t\t\tscript.setAttribute(\"nonce\", __webpack_require__.nc);\n\t\t}\n\t\tscript.setAttribute(\"data-webpack\", dataWebpackPrefix + key);\n\n\t\tscript.src = url;\n\t}\n\tinProgress[url] = [done];\n\tvar onScriptComplete = (prev, event) => {\n\t\t// avoid mem leaks in IE.\n\t\tscript.onerror = script.onload = null;\n\t\tclearTimeout(timeout);\n\t\tvar doneFns = inProgress[url];\n\t\tdelete inProgress[url];\n\t\tscript.parentNode && script.parentNode.removeChild(script);\n\t\tdoneFns && doneFns.forEach((fn) => (fn(event)));\n\t\tif(prev) return prev(event);\n\t}\n\tvar timeout = setTimeout(onScriptComplete.bind(null, undefined, { type: 'timeout', target: script }), 120000);\n\tscript.onerror = onScriptComplete.bind(null, script.onerror);\n\tscript.onload = onScriptComplete.bind(null, script.onload);\n\tneedAttach && document.head.appendChild(script);\n};","import React from \"react\"\nimport ReactDOM from \"react-dom\"\nimport misago from \"misago/index\"\nimport Button from \"misago/components/button\"\nimport Form from \"misago/components/form\"\nimport SignInModal from \"misago/components/sign-in.js\"\nimport ajax from \"misago/services/ajax\"\nimport auth from \"misago/services/auth\"\nimport modal from \"misago/services/modal\"\nimport snackbar from \"misago/services/snackbar\"\nimport showBannedPage from \"misago/utils/banned-page\"\n\nexport class ResetPasswordForm extends Form {\n  constructor(props) {\n    super(props)\n\n    this.state = {\n      isLoading: false,\n\n      password: \"\",\n    }\n  }\n\n  clean() {\n    if (this.state.password.trim().length) {\n      return true\n    } else {\n      snackbar.error(pgettext(\"password reset form\", \"Enter new password.\"))\n      return false\n    }\n  }\n\n  send() {\n    return ajax.post(misago.get(\"CHANGE_PASSWORD_API\"), {\n      password: this.state.password,\n    })\n  }\n\n  handleSuccess(apiResponse) {\n    this.props.callback(apiResponse)\n  }\n\n  handleError(rejection) {\n    if (rejection.status === 403 && rejection.ban) {\n      showBannedPage(rejection.ban)\n    } else {\n      snackbar.apiError(rejection)\n    }\n  }\n\n  render() {\n    return (\n      <div className=\"well well-form well-form-reset-password\">\n        <form onSubmit={this.handleSubmit}>\n          <div className=\"form-group\">\n            <div className=\"control-input\">\n              <input\n                type=\"password\"\n                className=\"form-control\"\n                placeholder={pgettext(\n                  \"password reset form field\",\n                  \"Enter new password\"\n                )}\n                disabled={this.state.isLoading}\n                onChange={this.bindInput(\"password\")}\n                value={this.state.password}\n              />\n            </div>\n          </div>\n\n          <Button\n            className=\"btn-primary btn-block\"\n            loading={this.state.isLoading}\n          >\n            {pgettext(\"password reset form btn\", \"Change password\")}\n          </Button>\n        </form>\n      </div>\n    )\n  }\n}\n\nexport class PasswordChangedPage extends React.Component {\n  getMessage() {\n    return interpolate(\n      pgettext(\n        \"password reset form\",\n        \"%(username)s, your password has been changed.\"\n      ),\n      {\n        username: this.props.user.username,\n      },\n      true\n    )\n  }\n\n  showSignIn() {\n    modal.show(SignInModal)\n  }\n\n  render() {\n    return (\n      <div className=\"page page-message page-message-success page-forgotten-password-changed\">\n        <div className=\"container\">\n          <div className=\"message-panel\">\n            <div className=\"message-icon\">\n              <span className=\"material-icon\">check</span>\n            </div>\n\n            <div className=\"message-body\">\n              <p className=\"lead\">{this.getMessage()}</p>\n              <p>\n                {pgettext(\n                  \"password reset form\",\n                  \"Sign in using new password to continue.\"\n                )}\n              </p>\n              <p>\n                <button\n                  type=\"button\"\n                  className=\"btn btn-primary\"\n                  onClick={this.showSignIn}\n                >\n                  {pgettext(\"password reset form btn\", \"Sign in\")}\n                </button>\n              </p>\n            </div>\n          </div>\n        </div>\n      </div>\n    )\n  }\n}\n\nexport default class extends React.Component {\n  complete = (apiResponse) => {\n    auth.softSignOut()\n\n    // nuke \"next\" field so we don't end\n    // coming back to error page after sign in\n    $('#hidden-login-form input[name=\"next\"]').remove()\n\n    ReactDOM.render(\n      <PasswordChangedPage user={apiResponse} />,\n      document.getElementById(\"page-mount\")\n    )\n  }\n\n  render() {\n    return <ResetPasswordForm callback={this.complete} />\n  }\n}\n","import misago from \"misago\"\nimport ResetPasswordForm from \"misago/components/reset-password-form\"\nimport mount from \"misago/utils/mount-component\"\n\nexport default function initializer() {\n  if (document.getElementById(\"reset-password-form-mount\")) {\n    mount(ResetPasswordForm, \"reset-password-form-mount\", false)\n  }\n}\n\nmisago.addInitializer({\n  name: \"component:reset-password-form\",\n  initializer: initializer,\n  after: \"store\",\n})\n","import React from \"react\"\nimport { required } from \"../utils/validators\"\nimport snackbar from \"../services/snackbar\"\n\nlet validateRequired = required()\n\nexport default class extends React.Component {\n  validate() {\n    let errors = {}\n    if (!this.state.validators) {\n      return errors\n    }\n\n    let validators = {\n      required: this.state.validators.required || this.state.validators,\n      optional: this.state.validators.optional || {},\n    }\n\n    let validatedFields = []\n\n    // add required fields to validation\n    for (let name in validators.required) {\n      if (\n        validators.required.hasOwnProperty(name) &&\n        validators.required[name]\n      ) {\n        validatedFields.push(name)\n      }\n    }\n\n    // add optional fields to validation\n    for (let name in validators.optional) {\n      if (\n        validators.optional.hasOwnProperty(name) &&\n        validators.optional[name]\n      ) {\n        validatedFields.push(name)\n      }\n    }\n\n    // validate fields values\n    for (let i in validatedFields) {\n      let name = validatedFields[i]\n      let fieldErrors = this.validateField(name, this.state[name])\n\n      if (fieldErrors === null) {\n        errors[name] = null\n      } else if (fieldErrors) {\n        errors[name] = fieldErrors\n      }\n    }\n\n    return errors\n  }\n\n  isValid() {\n    let errors = this.validate()\n    for (let field in errors) {\n      if (errors.hasOwnProperty(field)) {\n        if (errors[field] !== null) {\n          return false\n        }\n      }\n    }\n\n    return true\n  }\n\n  validateField(name, value) {\n    let errors = []\n    if (!this.state.validators) {\n      return errors\n    }\n\n    let validators = {\n      required: (this.state.validators.required || this.state.validators)[name],\n      optional: (this.state.validators.optional || {})[name],\n    }\n\n    let requiredError = validateRequired(value) || false\n\n    if (validators.required) {\n      if (requiredError) {\n        errors = [requiredError]\n      } else {\n        for (let i in validators.required) {\n          let validationError = validators.required[i](value)\n          if (validationError) {\n            errors.push(validationError)\n          }\n        }\n      }\n\n      return errors.length ? errors : null\n    } else if (requiredError === false && validators.optional) {\n      for (let i in validators.optional) {\n        let validationError = validators.optional[i](value)\n        if (validationError) {\n          errors.push(validationError)\n        }\n      }\n\n      return errors.length ? errors : null\n    }\n\n    return false // false === field wasn't validated\n  }\n\n  bindInput = (name) => {\n    return (event) => {\n      this.changeValue(name, event.target.value)\n    }\n  }\n\n  changeValue = (name, value) => {\n    let newState = {\n      [name]: value,\n    }\n\n    const formErrors = this.state.errors || {}\n    formErrors[name] = this.validateField(name, newState[name])\n    newState.errors = formErrors\n\n    this.setState(newState)\n  }\n\n  clean() {\n    return true\n  }\n\n  send() {\n    return null\n  }\n\n  handleSuccess(success) {\n    return\n  }\n\n  handleError(rejection) {\n    snackbar.apiError(rejection)\n  }\n\n  handleSubmit = (event) => {\n    // we don't reload page on submissions\n    if (event) {\n      event.preventDefault()\n    }\n\n    if (this.state.isLoading) {\n      return\n    }\n\n    if (this.clean()) {\n      this.setState({ isLoading: true })\n      let promise = this.send()\n\n      if (promise) {\n        promise.then(\n          (success) => {\n            this.setState({ isLoading: false })\n            this.handleSuccess(success)\n          },\n          (rejection) => {\n            this.setState({ isLoading: false })\n            this.handleError(rejection)\n          }\n        )\n      } else {\n        this.setState({ isLoading: false })\n      }\n    }\n  }\n}\n","import { signIn, signOut } from \"misago/reducers/auth\"\n\nexport class Auth {\n  init(store, local, modal) {\n    this._store = store\n    this._local = local\n    this._modal = modal\n\n    // tell other tabs what auth state is because we are most current with it\n    this.syncSession()\n\n    // listen for other tabs to tell us that state changed\n    this.watchState()\n  }\n\n  syncSession() {\n    const state = this._store.getState().auth\n    if (state.isAuthenticated) {\n      this._local.set(\"auth\", {\n        isAuthenticated: true,\n        username: state.user.username,\n      })\n    } else {\n      this._local.set(\"auth\", {\n        isAuthenticated: false,\n      })\n    }\n  }\n\n  watchState() {\n    const state = this._store.getState().auth\n    this._local.watch(\"auth\", (newState) => {\n      if (newState.isAuthenticated) {\n        this._store.dispatch(\n          signIn({\n            username: newState.username,\n          })\n        )\n      } else if (state.isAuthenticated) {\n        // check if we are authenticated in this tab\n        // because some browser plugins prune local store\n        // aggressively, forcing erroneous message to display here\n        // tracking bug #955\n        this._store.dispatch(signOut())\n      }\n    })\n    this._modal.hide()\n  }\n\n  signIn(user) {\n    this._store.dispatch(signIn(user))\n    this._local.set(\"auth\", {\n      isAuthenticated: true,\n      username: user.username,\n    })\n    this._modal.hide()\n  }\n\n  signOut() {\n    this._store.dispatch(signOut())\n    this._local.set(\"auth\", {\n      isAuthenticated: false,\n    })\n    this._modal.hide()\n  }\n\n  softSignOut() {\n    this._store.dispatch(signOut(true))\n    this._local.set(\"auth\", {\n      isAuthenticated: false,\n    })\n    this._modal.hide()\n  }\n}\n\nexport default new Auth()\n","import React from \"react\"\nimport modal from \"../services/modal\"\nimport SignInModal from \"./sign-in\"\n\nclass SignInModalAutoOpen extends React.Component {\n  componentDidMount() {\n    const query = window.document.location.search\n    if (query === \"?modal=login\") {\n      window.setTimeout(() => modal.show(<SignInModal />), 300)\n    }\n  }\n\n  render() {\n    return null\n  }\n}\n\nexport default SignInModalAutoOpen\n","import React from \"react\"\n\nexport default function NavbarBranding({ logo, logoXs, text, url }) {\n  if (logo) {\n    return (\n      <div className=\"navbar-branding\">\n        <a href={url} className=\"navbar-branding-logo\">\n          <img src={logo} alt={text} />\n        </a>\n      </div>\n    )\n  }\n\n  return (\n    <div className=\"navbar-branding\">\n      {!!logoXs && (\n        <a href={url} className=\"navbar-branding-logo-xs\">\n          <img src={logoXs} alt={text} />\n        </a>\n      )}\n      {!!text && (\n        <a href={url} className=\"navbar-branding-text\">\n          {text}\n        </a>\n      )}\n    </div>\n  )\n}\n","import React from \"react\"\n\nexport default function NavbarExtraMenu({ items }) {\n  return (\n    <ul className=\"navbar-extra-menu\" role=\"nav\">\n      {items.map((item, index) => (\n        <li key={index} className={item.className}>\n          <a\n            href={item.url}\n            target={item.targetBlank ? \"_blank\" : null}\n            rel={item.rel}\n          >\n            {item.title}\n          </a>\n        </li>\n      ))}\n    </ul>\n  )\n}\n","import classnames from \"classnames\"\nimport React from \"react\"\nimport { DropdownFooter, DropdownHeader, DropdownPills } from \"../Dropdown\"\n\nexport default function NotificationsDropdownBody({\n  children,\n  showAll,\n  showUnread,\n  unread,\n}) {\n  return (\n    <div className=\"notifications-dropdown-body\">\n      <DropdownHeader>\n        {pgettext(\"notifications title\", \"Notifications\")}\n      </DropdownHeader>\n      <DropdownPills>\n        <NotificationsDropdownBodyPill active={!unread} onClick={showAll}>\n          {pgettext(\"notifications dropdown\", \"All\")}\n        </NotificationsDropdownBodyPill>\n        <NotificationsDropdownBodyPill active={unread} onClick={showUnread}>\n          {pgettext(\"notifications dropdown\", \"Unread\")}\n        </NotificationsDropdownBodyPill>\n      </DropdownPills>\n      {children}\n      <DropdownFooter>\n        <a\n          className=\"btn btn-default btn-block\"\n          href={misago.get(\"NOTIFICATIONS_URL\")}\n        >\n          {pgettext(\"notifications\", \"See all notifications\")}\n        </a>\n      </DropdownFooter>\n    </div>\n  )\n}\n\nfunction NotificationsDropdownBodyPill({ active, children, onClick }) {\n  return (\n    <button\n      className={classnames(\"btn\", {\n        \"btn-primary\": active,\n        \"btn-default\": !active,\n      })}\n      type=\"button\"\n      onClick={onClick}\n    >\n      {children}\n    </button>\n  )\n}\n","import NotificationsDropdown from \"./NotificationsDropdown\"\n\nexport default NotificationsDropdown\n","import React from \"react\"\nimport NotificationsFetch from \"../NotificationsFetch\"\nimport {\n  NotificationsList,\n  NotificationsListError,\n  NotificationsListLoading,\n} from \"../NotificationsList\"\nimport NotificationsDropdownBody from \"./NotificationsDropdownBody\"\n\nexport default class NotificationsDropdown extends React.Component {\n  constructor(props) {\n    super(props)\n\n    this.state = {\n      unread: false,\n      url: \"\",\n    }\n  }\n\n  getApiUrl() {\n    let url = misago.get(\"NOTIFICATIONS_API\") + \"?limit=20\"\n    url += this.state.unread ? \"&filter=unread\" : \"\"\n    return url\n  }\n\n  render = () => (\n    <NotificationsDropdownBody\n      unread={this.state.unread}\n      showAll={() => this.setState({ unread: false })}\n      showUnread={() => this.setState({ unread: true })}\n    >\n      <NotificationsFetch\n        filter={this.state.unread ? \"unread\" : \"all\"}\n        disabled={!this.props.active}\n      >\n        {({ data, loading, error }) => {\n          if (loading) {\n            return <NotificationsListLoading />\n          }\n\n          if (error) {\n            return <NotificationsListError error={error} />\n          }\n\n          return (\n            <NotificationsList\n              filter={this.state.unread ? \"unread\" : \"all\"}\n              items={data ? data.results : []}\n            />\n          )\n        }}\n      </NotificationsFetch>\n    </NotificationsDropdownBody>\n  )\n}\n","import classnames from \"classnames\"\nimport React from \"react\"\n\nexport default function NavbarNotificationsToggle({\n  id,\n  className,\n  badge,\n  url,\n  active,\n  onClick,\n}) {\n  const title = !!badge\n    ? pgettext(\"navbar\", \"You have unread notifications!\")\n    : pgettext(\"navbar\", \"Open notifications\")\n\n  return (\n    <a\n      id={id}\n      className={classnames(\"btn btn-navbar-icon\", className, { active })}\n      href={url}\n      title={title}\n      onClick={onClick}\n    >\n      {!!badge && <span className=\"navbar-item-badge\">{badge}</span>}\n      <span className=\"material-icon\">\n        {!!badge ? \"notifications_active\" : \"notifications_none\"}\n      </span>\n    </a>\n  )\n}\n","import React from \"react\"\nimport { Dropdown } from \"../Dropdown\"\nimport NotificationsDropdown from \"../NotificationsDropdown\"\nimport NavbarNotificationsToggle from \"./NavbarNotificationsToggle\"\n\nexport default function NavbarNotificationsDropdown({\n  id,\n  className,\n  badge,\n  url,\n}) {\n  return (\n    <Dropdown\n      id={id}\n      toggle={({ isOpen, toggle }) => (\n        <NavbarNotificationsToggle\n          className={className}\n          active={isOpen}\n          badge={badge}\n          url={url}\n          onClick={(event) => {\n            event.preventDefault()\n            toggle()\n          }}\n        />\n      )}\n      menuClassName=\"notifications-dropdown\"\n      menuAlignRight\n    >\n      {({ isOpen }) => <NotificationsDropdown active={isOpen} />}\n    </Dropdown>\n  )\n}\n","import classnames from \"classnames\"\nimport React from \"react\"\n\nexport default function NavbarPrivateThreads({\n  id,\n  className,\n  badge,\n  url,\n  active,\n  onClick,\n}) {\n  const title = !!badge\n    ? pgettext(\"navbar\", \"You have unread private threads!\")\n    : pgettext(\"navbar\", \"Open private threads\")\n\n  return (\n    <a\n      id={id}\n      className={classnames(\"btn btn-navbar-icon\", className, { active })}\n      href={url}\n      title={title}\n      onClick={onClick}\n    >\n      {!!badge && <span className=\"navbar-item-badge\">{badge}</span>}\n      <span className=\"material-icon\">inbox</span>\n    </a>\n  )\n}\n","import classnames from \"classnames\"\nimport React from \"react\"\n\nexport default function NavbarSearchToggle({\n  id,\n  className,\n  url,\n  active,\n  onClick,\n}) {\n  return (\n    <a\n      id={id}\n      className={classnames(\"btn btn-navbar-icon\", className, { active })}\n      href={url}\n      title={pgettext(\"navbar\", \"Open search\")}\n      onClick={onClick}\n    >\n      <span className=\"material-icon\">search</span>\n    </a>\n  )\n}\n","import React from \"react\"\nimport { Dropdown } from \"../Dropdown\"\nimport { SearchDropdown } from \"../search\"\nimport NavbarSearchToggle from \"./NavbarSearchToggle\"\n\nexport default function NavbarSearchDropdown({ id, className, url }) {\n  return (\n    <Dropdown\n      id={id}\n      toggle={({ isOpen, toggle }) => (\n        <NavbarSearchToggle\n          className={className}\n          active={isOpen}\n          url={url}\n          onClick={(event) => {\n            event.preventDefault()\n            toggle()\n\n            window.setTimeout(() => {\n              document\n                .querySelector(\".search-dropdown .form-control-search\")\n                .focus()\n            }, 0)\n          }}\n        />\n      )}\n      menuClassName=\"search-dropdown\"\n      menuAlignRight\n    >\n      {() => <SearchDropdown />}\n    </Dropdown>\n  )\n}\n","import classnames from \"classnames\"\nimport React from \"react\"\n\nexport default function NavbarSiteNavToggle({\n  id,\n  className,\n  active,\n  onClick,\n}) {\n  return (\n    <button\n      id={id}\n      className={classnames(\"btn btn-navbar-icon\", className, { active })}\n      title={pgettext(\"navbar\", \"Open menu\")}\n      type=\"button\"\n      onClick={onClick}\n    >\n      <span className=\"material-icon\">menu</span>\n    </button>\n  )\n}\n","import React from \"react\"\nimport { Dropdown } from \"../Dropdown\"\nimport NavbarSiteNavToggle from \"./NavbarSiteNavToggle\"\nimport { SiteNavDropdown } from \"../SiteNav\"\n\nexport default function NavbarSiteNavDropdown({ id, className }) {\n  return (\n    <Dropdown\n      id={id}\n      toggle={({ isOpen, toggle }) => (\n        <NavbarSiteNavToggle\n          className={className}\n          active={isOpen}\n          onClick={toggle}\n        />\n      )}\n      menuClassName=\"site-nav-dropdown\"\n      menuAlignRight\n    >\n      {({ isOpen, close }) => <SiteNavDropdown close={close} />}\n    </Dropdown>\n  )\n}\n","import classnames from \"classnames\"\nimport React from \"react\"\nimport Avatar from \"../avatar\"\n\nexport default function NavbarUserNavToggle({\n  id,\n  className,\n  user,\n  active,\n  onClick,\n}) {\n  return (\n    <a\n      id={id}\n      className={classnames(\"btn-navbar-image\", className, { active })}\n      href={user.url}\n      title={pgettext(\"navbar\", \"Open your options\")}\n      onClick={onClick}\n    >\n      <Avatar user={user} size={34} />\n    </a>\n  )\n}\n","import React from \"react\"\nimport { Dropdown } from \"../Dropdown\"\nimport NavbarUserNavToggle from \"./NavbarUserNavToggle\"\nimport { UserNavDropdown } from \"../UserNav\"\n\nexport default function NavbarUserNavDropdown({ id, className, user }) {\n  return (\n    <Dropdown\n      id={id}\n      toggle={({ isOpen, toggle }) => (\n        <NavbarUserNavToggle\n          className={className}\n          active={isOpen}\n          user={user}\n          onClick={(event) => {\n            event.preventDefault()\n            toggle()\n          }}\n        />\n      )}\n      menuClassName=\"user-nav-dropdown\"\n      menuAlignRight\n    >\n      {({ isOpen, close }) => <UserNavDropdown close={close} />}\n    </Dropdown>\n  )\n}\n","import React from \"react\"\nimport { connect } from \"react-redux\"\nimport * as overlay from \"../../reducers/overlay\"\nimport RegisterButton from \"../RegisterButton\"\nimport SignInButton from \"../SignInButton\"\nimport SignInModalAutoOpen from \"../SignInModalAutoOpen\"\nimport NavbarBranding from \"./NavbarBranding\"\nimport NavbarExtraMenu from \"./NavbarExtraMenu\"\nimport NavbarNotificationsDropdown from \"./NavbarNotificationsDropdown\"\nimport NavbarNotificationsToggle from \"./NavbarNotificationsToggle\"\nimport NavbarPrivateThreads from \"./NavbarPrivateThreads\"\nimport NavbarSearchDropdown from \"./NavbarSearchDropdown\"\nimport NavbarSearchToggle from \"./NavbarSearchToggle\"\nimport NavbarSiteNavDropdown from \"./NavbarSiteNavDropdown\"\nimport NavbarSiteNavToggle from \"./NavbarSiteNavToggle\"\nimport NavbarUserNavDropdown from \"./NavbarUserNavDropdown\"\nimport NavbarUserNavToggle from \"./NavbarUserNavToggle\"\n\nexport function Navbar({\n  dispatch,\n  branding,\n  extraMenuItems,\n  authDelegated,\n  user,\n  searchUrl,\n  notificationsUrl,\n  privateThreadsUrl,\n  showSearch,\n  showPrivateThreads,\n}) {\n  return (\n    <div className=\"container navbar-container\">\n      <NavbarBranding {...branding} />\n      <div className=\"navbar-right\">\n        {extraMenuItems.length > 0 && (\n          <NavbarExtraMenu items={extraMenuItems} />\n        )}\n        {!!showSearch && (\n          <NavbarSearchDropdown id=\"navbar-search-dropdown\" url={searchUrl} />\n        )}\n        {!!showSearch && (\n          <NavbarSearchToggle\n            id=\"navbar-search-overlay\"\n            url={searchUrl}\n            onClick={(event) => {\n              dispatch(overlay.openSearch())\n              event.preventDefault()\n            }}\n          />\n        )}\n        <NavbarSiteNavDropdown id=\"navbar-site-nav-dropdown\" />\n        <NavbarSiteNavToggle\n          id=\"navbar-site-nav-overlay\"\n          onClick={() => {\n            dispatch(overlay.openSiteNav())\n          }}\n        />\n        {!!showPrivateThreads && (\n          <NavbarPrivateThreads\n            id=\"navbar-private-threads\"\n            badge={user.unreadPrivateThreads}\n            url={privateThreadsUrl}\n          />\n        )}\n        {!!user && (\n          <NavbarNotificationsDropdown\n            id=\"navbar-notifications-dropdown\"\n            badge={user.unreadNotifications}\n            url={notificationsUrl}\n          />\n        )}\n        {!!user && (\n          <NavbarNotificationsToggle\n            id=\"navbar-notifications-overlay\"\n            badge={user.unreadNotifications}\n            url={notificationsUrl}\n            onClick={(event) => {\n              dispatch(overlay.openNotifications())\n              event.preventDefault()\n            }}\n          />\n        )}\n        {!!user && (\n          <NavbarUserNavDropdown id=\"navbar-user-nav-dropdown\" user={user} />\n        )}\n        {!!user && (\n          <NavbarUserNavToggle\n            id=\"navbar-user-nav-overlay\"\n            user={user}\n            onClick={(event) => {\n              dispatch(overlay.openUserNav())\n              event.preventDefault()\n            }}\n          />\n        )}\n        {!user && <SignInButton className=\"btn-navbar-sign-in\" />}\n        {!user && !authDelegated && (\n          <RegisterButton className=\"btn-navbar-register\" />\n        )}\n        {!user && !authDelegated && <SignInModalAutoOpen />}\n      </div>\n    </div>\n  )\n}\n\nfunction select(state) {\n  const settings = misago.get(\"SETTINGS\")\n  const user = state.auth.user\n\n  return {\n    branding: {\n      logo: settings.logo,\n      logoXs: settings.logo_small,\n      text: settings.logo_text,\n      url: misago.get(\"MISAGO_PATH\"),\n    },\n    extraMenuItems: misago.get(\"extraMenuItems\"),\n\n    user: !user.id\n      ? null\n      : {\n          id: user.id,\n          username: user.username,\n          email: user.email,\n          avatars: user.avatars,\n          unreadNotifications: user.unreadNotifications,\n          unreadPrivateThreads: user.unread_private_threads,\n          url: user.url,\n        },\n\n    searchUrl: misago.get(\"SEARCH_URL\"),\n    notificationsUrl: misago.get(\"NOTIFICATIONS_URL\"),\n    privateThreadsUrl: misago.get(\"PRIVATE_THREADS_URL\"),\n\n    authDelegated: settings.enable_oauth2_client,\n    showSearch: !!user.acl.can_search,\n    showPrivateThreads: !!user && !!user.acl.can_use_private_threads,\n  }\n}\n\nconst NavbarConnected = connect(select)(Navbar)\n\nexport default NavbarConnected\n","import Navbar from \"./Navbar\"\n\nexport default Navbar\n","import React from \"react\"\nimport ReactDOM from \"react-dom\"\nimport { Provider } from \"react-redux\"\nimport Navbar from \"../../components/Navbar\"\nimport store from \"../../services/store\"\n\nexport default function initializer(context) {\n  const root = document.getElementById(\"misago-navbar\")\n  ReactDOM.render(\n    <Provider store={store.getStore()}>\n      <Navbar />\n    </Provider>,\n    root\n  )\n}\n\nmisago.addInitializer({\n  name: \"component:navbar\",\n  initializer: initializer,\n  after: \"store\",\n})\n","import React from \"react\"\nimport { ListGroup } from \"../ListGroup\"\n\nexport default function SearchResultsList({ children }) {\n  return <ListGroup className=\"search-results-list\">{children}</ListGroup>\n}\n","import React from \"react\"\nimport { ListGroupMessage } from \"../ListGroup\"\nimport SearchResultsList from \"./SearchResultsList\"\n\nexport default function SearchMessage() {\n  return (\n    <SearchResultsList>\n      <ListGroupMessage\n        message={pgettext(\n          \"search cta\",\n          \"Enter search query (at least 3 characters).\"\n        )}\n      />\n    </SearchResultsList>\n  )\n}\n","import React from \"react\"\nimport { ListGroupItem } from \"../ListGroup\"\nimport Timestamp from \"../Timestamp\"\n\nexport default function SearchResultPost({ post }) {\n  return (\n    <ListGroupItem className=\"search-result\">\n      <a href={post.url.index}>\n        <div className=\"search-result-card\">\n          <div className=\"search-result-name\">{post.thread.title}</div>\n          <div\n            className=\"search-result-summary\"\n            dangerouslySetInnerHTML={{ __html: post.headline || post.content }}\n          />\n          <ul className=\"search-result-details\">\n            <li>\n              <b>{post.category.name}</b>\n            </li>\n            <li>{post.poster ? post.poster.username : post.poster_name}</li>\n            <li>\n              <Timestamp datetime={post.posted_on} />\n            </li>\n          </ul>\n        </div>\n      </a>\n    </ListGroupItem>\n  )\n}\n","import React from \"react\"\nimport Avatar from \"../avatar\"\nimport { ListGroupItem } from \"../ListGroup\"\nimport Timestamp from \"../Timestamp\"\n\nexport default function SearchResultUser({ user }) {\n  const title = user.title || user.rank.title\n\n  return (\n    <ListGroupItem className=\"search-result\">\n      <a href={user.url}>\n        <Avatar user={user} size={32} />\n        <div className=\"search-result-card\">\n          <div className=\"search-result-name\">{user.username}</div>\n          <ul className=\"search-result-details\">\n            {!!title && (\n              <li>\n                <b>{title}</b>\n              </li>\n            )}\n            <li>{user.rank.name}</li>\n            <li>\n              <Timestamp datetime={user.joined_on} />\n            </li>\n          </ul>\n        </div>\n      </a>\n    </ListGroupItem>\n  )\n}\n","import React from \"react\"\nimport { ListGroupItem } from \"../ListGroup\"\nimport SearchResultsList from \"./SearchResultsList\"\nimport SearchResultPost from \"./SearchResultPost\"\nimport SearchResultUser from \"./SearchResultUser\"\n\nexport default function SearchResults({ query, results }) {\n  const threads = results[0]\n  const users = results[1]\n\n  const { count } = threads.results\n\n  return (\n    <SearchResultsList>\n      {users.results.results.map((user) => (\n        <SearchResultUser key={user.id} user={user} />\n      ))}\n      {threads.results.results.map((post) => (\n        <SearchResultPost key={post.id} post={post} />\n      ))}\n      {count > 0 && (\n        <ListGroupItem>\n          <a\n            href={threads.url + \"?q=\" + encodeURIComponent(query)}\n            className=\"btn btn-default btn-block\"\n          >\n            {npgettext(\n              \"search results list\",\n              \"See all %(count)s result.\",\n              \"See all %(count)s results.\",\n              threads.results.count\n            ).replace(\"%(count)s\", threads.results.count)}\n          </a>\n        </ListGroupItem>\n      )}\n    </SearchResultsList>\n  )\n}\n","import React from \"react\"\nimport { ListGroupEmpty } from \"../ListGroup\"\nimport SearchResultsList from \"./SearchResultsList\"\n\nexport default function SearchResultsEmpty() {\n  return (\n    <SearchResultsList>\n      <ListGroupEmpty\n        message={pgettext(\"search results\", \"The search returned no results.\")}\n      />\n    </SearchResultsList>\n  )\n}\n","import React from \"react\"\nimport { ListGroupError } from \"../ListGroup\"\nimport SearchResultsList from \"./SearchResultsList\"\n\nexport default function SearchResultsError({ error }) {\n  return (\n    <SearchResultsList>\n      <ListGroupError\n        message={pgettext(\n          \"search results\",\n          \"The search could not be completed.\"\n        )}\n        detail={errorDetail(error)}\n      />\n    </SearchResultsList>\n  )\n}\n\nfunction errorDetail(error) {\n  if (error.status === 0) {\n    return gettext(\n      \"Check your internet connection and try refreshing the site.\"\n    )\n  }\n\n  if (error.data && error.data.detail) {\n    return error.data.detail\n  }\n}\n","import React from \"react\"\nimport { ListGroupLoading } from \"../ListGroup\"\nimport SearchResultsList from \"./SearchResultsList\"\n\nexport default function SearchResultsLoading() {\n  return (\n    <SearchResultsList>\n      <ListGroupLoading message={pgettext(\"search results\", \"Searching...\")} />\n    </SearchResultsList>\n  )\n}\n","import React from \"react\"\nimport { ApiFetch } from \"../Api\"\nimport SearchMessage from \"./SearchMessage\"\nimport SearchResults from \"./SearchResults\"\nimport SearchResultsEmpty from \"./SearchResultsEmpty\"\nimport SearchResultsError from \"./SearchResultsError\"\nimport SearchResultsLoading from \"./SearchResultsLoading\"\n\nconst DEBOUNCE = 750\nconst CACHE = {}\n\nexport default class SearchFetch extends React.Component {\n  constructor(props) {\n    super(props)\n\n    this.state = {\n      query: this.props.query.trim(),\n    }\n\n    this.debounce = null\n  }\n\n  componentDidUpdate() {\n    const query = this.props.query.trim()\n\n    if (this.state.query != query) {\n      if (this.debounce) {\n        window.clearTimeout(this.debounce)\n      }\n\n      this.debounce = window.setTimeout(() => {\n        this.setState({ query })\n      }, DEBOUNCE)\n    }\n  }\n\n  componentWillUnmount() {\n    if (this.debounce) {\n      window.clearTimeout(this.debounce)\n    }\n  }\n\n  render() {\n    return (\n      <ApiFetch\n        url={getSearchUrl(this.state.query)}\n        cache={CACHE}\n        disabled={this.state.query.length < 3}\n      >\n        {({ data, loading, error }) => {\n          if (this.state.query.length < 3) {\n            return <SearchMessage />\n          }\n\n          if (loading) {\n            return <SearchResultsLoading />\n          }\n\n          if (error) {\n            return <SearchResultsError error={error} />\n          }\n\n          if (isResultEmpty(data)) {\n            return <SearchResultsEmpty />\n          }\n\n          if (data !== null) {\n            return <SearchResults query={this.state.query} results={data} />\n          }\n\n          return null\n        }}\n      </ApiFetch>\n    )\n  }\n}\n\nfunction getSearchUrl(query) {\n  return misago.get(\"SEARCH_API\") + \"?q=\" + encodeURIComponent(query)\n}\n\nfunction isResultEmpty(results) {\n  if (results === null) {\n    return true\n  }\n\n  let resultsCount = 0\n  results.forEach((result) => {\n    resultsCount += result.results.count\n  })\n  return resultsCount === 0\n}\n","import React from \"react\"\n\nexport default function SearchInput({ query, setQuery }) {\n  return (\n    <div className=\"search-input\">\n      <input\n        className=\"form-control form-control-search\"\n        type=\"text\"\n        placeholder={pgettext(\"cta\", \"Search\")}\n        value={query}\n        onChange={(event) => setQuery(event.target.value)}\n      />\n    </div>\n  )\n}\n","import React from \"react\"\n\nexport default class SearchQuery extends React.Component {\n  constructor(props) {\n    super(props)\n\n    this.state = {\n      query: \"\",\n    }\n  }\n\n  setQuery = (query) => {\n    this.setState({ query })\n  }\n\n  render() {\n    return this.props.children({\n      query: this.state.query,\n      setQuery: this.setQuery,\n    })\n  }\n}\n","import React from \"react\"\nimport SearchFetch from \"./SearchFetch\"\nimport SearchInput from \"./SearchInput\"\nimport SearchQuery from \"./SearchQuery\"\n\nexport default function SearchDropdown() {\n  return (\n    <SearchQuery>\n      {({ query, setQuery }) => {\n        return (\n          <div className=\"search-dropdown-body\">\n            <SearchInput query={query} setQuery={setQuery} />\n            <SearchFetch query={query} />\n          </div>\n        )\n      }}\n    </SearchQuery>\n  )\n}\n","import React from \"react\"\nimport { connect } from \"react-redux\"\nimport { Overlay, OverlayHeader } from \"../Overlay\"\nimport SearchFetch from \"./SearchFetch\"\nimport SearchInput from \"./SearchInput\"\nimport SearchQuery from \"./SearchQuery\"\n\nfunction SearchOverlay({ open }) {\n  return (\n    <Overlay\n      open={open}\n      onOpen={() => {\n        window.setTimeout(() => {\n          document.querySelector(\"#search-mount .form-control-search\").focus()\n        }, 0)\n      }}\n    >\n      <OverlayHeader>{pgettext(\"cta\", \"Search\")}</OverlayHeader>\n      <SearchQuery>\n        {({ query, setQuery }) => {\n          return (\n            <div className=\"search-overlay-body\">\n              <SearchInput query={query} setQuery={setQuery} />\n              <div className=\"search-results-container\">\n                <SearchFetch query={query} />\n              </div>\n            </div>\n          )\n        }}\n      </SearchQuery>\n    </Overlay>\n  )\n}\n\nfunction select(state) {\n  return { open: state.overlay.search }\n}\n\nconst SearchOverlayConnected = connect(select)(SearchOverlay)\n\nexport default SearchOverlayConnected\n","import misago from \"misago/index\"\nimport ajax from \"misago/services/ajax\"\nimport snackbar from \"misago/services/snackbar\"\nimport polls from \"misago/services/polls\"\n\nexport default function initializer() {\n  polls.init(ajax, snackbar)\n}\n\nmisago.addInitializer({\n  name: \"polls\",\n  initializer: initializer,\n})\n","import React from \"react\"\nimport { dateRelative, dateRelativeShort, fullDateTime } from \"../../formats\"\n\nclass Timestamp extends React.Component {\n  constructor(props) {\n    super(props)\n\n    this.state = { tick: 0 }\n    this.date = new Date(props.datetime)\n    this.timeout = null\n  }\n\n  componentDidMount() {\n    this.scheduleNextUpdate()\n  }\n\n  componentWillUnmount() {\n    if (this.timeout) {\n      window.clearTimeout(this.timeout)\n    }\n  }\n\n  scheduleNextUpdate = () => {\n    const now = new Date()\n    const diff = Math.ceil(Math.abs(Math.round((this.date - now) / 1000)))\n\n    if (diff < 3600) {\n      this.timeout = window.setTimeout(\n        () => {\n          this.setState(tick)\n          this.scheduleNextUpdate()\n        },\n        50 * 1000 // Update every 50 seconds\n      )\n    } else if (diff < 3600 * 24) {\n      this.timeout = window.setTimeout(\n        () => {\n          this.setState(tick)\n        },\n        40 * 60 * 1000 // Update every 40 minutes\n      )\n    }\n  }\n\n  render() {\n    const displayed = this.props.narrow\n      ? dateRelativeShort(this.date)\n      : dateRelative(this.date)\n\n    return (\n      <attr\n        title={\n          this.props.title\n            ? this.props.title.replace(\n                \"%(timestamp)s\",\n                fullDateTime.format(this.date)\n              )\n            : fullDateTime.format(this.date)\n        }\n      >\n        {displayed}\n      </attr>\n    )\n  }\n}\n\nfunction tick(state) {\n  return { tick: state.tick + 1 }\n}\n\nexport default Timestamp\n","import Timestamp from \"./Timestamp\"\n\nexport default Timestamp\n","import classnames from \"classnames\"\nimport React from \"react\"\n\nconst PageHeader = ({ children, className, styleName }) => (\n  <div\n    className={classnames(\n      \"page-header\",\n      className,\n      styleName && \"page-header-\" + styleName\n    )}\n  >\n    <div className=\"page-header-bg-image\">\n      <div className=\"page-header-bg-overlay\">\n        <div className=\"page-header-image\" />\n        {children}\n      </div>\n    </div>\n  </div>\n)\n\nexport default PageHeader\n","import classnames from \"classnames\"\nimport React from \"react\"\n\nconst PageHeaderBanner = ({ children, className, styleName }) => (\n  <div\n    className={classnames(\n      \"page-header-banner\",\n      className,\n      styleName && \"page-header-banner-\" + styleName\n    )}\n  >\n    <div className=\"page-header-banner-bg-image\">\n      <div className=\"page-header-banner-bg-overlay\">{children}</div>\n    </div>\n  </div>\n)\n\nexport default PageHeaderBanner\n","import React from \"react\"\n\nconst PageHeaderContainer = ({ children }) => (\n  <div className=\"container page-header-container\">{children}</div>\n)\n\nexport default PageHeaderContainer\n","import classnames from \"classnames\"\nimport React from \"react\"\n\nconst PageHeaderDetails = ({ children, className }) => (\n  <div className={classnames(\"page-header-details\", className)}>{children}</div>\n)\n\nexport default PageHeaderDetails\n","import React from \"react\"\nimport PageHeader from \"./PageHeader\"\nimport PageHeaderBanner from \"./PageHeaderBanner\"\nimport PageHeaderContainer from \"./PageHeaderContainer\"\nimport PageHeaderDetails from \"./PageHeaderDetails\"\n\nconst PageHeaderPlain = ({ styleName, header, message }) => (\n  <PageHeaderContainer>\n    <PageHeader styleName={styleName}>\n      <PageHeaderBanner styleName={styleName}>\n        <h1>{header}</h1>\n      </PageHeaderBanner>\n      {message && (\n        <PageHeaderDetails styleName={styleName}>{message}</PageHeaderDetails>\n      )}\n    </PageHeader>\n  </PageHeaderContainer>\n)\n\nexport default PageHeaderPlain\n","import misago from \"misago/index\"\nimport auth from \"misago/services/auth\"\nimport modal from \"misago/services/modal\"\nimport store from \"misago/services/store\"\nimport storage from \"misago/services/local-storage\"\n\nexport default function initializer() {\n  auth.init(store, storage, modal)\n}\n\nmisago.addInitializer({\n  name: \"auth\",\n  initializer: initializer,\n  after: \"store\",\n})\n","import mount from \"misago/utils/mount-component\"\n\nexport class MobileNavbarDropdown {\n  init(element) {\n    this._element = element\n    this._component = null\n  }\n\n  show(component) {\n    if (this._component === component) {\n      this.hide()\n    } else {\n      this._component = component\n      mount(component, this._element.id)\n      $(this._element).addClass(\"open\")\n    }\n  }\n\n  showConnected(name, component) {\n    if (this._component === name) {\n      this.hide()\n    } else {\n      this._component = name\n      mount(component, this._element.id, true)\n      $(this._element).addClass(\"open\")\n    }\n  }\n\n  hide() {\n    $(this._element).removeClass(\"open\")\n    this._component = null\n  }\n}\n\nexport default new MobileNavbarDropdown()\n","import misago from \"misago/index\"\nimport dropdown from \"misago/services/mobile-navbar-dropdown\"\n\nexport default function initializer() {\n  let element = document.getElementById(\"mobile-navbar-dropdown-mount\")\n  if (element) {\n    dropdown.init(element)\n  }\n}\n\nmisago.addInitializer({\n  name: \"dropdown\",\n  initializer: initializer,\n  before: \"store\",\n})\n","import React from \"react\"\nimport ReactDOM from \"react-dom\"\nimport PostingComponent from \"misago/components/posting\"\nimport mount from \"misago/utils/mount-component\"\n\nexport class Posting {\n  init(ajax, snackbar, mount) {\n    this._ajax = ajax\n    this._snackbar = snackbar\n    this._mount = mount\n\n    this._mode = null\n    this._spacer = document.getElementById(\"posting-spacer\")\n    this._observer = new ResizeObserver((entries) => {\n      this._spacer.style.height = entries[0].contentRect.height + \"px\"\n    })\n\n    this._isOpen = false\n    this._isClosing = false\n\n    this._beforeunloadSet = false\n    this._props = null\n  }\n\n  isOpen() {\n    return this._isOpen\n  }\n\n  setBeforeUnload() {\n    if (!this._beforeunloadSet) {\n      window.addEventListener(\"beforeunload\", this.beforeUnload, {\n        capture: true,\n      })\n      this._beforeunloadSet = true\n    }\n  }\n\n  unsetBeforeUnload() {\n    window.removeEventListener(\"beforeunload\", this.beforeUnload, {\n      capture: true,\n    })\n    this._beforeunloadSet = false\n  }\n\n  beforeUnload(event) {\n    event.returnValue = \"true\"\n    return \"true\"\n  }\n\n  open(props) {\n    if (this._isOpen === false) {\n      if (props.mode === \"QUOTE\") {\n        this._mode = \"REPLY\"\n      } else {\n        this._mode = props.mode\n      }\n\n      this._isOpen = props.submit\n      this._realOpen(Object.assign({}, props, { mode: this._mode }))\n    } else if (props.mode === \"QUOTE\") {\n      this._realOpen(\n        Object.assign({}, this._props, {\n          config: props.config,\n          context: props.context,\n        })\n      )\n    } else if (this._isOpen !== props.submit) {\n      let message = gettext(\n        \"You are already working on other message. Do you want to discard it?\"\n      )\n\n      const changeForm = window.confirm(message)\n      if (changeForm) {\n        this._mode = props.mode\n        this._isOpen = props.submit\n        this._realOpen(props)\n      }\n    } else if (this._mode == \"REPLY\" && props.mode == \"REPLY\") {\n      this._realOpen(props)\n    }\n  }\n\n  _realOpen(props) {\n    mount(<PostingComponent {...props} />, this._mount.id)\n\n    this._props = props\n    this._mount.classList.add(\"show\")\n    this._observer.observe(this._mount)\n    this.setBeforeUnload()\n  }\n\n  close = () => {\n    this.unsetBeforeUnload()\n    this._props = null\n\n    if (this._isOpen && !this._isClosing) {\n      this._isClosing = true\n      this._mount.classList.remove(\"show\")\n\n      window.setTimeout(() => {\n        ReactDOM.unmountComponentAtNode(this._mount)\n        this._observer.unobserve(this._mount)\n        this._spacer.style.height = \"0px;\"\n        this._isClosing = false\n        this._isOpen = false\n        this._mode = null\n      }, 300)\n    }\n  }\n}\n\nexport default new Posting()\n","import misago from \"misago/index\"\nimport reducer, { initialState } from \"misago/reducers/snackbar\"\nimport store from \"misago/services/store\"\n\nexport default function initializer() {\n  store.addReducer(\"snackbar\", reducer, initialState)\n}\n\nmisago.addInitializer({\n  name: \"reducer:snackbar\",\n  initializer: initializer,\n  before: \"store\",\n})\n","import moment from \"moment\"\nimport concatUnique from \"misago/utils/concat-unique\"\n\nexport const APPEND_THREADS = \"APPEND_THREADS\"\nexport const DELETE_THREAD = \"DELETE_THREAD\"\nexport const FILTER_THREADS = \"FILTER_THREADS\"\nexport const HYDRATE_THREADS = \"HYDRATE_THREADS\"\nexport const PATCH_THREAD = \"PATCH_THREAD\"\nexport const SORT_THREADS = \"SORT_THREADS\"\n\nexport const MODERATION_PERMISSIONS = [\n  \"can_announce\",\n  \"can_approve\",\n  \"can_close\",\n  \"can_hide\",\n  \"can_move\",\n  \"can_merge\",\n  \"can_pin\",\n  \"can_review\",\n]\n\nexport function append(items, sorting) {\n  return {\n    type: APPEND_THREADS,\n    items,\n    sorting,\n  }\n}\n\nexport function deleteThread(thread) {\n  return {\n    type: DELETE_THREAD,\n    thread,\n  }\n}\n\nexport function filterThreads(category, categoriesMap) {\n  return {\n    type: FILTER_THREADS,\n    category,\n    categoriesMap,\n  }\n}\n\nexport function hydrate(items) {\n  return {\n    type: HYDRATE_THREADS,\n    items,\n  }\n}\n\nexport function patch(thread, patch, sorting = null) {\n  return {\n    type: PATCH_THREAD,\n    thread,\n    patch,\n    sorting,\n  }\n}\n\nexport function sort(sorting) {\n  return {\n    type: SORT_THREADS,\n    sorting,\n  }\n}\n\nexport function getThreadModerationOptions(thread_acl) {\n  let options = []\n  MODERATION_PERMISSIONS.forEach(function (perm) {\n    if (thread_acl[perm]) {\n      options.push(perm)\n    }\n  })\n  return options\n}\n\nexport function hydrateThread(thread) {\n  return Object.assign({}, thread, {\n    moderation: getThreadModerationOptions(thread.acl),\n  })\n}\n\nexport default function thread(state = [], action = null) {\n  switch (action.type) {\n    case APPEND_THREADS:\n      const mergedState = concatUnique(action.items.map(hydrateThread), state)\n      return mergedState.sort(action.sorting)\n\n    case DELETE_THREAD:\n      return state.filter(function (item) {\n        return item.id !== action.thread.id\n      })\n\n    case FILTER_THREADS:\n      return state.filter(function (item) {\n        const itemCategory = action.categoriesMap[item.category]\n        if (\n          itemCategory.lft >= action.category.lft &&\n          itemCategory.rght <= action.category.rght\n        ) {\n          // same or sub category\n          return true\n        } else if (item.weight == 2) {\n          // globally pinned\n          return true\n        } else {\n          // thread moved outside displayed scope, hide it\n          return false\n        }\n      })\n\n    case HYDRATE_THREADS:\n      return action.items.map(hydrateThread)\n\n    case PATCH_THREAD:\n      const patchedState = state.map(function (item) {\n        if (item.id === action.thread.id) {\n          return Object.assign({}, item, action.patch)\n        } else {\n          return item\n        }\n      })\n\n      if (action.sorting) {\n        return patchedState.sort(action.sorting)\n      }\n      return patchedState\n\n    case SORT_THREADS:\n      return state.sort(action.sorting)\n\n    default:\n      return state\n  }\n}\n","import misago from \"misago/index\"\nimport reducer from \"misago/reducers/threads\"\nimport store from \"misago/services/store\"\n\nexport default function initializer() {\n  store.addReducer(\"threads\", reducer, [])\n}\n\nmisago.addInitializer({\n  name: \"reducer:threads\",\n  initializer: initializer,\n  before: \"store\",\n})\n","import React from \"react\"\nimport misago from \"misago\"\nimport Form from \"misago/components/form\"\nimport { load as updatePosts } from \"misago/reducers/posts\"\nimport { update as updateSearch } from \"misago/reducers/search\"\nimport { hydrate as updateUsers } from \"misago/reducers/users\"\nimport ajax from \"misago/services/ajax\"\nimport snackbar from \"misago/services/snackbar\"\nimport store from \"misago/services/store\"\nimport { FlexRow, FlexRowCol, FlexRowSection } from \"../FlexRow\"\nimport {\n  PageHeader,\n  PageHeaderContainer,\n  PageHeaderBanner,\n  PageHeaderDetails,\n} from \"../PageHeader\"\n\nexport default class extends Form {\n  constructor(props) {\n    super(props)\n\n    this.state = {\n      isLoading: false,\n      query: props.search.query,\n    }\n  }\n\n  componentDidMount() {\n    if (this.state.query.length) {\n      this.handleSubmit()\n    }\n  }\n\n  onQueryChange = (event) => {\n    this.changeValue(\"query\", event.target.value)\n  }\n\n  clean() {\n    if (!this.state.query.trim().length) {\n      snackbar.error(pgettext(\"search form\", \"You have to enter search query.\"))\n      return false\n    }\n\n    return true\n  }\n\n  send() {\n    store.dispatch(\n      updateSearch({\n        isLoading: true,\n      })\n    )\n\n    const query = this.state.query.trim()\n\n    let url = window.location.href\n    const urlQuery = url.indexOf(\"?q=\")\n    if (urlQuery > 0) {\n      url = url.substring(0, urlQuery + 3)\n    }\n    window.history.pushState({}, \"\", url + encodeURIComponent(query))\n\n    return ajax.get(misago.get(\"SEARCH_API\"), { q: query })\n  }\n\n  handleSuccess(providers) {\n    store.dispatch(\n      updateSearch({\n        query: this.state.query.trim(),\n        isLoading: false,\n        providers,\n      })\n    )\n\n    providers.forEach((provider) => {\n      if (provider.id === \"users\") {\n        store.dispatch(updateUsers(provider.results.results))\n      } else if (provider.id === \"threads\") {\n        store.dispatch(updatePosts(provider.results))\n      }\n    })\n  }\n\n  handleError(rejection) {\n    snackbar.apiError(rejection)\n\n    store.dispatch(\n      updateSearch({\n        isLoading: false,\n      })\n    )\n  }\n\n  render() {\n    return (\n      <form onSubmit={this.handleSubmit}>\n        <PageHeaderContainer>\n          <PageHeader styleName=\"site-search\">\n            <PageHeaderBanner styleName=\"site-search\">\n              <h1>{pgettext(\"search form title\", \"Search\")}</h1>\n            </PageHeaderBanner>\n            <PageHeaderDetails className=\"page-header-search-form\">\n              <FlexRow>\n                <FlexRowSection auto>\n                  <FlexRowCol>\n                    <input\n                      className=\"form-control\"\n                      disabled={this.state.isLoading}\n                      type=\"text\"\n                      value={this.state.query}\n                      placeholder={pgettext(\"search form input\", \"Search\")}\n                      onChange={this.onQueryChange}\n                    />\n                  </FlexRowCol>\n                  <FlexRowCol shrink>\n                    <button\n                      className=\"btn btn-secondary btn-icon btn-outline\"\n                      title={pgettext(\"search form btn\", \"Search\")}\n                      disabled={this.state.isLoading}\n                    >\n                      <span className=\"material-icon\">search</span>\n                    </button>\n                  </FlexRowCol>\n                </FlexRowSection>\n              </FlexRow>\n            </PageHeaderDetails>\n          </PageHeader>\n        </PageHeaderContainer>\n      </form>\n    )\n  }\n}\n","import React from \"react\"\nimport { Link } from \"react-router\"\n\nexport default function (props) {\n  return (\n    <div className=\"list-group nav-side\">\n      {props.providers.map((provider) => {\n        return (\n          <Link\n            activeClassName=\"active\"\n            className=\"list-group-item\"\n            key={provider.id}\n            to={provider.url}\n          >\n            <span className=\"material-icon\">{provider.icon}</span>\n            {provider.name}\n            <Badge results={provider.results} />\n          </Link>\n        )\n      })}\n    </div>\n  )\n}\n\nexport function Badge(props) {\n  if (!props.results) return null\n\n  let count = props.results.count\n  if (count > 1000000) {\n    count = Math.ceil(count / 1000000) + \"KK\"\n  } else if (count > 1000) {\n    count = Math.ceil(count / 1000) + \"K\"\n  }\n\n  return <span className=\"badge\">{count}</span>\n}\n","import React from \"react\"\nimport PageContainer from \"../PageContainer\"\nimport SearchForm from \"./form\"\nimport SideNav from \"./sidenav\"\n\nexport default function (props) {\n  return (\n    <div className=\"page page-search\">\n      <SearchForm provider={props.provider} search={props.search} />\n      <PageContainer>\n        <div className=\"row\">\n          <div className=\"col-md-3\">\n            <SideNav providers={props.search.providers} />\n          </div>\n          <div className=\"col-md-9\">\n            {props.children}\n            <SearchTime provider={props.provider} search={props.search} />\n          </div>\n        </div>\n      </PageContainer>\n    </div>\n  )\n}\n\nexport function SearchTime(props) {\n  let time = null\n  props.search.providers.forEach((p) => {\n    if (p.id === props.provider.id) {\n      time = p.time\n    }\n  })\n\n  if (time === null) return null\n\n  const copy = pgettext(\"search time\", \"Search took %(time)s s\")\n\n  return (\n    <footer className=\"search-footer\">\n      <p>{interpolate(copy, { time }, true)}</p>\n    </footer>\n  )\n}\n","import React from \"react\"\nimport PostFeed from \"misago/components/post-feed\"\nimport Button from \"misago/components/button\"\nimport MisagoMarkup from \"misago/components/misago-markup\"\nimport {\n  update as updatePosts,\n  append as appendPosts,\n} from \"misago/reducers/posts\"\nimport { updateProvider } from \"misago/reducers/search\"\nimport ajax from \"misago/services/ajax\"\nimport snackbar from \"misago/services/snackbar\"\nimport store from \"misago/services/store\"\n\nexport default function (props) {\n  return (\n    <div>\n      <PostFeed isReady={true} posts={props.results} />\n      <LoadMore {...props} />\n    </div>\n  )\n}\n\nexport class LoadMore extends React.Component {\n  onClick = () => {\n    store.dispatch(\n      updatePosts({\n        isBusy: true,\n      })\n    )\n\n    ajax\n      .get(this.props.provider.api, {\n        q: this.props.query,\n        page: this.props.next,\n      })\n      .then(\n        (providers) => {\n          providers.forEach((provider) => {\n            if (provider.id !== \"threads\") return\n            store.dispatch(appendPosts(provider.results))\n            store.dispatch(updateProvider(provider))\n          })\n\n          store.dispatch(\n            updatePosts({\n              isBusy: false,\n            })\n          )\n        },\n        (rejection) => {\n          snackbar.apiError(rejection)\n\n          store.dispatch(\n            updatePosts({\n              isBusy: false,\n            })\n          )\n        }\n      )\n  }\n\n  render() {\n    if (!this.props.more) return null\n\n    return (\n      <div className=\"pager-more\">\n        <Button\n          className=\"btn btn-default btn-outline\"\n          loading={this.props.isBusy}\n          onClick={this.onClick}\n        >\n          {pgettext(\"search threads btn\", \"Show more\")}\n        </Button>\n      </div>\n    )\n  }\n}\n","import React from \"react\"\nimport SearchPage from \"../page\"\nimport Results from \"./results\"\n\nexport default function (props) {\n  return (\n    <SearchPage provider={props.route.provider} search={props.search}>\n      <Blankslate\n        loading={props.search.isLoading}\n        query={props.search.query}\n        posts={props.posts}\n      >\n        <Results\n          provider={props.route.provider}\n          query={props.search.query}\n          {...props.posts}\n        />\n      </Blankslate>\n    </SearchPage>\n  )\n}\n\nexport function Blankslate({ children, loading, posts, query }) {\n  if (posts && posts.count) return children\n\n  if (query.length) {\n    return (\n      <p className=\"lead\">\n        {loading\n          ? pgettext(\"search threads\", \"Loading results...\")\n          : pgettext(\n              \"search threads\",\n              \"No threads matching search query have been found.\"\n            )}\n      </p>\n    )\n  }\n\n  return (\n    <p className=\"lead\">\n      {pgettext(\n        \"search threads\",\n        \"Enter at least two characters to search threads.\"\n      )}\n    </p>\n  )\n}\n","import React from \"react\"\nimport SearchPage from \"../page\"\nimport UsersList from \"misago/components/users-list\"\n\nexport default function (props) {\n  return (\n    <SearchPage provider={props.route.provider} search={props.search}>\n      <Blankslate\n        loading={props.search.isLoading}\n        query={props.search.query}\n        users={props.users}\n      >\n        <UsersList\n          cols={3}\n          isReady={!props.search.isLoading}\n          users={props.users}\n        />\n      </Blankslate>\n    </SearchPage>\n  )\n}\n\nexport function Blankslate({ children, loading, query, users }) {\n  if (users.length) return children\n\n  if (query.length) {\n    return (\n      <p className=\"lead\">\n        {loading\n          ? pgettext(\"search users\", \"Loading results...\")\n          : pgettext(\n              \"search users\",\n              \"No users matching search query have been found.\"\n            )}\n      </p>\n    )\n  }\n\n  return (\n    <p className=\"lead\">\n      {pgettext(\n        \"search users\",\n        \"Enter at least two characters to search users.\"\n      )}\n    </p>\n  )\n}\n","import { connect } from \"react-redux\"\nimport SearchThreads from \"./threads\"\nimport SearchUsers from \"./users\"\n\nconst components = {\n  threads: SearchThreads,\n  users: SearchUsers,\n}\n\nexport function select(store) {\n  return {\n    posts: store.posts,\n    search: store.search,\n    tick: store.tick.tick,\n    user: store.auth.user,\n    users: store.users,\n  }\n}\n\nexport default function (providers) {\n  return providers.map((provider) => {\n    return {\n      path: provider.url,\n      component: connect(select)(components[provider.id]),\n      provider: provider,\n    }\n  })\n}\n","import paths from \"misago/components/search-route\"\nimport misago from \"misago\"\nimport mount from \"misago/utils/routed-component\"\n\nexport default function initializer(context) {\n  if (context.get(\"CURRENT_LINK\") === \"misago:search\") {\n    mount({\n      paths: paths(misago.get(\"SEARCH_PROVIDERS\")),\n    })\n  }\n}\n\nmisago.addInitializer({\n  name: \"component:search\",\n  initializer: initializer,\n  after: \"store\",\n})\n","import misago from \"misago/index\"\nimport reducer, { initialState } from \"misago/reducers/tick\"\nimport store from \"misago/services/store\"\n\nexport default function initializer() {\n  store.addReducer(\"tick\", reducer, initialState)\n}\n\nmisago.addInitializer({\n  name: \"reducer:tick\",\n  initializer: initializer,\n  before: \"store\",\n})\n","import React from \"react\"\n\nconst TYPES_CLASSES = {\n  info: \"alert-info\",\n  success: \"alert-success\",\n  warning: \"alert-warning\",\n  error: \"alert-danger\",\n}\n\nexport class Snackbar extends React.Component {\n  getSnackbarClass() {\n    let snackbarClass = \"alerts-snackbar\"\n    if (this.props.isVisible) {\n      snackbarClass += \" in\"\n    } else {\n      snackbarClass += \" out\"\n    }\n    return snackbarClass\n  }\n\n  render() {\n    return (\n      <div className={this.getSnackbarClass()}>\n        <p className={\"alert \" + TYPES_CLASSES[this.props.type]}>\n          {this.props.message}\n        </p>\n      </div>\n    )\n  }\n}\n\nexport function select(state) {\n  return state.snackbar\n}\n","import { connect } from \"react-redux\"\nimport misago from \"misago/index\"\nimport { Snackbar, select } from \"misago/components/snackbar\"\nimport mount from \"misago/utils/mount-component\"\n\nexport default function initializer() {\n  mount(connect(select)(Snackbar), \"snackbar-mount\")\n}\n\nmisago.addInitializer({\n  name: \"component:snackbar\",\n  initializer: initializer,\n  after: \"snackbar\",\n})\n","let storage = window.localStorage\n\nexport class LocalStorage {\n  init(prefix) {\n    this._prefix = prefix\n    this._watchers = []\n\n    window.addEventListener(\"storage\", (e) => {\n      let newValueJson = JSON.parse(e.newValue)\n      this._watchers.forEach(function (watcher) {\n        if (watcher.key === e.key && e.oldValue !== e.newValue) {\n          watcher.callback(newValueJson)\n        }\n      })\n    })\n  }\n\n  set(key, value) {\n    storage.setItem(this._prefix + key, JSON.stringify(value))\n  }\n\n  get(key) {\n    let itemString = storage.getItem(this._prefix + key)\n    if (itemString) {\n      return JSON.parse(itemString)\n    } else {\n      return null\n    }\n  }\n\n  watch(key, callback) {\n    this._watchers.push({\n      key: this._prefix + key,\n      callback: callback,\n    })\n  }\n}\n\nexport default new LocalStorage()\n","export default function (bytes) {\n  if (bytes > 1024 * 1024 * 1024) {\n    return roundSize(bytes / (1024 * 1024 * 1024)) + \" GB\"\n  } else if (bytes > 1024 * 1024) {\n    return roundSize(bytes / (1024 * 1024)) + \" MB\"\n  } else if (bytes > 1024) {\n    return roundSize(bytes / 1024) + \" KB\"\n  } else {\n    return roundSize(bytes) + \" B\"\n  }\n}\n\nexport function roundSize(value) {\n  return value.toFixed(1)\n}\n","document.body.addEventListener(\"click\", (event) => {\n  const target = event.target.closest(\"[misago-scroll-to]\")\n  if (!!target) {\n    const selector = target.getAttribute(\"misago-scroll-to\")\n    const element = document.querySelector(selector)\n    if (element) {\n      event.preventDefault()\n      element.scrollIntoView({ behavior: \"instant\" })\n    }\n  }\n})\n","export const ALPHA = \"12345678990abcdefghijklmnopqrstuvwxyz\"\nexport const ALPHA_LEN = ALPHA.length\n\nexport default function getRandomString(len) {\n  const chars = []\n  for (let i = 0; i < len; i++) {\n    const index = Math.floor(Math.random() * ALPHA_LEN)\n    chars.push(ALPHA[index])\n  }\n  return chars.join(\"\")\n}\n","import misago from \"misago/index\"\nimport reducer, { initialState } from \"misago/reducers/auth\"\nimport store from \"misago/services/store\"\n\nexport default function initializer(context) {\n  store.addReducer(\n    \"auth\",\n    reducer,\n    Object.assign(\n      {\n        isAuthenticated: context.get(\"isAuthenticated\"),\n        isAnonymous: !context.get(\"isAuthenticated\"),\n\n        user: context.get(\"user\"),\n      },\n      initialState\n    )\n  )\n}\n\nmisago.addInitializer({\n  name: \"reducer:auth\",\n  initializer: initializer,\n  before: \"store\",\n})\n","import misago from \"misago/index\"\nimport ajax from \"misago/services/ajax\"\nimport captcha from \"misago/services/captcha\"\nimport include from \"misago/services/include\"\nimport snackbar from \"misago/services/snackbar\"\n\nexport default function initializer(context) {\n  captcha.init(context, ajax, include, snackbar)\n}\n\nmisago.addInitializer({\n  name: \"captcha\",\n  initializer: initializer,\n})\n","const map = {\n  \"&\": \"&amp;\",\n  \"<\": \"&lt;\",\n  \">\": \"&gt;\",\n  '\"': \"&quot;\",\n  \"'\": \"&#039;\",\n}\n\nexport default function (text) {\n  return text.replace(/[&<>\"']/g, function (m) {\n    return map[m]\n  })\n}\n","import React from \"react\"\nimport misago from \"misago/index\"\nimport Button from \"misago/components/button\"\nimport Form from \"misago/components/form\"\nimport ajax from \"misago/services/ajax\"\nimport snackbar from \"misago/services/snackbar\"\nimport * as validators from \"misago/utils/validators\"\nimport showBannedPage from \"misago/utils/banned-page\"\n\nexport class RequestLinkForm extends Form {\n  constructor(props) {\n    super(props)\n\n    this.state = {\n      isLoading: false,\n\n      email: \"\",\n\n      validators: {\n        email: [validators.email()],\n      },\n    }\n  }\n\n  clean() {\n    if (this.isValid()) {\n      return true\n    } else {\n      snackbar.error(\n        pgettext(\n          \"request activation link form\",\n          \"Enter a valid e-mail address.\"\n        )\n      )\n      return false\n    }\n  }\n\n  send() {\n    return ajax.post(misago.get(\"SEND_ACTIVATION_API\"), {\n      email: this.state.email,\n    })\n  }\n\n  handleSuccess(apiResponse) {\n    this.props.callback(apiResponse)\n  }\n\n  handleError(rejection) {\n    if ([\"already_active\", \"inactive_admin\"].indexOf(rejection.code) > -1) {\n      snackbar.info(rejection.detail)\n    } else if (rejection.status === 403 && rejection.ban) {\n      showBannedPage(rejection.ban)\n    } else {\n      snackbar.apiError(rejection)\n    }\n  }\n\n  render() {\n    return (\n      <div className=\"well well-form well-form-request-activation-link\">\n        <form onSubmit={this.handleSubmit}>\n          <div className=\"form-group\">\n            <div className=\"control-input\">\n              <input\n                type=\"text\"\n                className=\"form-control\"\n                placeholder={pgettext(\n                  \"request activation link form field\",\n                  \"Your e-mail address\"\n                )}\n                disabled={this.state.isLoading}\n                onChange={this.bindInput(\"email\")}\n                value={this.state.email}\n              />\n            </div>\n          </div>\n\n          <Button\n            className=\"btn-primary btn-block\"\n            loading={this.state.isLoading}\n          >\n            {pgettext(\"request activation link form btn\", \"Send link\")}\n          </Button>\n        </form>\n      </div>\n    )\n  }\n}\n\nexport class LinkSent extends React.Component {\n  getMessage() {\n    return interpolate(\n      pgettext(\n        \"request activation link form\",\n        \"Activation link was sent to %(email)s\"\n      ),\n      {\n        email: this.props.user.email,\n      },\n      true\n    )\n  }\n\n  render() {\n    return (\n      <div className=\"well well-form well-form-request-activation-link well-done\">\n        <div className=\"done-message\">\n          <div className=\"message-icon\">\n            <span className=\"material-icon\">check</span>\n          </div>\n          <div className=\"message-body\">\n            <p>{this.getMessage()}</p>\n          </div>\n          <button\n            className=\"btn btn-primary btn-block\"\n            type=\"button\"\n            onClick={this.props.callback}\n          >\n            {pgettext(\n              \"request activation link form btn\",\n              \"Request another link\"\n            )}\n          </button>\n        </div>\n      </div>\n    )\n  }\n}\n\nexport default class extends React.Component {\n  constructor(props) {\n    super(props)\n\n    this.state = {\n      complete: false,\n    }\n  }\n\n  complete = (apiResponse) => {\n    this.setState({\n      complete: apiResponse,\n    })\n  }\n\n  reset = () => {\n    this.setState({\n      complete: false,\n    })\n  }\n\n  render() {\n    if (this.state.complete) {\n      return <LinkSent user={this.state.complete} callback={this.reset} />\n    } else {\n      return <RequestLinkForm callback={this.complete} />\n    }\n  }\n}\n","import misago from \"misago/index\"\nimport RequestActivationLink from \"misago/components/request-activation-link\"\nimport mount from \"misago/utils/mount-component\"\n\nexport default function initializer() {\n  if (document.getElementById(\"request-activation-link-mount\")) {\n    mount(RequestActivationLink, \"request-activation-link-mount\", false)\n  }\n}\n\nmisago.addInitializer({\n  name: \"component:request-activation-link\",\n  initializer: initializer,\n  after: \"store\",\n})\n","import classnames from \"classnames\"\nimport React from \"react\"\n\nconst FlexRow = ({ children, className }) => (\n  <div className={classnames(\"flex-row\", className)}>{children}</div>\n)\n\nexport default FlexRow\n","import classnames from \"classnames\"\nimport React from \"react\"\n\nconst FlexRowCol = ({ children, className, shrink }) => (\n  <div\n    className={classnames(\"flex-row-col\", className, {\n      \"flex-row-col-shrink\": shrink,\n    })}\n  >\n    {children}\n  </div>\n)\n\nexport default FlexRowCol\n","import classnames from \"classnames\"\nimport React from \"react\"\n\nconst FlexRowSection = ({ auto, children, className }) => (\n  <div\n    className={classnames(\n      \"flex-row-section\",\n      { \"flex-row-section-auto\": auto },\n      className\n    )}\n  >\n    {children}\n  </div>\n)\n\nexport default FlexRowSection\n","export class Polls {\n  init(ajax, snackbar) {\n    this._ajax = ajax\n    this._snackbar = snackbar\n\n    this._polls = {}\n  }\n\n  start(kwargs) {\n    this.stop(kwargs.poll)\n\n    const poolServer = () => {\n      this._polls[kwargs.poll] = kwargs\n\n      this._ajax.get(kwargs.url, kwargs.data || null).then(\n        (data) => {\n          if (!this._polls[kwargs.poll]._stopped) {\n            kwargs.update(data)\n\n            this._polls[kwargs.poll].timeout = window.setTimeout(\n              poolServer,\n              kwargs.frequency\n            )\n          }\n        },\n        (rejection) => {\n          if (!this._polls[kwargs.poll]._stopped) {\n            if (kwargs.error) {\n              kwargs.error(rejection)\n            } else {\n              this._snackbar.apiError(rejection)\n            }\n          }\n        }\n      )\n    }\n\n    if (kwargs.delayed) {\n      this._polls[kwargs.poll] = {\n        timeout: window.setTimeout(poolServer, kwargs.frequency),\n      }\n    } else {\n      poolServer()\n    }\n  }\n\n  stop(pollId) {\n    if (this._polls[pollId]) {\n      window.clearTimeout(this._polls[pollId].timeout)\n      this._polls[pollId]._stopped = true\n    }\n  }\n}\n\nexport default new Polls()\n","export const OPEN_SITE_NAV = \"OPEN_SITE_NAV\"\nexport const OPEN_SEARCH = \"OPEN_SEARCH\"\nexport const OPEN_NOTIFICATIONS = \"OPEN_NOTIFICATIONS\"\nexport const OPEN_PRIVATE_THREADS = \"OPEN_PRIVATE_THREADS\"\nexport const OPEN_USER_NAV = \"OPEN_USER_NAV\"\nexport const CLOSE = \"CLOSE_OVERLAYS\"\n\nexport function openSiteNav() {\n  return { type: OPEN_SITE_NAV }\n}\n\nexport function openSearch() {\n  return { type: OPEN_SEARCH }\n}\n\nexport function openNotifications() {\n  return { type: OPEN_NOTIFICATIONS }\n}\n\nexport function openPrivateThreads() {\n  return { type: OPEN_PRIVATE_THREADS }\n}\n\nexport function openUserNav() {\n  return { type: OPEN_USER_NAV }\n}\n\nexport function close() {\n  return { type: CLOSE }\n}\n\nexport const initialState = {\n  siteNav: false,\n  search: false,\n  notifications: false,\n  privateThreads: false,\n  userNav: false,\n}\n\nexport default function notifications(state = initialState, action = null) {\n  switch (action.type) {\n    case OPEN_SITE_NAV:\n      return Object.assign({}, state, initialState, { siteNav: true })\n\n    case OPEN_SEARCH:\n      return Object.assign({}, state, initialState, { search: true })\n\n    case OPEN_NOTIFICATIONS:\n      return Object.assign({}, state, initialState, { notifications: true })\n\n    case OPEN_PRIVATE_THREADS:\n      return Object.assign({}, state, initialState, { privateThreads: true })\n\n    case OPEN_USER_NAV:\n      return Object.assign({}, state, initialState, { userNav: true })\n\n    case CLOSE:\n      return Object.assign({}, state, initialState)\n\n    default:\n      return state\n  }\n}\n","/* global zxcvbn */\nexport class Zxcvbn {\n  init(include) {\n    this._include = include\n    this._isLoaded = false\n  }\n\n  scorePassword(password, inputs) {\n    // 0-4 score, the more the stronger password\n    if (this._isLoaded) {\n      return zxcvbn(password, inputs).score\n    }\n\n    return 0\n  }\n\n  load() {\n    if (!this._isLoaded) {\n      this._include.include(\"misago/js/zxcvbn.js\")\n      return this._loadingPromise()\n    } else {\n      return this._loadedPromise()\n    }\n  }\n\n  _loadingPromise() {\n    const self = this\n\n    return new Promise(function (resolve, reject) {\n      var wait = function (tries = 0) {\n        tries += 1\n        if (tries > 200) {\n          reject()\n        } else if (typeof zxcvbn === \"undefined\") {\n          window.setTimeout(function () {\n            wait(tries)\n          }, 200)\n        } else {\n          self._isLoaded = true\n          resolve()\n        }\n      }\n      wait()\n    })\n  }\n\n  _loadedPromise() {\n    // we have already loaded zxcvbn.js, resolve away!\n    return new Promise(function (resolve) {\n      resolve()\n    })\n  }\n}\n\nexport default new Zxcvbn()\n","import React from \"react\"\nimport misago from \"misago/index\"\nimport Button from \"misago/components/button\"\nimport Form from \"misago/components/form\"\nimport StartSocialAuth from \"misago/components/StartSocialAuth\"\nimport ajax from \"misago/services/ajax\"\nimport modal from \"misago/services/modal\"\nimport snackbar from \"misago/services/snackbar\"\nimport showBannedPage from \"misago/utils/banned-page\"\n\nexport default class extends Form {\n  constructor(props) {\n    super(props)\n\n    this.state = {\n      isLoading: false,\n      showActivation: false,\n\n      username: \"\",\n      password: \"\",\n\n      validators: {\n        username: [],\n        password: [],\n      },\n    }\n  }\n\n  clean() {\n    if (!this.isValid()) {\n      snackbar.error(pgettext(\"sign in modal\", \"Fill out both fields.\"))\n      return false\n    } else {\n      return true\n    }\n  }\n\n  send() {\n    return ajax.post(misago.get(\"AUTH_API\"), {\n      username: this.state.username,\n      password: this.state.password,\n    })\n  }\n\n  handleSuccess() {\n    let form = $(\"#hidden-login-form\")\n\n    form.append('<input type=\"text\" name=\"username\" />')\n    form.append('<input type=\"password\" name=\"password\" />')\n\n    // fill out form with user credentials and submit it, this will tell\n    // Misago to redirect user back to right page, and will trigger browser's\n    // key ring feature\n    form.find('input[type=\"hidden\"]').val(ajax.getCsrfToken())\n    form.find('input[name=\"next\"]').val(window.location.pathname)\n    form.find('input[name=\"username\"]').val(this.state.username)\n    form.find('input[name=\"password\"]').val(this.state.password)\n    form.submit()\n\n    // keep form loading\n    this.setState({\n      isLoading: true,\n    })\n  }\n\n  handleError(rejection) {\n    if (rejection.status === 400) {\n      if (rejection.code === \"inactive_admin\") {\n        snackbar.info(rejection.detail)\n      } else if (rejection.code === \"inactive_user\") {\n        snackbar.info(rejection.detail)\n        this.setState({\n          showActivation: true,\n        })\n      } else if (rejection.code === \"banned\") {\n        showBannedPage(rejection.detail)\n        modal.hide()\n      } else {\n        snackbar.error(rejection.detail)\n      }\n    } else if (rejection.status === 403 && rejection.ban) {\n      showBannedPage(rejection.ban)\n      modal.hide()\n    } else {\n      snackbar.apiError(rejection)\n    }\n  }\n\n  getActivationButton() {\n    if (!this.state.showActivation) return null\n\n    return (\n      <a\n        className=\"btn btn-success btn-block\"\n        href={misago.get(\"REQUEST_ACTIVATION_URL\")}\n      >\n        {pgettext(\"sign in modal btn\", \"Activate account\")}\n      </a>\n    )\n  }\n\n  render() {\n    return (\n      <div className=\"modal-dialog modal-sm modal-sign-in\" role=\"document\">\n        <div className=\"modal-content\">\n          <div className=\"modal-header\">\n            <button\n              aria-label={pgettext(\"modal\", \"Close\")}\n              className=\"close\"\n              data-dismiss=\"modal\"\n              type=\"button\"\n            >\n              <span aria-hidden=\"true\">&times;</span>\n            </button>\n            <h4 className=\"modal-title\">\n              {pgettext(\"sign in modal title\", \"Sign in\")}\n            </h4>\n          </div>\n          <form onSubmit={this.handleSubmit}>\n            <div className=\"modal-body\">\n              <StartSocialAuth\n                buttonLabel={pgettext(\"sign in modal\", \"Sign in with %(site)s\")}\n                formLabel={pgettext(\n                  \"sign in modal\",\n                  \"Or use your forum account:\"\n                )}\n                labelClassName=\"text-center\"\n              />\n\n              <div className=\"form-group\">\n                <div className=\"control-input\">\n                  <input\n                    className=\"form-control input-lg\"\n                    disabled={this.state.isLoading}\n                    id=\"id_username\"\n                    onChange={this.bindInput(\"username\")}\n                    placeholder={pgettext(\n                      \"sign in modal field\",\n                      \"Username or e-mail\"\n                    )}\n                    type=\"text\"\n                    value={this.state.username}\n                  />\n                </div>\n              </div>\n\n              <div className=\"form-group\">\n                <div className=\"control-input\">\n                  <input\n                    className=\"form-control input-lg\"\n                    disabled={this.state.isLoading}\n                    id=\"id_password\"\n                    onChange={this.bindInput(\"password\")}\n                    placeholder={pgettext(\"sign in modal field\", \"Password\")}\n                    type=\"password\"\n                    value={this.state.password}\n                  />\n                </div>\n              </div>\n            </div>\n            <div className=\"modal-footer\">\n              {this.getActivationButton()}\n              <Button\n                className=\"btn-primary btn-block\"\n                loading={this.state.isLoading}\n              >\n                {pgettext(\"sign in modal btn\", \"Sign in\")}\n              </Button>\n              <a\n                className=\"btn btn-default btn-block\"\n                href={misago.get(\"FORGOTTEN_PASSWORD_URL\")}\n              >\n                {pgettext(\"sign in modal btn\", \"Forgot password?\")}\n              </a>\n            </div>\n          </form>\n        </div>\n      </div>\n    )\n  }\n}\n","import misago from \"misago/index\"\nimport store from \"misago/services/store\"\n\nexport default function initializer() {\n  store.init()\n}\n\nmisago.addInitializer({\n  name: \"store\",\n  initializer: initializer,\n  before: \"_end\",\n})\n","import misago from \"misago/index\"\nimport include from \"misago/services/include\"\nimport zxcvbn from \"misago/services/zxcvbn\"\n\nexport default function initializer() {\n  zxcvbn.init(include)\n}\n\nmisago.addInitializer({\n  name: \"zxcvbn\",\n  initializer: initializer,\n})\n","import classnames from \"classnames\"\nimport React from \"react\"\n\nexport default class Dropdown extends React.Component {\n  constructor(props) {\n    super(props)\n\n    this.state = {\n      isOpen: false,\n    }\n\n    this.root = null\n    this.dropdown = null\n  }\n\n  componentDidMount() {\n    window.addEventListener(\"click\", this.handleClick)\n  }\n\n  componentWillUnmount() {\n    window.removeEventListener(\"click\", this.handleClick)\n  }\n\n  componentDidUpdate(prevProps, prevState) {\n    const didUpdate = prevState.isOpen !== this.state.isOpen\n    if (didUpdate) {\n      if (this.state.isOpen && this.props.onOpen) {\n        this.props.onOpen(this.root)\n      }\n\n      if (!this.state.isOpen && this.props.onClose) {\n        this.props.onClose(this.root)\n      }\n    }\n  }\n\n  handleClick = (event) => {\n    if (\n      this.state.isOpen &&\n      (!this.root.contains(event.target) ||\n        (this.menu.contains(event.target) && event.target.closest(\"a\")))\n    ) {\n      this.setState({ isOpen: false })\n    }\n  }\n\n  toggle = () => {\n    this.setState((prevState) => {\n      return { isOpen: !prevState.isOpen }\n    })\n  }\n\n  close = () => {\n    this.setState({ isOpen: false })\n  }\n\n  render() {\n    const { isOpen } = this.state\n\n    return (\n      <div\n        id={this.props.id}\n        className={classnames(\n          \"dropdown\",\n          { open: isOpen },\n          this.props.className\n        )}\n        ref={(element) => {\n          if (element && !this.element) {\n            this.root = element\n          }\n        }}\n      >\n        {this.props.toggle({\n          isOpen,\n          toggle: this.toggle,\n          aria: ariaProps(isOpen),\n        })}\n        <div\n          className={classnames(\n            \"dropdown-menu\",\n            { \"dropdown-menu-right\": this.props.menuAlignRight },\n            this.props.menuClassName\n          )}\n          ref={(element) => {\n            if (element && !this.menu) {\n              this.menu = element\n            }\n          }}\n          role=\"menu\"\n        >\n          {this.props.children({ isOpen, close: this.close })}\n        </div>\n      </div>\n    )\n  }\n}\n\nfunction ariaProps(isOpen) {\n  return {\n    \"aria-haspopup\": \"true\",\n    \"aria-expanded\": isOpen ? \"true\" : \"false\",\n  }\n}\n","import classnames from \"classnames\"\nimport React from \"react\"\n\nexport default function DropdownDivider({ className }) {\n  return <li className={classnames(\"divider\", className)}></li>\n}\n","import React from \"react\"\n\nexport default function DropdownFooter({ children, listItem }) {\n  if (listItem) {\n    return <li className=\"dropdown-footer\">{children}</li>\n  }\n\n  return <div className=\"dropdown-footer\">{children}</div>\n}\n","import classnames from \"classnames\"\nimport React from \"react\"\n\nexport default function DropdownHeader({ className, children }) {\n  return (\n    <div className={classnames(\"dropdown-header\", className)}>{children}</div>\n  )\n}\n","import classnames from \"classnames\"\nimport React from \"react\"\n\nexport default function DropdownMenuItem({ className, children }) {\n  return (\n    <li className={classnames(\"dropdown-menu-item\", className)}>{children}</li>\n  )\n}\n","import classnames from \"classnames\"\nimport React from \"react\"\n\nexport default function DropdownPills({ className, children }) {\n  return (\n    <div className={classnames(\"dropdown-pills\", className)}>{children}</div>\n  )\n}\n","import classnames from \"classnames\"\nimport React from \"react\"\n\nexport default function DropdownSubheader({ className, children }) {\n  return (\n    <li className={classnames(\"dropdown-subheader\", className)}>{children}</li>\n  )\n}\n","import React from \"react\"\nimport { Link } from \"react-router\"\nimport Li from \"misago/components/li\"\n\nconst UsersNav = ({ baseUrl, page, pages }) => (\n  <div className=\"nav-container\">\n    <div className=\"dropdown hidden-sm hidden-md hidden-lg\">\n      <button\n        className=\"btn btn-default btn-block btn-outline dropdown-toggle\"\n        type=\"button\"\n        data-toggle=\"dropdown\"\n        aria-haspopup=\"true\"\n        aria-expanded=\"false\"\n      >\n        <span className=\"material-icon\">menu</span>\n        {page.name}\n      </button>\n      <ul className=\"dropdown-menu stick-to-bottom\">\n        {pages.map((page) => {\n          const url = getPageUrl(baseUrl, page)\n          return (\n            <li key={url}>\n              <Link to={url}>{page.name}</Link>\n            </li>\n          )\n        })}\n      </ul>\n    </div>\n    <ul className=\"nav nav-pills hidden-xs\" role=\"menu\">\n      {pages.map((page) => {\n        const url = getPageUrl(baseUrl, page)\n        return (\n          <Li path={url} key={url}>\n            <Link to={url}>{page.name}</Link>\n          </Li>\n        )\n      })}\n    </ul>\n  </div>\n)\n\nconst getPageUrl = (baseUrl, page) => {\n  let url = baseUrl\n  if (page.component === \"rank\") {\n    url += page.slug\n  } else {\n    url += page.component\n  }\n  return url + \"/\"\n}\n\nexport default UsersNav\n","import React from \"react\"\nimport PageContainer from \"../../PageContainer\"\nimport UsersNav from \"../UsersNav\"\n\nexport default class extends React.Component {\n  getEmptyMessage() {\n    return interpolate(\n      npgettext(\n        \"top posters empty\",\n        \"No users have posted any new messages during last %(days)s day.\",\n        \"No users have posted any new messages during last %(days)s days.\",\n        this.props.trackedPeriod\n      ),\n      { days: this.props.trackedPeriod },\n      true\n    )\n  }\n\n  render() {\n    return (\n      <div className=\"active-posters-list\">\n        <PageContainer>\n          <UsersNav\n            baseUrl={misago.get(\"USERS_LIST_URL\")}\n            page={this.props.page}\n            pages={misago.get(\"USERS_LISTS\")}\n          />\n          <p className=\"lead\">{this.getEmptyMessage()}</p>\n        </PageContainer>\n      </div>\n    )\n  }\n}\n","import React from \"react\"\nimport Avatar from \"misago/components/avatar\"\nimport * as random from \"misago/utils/random\"\n\nexport default class extends React.Component {\n  shouldComponentUpdate() {\n    return false\n  }\n\n  getClassName() {\n    if (this.props.hiddenOnMobile) {\n      return \"list-group-item hidden-xs hidden-sm\"\n    } else {\n      return \"list-group-item\"\n    }\n  }\n\n  render() {\n    return (\n      <li className={this.getClassName()}>\n        <div className=\"rank-user-avatar\">\n          <span>\n            <Avatar size=\"50\" />\n          </span>\n        </div>\n\n        <div className=\"rank-user\">\n          <div className=\"user-name\">\n            <span className=\"item-title\">\n              <span\n                className=\"ui-preview-text\"\n                style={{ width: random.int(30, 80) + \"px\" }}\n              >\n                &nbsp;\n              </span>\n            </span>\n          </div>\n\n          <div className=\"user-details\">\n            <span className=\"user-status\">\n              <span className=\"status-icon ui-preview-text\">&nbsp;</span>\n              <span\n                className=\"status-label ui-preview-text hidden-xs hidden-sm\"\n                style={{ width: random.int(30, 50) + \"px\" }}\n              >\n                &nbsp;\n              </span>\n            </span>\n            <span className=\"rank-name\">\n              <span\n                className=\"ui-preview-text\"\n                style={{ width: random.int(30, 50) + \"px\" }}\n              >\n                &nbsp;\n              </span>\n            </span>\n            <span className=\"user-title hidden-xs hidden-sm\">\n              <span\n                className=\"ui-preview-text\"\n                style={{ width: random.int(30, 50) + \"px\" }}\n              >\n                &nbsp;\n              </span>\n            </span>\n          </div>\n          <div className=\"user-compact-stats visible-xs-block\">\n            <span className=\"rank-position\">\n              <strong>\n                <span\n                  className=\"ui-preview-text\"\n                  style={{ width: random.int(20, 30) + \"px\" }}\n                >\n                  &nbsp;\n                </span>\n              </strong>\n              <small>{pgettext(\"top posters list item\", \"Rank\")}</small>\n            </span>\n            <span className=\"rank-posts-counted\">\n              <strong>\n                <span\n                  className=\"ui-preview-text\"\n                  style={{ width: random.int(20, 30) + \"px\" }}\n                >\n                  &nbsp;\n                </span>\n              </strong>\n              <small>{pgettext(\"top posters list item\", \"Ranked posts\")}</small>\n            </span>\n          </div>\n        </div>\n\n        <div className=\"rank-position hidden-xs\">\n          <strong>\n            <span\n              className=\"ui-preview-text\"\n              style={{ width: random.int(20, 30) + \"px\" }}\n            >\n              &nbsp;\n            </span>\n          </strong>\n          <small>{pgettext(\"top posters list item\", \"Rank\")}</small>\n        </div>\n\n        <div className=\"rank-posts-counted hidden-xs\">\n          <strong>\n            <span\n              className=\"ui-preview-text\"\n              style={{ width: random.int(20, 30) + \"px\" }}\n            >\n              &nbsp;\n            </span>\n          </strong>\n          <small>{pgettext(\"top posters list item\", \"Ranked posts\")}</small>\n        </div>\n\n        <div className=\"rank-posts-total hidden-xs\">\n          <strong>\n            <span\n              className=\"ui-preview-text\"\n              style={{ width: random.int(20, 30) + \"px\" }}\n            >\n              &nbsp;\n            </span>\n          </strong>\n          <small>{pgettext(\"top posters list item\", \"Total posts\")}</small>\n        </div>\n      </li>\n    )\n  }\n}\n","import React from \"react\"\nimport ItemPreview from \"misago/components/users/active-posters/list-item-preview\"\nimport * as random from \"misago/utils/random\"\nimport PageContainer from \"../../PageContainer\"\nimport UsersNav from \"../UsersNav\"\n\nexport default class extends React.Component {\n  shouldComponentUpdate() {\n    return false\n  }\n\n  render() {\n    return (\n      <div className=\"active-posters-list\">\n        <PageContainer>\n          <UsersNav\n            baseUrl={misago.get(\"USERS_LIST_URL\")}\n            page={this.props.page}\n            pages={misago.get(\"USERS_LISTS\")}\n          />\n          <p className=\"lead ui-preview\">\n            <span\n              className=\"ui-preview-text\"\n              style={{ width: random.int(50, 220) + \"px\" }}\n            >\n              &nbsp;\n            </span>\n          </p>\n\n          <div className=\"active-posters ui-preview\">\n            <ul className=\"list-group\">\n              {[0, 1, 2].map((i) => {\n                return <ItemPreview hiddenOnMobile={i > 0} key={i} />\n              })}\n            </ul>\n          </div>\n        </PageContainer>\n      </div>\n    )\n  }\n}\n","import React from \"react\"\nimport { Link } from \"react-router\"\nimport Avatar from \"misago/components/avatar\"\nimport Status, { StatusIcon, StatusLabel } from \"misago/components/user-status\"\nimport misago from \"misago/index\"\nimport * as random from \"misago/utils/random\"\n\nexport default class extends React.Component {\n  getClassName() {\n    if (this.props.rank.css_class) {\n      return \"list-group-item list-group-rank-\" + this.props.rank.css_class\n    } else {\n      return \"list-group-item\"\n    }\n  }\n\n  getUserStatus() {\n    if (this.props.user.status) {\n      return (\n        <Status user={this.props.user} status={this.props.user.status}>\n          <StatusIcon user={this.props.user} status={this.props.user.status} />\n          <StatusLabel\n            user={this.props.user}\n            status={this.props.user.status}\n            className=\"status-label hidden-xs hidden-sm\"\n          />\n        </Status>\n      )\n    }\n\n    return (\n      <span className=\"user-status\">\n        <span className=\"status-icon ui-preview-text\">&nbsp;</span>\n        <span\n          className=\"status-label ui-preview-text hidden-xs hidden-sm\"\n          style={{ width: random.int(30, 50) + \"px\" }}\n        >\n          &nbsp;\n        </span>\n      </span>\n    )\n  }\n\n  getRankName() {\n    if (!this.props.rank.is_tab) {\n      return (\n        <span className=\"rank-name item-title\">{this.props.rank.name}</span>\n      )\n    }\n\n    let rankUrl = misago.get(\"USERS_LIST_URL\") + this.props.rank.slug + \"/\"\n    return (\n      <Link to={rankUrl} className=\"rank-name item-title\">\n        {this.props.rank.name}\n      </Link>\n    )\n  }\n\n  getUserTitle() {\n    if (!this.props.user.title) return null\n\n    return (\n      <span className=\"user-title hidden-xs hidden-sm\">\n        {this.props.user.title}\n      </span>\n    )\n  }\n\n  render() {\n    return (\n      <li className={this.getClassName()}>\n        <div className=\"rank-user-avatar\">\n          <a href={this.props.user.url}>\n            <Avatar user={this.props.user} size={50} size2x={64} />\n          </a>\n        </div>\n\n        <div className=\"rank-user\">\n          <div className=\"user-name\">\n            <a href={this.props.user.url} className=\"item-title\">\n              {this.props.user.username}\n            </a>\n          </div>\n          <div className=\"user-details\">\n            {this.getUserStatus()}\n            {this.getRankName()}\n            {this.getUserTitle()}\n          </div>\n          <div className=\"user-compact-stats visible-xs-block\">\n            <span className=\"rank-position\">\n              <strong>#{this.props.counter}</strong>\n              <small>{pgettext(\"top posters list item\", \"Rank\")}</small>\n            </span>\n\n            <span className=\"rank-posts-counted\">\n              <strong>{this.props.user.meta.score}</strong>\n              <small>{pgettext(\"top posters list item\", \"Ranked posts\")}</small>\n            </span>\n          </div>\n        </div>\n\n        <div className=\"rank-position hidden-xs\">\n          <strong>#{this.props.counter}</strong>\n          <small>{pgettext(\"top posters list item\", \"Rank\")}</small>\n        </div>\n\n        <div className=\"rank-posts-counted hidden-xs\">\n          <strong>{this.props.user.meta.score}</strong>\n          <small>{pgettext(\"top posters list item\", \"Ranked posts\")}</small>\n        </div>\n\n        <div className=\"rank-posts-total hidden-xs\">\n          <strong>{this.props.user.posts}</strong>\n          <small>{pgettext(\"top posters list item\", \"Total posts\")}</small>\n        </div>\n      </li>\n    )\n  }\n}\n","import React from \"react\"\nimport ListItem from \"misago/components/users/active-posters/list-item\"\nimport PageContainer from \"../../PageContainer\"\nimport UsersNav from \"../UsersNav\"\n\nexport default class extends React.Component {\n  getLeadMessage() {\n    let message = npgettext(\n      \"top posters list\",\n      \"%(posters)s top poster from last %(days)s days.\",\n      \"%(posters)s top posters from last %(days)s days.\",\n      this.props.count\n    )\n\n    return interpolate(\n      message,\n      {\n        posters: this.props.count,\n        days: this.props.trackedPeriod,\n      },\n      true\n    )\n  }\n\n  render() {\n    return (\n      <div className=\"active-posters-list\">\n        <PageContainer>\n          <UsersNav\n            baseUrl={misago.get(\"USERS_LIST_URL\")}\n            page={this.props.page}\n            pages={misago.get(\"USERS_LISTS\")}\n          />\n          <p className=\"lead\">{this.getLeadMessage()}</p>\n\n          <div className=\"active-posters ui-ready\">\n            <ul className=\"list-group\">\n              {this.props.users.map((user, i) => {\n                return (\n                  <ListItem\n                    user={user}\n                    rank={user.rank}\n                    counter={i + 1}\n                    key={user.id}\n                  />\n                )\n              })}\n            </ul>\n          </div>\n        </PageContainer>\n      </div>\n    )\n  }\n}\n","import React from \"react\"\nimport ListEmpty from \"misago/components/users/active-posters/list-empty\"\nimport ListPreview from \"misago/components/users/active-posters/list-preview\"\nimport ListReady from \"misago/components/users/active-posters/list-ready\"\nimport misago from \"misago/index\"\nimport { hydrate } from \"misago/reducers/users\"\nimport polls from \"misago/services/polls\"\nimport store from \"misago/services/store\"\nimport title from \"misago/services/page-title\"\n\nexport default class extends React.Component {\n  constructor(props) {\n    super(props)\n\n    if (misago.has(\"USERS\")) {\n      this.initWithPreloadedData(misago.pop(\"USERS\"))\n    } else {\n      this.initWithoutPreloadedData()\n    }\n\n    this.startPolling()\n  }\n\n  initWithPreloadedData(data) {\n    this.state = {\n      isLoaded: true,\n\n      trackedPeriod: data.tracked_period,\n      count: data.count,\n    }\n\n    store.dispatch(hydrate(data.results))\n  }\n\n  initWithoutPreloadedData() {\n    this.state = {\n      isLoaded: false,\n    }\n  }\n\n  startPolling() {\n    polls.start({\n      poll: \"active-posters\",\n      url: misago.get(\"USERS_API\"),\n      data: {\n        list: \"active\",\n      },\n      frequency: 90 * 1000,\n      update: this.update,\n    })\n  }\n\n  update = (data) => {\n    store.dispatch(hydrate(data.results))\n\n    this.setState({\n      isLoaded: true,\n\n      trackedPeriod: data.tracked_period,\n      count: data.count,\n    })\n  }\n\n  componentDidMount() {\n    title.set({\n      title: this.props.route.extra.name,\n      parent: pgettext(\"users page title\", \"Users\"),\n    })\n  }\n\n  componentWillUnmount() {\n    polls.stop(\"active-posters\")\n  }\n\n  render() {\n    const page = { name: this.props.route.extra.name }\n\n    if (this.state.isLoaded) {\n      if (this.state.count > 0) {\n        return (\n          <ListReady\n            page={page}\n            users={this.props.users}\n            trackedPeriod={this.state.trackedPeriod}\n            count={this.state.count}\n          />\n        )\n      } else {\n        return (\n          <ListEmpty page={page} trackedPeriod={this.state.trackedPeriod} />\n        )\n      }\n    } else {\n      return <ListPreview page={page} />\n    }\n  }\n}\n","import React from \"react\"\nimport stringCount from \"misago/utils/string-count\"\n\nexport default class extends React.Component {\n  getClassName() {\n    if (this.props.copy && this.props.copy.length) {\n      if (\n        stringCount(this.props.copy, \"<p\") === 1 &&\n        this.props.copy.indexOf(\"<br\") === -1\n      ) {\n        return \"page-lead lead\"\n      }\n    }\n\n    return \"page-lead\"\n  }\n\n  render() {\n    if (this.props.copy && this.props.copy.length) {\n      return (\n        <div\n          className={this.getClassName()}\n          dangerouslySetInnerHTML={{\n            __html: this.props.copy,\n          }}\n        />\n      )\n    } else {\n      return null\n    }\n  }\n}\n","export default function (string, subString) {\n  string = (string + \"\").toLowerCase()\n  subString = (subString + \"\").toLowerCase()\n\n  if (subString.length <= 0) return 0\n\n  let n = 0\n  let pos = 0\n  let step = subString.length\n\n  while (true) {\n    pos = string.indexOf(subString, pos)\n    if (pos >= 0) {\n      n += 1\n      pos += step\n    } else {\n      break\n    }\n  }\n\n  return n\n}\n","import React from \"react\"\nimport UsersList from \"../../users-list\"\n\nconst RankUsersList = ({ users }) => (\n  <UsersList cols={4} isReady={true} showStatus={true} users={users} />\n)\n\nexport default RankUsersList\n","import React from \"react\"\nimport UsersList from \"misago/components/users-list\"\n\nclass RankUsersListLoader extends React.Component {\n  shouldComponentUpdate() {\n    return false\n  }\n\n  render = () => <UsersList cols={4} isReady={false} />\n}\n\nexport default RankUsersListLoader\n","import React from \"react\"\n\nconst RankUsersLeft = ({ users }) => {\n  if (users.more) {\n    return (\n      <p>\n        {interpolate(\n          npgettext(\n            \"rank users list\",\n            \"There is %(more)s more user with this rank.\",\n            \"There are %(more)s more users with this rank.\",\n            users.more\n          ),\n          { more: users.more },\n          true\n        )}\n      </p>\n    )\n  }\n\n  return (\n    <p>\n      {pgettext(\n        \"rank users list empty\",\n        \"There are no more users with this rank.\"\n      )}\n    </p>\n  )\n}\n\nexport default RankUsersLeft\n","import React from \"react\"\nimport { Link } from \"react-router\"\n\nconst RankUsersPagination = ({ baseUrl, users }) => (\n  <div className=\"misago-pagination\">\n    {users.isLoaded && users.first ? (\n      <Link\n        className=\"btn btn-default btn-outline btn-icon\"\n        to={baseUrl}\n        title={pgettext(\"rank users list paginator\", \"Go to first page\")}\n      >\n        <span className=\"material-icon\">first_page</span>\n      </Link>\n    ) : (\n      <button\n        className=\"btn btn-default btn-outline btn-icon\"\n        title={pgettext(\"rank users list paginator\", \"Go to first page\")}\n        type=\"button\"\n        disabled\n      >\n        <span className=\"material-icon\">first_page</span>\n      </button>\n    )}\n    {users.isLoaded && users.previous ? (\n      <Link\n        className=\"btn btn-default btn-outline btn-icon\"\n        to={baseUrl + (users.previous > 1 ? users.previous + \"/\" : \"\")}\n        title={pgettext(\"rank users list paginator\", \"Go to previous page\")}\n      >\n        <span className=\"material-icon\">chevron_left</span>\n      </Link>\n    ) : (\n      <button\n        className=\"btn btn-default btn-outline btn-icon\"\n        title={pgettext(\"rank users list paginator\", \"Go to previous page\")}\n        type=\"button\"\n        disabled\n      >\n        <span className=\"material-icon\">chevron_left</span>\n      </button>\n    )}\n    {users.isLoaded && users.next ? (\n      <Link\n        className=\"btn btn-default btn-outline btn-icon\"\n        to={baseUrl + users.next + \"/\"}\n        title={pgettext(\"rank users list paginator\", \"Go to next page\")}\n      >\n        <span className=\"material-icon\">chevron_right</span>\n      </Link>\n    ) : (\n      <button\n        className=\"btn btn-default btn-outline btn-icon\"\n        title={pgettext(\"rank users list paginator\", \"Go to next page\")}\n        type=\"button\"\n        disabled\n      >\n        <span className=\"material-icon\">chevron_right</span>\n      </button>\n    )}\n    {users.isLoaded && users.last ? (\n      <Link\n        className=\"btn btn-default btn-outline btn-icon\"\n        to={baseUrl + users.last + \"/\"}\n        title={pgettext(\"rank users list paginator\", \"Go to last page\")}\n      >\n        <span className=\"material-icon\">last_page</span>\n      </Link>\n    ) : (\n      <button\n        className=\"btn btn-default btn-outline btn-icon\"\n        title={pgettext(\"rank users list paginator\", \"Go to last page\")}\n        type=\"button\"\n        disabled\n      >\n        <span className=\"material-icon\">last_page</span>\n      </button>\n    )}\n  </div>\n)\n\nexport default RankUsersPagination\n","import React from \"react\"\nimport { Toolbar, ToolbarItem, ToolbarSection } from \"../../Toolbar\"\nimport RankUsersLeft from \"./RankUsersLeft\"\nimport RankUsersPagination from \"./RankUsersPagination\"\n\nconst RankUsersToolbar = ({ baseUrl, users }) => (\n  <Toolbar>\n    <ToolbarSection>\n      <ToolbarItem>\n        <RankUsersPagination baseUrl={baseUrl} users={users} />\n      </ToolbarItem>\n    </ToolbarSection>\n    <ToolbarSection auto>\n      <ToolbarItem>\n        <RankUsersLeft users={users} />\n      </ToolbarItem>\n    </ToolbarSection>\n  </Toolbar>\n)\n\nexport default RankUsersToolbar\n","import React from \"react\"\nimport PageLead from \"misago/components/page-lead\"\nimport misago from \"misago/index\"\nimport { hydrate } from \"misago/reducers/users\"\nimport polls from \"misago/services/polls\"\nimport store from \"misago/services/store\"\nimport title from \"misago/services/page-title\"\nimport PageContainer from \"../../PageContainer\"\nimport RankUsersList from \"./RankUsersList\"\nimport RankUsersListLoader from \"./RankUsersListLoader\"\nimport RankUsersToolbar from \"./RankUsersToolbar\"\nimport UsersNav from \"../UsersNav\"\n\nexport default class extends React.Component {\n  constructor(props) {\n    super(props)\n\n    if (misago.has(\"USERS\")) {\n      this.initWithPreloadedData(misago.pop(\"USERS\"))\n    } else {\n      this.initWithoutPreloadedData()\n    }\n\n    this.startPolling(props.params.page || 1)\n  }\n\n  initWithPreloadedData(data) {\n    this.state = Object.assign(data, {\n      isLoaded: true,\n    })\n    store.dispatch(hydrate(data.results))\n  }\n\n  initWithoutPreloadedData() {\n    this.state = {\n      isLoaded: false,\n    }\n  }\n\n  startPolling(page) {\n    polls.start({\n      poll: \"rank-users\",\n      url: misago.get(\"USERS_API\"),\n      data: {\n        rank: this.props.route.rank.id,\n        page: page,\n      },\n      frequency: 90 * 1000,\n      update: this.update,\n    })\n  }\n\n  update = (data) => {\n    store.dispatch(hydrate(data.results))\n\n    data.isLoaded = true\n    this.setState(data)\n  }\n\n  componentDidMount() {\n    title.set({\n      title: this.props.route.rank.name,\n      page: this.props.params.page || null,\n      parent: pgettext(\"users page title\", \"Users\"),\n    })\n  }\n\n  componentWillUnmount() {\n    polls.stop(\"rank-users\")\n  }\n\n  componentWillReceiveProps(nextProps) {\n    if (this.props.params.page !== nextProps.params.page) {\n      title.set({\n        title: this.props.route.rank.name,\n        page: nextProps.params.page || null,\n        parent: pgettext(\"users page title\", \"Users\"),\n      })\n\n      this.setState({\n        isLoaded: false,\n      })\n\n      polls.stop(\"rank-users\")\n      this.startPolling(nextProps.params.page)\n    }\n  }\n\n  getClassName() {\n    if (this.props.route.rank.css_class) {\n      return \"rank-users-list rank-users-\" + this.props.route.rank.css_class\n    } else {\n      return \"rank-users-list\"\n    }\n  }\n\n  getRankDescription() {\n    if (this.props.route.rank.description) {\n      return (\n        <div className=\"rank-description\">\n          <PageLead copy={this.props.route.rank.description.html} />\n        </div>\n      )\n    } else {\n      return null\n    }\n  }\n\n  getComponent() {\n    if (this.state.isLoaded) {\n      if (this.state.count > 0) {\n        return <RankUsersList users={this.props.users} />\n      } else {\n        return (\n          <p className=\"lead\">\n            {pgettext(\n              \"rank users list\",\n              \"There are no users with this rank at the moment.\"\n            )}\n          </p>\n        )\n      }\n    } else {\n      return <RankUsersListLoader />\n    }\n  }\n\n  render() {\n    return (\n      <div className={this.getClassName()}>\n        <PageContainer>\n          <UsersNav\n            baseUrl={misago.get(\"USERS_LIST_URL\")}\n            page={{ name: this.props.route.rank.name }}\n            pages={misago.get(\"USERS_LISTS\")}\n          />\n          {this.getRankDescription()}\n          {this.getComponent()}\n          <RankUsersToolbar\n            baseUrl={\n              misago.get(\"USERS_LIST_URL\") + this.props.route.rank.slug + \"/\"\n            }\n            users={this.state}\n          />\n        </PageContainer>\n      </div>\n    )\n  }\n}\n","import React from \"react\"\nimport { connect } from \"react-redux\"\nimport ActivePosters from \"misago/components/users/active-posters/root\"\nimport Rank from \"misago/components/users/rank/root\"\nimport WithDropdown from \"misago/components/with-dropdown\"\nimport misago from \"misago/index\"\nimport {\n  PageHeader,\n  PageHeaderBanner,\n  PageHeaderContainer,\n} from \"../PageHeader\"\n\nexport default class extends WithDropdown {\n  render() {\n    return (\n      <div className=\"page page-users-lists\">\n        <PageHeaderContainer>\n          <PageHeader styleName=\"users-lists\">\n            <PageHeaderBanner styleName=\"users-lists\">\n              <h1>{pgettext(\"users page title\", \"Users\")}</h1>\n            </PageHeaderBanner>\n          </PageHeader>\n        </PageHeaderContainer>\n        {this.props.children}\n      </div>\n    )\n  }\n}\n\nexport function select(store) {\n  return {\n    tick: store.tick.tick,\n    user: store.auth.user,\n    users: store.users,\n  }\n}\n\nexport function paths() {\n  let paths = []\n\n  misago.get(\"USERS_LISTS\").forEach(function (item) {\n    if (item.component === \"rank\") {\n      paths.push({\n        path: misago.get(\"USERS_LIST_URL\") + item.slug + \"/:page/\",\n        component: connect(select)(Rank),\n        rank: item,\n      })\n      paths.push({\n        path: misago.get(\"USERS_LIST_URL\") + item.slug + \"/\",\n        component: connect(select)(Rank),\n        rank: item,\n      })\n    } else if (item.component === \"active-posters\") {\n      paths.push({\n        path: misago.get(\"USERS_LIST_URL\") + item.component + \"/\",\n        component: connect(select)(ActivePosters),\n        extra: {\n          name: item.name,\n        },\n      })\n    }\n  })\n\n  return paths\n}\n","import Users, { paths } from \"misago/components/users/root\"\nimport misago from \"misago/index\"\nimport mount from \"misago/utils/routed-component\"\n\nexport default function initializer(context) {\n  if (context.has(\"USERS_LISTS\")) {\n    mount({\n      root: misago.get(\"USERS_LIST_URL\"),\n      component: Users,\n      paths: paths(),\n    })\n  }\n}\n\nmisago.addInitializer({\n  name: \"component:users\",\n  initializer: initializer,\n  after: \"store\",\n})\n","import misago from \"misago/index\"\nimport reducer, { initialState } from \"../../reducers/overlay\"\nimport store from \"../../services/store\"\n\nexport default function initializer(context) {\n  store.addReducer(\"overlay\", reducer, initialState)\n}\n\nmisago.addInitializer({\n  name: \"reducer:overlay\",\n  initializer: initializer,\n  before: \"store\",\n})\n","import React from \"react\"\nimport Loader from \"misago/components/loader\"\n\nexport default class extends React.Component {\n  render() {\n    return (\n      <div className=\"modal-body modal-loader\">\n        <Loader />\n      </div>\n    )\n  }\n}\n","import React from \"react\"\n\nexport default function (props) {\n  return (\n    <div className={props.className || \"loader\"}>\n      <div className=\"loader-spinning-wheel\" />\n    </div>\n  )\n}\n","export default function (list, rowWidth, padding = false) {\n  let rows = []\n  let row = []\n\n  list.forEach(function (element) {\n    row.push(element)\n    if (row.length === rowWidth) {\n      rows.push(row)\n      row = []\n    }\n  })\n\n  // pad row to required length?\n  if (padding !== false && row.length > 0 && row.length < rowWidth) {\n    for (let i = row.length; i < rowWidth; i++) {\n      row.push(padding)\n    }\n  }\n\n  if (row.length) {\n    rows.push(row)\n  }\n\n  return rows\n}\n","import moment from \"moment\"\nimport { REMOVE_POLL, REPLACE_POLL } from \"./poll\"\n\nexport const BUSY_THREAD = \"BUSY_THREAD\"\nexport const RELEASE_THREAD = \"RELEASE_THREAD\"\nexport const REPLACE_THREAD = \"REPLACE_THREAD\"\nexport const UPDATE_THREAD = \"UPDATE_THREAD\"\nexport const UPDATE_THREAD_ACL = \"UPDATE_THREAD_ACL\"\n\nexport function hydrate(json) {\n  return Object.assign({}, json, {\n    started_on: moment(json.started_on),\n    last_post_on: moment(json.last_post_on),\n    best_answer_marked_on: json.best_answer_marked_on\n      ? moment(json.best_answer_marked_on)\n      : null,\n\n    isBusy: false,\n  })\n}\n\nexport function busy() {\n  return {\n    type: BUSY_THREAD,\n  }\n}\n\nexport function release() {\n  return {\n    type: RELEASE_THREAD,\n  }\n}\n\nexport function replace(newState, hydrated = false) {\n  return {\n    type: REPLACE_THREAD,\n    state: hydrated ? newState : hydrate(newState),\n  }\n}\n\nexport function update(data) {\n  return {\n    type: UPDATE_THREAD,\n    data,\n  }\n}\n\nexport function updateAcl(data) {\n  return {\n    type: UPDATE_THREAD_ACL,\n    data,\n  }\n}\n\nexport default function thread(state = {}, action = null) {\n  switch (action.type) {\n    case BUSY_THREAD:\n      return Object.assign({}, state, { isBusy: true })\n\n    case RELEASE_THREAD:\n      return Object.assign({}, state, { isBusy: false })\n\n    case REMOVE_POLL:\n      return Object.assign({}, state, { poll: null })\n\n    case REPLACE_POLL:\n      return Object.assign({}, state, { poll: action.state })\n\n    case REPLACE_THREAD:\n      return action.state\n\n    case UPDATE_THREAD:\n      return Object.assign({}, state, action.data)\n\n    case UPDATE_THREAD_ACL:\n      const acl = Object.assign({}, state.acl, action.data)\n      return Object.assign({}, state, { acl })\n\n    default:\n      return state\n  }\n}\n","import { showSnackbar, hideSnackbar } from \"misago/reducers/snackbar\"\n\nconst HIDE_ANIMATION_LENGTH = 300\nconst MESSAGE_SHOW_LENGTH = 5000\n\nexport class Snackbar {\n  init(store) {\n    this._store = store\n    this._timeout = null\n  }\n\n  alert = (message, type) => {\n    if (this._timeout) {\n      window.clearTimeout(this._timeout)\n      this._store.dispatch(hideSnackbar())\n\n      this._timeout = window.setTimeout(() => {\n        this._timeout = null\n        this.alert(message, type)\n      }, HIDE_ANIMATION_LENGTH)\n    } else {\n      this._store.dispatch(showSnackbar(message, type))\n      this._timeout = window.setTimeout(() => {\n        this._store.dispatch(hideSnackbar())\n        this._timeout = null\n      }, MESSAGE_SHOW_LENGTH)\n    }\n  }\n\n  // shorthands for message types\n\n  info = (message) => {\n    this.alert(message, \"info\")\n  }\n\n  success = (message) => {\n    this.alert(message, \"success\")\n  }\n\n  warning = (message) => {\n    this.alert(message, \"warning\")\n  }\n\n  error = (message) => {\n    this.alert(message, \"error\")\n  }\n\n  // shorthand for api errors\n\n  apiError = (rejection) => {\n    let message = rejection.data ? rejection.data.detail : rejection.detail\n\n    if (!message) {\n      if (rejection.status === 0) {\n        message = pgettext(\"api error\", \"Could not connect to the site.\")\n      } else if (rejection.status === 404) {\n        message = pgettext(\"api error\", \"Action link is invalid.\")\n      } else {\n        message = pgettext(\"api error\", \"Unknown error has occurred.\")\n      }\n    }\n\n    if (rejection.status === 403 && message === \"Permission denied\") {\n      message = pgettext(\n        \"api error\",\n        \"You don't have permission to perform this action.\"\n      )\n    }\n\n    this.error(message)\n  }\n}\n\nexport default new Snackbar()\n","import React from \"react\"\nimport misago from \"misago\"\n\nexport default function (props) {\n  const size = props.size || 100\n  const size2x = props.size2x || size * 2\n\n  return (\n    <img\n      alt=\"\"\n      className={props.className || \"user-avatar\"}\n      src={getSrc(props.user, size)}\n      srcSet={getSrc(props.user, size2x)}\n      width={props.height || size}\n      height={props.height || size}\n    />\n  )\n}\n\nexport function getSrc(user, size) {\n  if (user && user.id) {\n    // just avatar hash, size and user id\n    return resolveAvatarForSize(user.avatars, size).url\n  } else {\n    // just append avatar size to file to produce no-avatar placeholder\n    return misago.get(\"BLANK_AVATAR_URL\")\n  }\n}\n\nexport function resolveAvatarForSize(avatars, size) {\n  let avatar = avatars[0]\n  avatars.forEach((av) => {\n    if (av.size >= size) {\n      avatar = av\n    }\n  })\n  return avatar\n}\n","import misago from \"misago/index\"\nimport reducer from \"misago/reducers/participants\"\nimport store from \"misago/services/store\"\n\nexport default function initializer() {\n  let initialState = null\n  if (misago.has(\"THREAD\")) {\n    initialState = misago.get(\"THREAD\").participants\n  }\n\n  store.addReducer(\"participants\", reducer, initialState || [])\n}\n\nmisago.addInitializer({\n  name: \"reducer:participants\",\n  initializer: initializer,\n  before: \"store\",\n})\n","export const REPLACE_SEARCH = \"REPLACE_SEARCH\"\nexport const UPDATE_SEARCH = \"UPDATE_SEARCH\"\nexport const UPDATE_SEARCH_PROVIDER = \"UPDATE_SEARCH_PROVIDER\"\n\nexport const initialState = {\n  isLoading: false,\n  query: \"\",\n  providers: [],\n}\n\nexport function replace(newState) {\n  return {\n    type: REPLACE_SEARCH,\n    state: {\n      isLoading: false,\n      providers: newState,\n    },\n  }\n}\n\nexport function update(newState) {\n  return {\n    type: UPDATE_SEARCH,\n    update: newState,\n  }\n}\n\nexport function updateProvider(provider) {\n  return {\n    type: UPDATE_SEARCH_PROVIDER,\n    provider: provider,\n  }\n}\n\nexport default function participants(state = {}, action = null) {\n  switch (action.type) {\n    case REPLACE_SEARCH:\n      return action.state\n\n    case UPDATE_SEARCH:\n      return Object.assign({}, state, action.update)\n\n    case UPDATE_SEARCH_PROVIDER:\n      return Object.assign({}, state, {\n        providers: state.providers.map((provider) => {\n          if (provider.id === action.provider.id) {\n            return action.provider\n          } else {\n            return provider\n          }\n        }),\n      })\n\n    default:\n      return state\n  }\n}\n","export function int(min, max) {\n  return Math.floor(Math.random() * (max - min + 1)) + min\n}\n\nexport function range(min, max) {\n  let array = new Array(int(min, max))\n  for (let i = 0; i < array.length; i++) {\n    array[i] = i\n  }\n\n  return array\n}\n","import React from \"react\"\nimport PanelMessage from \"misago/components/panel-message\"\n\nexport default class extends PanelMessage {\n  getHelpText() {\n    if (this.props.helpText) {\n      return <p className=\"help-block\">{this.props.helpText}</p>\n    } else {\n      return null\n    }\n  }\n\n  render() {\n    return (\n      <div className=\"modal-body\">\n        <div className=\"message-icon\">\n          <span className=\"material-icon\">\n            {this.props.icon || \"info_outline\"}\n          </span>\n        </div>\n        <div className=\"message-body\">\n          <p className=\"lead\">{this.props.message}</p>\n          {this.getHelpText()}\n          <button\n            className=\"btn btn-default\"\n            data-dismiss=\"modal\"\n            type=\"button\"\n          >\n            {pgettext(\"modal message dismiss btn\", \"Ok\")}\n          </button>\n        </div>\n      </div>\n    )\n  }\n}\n","import React from \"react\"\nimport posting from \"../../services/posting\"\nimport { getGlobalState, getQuoteMarkup } from \"../posting\"\n\nexport default class PostingQuoteSelection extends React.Component {\n  constructor(props) {\n    super(props)\n\n    this.state = {\n      range: null,\n      rect: null,\n    }\n\n    this.element = null\n  }\n\n  selected = () => {\n    if (this.element) {\n      const range = getQuoteSelection(this.element) || null\n      const rect = range ? range.getBoundingClientRect() : null\n\n      this.setState({ range, rect })\n    }\n  }\n\n  reply = () => {\n    if (!posting.isOpen()) {\n      const content = getQuoteMarkup(this.state.range)\n      posting.open(Object.assign({}, this.props.posting, { default: content }))\n\n      this.setState({ range: null, rect: null })\n\n      window.setTimeout(focusEditor, 1000)\n    } else {\n      const globalState = getGlobalState()\n      if (globalState && !globalState.disabled) {\n        globalState.quote(getQuoteMarkup(this.state.range))\n        this.setState({ range: null, rect: null })\n        focusEditor()\n      }\n    }\n  }\n\n  render = () => (\n    <div>\n      <div\n        ref={(element) => {\n          if (element) {\n            this.element = element\n          }\n        }}\n        onMouseUp={this.selected}\n        onTouchEnd={this.selected}\n      >\n        {this.props.children}\n      </div>\n      {!!this.state.rect && (\n        <div\n          className=\"quote-control\"\n          style={{\n            position: \"absolute\",\n            left: this.state.rect.left + window.scrollX,\n            top: this.state.rect.bottom + window.scrollY,\n          }}\n        >\n          <div className=\"quote-control-arrow\" />\n          <div className=\"quote-control-inner\">\n            <button\n              className=\"btn quote-control-btn\"\n              type=\"button\"\n              onClick={this.reply}\n            >\n              {pgettext(\"post reply\", \"Quote\")}\n            </button>\n          </div>\n        </div>\n      )}\n    </div>\n  )\n}\n\nfunction focusEditor() {\n  const textarea = document.querySelector(\"#posting-mount textarea\")\n  textarea.focus()\n  textarea.selectionStart = textarea.selectionEnd = textarea.value.length\n}\n\nconst getQuoteSelection = (container) => {\n  if (typeof window.getSelection === \"undefined\") return\n\n  // Validate that selection is of valid type and has one range\n  const selection = window.getSelection()\n  if (!selection) return\n  if (selection.type !== \"Range\") return\n  if (selection.rangeCount !== 1) return\n\n  // Validate that selection is within the container and post's article\n  const range = selection.getRangeAt(0)\n  if (!isRangeContained(range, container)) return\n  if (!isPostContained(range)) return\n  if (!isAnyTextSelected(range.cloneContents())) return\n\n  return range\n}\n\nconst isRangeContained = (range, container) => {\n  const node = range.commonAncestorContainer\n  if (node === container) return true\n\n  let p = node.parentNode\n  while (p) {\n    if (p === container) return true\n    p = p.parentNode\n  }\n\n  return false\n}\n\nconst isPostContained = (range) => {\n  const element = range.commonAncestorContainer\n  if (element.nodeName === \"ARTICLE\") return true\n  if (element.dataset && element.dataset.noquote === \"1\") return false\n  let p = element.parentNode\n  while (p) {\n    if (p.dataset && p.dataset.noquote === \"1\") return false\n    if (p.nodeName === \"ARTICLE\") return true\n    p = p.parentNode\n  }\n  return false\n}\n\nconst isAnyTextSelected = (node) => {\n  for (let i = 0; i < node.childNodes.length; i++) {\n    const child = node.childNodes[i]\n    if (child.nodeType === Node.TEXT_NODE) {\n      if (child.textContent && child.textContent.trim().length > 0) return true\n    }\n    if (child.nodeName === \"IMG\") return true\n    if (isAnyTextSelected(child)) return true\n  }\n\n  return false\n}\n","const getQuoteMarkup = (range) => {\n  const metadata = getQuoteMetadata(range)\n  let markup = convertNodesToMarkup(range.cloneContents().childNodes, [])\n  let prefix = metadata ? `[quote=\"${metadata}\"]\\n` : \"[quote]\\n\"\n  let suffix = \"\\n[/quote]\\n\\n\"\n\n  const codeBlock = getQuoteCodeBlock(range)\n  if (codeBlock) {\n    prefix += codeBlock.syntax ? `[code=${codeBlock.syntax}]\\n` : \"[code]\\n\"\n    suffix = \"\\n[/code]\" + suffix\n  } else if (isNodeInlineCodeBlock(range)) {\n    markup = markup.trim()\n    prefix += \"`\"\n    suffix = \"`\" + suffix\n  } else {\n    markup = markup.trim()\n  }\n\n  return prefix + markup + suffix\n}\n\nexport default getQuoteMarkup\n\nconst getQuoteMetadata = (range) => {\n  const node = range.commonAncestorContainer\n  if (isNodeElementWithQuoteMetadata(node)) {\n    return getQuoteMetadataFromNode(node)\n  }\n\n  let p = node.parentNode\n  while (p) {\n    if (isNodeElementWithQuoteMetadata(p)) {\n      return getQuoteMetadataFromNode(p)\n    }\n    p = p.parentNode\n  }\n\n  return \"\"\n}\n\nconst isNodeElementWithQuoteMetadata = (node) => {\n  if (node.nodeType !== Node.ELEMENT_NODE) return false\n  if (node.nodeName === \"ARTICLE\") return true\n  if (node.nodeName === \"BLOCKQUOTE\") {\n    return node.dataset && node.dataset.block === \"quote\"\n  }\n\n  return false\n}\n\nconst getQuoteMetadataFromNode = (element) => {\n  if (element.dataset) {\n    return element.dataset.author || null\n  }\n  return null\n}\n\nconst getQuoteCodeBlock = (range) => {\n  const node = range.commonAncestorContainer\n  if (isNodeCodeBlock(node)) {\n    return getNodeCodeBlockMeta(node)\n  }\n\n  let p = node.parentNode\n  while (p) {\n    if (isNodeCodeBlock(p)) {\n      return getNodeCodeBlockMeta(p)\n    }\n    p = p.parentNode\n  }\n\n  return null\n}\n\nconst isNodeCodeBlock = (node) => {\n  return node.nodeName === \"PRE\"\n}\n\nconst isNodeInlineCodeBlock = (range) => {\n  const node = range.commonAncestorContainer\n  if (node.nodeName === \"CODE\") {\n    return true\n  }\n\n  let p = node.parentNode\n  while (p) {\n    if (isNodeElementWithQuoteMetadata(p)) {\n      return false\n    }\n\n    if (p.nodeName === \"CODE\") {\n      return true\n    }\n\n    p = p.parentNode\n  }\n\n  return false\n}\n\nconst getNodeCodeBlockMeta = (node) => {\n  if (!node.dataset) {\n    return { syntax: null }\n  }\n\n  return { syntax: node.dataset.syntax || null }\n}\n\nconst convertNodesToMarkup = (nodes, stack) => {\n  let markup = \"\"\n  for (let i = 0; i < nodes.length; i++) {\n    const node = nodes[i]\n    markup += convertNodeToMarkup(node, stack)\n  }\n  return markup\n}\n\nconst SIMPLE_NODE_MAPPINGS = {\n  H1: [\"\\n\\n# \", \"\"],\n  H2: [\"\\n\\n## \", \"\"],\n  H3: [\"\\n\\n### \", \"\"],\n  H4: [\"\\n\\n#### \", \"\"],\n  H5: [\"\\n\\n##### \", \"\"],\n  H6: [\"\\n\\n###### \", \"\"],\n  STRONG: [\"**\", \"**\"],\n  EM: [\"*\", \"*\"],\n  DEL: [\"~~\", \"~~\"],\n  B: [\"[b]\", \"[/b]\"],\n  U: [\"[u]\", \"[/u]\"],\n  I: [\"[i]\", \"[/i]\"],\n  SUB: [\"[sub]\", \"[/sub]\"],\n  SUP: [\"[sup]\", \"[/sup]\"],\n}\n\nconst convertNodeToMarkup = (node, stack) => {\n  const dataset = node.dataset || {}\n\n  if (node.nodeType === Node.TEXT_NODE) {\n    return node.textContent || \"\"\n  }\n\n  if (node.nodeType === Node.ELEMENT_NODE) {\n    if (dataset.quote) {\n      return dataset.quote || \"\"\n    }\n    if (dataset.noquote === \"1\") return \"\"\n  }\n\n  if (\n    node.nodeType === Node.ELEMENT_NODE &&\n    dataset.quote &&\n    dataset.quote.trim()\n  ) {\n    return \"\"\n  }\n\n  if (node.nodeName === \"HR\") {\n    return \"\\n\\n- - -\"\n  }\n\n  if (SIMPLE_NODE_MAPPINGS[node.nodeName]) {\n    const [prefix, suffix] = SIMPLE_NODE_MAPPINGS[node.nodeName]\n    return (\n      prefix +\n      convertNodesToMarkup(node.childNodes, [...stack, node.nodeName]) +\n      suffix\n    )\n  }\n\n  if (node.nodeName === \"A\") {\n    const href = node.href\n    const text = convertNodesToMarkup(node.childNodes, [\n      ...stack,\n      node.nodeName,\n    ])\n    if (text) {\n      return `[${text}](${href})`\n    } else {\n      return `!(${href})`\n    }\n  }\n\n  if (node.nodeName === \"IMG\") {\n    const src = node.src\n    const alt = node.alt\n    if (alt) {\n      return `![${alt}](${src})`\n    } else {\n      return `!(${src})`\n    }\n  }\n\n  if (node.nodeName === \"DIV\" || node.nodeName === \"ASIDE\") {\n    const block = dataset.block && dataset.block.toUpperCase()\n    if (block && SIMPLE_NODE_MAPPINGS[block]) {\n      const [prefix, suffix] = SIMPLE_NODE_MAPPINGS[block]\n      return (\n        prefix +\n        convertNodesToMarkup(node.childNodes, [...stack, block]) +\n        suffix\n      )\n    } else {\n      return convertNodesToMarkup(node.childNodes, stack)\n    }\n  }\n\n  if (node.nodeName === \"BLOCKQUOTE\") {\n    if (dataset.block === \"spoiler\") {\n      const content = convertNodesToMarkup(node.childNodes, [\n        ...stack,\n        \"SPOILER\",\n      ]).trim()\n\n      if (!content) return \"\"\n\n      let markup = \"\\n[spoiler]\\n\"\n      markup += content\n      markup += \"\\n[/spoiler]\"\n      return markup\n    }\n\n    const content = convertNodesToMarkup(node.childNodes, [\n      ...stack,\n      \"QUOTE\",\n    ]).trim()\n\n    if (!content) return \"\"\n\n    const metadata = getQuoteMetadataFromNode(node)\n    let markup = metadata ? `\\n[quote=${metadata}]\\n` : \"\\n\\n[quote]\\n\"\n    markup += content\n    markup += \"\\n[/quote]\"\n    return markup\n  }\n\n  if (node.nodeName === \"PRE\") {\n    const syntax = dataset.syntax || null\n    const code = node.querySelector(\"code\")\n    const content = code ? code.innerText || \"\" : \"\"\n\n    if (!content.trim()) return \"\"\n\n    return \"\\n[code\" + (syntax ? \"=\" + syntax : \"\") + \"]\" + content + \"[/code]\"\n  }\n\n  if (node.nodeName === \"CODE\") {\n    return \"`\" + node.innerText + \"`\"\n  }\n\n  if (node.nodeName === \"P\") {\n    return (\n      \"\\n\" + convertNodesToMarkup(node.childNodes, [...stack, node.nodeName])\n    )\n  }\n\n  if (node.nodeName === \"UL\" || node.nodeName === \"OL\") {\n    const level = stack.filter((item) => item === \"OL\" || item === \"UL\").length\n    const prefix = level === 0 ? \"\\n\" : \"\"\n    return (\n      prefix + convertNodesToMarkup(node.childNodes, [...stack, node.nodeName])\n    )\n  }\n\n  if (node.nodeName === \"LI\") {\n    let prefix = \"\"\n    const level = stack.filter((item) => item === \"OL\" || item === \"UL\").length\n    for (let i = 1; i < level; i++) {\n      prefix += \"    \"\n    }\n\n    const ordered = stack[stack.length - 1] === \"OL\"\n    if (ordered) {\n      prefix += dataset.index ? dataset.index + \". \" : \"1. \"\n    } else {\n      prefix += \"- \"\n    }\n\n    const content = convertNodesToMarkup(node.childNodes, [\n      ...stack,\n      node.nodeName,\n    ])\n    if (!content.trim()) return \"\"\n\n    return \"\\n\" + prefix + content\n  }\n\n  if (node.nodeName === \"SPAN\") {\n    return convertNodesToMarkup(node.childNodes, stack)\n  }\n\n  return \"\"\n}\n","export function getGlobalState() {\n  return window.misagoReply\n}\n\nexport function setGlobalState(disabled, quote) {\n  window.misagoReply = { disabled, quote }\n}\n\nexport function clearGlobalState() {\n  window.misagoReply = null\n}\n","import moment from \"moment\"\n\nexport function clean(attachments) {\n  return attachments\n    .filter((attachment) => {\n      return attachment.id && !attachment.isRemoved\n    })\n    .map((a) => {\n      return a.id\n    })\n}\n\nexport function hydrate(attachments) {\n  return attachments.map((attachment) => {\n    return Object.assign({}, attachment, {\n      uploaded_on: moment(attachment.uploaded_on),\n    })\n  })\n}\n","import React from \"react\"\nimport formatFilesize from \"../../utils/file-size\"\n\nexport default function MarkupAttachmentModal({ attachment }) {\n  return (\n    <div className=\"modal-dialog modal-lg\" role=\"document\">\n      <div className=\"modal-content\">\n        <div className=\"modal-header\">\n          <button\n            aria-label={pgettext(\"modal\", \"Close\")}\n            className=\"close\"\n            data-dismiss=\"modal\"\n            type=\"button\"\n          >\n            <span aria-hidden=\"true\">&times;</span>\n          </button>\n          <h4 className=\"modal-title\">\n            {pgettext(\"markup editor\", \"Attachment details\")}\n          </h4>\n        </div>\n        <div className=\"modal-body\">\n          {!!attachment.is_image && (\n            <div className=\"markup-editor-attachment-modal-preview\">\n              <a href={attachment.url.index + \"?shva=1\"} target=\"_blank\">\n                <img src={attachment.url.index + \"?shva=1\"} alt=\"\" />\n              </a>\n            </div>\n          )}\n          <div className=\"markup-editor-attachment-modal-filename\">\n            {attachment.filename}\n          </div>\n          <div className=\"row markup-editor-attachment-modal-details\">\n            <div className=\"col-xs-12 col-md-3\">\n              <strong>\n                {attachment.filetype + \", \" + formatFilesize(attachment.size)}\n              </strong>\n              <div className=\"text-muted\">\n                <small>{pgettext(\"markup editor\", \"Type and size\")}</small>\n              </div>\n            </div>\n            <div className=\"col-xs-12 col-md-4\">\n              <strong>\n                <abbr title={attachment.uploaded_on.format(\"LLL\")}>\n                  {attachment.uploaded_on.fromNow()}\n                </abbr>\n              </strong>\n              <div className=\"text-muted\">\n                <small>{pgettext(\"markup editor\", \"Uploaded at\")}</small>\n              </div>\n            </div>\n            <div className=\"col-xs-12 col-md-3\">\n              {attachment.url.uploader ? (\n                <a\n                  href={attachment.url.uploader}\n                  target=\"_blank\"\n                  className=\"item-title\"\n                >\n                  {attachment.uploader_name}\n                </a>\n              ) : (\n                <span className=\"item-title\">{attachment.uploader_name}</span>\n              )}\n              <div className=\"text-muted\">\n                <small>{pgettext(\"markup editor\", \"Uploader\")}</small>\n              </div>\n            </div>\n          </div>\n        </div>\n        <div className=\"modal-footer\">\n          <button\n            className=\"btn btn-default\"\n            data-dismiss=\"modal\"\n            type=\"button\"\n          >\n            {pgettext(\"modal\", \"Close\")}\n          </button>\n        </div>\n      </div>\n    </div>\n  )\n}\n","const wrapSelection = (selection, update, prefix, suffix, def) => {\n  const text = selection.text || def || \"\"\n  let newValue = selection.prefix\n  newValue += prefix + text + suffix\n  newValue += selection.suffix\n  update(newValue)\n\n  window.setTimeout(() => {\n    focus(selection.textarea)\n\n    const caret = selection.start + prefix.length\n    selection.textarea.setSelectionRange(caret, caret + text.length)\n  }, 250)\n}\n\nconst replaceSelection = (selection, update, text) => {\n  let newValue = selection.prefix\n  newValue += text\n  newValue += selection.suffix\n  update(newValue)\n\n  window.setTimeout(() => {\n    focus(selection.textarea)\n\n    const caret = selection.end + text.length\n    selection.textarea.setSelectionRange(caret, caret)\n  }, 250)\n}\n\nconst getSelection = (textarea) => {\n  if (document.selection) {\n    textarea.focus()\n    const range = document.selection.createRange()\n    const length = range.text.length\n    range.moveStart(\"character\", -textarea.value.length)\n    return createRange(textarea, range.text.length - length, range.text.length)\n  }\n\n  if (textarea.selectionStart || textarea.selectionStart == \"0\") {\n    return createRange(textarea, textarea.selectionStart, textarea.selectionEnd)\n  }\n}\n\nconst createRange = (textarea, start, end) => {\n  return {\n    textarea: textarea,\n    start: start,\n    end: end,\n    text: textarea.value.substring(start, end),\n    prefix: textarea.value.substring(0, start),\n    suffix: textarea.value.substring(end),\n  }\n}\n\nexport function focus(textarea) {\n  const scroll = textarea.scrollTop\n  textarea.focus()\n  textarea.scrollTop = scroll\n}\n\nexport { getSelection, replaceSelection, wrapSelection }\n","import React from \"react\"\nimport modal from \"../../services/modal\"\nimport snackbar from \"../../services/snackbar\"\nimport formatFilesize from \"../../utils/file-size\"\nimport MarkupAttachmentModal from \"./MarkupAttachmentModal\"\nimport { getSelection, replaceSelection } from \"./operations\"\n\nconst MarkupEditorAttachment = ({\n  attachment,\n  disabled,\n  element,\n  setState,\n  update,\n}) => (\n  <div className=\"markup-editor-attachments-item\">\n    <div className=\"markup-editor-attachment\">\n      <div className=\"markup-editor-attachment-details\">\n        {attachment.id ? (\n          <a\n            className=\"item-title\"\n            href={attachment.url.index + \"?shva=1\"}\n            target=\"_blank\"\n            onClick={(event) => {\n              event.preventDefault()\n              modal.show(<MarkupAttachmentModal attachment={attachment} />)\n            }}\n          >\n            {attachment.filename}\n          </a>\n        ) : (\n          <strong className=\"item-title\">{attachment.filename}</strong>\n        )}\n        <div className=\"text-muted\">\n          <ul className=\"list-unstyled list-inline\">\n            {!attachment.id && <li>{attachment.progress + \"%\"}</li>}\n            {!!attachment.filetype && <li>{attachment.filetype}</li>}\n            {attachment.size > 0 && <li>{formatFilesize(attachment.size)}</li>}\n          </ul>\n        </div>\n      </div>\n      {!!attachment.id && (\n        <div className=\"markup-editor-attachment-buttons\">\n          <button\n            className=\"btn btn-markup-editor-attachment btn-icon\"\n            title={pgettext(\"markup editor\", \"Insert into message\")}\n            type=\"button\"\n            disabled={disabled}\n            onClick={() => {\n              const markup = getAttachmentMarkup(attachment)\n              const selection = getSelection(element)\n              replaceSelection(selection, update, markup)\n            }}\n          >\n            <span className=\"material-icon\">flip_to_front</span>\n          </button>\n          <button\n            className=\"btn btn-markup-editor-attachment btn-icon\"\n            title={pgettext(\"markup editor\", \"Remove attachment\")}\n            type=\"button\"\n            disabled={disabled}\n            onClick={() => {\n              setState(({ attachments }) => {\n                const confirm = window.confirm(\n                  pgettext(\"markup editor\", \"Remove this attachment?\")\n                )\n\n                if (confirm) {\n                  return {\n                    attachments: attachments.filter(\n                      ({ id }) => id !== attachment.id\n                    ),\n                  }\n                }\n              })\n            }}\n          >\n            <span className=\"material-icon\">close</span>\n          </button>\n        </div>\n      )}\n      {!attachment.id && !!attachment.key && (\n        <div className=\"markup-editor-attachment-buttons\">\n          {attachment.error && (\n            <button\n              className=\"btn btn-markup-editor-attachment btn-icon\"\n              title={pgettext(\"markup editor\", \"See error\")}\n              type=\"button\"\n              onClick={() => {\n                snackbar.error(\n                  interpolate(\n                    pgettext(\"markup editor\", \"%(filename)s: %(error)s\"),\n                    { filename: attachment.filename, error: attachment.error },\n                    true\n                  )\n                )\n              }}\n            >\n              <span className=\"material-icon\">warning</span>\n            </button>\n          )}\n          <button\n            className=\"btn btn-markup-editor-attachment btn-icon\"\n            title={pgettext(\"markup editor\", \"Remove attachment\")}\n            type=\"button\"\n            disabled={disabled}\n            onClick={() => {\n              setState(({ attachments }) => {\n                return {\n                  attachments: attachments.filter(\n                    ({ key }) => key !== attachment.key\n                  ),\n                }\n              })\n            }}\n          >\n            <span className=\"material-icon\">close</span>\n          </button>\n        </div>\n      )}\n    </div>\n  </div>\n)\n\nexport default MarkupEditorAttachment\n\nfunction getAttachmentMarkup(attachment) {\n  let markup = \"[\"\n\n  if (attachment.is_image) {\n    markup += \"![\" + attachment.filename + \"]\"\n    markup += \"(\" + (attachment.url.thumb || attachment.url.index) + \"?shva=1)\"\n  } else {\n    markup += attachment.filename\n  }\n\n  markup += \"](\" + attachment.url.index + \"?shva=1)\"\n  return markup\n}\n","import React from \"react\"\nimport MarkupEditorAttachment from \"./MarkupEditorAttachment\"\n\nconst MarkupEditorAttachments = ({\n  attachments,\n  disabled,\n  element,\n  setState,\n  update,\n}) => (\n  <div className=\"markup-editor-attachments\">\n    <div className=\"markup-editor-attachments-container\">\n      {attachments.map((attachment) => (\n        <MarkupEditorAttachment\n          key={attachment.key || attachment.id}\n          attachment={attachment}\n          disabled={disabled}\n          element={element}\n          setState={setState}\n          update={update}\n        />\n      ))}\n    </div>\n  </div>\n)\n\nexport default MarkupEditorAttachments\n","import React from \"react\"\nimport Button from \"../button\"\n\nconst MarkupEditorFooter = ({\n  canProtect,\n  disabled,\n  empty,\n  preview,\n  isProtected,\n  submitText,\n  showPreview,\n  closePreview,\n  enableProtection,\n  disableProtection,\n}) => (\n  <div className=\"markup-editor-footer\">\n    {!!canProtect && (\n      <Button\n        className=\"btn-default btn-icon hidden-sm hidden-md hidden-lg\"\n        title={\n          isProtected\n            ? pgettext(\"markup editor\", \"Protected\")\n            : pgettext(\"markup editor\", \"Protect\")\n        }\n        type=\"button\"\n        disabled={disabled}\n        onClick={() => {\n          if (isProtected) {\n            disableProtection()\n          } else {\n            enableProtection()\n          }\n        }}\n      >\n        <span className=\"material-icon\">\n          {isProtected ? \"lock\" : \"lock_open\"}\n        </span>\n      </Button>\n    )}\n    {!!canProtect && (\n      <div>\n        <Button\n          className=\"btn-default hidden-xs\"\n          type=\"button\"\n          disabled={disabled}\n          onClick={() => {\n            if (isProtected) {\n              disableProtection()\n            } else {\n              enableProtection()\n            }\n          }}\n        >\n          <span className=\"material-icon\">\n            {isProtected ? \"lock\" : \"lock_open\"}\n          </span>\n          {isProtected\n            ? pgettext(\"markup editor\", \"Protected\")\n            : pgettext(\"markup editor\", \"Protect\")}\n        </Button>\n      </div>\n    )}\n    <div className=\"markup-editor-spacer\" />\n    {preview ? (\n      <Button\n        className=\"btn-default btn-auto\"\n        type=\"button\"\n        onClick={closePreview}\n      >\n        {pgettext(\"markup editor\", \"Edit\")}\n      </Button>\n    ) : (\n      <Button\n        className=\"btn-default btn-auto\"\n        disabled={disabled || empty}\n        type=\"button\"\n        onClick={showPreview}\n      >\n        {pgettext(\"markup editor\", \"Preview\")}\n      </Button>\n    )}\n    <Button className=\"btn-primary btn-auto\" disabled={disabled || empty}>\n      {submitText || pgettext(\"markup editor\", \"Post\")}\n    </Button>\n  </div>\n)\n\nexport default MarkupEditorFooter\n","import React from \"react\"\nimport modal from \"../../services/modal\"\nimport FormGroup from \"../form-group\"\nimport { replaceSelection } from \"./operations\"\n\nclass MarkupCodeModal extends React.Component {\n  constructor(props) {\n    super(props)\n\n    this.state = {\n      error: null,\n      syntax: \"\",\n      text: props.selection.text,\n    }\n  }\n\n  handleSubmit = (ev) => {\n    ev.preventDefault()\n\n    const { selection, update } = this.props\n    const syntax = this.state.syntax.trim()\n    const text = this.state.text.trim()\n\n    if (text.length === 0) {\n      this.setState({ error: gettext(\"This field is required.\") })\n      return false\n    }\n\n    const prefix = selection.prefix.trim().length ? \"\\n\\n\" : \"\"\n\n    replaceSelection(\n      Object.assign({}, selection, { text }),\n      update,\n      prefix + \"```\" + syntax + \"\\n\" + text + \"\\n```\\n\\n\"\n    )\n\n    modal.hide()\n\n    return false\n  }\n\n  render() {\n    return (\n      <div className=\"modal-dialog modal-lg\" role=\"document\">\n        <div className=\"modal-content\">\n          <div className=\"modal-header\">\n            <button\n              aria-label={pgettext(\"modal\", \"Close\")}\n              className=\"close\"\n              data-dismiss=\"modal\"\n              type=\"button\"\n            >\n              <span aria-hidden=\"true\">&times;</span>\n            </button>\n            <h4 className=\"modal-title\">{pgettext(\"markup editor\", \"Code\")}</h4>\n          </div>\n          <form onSubmit={this.handleSubmit}>\n            <div className=\"modal-body\">\n              <FormGroup\n                for=\"markup_code_syntax\"\n                label={pgettext(\"markup editor\", \"Syntax highlighting\")}\n              >\n                <select\n                  id=\"markup_code_syntax\"\n                  className=\"form-control\"\n                  value={this.state.syntax}\n                  onChange={(event) =>\n                    this.setState({ syntax: event.target.value })\n                  }\n                >\n                  <option value=\"\">\n                    {pgettext(\"markup editor\", \"No syntax highlighting\")}\n                  </option>\n                  {LANGUAGES.map(({ value, name }) => (\n                    <option key={value} value={value}>\n                      {name}\n                    </option>\n                  ))}\n                </select>\n              </FormGroup>\n              <FormGroup\n                for=\"markup_code_text\"\n                label={pgettext(\"markup editor\", \"Code to insert\")}\n                validation={!!this.state.error ? [this.state.error] : undefined}\n              >\n                <textarea\n                  id=\"markup_code_text\"\n                  className=\"form-control\"\n                  rows=\"8\"\n                  value={this.state.text}\n                  onChange={(event) =>\n                    this.setState({ text: event.target.value })\n                  }\n                />\n              </FormGroup>\n            </div>\n            <div className=\"modal-footer\">\n              <button\n                className=\"btn btn-default\"\n                data-dismiss=\"modal\"\n                type=\"button\"\n              >\n                {pgettext(\"markup editor\", \"Cancel\")}\n              </button>\n              <button className=\"btn btn-primary\">\n                {pgettext(\"markup editor\", \"Insert code\")}\n              </button>\n            </div>\n          </form>\n        </div>\n      </div>\n    )\n  }\n}\n\nconst LANGUAGES = [\n  { value: \"bash\", name: \"Bash\" },\n  { value: \"c\", name: \"C\" },\n  { value: \"c#\", name: \"C#\" },\n  { value: \"c++\", name: \"C++\" },\n  { value: \"css\", name: \"CSS\" },\n  { value: \"diff\", name: \"Diff\" },\n  { value: \"go\", name: \"Go\" },\n  { value: \"graphql\", name: \"GraphQL\" },\n  { value: \"html,\", name: \"HTML\" },\n  { value: \"xml\", name: \"XML\" },\n  { value: \"json\", name: \"JSON\" },\n  { value: \"java\", name: \"Java\" },\n  { value: \"javascript\", name: \"JavaScript\" },\n  { value: \"kotlin\", name: \"Kotlin\" },\n  { value: \"less\", name: \"Less\" },\n  { value: \"lua\", name: \"Lua\" },\n  { value: \"makefile\", name: \"Makefile\" },\n  { value: \"markdown\", name: \"Markdown\" },\n  { value: \"objective-C\", name: \"Objective-C\" },\n  { value: \"php\", name: \"PHP\" },\n  { value: \"perl\", name: \"Perl\" },\n  { value: \"plain\", name: \"Plain\" },\n  { value: \"text\", name: \"text\" },\n  { value: \"python\", name: \"Python\" },\n  { value: \"repl\", name: \"REPL\" },\n  { value: \"r\", name: \"R\" },\n  { value: \"ruby\", name: \"Ruby\" },\n  { value: \"rust\", name: \"Rust\" },\n  { value: \"scss\", name: \"SCSS\" },\n  { value: \"sql\", name: \"SQL\" },\n  { value: \"shell\", name: \"Shell Session\" },\n  { value: \"swift\", name: \"Swift\" },\n  { value: \"toml\", name: \"TOML\" },\n  { value: \"ini\", name: \"INI\" },\n  { value: \"typescript\", name: \"TypeScript\" },\n  { value: \"visualbasic\", name: \"Visual Basic .NET\" },\n  { value: \"webassembly\", name: \"WebAssembly\" },\n  { value: \"yaml\", name: \"YAML\" },\n]\n\nexport default MarkupCodeModal\n","import React from \"react\"\nimport formatFilesize from \"../../utils/file-size\"\n\nexport default function MarkupFormattingHelpModal() {\n  return (\n    <div className=\"modal-dialog modal-lg\" role=\"document\">\n      <div className=\"modal-content\">\n        <div className=\"modal-header\">\n          <button\n            aria-label={pgettext(\"modal\", \"Close\")}\n            className=\"close\"\n            data-dismiss=\"modal\"\n            type=\"button\"\n          >\n            <span aria-hidden=\"true\">&times;</span>\n          </button>\n          <h4 className=\"modal-title\">\n            {pgettext(\"markup help\", \"Formatting help\")}\n          </h4>\n        </div>\n        <div className=\"modal-body formatting-help\">\n          <h4>{pgettext(\"markup help\", \"Emphasis text\")}</h4>\n          <ExampleFormatting\n            markup={pgettext(\"markup help\", \"_This text will have emphasis_\")}\n            result={\n              <p>\n                <em>\n                  {pgettext(\"markup help\", \"This text will have emphasis\")}\n                </em>\n              </p>\n            }\n          />\n\n          <hr />\n\n          <h4>{pgettext(\"markup help\", \"Bold text\")}</h4>\n          <ExampleFormatting\n            markup={pgettext(\"markup help\", \"**This text will be bold**\")}\n            result={\n              <p>\n                <strong>\n                  {pgettext(\"markup help\", \"This text will be bold\")}\n                </strong>\n              </p>\n            }\n          />\n\n          <hr />\n\n          <h4>{pgettext(\"markup help\", \"Removed text\")}</h4>\n          <ExampleFormatting\n            markup={pgettext(\"markup help\", \"~~This text will be removed~~\")}\n            result={\n              <p>\n                <del>\n                  {pgettext(\"markup help\", \"This text will be removed\")}\n                </del>\n              </p>\n            }\n          />\n\n          <hr />\n\n          <h4>{pgettext(\"markup help\", \"Bold text (BBCode)\")}</h4>\n          <ExampleFormatting\n            markup={pgettext(\"markup help\", \"[b]This text will be bold[/b]\")}\n            result={\n              <p>\n                <b>{pgettext(\"markup help\", \"This text will be bold\")}</b>\n              </p>\n            }\n          />\n\n          <hr />\n\n          <h4>{pgettext(\"markup help\", \"Underlined text (BBCode)\")}</h4>\n          <ExampleFormatting\n            markup={pgettext(\n              \"markup help\",\n              \"[u]This text will be underlined[/u]\"\n            )}\n            result={\n              <p>\n                <u>{pgettext(\"markup help\", \"This text will be underlined\")}</u>\n              </p>\n            }\n          />\n\n          <hr />\n\n          <h4>{pgettext(\"markup help\", \"Italics text (BBCode)\")}</h4>\n          <ExampleFormatting\n            markup={pgettext(\n              \"markup help\",\n              \"[i]This text will be in italics[/i]\"\n            )}\n            result={\n              <p>\n                <i>{pgettext(\"markup help\", \"This text will be in italics\")}</i>\n              </p>\n            }\n          />\n\n          <hr />\n\n          <h4>{pgettext(\"markup help\", \"Link\")}</h4>\n          <ExampleFormatting\n            markup=\"<http://example.com>\"\n            result={\n              <p>\n                <a href=\"#\">example.com</a>\n              </p>\n            }\n          />\n\n          <hr />\n\n          <h4>{pgettext(\"markup help\", \"Link with text\")}</h4>\n          <ExampleFormatting\n            markup={\n              \"[\" +\n              pgettext(\"markup help\", \"Link text\") +\n              \"](http://example.com)\"\n            }\n            result={\n              <p>\n                <a href=\"#\">{pgettext(\"markup help\", \"Link text\")}</a>\n              </p>\n            }\n          />\n\n          <hr />\n\n          <h4>{pgettext(\"markup help\", \"Link (BBCode)\")}</h4>\n          <ExampleFormatting\n            markup=\"[url]http://example.com[/url]\"\n            result={\n              <p>\n                <a href=\"#\">example.com</a>\n              </p>\n            }\n          />\n\n          <hr />\n\n          <h4>{pgettext(\"markup help\", \"Link with text (BBCode)\")}</h4>\n          <ExampleFormatting\n            markup={\n              \"[url=http://example.com]\" +\n              pgettext(\"markup help\", \"Link text\") +\n              \"[/url]\"\n            }\n            result={\n              <p>\n                <a href=\"#\">{pgettext(\"markup help\", \"Link text\")}</a>\n              </p>\n            }\n          />\n\n          <hr />\n\n          <h4>{pgettext(\"markup help\", \"Image\")}</h4>\n          <ExampleFormatting\n            markup=\"!(http://dummyimage.com/38/38)\"\n            result={\n              <p>\n                <img alt=\"\" src=\"http://dummyimage.com/38/38\" />\n              </p>\n            }\n          />\n\n          <hr />\n\n          <h4>{pgettext(\"markup help\", \"Image with alternate text\")}</h4>\n          <ExampleFormatting\n            markup={\n              \"![\" +\n              pgettext(\"markup help\", \"Image text\") +\n              \"](http://dummyimage.com/38/38)\"\n            }\n            result={\n              <p>\n                <img\n                  alt={pgettext(\"markup help\", \"Image text\")}\n                  src=\"http://dummyimage.com/38/38\"\n                />\n              </p>\n            }\n          />\n\n          <hr />\n\n          <h4>{pgettext(\"markup help\", \"Image (BBCode)\")}</h4>\n          <ExampleFormatting\n            markup=\"[img]http://dummyimage.com/38/38[/img]\"\n            result={\n              <p>\n                <img alt=\"\" src=\"http://dummyimage.com/38/38\" />\n              </p>\n            }\n          />\n\n          <hr />\n\n          <h4>{pgettext(\"markup help\", \"Mention user by their name\")}</h4>\n          <ExampleFormatting\n            markup=\"@username\"\n            result={\n              <p>\n                <a href=\"#\">@username</a>\n              </p>\n            }\n          />\n\n          <hr />\n\n          <h4>{pgettext(\"markup help\", \"Heading 1\")}</h4>\n          <ExampleFormatting\n            markup={pgettext(\"markup help\", \"# First level heading\")}\n            result={<h1>{pgettext(\"markup help\", \"First level heading\")}</h1>}\n          />\n\n          <hr />\n\n          <h4>{pgettext(\"markup help\", \"Heading 2\")}</h4>\n          <ExampleFormatting\n            markup={pgettext(\"markup help\", \"## Second level heading\")}\n            result={<h2>{pgettext(\"markup help\", \"Second level heading\")}</h2>}\n          />\n\n          <hr />\n\n          <h4>{pgettext(\"markup help\", \"Heading 3\")}</h4>\n          <ExampleFormatting\n            markup={pgettext(\"markup help\", \"### Third level heading\")}\n            result={<h3>{pgettext(\"markup help\", \"Third level heading\")}</h3>}\n          />\n\n          <hr />\n\n          <h4>{pgettext(\"markup help\", \"Heading 4\")}</h4>\n          <ExampleFormatting\n            markup={pgettext(\"markup help\", \"#### Fourth level heading\")}\n            result={<h4>{pgettext(\"markup help\", \"Fourth level heading\")}</h4>}\n          />\n\n          <hr />\n\n          <h4>{pgettext(\"markup help\", \"Heading 5\")}</h4>\n          <ExampleFormatting\n            markup={pgettext(\"markup help\", \"##### Fifth level heading\")}\n            result={<h5>{pgettext(\"markup help\", \"Fifth level heading\")}</h5>}\n          />\n\n          <hr />\n\n          <h4>{pgettext(\"markup help\", \"Unordered list\")}</h4>\n          <ExampleFormatting\n            markup={\"- Lorem ipsum\\n- Dolor met\\n- Vulputate lectus\"}\n            result={\n              <ul>\n                <li>Lorem ipsum</li>\n                <li>Dolor met</li>\n                <li>Vulputate lectus</li>\n              </ul>\n            }\n          />\n\n          <hr />\n\n          <h4>{pgettext(\"markup help\", \"Ordered list\")}</h4>\n          <ExampleFormatting\n            markup={\"1. Lorem ipsum\\n2. Dolor met\\n3. Vulputate lectus\"}\n            result={\n              <ol>\n                <li>Lorem ipsum</li>\n                <li>Dolor met</li>\n                <li>Vulputate lectus</li>\n              </ol>\n            }\n          />\n\n          <hr />\n\n          <h4>{pgettext(\"markup help\", \"Quote text\")}</h4>\n          <ExampleFormatting\n            markup={\"> \" + pgettext(\"markup help\", \"Quoted text\")}\n            result={\n              <blockquote>\n                <p>{pgettext(\"markup help\", \"Quoted text\")}</p>\n              </blockquote>\n            }\n          />\n\n          <hr />\n\n          <h4>{pgettext(\"markup help\", \"Quote text (BBCode)\")}</h4>\n          <ExampleFormatting\n            markup={\n              \"[quote]\\n\" +\n              pgettext(\"markup help\", \"Quoted text\") +\n              \"\\n[/quote]\"\n            }\n            result={\n              <aside className=\"quote-block\">\n                <div className=\"quote-heading\">\n                  {gettext(\"Quoted message:\")}\n                </div>\n                <blockquote className=\"quote-body\">\n                  <p>{pgettext(\"markup help\", \"Quoted text\")}</p>\n                </blockquote>\n              </aside>\n            }\n          />\n\n          <hr />\n\n          <h4>{pgettext(\"markup help\", \"Quote text with author (BBCode)\")}</h4>\n          <ExampleFormatting\n            markup={\n              '[quote=\"' +\n              pgettext(\"markup help\", \"Quote author\") +\n              '\"]\\n' +\n              pgettext(\"markup help\", \"Quoted text\") +\n              \"\\n[/quote]\"\n            }\n            result={\n              <aside className=\"quote-block\">\n                <div className=\"quote-heading\">\n                  {pgettext(\"markup help\", \"Quote author has written:\")}\n                </div>\n                <blockquote className=\"quote-body\">\n                  <p>{pgettext(\"markup help\", \"Quoted text\")}</p>\n                </blockquote>\n              </aside>\n            }\n          />\n\n          <hr />\n\n          <h4>{pgettext(\"markup help\", \"Spoiler\")}</h4>\n          <ExampleFormatting\n            markup={\n              \"[spoiler]\\n\" +\n              pgettext(\"markup help\", \"Secret text\") +\n              \"\\n[/spoiler]\"\n            }\n            result={\n              <ExampleFormattingSpoiler>\n                {pgettext(\"markup help\", \"Secret text\")}\n              </ExampleFormattingSpoiler>\n            }\n          />\n\n          <hr />\n\n          <h4>{pgettext(\"markup help\", \"Inline code\")}</h4>\n          <ExampleFormatting\n            markup={pgettext(\"markup help\", \"`Inline code`\")}\n            result={\n              <p>\n                <code>{pgettext(\"markup help\", \"Inline code\")}</code>\n              </p>\n            }\n          />\n\n          <hr />\n\n          <h4>{pgettext(\"markup help\", \"Code block\")}</h4>\n          <ExampleFormatting\n            markup={\"```\\nalert\" + '(\"Hello world!\");' + \"\\n```\"}\n            result={\n              <pre>\n                <code className=\"hljs\">alert(\"Hello world!\");</code>\n              </pre>\n            }\n          />\n\n          <hr />\n\n          <h4>\n            {pgettext(\"markup help\", \"Code block with syntax highlighting\")}\n          </h4>\n          <ExampleFormatting\n            markup={\"```python\\nprint\" + '(\"Hello world!\");' + \"\\n```\"}\n            result={\n              <pre>\n                <code className=\"hljs language-python\">\n                  <span className=\"hljs-built_in\">print</span>(\"Hello world!\");\n                </code>\n              </pre>\n            }\n          />\n\n          <hr />\n\n          <h4>{pgettext(\"markup help\", \"Code block (BBCode)\")}</h4>\n          <ExampleFormatting\n            markup={\"[code]\\nalert\" + '(\"Hello world!\");' + \"\\n[/code]\"}\n            result={\n              <pre>\n                <code className=\"hljs\">alert(\"Hello world!\");</code>\n              </pre>\n            }\n          />\n\n          <hr />\n\n          <h4>\n            {pgettext(\n              \"markup help\",\n              \"Code block with syntax highlighting (BBCode)\"\n            )}\n          </h4>\n          <ExampleFormatting\n            markup={\n              '[code=\"python\"]\\nprint' + '(\"Hello world!\");' + \"\\n[/code]\"\n            }\n            result={\n              <pre>\n                <code className=\"hljs language-python\">\n                  <span className=\"hljs-built_in\">print</span>(\"Hello world!\");\n                </code>\n              </pre>\n            }\n          />\n\n          <hr />\n\n          <h4>{pgettext(\"markup help\", \"Horizontal rule\")}</h4>\n          <ExampleFormatting\n            markup={\"Lorem ipsum\\n- - -\\nDolor met\"}\n            result={\n              <div>\n                <p>Lorem ipsum</p>\n                <hr />\n                <p>Dolor met</p>\n              </div>\n            }\n          />\n\n          <hr />\n\n          <h4>{pgettext(\"markup help\", \"Horizontal rule (BBCode)\")}</h4>\n          <ExampleFormatting\n            markup={\"Lorem ipsum\\n[hr]\\nDolor met\"}\n            result={\n              <div>\n                <p>Lorem ipsum</p>\n                <hr />\n                <p>Dolor met</p>\n              </div>\n            }\n          />\n        </div>\n        <div className=\"modal-footer\">\n          <button\n            className=\"btn btn-default\"\n            data-dismiss=\"modal\"\n            type=\"button\"\n          >\n            {pgettext(\"modal\", \"Close\")}\n          </button>\n        </div>\n      </div>\n    </div>\n  )\n}\n\nfunction ExampleFormatting({ markup, result }) {\n  return (\n    <div className=\"formatting-help-item\">\n      <div className=\"formatting-help-item-markup\">\n        <pre>\n          <code>{markup}</code>\n        </pre>\n      </div>\n      <div className=\"formatting-help-item-preview\">\n        <article className=\"misago-markup\">{result}</article>\n      </div>\n    </div>\n  )\n}\n\nclass ExampleFormattingSpoiler extends React.Component {\n  constructor(props) {\n    super(props)\n\n    this.state = {\n      reveal: false,\n    }\n  }\n\n  render() {\n    return (\n      <aside\n        className={\n          this.state.reveal ? \"spoiler-block revealed\" : \"spoiler-block\"\n        }\n      >\n        <blockquote className=\"spoiler-body\">\n          <p>{this.props.children}</p>\n        </blockquote>\n        {!this.state.reveal && (\n          <div className=\"spoiler-overlay\">\n            <button\n              className=\"spoiler-reveal\"\n              type=\"button\"\n              onClick={() => {\n                this.setState({ reveal: true })\n              }}\n            >\n              {gettext(\"Reveal spoiler\")}\n            </button>\n          </div>\n        )}\n      </aside>\n    )\n  }\n}\n","const URL_PATTERN = new RegExp(\"^(((ftps?)|(https?))://)\", \"i\")\n\nexport default function isUrl(str) {\n  return URL_PATTERN.test(str.trim())\n}\n","import React from \"react\"\nimport modal from \"../../services/modal\"\nimport FormGroup from \"../form-group\"\nimport isUrl from \"./isUrl\"\nimport { replaceSelection } from \"./operations\"\n\nclass MarkupImageModal extends React.Component {\n  constructor(props) {\n    super(props)\n\n    const text = props.selection.text.trim()\n    const textUrl = isUrl(text)\n\n    this.state = {\n      error: null,\n      text: textUrl ? \"\" : text,\n      url: textUrl ? text : \"\",\n    }\n  }\n\n  handleSubmit = (ev) => {\n    ev.preventDefault()\n\n    const { selection, update } = this.props\n    const text = this.state.text.trim()\n    const url = this.state.url.trim()\n\n    if (url.length === 0) {\n      this.setState({ error: gettext(\"This field is required.\") })\n      return false\n    }\n\n    if (text.length > 0) {\n      replaceSelection(selection, update, \"![\" + text + \"](\" + url + \")\")\n    } else {\n      replaceSelection(selection, update, \"!(\" + url + \")\")\n    }\n\n    modal.hide()\n\n    return false\n  }\n\n  render() {\n    return (\n      <div className=\"modal-dialog\" role=\"document\">\n        <div className=\"modal-content\">\n          <div className=\"modal-header\">\n            <button\n              aria-label={pgettext(\"modal\", \"Close\")}\n              className=\"close\"\n              data-dismiss=\"modal\"\n              type=\"button\"\n            >\n              <span aria-hidden=\"true\">&times;</span>\n            </button>\n            <h4 className=\"modal-title\">\n              {pgettext(\"markup editor\", \"Image\")}\n            </h4>\n          </div>\n          <form onSubmit={this.handleSubmit}>\n            <div className=\"modal-body\">\n              <FormGroup\n                for=\"markup_image_text\"\n                label={pgettext(\"markup editor\", \"Image description\")}\n                helpText={pgettext(\n                  \"markup editor\",\n                  \"Optional but recommended . Will be displayed instead of image when it fails to load.\"\n                )}\n              >\n                <input\n                  id=\"markup_image_text\"\n                  className=\"form-control\"\n                  type=\"text\"\n                  value={this.state.text}\n                  onChange={(event) =>\n                    this.setState({ text: event.target.value })\n                  }\n                />\n              </FormGroup>\n              <FormGroup\n                for=\"markup_image_url\"\n                label={pgettext(\"markup editor\", \"Image URL\")}\n                validation={!!this.state.error ? [this.state.error] : undefined}\n              >\n                <input\n                  id=\"markup_image_url\"\n                  className=\"form-control\"\n                  type=\"text\"\n                  value={this.state.url}\n                  placeholder=\"http://domain.com/image.png\"\n                  onChange={(event) =>\n                    this.setState({ url: event.target.value })\n                  }\n                />\n              </FormGroup>\n            </div>\n            <div className=\"modal-footer\">\n              <button\n                className=\"btn btn-default\"\n                data-dismiss=\"modal\"\n                type=\"button\"\n              >\n                {pgettext(\"markup editor\", \"Cancel\")}\n              </button>\n              <button className=\"btn btn-primary\">\n                {pgettext(\"markup editor\", \"Insert image\")}\n              </button>\n            </div>\n          </form>\n        </div>\n      </div>\n    )\n  }\n}\n\nexport default MarkupImageModal\n","import React from \"react\"\nimport modal from \"../../services/modal\"\nimport FormGroup from \"../form-group\"\nimport isUrl from \"./isUrl\"\nimport { replaceSelection } from \"./operations\"\n\nclass MarkupLinkModal extends React.Component {\n  constructor(props) {\n    super(props)\n\n    const text = props.selection.text.trim()\n    const textUrl = isUrl(text)\n\n    this.state = {\n      error: null,\n      text: textUrl ? \"\" : text,\n      url: textUrl ? text : \"\",\n    }\n  }\n\n  handleSubmit = (ev) => {\n    ev.preventDefault()\n\n    const { selection, update } = this.props\n    const text = this.state.text.trim()\n    const url = this.state.url.trim()\n\n    if (url.length === 0) {\n      this.setState({ error: gettext(\"This field is required.\") })\n      return false\n    }\n\n    if (text.length > 0) {\n      replaceSelection(selection, update, \"[\" + text + \"](\" + url + \")\")\n    } else {\n      replaceSelection(selection, update, \"<\" + url + \">\")\n    }\n\n    modal.hide()\n\n    return false\n  }\n\n  render() {\n    return (\n      <div className=\"modal-dialog\" role=\"document\">\n        <div className=\"modal-content\">\n          <div className=\"modal-header\">\n            <button\n              aria-label={pgettext(\"modal\", \"Close\")}\n              className=\"close\"\n              data-dismiss=\"modal\"\n              type=\"button\"\n            >\n              <span aria-hidden=\"true\">&times;</span>\n            </button>\n            <h4 className=\"modal-title\">{pgettext(\"markup editor\", \"Link\")}</h4>\n          </div>\n          <form onSubmit={this.handleSubmit}>\n            <div className=\"modal-body\">\n              <FormGroup\n                for=\"markup_link_url\"\n                label={pgettext(\"markup editor\", \"Link text\")}\n                helpText={pgettext(\n                  \"markup editor\",\n                  \"Optional. Will be displayed instead of link's address.\"\n                )}\n              >\n                <input\n                  id=\"markup_link_text\"\n                  className=\"form-control\"\n                  type=\"text\"\n                  value={this.state.text}\n                  onChange={(event) =>\n                    this.setState({ text: event.target.value })\n                  }\n                />\n              </FormGroup>\n              <FormGroup\n                for=\"markup_link_url\"\n                label={pgettext(\"markup editor\", \"Link address\")}\n                validation={!!this.state.error ? [this.state.error] : undefined}\n              >\n                <input\n                  id=\"markup_link_url\"\n                  className=\"form-control\"\n                  type=\"text\"\n                  value={this.state.url}\n                  onChange={(event) =>\n                    this.setState({ url: event.target.value })\n                  }\n                />\n              </FormGroup>\n            </div>\n            <div className=\"modal-footer\">\n              <button\n                className=\"btn btn-default\"\n                data-dismiss=\"modal\"\n                type=\"button\"\n              >\n                {pgettext(\"markup editor\", \"Cancel\")}\n              </button>\n              <button className=\"btn btn-primary\">\n                {pgettext(\"markup editor\", \"Insert link\")}\n              </button>\n            </div>\n          </form>\n        </div>\n      </div>\n    )\n  }\n}\n\nexport default MarkupLinkModal\n","import React from \"react\"\nimport modal from \"../../services/modal\"\nimport FormGroup from \"../form-group\"\nimport { replaceSelection } from \"./operations\"\n\nclass MarkupQuoteModal extends React.Component {\n  constructor(props) {\n    super(props)\n\n    this.state = {\n      error: null,\n      author: \"\",\n      text: props.selection.text,\n    }\n  }\n\n  handleSubmit = (ev) => {\n    ev.preventDefault()\n\n    const { selection, update } = this.props\n    const author = this.state.author.trim()\n    const text = this.state.text.trim()\n\n    if (text.length === 0) {\n      this.setState({ error: gettext(\"This field is required.\") })\n      return false\n    }\n\n    const prefix = selection.prefix.trim().length ? \"\\n\\n\" : \"\"\n\n    if (author) {\n      replaceSelection(\n        selection,\n        update,\n        prefix + '[quote=\"' + author + '\"]\\n' + text + \"\\n[/quote]\\n\\n\"\n      )\n    } else {\n      replaceSelection(\n        selection,\n        update,\n        prefix + \"[quote]\\n\" + text + \"\\n[/quote]\\n\\n\"\n      )\n    }\n\n    modal.hide()\n\n    return false\n  }\n\n  render() {\n    return (\n      <div className=\"modal-dialog modal-lg\" role=\"document\">\n        <div className=\"modal-content\">\n          <div className=\"modal-header\">\n            <button\n              aria-label={pgettext(\"modal\", \"Close\")}\n              className=\"close\"\n              data-dismiss=\"modal\"\n              type=\"button\"\n            >\n              <span aria-hidden=\"true\">&times;</span>\n            </button>\n            <h4 className=\"modal-title\">\n              {pgettext(\"markup editor\", \"Quote\")}\n            </h4>\n          </div>\n          <form onSubmit={this.handleSubmit}>\n            <div className=\"modal-body\">\n              <FormGroup\n                for=\"markup_quote_author\"\n                label={pgettext(\"markup editor\", \"Quote's author or source\")}\n                helpText={pgettext(\n                  \"markup editor\",\n                  'Optional. If it\\'s username, put \"@\" before it (\"@JohnDoe\").'\n                )}\n              >\n                <input\n                  id=\"markup_quote_author\"\n                  className=\"form-control\"\n                  type=\"text\"\n                  value={this.state.author}\n                  onChange={(event) =>\n                    this.setState({ author: event.target.value })\n                  }\n                />\n              </FormGroup>\n              <FormGroup\n                for=\"markup_quote_text\"\n                label={pgettext(\"markup editor\", \"Quoted text\")}\n                validation={!!this.state.error ? [this.state.error] : undefined}\n              >\n                <textarea\n                  id=\"markup_quote_text\"\n                  className=\"form-control\"\n                  rows=\"8\"\n                  value={this.state.text}\n                  onChange={(event) =>\n                    this.setState({ text: event.target.value })\n                  }\n                />\n              </FormGroup>\n            </div>\n            <div className=\"modal-footer\">\n              <button\n                className=\"btn btn-default\"\n                data-dismiss=\"modal\"\n                type=\"button\"\n              >\n                {pgettext(\"markup editor\", \"Cancel\")}\n              </button>\n              <button className=\"btn btn-primary\">\n                {pgettext(\"markup editor\", \"Insert quote\")}\n              </button>\n            </div>\n          </form>\n        </div>\n      </div>\n    )\n  }\n}\n\nexport default MarkupQuoteModal\n","import React from \"react\"\n\nconst MarkupEditorButton = ({ disabled, icon, title, onClick }) => (\n  <button\n    className=\"btn btn-markup-editor\"\n    title={title}\n    type=\"button\"\n    disabled={disabled}\n    onClick={onClick}\n  >\n    <span className=\"material-icon\">{icon}</span>\n  </button>\n)\n\nexport default MarkupEditorButton\n","import moment from \"moment\"\nimport misago from \"../../\"\nimport ajax from \"../../services/ajax\"\nimport snackbar from \"../../services/snackbar\"\nimport formatFilesize from \"../../utils/file-size\"\nimport getRandomString from \"../../utils/getRandomString\"\n\nconst ID_LEN = 32\n\nconst uploadFile = (file, setState) => {\n  const maxSize = misago.get(\"user\").acl.max_attachment_size * 1024\n\n  if (file.size > maxSize) {\n    snackbar.error(\n      interpolate(\n        pgettext(\n          \"markup editor\",\n          \"File %(filename)s is bigger than %(limit)s.\"\n        ),\n        { filename: file.name, limit: formatFilesize(maxSize) },\n        true\n      )\n    )\n\n    return\n  }\n\n  let upload = {\n    id: null,\n    key: getRandomString(ID_LEN),\n    error: null,\n    uploaded_on: null,\n    progress: 0,\n    filename: file.name,\n    filetype: null,\n    is_image: false,\n    size: file.size,\n    url: null,\n    uploader_name: null,\n  }\n\n  setState(({ attachments }) => {\n    return { attachments: [upload].concat(attachments) }\n  })\n\n  const refreshState = () => {\n    setState(({ attachments }) => {\n      return { attachments: attachments.concat() }\n    })\n  }\n\n  const data = new FormData()\n  data.append(\"upload\", file)\n\n  ajax\n    .upload(misago.get(\"ATTACHMENTS_API\"), data, (progress) => {\n      upload.progress = progress\n      refreshState()\n    })\n    .then(\n      (data) => {\n        Object.assign(upload, data, { uploaded_on: moment(data.uploaded_on) })\n        refreshState()\n      },\n      (rejection) => {\n        if (rejection.status === 400 || rejection.status === 413) {\n          upload.error = rejection.detail\n          snackbar.error(rejection.detail)\n          refreshState()\n        } else {\n          snackbar.apiError(rejection)\n        }\n      }\n    )\n}\n\nexport default uploadFile\n","import React from \"react\"\nimport misago from \"../../\"\nimport modal from \"../../services/modal\"\nimport MarkupCodeModal from \"./MarkupCodeModal\"\nimport MarkupFormattingHelpModal from \"./MarkupFormattingHelpModal\"\nimport MarkupImageModal from \"./MarkupImageModal\"\nimport MarkupLinkModal from \"./MarkupLinkModal\"\nimport MarkupQuoteModal from \"./MarkupQuoteModal\"\nimport MarkupEditorButton from \"./MarkupEditorButton\"\nimport { getSelection, replaceSelection, wrapSelection } from \"./operations\"\nimport uploadFile from \"./uploadFile\"\n\nconst MarkupEditorToolbar = ({\n  disabled,\n  element,\n  update,\n  updateAttachments,\n}) => {\n  const actions = [\n    {\n      name: pgettext(\"markup editor\", \"Strong\"),\n      icon: \"format_bold\",\n      onClick: () => {\n        wrapSelection(\n          getSelection(element),\n          update,\n          \"**\",\n          \"**\",\n          pgettext(\"example markup\", \"Strong text\")\n        )\n      },\n    },\n    {\n      name: pgettext(\"markup editor\", \"Emphasis\"),\n      icon: \"format_italic\",\n      onClick: () => {\n        wrapSelection(\n          getSelection(element),\n          update,\n          \"*\",\n          \"*\",\n          pgettext(\"example markup\", \"Text with emphasis\")\n        )\n      },\n    },\n    {\n      name: pgettext(\"markup editor\", \"Strikethrough\"),\n      icon: \"format_strikethrough\",\n      onClick: () => {\n        wrapSelection(\n          getSelection(element),\n          update,\n          \"~~\",\n          \"~~\",\n          pgettext(\"example markup\", \"Text with strikethrough\")\n        )\n      },\n    },\n    {\n      name: pgettext(\"markup editor\", \"Horizontal ruler\"),\n      icon: \"remove\",\n      onClick: () => {\n        replaceSelection(getSelection(element), update, \"\\n\\n- - -\\n\\n\")\n      },\n    },\n    {\n      name: pgettext(\"markup editor\", \"Link\"),\n      icon: \"insert_link\",\n      onClick: () => {\n        const selection = getSelection(element)\n        modal.show(\n          <MarkupLinkModal\n            selection={selection}\n            element={element}\n            update={update}\n          />\n        )\n      },\n    },\n    {\n      name: pgettext(\"markup editor\", \"Image\"),\n      icon: \"insert_photo\",\n      onClick: () => {\n        const selection = getSelection(element)\n        modal.show(\n          <MarkupImageModal\n            selection={selection}\n            element={element}\n            update={update}\n          />\n        )\n      },\n    },\n    {\n      name: pgettext(\"markup editor\", \"Quote\"),\n      icon: \"format_quote\",\n      onClick: () => {\n        const selection = getSelection(element)\n        modal.show(\n          <MarkupQuoteModal\n            selection={selection}\n            element={element}\n            update={update}\n          />\n        )\n      },\n    },\n    {\n      name: pgettext(\"markup editor\", \"Spoiler\"),\n      icon: \"visibility_off\",\n      onClick: () => {\n        insertSpoiler(element, update)\n      },\n    },\n    {\n      name: pgettext(\"markup editor\", \"Code\"),\n      icon: \"code\",\n      onClick: () => {\n        const selection = getSelection(element)\n        modal.show(\n          <MarkupCodeModal\n            selection={selection}\n            element={element}\n            update={update}\n          />\n        )\n      },\n    },\n  ]\n\n  if (misago.get(\"user\").acl.max_attachment_size) {\n    actions.push({\n      name: pgettext(\"markup editor\", \"Upload file\"),\n      icon: \"file_upload\",\n      onClick: () => uploadFiles(updateAttachments),\n    })\n  }\n\n  return (\n    <div className=\"markup-editor-toolbar\">\n      <div className=\"markup-editor-toolbar-left\">\n        {actions.map(({ name, icon, onClick }) => (\n          <MarkupEditorButton\n            key={icon}\n            title={name}\n            icon={icon}\n            disabled={disabled || !element}\n            onClick={onClick}\n          />\n        ))}\n      </div>\n      <div className=\"markup-editor-toolbar-right\">\n        <div className=\"markup-editor-controls-dropdown\">\n          <button\n            type=\"button\"\n            className=\"btn btn-markup-editor dropdown-toggle\"\n            data-toggle=\"dropdown\"\n            aria-haspopup=\"true\"\n            aria-expanded=\"false\"\n            disabled={disabled || !element}\n          >\n            <span className=\"material-icon\">more_vert</span>\n          </button>\n          <ul className=\"dropdown-menu dropdown-menu-right stick-to-bottom\">\n            {actions.map(({ name, icon, onClick }) => (\n              <li key={icon}>\n                <button\n                  type=\"button\"\n                  className=\"btn-link\"\n                  disabled={disabled || !element}\n                  onClick={onClick}\n                >\n                  <span className=\"material-icon\">{icon}</span>\n                  {name}\n                </button>\n              </li>\n            ))}\n          </ul>\n        </div>\n        <MarkupEditorButton\n          title={pgettext(\"markup editor\", \"Open formatting help\")}\n          icon=\"help_outline\"\n          onClick={() => {\n            modal.show(<MarkupFormattingHelpModal />)\n          }}\n        />\n      </div>\n    </div>\n  )\n}\n\nconst insertSpoiler = (element, update) => {\n  const selection = getSelection(element)\n  const prefix = selection.prefix.trim().length ? \"\\n\\n\" : \"\"\n\n  wrapSelection(\n    selection,\n    update,\n    prefix + \"[spoiler]\\n\",\n    \"\\n[/spoiler]\\n\\n\",\n    pgettext(\"markup editor\", \"Spoiler text\")\n  )\n}\n\nconst uploadFiles = (setState) => {\n  const input = document.createElement(\"input\")\n  input.type = \"file\"\n  input.multiple = \"multiple\"\n\n  input.addEventListener(\"change\", function () {\n    for (let i = 0; i < input.files.length; i++) {\n      uploadFile(input.files[i], setState)\n    }\n  })\n\n  input.click()\n}\n\nexport default MarkupEditorToolbar\n","import React from \"react\"\nimport classnames from \"classnames\"\n\nimport misago from \"../../\"\nimport ajax from \"../../services/ajax\"\nimport snackbar from \"../../services/snackbar\"\nimport MisagoMarkup from \"../misago-markup\"\nimport MarkupEditorAttachments from \"./MarkupEditorAttachments\"\nimport MarkupEditorFooter from \"./MarkupEditorFooter\"\nimport MarkupEditorToolbar from \"./MarkupEditorToolbar\"\nimport uploadFile from \"./uploadFile\"\n\nclass MarkupEditor extends React.Component {\n  constructor(props) {\n    super(props)\n\n    this.state = {\n      element: null,\n      focused: false,\n      loading: false,\n      preview: false,\n      parsed: null,\n    }\n  }\n\n  showPreview = () => {\n    if (this.state.loading) return\n\n    this.setState({ loading: true, preview: true, element: null })\n\n    ajax.post(misago.get(\"PARSE_MARKUP_API\"), { post: this.props.value }).then(\n      (data) => {\n        this.setState({ loading: false, parsed: data.parsed })\n      },\n      (rejection) => {\n        if (rejection.status === 400) {\n          snackbar.error(rejection.detail)\n        } else {\n          snackbar.apiError(rejection)\n        }\n\n        this.setState({ loading: false, preview: false })\n      }\n    )\n  }\n\n  closePreview = () => {\n    this.setState({ loading: false, preview: false })\n  }\n\n  onDrop = (event) => {\n    event.preventDefault()\n    event.stopPropagation()\n\n    if (!event.dataTransfer.files) return\n\n    const { onAttachmentsChange: setState } = this.props\n\n    if (misago.get(\"user\").acl.max_attachment_size) {\n      for (let i = 0; i < event.dataTransfer.files.length; i++) {\n        const file = event.dataTransfer.files[i]\n        uploadFile(file, setState)\n      }\n    }\n  }\n\n  onPaste = (event) => {\n    const { onAttachmentsChange: setState } = this.props\n\n    const files = []\n    for (let i = 0; i < event.clipboardData.items.length; i++) {\n      const item = event.clipboardData.items[i]\n      if (item.kind === \"file\") {\n        files.push(item.getAsFile())\n      }\n    }\n\n    if (files.length) {\n      event.preventDefault()\n      event.stopPropagation()\n\n      if (misago.get(\"user\").acl.max_attachment_size) {\n        for (let i = 0; i < files.length; i++) {\n          uploadFile(files[i], setState)\n        }\n      }\n    }\n  }\n\n  render = () => (\n    <div\n      className={classnames(\"markup-editor\", {\n        \"markup-editor-focused\": this.state.focused && !this.state.preview,\n      })}\n    >\n      <MarkupEditorToolbar\n        disabled={this.props.disabled || this.state.preview}\n        element={this.state.element}\n        update={(value) => this.props.onChange({ target: { value } })}\n        updateAttachments={this.props.onAttachmentsChange}\n      />\n      {this.state.preview ? (\n        <div className=\"markup-editor-preview\">\n          {this.state.loading ? (\n            <div className=\"markup-editor-preview-loading\">\n              <div className=\"ui-preview\">\n                <span className=\"ui-preview-text\" style={{ width: \"240px\" }} />\n              </div>\n            </div>\n          ) : (\n            <MisagoMarkup\n              className=\"markup-editor-preview-contents\"\n              markup={this.state.parsed}\n            />\n          )}\n        </div>\n      ) : (\n        <textarea\n          className=\"markup-editor-textarea form-control\"\n          placeholder={this.props.placeholder}\n          value={this.props.value}\n          disabled={this.props.disabled || this.state.loading}\n          rows={6}\n          ref={(element) => {\n            if (element && this.state.element !== element) {\n              this.setState({ element })\n              setMentions(this.props, element)\n            }\n          }}\n          onChange={this.props.onChange}\n          onDrop={this.onDrop}\n          onFocus={() => this.setState({ focused: true })}\n          onPaste={this.onPaste}\n          onBlur={() => this.setState({ focused: false })}\n        />\n      )}\n      {this.props.attachments.length > 0 && (\n        <MarkupEditorAttachments\n          attachments={this.props.attachments}\n          disabled={this.props.disabled || this.state.preview}\n          element={this.state.element}\n          setState={this.props.onAttachmentsChange}\n          update={(value) => this.props.onChange({ target: { value } })}\n        />\n      )}\n      <MarkupEditorFooter\n        preview={this.state.preview}\n        canProtect={this.props.canProtect}\n        isProtected={this.props.isProtected}\n        disabled={this.props.disabled}\n        empty={\n          this.props.value.trim().length <\n            misago.get(\"SETTINGS\").post_length_min || this.state.loading\n        }\n        enableProtection={this.props.enableProtection}\n        disableProtection={this.props.disableProtection}\n        showPreview={this.showPreview}\n        closePreview={this.closePreview}\n        submitText={this.props.submitText}\n      />\n    </div>\n  )\n}\n\nfunction setMentions(props, element) {\n  $(element).atwho({\n    at: \"@\",\n    displayTpl: '<li><img src=\"${avatar}\" alt=\"\">${username}</li>',\n    insertTpl: \"@${username}\",\n    searchKey: \"username\",\n    callbacks: {\n      remoteFilter: function (query, callback) {\n        $.getJSON(misago.get(\"MENTION_API\"), { q: query }, callback)\n      },\n    },\n  })\n\n  $(element).on(\"inserted.atwho\", (event, _storage, source, controller) => {\n    const { query } = controller\n    const username = source.target.innerText.trim()\n    const prefix = event.target.value.substr(0, query.headPos)\n    const suffix = event.target.value.substr(query.endPos)\n\n    event.target.value = prefix + username + suffix\n    props.onChange(event)\n\n    const caret = query.headPos + username.length\n    event.target.setSelectionRange(caret, caret)\n    event.target.focus()\n  })\n}\n\nexport default MarkupEditor\n","import MarkupEditor from \"./MarkupEditor\"\n\nexport default MarkupEditor\n","import React from \"react\"\nimport classnames from \"classnames\"\n\nconst CLASS_ACTIVE = \"posting-active\"\nconst CLASS_DEFAULT = \"posting-default\"\nconst CLASS_MINIMIZED = \"posting-minimized\"\nconst CLASS_FULLSCREEN = \"posting-fullscreen\"\n\nclass PostingDialog extends React.Component {\n  componentDidMount() {\n    document.body.classList.add(CLASS_ACTIVE, CLASS_DEFAULT)\n  }\n\n  componentWillUnmount() {\n    document.body.classList.remove(\n      CLASS_ACTIVE,\n      CLASS_DEFAULT,\n      CLASS_MINIMIZED,\n      CLASS_FULLSCREEN\n    )\n  }\n\n  componentWillReceiveProps({ fullscreen, minimized }) {\n    if (minimized) {\n      document.body.classList.remove(CLASS_DEFAULT, CLASS_FULLSCREEN)\n      document.body.classList.add(CLASS_MINIMIZED)\n    } else {\n      if (fullscreen) {\n        document.body.classList.remove(CLASS_DEFAULT, CLASS_MINIMIZED)\n        document.body.classList.add(CLASS_FULLSCREEN)\n      } else {\n        document.body.classList.remove(CLASS_FULLSCREEN, CLASS_MINIMIZED)\n        document.body.classList.add(CLASS_DEFAULT)\n      }\n    }\n  }\n\n  render() {\n    const { children, fullscreen, minimized } = this.props\n\n    return (\n      <div\n        className={classnames(\"posting-dialog\", {\n          \"posting-dialog-minimized\": minimized,\n          \"posting-dialog-fullscreen\": fullscreen && !minimized,\n        })}\n      >\n        <div className=\"posting-dialog-container\">{children}</div>\n      </div>\n    )\n  }\n}\n\nexport default PostingDialog\n","import React from \"react\"\n\nconst PostingDialogBody = ({ children }) => (\n  <div className=\"posting-dialog-body\">{children}</div>\n)\n\nexport default PostingDialogBody\n","import React from \"react\"\n\nconst PostingDialogError = ({ close, message }) => (\n  <div className=\"posting-dialog-error\">\n    <div className=\"posting-dialog-error-icon\">\n      <span className=\"material-icon\">error_outlined</span>\n    </div>\n    <div className=\"posting-dialog-error-detail\">\n      <p>{message}</p>\n      <button type=\"button\" className=\"btn btn-default\" onClick={close}>\n        {pgettext(\"modal\", \"Close\")}\n      </button>\n    </div>\n  </div>\n)\n\nexport default PostingDialogError\n","import React from \"react\"\n\nconst PostingDialogHeader = ({\n  children,\n  close,\n  fullscreen,\n  minimize,\n  minimized,\n  fullscreenEnter,\n  fullscreenExit,\n  open,\n}) => (\n  <div className=\"posting-dialog-header\">\n    <div className=\"posting-dialog-caption\">{children}</div>\n    {minimized ? (\n      <button\n        className=\"btn btn-posting-dialog\"\n        title={pgettext(\"dialog\", \"Open\")}\n        type=\"button\"\n        onClick={open}\n      >\n        <span className=\"material-icon\">expand_less</span>\n      </button>\n    ) : (\n      <button\n        className=\"btn btn-posting-dialog\"\n        title={pgettext(\"dialog\", \"Minimize\")}\n        type=\"button\"\n        onClick={minimize}\n      >\n        <span className=\"material-icon\">expand_more</span>\n      </button>\n    )}\n    {fullscreen ? (\n      <button\n        className=\"btn btn-posting-dialog hidden-xs\"\n        title={pgettext(\"dialog\", \"Exit the fullscreen mode\")}\n        type=\"button\"\n        onClick={fullscreenExit}\n      >\n        <span className=\"material-icon\">fullscreen_exit</span>\n      </button>\n    ) : (\n      <button\n        className=\"btn btn-posting-dialog hidden-xs\"\n        title={pgettext(\"dialog\", \"Enter the fullscreen mode\")}\n        type=\"button\"\n        onClick={fullscreenEnter}\n      >\n        <span className=\"material-icon\">fullscreen</span>\n      </button>\n    )}\n    <button\n      className=\"btn btn-posting-dialog\"\n      title={pgettext(\"dialog\", \"Cancel\")}\n      type=\"button\"\n      onClick={close}\n    >\n      <span className=\"material-icon\">close</span>\n    </button>\n  </div>\n)\n\nexport default PostingDialogHeader\n","import React from \"react\"\n\nexport default function PostingThreadOptions({\n  isClosed,\n  isHidden,\n  isPinned,\n  disabled,\n  options,\n  close,\n  open,\n  hide,\n  unhide,\n  pinGlobally,\n  pinLocally,\n  unpin,\n}) {\n  const icons = getIcons(isClosed, isHidden, isPinned)\n\n  return (\n    <div className=\"dropdown\">\n      <button\n        className=\"btn btn-default btn-outline btn-icon\"\n        title={pgettext(\"post thread\", \"Options\")}\n        aria-expanded=\"true\"\n        aria-haspopup=\"true\"\n        data-toggle=\"dropdown\"\n        type=\"button\"\n        disabled={disabled}\n      >\n        {icons.length > 0 ? (\n          <span className=\"btn-icons-family\">\n            {icons.map((icon) => (\n              <span key={icon} className=\"material-icon\">\n                {icon}\n              </span>\n            ))}\n          </span>\n        ) : (\n          <span className=\"material-icon\">more_horiz</span>\n        )}\n      </button>\n      <ul className=\"dropdown-menu dropdown-menu-right stick-to-bottom\">\n        {options.pin === 2 && isPinned !== 2 && (\n          <li>\n            <button\n              className=\"btn btn-link\"\n              onClick={pinGlobally}\n              type=\"button\"\n              disabled={disabled}\n            >\n              <span className=\"material-icon\">bookmark</span>\n              {pgettext(\"post thread\", \"Pinned globally\")}\n            </button>\n          </li>\n        )}\n        {options.pin >= isPinned && isPinned !== 1 && (\n          <li>\n            <button\n              className=\"btn btn-link\"\n              onClick={pinLocally}\n              type=\"button\"\n              disabled={disabled}\n            >\n              <span className=\"material-icon\">bookmark_outline</span>\n              {pgettext(\"post thread\", \"Pinned in category\")}\n            </button>\n          </li>\n        )}\n        {options.pin >= isPinned && isPinned !== 0 && (\n          <li>\n            <button\n              className=\"btn btn-link\"\n              onClick={unpin}\n              type=\"button\"\n              disabled={disabled}\n            >\n              <span className=\"material-icon\">radio_button_unchecked</span>\n              {pgettext(\"post thread\", \"Not pinned\")}\n            </button>\n          </li>\n        )}\n        {options.close && !!isClosed && (\n          <li>\n            <button\n              className=\"btn btn-link\"\n              onClick={open}\n              type=\"button\"\n              disabled={disabled}\n            >\n              <span className=\"material-icon\">lock_outline</span>\n              {pgettext(\"post thread\", \"Open\")}\n            </button>\n          </li>\n        )}\n        {options.close && !isClosed && (\n          <li>\n            <button\n              className=\"btn btn-link\"\n              onClick={close}\n              type=\"button\"\n              disabled={disabled}\n            >\n              <span className=\"material-icon\">lock</span>\n              {pgettext(\"post thread\", \"Closed\")}\n            </button>\n          </li>\n        )}\n        {options.hide && !!isHidden && (\n          <li>\n            <button\n              className=\"btn btn-link\"\n              onClick={unhide}\n              type=\"button\"\n              disabled={disabled}\n            >\n              <span className=\"material-icon\">visibility</span>\n              {pgettext(\"post thread\", \"Visible\")}\n            </button>\n          </li>\n        )}\n        {options.hide && !isHidden && (\n          <li>\n            <button\n              className=\"btn btn-link\"\n              onClick={hide}\n              type=\"button\"\n              disabled={disabled}\n            >\n              <span className=\"material-icon\">visibility_off</span>\n              {pgettext(\"post thread\", \"Hidden\")}\n            </button>\n          </li>\n        )}\n      </ul>\n    </div>\n  )\n}\n\nfunction getIcons(closed, hidden, pinned) {\n  const icons = []\n  if (pinned === 2) icons.push(\"bookmark\")\n  if (pinned === 1) icons.push(\"bookmark_outline\")\n  if (closed) icons.push(\"lock\")\n  if (hidden) icons.push(\"visibility_off\")\n  return icons\n}\n","import React from \"react\"\nimport CategorySelect from \"misago/components/category-select\"\nimport Form from \"misago/components/form\"\nimport * as attachments from \"./utils/attachments\"\nimport { getPostValidators, getTitleValidators } from \"./utils/validators\"\nimport ajax from \"misago/services/ajax\"\nimport posting from \"misago/services/posting\"\nimport snackbar from \"misago/services/snackbar\"\nimport MarkupEditor from \"../MarkupEditor\"\nimport { Toolbar, ToolbarItem, ToolbarSection } from \"../Toolbar\"\nimport PostingDialog from \"./PostingDialog\"\nimport PostingDialogBody from \"./PostingDialogBody\"\nimport PostingDialogError from \"./PostingDialogError\"\nimport PostingDialogHeader from \"./PostingDialogHeader\"\nimport PostingThreadOptions from \"./PostingThreadOptions\"\n\nexport default class extends Form {\n  constructor(props) {\n    super(props)\n\n    this.state = {\n      isReady: false,\n      isLoading: false,\n\n      error: null,\n\n      minimized: false,\n      fullscreen: false,\n\n      options: null,\n\n      title: \"\",\n      category: props.category || null,\n      categories: [],\n      post: \"\",\n      attachments: [],\n      close: false,\n      hide: false,\n      pin: 0,\n\n      validators: {\n        title: getTitleValidators(),\n        post: getPostValidators(),\n      },\n      errors: {},\n    }\n  }\n\n  componentDidMount() {\n    ajax.get(this.props.config).then(this.loadSuccess, this.loadError)\n  }\n\n  loadSuccess = (data) => {\n    let category = null\n    let options = null\n\n    // hydrate categories, extract posting options\n    const categories = data.map((item) => {\n      // pick first category that allows posting and if it may, override it with initial one\n      if (\n        item.post !== false &&\n        (!category || item.id == this.state.category)\n      ) {\n        category = item.id\n        options = item.post\n      }\n\n      return Object.assign(item, {\n        disabled: item.post === false,\n        label: item.name,\n        value: item.id,\n      })\n    })\n\n    this.setState({\n      isReady: true,\n      options,\n\n      categories,\n      category,\n    })\n  }\n\n  loadError = (rejection) => {\n    this.setState({\n      error: rejection.detail,\n    })\n  }\n\n  onCancel = () => {\n    const formEmpty = !!(\n      this.state.post.length === 0 &&\n      this.state.title.length === 0 &&\n      this.state.attachments.length === 0\n    )\n\n    if (formEmpty) {\n      this.minimize()\n      return posting.close()\n    }\n\n    const cancel = window.confirm(\n      pgettext(\"post thread\", \"Are you sure you want to discard thread?\")\n    )\n    if (cancel) {\n      this.minimize()\n      posting.close()\n    }\n  }\n\n  onTitleChange = (event) => {\n    this.changeValue(\"title\", event.target.value)\n  }\n\n  onCategoryChange = (event) => {\n    const category = this.state.categories.find((item) => {\n      return event.target.value == item.value\n    })\n\n    // if selected pin is greater than allowed, reduce it\n    let pin = this.state.pin\n    if (category.post.pin && category.post.pin < pin) {\n      pin = category.post.pin\n    }\n\n    this.setState({\n      category: category.id,\n      categoryOptions: category.post,\n\n      pin,\n    })\n  }\n\n  onPostChange = (event) => {\n    this.changeValue(\"post\", event.target.value)\n  }\n\n  onAttachmentsChange = (attachments) => {\n    this.setState(attachments)\n  }\n\n  onClose = () => {\n    this.changeValue(\"close\", true)\n  }\n\n  onOpen = () => {\n    this.changeValue(\"close\", false)\n  }\n\n  onPinGlobally = () => {\n    this.changeValue(\"pin\", 2)\n  }\n\n  onPinLocally = () => {\n    this.changeValue(\"pin\", 1)\n  }\n\n  onUnpin = () => {\n    this.changeValue(\"pin\", 0)\n  }\n\n  onHide = () => {\n    this.changeValue(\"hide\", true)\n  }\n\n  onUnhide = () => {\n    this.changeValue(\"hide\", false)\n  }\n\n  close = () => {\n    this.minimize()\n    posting.close()\n  }\n\n  minimize = () => {\n    this.setState({ fullscreen: false, minimized: true })\n  }\n\n  open = () => {\n    this.setState({ minimized: false })\n    if (this.state.fullscreen) {\n    }\n  }\n\n  fullscreenEnter = () => {\n    this.setState({ fullscreen: true, minimized: false })\n  }\n\n  fullscreenExit = () => {\n    this.setState({ fullscreen: false, minimized: false })\n  }\n\n  clean() {\n    if (!this.state.title.trim().length) {\n      snackbar.error(\n        pgettext(\"posting form\", \"You have to enter thread title.\")\n      )\n      return false\n    }\n\n    if (!this.state.post.trim().length) {\n      snackbar.error(pgettext(\"posting form\", \"You have to enter a message.\"))\n      return false\n    }\n\n    const errors = this.validate()\n\n    if (errors.title) {\n      snackbar.error(errors.title[0])\n      return false\n    }\n\n    if (errors.post) {\n      snackbar.error(errors.post[0])\n      return false\n    }\n\n    return true\n  }\n\n  send() {\n    return ajax.post(this.props.submit, {\n      title: this.state.title,\n      category: this.state.category,\n      post: this.state.post,\n      attachments: attachments.clean(this.state.attachments),\n      close: this.state.close,\n      hide: this.state.hide,\n      pin: this.state.pin,\n    })\n  }\n\n  handleSuccess(success) {\n    this.setState({ isLoading: true })\n    this.close()\n\n    snackbar.success(pgettext(\"post thread\", \"Your thread has been posted.\"))\n    window.location = success.url\n  }\n\n  handleError(rejection) {\n    if (rejection.status === 400) {\n      const errors = [].concat(\n        rejection.non_field_errors || [],\n        rejection.category || [],\n        rejection.title || [],\n        rejection.post || [],\n        rejection.attachments || []\n      )\n\n      snackbar.error(errors[0])\n    } else {\n      snackbar.apiError(rejection)\n    }\n  }\n\n  render() {\n    const dialogProps = {\n      minimized: this.state.minimized,\n      minimize: this.minimize,\n      open: this.open,\n\n      fullscreen: this.state.fullscreen,\n      fullscreenEnter: this.fullscreenEnter,\n      fullscreenExit: this.fullscreenExit,\n\n      close: this.onCancel,\n    }\n\n    if (this.state.error) {\n      return (\n        <PostingDialogStart {...dialogProps}>\n          <PostingDialogError message={this.state.error} close={this.close} />\n        </PostingDialogStart>\n      )\n    }\n\n    if (!this.state.isReady) {\n      return (\n        <PostingDialogStart {...dialogProps}>\n          <div className=\"posting-loading ui-preview\">\n            <Toolbar className=\"posting-dialog-toolbar\">\n              <ToolbarSection className=\"posting-dialog-thread-title\" auto>\n                <ToolbarItem auto>\n                  <input className=\"form-control\" disabled={true} type=\"text\" />\n                </ToolbarItem>\n              </ToolbarSection>\n              <ToolbarSection className=\"posting-dialog-category-select\" auto>\n                <ToolbarItem>\n                  <input className=\"form-control\" disabled={true} type=\"text\" />\n                </ToolbarItem>\n              </ToolbarSection>\n            </Toolbar>\n            <MarkupEditor\n              attachments={[]}\n              value={\"\"}\n              submitText={pgettext(\"post thread submit\", \"Start thread\")}\n              disabled={true}\n              onAttachmentsChange={() => {}}\n              onChange={() => {}}\n            />\n          </div>\n        </PostingDialogStart>\n      )\n    }\n\n    const showOptions = !!(\n      this.state.options.close ||\n      this.state.options.hide ||\n      this.state.options.pin\n    )\n\n    return (\n      <PostingDialogStart {...dialogProps}>\n        <form className=\"posting-dialog-form\" onSubmit={this.handleSubmit}>\n          <Toolbar className=\"posting-dialog-toolbar\">\n            <ToolbarSection className=\"posting-dialog-thread-title\" auto>\n              <ToolbarItem auto>\n                <input\n                  className=\"form-control\"\n                  disabled={this.state.isLoading}\n                  onChange={this.onTitleChange}\n                  placeholder={pgettext(\"post thread\", \"Thread title\")}\n                  type=\"text\"\n                  value={this.state.title}\n                />\n              </ToolbarItem>\n            </ToolbarSection>\n            <ToolbarSection className=\"posting-dialog-category-select\" auto>\n              <ToolbarItem>\n                <CategorySelect\n                  choices={this.state.categories}\n                  disabled={this.state.isLoading}\n                  onChange={this.onCategoryChange}\n                  value={this.state.category}\n                />\n              </ToolbarItem>\n              {showOptions && (\n                <ToolbarItem shrink>\n                  <PostingThreadOptions\n                    isClosed={this.state.close}\n                    isHidden={this.state.hide}\n                    isPinned={this.state.pin}\n                    disabled={this.state.isLoading}\n                    options={this.state.options}\n                    close={this.onClose}\n                    open={this.onOpen}\n                    hide={this.onHide}\n                    unhide={this.onUnhide}\n                    pinGlobally={this.onPinGlobally}\n                    pinLocally={this.onPinLocally}\n                    unpin={this.onUnpin}\n                  />\n                </ToolbarItem>\n              )}\n            </ToolbarSection>\n          </Toolbar>\n          <MarkupEditor\n            attachments={this.state.attachments}\n            value={this.state.post}\n            submitText={pgettext(\"post thread submit\", \"Start thread\")}\n            disabled={this.state.isLoading}\n            onAttachmentsChange={this.onAttachmentsChange}\n            onChange={this.onPostChange}\n          />\n        </form>\n      </PostingDialogStart>\n    )\n  }\n}\n\nconst PostingDialogStart = ({\n  children,\n  close,\n  minimized,\n  minimize,\n  open,\n  fullscreen,\n  fullscreenEnter,\n  fullscreenExit,\n}) => (\n  <PostingDialog fullscreen={fullscreen} minimized={minimized}>\n    <PostingDialogHeader\n      fullscreen={fullscreen}\n      fullscreenEnter={fullscreenEnter}\n      fullscreenExit={fullscreenExit}\n      minimized={minimized}\n      minimize={minimize}\n      open={open}\n      close={close}\n    >\n      {pgettext(\"post thread\", \"Start new thread\")}\n    </PostingDialogHeader>\n    <PostingDialogBody>{children}</PostingDialogBody>\n  </PostingDialog>\n)\n","export default function (usernames) {\n  const normalisedNames = usernames\n    .split(\",\")\n    .map((i) => i.trim().toLowerCase())\n  const removedBlanks = normalisedNames.filter((i) => i.length > 0)\n  const removedDuplicates = removedBlanks.filter((name, pos) => {\n    return removedBlanks.indexOf(name) == pos\n  })\n\n  return removedDuplicates\n}\n","import React from \"react\"\nimport Form from \"misago/components/form\"\nimport * as attachments from \"./utils/attachments\"\nimport cleanUsernames from \"./utils/usernames\"\nimport { getPostValidators, getTitleValidators } from \"./utils/validators\"\nimport ajax from \"misago/services/ajax\"\nimport posting from \"misago/services/posting\"\nimport snackbar from \"misago/services/snackbar\"\nimport MarkupEditor from \"../MarkupEditor\"\nimport { Toolbar, ToolbarItem, ToolbarSection } from \"../Toolbar\"\nimport PostingDialog from \"./PostingDialog\"\nimport PostingDialogBody from \"./PostingDialogBody\"\nimport PostingDialogHeader from \"./PostingDialogHeader\"\n\nexport default class extends Form {\n  constructor(props) {\n    super(props)\n\n    const to = (props.to || []).map((user) => user.username).join(\", \")\n\n    this.state = {\n      isLoading: false,\n\n      error: null,\n\n      minimized: false,\n      fullscreen: false,\n\n      to: to,\n      title: \"\",\n      post: \"\",\n      attachments: [],\n\n      validators: {\n        title: getTitleValidators(),\n        post: getPostValidators(),\n      },\n      errors: {},\n    }\n  }\n\n  onCancel = () => {\n    const formEmpty = !!(\n      this.state.post.length === 0 &&\n      this.state.title.length === 0 &&\n      this.state.to.length === 0 &&\n      this.state.attachments.length === 0\n    )\n\n    if (formEmpty) {\n      return this.close()\n    }\n\n    const cancel = window.confirm(\n      pgettext(\n        \"post thread\",\n        \"Are you sure you want to discard private thread?\"\n      )\n    )\n    if (cancel) {\n      this.close()\n    }\n  }\n\n  onToChange = (event) => {\n    this.changeValue(\"to\", event.target.value)\n  }\n\n  onTitleChange = (event) => {\n    this.changeValue(\"title\", event.target.value)\n  }\n\n  onPostChange = (event) => {\n    this.changeValue(\"post\", event.target.value)\n  }\n\n  onAttachmentsChange = (attachments) => {\n    this.setState(attachments)\n  }\n\n  clean() {\n    if (!cleanUsernames(this.state.to).length) {\n      snackbar.error(\n        pgettext(\"posting form\", \"You have to enter at least one recipient.\")\n      )\n      return false\n    }\n\n    if (!this.state.title.trim().length) {\n      snackbar.error(\n        pgettext(\"posting form\", \"You have to enter thread title.\")\n      )\n      return false\n    }\n\n    if (!this.state.post.trim().length) {\n      snackbar.error(pgettext(\"posting form\", \"You have to enter a message.\"))\n      return false\n    }\n\n    const errors = this.validate()\n\n    if (errors.title) {\n      snackbar.error(errors.title[0])\n      return false\n    }\n\n    if (errors.post) {\n      snackbar.error(errors.post[0])\n      return false\n    }\n\n    return true\n  }\n\n  send() {\n    return ajax.post(this.props.submit, {\n      to: cleanUsernames(this.state.to),\n      title: this.state.title,\n      post: this.state.post,\n      attachments: attachments.clean(this.state.attachments),\n    })\n  }\n\n  handleSuccess(success) {\n    this.setState({ isLoading: true })\n    this.close()\n\n    snackbar.success(pgettext(\"post thread\", \"Your thread has been posted.\"))\n    window.location = success.url\n  }\n\n  handleError(rejection) {\n    if (rejection.status === 400) {\n      const errors = [].concat(\n        rejection.non_field_errors || [],\n        rejection.to || [],\n        rejection.title || [],\n        rejection.post || [],\n        rejection.attachments || []\n      )\n\n      snackbar.error(errors[0])\n    } else {\n      snackbar.apiError(rejection)\n    }\n  }\n\n  close = () => {\n    this.minimize()\n    posting.close()\n  }\n\n  minimize = () => {\n    this.setState({ fullscreen: false, minimized: true })\n  }\n\n  open = () => {\n    this.setState({ minimized: false })\n    if (this.state.fullscreen) {\n    }\n  }\n\n  fullscreenEnter = () => {\n    this.setState({ fullscreen: true, minimized: false })\n  }\n\n  fullscreenExit = () => {\n    this.setState({ fullscreen: false, minimized: false })\n  }\n\n  render() {\n    const dialogProps = {\n      minimized: this.state.minimized,\n      minimize: this.minimize,\n      open: this.open,\n\n      fullscreen: this.state.fullscreen,\n      fullscreenEnter: this.fullscreenEnter,\n      fullscreenExit: this.fullscreenExit,\n\n      close: this.onCancel,\n    }\n\n    return (\n      <PostingDialogStartPrivate {...dialogProps}>\n        <form className=\"posting-dialog-form\" onSubmit={this.handleSubmit}>\n          <Toolbar className=\"posting-dialog-toolbar\">\n            <ToolbarSection className=\"posting-dialog-thread-recipients\" auto>\n              <ToolbarItem auto>\n                <input\n                  className=\"form-control\"\n                  disabled={this.state.isLoading}\n                  onChange={this.onToChange}\n                  placeholder={pgettext(\n                    \"post thread\",\n                    \"Recipients, eg.: Danny, Lisa, Alice\"\n                  )}\n                  type=\"text\"\n                  value={this.state.to}\n                />\n              </ToolbarItem>\n            </ToolbarSection>\n            <ToolbarSection className=\"posting-dialog-thread-title\" auto>\n              <ToolbarItem auto>\n                <input\n                  className=\"form-control\"\n                  disabled={this.state.isLoading}\n                  onChange={this.onTitleChange}\n                  placeholder={pgettext(\"post thread\", \"Thread title\")}\n                  type=\"text\"\n                  value={this.state.title}\n                />\n              </ToolbarItem>\n            </ToolbarSection>\n          </Toolbar>\n          <MarkupEditor\n            attachments={this.state.attachments}\n            value={this.state.post}\n            submitText={pgettext(\"post thread submit\", \"Start thread\")}\n            disabled={this.state.isLoading}\n            onAttachmentsChange={this.onAttachmentsChange}\n            onChange={this.onPostChange}\n          />\n        </form>\n      </PostingDialogStartPrivate>\n    )\n  }\n}\n\nconst PostingDialogStartPrivate = ({\n  children,\n  close,\n  minimized,\n  minimize,\n  open,\n  fullscreen,\n  fullscreenEnter,\n  fullscreenExit,\n}) => (\n  <PostingDialog fullscreen={fullscreen} minimized={minimized}>\n    <PostingDialogHeader\n      fullscreen={fullscreen}\n      fullscreenEnter={fullscreenEnter}\n      fullscreenExit={fullscreenExit}\n      minimized={minimized}\n      minimize={minimize}\n      open={open}\n      close={close}\n    >\n      {pgettext(\"post thread\", \"Start private thread\")}\n    </PostingDialogHeader>\n    <PostingDialogBody>{children}</PostingDialogBody>\n  </PostingDialog>\n)\n","import React from \"react\"\nimport Form from \"misago/components/form\"\nimport * as attachments from \"./utils/attachments\"\nimport { getPostValidators } from \"./utils/validators\"\nimport ajax from \"misago/services/ajax\"\nimport posting from \"misago/services/posting\"\nimport snackbar from \"misago/services/snackbar\"\nimport MarkupEditor from \"../MarkupEditor\"\nimport PostingDialog from \"./PostingDialog\"\nimport PostingDialogBody from \"./PostingDialogBody\"\nimport PostingDialogError from \"./PostingDialogError\"\nimport PostingDialogHeader from \"./PostingDialogHeader\"\nimport { clearGlobalState, setGlobalState } from \"./globalState\"\n\nexport default class extends Form {\n  constructor(props) {\n    super(props)\n\n    this.state = {\n      isReady: false,\n      isLoading: false,\n\n      error: null,\n\n      minimized: false,\n      fullscreen: false,\n\n      post: this.props.default || \"\",\n      attachments: [],\n\n      validators: {\n        post: getPostValidators(),\n      },\n      errors: {},\n    }\n\n    this.quoteText = \"\"\n  }\n\n  componentDidMount() {\n    ajax\n      .get(this.props.config, this.props.context || null)\n      .then(this.loadSuccess, this.loadError)\n\n    setGlobalState(false, this.onQuote)\n  }\n\n  componentWillUnmount() {\n    clearGlobalState()\n  }\n\n  componentWillReceiveProps(nextProps) {\n    const context = this.props.context\n    const newContext = nextProps.context\n\n    // User clicked \"reply\" instead of \"quote\"\n    if (context && newContext && !newContext.reply) return\n\n    ajax\n      .get(nextProps.config, nextProps.context || null)\n      .then(this.appendData, snackbar.apiError)\n  }\n\n  loadSuccess = (data) => {\n    this.setState({\n      isReady: true,\n\n      post: data.post\n        ? '[quote=\"@' + data.poster + '\"]\\n' + data.post + \"\\n[/quote]\"\n        : this.state.post,\n    })\n\n    this.quoteText = data.post\n      ? '[quote=\"@' + data.poster + '\"]\\n' + data.post + \"\\n[/quote]\"\n      : this.state.post\n  }\n\n  loadError = (rejection) => {\n    this.setState({\n      error: rejection.detail,\n    })\n  }\n\n  appendData = (data) => {\n    const newPost = data.post\n      ? '[quote=\"@' + data.poster + '\"]\\n' + data.post + \"\\n[/quote]\\n\\n\"\n      : \"\"\n\n    this.setState((prevState, props) => {\n      if (prevState.post.length > 0) {\n        return {\n          post: prevState.post.trim() + \"\\n\\n\" + newPost,\n        }\n      }\n\n      return {\n        post: newPost,\n      }\n    })\n\n    this.open()\n  }\n\n  onCancel = () => {\n    // If only the quote text is on editor user didn't add anything\n    // so no changes to discard\n    const onlyQuoteTextInEditor = this.state.post === this.quoteText\n\n    if (onlyQuoteTextInEditor && this.state.attachments.length === 0) {\n      return this.close()\n    }\n\n    const cancel = window.confirm(\n      pgettext(\"post reply\", \"Are you sure you want to discard your reply?\")\n    )\n    if (cancel) {\n      this.close()\n    }\n  }\n\n  onPostChange = (event) => {\n    this.changeValue(\"post\", event.target.value)\n  }\n\n  onAttachmentsChange = (attachments) => {\n    this.setState(attachments)\n  }\n\n  onQuote = (quote) => {\n    this.setState(({ post }) => {\n      if (post.length > 0) {\n        return { post: post.trim() + \"\\n\\n\" + quote }\n      }\n\n      return { post: quote }\n    })\n\n    this.open()\n  }\n\n  clean() {\n    if (!this.state.post.trim().length) {\n      snackbar.error(pgettext(\"posting form\", \"You have to enter a message.\"))\n      return false\n    }\n\n    const errors = this.validate()\n\n    if (errors.post) {\n      snackbar.error(errors.post[0])\n      return false\n    }\n\n    return true\n  }\n\n  send() {\n    setGlobalState(true, this.onQuote)\n\n    return ajax.post(this.props.submit, {\n      post: this.state.post,\n      attachments: attachments.clean(this.state.attachments),\n    })\n  }\n\n  handleSuccess(success) {\n    this.setState({ isLoading: true })\n    this.close()\n\n    setGlobalState(false, this.onQuote)\n\n    snackbar.success(pgettext(\"post reply\", \"Your reply has been posted.\"))\n    window.location = success.url.index\n  }\n\n  handleError(rejection) {\n    if (rejection.status === 400) {\n      const errors = [].concat(\n        rejection.non_field_errors || [],\n        rejection.post || [],\n        rejection.attachments || []\n      )\n\n      snackbar.error(errors[0])\n    } else {\n      snackbar.apiError(rejection)\n    }\n\n    setGlobalState(false, this.onQuote)\n  }\n\n  close = () => {\n    this.minimize()\n    posting.close()\n  }\n\n  minimize = () => {\n    this.setState({ fullscreen: false, minimized: true })\n  }\n\n  open = () => {\n    this.setState({ minimized: false })\n    if (this.state.fullscreen) {\n    }\n  }\n\n  fullscreenEnter = () => {\n    this.setState({ fullscreen: true, minimized: false })\n  }\n\n  fullscreenExit = () => {\n    this.setState({ fullscreen: false, minimized: false })\n  }\n\n  render() {\n    const dialogProps = {\n      thread: this.props.thread,\n\n      minimized: this.state.minimized,\n      minimize: this.minimize,\n      open: this.open,\n\n      fullscreen: this.state.fullscreen,\n      fullscreenEnter: this.fullscreenEnter,\n      fullscreenExit: this.fullscreenExit,\n\n      close: this.onCancel,\n    }\n\n    if (this.state.error) {\n      return (\n        <PostingDialogReply {...dialogProps}>\n          <PostingDialogError message={this.state.error} close={this.close} />\n        </PostingDialogReply>\n      )\n    }\n\n    if (!this.state.isReady) {\n      return (\n        <PostingDialogReply {...dialogProps}>\n          <div className=\"posting-loading ui-preview\">\n            <MarkupEditor\n              attachments={[]}\n              value={\"\"}\n              submitText={pgettext(\"post reply submit\", \"Post reply\")}\n              disabled={true}\n              onAttachmentsChange={() => {}}\n              onChange={() => {}}\n            />\n          </div>\n        </PostingDialogReply>\n      )\n    }\n\n    return (\n      <PostingDialogReply {...dialogProps}>\n        <form\n          className=\"posting-dialog-form\"\n          method=\"POST\"\n          onSubmit={this.handleSubmit}\n        >\n          <MarkupEditor\n            attachments={this.state.attachments}\n            value={this.state.post}\n            submitText={pgettext(\"post reply submit\", \"Post reply\")}\n            disabled={this.state.isLoading}\n            onAttachmentsChange={this.onAttachmentsChange}\n            onChange={this.onPostChange}\n          />\n        </form>\n      </PostingDialogReply>\n    )\n  }\n}\n\nconst PostingDialogReply = ({\n  children,\n  close,\n  minimized,\n  minimize,\n  open,\n  fullscreen,\n  fullscreenEnter,\n  fullscreenExit,\n  thread,\n}) => (\n  <PostingDialog fullscreen={fullscreen} minimized={minimized}>\n    <PostingDialogHeader\n      fullscreen={fullscreen}\n      fullscreenEnter={fullscreenEnter}\n      fullscreenExit={fullscreenExit}\n      minimized={minimized}\n      minimize={minimize}\n      open={open}\n      close={close}\n    >\n      {interpolate(\n        pgettext(\"post reply\", \"Reply to: %(thread)s\"),\n        { thread: thread.title },\n        true\n      )}\n    </PostingDialogHeader>\n    <PostingDialogBody>{children}</PostingDialogBody>\n  </PostingDialog>\n)\n","import React from \"react\"\nimport Form from \"misago/components/form\"\nimport * as attachments from \"./utils/attachments\"\nimport { getPostValidators } from \"./utils/validators\"\nimport ajax from \"misago/services/ajax\"\nimport posting from \"misago/services/posting\"\nimport snackbar from \"misago/services/snackbar\"\nimport MarkupEditor from \"../MarkupEditor\"\nimport PostingDialog from \"./PostingDialog\"\nimport PostingDialogBody from \"./PostingDialogBody\"\nimport PostingDialogError from \"./PostingDialogError\"\nimport PostingDialogHeader from \"./PostingDialogHeader\"\nimport { clearGlobalState, setGlobalState } from \"./globalState\"\n\nexport default class extends Form {\n  constructor(props) {\n    super(props)\n\n    this.state = {\n      isReady: false,\n      isLoading: false,\n\n      error: false,\n\n      minimized: false,\n      fullscreen: false,\n\n      post: \"\",\n      attachments: [],\n      protect: false,\n\n      canProtect: false,\n\n      validators: {\n        post: getPostValidators(),\n      },\n      errors: {},\n    }\n\n    this.originalPost = \"\"\n  }\n\n  componentDidMount() {\n    ajax.get(this.props.config).then(this.loadSuccess, this.loadError)\n\n    setGlobalState(false, this.onQuote)\n  }\n\n  componentWillUnmount() {\n    clearGlobalState()\n  }\n\n  componentWillReceiveProps(nextProps) {\n    const context = this.props.context\n    const newContext = nextProps.context\n\n    if (context && newContext && context.reply === newContext.reply) return\n\n    ajax\n      .get(nextProps.config, nextProps.context || null)\n      .then(this.appendData, snackbar.apiError)\n  }\n\n  loadSuccess = (data) => {\n    this.originalPost = data.post\n\n    this.setState({\n      isReady: true,\n\n      post: data.post,\n      attachments: attachments.hydrate(data.attachments),\n      protect: data.is_protected,\n\n      canProtect: data.can_protect,\n    })\n  }\n\n  loadError = (rejection) => {\n    this.setState({\n      error: rejection.detail,\n    })\n  }\n\n  appendData = (data) => {\n    const newPost = data.post\n      ? '[quote=\"@' + data.poster + '\"]\\n' + data.post + \"\\n[/quote]\\n\\n\"\n      : \"\"\n\n    this.setState((prevState, props) => {\n      if (prevState.post.length > 0) {\n        return {\n          post: prevState.post.trim() + \"\\n\\n\" + newPost,\n        }\n      }\n\n      return {\n        post: newPost,\n      }\n    })\n\n    this.open()\n  }\n\n  onCancel = () => {\n    const originalPostSameAsCurrentPost =\n      this.state.originalPost === this.state.post\n    const noAttachementsAdded = this.state.attachments.length === 0\n\n    if (originalPostSameAsCurrentPost && noAttachementsAdded) {\n      return this.close()\n    }\n\n    const cancel = window.confirm(\n      pgettext(\"edit reply\", \"Are you sure you want to discard changes?\")\n    )\n    if (cancel) {\n      this.close()\n    }\n  }\n\n  onProtect = () => {\n    this.setState({\n      protect: true,\n    })\n  }\n\n  onUnprotect = () => {\n    this.setState({\n      protect: false,\n    })\n  }\n\n  onPostChange = (event) => {\n    this.changeValue(\"post\", event.target.value)\n  }\n\n  onAttachmentsChange = (attachments) => {\n    this.setState(attachments)\n  }\n\n  onQuote = (quote) => {\n    this.setState(({ post }) => {\n      if (post.length > 0) {\n        return { post: post.trim() + \"\\n\\n\" + quote }\n      }\n\n      return { post: quote }\n    })\n\n    this.open()\n  }\n\n  clean() {\n    if (!this.state.post.trim().length) {\n      snackbar.error(pgettext(\"posting form\", \"You have to enter a message.\"))\n      return false\n    }\n\n    const errors = this.validate()\n\n    if (errors.post) {\n      snackbar.error(errors.post[0])\n      return false\n    }\n\n    return true\n  }\n\n  send() {\n    setGlobalState(true, this.onQuote)\n\n    return ajax.put(this.props.submit, {\n      post: this.state.post,\n      attachments: attachments.clean(this.state.attachments),\n      protect: this.state.protect,\n    })\n  }\n\n  handleSuccess(success) {\n    this.setState({ isLoading: true })\n    this.close()\n\n    setGlobalState(false, this.onQuote)\n\n    snackbar.success(pgettext(\"edit reply\", \"Reply has been edited.\"))\n    window.location = success.url.index\n  }\n\n  handleError(rejection) {\n    if (rejection.status === 400) {\n      const errors = [].concat(\n        rejection.non_field_errors || [],\n        rejection.category || [],\n        rejection.title || [],\n        rejection.post || [],\n        rejection.attachments || []\n      )\n\n      snackbar.error(errors[0])\n    } else {\n      snackbar.apiError(rejection)\n    }\n\n    setGlobalState(false, this.onQuote)\n  }\n\n  close = () => {\n    this.minimize()\n    posting.close()\n  }\n\n  minimize = () => {\n    this.setState({ fullscreen: false, minimized: true })\n  }\n\n  open = () => {\n    this.setState({ minimized: false })\n    if (this.state.fullscreen) {\n    }\n  }\n\n  fullscreenEnter = () => {\n    this.setState({ fullscreen: true, minimized: false })\n  }\n\n  fullscreenExit = () => {\n    this.setState({ fullscreen: false, minimized: false })\n  }\n\n  render() {\n    const dialogProps = {\n      post: this.props.post,\n\n      minimized: this.state.minimized,\n      minimize: this.minimize,\n      open: this.open,\n\n      fullscreen: this.state.fullscreen,\n      fullscreenEnter: this.fullscreenEnter,\n      fullscreenExit: this.fullscreenExit,\n\n      close: this.onCancel,\n    }\n\n    if (this.state.error) {\n      return (\n        <PostingDialogEditReply {...dialogProps}>\n          <PostingDialogError message={this.state.error} close={this.close} />\n        </PostingDialogEditReply>\n      )\n    }\n\n    if (!this.state.isReady) {\n      return (\n        <PostingDialogEditReply {...dialogProps}>\n          <div className=\"posting-loading ui-preview\">\n            <MarkupEditor\n              attachments={[]}\n              value={\"\"}\n              submitText={pgettext(\"edit reply submit\", \"Edit reply\")}\n              disabled={true}\n              onAttachmentsChange={() => {}}\n              onChange={() => {}}\n            />\n          </div>\n        </PostingDialogEditReply>\n      )\n    }\n\n    return (\n      <PostingDialogEditReply {...dialogProps}>\n        <form\n          className=\"posting-dialog-form\"\n          method=\"POST\"\n          onSubmit={this.handleSubmit}\n        >\n          <MarkupEditor\n            attachments={this.state.attachments}\n            canProtect={this.state.canProtect}\n            isProtected={this.state.protect}\n            enableProtection={() => this.setState({ protect: true })}\n            disableProtection={() => this.setState({ protect: false })}\n            value={this.state.post}\n            submitText={pgettext(\"edit reply submit\", \"Edit reply\")}\n            disabled={this.state.isLoading}\n            onAttachmentsChange={this.onAttachmentsChange}\n            onChange={this.onPostChange}\n          />\n        </form>\n      </PostingDialogEditReply>\n    )\n  }\n}\n\nconst PostingDialogEditReply = ({\n  children,\n  close,\n  minimized,\n  minimize,\n  open,\n  fullscreen,\n  fullscreenEnter,\n  fullscreenExit,\n  post,\n}) => (\n  <PostingDialog fullscreen={fullscreen} minimized={minimized}>\n    <PostingDialogHeader\n      fullscreen={fullscreen}\n      fullscreenEnter={fullscreenEnter}\n      fullscreenExit={fullscreenExit}\n      minimized={minimized}\n      minimize={minimize}\n      open={open}\n      close={close}\n    >\n      {interpolate(\n        pgettext(\"edit reply\", \"Edit reply by %(poster)s from %(date)s\"),\n        {\n          poster: post.poster ? post.poster.username : post.poster_name,\n          date: post.posted_on.fromNow(),\n        },\n        true\n      )}\n    </PostingDialogHeader>\n    <PostingDialogBody>{children}</PostingDialogBody>\n  </PostingDialog>\n)\n","import React from \"react\"\nimport PostingQuoteSelection from \"./PostingQuoteSelection\"\nimport getQuoteMarkup from \"./getQuoteMarkup\"\nimport { clearGlobalState, getGlobalState, setGlobalState } from \"./globalState\"\nimport Start from \"./start\"\nimport StartPrivate from \"./start-private\"\nimport Reply from \"./reply\"\nimport Edit from \"./edit\"\n\nexport default function (props) {\n  switch (props.mode) {\n    case \"START\":\n      return <Start {...props} />\n\n    case \"START_PRIVATE\":\n      return <StartPrivate {...props} />\n\n    case \"REPLY\":\n      return <Reply {...props} />\n\n    case \"EDIT\":\n      return <Edit {...props} />\n\n    default:\n      return null\n  }\n}\n\nexport {\n  PostingQuoteSelection,\n  clearGlobalState,\n  getGlobalState,\n  getQuoteMarkup,\n  setGlobalState,\n}\n","const ytRegExp = new RegExp(\n  \"^.*(?:(?:youtu.be/|v/|vi/|u/w/|embed/)|(?:(?:watch)??v(?:i)?=|&v(?:i)?=))([^#&?]*).*\"\n)\n\nexport class OneBox {\n  constructor() {\n    this._youtube = {}\n  }\n\n  render = (element) => {\n    if (!element) return\n    this.highlightCode(element)\n    this.embedYoutubePlayers(element)\n  }\n\n  highlightCode(element) {\n    import(\"highlight\").then(({ default: hljs }) => {\n      const codeblocks = element.querySelectorAll(\"pre>code\")\n      for (let i = 0; i < codeblocks.length; i++) {\n        hljs.highlightElement(codeblocks[i])\n      }\n    })\n  }\n\n  embedYoutubePlayers(element) {\n    const anchors = element.querySelectorAll(\"p>a\")\n    for (let i = 0; i < anchors.length; i++) {\n      const a = anchors[i]\n      const p = a.parentNode\n      const onlyChild = p.childNodes.length === 1\n\n      if (!this._youtube[a.href]) {\n        this._youtube[a.href] = parseYoutubeUrl(a.href)\n      }\n\n      const youtubeMovie = this._youtube[a.href]\n      if (onlyChild && !!youtubeMovie && youtubeMovie.data !== false) {\n        this.swapYoutubePlayer(a, youtubeMovie)\n      }\n    }\n  }\n\n  swapYoutubePlayer(element, youtube) {\n    let url = \"https://www.youtube.com/embed/\"\n    url += youtube.video\n    url += \"?feature=oembed\"\n    if (youtube.start) {\n      url += \"&start=\" + youtube.start\n    }\n\n    const player = $(\n      '<iframe class=\"embed-responsive-item\" frameborder=\"0\" ' +\n        'src=\"' +\n        url +\n        '\" ' +\n        'allow=\"encrypted-media; gyroscope; picture-in-picture\" ' +\n        \"allowfullscreen></iframe>\"\n    )\n    $(element).replaceWith(player)\n    player.wrap('<div class=\"embed-responsive embed-responsive-16by9\"></div>')\n  }\n}\n\nexport default new OneBox()\n\nexport function parseYoutubeUrl(url) {\n  const cleanedUrl = cleanUrl(url)\n  const video = getVideoIdFromUrl(cleanedUrl)\n\n  if (!video) return null\n\n  let start = 0\n  if (cleanedUrl.indexOf(\"?\") > 0) {\n    const query = cleanedUrl.substr(cleanedUrl.indexOf(\"?\") + 1)\n    const timebit = query.split(\"&\").filter((i) => {\n      return i.substr(0, 2) === \"t=\"\n    })[0]\n\n    if (timebit) {\n      const bits = timebit.substr(2).split(\"m\")\n      if (bits[0].substr(-1) === \"s\") {\n        start += parseInt(bits[0].substr(0, bits[0].length - 1))\n      } else {\n        start += parseInt(bits[0]) * 60\n        if (!!bits[1] && bits[1].substr(-1) === \"s\") {\n          start += parseInt(bits[1].substr(0, bits[1].length - 1))\n        }\n      }\n    }\n  }\n\n  return {\n    start,\n    video,\n  }\n}\n\nexport function cleanUrl(url) {\n  let clean = url\n\n  if (url.substr(0, 8) === \"https://\") {\n    clean = clean.substr(8)\n  } else if (url.substr(0, 7) === \"http://\") {\n    clean = clean.substr(7)\n  }\n\n  if (clean.substr(0, 4) === \"www.\") {\n    clean = clean.substr(4)\n  }\n\n  return clean\n}\n\nexport function getVideoIdFromUrl(url) {\n  if (url.indexOf(\"youtu\") === -1) return null\n\n  const video = url.match(ytRegExp)\n  if (video) {\n    return video[1]\n  }\n  return null\n}\n","import classnames from \"classnames\"\nimport React from \"react\"\nimport onebox from \"misago/services/one-box\"\n\nexport default class extends React.Component {\n  componentDidMount() {\n    onebox.render(this.documentNode)\n    $(this.documentNode).find(\".spoiler-reveal\").click(revealSpoiler)\n  }\n\n  componentDidUpdate(prevProps, prevState) {\n    onebox.render(this.documentNode)\n    $(this.documentNode).find(\".spoiler-reveal\").click(revealSpoiler)\n  }\n\n  shouldComponentUpdate(nextProps, nextState) {\n    return nextProps.markup !== this.props.markup\n  }\n\n  render() {\n    return (\n      <article\n        className={classnames(\"misago-markup\", this.props.className)}\n        dangerouslySetInnerHTML={{ __html: this.props.markup }}\n        data-author={this.props.author || undefined}\n        ref={(node) => {\n          this.documentNode = node\n        }}\n      />\n    )\n  }\n}\n\nfunction revealSpoiler(event) {\n  var btn = event.target\n  $(btn).parent().parent().addClass(\"revealed\")\n}\n","var map = {\n\t\"./af\": 25177,\n\t\"./af.js\": 25177,\n\t\"./ar\": 61509,\n\t\"./ar-dz\": 41488,\n\t\"./ar-dz.js\": 41488,\n\t\"./ar-kw\": 58676,\n\t\"./ar-kw.js\": 58676,\n\t\"./ar-ly\": 42353,\n\t\"./ar-ly.js\": 42353,\n\t\"./ar-ma\": 24496,\n\t\"./ar-ma.js\": 24496,\n\t\"./ar-sa\": 82682,\n\t\"./ar-sa.js\": 82682,\n\t\"./ar-tn\": 89756,\n\t\"./ar-tn.js\": 89756,\n\t\"./ar.js\": 61509,\n\t\"./az\": 95533,\n\t\"./az.js\": 95533,\n\t\"./be\": 28959,\n\t\"./be.js\": 28959,\n\t\"./bg\": 47777,\n\t\"./bg.js\": 47777,\n\t\"./bm\": 54903,\n\t\"./bm.js\": 54903,\n\t\"./bn\": 61290,\n\t\"./bn-bd\": 17357,\n\t\"./bn-bd.js\": 17357,\n\t\"./bn.js\": 61290,\n\t\"./bo\": 31545,\n\t\"./bo.js\": 31545,\n\t\"./br\": 11470,\n\t\"./br.js\": 11470,\n\t\"./bs\": 44429,\n\t\"./bs.js\": 44429,\n\t\"./ca\": 7306,\n\t\"./ca.js\": 7306,\n\t\"./cs\": 56464,\n\t\"./cs.js\": 56464,\n\t\"./cv\": 73635,\n\t\"./cv.js\": 73635,\n\t\"./cy\": 64226,\n\t\"./cy.js\": 64226,\n\t\"./da\": 93601,\n\t\"./da.js\": 93601,\n\t\"./de\": 77853,\n\t\"./de-at\": 26111,\n\t\"./de-at.js\": 26111,\n\t\"./de-ch\": 54697,\n\t\"./de-ch.js\": 54697,\n\t\"./de.js\": 77853,\n\t\"./dv\": 60708,\n\t\"./dv.js\": 60708,\n\t\"./el\": 54691,\n\t\"./el.js\": 54691,\n\t\"./en-au\": 53872,\n\t\"./en-au.js\": 53872,\n\t\"./en-ca\": 28298,\n\t\"./en-ca.js\": 28298,\n\t\"./en-gb\": 56195,\n\t\"./en-gb.js\": 56195,\n\t\"./en-ie\": 66584,\n\t\"./en-ie.js\": 66584,\n\t\"./en-il\": 65543,\n\t\"./en-il.js\": 65543,\n\t\"./en-in\": 9033,\n\t\"./en-in.js\": 9033,\n\t\"./en-nz\": 79402,\n\t\"./en-nz.js\": 79402,\n\t\"./en-sg\": 43004,\n\t\"./en-sg.js\": 43004,\n\t\"./eo\": 32934,\n\t\"./eo.js\": 32934,\n\t\"./es\": 97650,\n\t\"./es-do\": 20838,\n\t\"./es-do.js\": 20838,\n\t\"./es-mx\": 17730,\n\t\"./es-mx.js\": 17730,\n\t\"./es-us\": 56575,\n\t\"./es-us.js\": 56575,\n\t\"./es.js\": 97650,\n\t\"./et\": 3035,\n\t\"./et.js\": 3035,\n\t\"./eu\": 3508,\n\t\"./eu.js\": 3508,\n\t\"./fa\": 119,\n\t\"./fa.js\": 119,\n\t\"./fi\": 90527,\n\t\"./fi.js\": 90527,\n\t\"./fil\": 95995,\n\t\"./fil.js\": 95995,\n\t\"./fo\": 52477,\n\t\"./fo.js\": 52477,\n\t\"./fr\": 85498,\n\t\"./fr-ca\": 26435,\n\t\"./fr-ca.js\": 26435,\n\t\"./fr-ch\": 37892,\n\t\"./fr-ch.js\": 37892,\n\t\"./fr.js\": 85498,\n\t\"./fy\": 37071,\n\t\"./fy.js\": 37071,\n\t\"./ga\": 41734,\n\t\"./ga.js\": 41734,\n\t\"./gd\": 70217,\n\t\"./gd.js\": 70217,\n\t\"./gl\": 77329,\n\t\"./gl.js\": 77329,\n\t\"./gom-deva\": 32124,\n\t\"./gom-deva.js\": 32124,\n\t\"./gom-latn\": 93383,\n\t\"./gom-latn.js\": 93383,\n\t\"./gu\": 95050,\n\t\"./gu.js\": 95050,\n\t\"./he\": 11713,\n\t\"./he.js\": 11713,\n\t\"./hi\": 43861,\n\t\"./hi.js\": 43861,\n\t\"./hr\": 26308,\n\t\"./hr.js\": 26308,\n\t\"./hu\": 90609,\n\t\"./hu.js\": 90609,\n\t\"./hy-am\": 17160,\n\t\"./hy-am.js\": 17160,\n\t\"./id\": 74063,\n\t\"./id.js\": 74063,\n\t\"./is\": 89374,\n\t\"./is.js\": 89374,\n\t\"./it\": 88383,\n\t\"./it-ch\": 21827,\n\t\"./it-ch.js\": 21827,\n\t\"./it.js\": 88383,\n\t\"./ja\": 23827,\n\t\"./ja.js\": 23827,\n\t\"./jv\": 89722,\n\t\"./jv.js\": 89722,\n\t\"./ka\": 41794,\n\t\"./ka.js\": 41794,\n\t\"./kk\": 27088,\n\t\"./kk.js\": 27088,\n\t\"./km\": 96870,\n\t\"./km.js\": 96870,\n\t\"./kn\": 84451,\n\t\"./kn.js\": 84451,\n\t\"./ko\": 63164,\n\t\"./ko.js\": 63164,\n\t\"./ku\": 98174,\n\t\"./ku.js\": 98174,\n\t\"./ky\": 78474,\n\t\"./ky.js\": 78474,\n\t\"./lb\": 79680,\n\t\"./lb.js\": 79680,\n\t\"./lo\": 15867,\n\t\"./lo.js\": 15867,\n\t\"./lt\": 45766,\n\t\"./lt.js\": 45766,\n\t\"./lv\": 69532,\n\t\"./lv.js\": 69532,\n\t\"./me\": 58076,\n\t\"./me.js\": 58076,\n\t\"./mi\": 41848,\n\t\"./mi.js\": 41848,\n\t\"./mk\": 30306,\n\t\"./mk.js\": 30306,\n\t\"./ml\": 73739,\n\t\"./ml.js\": 73739,\n\t\"./mn\": 99053,\n\t\"./mn.js\": 99053,\n\t\"./mr\": 86169,\n\t\"./mr.js\": 86169,\n\t\"./ms\": 73386,\n\t\"./ms-my\": 92297,\n\t\"./ms-my.js\": 92297,\n\t\"./ms.js\": 73386,\n\t\"./mt\": 77075,\n\t\"./mt.js\": 77075,\n\t\"./my\": 72264,\n\t\"./my.js\": 72264,\n\t\"./nb\": 22274,\n\t\"./nb.js\": 22274,\n\t\"./ne\": 8235,\n\t\"./ne.js\": 8235,\n\t\"./nl\": 92572,\n\t\"./nl-be\": 43784,\n\t\"./nl-be.js\": 43784,\n\t\"./nl.js\": 92572,\n\t\"./nn\": 54566,\n\t\"./nn.js\": 54566,\n\t\"./oc-lnc\": 69330,\n\t\"./oc-lnc.js\": 69330,\n\t\"./pa-in\": 29849,\n\t\"./pa-in.js\": 29849,\n\t\"./pl\": 94418,\n\t\"./pl.js\": 94418,\n\t\"./pt\": 79834,\n\t\"./pt-br\": 48303,\n\t\"./pt-br.js\": 48303,\n\t\"./pt.js\": 79834,\n\t\"./ro\": 24457,\n\t\"./ro.js\": 24457,\n\t\"./ru\": 82271,\n\t\"./ru.js\": 82271,\n\t\"./sd\": 1221,\n\t\"./sd.js\": 1221,\n\t\"./se\": 33478,\n\t\"./se.js\": 33478,\n\t\"./si\": 17538,\n\t\"./si.js\": 17538,\n\t\"./sk\": 5784,\n\t\"./sk.js\": 5784,\n\t\"./sl\": 46637,\n\t\"./sl.js\": 46637,\n\t\"./sq\": 86794,\n\t\"./sq.js\": 86794,\n\t\"./sr\": 45719,\n\t\"./sr-cyrl\": 3322,\n\t\"./sr-cyrl.js\": 3322,\n\t\"./sr.js\": 45719,\n\t\"./ss\": 56000,\n\t\"./ss.js\": 56000,\n\t\"./sv\": 41011,\n\t\"./sv.js\": 41011,\n\t\"./sw\": 40748,\n\t\"./sw.js\": 40748,\n\t\"./ta\": 11025,\n\t\"./ta.js\": 11025,\n\t\"./te\": 11885,\n\t\"./te.js\": 11885,\n\t\"./tet\": 28861,\n\t\"./tet.js\": 28861,\n\t\"./tg\": 86571,\n\t\"./tg.js\": 86571,\n\t\"./th\": 55802,\n\t\"./th.js\": 55802,\n\t\"./tk\": 59527,\n\t\"./tk.js\": 59527,\n\t\"./tl-ph\": 29231,\n\t\"./tl-ph.js\": 29231,\n\t\"./tlh\": 31052,\n\t\"./tlh.js\": 31052,\n\t\"./tr\": 85096,\n\t\"./tr.js\": 85096,\n\t\"./tzl\": 79846,\n\t\"./tzl.js\": 79846,\n\t\"./tzm\": 81765,\n\t\"./tzm-latn\": 97711,\n\t\"./tzm-latn.js\": 97711,\n\t\"./tzm.js\": 81765,\n\t\"./ug-cn\": 48414,\n\t\"./ug-cn.js\": 48414,\n\t\"./uk\": 16618,\n\t\"./uk.js\": 16618,\n\t\"./ur\": 57777,\n\t\"./ur.js\": 57777,\n\t\"./uz\": 57609,\n\t\"./uz-latn\": 72475,\n\t\"./uz-latn.js\": 72475,\n\t\"./uz.js\": 57609,\n\t\"./vi\": 21135,\n\t\"./vi.js\": 21135,\n\t\"./x-pseudo\": 64051,\n\t\"./x-pseudo.js\": 64051,\n\t\"./yo\": 82218,\n\t\"./yo.js\": 82218,\n\t\"./zh-cn\": 52648,\n\t\"./zh-cn.js\": 52648,\n\t\"./zh-hk\": 1632,\n\t\"./zh-hk.js\": 1632,\n\t\"./zh-mo\": 31541,\n\t\"./zh-mo.js\": 31541,\n\t\"./zh-tw\": 50304,\n\t\"./zh-tw.js\": 50304\n};\n\n\nfunction webpackContext(req) {\n\tvar id = webpackContextResolve(req);\n\treturn __webpack_require__(id);\n}\nfunction webpackContextResolve(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t}\n\treturn map[req];\n}\nwebpackContext.keys = function webpackContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackContext.resolve = webpackContextResolve;\nmodule.exports = webpackContext;\nwebpackContext.id = 35358;","import React from \"react\"\nimport ReactDOM from \"react-dom\"\nimport { Provider } from \"react-redux\"\nimport { SearchOverlay } from \"../../components/search\"\nimport store from \"../../services/store\"\n\nexport default function initializer(context) {\n  const root = document.getElementById(\"search-mount\")\n  ReactDOM.render(\n    <Provider store={store.getStore()}>\n      <SearchOverlay />\n    </Provider>,\n    root\n  )\n}\n\nmisago.addInitializer({\n  name: \"component:search-overlay\",\n  initializer: initializer,\n  after: \"store\",\n})\n","/* global grecaptcha */\nimport React from \"react\"\nimport FormGroup from \"misago/components/form-group\"\n\nexport class BaseCaptcha {\n  init(context, ajax, include, snackbar) {\n    this._context = context\n    this._ajax = ajax\n    this._include = include\n    this._snackbar = snackbar\n  }\n}\n\nexport class NoCaptcha extends BaseCaptcha {\n  load() {\n    return new Promise(function (resolve) {\n      // immediately resolve as we don't have anything to validate\n      resolve()\n    })\n  }\n\n  validator() {\n    return null\n  }\n\n  component() {\n    return null\n  }\n}\n\nexport class QACaptcha extends BaseCaptcha {\n  load() {\n    var self = this\n    return new Promise((resolve, reject) => {\n      self._ajax.get(self._context.get(\"CAPTCHA_API\")).then(\n        function (data) {\n          self.question = data.question\n          self.helpText = data.help_text\n          resolve()\n        },\n        function () {\n          self._snackbar.error(\n            pgettext(\"captcha field\", \"Failed to load CAPTCHA.\")\n          )\n          reject()\n        }\n      )\n    })\n  }\n\n  validator() {\n    return []\n  }\n\n  component(kwargs) {\n    return (\n      <FormGroup\n        label={this.question}\n        for=\"id_captcha\"\n        labelClass={kwargs.labelClass || \"\"}\n        controlClass={kwargs.controlClass || \"\"}\n        validation={kwargs.form.state.errors.captcha}\n        helpText={this.helpText || null}\n      >\n        <input\n          aria-describedby=\"id_captcha_status\"\n          className=\"form-control\"\n          disabled={kwargs.form.state.isLoading}\n          id=\"id_captcha\"\n          onChange={kwargs.form.bindInput(\"captcha\")}\n          type=\"text\"\n          value={kwargs.form.state.captcha}\n        />\n      </FormGroup>\n    )\n  }\n}\n\nexport class ReCaptchaComponent extends React.Component {\n  componentDidMount() {\n    grecaptcha.render(\"recaptcha\", {\n      sitekey: this.props.siteKey,\n      callback: (response) => {\n        // fire fakey event to binding\n        this.props.binding({\n          target: {\n            value: response,\n          },\n        })\n      },\n    })\n  }\n\n  render() {\n    return <div id=\"recaptcha\" />\n  }\n}\n\nexport class ReCaptcha extends BaseCaptcha {\n  load() {\n    this._include.include(\"https://www.google.com/recaptcha/api.js\", true)\n\n    return new Promise(function (resolve) {\n      var wait = function () {\n        if (typeof grecaptcha === \"undefined\") {\n          window.setTimeout(function () {\n            wait()\n          }, 200)\n        } else {\n          resolve()\n        }\n      }\n      wait()\n    })\n  }\n\n  validator() {\n    return []\n  }\n\n  component(kwargs) {\n    return (\n      <FormGroup\n        label={pgettext(\"captcha field\", \"Please solve the quick test\")}\n        for=\"id_captcha\"\n        labelClass={kwargs.labelClass || \"\"}\n        controlClass={kwargs.controlClass || \"\"}\n        validation={kwargs.form.state.errors.captcha}\n        helpText={pgettext(\n          \"captcha field\",\n          \"This test helps us prevent automated spam registrations on the site.\"\n        )}\n      >\n        <ReCaptchaComponent\n          binding={kwargs.form.bindInput(\"captcha\")}\n          siteKey={this._context.get(\"SETTINGS\").recaptcha_site_key}\n        />\n      </FormGroup>\n    )\n  }\n}\n\nexport class Captcha {\n  init(context, ajax, include, snackbar) {\n    switch (context.get(\"SETTINGS\").captcha_type) {\n      case \"no\":\n        this._captcha = new NoCaptcha()\n        break\n\n      case \"qa\":\n        this._captcha = new QACaptcha()\n        break\n\n      case \"re\":\n        this._captcha = new ReCaptcha()\n        break\n    }\n\n    this._captcha.init(context, ajax, include, snackbar)\n  }\n\n  // accessors for underlying strategy\n\n  load() {\n    return this._captcha.load()\n  }\n\n  validator() {\n    return this._captcha.validator()\n  }\n\n  component(kwargs) {\n    return this._captcha.component(kwargs)\n  }\n}\n\nexport default new Captcha()\n","import moment from \"moment\"\nimport { UPDATE_AVATAR, UPDATE_USERNAME } from \"misago/reducers/users\"\nimport concatUnique from \"misago/utils/concat-unique\"\n\nexport const ADD_NAME_CHANGE = \"ADD_NAME_CHANGE\"\nexport const APPEND_HISTORY = \"APPEND_HISTORY\"\nexport const HYDRATE_HISTORY = \"HYDRATE_HISTORY\"\n\nexport function addNameChange(change, user, changedBy) {\n  return {\n    type: ADD_NAME_CHANGE,\n    change,\n    user,\n    changedBy,\n  }\n}\n\nexport function append(items) {\n  return {\n    type: APPEND_HISTORY,\n    items: items,\n  }\n}\n\nexport function hydrate(items) {\n  return {\n    type: HYDRATE_HISTORY,\n    items: items,\n  }\n}\n\nexport function hydrateNamechange(namechange) {\n  return Object.assign({}, namechange, {\n    changed_on: moment(namechange.changed_on),\n  })\n}\n\nexport default function username(state = [], action = null) {\n  switch (action.type) {\n    case ADD_NAME_CHANGE:\n      let newState = state.slice()\n      newState.unshift({\n        id: Math.floor(Date.now() / 1000), // just small hax for getting id\n        changed_by: action.changedBy,\n        changed_by_username: action.changedBy.username,\n        changed_on: moment(),\n        new_username: action.change.username,\n        old_username: action.user.username,\n      })\n      return newState\n\n    case APPEND_HISTORY:\n      return concatUnique(state, action.items.map(hydrateNamechange))\n\n    case HYDRATE_HISTORY:\n      return action.items.map(hydrateNamechange)\n\n    case UPDATE_AVATAR:\n      return state.map(function (item) {\n        item = Object.assign({}, item)\n        if (item.changed_by && item.changed_by.id === action.userId) {\n          item.changed_by = Object.assign({}, item.changed_by, {\n            avatars: action.avatars,\n          })\n        }\n\n        return item\n      })\n\n    case UPDATE_USERNAME:\n      return state.map(function (item) {\n        item = Object.assign({}, item)\n        if (item.changed_by && item.changed_by.id === action.userId) {\n          item.changed_by = Object.assign({}, item.changed_by, {\n            username: action.username,\n            slug: action.slug,\n          })\n        }\n\n        return Object.assign({}, item)\n      })\n\n    default:\n      return state\n  }\n}\n","document.body.addEventListener(\"click\", (event) => {\n  const selector = event.target.getAttribute(\"misago-focus-on\")\n  if (!!selector) {\n    event.preventDefault()\n    const element = document.querySelector(selector)\n    if (element) {\n      element.focus()\n    }\n  }\n})\n","import React from \"react\"\nimport Loader from \"./loader\"\n\nexport default class Button extends React.Component {\n  render() {\n    let className = \"btn \" + this.props.className\n    let disabled = this.props.disabled\n\n    if (this.props.loading) {\n      className += \" btn-loading\"\n      disabled = true\n    }\n\n    return (\n      <button\n        className={className}\n        disabled={disabled}\n        onClick={this.props.onClick}\n        type={this.props.onClick ? \"button\" : \"submit\"}\n      >\n        {this.props.children}\n        {this.props.loading ? <Loader /> : null}\n      </button>\n    )\n  }\n}\n\nButton.defaultProps = {\n  className: \"btn-default\",\n\n  type: \"submit\",\n\n  loading: false,\n  disabled: false,\n\n  onClick: null,\n}\n","import { toggle } from \"misago/utils/sets\"\n\nexport const SELECT_ALL = \"SELECT_ALL\"\nexport const SELECT_NONE = \"SELECT_NONE\"\nexport const SELECT_ITEM = \"SELECT_ITEM\"\n\nexport function all(itemsIds) {\n  return {\n    type: SELECT_ALL,\n    items: itemsIds,\n  }\n}\n\nexport function none() {\n  return {\n    type: SELECT_NONE,\n  }\n}\n\nexport function item(itemId) {\n  return {\n    type: SELECT_ITEM,\n    item: itemId,\n  }\n}\n\nexport default function selection(state = [], action = null) {\n  switch (action.type) {\n    case SELECT_ALL:\n      return action.items\n\n    case SELECT_NONE:\n      return []\n\n    case SELECT_ITEM:\n      return toggle(state, action.item)\n\n    default:\n      return state\n  }\n}\n","export function push(array, value) {\n  if (array.indexOf(value) === -1) {\n    let copy = array.slice()\n    copy.push(value)\n    return copy\n  } else {\n    return array\n  }\n}\n\nexport function remove(array, value) {\n  if (array.indexOf(value) >= 0) {\n    return array.filter(function (i) {\n      return i !== value\n    })\n  } else {\n    return array\n  }\n}\n\nexport function toggle(array, value) {\n  if (array.indexOf(value) === -1) {\n    let copy = array.slice()\n    copy.push(value)\n    return copy\n  } else {\n    return array.filter(function (i) {\n      return i !== value\n    })\n  }\n}\n","import misago from \"misago/index\"\nimport reducer from \"misago/reducers/selection\"\nimport store from \"misago/services/store\"\n\nexport default function initializer() {\n  store.addReducer(\"selection\", reducer, [])\n}\n\nmisago.addInitializer({\n  name: \"reducer:selection\",\n  initializer: initializer,\n  before: \"store\",\n})\n","export class PageTitle {\n  init(indexTitle, forumName) {\n    this._indexTitle = indexTitle\n    this._forumName = forumName\n  }\n\n  set(title) {\n    if (!title) {\n      document.title = this._indexTitle || this._forumName\n      return\n    }\n\n    if (typeof title === \"string\") {\n      title = { title: title }\n    }\n\n    let finalTitle = title.title\n\n    if (title.page > 1) {\n      const pageLabel = interpolate(\n        pgettext(\"page title pagination\", \"page: %(page)s\"),\n        {\n          page: title.page,\n        },\n        true\n      )\n\n      finalTitle += \" (\" + pageLabel + \")\"\n    }\n\n    if (title.parent) {\n      finalTitle += \" | \" + title.parent\n    }\n\n    document.title = finalTitle + \" | \" + this._forumName\n  }\n}\n\nexport default new PageTitle()\n","import React from \"react\"\nimport Avatar from \"misago/components/avatar\"\nimport Button from \"misago/components/button\"\nimport Loader from \"misago/components/loader\"\nimport ajax from \"misago/services/ajax\"\nimport snackbar from \"misago/services/snackbar\"\n\nexport default class extends React.Component {\n  constructor(props) {\n    super(props)\n\n    this.state = {\n      isLoading: false,\n    }\n  }\n\n  callApi(avatarType) {\n    if (this.state.isLoading) {\n      return false\n    }\n\n    this.setState({\n      isLoading: true,\n    })\n\n    ajax\n      .post(this.props.user.api.avatar, {\n        avatar: avatarType,\n      })\n      .then(\n        (response) => {\n          this.setState({\n            isLoading: false,\n          })\n\n          snackbar.success(response.detail)\n          this.props.onComplete(response)\n        },\n        (rejection) => {\n          if (rejection.status === 400) {\n            snackbar.error(rejection.detail)\n            this.setState({\n              isLoading: false,\n            })\n          } else {\n            this.props.showError(rejection)\n          }\n        }\n      )\n  }\n\n  setGravatar = () => {\n    this.callApi(\"gravatar\")\n  }\n\n  setGenerated = () => {\n    this.callApi(\"generated\")\n  }\n\n  getGravatarButton() {\n    if (this.props.options.gravatar) {\n      return (\n        <Button\n          onClick={this.setGravatar}\n          disabled={this.state.isLoading}\n          className=\"btn-default btn-block btn-avatar-gravatar\"\n        >\n          {pgettext(\"avatar modal btn\", \"Download my Gravatar\")}\n        </Button>\n      )\n    } else {\n      return null\n    }\n  }\n\n  getCropButton() {\n    if (!this.props.options.crop_src) return null\n\n    return (\n      <Button\n        className=\"btn-default btn-block btn-avatar-crop\"\n        disabled={this.state.isLoading}\n        onClick={this.props.showCrop}\n      >\n        {pgettext(\"avatar modal btn\", \"Re-crop uploaded image\")}\n      </Button>\n    )\n  }\n\n  getUploadButton() {\n    if (!this.props.options.upload) return null\n\n    return (\n      <Button\n        className=\"btn-default btn-block btn-avatar-upload\"\n        disabled={this.state.isLoading}\n        onClick={this.props.showUpload}\n      >\n        {pgettext(\"avatar modal btn\", \"Upload new image\")}\n      </Button>\n    )\n  }\n\n  getGalleryButton() {\n    if (!this.props.options.galleries) return null\n\n    return (\n      <Button\n        className=\"btn-default btn-block btn-avatar-gallery\"\n        disabled={this.state.isLoading}\n        onClick={this.props.showGallery}\n      >\n        {pgettext(\"avatar modal btn\", \"Pick avatar from gallery\")}\n      </Button>\n    )\n  }\n\n  getAvatarPreview() {\n    let userPeview = {\n      id: this.props.user.id,\n      avatars: this.props.options.avatars,\n    }\n\n    if (this.state.isLoading) {\n      return (\n        <div className=\"avatar-preview preview-loading\">\n          <Avatar size=\"200\" user={userPeview} />\n          <Loader />\n        </div>\n      )\n    }\n\n    return (\n      <div className=\"avatar-preview\">\n        <Avatar size=\"200\" user={userPeview} />\n      </div>\n    )\n  }\n\n  render() {\n    return (\n      <div className=\"modal-body modal-avatar-index\">\n        <div className=\"row\">\n          <div className=\"col-md-5\">{this.getAvatarPreview()}</div>\n          <div className=\"col-md-7\">\n            {this.getGravatarButton()}\n\n            <Button\n              onClick={this.setGenerated}\n              disabled={this.state.isLoading}\n              className=\"btn-default btn-block btn-avatar-generate\"\n            >\n              {pgettext(\"avatar modal btn\", \"Generate my individual avatar\")}\n            </Button>\n\n            {this.getCropButton()}\n            {this.getUploadButton()}\n            {this.getGalleryButton()}\n          </div>\n        </div>\n      </div>\n    )\n  }\n}\n","import React from \"react\"\nimport Avatar from \"misago/components/avatar\"\nimport Button from \"misago/components/button\"\nimport ajax from \"misago/services/ajax\"\nimport snackbar from \"misago/services/snackbar\"\n\nexport default class extends React.Component {\n  constructor(props) {\n    super(props)\n\n    this.state = {\n      isLoading: false,\n      deviceRatio: 1,\n    }\n  }\n\n  getAvatarSize() {\n    if (this.props.upload) {\n      return this.props.options.crop_tmp.size\n    } else {\n      return this.props.options.crop_src.size\n    }\n  }\n\n  getImagePath() {\n    if (this.props.upload) {\n      return this.props.dataUrl\n    } else {\n      return this.props.options.crop_src.url\n    }\n  }\n\n  componentDidMount() {\n    let cropit = $(\".crop-form\")\n    let cropperWidth = this.getAvatarSize()\n\n    const initialWidth = cropit.width()\n    while (initialWidth < cropperWidth) {\n      cropperWidth = cropperWidth / 2\n    }\n\n    const deviceRatio = this.getAvatarSize() / cropperWidth\n\n    cropit.width(cropperWidth)\n\n    cropit.cropit({\n      width: cropperWidth,\n      height: cropperWidth,\n      exportZoom: deviceRatio,\n      imageState: {\n        src: this.getImagePath(),\n      },\n      onImageLoaded: () => {\n        if (this.props.upload) {\n          // center uploaded image\n          let zoomLevel = cropit.cropit(\"zoom\")\n          let imageSize = cropit.cropit(\"imageSize\")\n\n          // is it wider than taller?\n          if (imageSize.width > imageSize.height) {\n            let displayedWidth = imageSize.width * zoomLevel\n            let offsetX = (displayedWidth - this.getAvatarSize()) / -2\n\n            cropit.cropit(\"offset\", {\n              x: offsetX,\n              y: 0,\n            })\n          } else if (imageSize.width < imageSize.height) {\n            let displayedHeight = imageSize.height * zoomLevel\n            let offsetY = (displayedHeight - this.getAvatarSize()) / -2\n\n            cropit.cropit(\"offset\", {\n              x: 0,\n              y: offsetY,\n            })\n          } else {\n            cropit.cropit(\"offset\", {\n              x: 0,\n              y: 0,\n            })\n          }\n        } else {\n          // use preserved crop\n          let crop = this.props.options.crop_src.crop\n\n          if (crop) {\n            cropit.cropit(\"zoom\", crop.zoom)\n            cropit.cropit(\"offset\", {\n              x: crop.x,\n              y: crop.y,\n            })\n          }\n        }\n      },\n    })\n  }\n\n  componentWillUnmount() {\n    $(\".crop-form\").cropit(\"disable\")\n  }\n\n  cropAvatar = () => {\n    if (this.state.isLoading) {\n      return false\n    }\n\n    this.setState({\n      isLoading: true,\n    })\n\n    let avatarType = this.props.upload ? \"crop_tmp\" : \"crop_src\"\n    let cropit = $(\".crop-form\")\n\n    const deviceRatio = cropit.cropit(\"exportZoom\")\n    const cropitOffset = cropit.cropit(\"offset\")\n\n    ajax\n      .post(this.props.user.api.avatar, {\n        avatar: avatarType,\n        crop: {\n          offset: {\n            x: cropitOffset.x * deviceRatio,\n            y: cropitOffset.y * deviceRatio,\n          },\n          zoom: cropit.cropit(\"zoom\") * deviceRatio,\n        },\n      })\n      .then(\n        (data) => {\n          this.props.onComplete(data)\n          snackbar.success(data.detail)\n        },\n        (rejection) => {\n          if (rejection.status === 400) {\n            snackbar.error(rejection.detail)\n            this.setState({\n              isLoading: false,\n            })\n          } else {\n            this.props.showError(rejection)\n          }\n        }\n      )\n  }\n\n  render() {\n    return (\n      <div>\n        <div className=\"modal-body modal-avatar-crop\">\n          <div className=\"crop-form\">\n            <div className=\"cropit-preview\" />\n            <input type=\"range\" className=\"cropit-image-zoom-input\" />\n          </div>\n        </div>\n        <div className=\"modal-footer\">\n          <div className=\"col-md-6 col-md-offset-3\">\n            <Button\n              onClick={this.cropAvatar}\n              loading={this.state.isLoading}\n              className=\"btn-primary btn-block\"\n            >\n              {this.props.upload\n                ? pgettext(\"avatar crop modal btn\", \"Set avatar\")\n                : pgettext(\"avatar crop modal btn\", \"Crop image\")}\n            </Button>\n\n            <Button\n              onClick={this.props.showIndex}\n              disabled={this.state.isLoading}\n              className=\"btn-default btn-block\"\n            >\n              {pgettext(\"avatar crop modal btn\", \"Cancel\")}\n            </Button>\n          </div>\n        </div>\n      </div>\n    )\n  }\n}\n","import React from \"react\"\nimport AvatarCrop from \"misago/components/change-avatar/crop\"\nimport Button from \"misago/components/button\"\nimport ajax from \"misago/services/ajax\"\nimport snackbar from \"misago/services/snackbar\"\nimport fileSize from \"misago/utils/file-size\"\n\nexport default class extends React.Component {\n  constructor(props) {\n    super(props)\n\n    this.state = {\n      image: null,\n      preview: null,\n      progress: 0,\n      uploaded: null,\n      dataUrl: null,\n    }\n  }\n\n  validateFile(image) {\n    if (image.size > this.props.options.upload.limit) {\n      return interpolate(\n        pgettext(\n          \"avatar upload modal\",\n          \"Selected file is too big. (%(filesize)s)\"\n        ),\n        {\n          filesize: fileSize(image.size),\n        },\n        true\n      )\n    }\n\n    let invalidTypeMsg = pgettext(\n      \"avatar upload modal\",\n      \"Selected file type is not supported.\"\n    )\n    if (\n      this.props.options.upload.allowed_mime_types.indexOf(image.type) === -1\n    ) {\n      return invalidTypeMsg\n    }\n\n    let extensionFound = false\n    let loweredFilename = image.name.toLowerCase()\n    this.props.options.upload.allowed_extensions.map(function (extension) {\n      if (loweredFilename.substr(extension.length * -1) === extension) {\n        extensionFound = true\n      }\n    })\n\n    if (!extensionFound) {\n      return invalidTypeMsg\n    }\n\n    return false\n  }\n\n  pickFile = () => {\n    document.getElementById(\"avatar-hidden-upload\").click()\n  }\n\n  uploadFile = () => {\n    let image = document.getElementById(\"avatar-hidden-upload\").files[0]\n    if (!image) return\n\n    let validationError = this.validateFile(image)\n    if (validationError) {\n      snackbar.error(validationError)\n      return\n    }\n\n    this.setState({\n      image,\n      preview: URL.createObjectURL(image),\n      progress: 0,\n    })\n\n    let data = new FormData()\n    data.append(\"avatar\", \"upload\")\n    data.append(\"image\", image)\n\n    ajax\n      .upload(this.props.user.api.avatar, data, (progress) => {\n        this.setState({\n          progress,\n        })\n      })\n      .then(\n        (data) => {\n          this.setState({\n            options: data,\n            uploaded: data.detail,\n          })\n\n          snackbar.info(\n            pgettext(\n              \"avatar upload modal\",\n              \"Your image has been uploaded and you may now crop it.\"\n            )\n          )\n        },\n        (rejection) => {\n          if (rejection.status === 400 || rejection.status === 413) {\n            snackbar.error(rejection.detail)\n            this.setState({\n              isLoading: false,\n              image: null,\n              progress: 0,\n            })\n          } else {\n            this.props.showError(rejection)\n          }\n        }\n      )\n  }\n\n  getUploadRequirements(options) {\n    let extensions = options.allowed_extensions.map(function (extension) {\n      return extension.substr(1)\n    })\n\n    return interpolate(\n      pgettext(\"avatar upload modal\", \"%(files)s files smaller than %(limit)s\"),\n      {\n        files: extensions.join(\", \"),\n        limit: fileSize(options.limit),\n      },\n      true\n    )\n  }\n\n  getUploadButton() {\n    return (\n      <div className=\"modal-body modal-avatar-upload\">\n        <Button className=\"btn-pick-file\" onClick={this.pickFile}>\n          <div className=\"material-icon\">input</div>\n          {pgettext(\"avatar upload modal field\", \"Select file\")}\n        </Button>\n        <p className=\"text-muted\">\n          {this.getUploadRequirements(this.props.options.upload)}\n        </p>\n      </div>\n    )\n  }\n\n  getUploadProgressLabel() {\n    return interpolate(\n      pgettext(\"avatar upload modal field\", \"%(progress)s % complete\"),\n      {\n        progress: this.state.progress,\n      },\n      true\n    )\n  }\n\n  getUploadProgress() {\n    return (\n      <div className=\"modal-body modal-avatar-upload\">\n        <div className=\"upload-progress\">\n          <img src={this.state.preview} />\n\n          <div className=\"progress\">\n            <div\n              className=\"progress-bar\"\n              role=\"progressbar\"\n              aria-valuenow=\"{this.state.progress}\"\n              aria-valuemin=\"0\"\n              aria-valuemax=\"100\"\n              style={{ width: this.state.progress + \"%\" }}\n            >\n              <span className=\"sr-only\">{this.getUploadProgressLabel()}</span>\n            </div>\n          </div>\n        </div>\n      </div>\n    )\n  }\n\n  renderUpload() {\n    return (\n      <div>\n        <input\n          type=\"file\"\n          id=\"avatar-hidden-upload\"\n          className=\"hidden-file-upload\"\n          onChange={this.uploadFile}\n        />\n        {this.state.image ? this.getUploadProgress() : this.getUploadButton()}\n        <div className=\"modal-footer\">\n          <div className=\"col-md-6 col-md-offset-3\">\n            <Button\n              onClick={this.props.showIndex}\n              disabled={!!this.state.image}\n              className=\"btn-default btn-block\"\n            >\n              {pgettext(\"avatar upload modal btn\", \"Cancel\")}\n            </Button>\n          </div>\n        </div>\n      </div>\n    )\n  }\n\n  renderCrop() {\n    return (\n      <AvatarCrop\n        options={this.state.options}\n        user={this.props.user}\n        upload={this.state.uploaded}\n        dataUrl={this.state.preview}\n        onComplete={this.props.onComplete}\n        showError={this.props.showError}\n        showIndex={this.props.showIndex}\n      />\n    )\n  }\n\n  render() {\n    if (this.state.uploaded) return this.renderCrop()\n\n    return this.renderUpload()\n  }\n}\n","import React from \"react\"\nimport Avatar from \"misago/components/avatar\"\nimport Button from \"misago/components/button\"\nimport misago from \"misago/index\"\nimport ajax from \"misago/services/ajax\"\nimport snackbar from \"misago/services/snackbar\"\nimport batch from \"misago/utils/batch\"\n\nexport class GalleryItem extends React.Component {\n  select = () => {\n    this.props.select(this.props.id)\n  }\n\n  getClassName() {\n    if (this.props.selection === this.props.id) {\n      if (this.props.disabled) {\n        return \"btn btn-avatar btn-disabled avatar-selected\"\n      } else {\n        return \"btn btn-avatar avatar-selected\"\n      }\n    } else if (this.props.disabled) {\n      return \"btn btn-avatar btn-disabled\"\n    } else {\n      return \"btn btn-avatar\"\n    }\n  }\n\n  render() {\n    return (\n      <button\n        type=\"button\"\n        className={this.getClassName()}\n        disabled={this.props.disabled}\n        onClick={this.select}\n      >\n        <img src={this.props.url} />\n      </button>\n    )\n  }\n}\n\nexport class Gallery extends React.Component {\n  render() {\n    return (\n      <div className=\"avatars-gallery\">\n        <h3>{this.props.name}</h3>\n\n        <div className=\"avatars-gallery-images\">\n          {batch(this.props.images, 4, null).map((row, i) => {\n            return (\n              <div className=\"row\" key={i}>\n                {row.map((item, i) => {\n                  return (\n                    <div className=\"col-xs-3\" key={i}>\n                      {item ? (\n                        <GalleryItem\n                          disabled={this.props.disabled}\n                          select={this.props.select}\n                          selection={this.props.selection}\n                          {...item}\n                        />\n                      ) : (\n                        <div className=\"blank-avatar\" />\n                      )}\n                    </div>\n                  )\n                })}\n              </div>\n            )\n          })}\n        </div>\n      </div>\n    )\n  }\n}\n\nexport default class extends React.Component {\n  constructor(props) {\n    super(props)\n\n    this.state = {\n      selection: null,\n      isLoading: false,\n    }\n  }\n\n  select = (image) => {\n    this.setState({\n      selection: image,\n    })\n  }\n\n  save = () => {\n    if (this.state.isLoading) {\n      return false\n    }\n\n    this.setState({\n      isLoading: true,\n    })\n\n    ajax\n      .post(this.props.user.api.avatar, {\n        avatar: \"galleries\",\n        image: this.state.selection,\n      })\n      .then(\n        (response) => {\n          this.setState({\n            isLoading: false,\n          })\n\n          snackbar.success(response.detail)\n          this.props.onComplete(response)\n          this.props.showIndex()\n        },\n        (rejection) => {\n          if (rejection.status === 400) {\n            snackbar.error(rejection.detail)\n            this.setState({\n              isLoading: false,\n            })\n          } else {\n            this.props.showError(rejection)\n          }\n        }\n      )\n  }\n\n  render() {\n    return (\n      <div>\n        <div className=\"modal-body modal-avatar-gallery\">\n          {this.props.options.galleries.map((item, i) => {\n            return (\n              <Gallery\n                name={item.name}\n                images={item.images}\n                selection={this.state.selection}\n                disabled={this.state.isLoading}\n                select={this.select}\n                key={i}\n              />\n            )\n          })}\n        </div>\n        <div className=\"modal-footer\">\n          <div className=\"row\">\n            <div className=\"col-md-6 col-md-offset-3\">\n              <Button\n                onClick={this.save}\n                loading={this.state.isLoading}\n                disabled={!this.state.selection}\n                className=\"btn-primary btn-block\"\n              >\n                {this.state.selection\n                  ? pgettext(\"avatar gallery modal btn\", \"Save choice\")\n                  : pgettext(\"avatar gallery modal btn\", \"Select avatar\")}\n              </Button>\n\n              <Button\n                onClick={this.props.showIndex}\n                disabled={this.state.isLoading}\n                className=\"btn-default btn-block\"\n              >\n                {pgettext(\"avatar gallery modal btn\", \"Cancel\")}\n              </Button>\n            </div>\n          </div>\n        </div>\n      </div>\n    )\n  }\n}\n","import React from \"react\"\nimport AvatarIndex from \"misago/components/change-avatar/index\"\nimport AvatarCrop from \"misago/components/change-avatar/crop\"\nimport AvatarUpload from \"misago/components/change-avatar/upload\"\nimport AvatarGallery from \"misago/components/change-avatar/gallery\"\nimport Loader from \"misago/components/modal-loader\"\nimport { updateAvatar } from \"misago/reducers/users\"\nimport ajax from \"misago/services/ajax\"\nimport store from \"misago/services/store\"\n\nexport class ChangeAvatarError extends React.Component {\n  getErrorReason() {\n    if (this.props.reason) {\n      return <p dangerouslySetInnerHTML={{ __html: this.props.reason }} />\n    } else {\n      return null\n    }\n  }\n\n  render() {\n    return (\n      <div className=\"modal-body\">\n        <div className=\"message-icon\">\n          <span className=\"material-icon\">remove_circle_outline</span>\n        </div>\n        <div className=\"message-body\">\n          <p className=\"lead\">{this.props.message}</p>\n          {this.getErrorReason()}\n          <button\n            className=\"btn btn-default\"\n            data-dismiss=\"modal\"\n            type=\"button\"\n          >\n            {pgettext(\"avatar modal dismiss\", \"Ok\")}\n          </button>\n        </div>\n      </div>\n    )\n  }\n}\n\nexport default class extends React.Component {\n  componentDidMount() {\n    ajax.get(this.props.user.api.avatar).then(\n      (options) => {\n        this.setState({\n          component: AvatarIndex,\n          options: options,\n          error: null,\n        })\n      },\n      (rejection) => {\n        this.showError(rejection)\n      }\n    )\n  }\n\n  showError = (error) => {\n    this.setState({\n      error,\n    })\n  }\n\n  showIndex = () => {\n    this.setState({\n      component: AvatarIndex,\n    })\n  }\n\n  showUpload = () => {\n    this.setState({\n      component: AvatarUpload,\n    })\n  }\n\n  showCrop = () => {\n    this.setState({\n      component: AvatarCrop,\n    })\n  }\n\n  showGallery = () => {\n    this.setState({\n      component: AvatarGallery,\n    })\n  }\n\n  completeFlow = (options) => {\n    store.dispatch(updateAvatar(this.props.user, options.avatars))\n\n    this.setState({\n      component: AvatarIndex,\n      options,\n    })\n  }\n\n  getBody() {\n    if (this.state) {\n      if (this.state.error) {\n        return (\n          <ChangeAvatarError\n            message={this.state.error.detail}\n            reason={this.state.error.reason}\n          />\n        )\n      } else {\n        return (\n          <this.state.component\n            options={this.state.options}\n            user={this.props.user}\n            onComplete={this.completeFlow}\n            showError={this.showError}\n            showIndex={this.showIndex}\n            showCrop={this.showCrop}\n            showUpload={this.showUpload}\n            showGallery={this.showGallery}\n          />\n        )\n      }\n    } else {\n      return <Loader />\n    }\n  }\n\n  getClassName() {\n    if (this.state && this.state.error) {\n      return \"modal-dialog modal-message modal-change-avatar\"\n    } else {\n      return \"modal-dialog modal-change-avatar\"\n    }\n  }\n\n  render() {\n    return (\n      <div className={this.getClassName()} role=\"document\">\n        <div className=\"modal-content\">\n          <div className=\"modal-header\">\n            <button\n              type=\"button\"\n              className=\"close\"\n              data-dismiss=\"modal\"\n              aria-label={pgettext(\"modal\", \"Close\")}\n            >\n              <span aria-hidden=\"true\">&times;</span>\n            </button>\n            <h4 className=\"modal-title\">\n              {pgettext(\"avatar modal title\", \"Change your avatar\")}\n            </h4>\n          </div>\n\n          {this.getBody()}\n        </div>\n      </div>\n    )\n  }\n}\n\nexport function select(state) {\n  return {\n    user: state.auth.user,\n  }\n}\n","export default function logout() {\n  document.getElementById(\"hidden-logout-form\").submit()\n}\n","import classnames from \"classnames\"\nimport React from \"react\"\nimport { connect } from \"react-redux\"\nimport modal from \"../../services/modal\"\nimport ChangeAvatarModal, {\n  select as selectAvatar,\n} from \"../change-avatar/root\"\nimport {\n  DropdownDivider,\n  DropdownFooter,\n  DropdownMenuItem,\n  DropdownSubheader,\n} from \"../Dropdown\"\nimport logout from \"./logout\"\n\nclass UserNavMenu extends React.Component {\n  constructor(props) {\n    super(props)\n\n    if (props.dropdown) {\n      // Collapse options on dropdown\n      this.state = {\n        options: props.options.slice(0, 2),\n        optionsMore: props.options.length > 2,\n      }\n    } else {\n      // Reveal all options on mobile overlay\n      this.state = {\n        options: props.options,\n        optionsMore: false,\n      }\n    }\n  }\n\n  changeAvatar = () => {\n    this.props.close()\n    modal.show(connect(selectAvatar)(ChangeAvatarModal))\n  }\n\n  revealOptions = () => {\n    this.setState({\n      options: this.props.options,\n      optionsMore: false,\n    })\n  }\n\n  render() {\n    const { user, close, dropdown, overlay } = this.props\n\n    if (!user) {\n      return null\n    }\n\n    const adminUrl = misago.get(\"ADMIN_URL\")\n\n    return (\n      <ul\n        className={classnames(\"user-nav-menu\", {\n          \"dropdown-menu-list\": dropdown,\n          \"overlay-menu-list\": overlay,\n        })}\n      >\n        <li className=\"dropdown-menu-item\">\n          <a href={user.url} className=\"user-nav-profile\">\n            <strong>{user.username}</strong>\n            <small>{pgettext(\"user nav\", \"Go to your profile\")}</small>\n          </a>\n        </li>\n        <DropdownDivider />\n        <DropdownMenuItem>\n          <a href={misago.get(\"NOTIFICATIONS_URL\")}>\n            <span className=\"material-icon\">\n              {user.unreadNotifications\n                ? \"notifications_active\"\n                : \"notifications_none\"}\n            </span>\n            {pgettext(\"user nav\", \"Notifications\")}\n            {!!user.unreadNotifications && (\n              <span className=\"badge\">{user.unreadNotifications}</span>\n            )}\n          </a>\n        </DropdownMenuItem>\n        {!!user.showPrivateThreads && (\n          <DropdownMenuItem>\n            <a href={misago.get(\"PRIVATE_THREADS_URL\")}>\n              <span className=\"material-icon\">inbox</span>\n              {pgettext(\"user nav\", \"Private threads\")}\n              {!!user.unreadPrivateThreads && (\n                <span className=\"badge\">{user.unreadPrivateThreads}</span>\n              )}\n            </a>\n          </DropdownMenuItem>\n        )}\n        {!!adminUrl && (\n          <DropdownMenuItem>\n            <a href={adminUrl} target=\"_blank\">\n              <span className=\"material-icon\">security</span>\n              {pgettext(\"user nav\", \"Admin control panel\")}\n            </a>\n          </DropdownMenuItem>\n        )}\n        <DropdownDivider />\n        <DropdownSubheader className=\"user-nav-options\">\n          {pgettext(\"user nav section\", \"Account settings\")}\n        </DropdownSubheader>\n        <DropdownMenuItem>\n          <button\n            className=\"btn-link\"\n            onClick={this.changeAvatar}\n            type=\"button\"\n          >\n            <span className=\"material-icon\">portrait</span>\n            {pgettext(\"user nav\", \"Change avatar\")}\n          </button>\n        </DropdownMenuItem>\n        {this.state.options.map((item) => (\n          <DropdownMenuItem key={item.icon}>\n            <a href={item.url}>\n              <span className=\"material-icon\">{item.icon}</span>\n              {item.name}\n            </a>\n          </DropdownMenuItem>\n        ))}\n        <DropdownMenuItem>\n          <button\n            className={classnames(\"btn-link\", {\n              \"d-none\": !this.state.optionsMore,\n            })}\n            onClick={this.revealOptions}\n            type=\"button\"\n          >\n            <span className=\"material-icon\">more_vertical</span>\n            {pgettext(\"user nav\", \"See more\")}\n          </button>\n        </DropdownMenuItem>\n        {!!dropdown && (\n          <DropdownFooter listItem>\n            <button\n              className=\"btn btn-default btn-block\"\n              onClick={() => {\n                logout()\n                close()\n              }}\n              type=\"button\"\n            >\n              {pgettext(\"user nav\", \"Log out\")}\n            </button>\n          </DropdownFooter>\n        )}\n      </ul>\n    )\n  }\n}\n\nfunction select(state) {\n  const user = state.auth.user\n  if (!user.id) {\n    return { user: null }\n  }\n\n  return {\n    user: {\n      username: user.username,\n      unreadNotifications: user.unreadNotifications,\n      unreadPrivateThreads: user.unread_private_threads,\n      showPrivateThreads: user.acl.can_use_private_threads,\n      url: user.url,\n    },\n    options: [...misago.get(\"userOptions\")],\n  }\n}\n\nconst UserNavMenuConnected = connect(select)(UserNavMenu)\n\nexport default UserNavMenuConnected\n","import React from \"react\"\nimport UserNavMenu from \"./UserNavMenu\"\n\nexport default function UserNavDropdown({ close }) {\n  return <UserNavMenu close={close} dropdown />\n}\n","import React from \"react\"\nimport { connect } from \"react-redux\"\nimport { close } from \"../../reducers/overlay\"\nimport { DropdownFooter } from \"../Dropdown\"\nimport { Overlay, OverlayHeader } from \"../Overlay\"\nimport UserNavMenu from \"./UserNavMenu\"\nimport logout from \"./logout\"\n\nexport function UserNavOverlay({ dispatch, isOpen }) {\n  return (\n    <Overlay open={isOpen}>\n      <OverlayHeader>\n        {pgettext(\"user nav title\", \"Your options\")}\n      </OverlayHeader>\n      <UserNavMenu close={() => dispatch(close())} overlay />\n      <DropdownFooter>\n        <button\n          className=\"btn btn-default btn-block\"\n          onClick={() => {\n            logout()\n            dispatch(close())\n          }}\n          type=\"button\"\n        >\n          {pgettext(\"user nav\", \"Log out\")}\n        </button>\n      </DropdownFooter>\n    </Overlay>\n  )\n}\n\nfunction select(state) {\n  return {\n    isOpen: state.overlay.userNav,\n  }\n}\n\nconst UserNavOverlayConnected = connect(select)(UserNavOverlay)\n\nexport default UserNavOverlayConnected\n","import misago from \"misago/index\"\nimport { hydrate } from \"misago/reducers/profile\"\nimport store from \"misago/services/store\"\n\nexport default function initializer() {\n  if (misago.has(\"PROFILE\")) {\n    store.dispatch(hydrate(misago.get(\"PROFILE\")))\n  }\n}\n\nmisago.addInitializer({\n  name: \"reducer:profile-hydrate\",\n  initializer: initializer,\n  after: \"store\",\n})\n","import React from \"react\"\n\nexport default class extends React.Component {\n  getClass() {\n    return getStatusClassName(this.props.status)\n  }\n\n  render() {\n    return <span className={this.getClass()}>{this.props.children}</span>\n  }\n}\n\nexport class StatusIcon extends React.Component {\n  getIcon() {\n    if (this.props.status.is_banned) {\n      return \"remove_circle_outline\"\n    } else if (this.props.status.is_hidden) {\n      return \"help_outline\"\n    } else if (this.props.status.is_online_hidden) {\n      return \"label\"\n    } else if (this.props.status.is_offline_hidden) {\n      return \"label_outline\"\n    } else if (this.props.status.is_online) {\n      return \"lens\"\n    } else if (this.props.status.is_offline) {\n      return \"panorama_fish_eye\"\n    }\n  }\n\n  render() {\n    return <span className=\"material-icon status-icon\">{this.getIcon()}</span>\n  }\n}\n\nexport class StatusLabel extends React.Component {\n  getHelp() {\n    return getStatusDescription(this.props.user, this.props.status)\n  }\n\n  getLabel() {\n    if (this.props.status.is_banned) {\n      return pgettext(\"user status\", \"Banned\")\n    } else if (this.props.status.is_hidden) {\n      return pgettext(\"user status\", \"Hidden\")\n    } else if (this.props.status.is_online_hidden) {\n      return pgettext(\"user status\", \"Online (hidden)\")\n    } else if (this.props.status.is_offline_hidden) {\n      return pgettext(\"user status\", \"Offline (hidden)\")\n    } else if (this.props.status.is_online) {\n      return pgettext(\"user status\", \"Online\")\n    } else if (this.props.status.is_offline) {\n      return pgettext(\"user status\", \"Offline\")\n    }\n  }\n\n  render() {\n    return (\n      <span\n        className={this.props.className || \"status-label\"}\n        title={this.getHelp()}\n      >\n        {this.getLabel()}\n      </span>\n    )\n  }\n}\n\nexport function getStatusClassName(status) {\n  let className = \"\"\n  if (status.is_banned) {\n    className = \"banned\"\n  } else if (status.is_hidden) {\n    className = \"offline\"\n  } else if (status.is_online_hidden) {\n    className = \"online\"\n  } else if (status.is_offline_hidden) {\n    className = \"offline\"\n  } else if (status.is_online) {\n    className = \"online\"\n  } else if (status.is_offline) {\n    className = \"offline\"\n  }\n\n  return \"user-status user-\" + className\n}\n\nexport function getStatusDescription(user, status) {\n  if (status.is_banned) {\n    if (status.banned_until) {\n      return interpolate(\n        pgettext(\"user status\", \"%(username)s is banned until %(ban_expires)s\"),\n        {\n          username: user.username,\n          ban_expires: status.banned_until.format(\"LL, LT\"),\n        },\n        true\n      )\n    } else {\n      return interpolate(\n        pgettext(\"user status\", \"%(username)s is banned\"),\n        {\n          username: user.username,\n        },\n        true\n      )\n    }\n  } else if (status.is_hidden) {\n    return interpolate(\n      pgettext(\"user status\", \"%(username)s is hiding presence\"),\n      {\n        username: user.username,\n      },\n      true\n    )\n  } else if (status.is_online_hidden) {\n    return interpolate(\n      pgettext(\"user status\", \"%(username)s is online (hidden)\"),\n      {\n        username: user.username,\n      },\n      true\n    )\n  } else if (status.is_offline_hidden) {\n    return interpolate(\n      pgettext(\n        \"user status\",\n        \"%(username)s was last seen %(last_click)s (hidden)\"\n      ),\n      {\n        username: user.username,\n        last_click: status.last_click.fromNow(),\n      },\n      true\n    )\n  } else if (status.is_online) {\n    return interpolate(\n      pgettext(\"user status\", \"%(username)s is online\"),\n      {\n        username: user.username,\n      },\n      true\n    )\n  } else if (status.is_offline) {\n    return interpolate(\n      pgettext(\"user status\", \"%(username)s was last seen %(last_click)s\"),\n      {\n        username: user.username,\n        last_click: status.last_click.fromNow(),\n      },\n      true\n    )\n  }\n}\n","import React from \"react\"\nimport zxcvbn from \"misago/services/zxcvbn\"\n\nexport const STYLES = [\n  \"progress-bar-danger\",\n  \"progress-bar-warning\",\n  \"progress-bar-warning\",\n  \"progress-bar-primary\",\n  \"progress-bar-success\",\n]\n\nexport const LABELS = [\n  pgettext(\"password strength indicator\", \"Entered password is very weak.\"),\n  pgettext(\"password strength indicator\", \"Entered password is weak.\"),\n  pgettext(\"password strength indicator\", \"Entered password is average.\"),\n  pgettext(\"password strength indicator\", \"Entered password is strong.\"),\n  pgettext(\"password strength indicator\", \"Entered password is very strong.\"),\n]\n\nexport default class extends React.Component {\n  constructor(props) {\n    super(props)\n\n    this._score = 0\n    this._password = null\n    this._inputs = []\n\n    this.state = {\n      loaded: false,\n    }\n  }\n\n  componentDidMount() {\n    zxcvbn.load().then(() => {\n      this.setState({ loaded: true })\n    })\n  }\n\n  getScore(password, inputs) {\n    let cacheStale = false\n\n    if (password !== this._password) {\n      cacheStale = true\n    }\n\n    if (inputs.length !== this._inputs.length) {\n      cacheStale = true\n    } else {\n      inputs.map((value, i) => {\n        if (value.trim() !== this._inputs[i]) {\n          cacheStale = true\n        }\n      })\n    }\n\n    if (cacheStale) {\n      this._score = zxcvbn.scorePassword(password, inputs)\n      this._password = password\n      this._inputs = inputs.map(function (value) {\n        return value.trim()\n      })\n    }\n\n    return this._score\n  }\n\n  render() {\n    if (!this.state.loaded) return null\n\n    let score = this.getScore(this.props.password, this.props.inputs)\n\n    return (\n      <div className=\"help-block password-strength\">\n        <div className=\"progress\">\n          <div\n            className={\"progress-bar \" + STYLES[score]}\n            style={{ width: 20 + 20 * score + \"%\" }}\n            role=\"progress-bar\"\n            aria-valuenow={score}\n            aria-valuemin=\"0\"\n            aria-valuemax=\"4\"\n          >\n            <span className=\"sr-only\">{LABELS[score]}</span>\n          </div>\n        </div>\n        <p className=\"text-small\">{LABELS[score]}</p>\n      </div>\n    )\n  }\n}\n","import React from \"react\"\nimport Button from \"misago/components/button\"\nimport Form from \"misago/components/form\"\nimport FormGroup from \"misago/components/form-group\"\nimport PasswordStrength from \"misago/components/password-strength\"\nimport RegisterLegalFootnote from \"misago/components/RegisterLegalFootnote\"\nimport StartSocialAuth from \"misago/components/StartSocialAuth\"\nimport misago from \"misago\"\nimport ajax from \"misago/services/ajax\"\nimport auth from \"misago/services/auth\"\nimport captcha from \"misago/services/captcha\"\nimport modal from \"misago/services/modal\"\nimport snackbar from \"misago/services/snackbar\"\nimport showBannedPage from \"misago/utils/banned-page\"\nimport * as validators from \"misago/utils/validators\"\n\nexport class RegisterForm extends Form {\n  constructor(props) {\n    super(props)\n\n    const { username, password } = this.props.criteria\n\n    let passwordMinLength = 0\n    password.forEach((item) => {\n      if (item.name === \"MinimumLengthValidator\") {\n        passwordMinLength = item.min_length\n      }\n    })\n\n    const formValidators = {\n      username: [\n        validators.usernameContent(),\n        validators.usernameMinLength(username.min_length),\n        validators.usernameMaxLength(username.max_length),\n      ],\n      email: [validators.email()],\n      password: [validators.passwordMinLength(passwordMinLength)],\n      captcha: captcha.validator(),\n    }\n\n    if (!!misago.get(\"TERMS_OF_SERVICE_ID\")) {\n      formValidators.termsOfService = [validators.requiredTermsOfService()]\n    }\n\n    if (!!misago.get(\"PRIVACY_POLICY_ID\")) {\n      formValidators.privacyPolicy = [validators.requiredPrivacyPolicy()]\n    }\n\n    this.state = {\n      isLoading: false,\n\n      username: \"\",\n      email: \"\",\n      password: \"\",\n      captcha: \"\",\n\n      termsOfService: null,\n      privacyPolicy: null,\n\n      validators: formValidators,\n      errors: {},\n    }\n  }\n\n  clean() {\n    if (this.isValid()) {\n      return true\n    } else {\n      snackbar.error(gettext(\"Form contains errors.\"))\n      this.setState({\n        errors: this.validate(),\n      })\n      return false\n    }\n  }\n\n  send() {\n    return ajax.post(misago.get(\"USERS_API\"), {\n      username: this.state.username,\n      email: this.state.email,\n      password: this.state.password,\n      captcha: this.state.captcha,\n      terms_of_service: this.state.termsOfService,\n      privacy_policy: this.state.privacyPolicy,\n    })\n  }\n\n  handleSuccess(apiResponse) {\n    this.props.callback(apiResponse)\n  }\n\n  handleError(rejection) {\n    if (rejection.status === 400) {\n      this.setState({\n        errors: Object.assign({}, this.state.errors, rejection),\n      })\n\n      if (rejection.__all__ && rejection.__all__.length > 0) {\n        snackbar.error(rejection.__all__[0])\n      } else {\n        snackbar.error(gettext(\"Form contains errors.\"))\n      }\n    } else if (rejection.status === 403 && rejection.ban) {\n      showBannedPage(rejection.ban)\n      modal.hide()\n    } else {\n      snackbar.apiError(rejection)\n    }\n  }\n\n  handlePrivacyPolicyChange = (event) => {\n    const value = event.target.value\n    this.handleToggleAgreement(\"privacyPolicy\", value)\n  }\n\n  handleTermsOfServiceChange = (event) => {\n    const value = event.target.value\n    this.handleToggleAgreement(\"termsOfService\", value)\n  }\n\n  handleToggleAgreement = (agreement, value) => {\n    this.setState((prevState, props) => {\n      if (prevState[agreement] === null) {\n        const errors = { ...prevState.errors, [agreement]: null }\n        return { errors, [agreement]: value }\n      }\n\n      const validator = this.state.validators[agreement][0]\n      const errors = { ...prevState.errors, [agreement]: [validator(null)] }\n      return { errors, [agreement]: null }\n    })\n  }\n\n  render() {\n    return (\n      <div className=\"modal-dialog modal-register\" role=\"document\">\n        <div className=\"modal-content\">\n          <div className=\"modal-header\">\n            <button\n              type=\"button\"\n              className=\"close\"\n              data-dismiss=\"modal\"\n              aria-label={pgettext(\"modal\", \"Close\")}\n            >\n              <span aria-hidden=\"true\">&times;</span>\n            </button>\n            <h4 className=\"modal-title\">\n              {pgettext(\"register modal title\", \"Register\")}\n            </h4>\n          </div>\n          <form onSubmit={this.handleSubmit}>\n            <input type=\"type\" style={{ display: \"none\" }} />\n            <input type=\"password\" style={{ display: \"none\" }} />\n            <div className=\"modal-body\">\n              <StartSocialAuth\n                buttonClassName=\"col-xs-12 col-sm-6\"\n                buttonLabel={pgettext(\n                  \"register modal field\",\n                  \"Join with %(site)s\"\n                )}\n                formLabel={pgettext(\n                  \"register modal field\",\n                  \"Or create forum account:\"\n                )}\n              />\n\n              <FormGroup\n                label={pgettext(\"register modal field\", \"Username\")}\n                for=\"id_username\"\n                validation={this.state.errors.username}\n              >\n                <input\n                  type=\"text\"\n                  id=\"id_username\"\n                  className=\"form-control\"\n                  aria-describedby=\"id_username_status\"\n                  disabled={this.state.isLoading}\n                  onChange={this.bindInput(\"username\")}\n                  value={this.state.username}\n                />\n              </FormGroup>\n\n              <FormGroup\n                label={pgettext(\"register modal field\", \"E-mail\")}\n                for=\"id_email\"\n                validation={this.state.errors.email}\n              >\n                <input\n                  type=\"text\"\n                  id=\"id_email\"\n                  className=\"form-control\"\n                  aria-describedby=\"id_email_status\"\n                  disabled={this.state.isLoading}\n                  onChange={this.bindInput(\"email\")}\n                  value={this.state.email}\n                />\n              </FormGroup>\n\n              <FormGroup\n                label={pgettext(\"register modal field\", \"Password\")}\n                for=\"id_password\"\n                validation={this.state.errors.password}\n                extra={\n                  <PasswordStrength\n                    password={this.state.password}\n                    inputs={[this.state.username, this.state.email]}\n                  />\n                }\n              >\n                <input\n                  type=\"password\"\n                  id=\"id_password\"\n                  className=\"form-control\"\n                  aria-describedby=\"id_password_status\"\n                  disabled={this.state.isLoading}\n                  onChange={this.bindInput(\"password\")}\n                  value={this.state.password}\n                />\n              </FormGroup>\n\n              {captcha.component({\n                form: this,\n              })}\n\n              <RegisterLegalFootnote\n                errors={this.state.errors}\n                privacyPolicy={this.state.privacyPolicy}\n                termsOfService={this.state.termsOfService}\n                onPrivacyPolicyChange={this.handlePrivacyPolicyChange}\n                onTermsOfServiceChange={this.handleTermsOfServiceChange}\n              />\n            </div>\n            <div className=\"modal-footer\">\n              <button\n                className=\"btn btn-default\"\n                data-dismiss=\"modal\"\n                disabled={this.state.isLoading}\n                type=\"button\"\n              >\n                {pgettext(\"register modal btn\", \"Cancel\")}\n              </button>\n              <Button className=\"btn-primary\" loading={this.state.isLoading}>\n                {pgettext(\"register modal btn\", \"Register account\")}\n              </Button>\n            </div>\n          </form>\n        </div>\n      </div>\n    )\n  }\n}\n\nexport class RegisterComplete extends React.Component {\n  getLead() {\n    if (this.props.activation === \"user\") {\n      return pgettext(\n        \"account activation required\",\n        \"%(username)s, your account has been created but you need to activate it before you will be able to sign in.\"\n      )\n    } else if (this.props.activation === \"admin\") {\n      return pgettext(\n        \"account activation required\",\n        \"%(username)s, your account has been created but the site administrator will have to activate it before you will be able to sign in.\"\n      )\n    }\n  }\n\n  getSubscript() {\n    if (this.props.activation === \"user\") {\n      return pgettext(\n        \"account activation required\",\n        \"We have sent an e-mail to %(email)s with link that you have to click to activate your account.\"\n      )\n    } else if (this.props.activation === \"admin\") {\n      return pgettext(\n        \"account activation required\",\n        \"We will send an e-mail to %(email)s when this takes place.\"\n      )\n    }\n  }\n\n  render() {\n    return (\n      <div\n        className=\"modal-dialog modal-message modal-register\"\n        role=\"document\"\n      >\n        <div className=\"modal-content\">\n          <div className=\"modal-header\">\n            <button\n              type=\"button\"\n              className=\"close\"\n              data-dismiss=\"modal\"\n              aria-label={pgettext(\"modal\", \"Close\")}\n            >\n              <span aria-hidden=\"true\">&times;</span>\n            </button>\n            <h4 className=\"modal-title\">\n              {pgettext(\"register modal title\", \"Registration complete\")}\n            </h4>\n          </div>\n          <div className=\"modal-body\">\n            <div className=\"message-icon\">\n              <span className=\"material-icon\">info_outline</span>\n            </div>\n            <div className=\"message-body\">\n              <p className=\"lead\">\n                {interpolate(\n                  this.getLead(),\n                  { username: this.props.username },\n                  true\n                )}\n              </p>\n              <p>\n                {interpolate(\n                  this.getSubscript(),\n                  { email: this.props.email },\n                  true\n                )}\n              </p>\n              <button\n                className=\"btn btn-default\"\n                data-dismiss=\"modal\"\n                type=\"button\"\n              >\n                {pgettext(\"register modal dismiss\", \"Ok\")}\n              </button>\n            </div>\n          </div>\n        </div>\n      </div>\n    )\n  }\n}\n\nexport default class extends React.Component {\n  constructor(props) {\n    super(props)\n\n    this.state = {\n      complete: false,\n    }\n  }\n\n  completeRegistration = (apiResponse) => {\n    if (apiResponse.activation === \"active\") {\n      modal.hide()\n      auth.signIn(apiResponse)\n    } else {\n      this.setState({\n        complete: apiResponse,\n      })\n    }\n  }\n\n  render() {\n    if (this.state.complete) {\n      return (\n        <RegisterComplete\n          activation={this.state.complete.activation}\n          email={this.state.complete.email}\n          username={this.state.complete.username}\n        />\n      )\n    }\n\n    return <RegisterForm callback={this.completeRegistration} {...this.props} />\n  }\n}\n","import RegisterButton from \"./RegisterButton\"\n\nexport default RegisterButton\n","import classnames from \"classnames\"\nimport React from \"react\"\nimport ajax from \"../../services/ajax\"\nimport captcha from \"../../services/captcha\"\nimport modal from \"../../services/modal\"\nimport snackbar from \"../../services/snackbar\"\nimport Loader from \"../loader\"\nimport RegisterForm from \"../register.js\"\n\nexport default class RegisterButton extends React.Component {\n  constructor(props) {\n    super(props)\n\n    this.state = {\n      isLoading: false,\n      isLoaded: false,\n\n      criteria: null,\n    }\n  }\n\n  showRegisterForm = () => {\n    if (this.props.onClick) {\n      this.props.onClick()\n    }\n\n    if (misago.get(\"SETTINGS\").account_activation === \"closed\") {\n      snackbar.info(\n        pgettext(\n          \"register form\",\n          \"Registration form is currently disabled by the site administrator.\"\n        )\n      )\n    } else if (this.state.isLoaded) {\n      modal.show(<RegisterForm criteria={this.state.criteria} />)\n    } else {\n      this.setState({ isLoading: true })\n\n      Promise.all([\n        captcha.load(),\n        ajax.get(misago.get(\"AUTH_CRITERIA_API\")),\n      ]).then(\n        (result) => {\n          this.setState({\n            isLoading: false,\n            isLoaded: true,\n            criteria: result[1],\n          })\n\n          modal.show(<RegisterForm criteria={result[1]} />)\n        },\n        () => {\n          this.setState({ isLoading: false })\n\n          snackbar.error(\n            pgettext(\n              \"register form\",\n              \"Registration form is currently unavailable due to an error.\"\n            )\n          )\n        }\n      )\n    }\n  }\n\n  render() {\n    return (\n      <button\n        className={classnames(\"btn btn-register\", this.props.className, {\n          \"btn-block\": this.props.block,\n          \"btn-loading\": this.state.isLoading,\n        })}\n        disabled={this.state.isLoading}\n        onClick={this.showRegisterForm}\n        type=\"button\"\n      >\n        {pgettext(\"cta\", \"Register\")}\n        {this.state.isLoading ? <Loader /> : null}\n      </button>\n    )\n  }\n}\n","import { maxLength, minLength } from \"misago/utils/validators\"\nimport misago from \"misago\"\n\nexport function getTitleValidators() {\n  return [getTitleLengthMin(), getTitleLengthMax()]\n}\n\nexport function getPostValidators() {\n  if (misago.get(\"SETTINGS\").post_length_max) {\n    return [validatePostLengthMin(), validatePostLengthMax()]\n  } else {\n    return [validatePostLengthMin()]\n  }\n}\n\nexport function getTitleLengthMin() {\n  return minLength(\n    misago.get(\"SETTINGS\").thread_title_length_min,\n    (limitValue, length) => {\n      const message = npgettext(\n        \"thread title length validator\",\n        \"Thread title should be at least %(limit_value)s character long (it has %(show_value)s).\",\n        \"Thread title should be at least %(limit_value)s characters long (it has %(show_value)s).\",\n        limitValue\n      )\n\n      return interpolate(\n        message,\n        {\n          limit_value: limitValue,\n          show_value: length,\n        },\n        true\n      )\n    }\n  )\n}\n\nexport function getTitleLengthMax() {\n  return maxLength(\n    misago.get(\"SETTINGS\").thread_title_length_max,\n    (limitValue, length) => {\n      const message = npgettext(\n        \"thread title length validator\",\n        \"Thread title cannot be longer than %(limit_value)s character (it has %(show_value)s).\",\n        \"Thread title cannot be longer than %(limit_value)s characters (it has %(show_value)s).\",\n        limitValue\n      )\n\n      return interpolate(\n        message,\n        {\n          limit_value: limitValue,\n          show_value: length,\n        },\n        true\n      )\n    }\n  )\n}\n\nexport function validatePostLengthMin() {\n  return minLength(\n    misago.get(\"SETTINGS\").post_length_min,\n    (limitValue, length) => {\n      const message = npgettext(\n        \"post length validator\",\n        \"Posted message should be at least %(limit_value)s character long (it has %(show_value)s).\",\n        \"Posted message should be at least %(limit_value)s characters long (it has %(show_value)s).\",\n        limitValue\n      )\n\n      return interpolate(\n        message,\n        {\n          limit_value: limitValue,\n          show_value: length,\n        },\n        true\n      )\n    }\n  )\n}\n\nexport function validatePostLengthMax() {\n  return maxLength(\n    misago.get(\"SETTINGS\").post_length_max || 1000000,\n    (limitValue, length) => {\n      const message = npgettext(\n        \"post length validator\",\n        \"Posted message cannot be longer than %(limit_value)s character (it has %(show_value)s).\",\n        \"Posted message cannot be longer than %(limit_value)s characters (it has %(show_value)s).\",\n        limitValue\n      )\n\n      return interpolate(\n        message,\n        {\n          limit_value: limitValue,\n          show_value: length,\n        },\n        true\n      )\n    }\n  )\n}\n","import React from \"react\"\nimport ReactDOM from \"react-dom\"\nimport { Provider } from \"react-redux\"\nimport { SiteNavOverlay } from \"../../components/SiteNav\"\nimport store from \"../../services/store\"\n\nexport default function initializer(context) {\n  const root = document.getElementById(\"site-nav-mount\")\n  ReactDOM.render(\n    <Provider store={store.getStore()}>\n      <SiteNavOverlay />\n    </Provider>,\n    root\n  )\n}\n\nmisago.addInitializer({\n  name: \"component:site-nav-overlay\",\n  initializer: initializer,\n  after: \"store\",\n})\n","import React from \"react\"\nimport misago from \"misago\"\n\nconst StartSocialAuth = (props) => {\n  const { buttonClassName, buttonLabel, formLabel, header, labelClassName } =\n    props\n  const socialAuth = misago.get(\"SOCIAL_AUTH\")\n\n  if (socialAuth.length === 0) return null\n\n  return (\n    <div className=\"form-group form-social-auth\">\n      <FormHeader className={labelClassName} text={header} />\n      <div className=\"row\">\n        {socialAuth.map(({ pk, name, button_text, button_color, url }) => {\n          const className = \"btn btn-block btn-default btn-social-\" + pk\n          const style = button_color ? { color: button_color } : null\n          const finalButtonLabel =\n            button_text || interpolate(buttonLabel, { site: name }, true)\n\n          return (\n            <div className={buttonClassName || \"col-xs-12\"} key={pk}>\n              <a className={className} style={style} href={url}>\n                {finalButtonLabel}\n              </a>\n            </div>\n          )\n        })}\n      </div>\n      <hr />\n      <FormHeader className={labelClassName} text={formLabel} />\n    </div>\n  )\n}\n\nconst FormHeader = ({ className, text }) => {\n  if (!text) return null\n  return <h5 className={className || \"\"}>{text}</h5>\n}\n\nexport default StartSocialAuth\n","import React from \"react\"\n\nconst PageContainer = ({ children }) => (\n  <div className=\"container page-container\">{children}</div>\n)\n\nexport default PageContainer\n","import React from \"react\"\nimport UserStatus, { StatusLabel } from \"misago/components/user-status\"\n\nexport default function ({ showStatus, user }) {\n  return (\n    <ul className=\"list-unstyled\">\n      <Status showStatus={showStatus} user={user} />\n      <JoinDate user={user} />\n      <li className=\"user-stat-divider\" />\n      <Posts user={user} />\n      <Threads user={user} />\n      <Followers user={user} />\n    </ul>\n  )\n}\n\nexport function Status({ showStatus, user }) {\n  if (!showStatus) return null\n\n  return (\n    <li className=\"user-stat-status\">\n      <UserStatus status={user.status}>\n        <StatusLabel status={user.status} user={user} />\n      </UserStatus>\n    </li>\n  )\n}\n\nexport function JoinDate({ user }) {\n  const { joined_on } = user\n\n  let title = interpolate(\n    pgettext(\"users list item\", \"Joined on %(joined_on)s\"),\n    {\n      joined_on: joined_on.format(\"LL, LT\"),\n    },\n    true\n  )\n\n  let message = interpolate(\n    pgettext(\"users list item\", \"Joined %(joined_on)s\"),\n    {\n      joined_on: joined_on.fromNow(),\n    },\n    true\n  )\n\n  return (\n    <li className=\"user-stat-join-date\">\n      <abbr title={title}>{message}</abbr>\n    </li>\n  )\n}\n\nexport function Posts({ user }) {\n  const className = getStatClassName(\"user-stat-posts\", user.posts)\n  const message = npgettext(\n    \"users list item\",\n    \"%(posts)s post\",\n    \"%(posts)s posts\",\n    user.posts\n  )\n\n  return (\n    <li className={className}>\n      {interpolate(\n        message,\n        {\n          posts: user.posts,\n        },\n        true\n      )}\n    </li>\n  )\n}\n\nexport function Threads({ user }) {\n  const className = getStatClassName(\"user-stat-threads\", user.threads)\n  const message = npgettext(\n    \"users list item\",\n    \"%(threads)s thread\",\n    \"%(threads)s threads\",\n    user.threads\n  )\n\n  return (\n    <li className={className}>\n      {interpolate(\n        message,\n        {\n          threads: user.threads,\n        },\n        true\n      )}\n    </li>\n  )\n}\n\nexport function Followers({ user }) {\n  const className = getStatClassName(\"user-stat-followers\", user.followers)\n  const message = npgettext(\n    \"users list item\",\n    \"%(followers)s follower\",\n    \"%(followers)s followers\",\n    user.followers\n  )\n\n  return (\n    <li className={className}>\n      {interpolate(\n        message,\n        {\n          followers: user.followers,\n        },\n        true\n      )}\n    </li>\n  )\n}\n\nexport function getStatClassName(className, stat) {\n  if (stat === 0) {\n    return className + \" user-stat-empty\"\n  }\n  return className\n}\n","import React from \"react\"\n\nexport default function ({ rank, title }) {\n  let userTitle = title || rank.title || rank.name\n\n  let className = \"user-title\"\n  if (rank.css_class) {\n    className += \" user-title-\" + rank.css_class\n  }\n\n  if (rank.is_tab) {\n    return (\n      <a className={className} href={rank.url}>\n        {userTitle}\n      </a>\n    )\n  }\n\n  return <span className={className}>{userTitle}</span>\n}\n","import React from \"react\"\nimport Avatar from \"misago/components/avatar\"\nimport Stats from \"./stats\"\nimport UserTitle from \"./user-title\"\n\nexport default function ({ showStatus, user }) {\n  const { rank } = user\n\n  let className = \"panel user-card\"\n  if (rank.css_class) {\n    className += \" user-card-\" + rank.css_class\n  }\n\n  return (\n    <div className={className}>\n      <div className=\"panel-body\">\n        <div className=\"row\">\n          <div className=\"col-xs-3 user-card-left\">\n            <div className=\"user-card-small-avatar\">\n              <a href={user.url}>\n                <Avatar size=\"50\" size2x=\"80\" user={user} />\n              </a>\n            </div>\n          </div>\n          <div className=\"col-xs-9 col-sm-12 user-card-body\">\n            <div className=\"user-card-avatar\">\n              <a href={user.url}>\n                <Avatar size=\"150\" size2x=\"200\" user={user} />\n              </a>\n            </div>\n\n            <div className=\"user-card-username\">\n              <a href={user.url}>{user.username}</a>\n            </div>\n            <div className=\"user-card-title\">\n              <UserTitle rank={rank} title={user.title} />\n            </div>\n\n            <div className=\"user-card-stats\">\n              <Stats showStatus={showStatus} user={user} />\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  )\n}\n","import React from \"react\"\nimport Avatar from \"misago/components/avatar\"\nimport * as random from \"misago/utils/random\"\n\nexport default class extends React.Component {\n  shouldComponentUpdate() {\n    return false\n  }\n\n  render() {\n    return (\n      <div className=\"panel user-card user-card-preview\">\n        <div className=\"panel-body\">\n          <div className=\"row\">\n            <div className=\"col-xs-3 user-card-left\">\n              <div className=\"user-card-small-avatar\">\n                <span>\n                  <Avatar size=\"50\" size2x=\"80\" />\n                </span>\n              </div>\n            </div>\n            <div className=\"col-xs-9 col-sm-12 user-card-body\">\n              <div className=\"user-card-avatar\">\n                <span>\n                  <Avatar size=\"150\" size2x=\"200\" />\n                </span>\n              </div>\n\n              <div className=\"user-card-username\">\n                <span\n                  className=\"ui-preview-text\"\n                  style={{ width: random.int(60, 150) + \"px\" }}\n                >\n                  &nbsp;\n                </span>\n              </div>\n              <div className=\"user-card-title\">\n                <span\n                  className=\"ui-preview-text\"\n                  style={{ width: random.int(60, 150) + \"px\" }}\n                >\n                  &nbsp;\n                </span>\n              </div>\n\n              <div className=\"user-card-stats\">\n                <ul className=\"list-unstyled\">\n                  <li>\n                    <span\n                      className=\"ui-preview-text\"\n                      style={{ width: random.int(30, 70) + \"px\" }}\n                    >\n                      &nbsp;\n                    </span>\n                  </li>\n                  <li>\n                    <span\n                      className=\"ui-preview-text\"\n                      style={{ width: random.int(30, 70) + \"px\" }}\n                    >\n                      &nbsp;\n                    </span>\n                  </li>\n                  <li className=\"user-stat-divider\" />\n                  <li>\n                    <span\n                      className=\"ui-preview-text\"\n                      style={{ width: random.int(30, 70) + \"px\" }}\n                    >\n                      &nbsp;\n                    </span>\n                  </li>\n                  <li>\n                    <span\n                      className=\"ui-preview-text\"\n                      style={{ width: random.int(30, 70) + \"px\" }}\n                    >\n                      &nbsp;\n                    </span>\n                  </li>\n                </ul>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n    )\n  }\n}\n","import React from \"react\"\nimport Card from \"./card\"\n\nexport default function ({ colClassName, cols }) {\n  const list = Array.apply(null, { length: cols }).map(Number.call, Number)\n\n  return (\n    <div className=\"users-cards-list ui-preview\">\n      <div className=\"row\">\n        {list.map((i) => {\n          let className = colClassName\n          if (i !== 0) className += \" hidden-xs\"\n          if (i === 3) className += \" hidden-sm\"\n\n          return (\n            <div className={className} key={i}>\n              <Card />\n            </div>\n          )\n        })}\n      </div>\n    </div>\n  )\n}\n","import React from \"react\"\nimport Card from \"./card\"\nimport Preview from \"./preview\"\n\nexport default function ({ cols, isReady, showStatus, users }) {\n  let colClassName = \"col-xs-12 col-sm-4\"\n  if (cols === 4) {\n    colClassName += \" col-md-3\"\n  }\n\n  if (!isReady) {\n    return <Preview colClassName={colClassName} cols={cols} />\n  }\n\n  return (\n    <div className=\"users-cards-list ui-ready\">\n      <div className=\"row\">\n        {users.map((user) => {\n          return (\n            <div className={colClassName} key={user.id}>\n              <Card showStatus={showStatus} user={user} />\n            </div>\n          )\n        })}\n      </div>\n    </div>\n  )\n}\n","import misago from \"misago/index\"\nimport reducer, { hydrate } from \"misago/reducers/posts\"\nimport store from \"misago/services/store\"\n\nexport default function initializer() {\n  let initialState = null\n  if (misago.has(\"POSTS\")) {\n    initialState = hydrate(misago.get(\"POSTS\"))\n  } else {\n    initialState = {\n      isLoaded: false,\n      isBusy: false,\n    }\n  }\n\n  store.addReducer(\"posts\", reducer, initialState)\n}\n\nmisago.addInitializer({\n  name: \"reducer:posts\",\n  initializer: initializer,\n  before: \"store\",\n})\n","import postReducer, {\n  PATCH_POST,\n  hydrate as hydratePost,\n} from \"misago/reducers/post\"\n\nexport const APPEND_POSTS = \"APPEND_POSTS\"\nexport const SELECT_POST = \"SELECT_POST\"\nexport const DESELECT_POST = \"DESELECT_POST\"\nexport const DESELECT_POSTS = \"DESELECT_POSTS\"\nexport const LOAD_POSTS = \"LOAD_POSTS\"\nexport const UNLOAD_POSTS = \"UNLOAD_POSTS\"\nexport const UPDATE_POSTS = \"UPDATE_POSTS\"\n\nexport function select(post) {\n  return {\n    type: SELECT_POST,\n    post,\n  }\n}\n\nexport function deselect(post) {\n  return {\n    type: DESELECT_POST,\n    post,\n  }\n}\n\nexport function deselectAll() {\n  return {\n    type: DESELECT_POSTS,\n  }\n}\n\nexport function hydrate(json) {\n  return Object.assign({}, json, {\n    results: json.results.map(hydratePost),\n    isLoaded: true,\n    isBusy: false,\n    isSelected: false,\n  })\n}\n\nexport function load(newState, hydrated = false) {\n  return {\n    type: LOAD_POSTS,\n    state: hydrated ? newState : hydrate(newState),\n  }\n}\n\nexport function append(newState, hydrated = false) {\n  return {\n    type: APPEND_POSTS,\n    state: hydrated ? newState : hydrate(newState),\n  }\n}\n\nexport function unload() {\n  return {\n    type: UNLOAD_POSTS,\n  }\n}\n\nexport function update(newState) {\n  return {\n    type: UPDATE_POSTS,\n    update: newState,\n  }\n}\n\nexport default function posts(state = {}, action = null) {\n  switch (action.type) {\n    case SELECT_POST:\n      const selectedPosts = state.results.map((post) => {\n        if (post.id == action.post.id) {\n          return Object.assign({}, post, {\n            isSelected: true,\n          })\n        } else {\n          return post\n        }\n      })\n\n      return Object.assign({}, state, {\n        results: selectedPosts,\n      })\n\n    case DESELECT_POST:\n      const deseletedPosts = state.results.map((post) => {\n        if (post.id == action.post.id) {\n          return Object.assign({}, post, {\n            isSelected: false,\n          })\n        } else {\n          return post\n        }\n      })\n\n      return Object.assign({}, state, {\n        results: deseletedPosts,\n      })\n\n    case DESELECT_POSTS:\n      const deseletedAllPosts = state.results.map((post) => {\n        return Object.assign({}, post, {\n          isSelected: false,\n        })\n      })\n\n      return Object.assign({}, state, {\n        results: deseletedAllPosts,\n      })\n\n    case APPEND_POSTS:\n      let results = state.results.slice()\n      const resultsIds = state.results.map((post) => {\n        return post.id\n      })\n\n      action.state.results.map((post) => {\n        if (resultsIds.indexOf(post.id) === -1) {\n          results.push(post)\n        }\n      })\n\n      return Object.assign({}, action.state, {\n        results,\n      })\n\n    case LOAD_POSTS:\n      return action.state\n\n    case UNLOAD_POSTS:\n      return Object.assign({}, state, {\n        isLoaded: false,\n      })\n\n    case UPDATE_POSTS:\n      return Object.assign({}, state, action.update)\n\n    case PATCH_POST:\n      const reducedPosts = state.results.map((post) => {\n        return postReducer(post, action)\n      })\n\n      return Object.assign({}, state, {\n        results: reducedPosts,\n      })\n\n    default:\n      return state\n  }\n}\n","import moment from \"moment\"\nimport misago from \"misago/index\"\n\nexport default function initializer() {\n  moment.locale($(\"html\").attr(\"lang\"))\n}\n\nmisago.addInitializer({\n  name: \"moment\",\n  initializer: initializer,\n})\n","import moment from \"moment\"\n\nexport const BUSY_POLL = \"BUSY_POLL\"\nexport const RELEASE_POLL = \"RELEASE_POLL\"\nexport const REMOVE_POLL = \"REMOVE_POLL\"\nexport const REPLACE_POLL = \"REPLACE_POLL\"\nexport const UPDATE_POLL = \"UPDATE_POLL\"\n\nexport function hydrate(json) {\n  let hasSelectedChoices = false\n  for (const i in json.choices) {\n    const choice = json.choices[i]\n    if (choice.selected) {\n      hasSelectedChoices = true\n      break\n    }\n  }\n\n  return Object.assign({}, json, {\n    posted_on: moment(json.posted_on),\n\n    hasSelectedChoices,\n    endsOn: json.length\n      ? moment(json.posted_on).add(json.length, \"days\")\n      : null,\n\n    isBusy: false,\n  })\n}\n\nexport function busy() {\n  return {\n    type: BUSY_POLL,\n  }\n}\n\nexport function release() {\n  return {\n    type: RELEASE_POLL,\n  }\n}\n\nexport function replace(newState, hydrated = false) {\n  return {\n    type: REPLACE_POLL,\n    state: hydrated ? newState : hydrate(newState),\n  }\n}\n\nexport function update(data) {\n  return {\n    type: UPDATE_POLL,\n    data,\n  }\n}\n\nexport function remove() {\n  return {\n    type: REMOVE_POLL,\n  }\n}\n\nexport default function poll(state = {}, action = null) {\n  switch (action.type) {\n    case BUSY_POLL:\n      return Object.assign({}, state, { isBusy: true })\n\n    case RELEASE_POLL:\n      return Object.assign({}, state, { isBusy: false })\n\n    case REMOVE_POLL:\n      return {\n        isBusy: false,\n      }\n\n    case REPLACE_POLL:\n      return action.state\n\n    case UPDATE_POLL:\n      return Object.assign({}, state, action.data)\n\n    default:\n      return state\n  }\n}\n","import misago from \"misago/index\"\nimport { doTick } from \"misago/reducers/tick\"\nimport store from \"misago/services/store\"\n\nconst TICK_PERIOD = 50 * 1000 //do the tick every 50s\n\nexport default function initializer() {\n  window.setInterval(function () {\n    store.dispatch(doTick())\n  }, TICK_PERIOD)\n}\n\nmisago.addInitializer({\n  name: \"tick-start\",\n  initializer: initializer,\n  after: \"store\",\n})\n","import React from \"react\"\n\nexport default function (props) {\n  return (\n    <select\n      className={props.className || \"form-control\"}\n      disabled={props.disabled || false}\n      id={props.id || null}\n      onChange={props.onChange}\n      value={props.value}\n    >\n      {props.choices.map((item) => {\n        return (\n          <option\n            disabled={item.disabled || false}\n            key={item.value}\n            value={item.value}\n          >\n            {\"- - \".repeat(item.level) + item.label}\n          </option>\n        )\n      })}\n    </select>\n  )\n}\n","import misago from \"misago/index\"\nimport storage from \"misago/services/local-storage\"\n\nexport default function initializer() {\n  storage.init(\"misago_\")\n}\n\nmisago.addInitializer({\n  name: \"local-storage\",\n  initializer: initializer,\n})\n","import { combineReducers, createStore } from \"redux\"\n\nexport class StoreWrapper {\n  constructor() {\n    this._store = null\n    this._reducers = {}\n    this._initialState = {}\n  }\n\n  addReducer(name, reducer, initialState) {\n    this._reducers[name] = reducer\n    this._initialState[name] = initialState\n  }\n\n  init() {\n    this._store = createStore(\n      combineReducers(this._reducers),\n      this._initialState\n    )\n  }\n\n  getStore() {\n    return this._store\n  }\n\n  // Store API\n\n  getState() {\n    return this._store.getState()\n  }\n\n  dispatch(action) {\n    return this._store.dispatch(action)\n  }\n}\n\nexport default new StoreWrapper()\n","import misago from \"misago/index\"\nimport ajax from \"misago/services/ajax\"\n\nexport default function initializer() {\n  ajax.init(misago.get(\"CSRF_COOKIE_NAME\"))\n}\n\nmisago.addInitializer({\n  name: \"ajax\",\n  initializer: initializer,\n})\n","import misago from \"misago/index\"\nimport reducer from \"misago/reducers/username-history\"\nimport store from \"misago/services/store\"\n\nexport default function initializer() {\n  store.addReducer(\"username-history\", reducer, [])\n}\n\nmisago.addInitializer({\n  name: \"reducer:username-history\",\n  initializer: initializer,\n  before: \"store\",\n})\n","import React from \"react\"\nimport Loader from \"misago/components/loader\"\n\nexport default class extends React.Component {\n  render() {\n    return (\n      <div className=\"panel-body panel-body-loading\">\n        <Loader className=\"loader loader-spaced\" />\n      </div>\n    )\n  }\n}\n","import moment from \"moment\"\nimport React from \"react\"\nimport PanelLoader from \"misago/components/panel-loader\"\nimport PanelMessage from \"misago/components/panel-message\"\nimport misago from \"misago/index\"\nimport polls from \"misago/services/polls\"\nimport title from \"misago/services/page-title\"\n\nexport default class extends React.Component {\n  constructor(props) {\n    super(props)\n\n    if (misago.has(\"PROFILE_BAN\")) {\n      this.initWithPreloadedData(misago.pop(\"PROFILE_BAN\"))\n    } else {\n      this.initWithoutPreloadedData()\n    }\n\n    this.startPolling(props.profile.api.ban)\n  }\n\n  initWithPreloadedData(ban) {\n    if (ban.expires_on) {\n      ban.expires_on = moment(ban.expires_on)\n    }\n\n    this.state = {\n      isLoaded: true,\n      ban,\n    }\n  }\n\n  initWithoutPreloadedData() {\n    this.state = {\n      isLoaded: false,\n    }\n  }\n\n  startPolling(api) {\n    polls.start({\n      poll: \"ban-details\",\n      url: api,\n      frequency: 90 * 1000,\n      update: this.update,\n      error: this.error,\n    })\n  }\n\n  update = (ban) => {\n    if (ban.expires_on) {\n      ban.expires_on = moment(ban.expires_on)\n    }\n\n    this.setState({\n      isLoaded: true,\n      error: null,\n\n      ban,\n    })\n  }\n\n  error = (error) => {\n    this.setState({\n      isLoaded: true,\n      error: error.detail,\n      ban: null,\n    })\n  }\n\n  componentDidMount() {\n    title.set({\n      title: pgettext(\"profile ban details title\", \"Ban details\"),\n      parent: this.props.profile.username,\n    })\n  }\n\n  componentWillUnmount() {\n    polls.stop(\"ban-details\")\n  }\n\n  getUserMessage() {\n    if (this.state.ban.user_message) {\n      return (\n        <div className=\"panel-body ban-message ban-user-message\">\n          <h4>{pgettext(\"profile ban details\", \"User-shown ban message\")}</h4>\n          <div\n            className=\"lead\"\n            dangerouslySetInnerHTML={{\n              __html: this.state.ban.user_message.html,\n            }}\n          />\n        </div>\n      )\n    } else {\n      return null\n    }\n  }\n\n  getStaffMessage() {\n    if (this.state.ban.staff_message) {\n      return (\n        <div className=\"panel-body ban-message ban-staff-message\">\n          <h4>{pgettext(\"profile ban details\", \"Team-shown ban message\")}</h4>\n          <div\n            className=\"lead\"\n            dangerouslySetInnerHTML={{\n              __html: this.state.ban.staff_message.html,\n            }}\n          />\n        </div>\n      )\n    } else {\n      return null\n    }\n  }\n\n  getExpirationMessage() {\n    if (this.state.ban.expires_on) {\n      if (this.state.ban.expires_on.isAfter(moment())) {\n        let title = interpolate(\n          pgettext(\n            \"profile ban details\",\n            \"This ban expires on %(expires_on)s.\"\n          ),\n          {\n            expires_on: this.state.ban.expires_on.format(\"LL, LT\"),\n          },\n          true\n        )\n\n        let message = interpolate(\n          pgettext(\"profile ban details\", \"This ban expires %(expires_on)s.\"),\n          {\n            expires_on: this.state.ban.expires_on.fromNow(),\n          },\n          true\n        )\n\n        return <abbr title={title}>{message}</abbr>\n      } else {\n        return pgettext(\"profile ban details\", \"This ban has expired.\")\n      }\n    } else {\n      return interpolate(\n        pgettext(\"profile ban details\", \"%(username)s's ban is permanent.\"),\n        {\n          username: this.props.profile.username,\n        },\n        true\n      )\n    }\n  }\n\n  getPanelBody() {\n    if (this.state.ban) {\n      if (Object.keys(this.state.ban).length) {\n        return (\n          <div>\n            {this.getUserMessage()}\n            {this.getStaffMessage()}\n\n            <div className=\"panel-body ban-expires\">\n              <h4>{pgettext(\"profile ban details\", \"Ban expiration\")}</h4>\n              <p className=\"lead\">{this.getExpirationMessage()}</p>\n            </div>\n          </div>\n        )\n      } else {\n        return (\n          <div>\n            <PanelMessage\n              message={pgettext(\n                \"profile ban details\",\n                \"No ban is active at the moment.\"\n              )}\n            />\n          </div>\n        )\n      }\n    } else if (this.state.error) {\n      return (\n        <div>\n          <PanelMessage icon=\"error_outline\" message={this.state.error} />\n        </div>\n      )\n    } else {\n      return (\n        <div>\n          <PanelLoader />\n        </div>\n      )\n    }\n  }\n\n  render() {\n    return (\n      <div className=\"profile-ban-details\">\n        <div className=\"panel panel-default\">\n          <div className=\"panel-heading\">\n            <h3 className=\"panel-title\">\n              {pgettext(\"profile ban details title\", \"Ban details\")}\n            </h3>\n          </div>\n\n          {this.getPanelBody()}\n        </div>\n      </div>\n    )\n  }\n}\n","import React from \"react\"\nimport PanelMessage from \"misago/components/panel-message\"\n\nexport default function ({ display }) {\n  if (!display) return null\n\n  return (\n    <PanelMessage\n      helpText={pgettext(\n        \"user profile details\",\n        \"No profile details are editable at this time.\"\n      )}\n      message={pgettext(\n        \"user profile details\",\n        \"This option is currently unavailable.\"\n      )}\n    />\n  )\n}\n","import React from \"react\"\nimport Loader from \"misago/components/loader\"\n\nexport default function ({ display }) {\n  if (!display) return null\n\n  return (\n    <div className=\"panel-body\">\n      <Loader />\n    </div>\n  )\n}\n","import React from \"react\"\nimport Select from \"misago/components/select\"\n\nexport default class extends React.Component {\n  onChange = (ev) => {\n    const { field, onChange } = this.props\n    onChange(field.fieldname, ev.target.value)\n  }\n\n  render() {\n    const { disabled, field, value } = this.props\n    const { input } = field\n\n    if (input.type === \"select\") {\n      return (\n        <Select\n          choices={input.choices}\n          disabled={disabled}\n          id={\"id_\" + field.fieldname}\n          onChange={this.onChange}\n          value={value}\n        />\n      )\n    }\n\n    if (input.type === \"textarea\") {\n      return (\n        <textarea\n          className=\"form-control\"\n          disabled={disabled}\n          id={\"id_\" + field.fieldname}\n          onChange={this.onChange}\n          rows=\"4\"\n          type=\"text\"\n          value={value}\n        />\n      )\n    }\n\n    if (input.type === \"text\") {\n      return (\n        <input\n          className=\"form-control\"\n          disabled={disabled}\n          id={\"id_\" + field.fieldname}\n          onChange={this.onChange}\n          type=\"text\"\n          value={value}\n        />\n      )\n    }\n\n    return null\n  }\n}\n","import React from \"react\"\nimport FieldInput from \"./field-input\"\nimport FormGroup from \"misago/components/form-group\"\n\nexport default function ({ disabled, errors, fields, name, onChange, value }) {\n  return (\n    <fieldset>\n      <legend>{name}</legend>\n      {fields.map((field) => {\n        return (\n          <FormGroup\n            for={\"id_\" + field.fieldname}\n            helpText={field.help_text}\n            key={field.fieldname}\n            label={field.label}\n            validation={errors[field.fieldname]}\n          >\n            <FieldInput\n              disabled={disabled}\n              field={field}\n              onChange={onChange}\n              value={value[field.fieldname]}\n            />\n          </FormGroup>\n        )\n      })}\n    </fieldset>\n  )\n}\n","import React from \"react\"\nimport Fieldset from \"./fieldset\"\nimport Button from \"misago/components/button\"\nimport Form from \"misago/components/form\"\nimport ajax from \"misago/services/ajax\"\nimport snackbar from \"misago/services/snackbar\"\n\nexport default class extends Form {\n  constructor(props) {\n    super(props)\n\n    this.state = {\n      isLoading: false,\n\n      errors: {},\n    }\n\n    const groups = props.groups.length\n    for (let i = 0; i < groups; i++) {\n      const group = props.groups[i]\n      const fields = group.fields.length\n      for (let f = 0; f < fields; f++) {\n        const fieldname = group.fields[f].fieldname\n        const initial = group.fields[f].initial\n        this.state[fieldname] = initial\n      }\n    }\n  }\n\n  send() {\n    const data = Object.assign({}, this.state, {\n      errors: null,\n      isLoading: null,\n    })\n\n    return ajax.post(this.props.api, data)\n  }\n\n  handleSuccess(data) {\n    this.props.onSuccess(data)\n  }\n\n  handleError(rejection) {\n    if (rejection.status === 400) {\n      snackbar.error(gettext(\"Form contains errors.\"))\n      this.setState({ errors: rejection })\n    } else {\n      snackbar.apiError(rejection)\n    }\n  }\n\n  onChange = (name, value) => {\n    this.setState({\n      [name]: value,\n    })\n  }\n\n  render() {\n    return (\n      <form onSubmit={this.handleSubmit}>\n        <div className=\"panel-body\">\n          {this.props.groups.map((group, i) => {\n            return (\n              <Fieldset\n                disabled={this.state.isLoading}\n                errors={this.state.errors}\n                fields={group.fields}\n                name={group.name}\n                key={i}\n                onChange={this.onChange}\n                value={this.state}\n              />\n            )\n          })}\n        </div>\n        <div className=\"panel-footer text-right\">\n          <CancelButton\n            disabled={this.state.isLoading}\n            onCancel={this.props.onCancel}\n          />{\" \"}\n          <Button className=\"btn-primary\" loading={this.state.isLoading}>\n            {pgettext(\"user profile details form btn\", \"Save changes\")}\n          </Button>\n        </div>\n      </form>\n    )\n  }\n}\n\nexport function CancelButton({ onCancel, disabled }) {\n  if (!onCancel) return null\n\n  return (\n    <button\n      className=\"btn btn-default\"\n      disabled={disabled}\n      onClick={onCancel}\n      type=\"button\"\n    >\n      {pgettext(\"user profile details form btn\", \"Cancel\")}\n    </button>\n  )\n}\n","import React from \"react\"\nimport Blankslate from \"./blankslate\"\nimport Loader from \"./loader\"\nimport Form from \"./form\"\nimport ajax from \"misago/services/ajax\"\nimport snackbar from \"misago/services/snackbar\"\n\nexport default class extends React.Component {\n  constructor(props) {\n    super(props)\n\n    this.state = {\n      loading: true,\n      groups: null,\n    }\n  }\n\n  componentDidMount() {\n    ajax.get(this.props.api).then(\n      (groups) => {\n        this.setState({\n          loading: false,\n\n          groups,\n        })\n      },\n      (rejection) => {\n        snackbar.apiError(rejection)\n        if (this.props.cancel) {\n          this.props.cancel()\n        }\n      }\n    )\n  }\n\n  render() {\n    const { groups, loading } = this.state\n\n    return (\n      <div className=\"panel panel-default panel-form\">\n        <div className=\"panel-heading\">\n          <h3 className=\"panel-title\">\n            {pgettext(\"user profile details form title\", \"Edit details\")}\n          </h3>\n        </div>\n        <Loader display={loading} />\n        <Blankslate display={!loading && !groups.length} />\n        <FormDisplay\n          api={this.props.api}\n          display={!loading && groups.length}\n          groups={groups}\n          onCancel={this.props.onCancel}\n          onSuccess={this.props.onSuccess}\n        />\n      </div>\n    )\n  }\n}\n\nexport function FormDisplay({ api, display, groups, onCancel, onSuccess }) {\n  if (!display) return null\n\n  return (\n    <Form api={api} groups={groups} onCancel={onCancel} onSuccess={onSuccess} />\n  )\n}\n","import React from \"react\"\nimport Form from \"misago/components/edit-details\"\n\nexport default function ({ api, display, onCancel, onSuccess }) {\n  if (!display) return null\n\n  return <Form api={api} onCancel={onCancel} onSuccess={onSuccess} />\n}\n","import React from \"react\"\n\nexport default function ({ isAuthenticated, profile }) {\n  let message = null\n  if (isAuthenticated) {\n    message = pgettext(\n      \"profile details empty\",\n      \"You are not sharing any details with others.\"\n    )\n  } else {\n    message = interpolate(\n      pgettext(\n        \"profile details empty\",\n        \"%(username)s is not sharing any details with others.\"\n      ),\n      {\n        username: profile.username,\n      },\n      true\n    )\n  }\n\n  return (\n    <div className=\"panel panel-default\">\n      <div className=\"panel-body text-center lead\">{message}</div>\n    </div>\n  )\n}\n","import React from \"react\"\n\nexport default function ({ html, text, url }) {\n  if (html) {\n    return (\n      <div\n        className=\"form-control-static col-md-9\"\n        dangerouslySetInnerHTML={{ __html: html }}\n      />\n    )\n  }\n\n  return (\n    <div className=\"form-control-static col-md-9\">\n      <SafeValue text={text} url={url} />\n    </div>\n  )\n}\n\nexport function SafeValue({ text, url }) {\n  if (url) {\n    return (\n      <p>\n        <a href={url} target=\"_blank\" rel=\"nofollow\">\n          {text || url}\n        </a>\n      </p>\n    )\n  }\n\n  if (text) {\n    return <p>{text}</p>\n  }\n\n  return null\n}\n","import React from \"react\"\nimport FieldValue from \"./field-value\"\n\nexport default function (props) {\n  return (\n    <div className=\"form-group\">\n      <strong className=\"control-label col-md-3\">{props.name}:</strong>\n      <FieldValue {...props} />\n    </div>\n  )\n}\n","import React from \"react\"\nimport Field from \"./field\"\n\nexport default function ({ fields, name }) {\n  return (\n    <div className=\"panel panel-default panel-profile-details-group\">\n      <div className=\"panel-heading\">\n        <h3 className=\"panel-title\">{name}</h3>\n      </div>\n      <div className=\"panel-body\">\n        <div className=\"form-horizontal\">\n          {fields.map(({ fieldname, html, name, text, url }) => {\n            return (\n              <Field\n                key={fieldname}\n                name={name}\n                html={html}\n                text={text}\n                url={url}\n              />\n            )\n          })}\n        </div>\n      </div>\n    </div>\n  )\n}\n","import React from \"react\"\nimport EmptyMessage from \"./empty-message\"\nimport Group from \"./group\"\nimport Loader from \"misago/components/loader\"\n\nexport default function ({\n  display,\n  groups,\n  isAuthenticated,\n  loading,\n  profile,\n}) {\n  if (!display) return null\n\n  if (loading) {\n    return <Loader />\n  }\n\n  if (!groups.length) {\n    return <EmptyMessage isAuthenticated={isAuthenticated} profile={profile} />\n  }\n\n  return (\n    <div>\n      {groups.map((group, i) => {\n        return <Group fields={group.fields} key={i} name={group.name} />\n      })}\n    </div>\n  )\n}\n","import React from \"react\"\nimport { Toolbar, ToolbarItem, ToolbarSection } from \"../../Toolbar\"\n\nconst ProfileDetailsHeader = ({ onEdit, showEditButton }) => (\n  <Toolbar>\n    <ToolbarSection auto>\n      <ToolbarItem auto>\n        <h3>{pgettext(\"profile details title\", \"Details\")}</h3>\n      </ToolbarItem>\n    </ToolbarSection>\n    {showEditButton && (\n      <ToolbarSection>\n        <ToolbarItem>\n          <button\n            className=\"btn btn-default btn-outline btn-block\"\n            onClick={onEdit}\n            type=\"button\"\n          >\n            {pgettext(\"profile details edit btn\", \"Edit\")}\n          </button>\n        </ToolbarItem>\n      </ToolbarSection>\n    )}\n  </Toolbar>\n)\n\nexport default ProfileDetailsHeader\n","import React from \"react\"\nimport { load } from \"misago/reducers/profile-details\"\nimport ajax from \"misago/services/ajax\"\nimport snackbar from \"misago/services/snackbar\"\n\nexport default class extends React.Component {\n  componentDidMount() {\n    const { data, dispatch, user } = this.props\n    if (data && data.id === user.id) return\n\n    ajax.get(this.props.user.api.details).then(\n      (data) => {\n        dispatch(load(data))\n      },\n      (rejection) => {\n        snackbar.apiError(rejection)\n      }\n    )\n  }\n\n  render() {\n    return this.props.children\n  }\n}\n","import React from \"react\"\nimport Form from \"./form\"\nimport GroupsList from \"./groups-list\"\nimport Header from \"./header\"\nimport ProfileDetailsData from \"misago/data/profile-details\"\nimport { load as loadDetails } from \"misago/reducers/profile-details\"\nimport title from \"misago/services/page-title\"\nimport snackbar from \"misago/services/snackbar\"\n\nexport default class extends React.Component {\n  constructor(props) {\n    super(props)\n\n    this.state = {\n      editing: false,\n    }\n  }\n\n  componentDidMount() {\n    title.set({\n      title: pgettext(\"profile details title\", \"Details\"),\n      parent: this.props.profile.username,\n    })\n  }\n\n  onCancel = () => {\n    this.setState({ editing: false })\n  }\n\n  onEdit = () => {\n    this.setState({ editing: true })\n  }\n\n  onSuccess = (newDetails) => {\n    const { dispatch, isAuthenticated, profile } = this.props\n\n    let message = null\n    if (isAuthenticated) {\n      message = pgettext(\n        \"profile details form\",\n        \"Your details have been changed.\"\n      )\n    } else {\n      message = interpolate(\n        pgettext(\n          \"profile details form\",\n          \"%(username)s's details have been changed.\"\n        ),\n        {\n          username: profile.username,\n        },\n        true\n      )\n    }\n\n    snackbar.info(message)\n    dispatch(loadDetails(newDetails))\n    this.setState({ editing: false })\n  }\n\n  render() {\n    const { dispatch, isAuthenticated, profile, profileDetails } = this.props\n    const loading = profileDetails.id !== profile.id\n\n    return (\n      <ProfileDetailsData\n        data={profileDetails}\n        dispatch={dispatch}\n        user={profile}\n      >\n        <div className=\"profile-details\">\n          <Header\n            onEdit={this.onEdit}\n            showEditButton={!!profileDetails.edit && !this.state.editing}\n          />\n          <GroupsList\n            display={!this.state.editing}\n            groups={profileDetails.groups}\n            isAuthenticated={isAuthenticated}\n            loading={loading}\n            profile={profile}\n          />\n          <Form\n            api={profile.api.edit_details}\n            dispatch={dispatch}\n            display={this.state.editing}\n            onCancel={this.onCancel}\n            onSuccess={this.onSuccess}\n          />\n        </div>\n      </ProfileDetailsData>\n    )\n  }\n}\n","import React from \"react\"\nimport PostFeed from \"misago/components/post-feed\"\nimport Button from \"misago/components/button\"\nimport * as posts from \"misago/reducers/posts\"\nimport title from \"misago/services/page-title\"\nimport ajax from \"misago/services/ajax\"\nimport snackbar from \"misago/services/snackbar\"\nimport store from \"misago/services/store\"\nimport { Toolbar, ToolbarItem, ToolbarSection } from \"../../Toolbar\"\n\nexport default class extends React.Component {\n  constructor(props) {\n    super(props)\n\n    this.state = {\n      isLoading: false,\n    }\n  }\n\n  loadItems(start = 0) {\n    ajax\n      .get(this.props.api, {\n        start: start || 0,\n      })\n      .then(\n        (data) => {\n          if (start === 0) {\n            store.dispatch(posts.load(data))\n          } else {\n            store.dispatch(posts.append(data))\n          }\n\n          this.setState({\n            isLoading: false,\n          })\n        },\n        (rejection) => {\n          this.setState({\n            isLoading: false,\n          })\n\n          snackbar.apiError(rejection)\n        }\n      )\n  }\n\n  loadMore = () => {\n    this.setState({\n      isLoading: true,\n    })\n\n    this.loadItems(this.props.posts.next)\n  }\n\n  componentDidMount() {\n    title.set({\n      title: this.props.title,\n      parent: this.props.profile.username,\n    })\n\n    this.loadItems()\n  }\n\n  render() {\n    return (\n      <div className=\"profile-feed\">\n        <Toolbar>\n          <ToolbarSection auto>\n            <ToolbarItem auto>\n              <h3>{this.props.header}</h3>\n            </ToolbarItem>\n          </ToolbarSection>\n        </Toolbar>\n        <Feed\n          isLoading={this.state.isLoading}\n          loadMore={this.loadMore}\n          {...this.props}\n        />\n      </div>\n    )\n  }\n}\n\nexport function Feed(props) {\n  if (props.posts.isLoaded && !props.posts.results.length) {\n    return <p className=\"lead\">{props.emptyMessage}</p>\n  }\n\n  return (\n    <div>\n      <PostFeed\n        isReady={props.posts.isLoaded}\n        posts={props.posts.results}\n        poster={props.profile}\n      />\n      <LoadMoreButton\n        isLoading={props.isLoading}\n        loadMore={props.loadMore}\n        next={props.posts.next}\n      />\n    </div>\n  )\n}\n\nexport function LoadMoreButton(props) {\n  if (!props.next) return null\n\n  return (\n    <div className=\"pager-more\">\n      <Button\n        className=\"btn btn-default btn-outline\"\n        loading={props.isLoading}\n        onClick={props.loadMore}\n      >\n        {pgettext(\"profile load more btn\", \"Show older activity\")}\n      </Button>\n    </div>\n  )\n}\n","import React from \"react\"\n\nexport default class extends React.Component {\n  getClassName() {\n    if (this.props.className) {\n      return \"form-search \" + this.props.className\n    } else {\n      return \"form-search\"\n    }\n  }\n\n  render() {\n    return (\n      <div className={this.getClassName()}>\n        <input\n          type=\"text\"\n          className=\"form-control\"\n          value={this.props.value}\n          onChange={this.props.onChange}\n          placeholder={\n            this.props.placeholder ||\n            pgettext(\"quick search placeholder\", \"Search...\")\n          }\n        />\n        <span className=\"material-icon\">search</span>\n      </div>\n    )\n  }\n}\n","import React from \"react\"\nimport Button from \"misago/components/button\"\nimport Search from \"misago/components/quick-search\"\nimport UsersList from \"misago/components/users-list\"\nimport misago from \"misago/index\"\nimport { hydrate, append } from \"misago/reducers/users\"\nimport ajax from \"misago/services/ajax\"\nimport snackbar from \"misago/services/snackbar\"\nimport store from \"misago/services/store\"\nimport title from \"misago/services/page-title\"\nimport { Toolbar, ToolbarItem, ToolbarSection } from \"../Toolbar\"\n\nexport default class extends React.Component {\n  constructor(props) {\n    super(props)\n\n    this.setSpecialProps()\n\n    if (misago.has(this.PRELOADED_DATA_KEY)) {\n      this.initWithPreloadedData(misago.pop(this.PRELOADED_DATA_KEY))\n    } else {\n      this.initWithoutPreloadedData()\n    }\n  }\n\n  setSpecialProps() {\n    this.PRELOADED_DATA_KEY = \"PROFILE_FOLLOWERS\"\n    this.TITLE = pgettext(\"profile followers title\", \"Followers\")\n    this.API_FILTER = \"followers\"\n  }\n\n  initWithPreloadedData(data) {\n    this.state = {\n      isLoaded: true,\n      isBusy: false,\n\n      search: \"\",\n\n      count: data.count,\n      more: data.more,\n\n      page: data.page,\n      pages: data.pages,\n    }\n\n    store.dispatch(hydrate(data.results))\n  }\n\n  initWithoutPreloadedData() {\n    this.state = {\n      isLoaded: false,\n      isBusy: false,\n\n      search: \"\",\n\n      count: 0,\n      more: 0,\n\n      page: 1,\n      pages: 1,\n    }\n\n    this.loadUsers()\n  }\n\n  loadUsers(page = 1, search = null) {\n    const apiUrl = this.props.profile.api[this.API_FILTER]\n\n    ajax\n      .get(\n        apiUrl,\n        {\n          search: search,\n          page: page || 1,\n        },\n        \"user-\" + this.API_FILTER\n      )\n      .then(\n        (data) => {\n          if (page === 1) {\n            store.dispatch(hydrate(data.results))\n          } else {\n            store.dispatch(append(data.results))\n          }\n\n          this.setState({\n            isLoaded: true,\n            isBusy: false,\n\n            count: data.count,\n            more: data.more,\n\n            page: data.page,\n            pages: data.pages,\n          })\n        },\n        (rejection) => {\n          snackbar.apiError(rejection)\n        }\n      )\n  }\n\n  componentDidMount() {\n    title.set({\n      title: this.TITLE,\n      parent: this.props.profile.username,\n    })\n  }\n\n  loadMore = () => {\n    this.setState({\n      isBusy: true,\n    })\n\n    this.loadUsers(this.state.page + 1, this.state.search)\n  }\n\n  search = (ev) => {\n    this.setState({\n      isLoaded: false,\n      isBusy: true,\n\n      search: ev.target.value,\n\n      count: 0,\n      more: 0,\n\n      page: 1,\n      pages: 1,\n    })\n\n    this.loadUsers(1, ev.target.value)\n  }\n\n  getLabel() {\n    if (!this.state.isLoaded) {\n      return pgettext(\"Loading...\")\n    } else if (this.state.search) {\n      let message = npgettext(\n        \"profile followers\",\n        \"Found %(users)s user.\",\n        \"Found %(users)s users.\",\n        this.state.count\n      )\n\n      return interpolate(\n        message,\n        {\n          users: this.state.count,\n        },\n        true\n      )\n    } else if (this.props.profile.id === this.props.user.id) {\n      let message = npgettext(\n        \"profile followers\",\n        \"You have %(users)s follower.\",\n        \"You have %(users)s followers.\",\n        this.state.count\n      )\n\n      return interpolate(\n        message,\n        {\n          users: this.state.count,\n        },\n        true\n      )\n    } else {\n      let message = npgettext(\n        \"profile followers\",\n        \"%(username)s has %(users)s follower.\",\n        \"%(username)s has %(users)s followers.\",\n        this.state.count\n      )\n\n      return interpolate(\n        message,\n        {\n          username: this.props.profile.username,\n          users: this.state.count,\n        },\n        true\n      )\n    }\n  }\n\n  getEmptyMessage() {\n    if (this.state.search) {\n      return pgettext(\n        \"profile followers\",\n        \"Search returned no users matching specified criteria.\"\n      )\n    } else if (this.props.user.id === this.props.profile.id) {\n      return pgettext(\"profile followers\", \"You have no followers.\")\n    } else {\n      return interpolate(\n        pgettext(\"profile followers\", \"%(username)s has no followers.\"),\n        {\n          username: this.props.profile.username,\n        },\n        true\n      )\n    }\n  }\n\n  getMoreButton() {\n    if (!this.state.more) return null\n\n    return (\n      <div className=\"pager-more\">\n        <Button\n          className=\"btn btn-default btn-outline\"\n          loading={this.state.isBusy}\n          onClick={this.loadMore}\n        >\n          {interpolate(\n            pgettext(\"profile followers\", \"Show more (%(more)s)\"),\n            {\n              more: this.state.more,\n            },\n            true\n          )}\n        </Button>\n      </div>\n    )\n  }\n\n  getListBody() {\n    if (this.state.isLoaded && this.state.count === 0) {\n      return <p className=\"lead\">{this.getEmptyMessage()}</p>\n    }\n\n    return (\n      <div>\n        <UsersList\n          cols={3}\n          isReady={this.state.isLoaded}\n          users={this.props.users}\n        />\n\n        {this.getMoreButton()}\n      </div>\n    )\n  }\n\n  getClassName() {\n    return \"profile-\" + this.API_FILTER\n  }\n\n  render() {\n    return (\n      <div className={this.getClassName()}>\n        <Toolbar>\n          <ToolbarSection auto>\n            <ToolbarItem auto>\n              <h3>{this.getLabel()}</h3>\n            </ToolbarItem>\n          </ToolbarSection>\n          <ToolbarSection>\n            <ToolbarItem>\n              <Search\n                value={this.state.search}\n                onChange={this.search}\n                placeholder={pgettext(\n                  \"profile followers search\",\n                  \"Search users...\"\n                )}\n              />\n            </ToolbarItem>\n          </ToolbarSection>\n        </Toolbar>\n\n        {this.getListBody()}\n      </div>\n    )\n  }\n}\n","import React from \"react\"\nimport Followers from \"misago/components/profile/followers\"\n\nexport default class extends Followers {\n  setSpecialProps() {\n    this.PRELOADED_DATA_KEY = \"PROFILE_FOLLOWS\"\n    this.TITLE = pgettext(\"profile follows title\", \"Follows\")\n    this.API_FILTER = \"follows\"\n  }\n\n  getLabel() {\n    if (!this.state.isLoaded) {\n      return pgettext(\"profile follows\", \"Loading...\")\n    } else if (this.state.search) {\n      let message = npgettext(\n        \"profile follows\",\n        \"Found %(users)s user.\",\n        \"Found %(users)s users.\",\n        this.state.count\n      )\n\n      return interpolate(\n        message,\n        {\n          users: this.state.count,\n        },\n        true\n      )\n    } else if (this.props.profile.id === this.props.user.id) {\n      let message = npgettext(\n        \"profile follows\",\n        \"You are following %(users)s user.\",\n        \"You are following %(users)s users.\",\n        this.state.count\n      )\n\n      return interpolate(\n        message,\n        {\n          users: this.state.count,\n        },\n        true\n      )\n    } else {\n      let message = npgettext(\n        \"profile follows\",\n        \"%(username)s is following %(users)s user.\",\n        \"%(username)s is following %(users)s users.\",\n        this.state.count\n      )\n\n      return interpolate(\n        message,\n        {\n          username: this.props.profile.username,\n          users: this.state.count,\n        },\n        true\n      )\n    }\n  }\n\n  getEmptyMessage() {\n    if (this.state.search) {\n      return pgettext(\n        \"profile follows\",\n        \"Search returned no users matching specified criteria.\"\n      )\n    } else if (this.props.user.id === this.props.profile.id) {\n      return pgettext(\"profile follows\", \"You are not following any users.\")\n    } else {\n      return interpolate(\n        pgettext(\"profile follows\", \"%(username)s is not following any users.\"),\n        {\n          username: this.props.profile.username,\n        },\n        true\n      )\n    }\n  }\n}\n","import React from \"react\"\n\nexport default class extends React.Component {\n  getEmptyMessage() {\n    if (this.props.emptyMessage) {\n      return this.props.emptyMessage\n    } else {\n      return pgettext(\n        \"username history empty\",\n        \"Your account has no history of name changes.\"\n      )\n    }\n  }\n\n  render() {\n    return (\n      <div className=\"username-history ui-ready\">\n        <ul className=\"list-group\">\n          <li className=\"list-group-item empty-message\">\n            {this.getEmptyMessage()}\n          </li>\n        </ul>\n      </div>\n    )\n  }\n}\n","import React from \"react\"\nimport Avatar from \"misago/components/avatar\"\n\nexport default class extends React.Component {\n  renderUserAvatar() {\n    if (this.props.change.changed_by) {\n      return (\n        <a\n          href={this.props.change.changed_by.url}\n          className=\"user-avatar-wrapper\"\n        >\n          <Avatar user={this.props.change.changed_by} size=\"100\" />\n        </a>\n      )\n    } else {\n      return (\n        <span className=\"user-avatar-wrapper\">\n          <Avatar size=\"100\" />\n        </span>\n      )\n    }\n  }\n\n  renderUsername() {\n    if (this.props.change.changed_by) {\n      return (\n        <a href={this.props.change.changed_by.url} className=\"item-title\">\n          {this.props.change.changed_by.username}\n        </a>\n      )\n    } else {\n      return (\n        <span className=\"item-title\">\n          {this.props.change.changed_by_username}\n        </span>\n      )\n    }\n  }\n\n  render() {\n    return (\n      <li className=\"list-group-item\" key={this.props.change.id}>\n        <div className=\"change-avatar\">{this.renderUserAvatar()}</div>\n        <div className=\"change-author\">{this.renderUsername()}</div>\n        <div className=\"change\">\n          <span className=\"old-username\">{this.props.change.old_username}</span>\n          <span className=\"material-icon\">arrow_forward</span>\n          <span className=\"new-username\">{this.props.change.new_username}</span>\n        </div>\n        <div className=\"change-date\">\n          <abbr title={this.props.change.changed_on.format(\"LLL\")}>\n            {this.props.change.changed_on.fromNow()}\n          </abbr>\n        </div>\n      </li>\n    )\n  }\n}\n","import React from \"react\"\nimport Change from \"misago/components/username-history/change\"\n\nexport default class extends React.Component {\n  render() {\n    return (\n      <div className=\"username-history ui-ready\">\n        <ul className=\"list-group\">\n          {this.props.changes.map((change) => {\n            return <Change change={change} key={change.id} />\n          })}\n        </ul>\n      </div>\n    )\n  }\n}\n","import React from \"react\"\nimport Avatar from \"misago/components/avatar\"\nimport * as random from \"misago/utils/random\"\n\nexport default class extends React.Component {\n  shouldComponentUpdate() {\n    return false\n  }\n\n  getClassName() {\n    if (this.props.hiddenOnMobile) {\n      return \"list-group-item hidden-xs hidden-sm\"\n    } else {\n      return \"list-group-item\"\n    }\n  }\n\n  render() {\n    return (\n      <li className={this.getClassName()}>\n        <div className=\"change-avatar\">\n          <span className=\"user-avatar\">\n            <Avatar size=\"100\" />\n          </span>\n        </div>\n        <div className=\"change-author\">\n          <span\n            className=\"ui-preview-text\"\n            style={{ width: random.int(30, 100) + \"px\" }}\n          >\n            &nbsp;\n          </span>\n        </div>\n        <div className=\"change\">\n          <span\n            className=\"ui-preview-text\"\n            style={{ width: random.int(30, 70) + \"px\" }}\n          >\n            &nbsp;\n          </span>\n          <span className=\"material-icon\">arrow_forward</span>\n          <span\n            className=\"ui-preview-text\"\n            style={{ width: random.int(30, 70) + \"px\" }}\n          >\n            &nbsp;\n          </span>\n        </div>\n        <div className=\"change-date\">\n          <span\n            className=\"ui-preview-text\"\n            style={{ width: random.int(80, 140) + \"px\" }}\n          >\n            &nbsp;\n          </span>\n        </div>\n      </li>\n    )\n  }\n}\n","import React from \"react\"\nimport ChangePreview from \"misago/components/username-history/change-preview\"\n\nexport default class extends React.Component {\n  shouldComponentUpdate() {\n    return false\n  }\n\n  render() {\n    return (\n      <div className=\"username-history ui-preview\">\n        <ul className=\"list-group\">\n          {[0, 1, 2].map((i) => {\n            return <ChangePreview hiddenOnMobile={i > 0} key={i} />\n          })}\n        </ul>\n      </div>\n    )\n  }\n}\n","import React from \"react\"\nimport ListEmpty from \"misago/components/username-history/list-empty\"\nimport ListReady from \"misago/components/username-history/list-ready\"\nimport ListPreview from \"misago/components/username-history/list-preview\"\n\nexport default class extends React.Component {\n  render() {\n    if (this.props.isLoaded) {\n      if (this.props.changes.length) {\n        return <ListReady changes={this.props.changes} />\n      } else {\n        return <ListEmpty emptyMessage={this.props.emptyMessage} />\n      }\n    } else {\n      return <ListPreview />\n    }\n  }\n}\n","import React from \"react\"\nimport Button from \"misago/components/button\"\nimport Search from \"misago/components/quick-search\"\nimport UsernameHistory from \"misago/components/username-history/root\"\nimport misago from \"misago/index\"\nimport { hydrate, append } from \"misago/reducers/username-history\"\nimport ajax from \"misago/services/ajax\"\nimport snackbar from \"misago/services/snackbar\"\nimport store from \"misago/services/store\"\nimport title from \"misago/services/page-title\"\nimport { Toolbar, ToolbarItem, ToolbarSection } from \"../Toolbar\"\n\nexport default class extends React.Component {\n  constructor(props) {\n    super(props)\n\n    if (misago.has(\"PROFILE_NAME_HISTORY\")) {\n      this.initWithPreloadedData(misago.pop(\"PROFILE_NAME_HISTORY\"))\n    } else {\n      this.initWithoutPreloadedData()\n    }\n  }\n\n  initWithPreloadedData(data) {\n    this.state = {\n      isLoaded: true,\n      isBusy: false,\n\n      search: \"\",\n\n      count: data.count,\n      more: data.more,\n\n      page: data.page,\n      pages: data.pages,\n    }\n\n    store.dispatch(hydrate(data.results))\n  }\n\n  initWithoutPreloadedData() {\n    this.state = {\n      isLoaded: false,\n      isBusy: false,\n\n      search: \"\",\n\n      count: 0,\n      more: 0,\n\n      page: 1,\n      pages: 1,\n    }\n\n    this.loadChanges()\n  }\n\n  loadChanges(page = 1, search = null) {\n    ajax\n      .get(\n        misago.get(\"USERNAME_CHANGES_API\"),\n        {\n          user: this.props.profile.id,\n          search: search,\n          page: page || 1,\n        },\n        \"search-username-history\"\n      )\n      .then(\n        (data) => {\n          if (page === 1) {\n            store.dispatch(hydrate(data.results))\n          } else {\n            store.dispatch(append(data.results))\n          }\n\n          this.setState({\n            isLoaded: true,\n            isBusy: false,\n\n            count: data.count,\n            more: data.more,\n\n            page: data.page,\n            pages: data.pages,\n          })\n        },\n        (rejection) => {\n          snackbar.apiError(rejection)\n        }\n      )\n  }\n\n  componentDidMount() {\n    title.set({\n      title: pgettext(\"profile username history title\", \"Username history\"),\n      parent: this.props.profile.username,\n    })\n  }\n\n  loadMore = () => {\n    this.setState({\n      isBusy: true,\n    })\n\n    this.loadChanges(this.state.page + 1, this.state.search)\n  }\n\n  search = (ev) => {\n    this.setState({\n      isLoaded: false,\n      isBusy: true,\n\n      search: ev.target.value,\n\n      count: 0,\n      more: 0,\n\n      page: 1,\n      pages: 1,\n    })\n\n    this.loadChanges(1, ev.target.value)\n  }\n\n  getLabel() {\n    if (!this.state.isLoaded) {\n      return pgettext(\"profile username history\", \"Loading...\")\n    } else if (this.state.search) {\n      let message = npgettext(\n        \"profile username history\",\n        \"Found %(changes)s username change.\",\n        \"Found %(changes)s username changes.\",\n        this.state.count\n      )\n\n      return interpolate(\n        message,\n        {\n          changes: this.state.count,\n        },\n        true\n      )\n    } else if (this.props.profile.id === this.props.user.id) {\n      let message = npgettext(\n        \"profile username history\",\n        \"Your username was changed %(changes)s time.\",\n        \"Your username was changed %(changes)s times.\",\n        this.state.count\n      )\n\n      return interpolate(\n        message,\n        {\n          changes: this.state.count,\n        },\n        true\n      )\n    } else {\n      let message = npgettext(\n        \"profile username history\",\n        \"%(username)s's username was changed %(changes)s time.\",\n        \"%(username)s's username was changed %(changes)s times.\",\n        this.state.count\n      )\n\n      return interpolate(\n        message,\n        {\n          username: this.props.profile.username,\n          changes: this.state.count,\n        },\n        true\n      )\n    }\n  }\n\n  getEmptyMessage() {\n    if (this.state.search) {\n      return pgettext(\n        \"profile username history\",\n        \"Search returned no username changes matching specified criteria.\"\n      )\n    } else if (this.props.user.id === this.props.profile.id) {\n      return pgettext(\n        \"username history empty\",\n        \"Your account has no history of name changes.\"\n      )\n    } else {\n      return interpolate(\n        pgettext(\n          \"profile username history\",\n          \"%(username)s's username was never changed.\"\n        ),\n        {\n          username: this.props.profile.username,\n        },\n        true\n      )\n    }\n  }\n\n  getMoreButton() {\n    if (!this.state.more) return null\n\n    return (\n      <div className=\"pager-more\">\n        <Button\n          className=\"btn btn-default btn-outline\"\n          loading={this.state.isBusy}\n          onClick={this.loadMore}\n        >\n          {interpolate(\n            pgettext(\"profile username history\", \"Show older (%(more)s)\"),\n            {\n              more: this.state.more,\n            },\n            true\n          )}\n        </Button>\n      </div>\n    )\n  }\n\n  render() {\n    return (\n      <div className=\"profile-username-history\">\n        <Toolbar>\n          <ToolbarSection auto>\n            <ToolbarItem auto>\n              <h3>{this.getLabel()}</h3>\n            </ToolbarItem>\n          </ToolbarSection>\n          <ToolbarSection>\n            <ToolbarItem>\n              <Search\n                value={this.state.search}\n                onChange={this.search}\n                placeholder={pgettext(\n                  \"profile username history search input\",\n                  \"Search history...\"\n                )}\n              />\n            </ToolbarItem>\n          </ToolbarSection>\n        </Toolbar>\n\n        <UsernameHistory\n          isLoaded={this.state.isLoaded}\n          emptyMessage={this.getEmptyMessage()}\n          changes={this.props[\"username-history\"]}\n        />\n\n        {this.getMoreButton()}\n      </div>\n    )\n  }\n}\n","import React from \"react\"\nimport Button from \"misago/components/button\"\nimport { patch } from \"misago/reducers/profile\"\nimport ajax from \"misago/services/ajax\"\nimport snackbar from \"misago/services/snackbar\"\nimport store from \"misago/services/store\"\n\nexport default class extends React.Component {\n  constructor(props) {\n    super(props)\n\n    this.state = {\n      isLoading: false,\n    }\n  }\n\n  getClassName() {\n    if (this.props.profile.is_followed) {\n      return this.props.className + \" btn-default btn-following\"\n    } else {\n      return this.props.className + \" btn-default btn-follow\"\n    }\n  }\n\n  getIcon() {\n    if (this.props.profile.is_followed) {\n      return \"favorite\"\n    } else {\n      return \"favorite_border\"\n    }\n  }\n\n  getLabel() {\n    if (this.props.profile.is_followed) {\n      return pgettext(\"user profile follow btn\", \"Following\")\n    } else {\n      return pgettext(\"user profile follow btn\", \"Follow\")\n    }\n  }\n\n  action = () => {\n    this.setState({\n      isLoading: true,\n    })\n\n    if (this.props.profile.is_followed) {\n      store.dispatch(\n        patch({\n          is_followed: false,\n          followers: this.props.profile.followers - 1,\n        })\n      )\n    } else {\n      store.dispatch(\n        patch({\n          is_followed: true,\n          followers: this.props.profile.followers + 1,\n        })\n      )\n    }\n\n    ajax.post(this.props.profile.api.follow).then(\n      (data) => {\n        this.setState({\n          isLoading: false,\n        })\n\n        store.dispatch(patch(data))\n      },\n      (rejection) => {\n        this.setState({\n          isLoading: false,\n        })\n        snackbar.apiError(rejection)\n      }\n    )\n  }\n\n  render() {\n    return (\n      <Button\n        className={this.getClassName()}\n        disabled={this.state.isLoading}\n        onClick={this.action}\n      >\n        <span className=\"material-icon\">{this.getIcon()}</span>\n        {this.getLabel()}\n      </Button>\n    )\n  }\n}\n","import React from \"react\"\nimport posting from \"misago/services/posting\"\nimport misago from \"misago\"\n\nexport default class extends React.Component {\n  onClick = () => {\n    posting.open({\n      mode: \"START_PRIVATE\",\n      submit: misago.get(\"PRIVATE_THREADS_API\"),\n\n      to: [this.props.profile],\n    })\n  }\n\n  render() {\n    const canMessage = this.props.user.acl.can_start_private_threads\n    const isProfileOwner = this.props.user.id === this.props.profile.id\n\n    if (!canMessage || isProfileOwner) return null\n\n    return (\n      <button\n        className={this.props.className}\n        onClick={this.onClick}\n        type=\"button\"\n      >\n        <span className=\"material-icon\">comment</span>\n        {pgettext(\"profile message btn\", \"Message\")}\n      </button>\n    )\n  }\n}\n","import React from \"react\"\nimport Button from \"misago/components/button\"\nimport Form from \"misago/components/form\"\nimport FormGroup from \"misago/components/form-group\"\nimport Loader from \"misago/components/modal-loader\"\nimport YesNoSwitch from \"misago/components/yes-no-switch\"\nimport ModalMessage from \"misago/components/modal-message\"\nimport { updateAvatar } from \"misago/reducers/users\"\nimport ajax from \"misago/services/ajax\"\nimport snackbar from \"misago/services/snackbar\"\nimport store from \"misago/services/store\"\n\nexport default class extends Form {\n  constructor(props) {\n    super(props)\n\n    this.state = {\n      isLoaded: false,\n      isLoading: false,\n      error: null,\n\n      is_avatar_locked: \"\",\n      avatar_lock_user_message: \"\",\n      avatar_lock_staff_message: \"\",\n    }\n  }\n\n  componentDidMount() {\n    ajax.get(this.props.profile.api.moderate_avatar).then(\n      (options) => {\n        this.setState({\n          isLoaded: true,\n\n          is_avatar_locked: options.is_avatar_locked,\n          avatar_lock_user_message: options.avatar_lock_user_message || \"\",\n          avatar_lock_staff_message: options.avatar_lock_staff_message || \"\",\n        })\n      },\n      (rejection) => {\n        this.setState({\n          isLoaded: true,\n          error: rejection.detail,\n        })\n      }\n    )\n  }\n\n  clean() {\n    if (this.isValid()) {\n      return true\n    } else {\n      snackbar.error(this.validate().username[0])\n      return false\n    }\n  }\n\n  send() {\n    return ajax.post(this.props.profile.api.moderate_avatar, {\n      is_avatar_locked: this.state.is_avatar_locked,\n      avatar_lock_user_message: this.state.avatar_lock_user_message,\n      avatar_lock_staff_message: this.state.avatar_lock_staff_message,\n    })\n  }\n\n  handleSuccess(apiResponse) {\n    store.dispatch(updateAvatar(this.props.profile, apiResponse.avatar_hash))\n    snackbar.success(\n      pgettext(\n        \"profile avatar moderation\",\n        \"Avatar controls have been changed.\"\n      )\n    )\n  }\n\n  getFormBody() {\n    return (\n      <form onSubmit={this.handleSubmit}>\n        <div className=\"modal-body\">\n          <FormGroup\n            label={pgettext(\"profile avatar moderation field\", \"Lock avatar\")}\n            helpText={pgettext(\n              \"profile avatar moderation field\",\n              \"Locking user avatar will prohibit user from changing his avatar and will reset his/her avatar to default one.\"\n            )}\n            for=\"id_is_avatar_locked\"\n          >\n            <YesNoSwitch\n              id=\"id_is_avatar_locked\"\n              disabled={this.state.isLoading}\n              iconOn=\"lock_outline\"\n              iconOff=\"lock_open\"\n              labelOn={pgettext(\n                \"profile avatar moderation field\",\n                \"Disallow user from changing avatar\"\n              )}\n              labelOff={pgettext(\n                \"profile avatar moderation field\",\n                \"Allow user to change avatar\"\n              )}\n              onChange={this.bindInput(\"is_avatar_locked\")}\n              value={this.state.is_avatar_locked}\n            />\n          </FormGroup>\n\n          <FormGroup\n            label={pgettext(\"profile avatar moderation field\", \"User message\")}\n            helpText={pgettext(\n              \"profile avatar moderation field\",\n              \"Optional message for user explaining why they are prohibited from changing their avatar.\"\n            )}\n            for=\"id_avatar_lock_user_message\"\n          >\n            <textarea\n              id=\"id_avatar_lock_user_message\"\n              className=\"form-control\"\n              rows=\"4\"\n              disabled={this.state.isLoading}\n              onChange={this.bindInput(\"avatar_lock_user_message\")}\n              value={this.state.avatar_lock_user_message}\n            />\n          </FormGroup>\n\n          <FormGroup\n            label={pgettext(\"profile avatar moderation field\", \"Staff message\")}\n            helpText={pgettext(\n              \"profile avatar moderation field\",\n              \"Optional message for forum team members explaining why the user is prohibited form changing their avatar.\"\n            )}\n            for=\"id_avatar_lock_staff_message\"\n          >\n            <textarea\n              id=\"id_avatar_lock_staff_message\"\n              className=\"form-control\"\n              rows=\"4\"\n              disabled={this.state.isLoading}\n              onChange={this.bindInput(\"avatar_lock_staff_message\")}\n              value={this.state.avatar_lock_staff_message}\n            />\n          </FormGroup>\n        </div>\n        <div className=\"modal-footer\">\n          <button\n            type=\"button\"\n            className=\"btn btn-default\"\n            data-dismiss=\"modal\"\n          >\n            {pgettext(\"profile avatar moderation btn\", \"Close\")}\n          </button>\n          <Button className=\"btn-primary\" loading={this.state.isLoading}>\n            {pgettext(\"profile avatar moderation btn\", \"Save changes\")}\n          </Button>\n        </div>\n      </form>\n    )\n  }\n\n  getModalBody() {\n    if (this.state.error) {\n      return (\n        <ModalMessage icon=\"remove_circle_outline\" message={this.state.error} />\n      )\n    } else if (this.state.isLoaded) {\n      return this.getFormBody()\n    } else {\n      return <Loader />\n    }\n  }\n\n  getClassName() {\n    if (this.state.error) {\n      return \"modal-dialog modal-message modal-avatar-controls\"\n    } else {\n      return \"modal-dialog modal-avatar-controls\"\n    }\n  }\n\n  render() {\n    return (\n      <div className={this.getClassName()} role=\"document\">\n        <div className=\"modal-content\">\n          <div className=\"modal-header\">\n            <button\n              type=\"button\"\n              className=\"close\"\n              data-dismiss=\"modal\"\n              aria-label={pgettext(\"modal\", \"Close\")}\n            >\n              <span aria-hidden=\"true\">&times;</span>\n            </button>\n            <h4 className=\"modal-title\">\n              {pgettext(\"profile avatar moderation title\", \"Avatar controls\")}\n            </h4>\n          </div>\n          {this.getModalBody()}\n        </div>\n      </div>\n    )\n  }\n}\n","import React from \"react\"\nimport Button from \"misago/components/button\"\nimport Form from \"misago/components/form\"\nimport FormGroup from \"misago/components/form-group\"\nimport Loader from \"misago/components/modal-loader\"\nimport ModalMessage from \"misago/components/modal-message\"\nimport { addNameChange } from \"misago/reducers/username-history\"\nimport { updateUsername } from \"misago/reducers/users\"\nimport ajax from \"misago/services/ajax\"\nimport snackbar from \"misago/services/snackbar\"\nimport store from \"misago/services/store\"\nimport * as validators from \"misago/utils/validators\"\n\nexport default class extends Form {\n  constructor(props) {\n    super(props)\n\n    this.state = {\n      isLoaded: false,\n      isLoading: false,\n      error: null,\n\n      username: \"\",\n      validators: {\n        username: [validators.usernameContent()],\n      },\n    }\n  }\n\n  componentDidMount() {\n    ajax.get(this.props.profile.api.moderate_username).then(\n      () => {\n        this.setState({\n          isLoaded: true,\n        })\n      },\n      (rejection) => {\n        this.setState({\n          isLoaded: true,\n          error: rejection.detail,\n        })\n      }\n    )\n  }\n\n  clean() {\n    if (this.isValid()) {\n      return true\n    } else {\n      snackbar.error(this.validate().username[0])\n      return false\n    }\n  }\n\n  send() {\n    return ajax.post(this.props.profile.api.moderate_username, {\n      username: this.state.username,\n    })\n  }\n\n  handleSuccess(apiResponse) {\n    this.setState({\n      username: \"\",\n    })\n\n    store.dispatch(\n      addNameChange(apiResponse, this.props.profile, this.props.user)\n    )\n    store.dispatch(\n      updateUsername(this.props.profile, apiResponse.username, apiResponse.slug)\n    )\n\n    snackbar.success(\n      pgettext(\"profile username moderation\", \"Username has been changed.\")\n    )\n  }\n\n  getFormBody() {\n    return (\n      <form onSubmit={this.handleSubmit}>\n        <div className=\"modal-body\">\n          <FormGroup\n            label={pgettext(\n              \"profile username moderation field\",\n              \"New username\"\n            )}\n            for=\"id_username\"\n          >\n            <input\n              type=\"text\"\n              id=\"id_username\"\n              className=\"form-control\"\n              disabled={this.state.isLoading}\n              onChange={this.bindInput(\"username\")}\n              value={this.state.username}\n            />\n          </FormGroup>\n        </div>\n        <div className=\"modal-footer\">\n          <button\n            className=\"btn btn-default\"\n            data-dismiss=\"modal\"\n            disabled={this.state.isLoading}\n            type=\"button\"\n          >\n            {pgettext(\"profile username moderation btn\", \"Cancel\")}\n          </button>\n          <Button className=\"btn-primary\" loading={this.state.isLoading}>\n            {pgettext(\"profile username moderation btn\", \"Change username\")}\n          </Button>\n        </div>\n      </form>\n    )\n  }\n\n  getModalBody() {\n    if (this.state.error) {\n      return (\n        <ModalMessage icon=\"remove_circle_outline\" message={this.state.error} />\n      )\n    } else if (this.state.isLoaded) {\n      return this.getFormBody()\n    } else {\n      return <Loader />\n    }\n  }\n\n  getClassName() {\n    if (this.state.error) {\n      return \"modal-dialog modal-message modal-rename-user\"\n    } else {\n      return \"modal-dialog modal-rename-user\"\n    }\n  }\n\n  render() {\n    return (\n      <div className={this.getClassName()} role=\"document\">\n        <div className=\"modal-content\">\n          <div className=\"modal-header\">\n            <button\n              type=\"button\"\n              className=\"close\"\n              data-dismiss=\"modal\"\n              aria-label={pgettext(\"modal\", \"Close\")}\n            >\n              <span aria-hidden=\"true\">&times;</span>\n            </button>\n            <h4 className=\"modal-title\">\n              {pgettext(\"profile username moderation title\", \"Change username\")}\n            </h4>\n          </div>\n          {this.getModalBody()}\n        </div>\n      </div>\n    )\n  }\n}\n","import React from \"react\"\nimport Button from \"misago/components/button\"\nimport Form from \"misago/components/form\"\nimport FormGroup from \"misago/components/form-group\"\nimport Loader from \"misago/components/modal-loader\"\nimport ModalMessage from \"misago/components/modal-message\"\nimport YesNoSwitch from \"misago/components/yes-no-switch\"\nimport misago from \"misago/index\"\nimport ajax from \"misago/services/ajax\"\nimport polls from \"misago/services/polls\"\n\nexport default class extends Form {\n  constructor(props) {\n    super(props)\n\n    this.state = {\n      isLoaded: false,\n      isLoading: false,\n      isDeleted: false,\n      error: null,\n\n      countdown: 5,\n      confirm: false,\n\n      with_content: false,\n    }\n  }\n\n  componentDidMount() {\n    ajax.get(this.props.profile.api.delete).then(\n      () => {\n        this.setState({\n          isLoaded: true,\n        })\n\n        this.countdown()\n      },\n      (rejection) => {\n        this.setState({\n          isLoaded: true,\n          error: rejection.detail,\n        })\n      }\n    )\n  }\n\n  countdown = () => {\n    window.setTimeout(() => {\n      if (this.state.countdown > 1) {\n        this.setState({\n          countdown: this.state.countdown - 1,\n        })\n        this.countdown()\n      } else if (!this.state.confirm) {\n        this.setState({\n          confirm: true,\n        })\n      }\n    }, 1000)\n  }\n\n  send() {\n    return ajax.post(this.props.profile.api.delete, {\n      with_content: this.state.with_content,\n    })\n  }\n\n  handleSuccess() {\n    polls.stop(\"user-profile\")\n\n    if (this.state.with_content) {\n      this.setState({\n        isDeleted: interpolate(\n          pgettext(\n            \"profile delete\",\n            \"%(username)s's account, threads, posts and other content has been deleted.\"\n          ),\n          {\n            username: this.props.profile.username,\n          },\n          true\n        ),\n      })\n    } else {\n      this.setState({\n        isDeleted: interpolate(\n          pgettext(\n            \"profile delete\",\n            \"%(username)s's account has been deleted and other content has been hidden.\"\n          ),\n          {\n            username: this.props.profile.username,\n          },\n          true\n        ),\n      })\n    }\n  }\n\n  getButtonLabel() {\n    if (this.state.confirm) {\n      return interpolate(\n        pgettext(\"profile delete btn\", \"Delete %(username)s\"),\n        {\n          username: this.props.profile.username,\n        },\n        true\n      )\n    } else {\n      return interpolate(\n        pgettext(\"profile delete btn\", \"Please wait... (%(countdown)ss)\"),\n        {\n          countdown: this.state.countdown,\n        },\n        true\n      )\n    }\n  }\n\n  getForm() {\n    return (\n      <form onSubmit={this.handleSubmit}>\n        <div className=\"modal-body\">\n          <FormGroup\n            label={pgettext(\"profile delete\", \"User content\")}\n            for=\"id_with_content\"\n          >\n            <YesNoSwitch\n              id=\"id_with_content\"\n              disabled={this.state.isLoading}\n              labelOn={pgettext(\n                \"profile delete content\",\n                \"Delete together with user's account\"\n              )}\n              labelOff={pgettext(\n                \"profile delete content\",\n                \"Hide after deleting user's account\"\n              )}\n              onChange={this.bindInput(\"with_content\")}\n              value={this.state.with_content}\n            />\n          </FormGroup>\n        </div>\n        <div className=\"modal-footer\">\n          <button\n            type=\"button\"\n            className=\"btn btn-default\"\n            data-dismiss=\"modal\"\n          >\n            {pgettext(\"profile delete btn\", \"Cancel\")}\n          </button>\n\n          <Button\n            className=\"btn-danger\"\n            loading={this.state.isLoading}\n            disabled={!this.state.confirm}\n          >\n            {this.getButtonLabel()}\n          </Button>\n        </div>\n      </form>\n    )\n  }\n\n  getDeletedBody() {\n    return (\n      <div className=\"modal-body\">\n        <div className=\"message-icon\">\n          <span className=\"material-icon\">info_outline</span>\n        </div>\n        <div className=\"message-body\">\n          <p className=\"lead\">{this.state.isDeleted}</p>\n          <p>\n            <a href={misago.get(\"USERS_LIST_URL\")}>\n              {pgettext(\"profile delete link\", \"Return to users list\")}\n            </a>\n          </p>\n        </div>\n      </div>\n    )\n  }\n\n  getModalBody() {\n    if (this.state.error) {\n      return (\n        <ModalMessage icon=\"remove_circle_outline\" message={this.state.error} />\n      )\n    } else if (this.state.isLoaded) {\n      if (this.state.isDeleted) {\n        return this.getDeletedBody()\n      } else {\n        return this.getForm()\n      }\n    } else {\n      return <Loader />\n    }\n  }\n\n  getClassName() {\n    if (this.state.error || this.state.isDeleted) {\n      return \"modal-dialog modal-message modal-delete-account\"\n    } else {\n      return \"modal-dialog modal-delete-account\"\n    }\n  }\n\n  render() {\n    return (\n      <div className={this.getClassName()} role=\"document\">\n        <div className=\"modal-content\">\n          <div className=\"modal-header\">\n            <button\n              type=\"button\"\n              className=\"close\"\n              data-dismiss=\"modal\"\n              aria-label={pgettext(\"modal\", \"Close\")}\n            >\n              <span aria-hidden=\"true\">&times;</span>\n            </button>\n            <h4 className=\"modal-title\">\n              {pgettext(\"profile delete title\", \"Delete user account\")}\n            </h4>\n          </div>\n          {this.getModalBody()}\n        </div>\n      </div>\n    )\n  }\n}\n","import React from \"react\"\nimport { connect } from \"react-redux\"\nimport AvatarControls from \"misago/components/profile/moderation/avatar-controls\"\nimport ChangeUsername from \"misago/components/profile/moderation/change-username\"\nimport DeleteAccount from \"misago/components/profile/moderation/delete-account\"\nimport modal from \"misago/services/modal\"\n\nlet select = function (store) {\n  return {\n    tick: store.tick,\n    user: store.auth,\n    profile: store.profile,\n  }\n}\n\nexport default class extends React.Component {\n  showAvatarDialog = () => {\n    modal.show(connect(select)(AvatarControls))\n  }\n\n  showRenameDialog = () => {\n    modal.show(connect(select)(ChangeUsername))\n  }\n\n  showDeleteDialog = () => {\n    modal.show(connect(select)(DeleteAccount))\n  }\n\n  render() {\n    const { moderation } = this.props\n\n    return (\n      <ul className=\"dropdown-menu dropdown-menu-right\" role=\"menu\">\n        {!!moderation.avatar && (\n          <li>\n            <button\n              type=\"button\"\n              className=\"btn btn-link\"\n              onClick={this.showAvatarDialog}\n            >\n              <span className=\"material-icon\">portrait</span>\n              {pgettext(\"profile moderation menu\", \"Avatar controls\")}\n            </button>\n          </li>\n        )}\n        {!!moderation.rename && (\n          <li>\n            <button\n              type=\"button\"\n              className=\"btn btn-link\"\n              onClick={this.showRenameDialog}\n            >\n              <span className=\"material-icon\">credit_card</span>\n              {pgettext(\"profile moderation menu\", \"Change username\")}\n            </button>\n          </li>\n        )}\n        {!!moderation.delete && (\n          <li>\n            <button\n              type=\"button\"\n              className=\"btn btn-link\"\n              onClick={this.showDeleteDialog}\n            >\n              <span className=\"material-icon\">clear</span>\n              {pgettext(\"profile moderation menu\", \"Delete account\")}\n            </button>\n          </li>\n        )}\n      </ul>\n    )\n  }\n}\n","import React from \"react\"\nimport Status, { StatusIcon, StatusLabel } from \"../user-status\"\n\nconst ProfileDataList = ({ profile }) => (\n  <ul className=\"profile-data-list\">\n    {profile.is_active === false && (\n      <li className=\"user-account-disabled\">\n        <abbr\n          title={pgettext(\n            \"profile data list\",\n            \"This user's account has been disabled by administrator.\"\n          )}\n        >\n          {pgettext(\"profile data list\", \"Account disabled\")}\n        </abbr>\n      </li>\n    )}\n    <li className=\"user-status-display\">\n      <Status user={profile} status={profile.status}>\n        <StatusIcon user={profile} status={profile.status} />\n        <StatusLabel\n          user={profile}\n          status={profile.status}\n          className=\"status-label\"\n        />\n      </Status>\n    </li>\n    {profile.rank.is_tab ? (\n      <li className=\"user-rank\">\n        <a href={profile.rank.url} className=\"item-title\">\n          {profile.rank.name}\n        </a>\n      </li>\n    ) : (\n      <li className=\"user-rank\">\n        <span className=\"item-title\">{profile.rank.name}</span>\n      </li>\n    )}\n    {(profile.title || profile.rank.title) && (\n      <li className=\"user-title\">{profile.title || profile.rank.title}</li>\n    )}\n    <li className=\"user-joined-on\">\n      <abbr\n        title={interpolate(\n          pgettext(\"profile data list\", \"Joined on %(joined_on)s\"),\n          {\n            joined_on: profile.joined_on.format(\"LL, LT\"),\n          },\n          true\n        )}\n      >\n        {interpolate(\n          pgettext(\"profile data list\", \"Joined %(joined_on)s\"),\n          {\n            joined_on: profile.joined_on.fromNow(),\n          },\n          true\n        )}\n      </abbr>\n    </li>\n    {profile.email && (\n      <li className=\"user-email\">\n        <a href={\"mailto:\" + profile.email} className=\"item-title\">\n          {profile.email}\n        </a>\n      </li>\n    )}\n  </ul>\n)\n\nexport default ProfileDataList\n","import React from \"react\"\nimport Avatar from \"../avatar\"\nimport { FlexRow, FlexRowCol, FlexRowSection } from \"../FlexRow\"\nimport {\n  PageHeader,\n  PageHeaderBanner,\n  PageHeaderContainer,\n  PageHeaderDetails,\n} from \"../PageHeader\"\nimport FollowButton from \"./follow-button\"\nimport MessageButton from \"./message-button\"\nimport ModerationOptions from \"./moderation/nav\"\nimport ProfileDataList from \"./ProfileDataList\"\n\nconst ProfileHeader = ({ profile, user, moderation, message, follow }) => (\n  <PageHeaderContainer>\n    <PageHeader\n      styleName={\n        profile.rank.css_class ? \"rank-\" + profile.rank.css_class : \"profile\"\n      }\n    >\n      <PageHeaderBanner\n        styleName={\n          profile.rank.css_class ? \"rank-\" + profile.rank.css_class : \"profile\"\n        }\n      >\n        <div className=\"profile-page-header\">\n          <div className=\"profile-page-header-avatar\">\n            <Avatar\n              className=\"user-avatar hidden-sm hidden-md hidden-lg\"\n              user={profile}\n              size={200}\n              size2x={400}\n            />\n            <Avatar\n              className=\"user-avatar hidden-xs hidden-md hidden-lg\"\n              user={profile}\n              size={64}\n              size2x={128}\n            />\n            <Avatar\n              className=\"user-avatar hidden-xs hidden-sm\"\n              user={profile}\n              size={128}\n              size2x={256}\n            />\n          </div>\n          <h1>{profile.username}</h1>\n        </div>\n      </PageHeaderBanner>\n      <PageHeaderDetails className=\"profile-page-header-details\">\n        <FlexRow>\n          <FlexRowSection auto>\n            <FlexRowCol>\n              <ProfileDataList profile={profile} />\n            </FlexRowCol>\n          </FlexRowSection>\n          {message && (\n            <FlexRowSection>\n              <FlexRowCol>\n                <MessageButton\n                  className=\"btn btn-default btn-block btn-outline\"\n                  profile={profile}\n                  user={user}\n                />\n              </FlexRowCol>\n              {moderation.available && !follow && (\n                <FlexRowCol shrink>\n                  <div className=\"dropdown\">\n                    <ProfileModerationButton />\n                    <ModerationOptions\n                      profile={profile}\n                      moderation={moderation}\n                    />\n                  </div>\n                </FlexRowCol>\n              )}\n            </FlexRowSection>\n          )}\n          {follow && (\n            <FlexRowSection>\n              <FlexRowCol>\n                <FollowButton\n                  className=\"btn btn-block btn-outline\"\n                  profile={profile}\n                />\n              </FlexRowCol>\n              {moderation.available && (\n                <FlexRowCol shrink>\n                  <div className=\"dropdown\">\n                    <ProfileModerationButton />\n                    <ModerationOptions\n                      profile={profile}\n                      moderation={moderation}\n                    />\n                  </div>\n                </FlexRowCol>\n              )}\n            </FlexRowSection>\n          )}\n          {moderation.available && !follow && !message && (\n            <FlexRowSection>\n              <FlexRowCol className=\"hidden-xs\" shrink>\n                <div className=\"dropdown\">\n                  <ProfileModerationButton />\n                  <ModerationOptions\n                    profile={profile}\n                    moderation={moderation}\n                  />\n                </div>\n              </FlexRowCol>\n              <FlexRowCol className=\"hidden-sm hidden-md hidden-lg\">\n                <div className=\"dropdown\">\n                  <button\n                    className=\"btn btn-default btn-block btn-outline dropdown-toggle\"\n                    type=\"button\"\n                    data-toggle=\"dropdown\"\n                    aria-haspopup=\"true\"\n                    aria-expanded=\"false\"\n                  >\n                    <span className=\"material-icon\">settings</span>\n                    {pgettext(\"profile options btn\", \"Options\")}\n                  </button>\n                  <ModerationOptions\n                    profile={profile}\n                    moderation={moderation}\n                  />\n                </div>\n              </FlexRowCol>\n            </FlexRowSection>\n          )}\n        </FlexRow>\n      </PageHeaderDetails>\n    </PageHeader>\n  </PageHeaderContainer>\n)\n\nconst ProfileModerationButton = () => (\n  <button\n    className=\"btn btn-default btn-icon btn-outline dropdown-toggle\"\n    type=\"button\"\n    title={pgettext(\"profile options btn\", \"Options\")}\n    data-toggle=\"dropdown\"\n    aria-haspopup=\"true\"\n    aria-expanded=\"false\"\n  >\n    <span className=\"material-icon\">settings</span>\n  </button>\n)\n\nexport default ProfileHeader\n","import React from \"react\"\nimport { Link } from \"react-router\"\nimport Li from \"misago/components/li\"\n\nconst ProfileNav = ({ baseUrl, page, pages }) => (\n  <div className=\"nav-container\">\n    <div className=\"dropdown hidden-sm hidden-md hidden-lg\">\n      <button\n        className=\"btn btn-default btn-block btn-outline dropdown-toggle\"\n        type=\"button\"\n        data-toggle=\"dropdown\"\n        aria-haspopup=\"true\"\n        aria-expanded=\"false\"\n      >\n        <span className=\"material-icon\">{page.icon}</span>\n        {page.name}\n      </button>\n      <ul className=\"dropdown-menu stick-to-bottom\">\n        {pages.map((page) => (\n          <li key={page.component}>\n            <Link to={baseUrl + page.component + \"/\"}>\n              <span className=\"material-icon\">{page.icon}</span>\n              {page.name}\n            </Link>\n          </li>\n        ))}\n      </ul>\n    </div>\n    <ul className=\"nav nav-pills hidden-xs\" role=\"menu\">\n      {pages.map((page) => (\n        <Li path={baseUrl + page.component + \"/\"} key={page.component}>\n          <Link to={baseUrl + page.component + \"/\"}>\n            <span className=\"material-icon\">{page.icon}</span>\n            {page.name}\n          </Link>\n        </Li>\n      ))}\n    </ul>\n  </div>\n)\n\nexport default ProfileNav\n","import React from \"react\"\nimport { connect } from \"react-redux\"\nimport BanDetails from \"./ban-details\"\nimport Details from \"./details\"\nimport { Posts, Threads } from \"./feed\"\nimport Followers from \"./followers\"\nimport Follows from \"./follows\"\nimport UsernameHistory from \"./username-history\"\nimport WithDropdown from \"misago/components/with-dropdown\"\nimport misago from \"misago\"\nimport { hydrate } from \"misago/reducers/profile\"\nimport polls from \"misago/services/polls\"\nimport store from \"misago/services/store\"\nimport PageContainer from \"../PageContainer\"\nimport ProfileHeader from \"./ProfileHeader\"\nimport ProfileNav from \"./ProfileNav\"\n\nexport default class extends WithDropdown {\n  constructor(props) {\n    super(props)\n\n    this.startPolling(props.profile.api.index)\n  }\n\n  startPolling(api) {\n    polls.start({\n      poll: \"user-profile\",\n      url: api,\n      frequency: 90 * 1000,\n      update: this.update,\n    })\n  }\n\n  update = (data) => {\n    store.dispatch(hydrate(data))\n  }\n\n  render() {\n    const baseUrl = misago.get(\"PROFILE\").url\n    const pages = misago.get(\"PROFILE_PAGES\")\n    const page = pages.filter((page) => {\n      const url = baseUrl + page.component + \"/\"\n      return this.props.location.pathname === url\n    })[0]\n    const { profile, user } = this.props\n    const moderation = getModeration(profile, user)\n    const message =\n      !!user.acl.can_start_private_threads && profile.id !== user.id\n    const follow = !!profile.acl.can_follow && profile.id !== user.id\n\n    return (\n      <div className=\"page page-user-profile\">\n        <ProfileHeader\n          profile={this.props.profile}\n          user={this.props.user}\n          moderation={moderation}\n          message={message}\n          follow={follow}\n        />\n        <PageContainer>\n          <ProfileNav baseUrl={baseUrl} page={page} pages={pages} />\n\n          {this.props.children}\n        </PageContainer>\n      </div>\n    )\n  }\n}\n\nconst getModeration = (profile, user) => {\n  const moderation = {\n    available: false,\n    rename: false,\n    avatar: false,\n    delete: false,\n  }\n\n  if (user.is_anonymous) return moderation\n\n  moderation.rename = profile.acl.can_rename\n  moderation.avatar = profile.acl.can_moderate_avatar\n  moderation.delete = profile.acl.can_delete\n  moderation.available = !!(\n    moderation.rename ||\n    moderation.avatar ||\n    moderation.delete\n  )\n\n  return moderation\n}\n\nexport function select(store) {\n  return {\n    isAuthenticated: store.auth.user.id === store.profile.id,\n\n    tick: store.tick.tick,\n    user: store.auth.user,\n    users: store.users,\n    posts: store.posts,\n    profile: store.profile,\n    profileDetails: store[\"profile-details\"],\n    \"username-history\": store[\"username-history\"],\n  }\n}\n\nconst COMPONENTS = {\n  posts: Posts,\n  threads: Threads,\n  followers: Followers,\n  follows: Follows,\n  details: Details,\n  \"username-history\": UsernameHistory,\n  \"ban-details\": BanDetails,\n}\n\nexport function paths() {\n  let paths = []\n  misago.get(\"PROFILE_PAGES\").forEach(function (item) {\n    paths.push(\n      Object.assign({}, item, {\n        path: misago.get(\"PROFILE\").url + item.component + \"/\",\n        component: connect(select)(COMPONENTS[item.component]),\n      })\n    )\n  })\n\n  return paths\n}\n","import React from \"react\"\nimport Route from \"./route\"\n\nexport function Threads(props) {\n  let emptyMessage = null\n  if (props.user.id === props.profile.id) {\n    emptyMessage = pgettext(\n      \"profile threads\",\n      \"You haven't started any threads.\"\n    )\n  } else {\n    emptyMessage = interpolate(\n      pgettext(\"profile threads\", \"%(username)s hasn't started any threads\"),\n      {\n        username: props.profile.username,\n      },\n      true\n    )\n  }\n\n  let header = null\n  if (!props.posts.isLoaded) {\n    header = pgettext(\"profile threads\", \"Loading...\")\n  } else if (props.profile.id === props.user.id) {\n    const message = npgettext(\n      \"profile threads\",\n      \"You have started %(threads)s thread.\",\n      \"You have started %(threads)s threads.\",\n      props.profile.threads\n    )\n\n    header = interpolate(\n      message,\n      {\n        threads: props.profile.threads,\n      },\n      true\n    )\n  } else {\n    const message = npgettext(\n      \"profile threads\",\n      \"%(username)s has started %(threads)s thread.\",\n      \"%(username)s has started %(threads)s threads.\",\n      props.profile.threads\n    )\n\n    header = interpolate(\n      message,\n      {\n        username: props.profile.username,\n        threads: props.profile.threads,\n      },\n      true\n    )\n  }\n\n  return (\n    <Route\n      api={props.profile.api.threads}\n      emptyMessage={emptyMessage}\n      header={header}\n      title={pgettext(\"profile threads title\", \"Threads\")}\n      {...props}\n    />\n  )\n}\n\nexport function Posts(props) {\n  let emptyMessage = null\n  if (props.user.id === props.profile.id) {\n    emptyMessage = pgettext(\"profile posts\", \"You have posted no messages.\")\n  } else {\n    emptyMessage = interpolate(\n      pgettext(\"profile posts\", \"%(username)s posted no messages.\"),\n      {\n        username: props.profile.username,\n      },\n      true\n    )\n  }\n\n  let header = null\n  if (!props.posts.isLoaded) {\n    header = pgettext(\"profile posts\", \"Loading...\")\n  } else if (props.profile.id === props.user.id) {\n    const message = npgettext(\n      \"profile posts\",\n      \"You have posted %(posts)s message.\",\n      \"You have posted %(posts)s messages.\",\n      props.profile.posts\n    )\n\n    header = interpolate(\n      message,\n      {\n        posts: props.profile.posts,\n      },\n      true\n    )\n  } else {\n    const message = npgettext(\n      \"profile posts\",\n      \"%(username)s has posted %(posts)s message.\",\n      \"%(username)s has posted %(posts)s messages.\",\n      props.profile.posts\n    )\n\n    header = interpolate(\n      message,\n      {\n        username: props.profile.username,\n        posts: props.profile.posts,\n      },\n      true\n    )\n  }\n\n  return (\n    <Route\n      api={props.profile.api.posts}\n      emptyMessage={emptyMessage}\n      header={header}\n      title={pgettext(\"profile posts title\", \"Posts\")}\n      {...props}\n    />\n  )\n}\n","import { connect } from \"react-redux\"\nimport Profile, { paths, select } from \"misago/components/profile/root\"\nimport misago from \"misago/index\"\nimport mount from \"misago/utils/routed-component\"\n\nexport default function initializer(context) {\n  if (context.has(\"PROFILE\") && context.has(\"PROFILE_PAGES\")) {\n    mount({\n      root: misago.get(\"PROFILE\").url,\n      component: connect(select)(Profile),\n      paths: paths(),\n    })\n  }\n}\n\nmisago.addInitializer({\n  name: \"component:profile\",\n  initializer: initializer,\n  after: \"reducer:profile-hydrate\",\n})\n","import classnames from \"classnames\"\nimport React from \"react\"\nimport { DropdownFooter, DropdownPills } from \"../Dropdown\"\nimport { Overlay, OverlayHeader } from \"../Overlay\"\n\nexport default function NotificationsOverlayBody({\n  children,\n  open,\n  showAll,\n  showUnread,\n  unread,\n}) {\n  return (\n    <Overlay open={open}>\n      <OverlayHeader>\n        {pgettext(\"notifications title\", \"Notifications\")}\n      </OverlayHeader>\n      <DropdownPills>\n        <NotificationsOverlayBodyPill active={!unread} onClick={showAll}>\n          {pgettext(\"notifications dropdown\", \"All\")}\n        </NotificationsOverlayBodyPill>\n        <NotificationsOverlayBodyPill active={unread} onClick={showUnread}>\n          {pgettext(\"notifications dropdown\", \"Unread\")}\n        </NotificationsOverlayBodyPill>\n      </DropdownPills>\n      {children}\n      <DropdownFooter>\n        <a\n          className=\"btn btn-default btn-block\"\n          href={misago.get(\"NOTIFICATIONS_URL\")}\n        >\n          {pgettext(\"notifications\", \"See all notifications\")}\n        </a>\n      </DropdownFooter>\n    </Overlay>\n  )\n}\n\nfunction NotificationsOverlayBodyPill({ active, children, onClick }) {\n  return (\n    <button\n      className={classnames(\"btn\", {\n        \"btn-primary\": active,\n        \"btn-default\": !active,\n      })}\n      type=\"button\"\n      onClick={onClick}\n    >\n      {children}\n    </button>\n  )\n}\n","import React from \"react\"\nimport { connect } from \"react-redux\"\nimport NotificationsFetch from \"../NotificationsFetch\"\nimport {\n  NotificationsList,\n  NotificationsListError,\n  NotificationsListLoading,\n} from \"../NotificationsList\"\nimport NotificationsOverlayBody from \"./NotificationsOverlayBody\"\n\nclass NotificationsOverlay extends React.Component {\n  constructor(props) {\n    super(props)\n\n    this.body = document.body\n\n    this.state = {\n      unread: false,\n      url: \"\",\n    }\n  }\n\n  getApiUrl() {\n    let url = misago.get(\"NOTIFICATIONS_API\") + \"?limit=20\"\n    url += this.state.unread ? \"&filter=unread\" : \"\"\n    return url\n  }\n\n  componentDidUpdate(prevProps, prevState) {\n    if (prevProps.open !== this.props.open) {\n      if (this.props.open) {\n        this.body.classList.add(\"notifications-fullscreen\")\n      } else {\n        this.body.classList.remove(\"notifications-fullscreen\")\n      }\n    }\n  }\n\n  render = () => (\n    <NotificationsOverlayBody\n      open={this.props.open}\n      unread={this.state.unread}\n      showAll={() => this.setState({ unread: false })}\n      showUnread={() => this.setState({ unread: true })}\n    >\n      <NotificationsFetch\n        filter={this.state.unread ? \"unread\" : \"all\"}\n        disabled={!this.props.open}\n      >\n        {({ data, loading, error }) => {\n          if (loading) {\n            return <NotificationsListLoading />\n          }\n\n          if (error) {\n            return <NotificationsListError error={error} />\n          }\n\n          return (\n            <NotificationsList\n              filter={this.state.unread ? \"unread\" : \"all\"}\n              items={data ? data.results : []}\n            />\n          )\n        }}\n      </NotificationsFetch>\n    </NotificationsOverlayBody>\n  )\n}\n\nfunction select(state) {\n  return { open: state.overlay.notifications }\n}\n\nconst NotificationsOverlayConnected = connect(select)(NotificationsOverlay)\n\nexport default NotificationsOverlayConnected\n","import NotificationsOverlay from \"./NotificationsOverlay\"\n\nexport default NotificationsOverlay\n","import React from \"react\"\nimport ReactDOM from \"react-dom\"\nimport { Provider } from \"react-redux\"\nimport NotificationsOverlay from \"../../components/NotificationsOverlay\"\nimport store from \"../../services/store\"\n\nexport default function initializer(context) {\n  if (context.get(\"isAuthenticated\")) {\n    const root = document.getElementById(\"notifications-mount\")\n    ReactDOM.render(\n      <Provider store={store.getStore()}>\n        <NotificationsOverlay />\n      </Provider>,\n      root\n    )\n  }\n}\n\nmisago.addInitializer({\n  name: \"component:notifications-overlay\",\n  initializer: initializer,\n  after: \"store\",\n})\n","import misago from \"misago/index\"\nimport ajax from \"misago/services/ajax\"\nimport posting from \"misago/services/posting\"\nimport snackbar from \"misago/services/snackbar\"\n\nexport default function initializer() {\n  posting.init(ajax, snackbar, document.getElementById(\"posting-mount\"))\n}\n\nmisago.addInitializer({\n  name: \"posting\",\n  initializer: initializer,\n})\n","import misago from \"misago/index\"\nimport snackbar from \"misago/services/snackbar\"\nimport store from \"misago/services/store\"\n\nexport default function initializer() {\n  snackbar.init(store)\n}\n\nmisago.addInitializer({\n  name: \"snackbar\",\n  initializer: initializer,\n  after: \"store\",\n})\n","import NotificationsFetch from \"./NotificationsFetch\"\n\nexport default NotificationsFetch\n","import React from \"react\"\n\nexport default class extends React.Component {\n  refresh() {\n    window.location.reload()\n  }\n\n  getMessage() {\n    if (this.props.signedIn) {\n      return interpolate(\n        pgettext(\n          \"auth message\",\n          \"You have signed in as %(username)s. Please refresh the page before continuing.\"\n        ),\n        { username: this.props.signedIn.username },\n        true\n      )\n    } else if (this.props.signedOut) {\n      return interpolate(\n        pgettext(\n          \"auth message\",\n          \"%(username)s, you have been signed out. Please refresh the page before continuing.\"\n        ),\n        { username: this.props.user.username },\n        true\n      )\n    }\n  }\n\n  render() {\n    let className = \"auth-message\"\n    if (this.props.signedIn || this.props.signedOut) {\n      className += \" show\"\n    }\n\n    return (\n      <div className={className}>\n        <div className=\"container\">\n          <p className=\"lead\">{this.getMessage()}</p>\n          <p>\n            <button\n              className=\"btn btn-default\"\n              type=\"button\"\n              onClick={this.refresh}\n            >\n              {pgettext(\"auth message\", \"Reload page\")}\n            </button>\n            <span className=\"hidden-xs hidden-sm\">\n              {\" \" + pgettext(\"auth message\", \"or press F5 key.\")}\n            </span>\n          </p>\n        </div>\n      </div>\n    )\n  }\n}\n\nexport function select(state) {\n  return {\n    user: state.auth.user,\n    signedIn: state.auth.signedIn,\n    signedOut: state.auth.signedOut,\n  }\n}\n","import { connect } from \"react-redux\"\nimport misago from \"misago/index\"\nimport AuthMessage, { select } from \"misago/components/auth-message\"\nimport mount from \"misago/utils/mount-component\"\n\nexport default function initializer() {\n  mount(connect(select)(AuthMessage), \"auth-message-mount\")\n}\n\nmisago.addInitializer({\n  name: \"component:auth-message\",\n  initializer: initializer,\n  after: \"store\",\n})\n","import React from \"react\"\nimport ReactDOM from \"react-dom\"\nimport misago from \"misago/index\"\nimport Button from \"misago/components/button\"\nimport Form from \"misago/components/form\"\nimport ajax from \"misago/services/ajax\"\nimport snackbar from \"misago/services/snackbar\"\nimport * as validators from \"misago/utils/validators\"\nimport showBannedPage from \"misago/utils/banned-page\"\n\nexport class RequestResetForm extends Form {\n  constructor(props) {\n    super(props)\n\n    this.state = {\n      isLoading: false,\n\n      email: \"\",\n\n      validators: {\n        email: [validators.email()],\n      },\n    }\n  }\n\n  clean() {\n    if (this.isValid()) {\n      return true\n    } else {\n      snackbar.error(\n        pgettext(\"request password reset form\", \"Enter a valid e-mail address.\")\n      )\n      return false\n    }\n  }\n\n  send() {\n    return ajax.post(misago.get(\"SEND_PASSWORD_RESET_API\"), {\n      email: this.state.email,\n    })\n  }\n\n  handleSuccess(apiResponse) {\n    this.props.callback(apiResponse)\n  }\n\n  handleError(rejection) {\n    if ([\"inactive_user\", \"inactive_admin\"].indexOf(rejection.code) > -1) {\n      this.props.showInactivePage(rejection)\n    } else if (rejection.status === 403 && rejection.ban) {\n      showBannedPage(rejection.ban)\n    } else {\n      snackbar.apiError(rejection)\n    }\n  }\n\n  render() {\n    return (\n      <div className=\"well well-form well-form-request-password-reset\">\n        <form onSubmit={this.handleSubmit}>\n          <div className=\"form-group\">\n            <div className=\"control-input\">\n              <input\n                type=\"text\"\n                className=\"form-control\"\n                placeholder={pgettext(\n                  \"request password reset form field\",\n                  \"Your e-mail address\"\n                )}\n                disabled={this.state.isLoading}\n                onChange={this.bindInput(\"email\")}\n                value={this.state.email}\n              />\n            </div>\n          </div>\n\n          <Button\n            className=\"btn-primary btn-block\"\n            loading={this.state.isLoading}\n          >\n            {pgettext(\"request password reset form btn\", \"Send link\")}\n          </Button>\n        </form>\n      </div>\n    )\n  }\n}\n\nexport class LinkSent extends React.Component {\n  getMessage() {\n    return interpolate(\n      pgettext(\n        \"request password reset form\",\n        \"Reset password link was sent to %(email)s\"\n      ),\n      {\n        email: this.props.user.email,\n      },\n      true\n    )\n  }\n\n  render() {\n    return (\n      <div className=\"well well-form well-form-request-password-reset well-done\">\n        <div className=\"done-message\">\n          <div className=\"message-icon\">\n            <span className=\"material-icon\">check</span>\n          </div>\n          <div className=\"message-body\">\n            <p>{this.getMessage()}</p>\n          </div>\n          <button\n            type=\"button\"\n            className=\"btn btn-primary btn-block\"\n            onClick={this.props.callback}\n          >\n            {pgettext(\n              \"request password reset form btn\",\n              \"Request another link\"\n            )}\n          </button>\n        </div>\n      </div>\n    )\n  }\n}\n\nexport class AccountInactivePage extends React.Component {\n  getActivateButton() {\n    if (this.props.activation === \"inactive_user\") {\n      return (\n        <p>\n          <a href={misago.get(\"REQUEST_ACTIVATION_URL\")}>\n            {pgettext(\n              \"request password reset form error\",\n              \"Activate your account.\"\n            )}\n          </a>\n        </p>\n      )\n    } else {\n      return null\n    }\n  }\n\n  render() {\n    return (\n      <div className=\"page page-message page-message-info page-forgotten-password-inactive\">\n        <div className=\"container\">\n          <div className=\"message-panel\">\n            <div className=\"message-icon\">\n              <span className=\"material-icon\">info_outline</span>\n            </div>\n\n            <div className=\"message-body\">\n              <p className=\"lead\">\n                {pgettext(\n                  \"request password reset form error\",\n                  \"Your account is inactive.\"\n                )}\n              </p>\n              <p>{this.props.message}</p>\n              {this.getActivateButton()}\n            </div>\n          </div>\n        </div>\n      </div>\n    )\n  }\n}\n\nexport default class extends React.Component {\n  constructor(props) {\n    super(props)\n\n    this.state = {\n      complete: false,\n    }\n  }\n\n  complete = (apiResponse) => {\n    this.setState({\n      complete: apiResponse,\n    })\n  }\n\n  reset = () => {\n    this.setState({\n      complete: false,\n    })\n  }\n\n  showInactivePage(apiResponse) {\n    ReactDOM.render(\n      <AccountInactivePage\n        activation={apiResponse.code}\n        message={apiResponse.detail}\n      />,\n      document.getElementById(\"page-mount\")\n    )\n  }\n\n  render() {\n    if (this.state.complete) {\n      return <LinkSent callback={this.reset} user={this.state.complete} />\n    }\n\n    return (\n      <RequestResetForm\n        callback={this.complete}\n        showInactivePage={this.showInactivePage}\n      />\n    )\n  }\n}\n","import misago from \"misago/index\"\nimport RequestPasswordReset from \"misago/components/request-password-reset\"\nimport mount from \"misago/utils/mount-component\"\n\nexport default function initializer() {\n  if (document.getElementById(\"request-password-reset-mount\")) {\n    mount(RequestPasswordReset, \"request-password-reset-mount\", false)\n  }\n}\n\nmisago.addInitializer({\n  name: \"component:request-password-reset\",\n  initializer: initializer,\n  after: \"store\",\n})\n","import { UPDATE_AVATAR, UPDATE_USERNAME } from \"misago/reducers/users\"\n\nexport var initialState = {\n  signedIn: false,\n  signedOut: false,\n}\n\nexport const UPDATE_AUTHENTICATED_USER = \"UPDATE_AUTHENTICATED_USER\"\nexport const PATCH_USER = \"PATCH_USER\"\nexport const SIGN_IN = \"SIGN_IN\"\nexport const SIGN_OUT = \"SIGN_OUT\"\n\nexport function updateAuthenticatedUser(data) {\n  return {\n    type: UPDATE_AUTHENTICATED_USER,\n    data,\n  }\n}\n\nexport function patch(patch) {\n  return {\n    type: PATCH_USER,\n    patch,\n  }\n}\n\nexport function signIn(user) {\n  return {\n    type: SIGN_IN,\n    user,\n  }\n}\n\nexport function signOut(soft = false) {\n  return {\n    type: SIGN_OUT,\n    soft,\n  }\n}\n\nexport default function auth(state = initialState, action = null) {\n  switch (action.type) {\n    case PATCH_USER:\n      let newState = Object.assign({}, state)\n      newState.user = Object.assign({}, state.user, action.patch)\n      return newState\n\n    case UPDATE_AUTHENTICATED_USER:\n      let updatedState = Object.assign({}, state)\n      updatedState.user = Object.assign({}, state.user, action.data)\n      return updatedState\n\n    case SIGN_IN:\n      return Object.assign({}, state, {\n        signedIn: action.user,\n      })\n\n    case SIGN_OUT:\n      return Object.assign({}, state, {\n        isAuthenticated: false,\n        isAnonymous: true,\n        signedOut: !action.soft,\n      })\n\n    case UPDATE_AVATAR:\n      if (state.isAuthenticated && state.user.id === action.userId) {\n        let newState = Object.assign({}, state)\n        newState.user = Object.assign({}, state.user, {\n          avatars: action.avatars,\n        })\n        return newState\n      }\n      return state\n\n    case UPDATE_USERNAME:\n      if (state.isAuthenticated && state.user.id === action.userId) {\n        let newState = Object.assign({}, state)\n        newState.user = Object.assign({}, state.user, {\n          username: action.username,\n          slug: action.slug,\n        })\n        return newState\n      }\n      return state\n\n    default:\n      return state\n  }\n}\n","import React from \"react\"\nimport ReactDOM from \"react-dom\"\nimport { Provider } from \"react-redux\"\nimport { UserNavOverlay } from \"../../components/UserNav\"\nimport store from \"../../services/store\"\n\nexport default function initializer(context) {\n  const root = document.getElementById(\"user-nav-mount\")\n  ReactDOM.render(\n    <Provider store={store.getStore()}>\n      <UserNavOverlay />\n    </Provider>,\n    root\n  )\n}\n\nmisago.addInitializer({\n  name: \"component:user-nav-overlay\",\n  initializer: initializer,\n  after: \"store\",\n})\n","import classnames from \"classnames\"\nimport React from \"react\"\nimport { connect } from \"react-redux\"\nimport { close } from \"../../reducers/overlay\"\n\nconst BODY_CLASS = \"has-overlay\"\n\nclass Overlay extends React.Component {\n  constructor(props) {\n    super(props)\n\n    this.scrollOrigin = null\n  }\n\n  componentDidUpdate(prevProps) {\n    if (prevProps.open !== this.props.open) {\n      if (this.props.open) {\n        this.scrollOrigin = window.pageYOffset\n        document.body.classList.add(BODY_CLASS)\n        if (this.props.onOpen) {\n          this.props.onOpen()\n        }\n      } else {\n        document.body.classList.remove(BODY_CLASS)\n        window.scrollTo(0, this.scrollOrigin)\n        this.scrollOrigin = null\n      }\n    }\n  }\n\n  closeOnNavigation = (event) => {\n    if (event.target.closest(\"a\")) {\n      this.props.dispatch(close())\n    }\n  }\n\n  render() {\n    return (\n      <div\n        className={classnames(\"overlay\", this.props.className, {\n          \"overlay-open\": this.props.open,\n        })}\n        onClick={this.closeOnNavigation}\n      >\n        {this.props.children}\n      </div>\n    )\n  }\n}\n\nconst OverlayConnected = connect()(Overlay)\n\nexport default OverlayConnected\n","import React from \"react\"\nimport { connect } from \"react-redux\"\nimport { close } from \"../../reducers/overlay\"\n\nexport function OverlayHeader({ children, dispatch }) {\n  return (\n    <div className=\"overlay-header\">\n      <div className=\"overlay-header-caption\">{children}</div>\n      <button\n        className=\"btn btn-overlay-close\"\n        title={pgettext(\"modal\", \"Close\")}\n        type=\"button\"\n        onClick={() => dispatch(close())}\n      >\n        <span className=\"material-icon\">close</span>\n      </button>\n    </div>\n  )\n}\n\nconst OverlayHeaderConnected = connect()(OverlayHeader)\n\nexport default OverlayHeaderConnected\n","import React from \"react\"\nimport { PageHeaderPlain } from \"../PageHeader\"\n\nexport default function NotificationsHeader() {\n  return (\n    <PageHeaderPlain\n      header={pgettext(\"notifications title\", \"Notifications\")}\n      styleName=\"notifications\"\n    />\n  )\n}\n","import PageTitle from \"./PageTitle\"\n\nexport default PageTitle\n","export default function PageTitle({ title, subtitle }) {\n  const parts = []\n  if (subtitle) {\n    parts.push(subtitle)\n  }\n  if (title) {\n    parts.push(title)\n  }\n  parts.push(misago.get(\"SETTINGS\").forum_name)\n\n  document.title = parts.join(\" | \")\n  return null\n}\n","import React from \"react\"\n\nexport default function PillsNav({ children }) {\n  return <ul className=\"nav nav-pills\">{children}</ul>\n}\n","import classnames from \"classnames\"\nimport React from \"react\"\nimport { Link } from \"react-router\"\n\nexport default function PillsNavLink({ active, link, icon, children }) {\n  return (\n    <li className={classnames({ active })}>\n      <Link to={link} activeClassName=\"\">\n        {!!icon && <span className=\"material-icon\">{icon}</span>}\n        {children}\n      </Link>\n    </li>\n  )\n}\n","import React from \"react\"\nimport { PillsNav, PillsNavLink } from \"../PillsNav\"\nimport { Toolbar, ToolbarSection, ToolbarItem } from \"../Toolbar\"\n\nexport default function NotificationsPills({ filter }) {\n  const basename = misago.get(\"NOTIFICATIONS_URL\")\n\n  return (\n    <Toolbar>\n      <ToolbarSection auto>\n        <ToolbarItem>\n          <PillsNav>\n            <PillsNavLink active={filter === \"all\"} link={basename}>\n              {pgettext(\"notifications nav\", \"All\")}\n            </PillsNavLink>\n            <PillsNavLink\n              active={filter === \"unread\"}\n              link={basename + \"unread/\"}\n            >\n              {pgettext(\"notifications nav\", \"Unread\")}\n            </PillsNavLink>\n            <PillsNavLink active={filter === \"read\"} link={basename + \"read/\"}>\n              {pgettext(\"notifications nav\", \"Read\")}\n            </PillsNavLink>\n          </PillsNav>\n        </ToolbarItem>\n      </ToolbarSection>\n    </Toolbar>\n  )\n}\n","import React from \"react\"\nimport { Link } from \"react-router\"\n\nexport default function NotificationsPagination({ baseUrl, data, disabled }) {\n  return (\n    <div className=\"misago-pagination\">\n      <NotificationsPaginationLink\n        url={baseUrl}\n        disabled={disabled || !data || !data.hasPrevious}\n      >\n        {pgettext(\"notifications pagination\", \"Latest\")}\n      </NotificationsPaginationLink>\n      <NotificationsPaginationLink\n        url={baseUrl + \"?before=\" + (data ? data.firstCursor : \"\")}\n        disabled={disabled || !data || !data.hasPrevious}\n      >\n        {pgettext(\"notifications pagination\", \"Newer\")}\n      </NotificationsPaginationLink>\n      <NotificationsPaginationLink\n        url={baseUrl + \"?after=\" + (data ? data.lastCursor : \"\")}\n        disabled={disabled || !data || !data.hasNext}\n      >\n        {pgettext(\"notifications pagination\", \"Older\")}\n      </NotificationsPaginationLink>\n    </div>\n  )\n}\n\nfunction NotificationsPaginationLink({ disabled, children, url }) {\n  if (disabled) {\n    return (\n      <button className=\"btn btn-default\" type=\"disabled\" disabled>\n        {children}\n      </button>\n    )\n  }\n\n  return (\n    <Link to={url} className=\"btn btn-default\" activeClassName=\"\">\n      {children}\n    </Link>\n  )\n}\n","import classnames from \"classnames\"\nimport React from \"react\"\nimport Button from \"../button\"\nimport { Toolbar, ToolbarSection, ToolbarItem, ToolbarSpacer } from \"../Toolbar\"\nimport NotificationsPagination from \"./NotificationsPagination\"\n\nexport default function NotificationsToolbar({\n  baseUrl,\n  data,\n  disabled,\n  bottom,\n  markAllAsRead,\n}) {\n  return (\n    <Toolbar>\n      <ToolbarSection>\n        <ToolbarItem>\n          <NotificationsPagination\n            baseUrl={baseUrl}\n            data={data}\n            disabled={disabled}\n          />\n        </ToolbarItem>\n      </ToolbarSection>\n      <ToolbarSpacer />\n      <ToolbarSection className={classnames({ \"hidden-xs\": !bottom })}>\n        <ToolbarItem>\n          <Button\n            className=\"btn-default btn-block\"\n            type=\"button\"\n            disabled={disabled || !data || !data.unreadNotifications}\n            onClick={markAllAsRead}\n          >\n            <span className=\"material-icon\">done_all</span>\n            {pgettext(\"notifications\", \"Mark all as read\")}\n          </Button>\n        </ToolbarItem>\n      </ToolbarSection>\n    </Toolbar>\n  )\n}\n","import React from \"react\"\nimport { connect } from \"react-redux\"\nimport { updateAuthenticatedUser } from \"../../reducers/auth\"\nimport snackbar from \"../../services/snackbar\"\nimport { ApiMutation } from \"../Api\"\nimport NotificationsFetch from \"../NotificationsFetch\"\nimport PageTitle from \"../PageTitle\"\nimport PageContainer from \"../PageContainer\"\nimport {\n  NotificationsList,\n  NotificationsListError,\n  NotificationsListLoading,\n} from \"../NotificationsList\"\nimport NotificationsPills from \"./NotificationsPills\"\nimport NotificationsToolbar from \"./NotificationsToolbar\"\n\nfunction NotificationsRoute({ dispatch, location, route }) {\n  const { query } = location\n  const { filter } = route.props\n\n  const baseUrl = getBaseUrl(filter)\n\n  return (\n    <PageContainer>\n      <PageTitle\n        title={pgettext(\"notifications title\", \"Notifications\")}\n        subtitle={getSubtitle(filter)}\n      />\n\n      <NotificationsPills filter={filter} />\n\n      <NotificationsFetch filter={filter} query={query}>\n        {({ data, loading, error, refetch }) => (\n          <ApiMutation url={misago.get(\"NOTIFICATIONS_API\") + \"read-all/\"}>\n            {(readAll, { loading: mutating }) => {\n              const toolbarProps = {\n                baseUrl,\n                data,\n                disabled:\n                  loading || mutating || !data || data.results.length === 0,\n                markAllAsRead: async () => {\n                  const confirmed = window.confirm(\n                    pgettext(\"notifications\", \"Mark all notifications as read?\")\n                  )\n\n                  if (confirmed) {\n                    readAll({\n                      onSuccess: async () => {\n                        refetch()\n                        dispatch(\n                          updateAuthenticatedUser({ unreadNotifications: null })\n                        )\n                        snackbar.success(\n                          pgettext(\n                            \"notifications\",\n                            \"All notifications have been marked as read.\"\n                          )\n                        )\n                      },\n                      onError: snackbar.apiError,\n                    })\n                  }\n                },\n              }\n\n              if (loading || mutating) {\n                return (\n                  <div>\n                    <NotificationsToolbar {...toolbarProps} />\n                    <NotificationsListLoading />\n                    <NotificationsToolbar {...toolbarProps} bottom />\n                  </div>\n                )\n              }\n\n              if (error) {\n                return (\n                  <div>\n                    <NotificationsToolbar {...toolbarProps} />\n                    <NotificationsListError error={error} />\n                    <NotificationsToolbar {...toolbarProps} bottom />\n                  </div>\n                )\n              }\n\n              if (data) {\n                if (!data.hasPrevious && query) {\n                  window.history.replaceState({}, \"\", baseUrl)\n                }\n\n                return (\n                  <div>\n                    <NotificationsToolbar {...toolbarProps} />\n                    <NotificationsList\n                      filter={filter}\n                      items={data.results}\n                      hasNext={data.hasNext}\n                      hasPrevious={data.hasPrevious}\n                    />\n                    <NotificationsToolbar {...toolbarProps} bottom />\n                  </div>\n                )\n              }\n\n              return null\n            }}\n          </ApiMutation>\n        )}\n      </NotificationsFetch>\n    </PageContainer>\n  )\n}\n\nfunction getSubtitle(filter) {\n  if (filter === \"unread\") {\n    return pgettext(\"notifications title\", \"Unread notifications\")\n  } else if (filter === \"read\") {\n    return pgettext(\"notifications title\", \"Read notifications\")\n  } else {\n    return null\n  }\n}\n\nfunction getBaseUrl(filter) {\n  let url = misago.get(\"NOTIFICATIONS_URL\")\n  if (filter !== \"all\") {\n    url += filter + \"/\"\n  }\n  return url\n}\n\nconst NotificationsRouteConnected = connect()(NotificationsRoute)\n\nexport default NotificationsRouteConnected\n","import Notifications from \"./Notifications\"\nimport NotificationsFetch from \"../NotificationsFetch/NotificationsFetch\"\n\nexport default Notifications\n\nexport { NotificationsFetch }\n","import React from \"react\"\nimport { Router, browserHistory } from \"react-router\"\nimport NotificationsHeader from \"./NotificationsHeader\"\nimport NotificationsRoute from \"./NotificationsRoute\"\n\nexport default function Notifications() {\n  const basename = misago.get(\"NOTIFICATIONS_URL\")\n\n  return (\n    <div className=\"page page-notifications\">\n      <NotificationsHeader />\n      <Router\n        history={browserHistory}\n        routes={[\n          {\n            path: basename,\n            component: NotificationsRoute,\n            props: {\n              filter: \"all\",\n            },\n          },\n          {\n            path: basename + \"unread/\",\n            component: NotificationsRoute,\n            props: {\n              filter: \"unread\",\n            },\n          },\n          {\n            path: basename + \"read/\",\n            component: NotificationsRoute,\n            props: {\n              filter: \"read\",\n            },\n          },\n        ]}\n      />\n    </div>\n  )\n}\n","import React from \"react\"\nimport ReactDOM from \"react-dom\"\nimport { Provider } from \"react-redux\"\nimport Notifications from \"../../components/Notifications\"\nimport store from \"../../services/store\"\n\nexport default function initializer(context) {\n  const basename = misago.get(\"NOTIFICATIONS_URL\")\n  if (\n    document.location.pathname.startsWith(basename) &&\n    !document.location.pathname.startsWith(basename + \"disable-email/\") &&\n    context.get(\"isAuthenticated\")\n  ) {\n    const root = document.getElementById(\"page-mount\")\n    ReactDOM.render(\n      <Provider store={store.getStore()}>\n        <Notifications />\n      </Provider>,\n      root\n    )\n  }\n}\n\nmisago.addInitializer({\n  name: \"component:notifications\",\n  initializer: initializer,\n  after: \"store\",\n})\n","import misago from \"misago/index\"\nimport include from \"misago/services/include\"\n\nexport default function initializer(context) {\n  include.init(context.get(\"STATIC_URL\"))\n}\n\nmisago.addInitializer({\n  name: \"include\",\n  initializer: initializer,\n})\n","import React from \"react\"\n\nexport default class ApiFetch extends React.Component {\n  constructor(props) {\n    super(props)\n\n    this.state = {\n      data: null,\n      loading: false,\n      error: null,\n    }\n\n    this.controller = new AbortController()\n    this.signal = this.controller.signal\n  }\n\n  componentDidMount() {\n    if (this.props.url && !this.props.disabled) {\n      this.request(this.props.url)\n    }\n  }\n\n  componentDidUpdate(prevProps) {\n    const url = this.props.url\n    const urlChanged = url && url !== prevProps.url\n    const disabledChanged = this.props.disabled != prevProps.disabled\n\n    if (urlChanged || disabledChanged) {\n      if (!this.props.disabled) {\n        if (this.hasCache(url)) {\n          this.getCache(url)\n        } else {\n          this.controller.abort()\n\n          this.controller = new AbortController()\n          this.signal = this.controller.signal\n          this.request(url)\n        }\n      } else {\n        this.controller.abort()\n      }\n    }\n  }\n\n  componentWillUnmount() {\n    this.controller.abort()\n  }\n\n  hasCache = (url) => {\n    return this.props.cache && this.props.cache[url]\n  }\n\n  getCache = async (url) => {\n    const data = this.props.cache[url]\n    this.setState({ loading: false, error: null, data })\n    if (this.props.onData) {\n      await this.props.onData(data)\n    }\n  }\n\n  setCache = (url, data) => {\n    if (this.props.cache) {\n      this.props.cache[url] = data\n    }\n  }\n\n  request = (url) => {\n    this.setState({ loading: true })\n\n    fetch(url, {\n      method: \"GET\",\n      credentials: \"include\",\n      signal: this.signal,\n    }).then(\n      async (response) => {\n        if (url === this.props.url) {\n          if (response.status == 200) {\n            const data = await response.json()\n            this.setState({ loading: false, error: null, data })\n            this.setCache(url, data)\n            if (this.props.onData) {\n              await this.props.onData(data)\n            }\n          } else {\n            const error = { status: response.status }\n            if (response.headers.get(\"Content-Type\") === \"application/json\") {\n              error.data = await response.json()\n            }\n            this.setState({ loading: false, error })\n          }\n        }\n      },\n      (rejection) => {\n        if (url === this.props.url) {\n          this.setState({ loading: false, error: { status: 0, rejection } })\n        }\n      }\n    )\n  }\n\n  refetch = () => {\n    this.request(this.props.url)\n  }\n\n  update = (mutation) => {\n    this.setState((state) => {\n      return { data: mutation(state.data) }\n    })\n  }\n\n  render() {\n    return this.props.children(\n      Object.assign({ refetch: this.refetch, update: this.update }, this.state)\n    )\n  }\n}\n","import React from \"react\"\n\nexport default class ApiMutation extends React.Component {\n  constructor(props) {\n    super(props)\n\n    this.state = {\n      data: null,\n      loading: false,\n      error: null,\n    }\n  }\n\n  mutate = (options) => {\n    this.setState({ loading: true })\n\n    fetch(this.props.url, {\n      method: this.props.method || \"POST\",\n      credentials: \"include\",\n      headers: headers(options),\n      body: body(options),\n    }).then(\n      async (response) => {\n        if (response.status == 200) {\n          const data = await response.json()\n          this.setState({ loading: false, data })\n          if (options.onSuccess) {\n            await options.onSuccess(data)\n          }\n        } else if (response.status == 204) {\n          this.setState({ loading: false })\n          if (options.onSuccess) {\n            await options.onSuccess()\n          }\n        } else {\n          const error = { status: response.status }\n          if (response.headers.get(\"Content-Type\") === \"application/json\") {\n            error.data = await response.json()\n          }\n          this.setState({ loading: false, error })\n          if (options.onError) {\n            await options.onError(error)\n          }\n        }\n      },\n      async (rejection) => {\n        const error = { status: 0, rejection }\n        this.setState({ loading: false, error })\n        if (options.onError) {\n          await options.onError(error)\n        }\n      }\n    )\n  }\n\n  render() {\n    return this.props.children(this.mutate, this.state)\n  }\n}\n\nfunction headers(options) {\n  if (!!options.json) {\n    return {\n      \"Content-Type\": \"application/json; charset=utf-8\",\n      \"X-CSRFToken\": csrfToken(),\n    }\n  }\n\n  return {\n    \"X-CSRFToken\": csrfToken(),\n  }\n}\n\nfunction body(options) {\n  if (!!options.json) {\n    return JSON.stringify(options.json)\n  }\n\n  return undefined\n}\n\nfunction csrfToken() {\n  const cookieName = window.misago_csrf\n\n  if (document.cookie.indexOf(cookieName) !== -1) {\n    const cookieRegex = new RegExp(cookieName + \"=([^;]*)\")\n    const cookie = document.cookie.match(cookieRegex)[0]\n    return cookie ? cookie.split(\"=\")[1] : null\n  } else {\n    return null\n  }\n}\n","import classnames from \"classnames\"\nimport React from \"react\"\n\nexport default function ListGroup({ className, children }) {\n  return <ul className={classnames(\"list-group\", className)}>{children}</ul>\n}\n","import classnames from \"classnames\"\nimport React from \"react\"\n\nexport default function ListGroupItem({ className, children }) {\n  return (\n    <li className={classnames(\"list-group-item\", className)}>{children}</li>\n  )\n}\n","import classnames from \"classnames\"\nimport React from \"react\"\nimport ListGroupItem from \"./ListGroupItem\"\n\nexport default function ListGroupEmpty({ className, icon, message }) {\n  return (\n    <ListGroupItem className={classnames(\"list-group-empty\", className)}>\n      {!!icon && (\n        <div className=\"list-group-empty-icon\">\n          <span className=\"material-icon\">{icon}</span>\n        </div>\n      )}\n      <p className=\"list-group-empty-message\">{message}</p>\n    </ListGroupItem>\n  )\n}\n","import classnames from \"classnames\"\nimport React from \"react\"\nimport ListGroupItem from \"./ListGroupItem\"\n\nexport default function ListGroupError({ className, icon, message, detail }) {\n  return (\n    <ListGroupItem className={classnames(\"list-group-error\", className)}>\n      {!!icon && (\n        <div className=\"list-group-error-icon\">\n          <span className=\"material-icon\">{icon}</span>\n        </div>\n      )}\n      <p className=\"list-group-error-message\">{message}</p>\n      {!!detail && <p className=\"list-group-error-detail\">{detail}</p>}\n    </ListGroupItem>\n  )\n}\n","import classnames from \"classnames\"\nimport React from \"react\"\nimport ListGroupItem from \"./ListGroupItem\"\n\nexport default function ListGroupLoading({ className, message }) {\n  return (\n    <ListGroupItem className={classnames(\"list-group-loading\", className)}>\n      <p className=\"list-group-loading-message\">{message}</p>\n      <div className=\"list-group-loading-progress\">\n        <div className=\"list-group-loading-progress-bar\"></div>\n      </div>\n    </ListGroupItem>\n  )\n}\n","import classnames from \"classnames\"\nimport React from \"react\"\nimport ListGroupItem from \"./ListGroupItem\"\n\nexport default function ListGroupMessage({ className, icon, message, detail }) {\n  return (\n    <ListGroupItem className={classnames(\"list-group-message\", className)}>\n      {!!icon && (\n        <div className=\"list-group-message-icon\">\n          <span className=\"material-icon\">{icon}</span>\n        </div>\n      )}\n      <p className=\"list-group-message-message\">{message}</p>\n      {!!detail && <p className=\"list-group-message-detail\">{detail}</p>}\n    </ListGroupItem>\n  )\n}\n","import misago from \"misago/index\"\nimport reducer from \"misago/reducers/users\"\nimport store from \"misago/services/store\"\n\nexport default function initializer() {\n  store.addReducer(\"users\", reducer, [])\n}\n\nmisago.addInitializer({\n  name: \"reducer:users\",\n  initializer: initializer,\n  before: \"store\",\n})\n","import SignInButton from \"./SignInButton\"\n\nexport default SignInButton\n","import classnames from \"classnames\"\nimport React from \"react\"\nimport modal from \"../../services/modal\"\nimport SignInModal from \"../sign-in\"\n\nexport default function SignInButton({ block, className, onClick }) {\n  const settings = misago.get(\"SETTINGS\")\n\n  if (settings.DELEGATE_AUTH) {\n    return (\n      <a\n        className={classnames(\"btn btn-sign-in\", className, {\n          \"btn-block\": block,\n        })}\n        href={settings.LOGIN_URL}\n        onClick={() => {\n          if (onClick) {\n            onClick()\n          }\n        }}\n      >\n        {pgettext(\"cta\", \"Sign in\")}\n      </a>\n    )\n  }\n\n  return (\n    <a\n      className={classnames(\"btn btn-sign-in\", className, {\n        \"btn-block\": block,\n      })}\n      href={settings.LOGIN_URL}\n      onClick={(event) => {\n        event.preventDefault()\n\n        if (onClick) {\n          onClick()\n        }\n\n        modal.show(<SignInModal />)\n      }}\n    >\n      {pgettext(\"cta\", \"Sign in\")}\n    </a>\n  )\n}\n","import misago from \"misago/index\"\nimport reducer from \"misago/reducers/profile\"\nimport store from \"misago/services/store\"\n\nexport default function initializer() {\n  store.addReducer(\"profile\", reducer, {})\n}\n\nmisago.addInitializer({\n  name: \"reducer:profile\",\n  initializer: initializer,\n  before: \"store\",\n})\n","import React from \"react\"\nimport Form from \"./form\"\nimport FormGroup from \"misago/components/form-group\"\nimport * as participants from \"misago/reducers/participants\"\nimport { updateAcl } from \"misago/reducers/thread\"\nimport ajax from \"misago/services/ajax\"\nimport modal from \"misago/services/modal\"\nimport snackbar from \"misago/services/snackbar\"\nimport store from \"misago/services/store\"\n\nexport default class extends Form {\n  constructor(props) {\n    super(props)\n\n    this.state = {\n      isLoading: false,\n\n      username: \"\",\n    }\n  }\n\n  onUsernameChange = (event) => {\n    this.changeValue(\"username\", event.target.value)\n  }\n\n  clean() {\n    if (!this.state.username.trim().length) {\n      snackbar.error(\n        pgettext(\n          \"add private thread participant\",\n          \"You have to enter user name.\"\n        )\n      )\n      return false\n    }\n\n    return true\n  }\n\n  send() {\n    return ajax.patch(this.props.thread.api.index, [\n      { op: \"add\", path: \"participants\", value: this.state.username },\n      { op: \"add\", path: \"acl\", value: 1 },\n    ])\n  }\n\n  handleSuccess(data) {\n    store.dispatch(updateAcl(data))\n    store.dispatch(participants.replace(data.participants))\n\n    snackbar.success(\n      pgettext(\n        \"add private thread participant\",\n        \"New participant has been added to thread.\"\n      )\n    )\n\n    modal.hide()\n  }\n\n  render() {\n    return (\n      <div className=\"modal-dialog modal-sm\" role=\"document\">\n        <form onSubmit={this.handleSubmit}>\n          <div className=\"modal-content\">\n            <ModalHeader />\n            <div className=\"modal-body\">\n              <FormGroup\n                for=\"id_username\"\n                label={pgettext(\n                  \"add private thread participant field\",\n                  \"User to add\"\n                )}\n              >\n                <input\n                  id=\"id_username\"\n                  className=\"form-control\"\n                  disabled={this.state.isLoading}\n                  onChange={this.onUsernameChange}\n                  type=\"text\"\n                  value={this.state.username}\n                />\n              </FormGroup>\n            </div>\n            <div className=\"modal-footer\">\n              <button\n                className=\"btn btn-block btn-primary\"\n                disabled={this.state.isLoading}\n              >\n                {pgettext(\n                  \"add private thread participant btn\",\n                  \"Add participant\"\n                )}\n              </button>\n              <button\n                className=\"btn btn-block btn-default\"\n                data-dismiss=\"modal\"\n                disabled={this.state.isLoading}\n                type=\"button\"\n              >\n                {pgettext(\"add private thread participant btn\", \"Cancel\")}\n              </button>\n            </div>\n          </div>\n        </form>\n      </div>\n    )\n  }\n}\n\nexport function ModalHeader(props) {\n  return (\n    <div className=\"modal-header\">\n      <button\n        aria-label={pgettext(\"modal\", \"Close\")}\n        className=\"close\"\n        data-dismiss=\"modal\"\n        type=\"button\"\n      >\n        <span aria-hidden=\"true\">&times;</span>\n      </button>\n      <h4 className=\"modal-title\">\n        {pgettext(\n          \"add private thread participant modal title\",\n          \"Add participant\"\n        )}\n      </h4>\n    </div>\n  )\n}\n","import React from \"react\"\nimport AddParticipantModal from \"misago/components/add-participant\"\nimport modal from \"misago/services/modal\"\n\nexport default class extends React.Component {\n  onClick = () => {\n    modal.show(<AddParticipantModal thread={this.props.thread} />)\n  }\n\n  render() {\n    if (!this.props.thread.acl.can_add_participants) return null\n\n    return (\n      <div className=\"col-xs-12 col-sm-3\">\n        <button\n          className=\"btn btn-default btn-block\"\n          onClick={this.onClick}\n          type=\"button\"\n        >\n          <span className=\"material-icon\">person_add</span>\n          {pgettext(\"add participant btn\", \"Add participant\")}\n        </button>\n      </div>\n    )\n  }\n}\n","import React from \"react\"\nimport { changeOwner } from \"./actions\"\n\nexport default class extends React.Component {\n  constructor(props) {\n    super(props)\n\n    this.isUser = props.participant.id === props.user.id\n  }\n\n  onClick = () => {\n    let confirmed = false\n    if (this.isUser) {\n      confirmed = window.confirm(\n        pgettext(\n          \"private thread owner change\",\n          \"Are you sure you want to take over this thread?\"\n        )\n      )\n    } else {\n      const message = pgettext(\n        \"private thread owner change\",\n        \"Are you sure you want to change thread owner to %(user)s?\"\n      )\n      confirmed = window.confirm(\n        interpolate(\n          message,\n          {\n            user: this.props.participant.username,\n          },\n          true\n        )\n      )\n    }\n\n    if (!confirmed) return\n\n    changeOwner(this.props.thread, this.props.participant)\n  }\n\n  render() {\n    if (this.props.participant.is_owner) return null\n    if (!this.props.thread.acl.can_change_owner) return null\n\n    return (\n      <li>\n        <button className=\"btn btn-link\" onClick={this.onClick} type=\"button\">\n          {pgettext(\"private thread owner change btn\", \"Make owner\")}\n        </button>\n      </li>\n    )\n  }\n}\n","import * as participants from \"misago/reducers/participants\"\nimport { updateAcl } from \"misago/reducers/thread\"\nimport misago from \"misago\"\nimport ajax from \"misago/services/ajax\"\nimport snackbar from \"misago/services/snackbar\"\nimport store from \"misago/services/store\"\n\nexport function leave(thread, participant) {\n  ajax\n    .patch(thread.api.index, [\n      { op: \"remove\", path: \"participants\", value: participant.id },\n    ])\n    .then(\n      () => {\n        snackbar.success(\n          pgettext(\"thread participants actions\", \"You have left this thread.\")\n        )\n        window.setTimeout(() => {\n          window.location = misago.get(\"PRIVATE_THREADS_URL\")\n        }, 3 * 1000)\n      },\n      (rejection) => {\n        snackbar.apiError(rejection)\n      }\n    )\n}\n\nexport function remove(thread, participant) {\n  ajax\n    .patch(thread.api.index, [\n      { op: \"remove\", path: \"participants\", value: participant.id },\n      { op: \"add\", path: \"acl\", value: 1 },\n    ])\n    .then(\n      (data) => {\n        store.dispatch(updateAcl(data))\n        store.dispatch(participants.replace(data.participants))\n\n        const message = pgettext(\n          \"thread participants actions\",\n          \"%(user)s has been removed from this thread.\"\n        )\n        snackbar.success(\n          interpolate(\n            message,\n            {\n              user: participant.username,\n            },\n            true\n          )\n        )\n      },\n      (rejection) => {\n        snackbar.apiError(rejection)\n      }\n    )\n}\n\nexport function changeOwner(thread, participant) {\n  ajax\n    .patch(thread.api.index, [\n      { op: \"replace\", path: \"owner\", value: participant.id },\n      { op: \"add\", path: \"acl\", value: 1 },\n    ])\n    .then(\n      (data) => {\n        store.dispatch(updateAcl(data))\n        store.dispatch(participants.replace(data.participants))\n\n        const message = pgettext(\n          \"thread participants actions\",\n          \"%(user)s has been made new thread owner.\"\n        )\n        snackbar.success(\n          interpolate(\n            message,\n            {\n              user: participant.username,\n            },\n            true\n          )\n        )\n      },\n      (rejection) => {\n        snackbar.apiError(rejection)\n      }\n    )\n}\n","import React from \"react\"\nimport { remove, leave } from \"./actions\"\n\nexport default class extends React.Component {\n  constructor(props) {\n    super(props)\n\n    this.isUser = props.participant.id === props.user.id\n  }\n\n  onClick = () => {\n    let confirmed = false\n    if (this.isUser) {\n      confirmed = window.confirm(\n        pgettext(\n          \"private thread leave\",\n          \"Are you sure you want to leave this thread?\"\n        )\n      )\n    } else {\n      const message = pgettext(\n        \"private thread leave\",\n        \"Are you sure you want to remove %(user)s from this thread?\"\n      )\n      confirmed = window.confirm(\n        interpolate(\n          message,\n          {\n            user: this.props.participant.username,\n          },\n          true\n        )\n      )\n    }\n\n    if (!confirmed) return\n\n    if (this.isUser) {\n      leave(this.props.thread, this.props.participant)\n    } else {\n      remove(this.props.thread, this.props.participant)\n    }\n  }\n\n  render() {\n    const isModerator = this.props.user.acl.can_moderate_private_threads\n\n    if (!(this.props.userIsOwner || this.isUser || isModerator)) return null\n\n    return (\n      <li>\n        <button className=\"btn btn-link\" onClick={this.onClick} type=\"button\">\n          {this.isUser\n            ? pgettext(\"private thread leave btn\", \"Leave thread\")\n            : pgettext(\"private thread leave btn\", \"Remove\")}\n        </button>\n      </li>\n    )\n  }\n}\n","import React from \"react\"\nimport MakeOwner from \"./make-owner\"\nimport Remove from \"./remove\"\nimport Avatar from \"misago/components/avatar\"\n\nexport default function (props) {\n  const participant = props.participant\n\n  let className = \"btn btn-default\"\n  if (participant.is_owner) {\n    className = \"btn btn-primary\"\n  }\n  className += \" btn-user btn-block\"\n\n  return (\n    <div className=\"col-xs-12 col-sm-3 col-md-2 participant-card\">\n      <div className=\"dropdown\">\n        <button\n          aria-haspopup=\"true\"\n          aria-expanded=\"false\"\n          className={className}\n          data-toggle=\"dropdown\"\n          type=\"button\"\n        >\n          <Avatar size=\"34\" user={participant} />\n          <span className=\"btn-text\">{participant.username}</span>\n        </button>\n        <ul className=\"dropdown-menu stick-to-bottom\">\n          <UserStatus isOwner={participant.is_owner} />\n          <li className=\"dropdown-header\" />\n          <li>\n            <a href={participant.url}>\n              {pgettext(\"thread participants profile link\", \"See profile\")}\n            </a>\n          </li>\n          <li role=\"separator\" className=\"divider\" />\n          <MakeOwner {...props} />\n          <Remove {...props} />\n        </ul>\n      </div>\n    </div>\n  )\n}\n\nexport function UserStatus({ isOwner }) {\n  if (!isOwner) return null\n\n  return (\n    <li className=\"dropdown-header dropdown-header-owner\">\n      <span className=\"material-icon\">start</span>\n      <span className=\"icon-text\">\n        {pgettext(\"thread participants owner status\", \"Thread owner\")}\n      </span>\n    </li>\n  )\n}\n","import React from \"react\"\nimport Card from \"./card\"\n\nexport default function ({ participants, thread, user, userIsOwner }) {\n  return (\n    <div className=\"participants-cards\">\n      <div className=\"row\">\n        {participants.map((participant) => {\n          return (\n            <Card\n              key={participant.id}\n              participant={participant}\n              thread={thread}\n              user={user}\n              userIsOwner={userIsOwner}\n            />\n          )\n        })}\n      </div>\n    </div>\n  )\n}\n","import React from \"react\"\nimport AddParticipant from \"./add-participant\"\nimport CardsList from \"./cards-list\"\nimport * as utils from \"./utils\"\n\nexport default function (props) {\n  if (!props.participants.length) return null\n\n  return (\n    <div className=\"panel panel-default panel-participants\">\n      <div className=\"panel-body\">\n        <CardsList\n          userIsOwner={getUserIsOwner(props.user, props.participants)}\n          {...props}\n        />\n        <div className=\"row\">\n          <AddParticipant thread={props.thread} />\n          <div className=\"col-xs-12 col-sm-9\">\n            <p>{utils.getParticipantsCopy(props.participants)}</p>\n          </div>\n        </div>\n      </div>\n    </div>\n  )\n}\n\nexport function getUserIsOwner(user, participants) {\n  return participants[0].id === user.id\n}\n","export function getParticipantsCopy(participants) {\n  const count = participants.length\n  const message = npgettext(\n    \"thread participants stat\",\n    \"This thread has %(users)s participant.\",\n    \"This thread has %(users)s participants.\",\n    count\n  )\n\n  return interpolate(\n    message,\n    {\n      users: count,\n    },\n    true\n  )\n}\n","import React from \"react\"\n\nexport default function (props) {\n  return (\n    <div className=\"poll-choices-bars\">\n      {props.poll.choices.map((choice) => {\n        return (\n          <PollChoice choice={choice} key={choice.hash} poll={props.poll} />\n        )\n      })}\n    </div>\n  )\n}\n\nexport function PollChoice(props) {\n  let proc = 0\n  if (props.choice.votes && props.poll.votes) {\n    proc = Math.ceil((props.choice.votes * 100) / props.poll.votes)\n  }\n\n  return (\n    <dl className=\"dl-horizontal\">\n      <dt>{props.choice.label}</dt>\n      <dd>\n        <div className=\"progress\">\n          <div\n            className=\"progress-bar\"\n            role=\"progressbar\"\n            aria-valuenow={proc}\n            aria-valuemin=\"0\"\n            aria-valuemax=\"100\"\n            style={{ width: proc + \"%\" }}\n          >\n            <span className=\"sr-only\">\n              {getVotesLabel(props.votes, props.proc)}\n            </span>\n          </div>\n        </div>\n        <ul className=\"list-unstyled list-inline poll-chart\">\n          <ChoiceVotes proc={proc} votes={props.choice.votes} />\n          <UserChoice selected={props.choice.selected} />\n        </ul>\n      </dd>\n    </dl>\n  )\n}\n\nexport function ChoiceVotes(props) {\n  return (\n    <li className=\"poll-chart-votes\">\n      {getVotesLabel(props.votes, props.proc)}\n    </li>\n  )\n}\n\nexport function getVotesLabel(votes, proc) {\n  const message = npgettext(\n    \"thread poll\",\n    \"%(votes)s vote, %(proc)s% of total.\",\n    \"%(votes)s votes, %(proc)s% of total.\",\n    votes\n  )\n\n  return interpolate(\n    message,\n    {\n      votes: votes,\n      proc: proc,\n    },\n    true\n  )\n}\n\nexport function UserChoice(props) {\n  if (!props.selected) return null\n\n  return (\n    <li className=\"poll-chart-selected\">\n      <span className=\"material-icon\">check_box</span>\n      {pgettext(\"thread poll\", \"You've voted on this choice.\")}\n    </li>\n  )\n}\n","import React from \"react\"\nimport moment from \"moment\"\nimport Message from \"misago/components/modal-message\"\nimport Loader from \"misago/components/modal-loader\"\nimport ajax from \"misago/services/ajax\"\n\nexport default class extends React.Component {\n  constructor(props) {\n    super(props)\n\n    this.state = {\n      isLoading: true,\n      error: null,\n      data: [],\n    }\n  }\n\n  componentDidMount() {\n    ajax.get(this.props.poll.api.votes).then(\n      (data) => {\n        const hydratedData = data.map((choice) => {\n          return Object.assign({}, choice, {\n            voters: choice.voters.map((voter) => {\n              return Object.assign({}, voter, {\n                voted_on: moment(voter.voted_on),\n              })\n            }),\n          })\n        })\n\n        this.setState({\n          isLoading: false,\n          data: hydratedData,\n        })\n      },\n      (rejection) => {\n        this.setState({\n          isLoading: false,\n          error: rejection.detail,\n        })\n      }\n    )\n  }\n\n  render() {\n    return (\n      <div\n        className={\n          \"modal-dialog\" + (this.state.error ? \" modal-message\" : \" modal-sm\")\n        }\n        role=\"document\"\n      >\n        <div className=\"modal-content\">\n          <div className=\"modal-header\">\n            <button\n              type=\"button\"\n              className=\"close\"\n              data-dismiss=\"modal\"\n              aria-label={pgettext(\"modal\", \"Close\")}\n            >\n              <span aria-hidden=\"true\">&times;</span>\n            </button>\n            <h4 className=\"modal-title\">\n              {pgettext(\"thread poll\", \"Poll votes\")}\n            </h4>\n          </div>\n\n          <ModalBody\n            data={this.state.data}\n            error={this.state.error}\n            isLoading={this.state.isLoading}\n          />\n        </div>\n      </div>\n    )\n  }\n}\n\nexport function ModalBody(props) {\n  if (props.isLoading) {\n    return <Loader />\n  } else if (props.error) {\n    return <Message icon=\"error_outline\" message={props.error} />\n  }\n\n  return <ChoicesList data={props.data} />\n}\n\nexport function ChoicesList(props) {\n  return (\n    <div className=\"modal-body modal-poll-votes\">\n      <ul className=\"list-unstyled votes-details\">\n        {props.data.map((choice) => {\n          return <ChoiceDetails key={choice.hash} {...choice} />\n        })}\n      </ul>\n    </div>\n  )\n}\n\nexport function ChoiceDetails(props) {\n  return (\n    <li>\n      <h4>{props.label}</h4>\n      <VotesCount votes={props.votes} />\n      <VotesList voters={props.voters} />\n      <hr />\n    </li>\n  )\n}\n\nexport function VotesCount(props) {\n  const message = npgettext(\n    \"thread poll\",\n    \"%(votes)s user has voted for this choice.\",\n    \"%(votes)s users have voted for this choice.\",\n    props.votes\n  )\n\n  const label = interpolate(\n    message,\n    {\n      votes: props.votes,\n    },\n    true\n  )\n\n  return <p>{label}</p>\n}\n\nexport function VotesList(props) {\n  if (!props.voters.length) return null\n\n  return (\n    <ul className=\"list-unstyled\">\n      {props.voters.map((user) => {\n        return <Voter key={user.username} {...user} />\n      })}\n    </ul>\n  )\n}\n\nexport function Voter(props) {\n  if (props.url) {\n    return (\n      <li>\n        <a className=\"item-title\" href={props.url}>\n          {props.username}\n        </a>{\" \"}\n        <VoteDate voted_on={props.voted_on} />\n      </li>\n    )\n  }\n\n  return (\n    <li>\n      <strong>{props.username}</strong> <VoteDate voted_on={props.voted_on} />\n    </li>\n  )\n}\n\nexport function VoteDate(props) {\n  return (\n    <abbr className=\"text-muted\" title={props.voted_on.format(\"LLL\")}>\n      {props.voted_on.fromNow()}\n    </abbr>\n  )\n}\n","import React from \"react\"\nimport Modal from \"./modal\"\nimport * as poll from \"misago/reducers/poll\"\nimport * as thread from \"misago/reducers/thread\"\nimport ajax from \"misago/services/ajax\"\nimport modal from \"misago/services/modal\"\nimport posting from \"misago/services/posting\"\nimport snackbar from \"misago/services/snackbar\"\nimport store from \"misago/services/store\"\n\nexport default function (props) {\n  const { isPollOver, poll, showVoting, thread } = props\n\n  if (!isVisible(isPollOver, poll.acl, poll)) return null\n\n  const controls = []\n\n  const canVote = poll.acl.can_vote\n  const canChangeVote = !poll.hasSelectedChoices || poll.allow_revotes\n\n  if (canVote && canChangeVote) controls.push(0)\n  if (poll.is_public || poll.acl.can_see_votes) controls.push(1)\n  if (poll.acl.can_edit) controls.push(2)\n  if (poll.acl.can_delete) controls.push(3)\n\n  return (\n    <div className=\"row poll-options\">\n      <ChangeVote\n        controls={controls}\n        isPollOver={isPollOver}\n        poll={poll}\n        showVoting={showVoting}\n      />\n      <SeeVotes controls={controls} poll={poll} />\n      <Edit\n        controls={controls}\n        poll={poll}\n        thread={thread}\n        onClick={props.edit}\n      />\n      <Delete controls={controls} poll={poll} />\n    </div>\n  )\n}\n\nexport function isVisible(isPollOver, acl, poll) {\n  return (\n    poll.is_public ||\n    acl.can_delete ||\n    acl.can_edit ||\n    acl.can_see_votes ||\n    (acl.can_vote &&\n      !isPollOver &&\n      (!poll.hasSelectedChoices || poll.allow_revotes))\n  )\n}\n\nexport function getClassName(controls, control) {\n  let className = \"col-xs-6\"\n\n  if (controls.length === 1) {\n    className = \"col-xs-12\"\n  }\n\n  if (controls.length === 3 && controls[0] === control) {\n    className = \"col-xs-12\"\n  }\n\n  return className + \" col-sm-3 col-md-2\"\n}\n\nexport function ChangeVote(props) {\n  const canVote = props.poll.acl.can_vote\n  const canChangeVote =\n    !props.poll.hasSelectedChoices || props.poll.allow_revotes\n\n  if (!(canVote && canChangeVote)) return null\n\n  return (\n    <div className={getClassName(props.controls, 0)}>\n      <button\n        className=\"btn btn-default btn-block btn-sm\"\n        disabled={props.poll.isBusy}\n        onClick={props.showVoting}\n        type=\"button\"\n      >\n        {pgettext(\"thread poll\", \"Vote\")}\n      </button>\n    </div>\n  )\n}\n\nexport class SeeVotes extends React.Component {\n  onClick = () => {\n    modal.show(<Modal poll={this.props.poll} />)\n  }\n\n  render() {\n    const seeVotes =\n      this.props.poll.is_public || this.props.poll.acl.can_see_votes\n    if (!seeVotes) return null\n\n    return (\n      <div className={getClassName(this.props.controls, 1)}>\n        <button\n          className=\"btn btn-default btn-block btn-sm\"\n          disabled={this.props.poll.isBusy}\n          onClick={this.onClick}\n          type=\"button\"\n        >\n          {pgettext(\"thread poll\", \"See votes\")}\n        </button>\n      </div>\n    )\n  }\n}\n\nexport function Edit(props) {\n  if (!props.poll.acl.can_edit) return null\n\n  return (\n    <div className={getClassName(props.controls, 2)}>\n      <button\n        className=\"btn btn-default btn-block btn-sm\"\n        disabled={props.poll.isBusy}\n        onClick={props.onClick}\n        type=\"button\"\n      >\n        {pgettext(\"thread poll\", \"Edit\")}\n      </button>\n    </div>\n  )\n}\n\nexport class Delete extends React.Component {\n  onClick = () => {\n    const deletePoll = window.confirm(\n      pgettext(\n        \"thread poll\",\n        \"Are you sure you want to delete this poll? This action is not reversible.\"\n      )\n    )\n    if (!deletePoll) return false\n\n    store.dispatch(poll.busy())\n\n    ajax\n      .delete(this.props.poll.api.index)\n      .then(this.handleSuccess, this.handleError)\n  }\n\n  handleSuccess = (newThreadAcl) => {\n    snackbar.success(pgettext(\"thread poll\", \"Poll has been deleted\"))\n    store.dispatch(poll.remove())\n    store.dispatch(thread.updateAcl(newThreadAcl))\n  }\n\n  handleError = (rejection) => {\n    snackbar.apiError(rejection)\n    store.dispatch(poll.release())\n  }\n\n  render() {\n    if (!this.props.poll.acl.can_delete) return null\n\n    return (\n      <div className={getClassName(this.props.controls, 3)}>\n        <button\n          className=\"btn btn-default btn-block btn-sm\"\n          disabled={this.props.poll.isBusy}\n          onClick={this.onClick}\n          type=\"button\"\n        >\n          {pgettext(\"thread poll\", \"Delete\")}\n        </button>\n      </div>\n    )\n  }\n}\n","import React from \"react\"\nimport escapeHtml from \"misago/utils/escape-html\"\n\nconst DATE_ABBR = '<abbr title=\"%(absolute)s\">%(relative)s</abbr>'\nconst USER_SPAN = '<span class=\"item-title\">%(user)s</span>'\nconst USER_URL = '<a href=\"%(url)s\" class=\"item-title\">%(user)s</a>'\n\nexport default function (props) {\n  return (\n    <ul className=\"list-unstyled list-inline poll-details\">\n      <PollVotes votes={props.poll.votes} />\n      <PollLength poll={props.poll} />\n      <PollIsPublic poll={props.poll} />\n      <PollCreation poll={props.poll} />\n    </ul>\n  )\n}\n\nexport function PollCreation(props) {\n  const message = interpolate(\n    escapeHtml(pgettext(\"thread poll\", \"Started by %(poster)s %(posted_on)s.\")),\n    {\n      poster: getPoster(props.poll),\n      posted_on: getPostedOn(props.poll),\n    },\n    true\n  )\n\n  return (\n    <li\n      className=\"poll-info-creation\"\n      dangerouslySetInnerHTML={{ __html: message }}\n    />\n  )\n}\n\nexport function getPoster(poll) {\n  if (poll.url.poster) {\n    return interpolate(\n      USER_URL,\n      {\n        url: escapeHtml(poll.url.poster),\n        user: escapeHtml(poll.poster_name),\n      },\n      true\n    )\n  }\n\n  return interpolate(\n    USER_SPAN,\n    {\n      user: escapeHtml(poll.poster_name),\n    },\n    true\n  )\n}\n\nexport function getPostedOn(poll) {\n  return interpolate(\n    DATE_ABBR,\n    {\n      absolute: escapeHtml(poll.posted_on.format(\"LLL\")),\n      relative: escapeHtml(poll.posted_on.fromNow()),\n    },\n    true\n  )\n}\n\nexport function PollLength(props) {\n  if (!props.poll.length) {\n    return null\n  }\n\n  const message = interpolate(\n    escapeHtml(pgettext(\"thread poll\", \"Voting ends %(ends_on)s.\")),\n    {\n      ends_on: getEndsOn(props.poll),\n    },\n    true\n  )\n\n  return (\n    <li\n      className=\"poll-info-ends-on\"\n      dangerouslySetInnerHTML={{ __html: message }}\n    />\n  )\n}\n\nexport function getEndsOn(poll) {\n  return interpolate(\n    DATE_ABBR,\n    {\n      absolute: escapeHtml(poll.endsOn.format(\"LLL\")),\n      relative: escapeHtml(poll.endsOn.fromNow()),\n    },\n    true\n  )\n}\n\nexport function PollVotes(props) {\n  const message = npgettext(\n    \"thread poll\",\n    \"%(votes)s vote.\",\n    \"%(votes)s votes.\",\n    props.votes\n  )\n  const label = interpolate(\n    message,\n    {\n      votes: props.votes,\n    },\n    true\n  )\n\n  return <li className=\"poll-info-votes\">{label}</li>\n}\n\nexport function PollIsPublic(props) {\n  if (!props.poll.is_public) {\n    return null\n  }\n\n  return (\n    <li className=\"poll-info-public\">\n      {pgettext(\"thread poll\", \"Voting is public.\")}\n    </li>\n  )\n}\n","import React from \"react\"\nimport Chart from \"./chart\"\nimport Options from \"./options\"\nimport PollInfo from \"../info\"\n\nexport default function (props) {\n  return (\n    <div className=\"panel panel-default panel-poll\">\n      <div className=\"panel-body\">\n        <h2>{props.poll.question}</h2>\n        <PollInfo poll={props.poll} />\n        <Chart poll={props.poll} />\n        <Options\n          isPollOver={props.isPollOver}\n          poll={props.poll}\n          edit={props.edit}\n          showVoting={props.showVoting}\n          thread={props.thread}\n        />\n      </div>\n    </div>\n  )\n}\n","import React from \"react\"\nimport escapeHtml from \"misago/utils/escape-html\"\n\nconst DATE_ABBR = '<abbr title=\"%(absolute)s\">%(relative)s</abbr>'\nconst USER_SPAN = '<span class=\"item-title\">%(user)s</span>'\nconst USER_URL = '<a href=\"%(url)s\" class=\"item-title\">%(user)s</a>'\n\nexport default function (props) {\n  return (\n    <ul className=\"list-unstyled list-inline poll-help\">\n      <PollChoicesLeft choicesLeft={props.choicesLeft} />\n      <PollAllowRevote poll={props.poll} />\n    </ul>\n  )\n}\n\nexport function PollChoicesLeft({ choicesLeft }) {\n  if (choicesLeft === 0) {\n    return (\n      <li className=\"poll-help-choices-left\">\n        {pgettext(\"thread poll\", \"You can't select any more choices.\")}\n      </li>\n    )\n  }\n\n  const message = npgettext(\n    \"thread poll\",\n    \"You can select %(choices)s more choice.\",\n    \"You can select %(choices)s more choices.\",\n    choicesLeft\n  )\n\n  const label = interpolate(\n    message,\n    {\n      choices: choicesLeft,\n    },\n    true\n  )\n\n  return <li className=\"poll-help-choices-left\">{label}</li>\n}\n\nexport function PollAllowRevote(props) {\n  if (props.poll.allow_revotes) {\n    return (\n      <li className=\"poll-help-allow-revotes\">\n        {pgettext(\"thread poll\", \"You can change your vote later.\")}\n      </li>\n    )\n  }\n\n  return (\n    <li className=\"poll-help-no-revotes\">\n      {pgettext(\"thread poll\", \"Votes are final.\")}\n    </li>\n  )\n}\n","import React from \"react\"\n\nexport default function (props) {\n  return (\n    <ul className=\"list-unstyled poll-select-choices\">\n      {props.choices.map((choice) => {\n        return (\n          <ChoiceSelect\n            choice={choice}\n            key={choice.hash}\n            toggleChoice={props.toggleChoice}\n          />\n        )\n      })}\n    </ul>\n  )\n}\n\nexport class ChoiceSelect extends React.Component {\n  onClick = () => {\n    this.props.toggleChoice(this.props.choice.hash)\n  }\n\n  render() {\n    return (\n      <li className=\"poll-select-choice\">\n        <button\n          className={this.props.choice.selected ? \"btn btn-selected\" : \"btn\"}\n          onClick={this.onClick}\n          type=\"button\"\n        >\n          <span className=\"material-icon\">\n            {this.props.choice.selected\n              ? \"check_box\"\n              : \"check_box_outline_blank\"}\n          </span>\n          <strong>{this.props.choice.label}</strong>\n        </button>\n      </li>\n    )\n  }\n}\n","export function getChoiceFromHash(choices, hash) {\n  for (const i in choices) {\n    const choice = choices[i]\n    if (choice.hash === hash) {\n      return choice\n    }\n  }\n\n  return null\n}\n\nexport function getChoicesLeft(poll, choices) {\n  let selection = []\n  for (const i in choices) {\n    const choice = choices[i]\n    if (choice.selected) {\n      selection.push(choice)\n    }\n  }\n\n  return poll.allowed_choices - selection.length\n}\n","import React from \"react\"\nimport ChoicesHelp from \"./help\"\nimport ChoicesSelect from \"./select\"\nimport { getChoicesLeft, getChoiceFromHash } from \"./utils\"\nimport PollInfo from \"../info\"\nimport { Delete, Edit, getClassName } from \"../results/options\"\nimport Button from \"misago/components/button\"\nimport Form from \"misago/components/form\"\nimport * as poll from \"misago/reducers/poll\"\nimport ajax from \"misago/services/ajax\"\nimport snackbar from \"misago/services/snackbar\"\nimport store from \"misago/services/store\"\n\nexport default class extends Form {\n  constructor(props) {\n    super(props)\n\n    this.state = {\n      isLoading: false,\n\n      choices: props.poll.choices,\n      choicesLeft: getChoicesLeft(props.poll, props.poll.choices),\n    }\n  }\n\n  toggleChoice = (hash) => {\n    const choice = getChoiceFromHash(this.state.choices, hash)\n\n    let choices = null\n    if (!choice.selected) {\n      choices = this.selectChoice(choice, hash)\n    } else {\n      choices = this.deselectChoice(choice, hash)\n    }\n\n    this.setState({\n      choices,\n      choicesLeft: getChoicesLeft(this.props.poll, choices),\n    })\n  }\n\n  selectChoice = (choice, hash) => {\n    const choicesLeft = getChoicesLeft(this.props.poll, this.state.choices)\n\n    if (!choicesLeft) {\n      for (const i in this.state.choices.slice()) {\n        const item = this.state.choices[i]\n        if (item.selected && item.hash != hash) {\n          item.selected = false\n          break\n        }\n      }\n    }\n\n    return this.state.choices.map((choice) => {\n      return Object.assign({}, choice, {\n        selected: choice.hash == hash ? true : choice.selected,\n      })\n    })\n  }\n\n  deselectChoice = (choice, hash) => {\n    return this.state.choices.map((choice) => {\n      return Object.assign({}, choice, {\n        selected: choice.hash == hash ? false : choice.selected,\n      })\n    })\n  }\n\n  clean() {\n    if (this.state.choicesLeft === this.props.poll.allowed_choices) {\n      snackbar.error(\n        pgettext(\"thread poll vote\", \"You need to select at least one choice.\")\n      )\n      return false\n    }\n\n    return true\n  }\n\n  send() {\n    let data = []\n    for (const i in this.state.choices.slice()) {\n      const item = this.state.choices[i]\n      if (item.selected) {\n        data.push(item.hash)\n      }\n    }\n\n    return ajax.post(this.props.poll.api.votes, data)\n  }\n\n  handleSuccess(data) {\n    store.dispatch(poll.replace(data))\n    snackbar.success(pgettext(\"thread poll vote\", \"Your vote has been saved.\"))\n\n    this.props.showResults()\n  }\n\n  handleError(rejection) {\n    if (rejection.status === 400) {\n      snackbar.error(rejection.detail)\n    } else {\n      snackbar.apiError(rejection)\n    }\n  }\n\n  render() {\n    const controls = []\n\n    if (this.props.poll.acl.can_vote) controls.push(0)\n    if (this.props.poll.is_public || this.props.poll.acl.can_see_votes)\n      controls.push(1)\n    if (this.props.poll.acl.can_edit) controls.push(2)\n    if (this.props.poll.acl.can_delete) controls.push(3)\n\n    return (\n      <div className=\"panel panel-default panel-poll\">\n        <form onSubmit={this.handleSubmit}>\n          <div className=\"panel-body\">\n            <h2>{this.props.poll.question}</h2>\n            <PollInfo poll={this.props.poll} />\n            <ChoicesSelect\n              choices={this.state.choices}\n              toggleChoice={this.toggleChoice}\n            />\n            <ChoicesHelp\n              choicesLeft={this.state.choicesLeft}\n              poll={this.props.poll}\n            />\n          </div>\n          <div className=\"panel-footer\">\n            <div className=\"row\">\n              <div className={getClassName(controls, 0)}>\n                <Button\n                  className=\"btn-primary btn-block btn-sm\"\n                  loading={this.state.isLoading}\n                >\n                  {pgettext(\"thread poll vote btn\", \"Save your vote\")}\n                </Button>\n              </div>\n              <div className={getClassName(controls, 1)}>\n                <button\n                  className=\"btn btn-default btn-block btn-sm\"\n                  disabled={this.state.isLoading}\n                  onClick={this.props.showResults}\n                  type=\"button\"\n                >\n                  {pgettext(\"thread poll vote btn\", \"See results\")}\n                </button>\n              </div>\n              <Edit\n                controls={controls}\n                poll={this.props.poll}\n                thread={this.props.thread}\n                onClick={this.props.edit}\n              />\n              <Delete controls={controls} poll={this.props.poll} />\n            </div>\n          </div>\n        </form>\n      </div>\n    )\n  }\n}\n","import React from \"react\"\nimport moment from \"moment\"\nimport Results from \"./results\"\nimport Voting from \"./voting\"\n\nexport default class extends React.Component {\n  constructor(props) {\n    super(props)\n\n    let showResults = true\n    if (props.user.id && !props.poll.hasSelectedChoices) {\n      showResults = false\n    }\n\n    this.state = {\n      showResults,\n    }\n  }\n\n  showResults = () => {\n    this.setState({\n      showResults: true,\n    })\n  }\n\n  showVoting = () => {\n    this.setState({\n      showResults: false,\n    })\n  }\n\n  render() {\n    if (!this.props.thread.poll) return null\n\n    const isPollOver = getIsPollOver(this.props.poll)\n\n    if (\n      !isPollOver &&\n      this.props.poll.acl.can_vote &&\n      !this.state.showResults\n    ) {\n      return <Voting showResults={this.showResults} {...this.props} />\n    } else {\n      return (\n        <Results\n          isPollOver={isPollOver}\n          showVoting={this.showVoting}\n          {...this.props}\n        />\n      )\n    }\n  }\n}\n\nexport function getIsPollOver(poll) {\n  if (poll.length) {\n    return moment().isAfter(poll.endsOn)\n  }\n  return false\n}\n","import React from \"react\"\nimport getRandomString from \"../../../utils/getRandomString\"\n\nconst HASH_LENGTH = 12\n\nexport default class extends React.Component {\n  onAdd = () => {\n    let choices = this.props.choices.slice()\n    choices.push({\n      hash: getRandomString(HASH_LENGTH),\n      label: \"\",\n    })\n\n    this.props.setChoices(choices)\n  }\n\n  onChange = (hash, label) => {\n    const choices = this.props.choices.map((choice) => {\n      if (choice.hash === hash) {\n        choice.label = label\n      }\n\n      return choice\n    })\n    this.props.setChoices(choices)\n  }\n\n  onDelete = (hash) => {\n    const choices = this.props.choices.filter((choice) => {\n      return choice.hash !== hash\n    })\n    this.props.setChoices(choices)\n  }\n\n  render() {\n    return (\n      <div className=\"poll-choices-control\">\n        <ul className=\"list-group\">\n          {this.props.choices.map((choice) => {\n            return (\n              <PollChoice\n                canDelete={this.props.choices.length > 2}\n                choice={choice}\n                disabled={this.props.disabled}\n                key={choice.hash}\n                onChange={this.onChange}\n                onDelete={this.onDelete}\n              />\n            )\n          })}\n        </ul>\n        <button\n          className=\"btn btn-default btn-sm\"\n          disabled={this.props.disabled}\n          onClick={this.onAdd}\n          type=\"button\"\n        >\n          {pgettext(\"thread poll\", \"Add choice\")}\n        </button>\n      </div>\n    )\n  }\n}\n\nexport class PollChoice extends React.Component {\n  onChange = (event) => {\n    this.props.onChange(this.props.choice.hash, event.target.value)\n  }\n\n  onDelete = () => {\n    const deleteItem =\n      this.props.choice.label.length === 0\n        ? true\n        : window.confirm(\n            pgettext(\n              \"thread poll\",\n              \"Are you sure you want to remove this choice?\"\n            )\n          )\n    if (deleteItem) {\n      this.props.onDelete(this.props.choice.hash)\n    }\n  }\n\n  render() {\n    return (\n      <li className=\"list-group-item\">\n        <button\n          className=\"btn\"\n          disabled={!this.props.canDelete || this.props.disabled}\n          onClick={this.onDelete}\n          title={pgettext(\"thread poll\", \"Remove this choice\")}\n          type=\"button\"\n        >\n          <span className=\"material-icon\">close</span>\n        </button>\n        <input\n          disabled={this.props.disabled}\n          maxLength=\"255\"\n          placeholder={pgettext(\"thread poll\", \"Poll choice\")}\n          type=\"text\"\n          onChange={this.onChange}\n          value={this.props.choice.label}\n        />\n      </li>\n    )\n  }\n}\n","import React from \"react\"\nimport ChoicesControl from \"./choices-control\"\nimport Button from \"misago/components/button\"\nimport Form from \"misago/components/form\"\nimport FormGroup from \"misago/components/form-group\"\nimport YesNoSwitch from \"misago/components/yes-no-switch\"\nimport * as poll from \"misago/reducers/poll\"\nimport ajax from \"misago/services/ajax\"\nimport snackbar from \"misago/services/snackbar\"\nimport store from \"misago/services/store\"\n\nexport default class extends Form {\n  constructor(props) {\n    super(props)\n\n    const poll = props.poll.id\n      ? props.poll\n      : {\n          question: \"\",\n          choices: [\n            {\n              hash: \"choice-10000\",\n              label: \"\",\n            },\n            {\n              hash: \"choice-20000\",\n              label: \"\",\n            },\n          ],\n          length: 0,\n          allowed_choices: 1,\n          allow_revotes: 0,\n          is_public: 0,\n        }\n\n    this.state = {\n      isLoading: false,\n      isEdit: !!poll.id,\n\n      question: poll.question,\n      choices: poll.choices,\n      length: poll.length,\n      allowed_choices: poll.allowed_choices,\n      allow_revotes: poll.allow_revotes,\n      is_public: poll.is_public,\n\n      validators: {\n        question: [],\n        choices: [],\n        length: [],\n        allowed_choices: [],\n      },\n\n      errors: {},\n    }\n  }\n\n  setChoices = (choices) => {\n    this.setState((state) => {\n      return {\n        choices,\n        errors: Object.assign({}, state.errors, { choices: null }),\n      }\n    })\n  }\n\n  onCancel = () => {\n    let cancel = false\n\n    // Nothing added to the poll so no changes to discard\n    const formEmpty = !!(\n      this.state.question === \"\" &&\n      this.state.choices &&\n      this.state.choices.every((choice) => choice.label === \"\") &&\n      this.state.length === 0 &&\n      this.state.allowed_choices === 1\n    )\n\n    if (formEmpty) {\n      return this.props.close()\n    }\n\n    if (!!this.props.poll) {\n      cancel = window.confirm(\n        pgettext(\"thread poll\", \"Are you sure you want to discard changes?\")\n      )\n    } else {\n      cancel = window.confirm(\n        pgettext(\"thread poll\", \"Are you sure you want to discard new poll?\")\n      )\n    }\n\n    if (cancel) {\n      this.props.close()\n    }\n  }\n\n  send() {\n    const data = {\n      question: this.state.question,\n      choices: this.state.choices,\n      length: this.state.length,\n      allowed_choices: this.state.allowed_choices,\n      allow_revotes: this.state.allow_revotes,\n      is_public: this.state.is_public,\n    }\n\n    if (this.state.isEdit) {\n      return ajax.put(this.props.poll.api.index, data)\n    }\n\n    return ajax.post(this.props.thread.api.poll, data)\n  }\n\n  handleSuccess(data) {\n    store.dispatch(poll.replace(data))\n\n    if (this.state.isEdit) {\n      snackbar.success(pgettext(\"thread poll\", \"Poll has been edited.\"))\n    } else {\n      snackbar.success(pgettext(\"thread poll\", \"Poll has been posted.\"))\n    }\n\n    this.props.close()\n  }\n\n  handleError(rejection) {\n    if (rejection.status === 400) {\n      if (rejection.non_field_errors) {\n        rejection.allowed_choices = rejection.non_field_errors\n      }\n\n      this.setState({\n        errors: Object.assign({}, rejection),\n      })\n\n      snackbar.error(gettext(\"Form contains errors.\"))\n    } else {\n      snackbar.apiError(rejection)\n    }\n  }\n\n  render() {\n    return (\n      <div className=\"poll-form\">\n        <form onSubmit={this.handleSubmit}>\n          <div className=\"panel panel-default panel-form\">\n            <div className=\"panel-heading\">\n              <h3 className=\"panel-title\">\n                {this.state.isEdit\n                  ? pgettext(\"thread poll\", \"Edit poll\")\n                  : pgettext(\"thread poll\", \"Add poll\")}\n              </h3>\n            </div>\n            <div className=\"panel-body\">\n              <fieldset>\n                <legend>\n                  {pgettext(\"thread poll\", \"Question and choices\")}\n                </legend>\n\n                <FormGroup\n                  label={pgettext(\"thread poll\", \"Poll question\")}\n                  for=\"id_questions\"\n                  validation={this.state.errors.question}\n                >\n                  <input\n                    className=\"form-control\"\n                    disabled={this.state.isLoading}\n                    id=\"id_questions\"\n                    onChange={this.bindInput(\"question\")}\n                    type=\"text\"\n                    maxLength=\"255\"\n                    value={this.state.question}\n                  />\n                </FormGroup>\n\n                <FormGroup\n                  label={pgettext(\"thread poll\", \"Available choices\")}\n                  validation={this.state.errors.choices}\n                >\n                  <ChoicesControl\n                    choices={this.state.choices}\n                    disabled={this.state.isLoading}\n                    setChoices={this.setChoices}\n                  />\n                </FormGroup>\n              </fieldset>\n\n              <fieldset>\n                <legend>{pgettext(\"thread poll\", \"Voting\")}</legend>\n\n                <div className=\"row\">\n                  <div className=\"col-xs-12 col-sm-6\">\n                    <FormGroup\n                      label={pgettext(\"thread poll\", \"Poll length\")}\n                      helpText={pgettext(\n                        \"thread poll\",\n                        \"Enter number of days for which voting in this poll should be possible or zero to run this poll indefinitely.\"\n                      )}\n                      for=\"id_length\"\n                      validation={this.state.errors.length}\n                    >\n                      <input\n                        className=\"form-control\"\n                        disabled={this.state.isLoading}\n                        id=\"id_length\"\n                        onChange={this.bindInput(\"length\")}\n                        type=\"text\"\n                        value={this.state.length}\n                      />\n                    </FormGroup>\n                  </div>\n                  <div className=\"col-xs-12 col-sm-6\">\n                    <FormGroup\n                      label={pgettext(\"thread poll\", \"Allowed choices\")}\n                      for=\"id_allowed_choices\"\n                      validation={this.state.errors.allowed_choices}\n                    >\n                      <input\n                        className=\"form-control\"\n                        disabled={this.state.isLoading}\n                        id=\"id_allowed_choices\"\n                        onChange={this.bindInput(\"allowed_choices\")}\n                        type=\"text\"\n                        maxLength=\"255\"\n                        value={this.state.allowed_choices}\n                      />\n                    </FormGroup>\n                  </div>\n                </div>\n\n                <div className=\"row\">\n                  <PollPublicSwitch\n                    bindInput={this.bindInput}\n                    disabled={this.state.isLoading}\n                    isEdit={this.state.isEdit}\n                    value={this.state.is_public}\n                  />\n                  <div className=\"col-xs-12 col-sm-6\">\n                    <FormGroup\n                      label={pgettext(\"thread poll\", \"Allow vote changes\")}\n                      for=\"id_allow_revotes\"\n                    >\n                      <YesNoSwitch\n                        id=\"id_allow_revotes\"\n                        disabled={this.state.isLoading}\n                        iconOn=\"check\"\n                        iconOff=\"close\"\n                        labelOn={pgettext(\n                          \"thread poll\",\n                          \"Allow participants to change their vote\"\n                        )}\n                        labelOff={pgettext(\n                          \"thread poll\",\n                          \"Don't allow participants to change their vote\"\n                        )}\n                        onChange={this.bindInput(\"allow_revotes\")}\n                        value={this.state.allow_revotes}\n                      />\n                    </FormGroup>\n                  </div>\n                </div>\n              </fieldset>\n            </div>\n            <div className=\"panel-footer text-right\">\n              <button\n                className=\"btn btn-default\"\n                disabled={this.state.isLoading}\n                onClick={this.onCancel}\n                type=\"button\"\n              >\n                {pgettext(\"thread poll\", \"Cancel\")}\n              </button>{\" \"}\n              <Button className=\"btn-primary\" loading={this.state.isLoading}>\n                {this.state.isEdit\n                  ? pgettext(\"thread poll\", \"Save changes\")\n                  : pgettext(\"thread poll\", \"Post poll\")}\n              </Button>\n            </div>\n          </div>\n        </form>\n      </div>\n    )\n  }\n}\n\nexport function PollPublicSwitch(props) {\n  if (props.isEdit) return null\n\n  return (\n    <div className=\"col-xs-12 col-sm-6\">\n      <FormGroup\n        label={pgettext(\"thread poll\", \"Make voting public\")}\n        helpText={pgettext(\n          \"thread poll\",\n          \"Making voting public will allow everyone to access detailed list of votes, showing which users voted for which choices and at which times. This option can't be changed after poll's creation. Moderators may see voting details for all polls.\"\n        )}\n        for=\"id_is_public\"\n      >\n        <YesNoSwitch\n          id=\"id_is_public\"\n          disabled={props.disabled}\n          iconOn=\"visibility\"\n          iconOff=\"visibility_off\"\n          labelOn={pgettext(\"thread poll\", \"Votes are public\")}\n          labelOff={pgettext(\"thread poll\", \"Votes are hidden\")}\n          onChange={props.bindInput(\"is_public\")}\n          value={props.value}\n        />\n      </FormGroup>\n    </div>\n  )\n}\n","import React from \"react\"\n\nconst ICON = {\n  changed_title: \"edit\",\n\n  pinned_globally: \"bookmark\",\n  pinned_locally: \"bookmark_border\",\n  unpinned: \"panorama_fish_eye\",\n\n  moved: \"arrow_forward\",\n  merged: \"call_merge\",\n\n  approved: \"done\",\n\n  opened: \"lock_open\",\n  closed: \"lock_outline\",\n\n  unhid: \"visibility\",\n  hid: \"visibility_off\",\n\n  changed_owner: \"grade\",\n  tookover: \"grade\",\n\n  added_participant: \"person_add\",\n\n  owner_left: \"person_outline\",\n  participant_left: \"person_outline\",\n  removed_participant: \"remove_circle_outline\",\n}\n\nconst EventIcon = (props) => (\n  <span className=\"event-icon-bg\">\n    <span className=\"material-icon\">{ICON[props.post.event_type]}</span>\n  </span>\n)\n\nexport default EventIcon\n","import React from \"react\"\nimport moment from \"moment\"\nimport * as post from \"misago/reducers/post\"\nimport ajax from \"misago/services/ajax\"\nimport snackbar from \"misago/services/snackbar\"\nimport store from \"misago/services/store\"\n\nexport default function (props) {\n  if (isVisible(props.post.acl)) {\n    return (\n      <li className=\"event-controls\">\n        <Hide {...props} />\n        <Unhide {...props} />\n        <Delete {...props} />\n      </li>\n    )\n  } else {\n    return null\n  }\n}\n\nexport function isVisible(acl) {\n  return acl.can_hide\n}\n\nexport class Hide extends React.Component {\n  onClick = () => {\n    store.dispatch(\n      post.patch(this.props.post, {\n        is_hidden: true,\n        hidden_on: moment(),\n        hidden_by_name: this.props.user.username,\n        url: Object.assign(this.props.post.url, {\n          hidden_by: this.props.user.url,\n        }),\n      })\n    )\n\n    const op = { op: \"replace\", path: \"is-hidden\", value: true }\n\n    ajax.patch(this.props.post.api.index, [op]).then(\n      (patch) => {\n        store.dispatch(post.patch(this.props.post, patch))\n      },\n      (rejection) => {\n        if (rejection.status === 400) {\n          snackbar.error(rejection.detail[0])\n        } else {\n          snackbar.apiError(rejection)\n        }\n\n        store.dispatch(\n          post.patch(this.props.post, {\n            is_hidden: false,\n          })\n        )\n      }\n    )\n  }\n\n  render() {\n    if (!this.props.post.is_hidden) {\n      return (\n        <button type=\"button\" className=\"btn btn-link\" onClick={this.onClick}>\n          {pgettext(\"event hide btn\", \"Hide\")}\n        </button>\n      )\n    } else {\n      return null\n    }\n  }\n}\n\nexport class Unhide extends React.Component {\n  onClick = () => {\n    store.dispatch(\n      post.patch(this.props.post, {\n        is_hidden: false,\n      })\n    )\n\n    const op = { op: \"replace\", path: \"is-hidden\", value: false }\n\n    ajax.patch(this.props.post.api.index, [op]).then(\n      (patch) => {\n        store.dispatch(post.patch(this.props.post, patch))\n      },\n      (rejection) => {\n        if (rejection.status === 400) {\n          snackbar.error(rejection.detail[0])\n        } else {\n          snackbar.apiError(rejection)\n        }\n\n        store.dispatch(\n          post.patch(this.props.post, {\n            is_hidden: true,\n          })\n        )\n      }\n    )\n  }\n\n  render() {\n    if (this.props.post.is_hidden) {\n      return (\n        <button type=\"button\" className=\"btn btn-link\" onClick={this.onClick}>\n          {pgettext(\"event reveal btn\", \"Unhide\")}\n        </button>\n      )\n    } else {\n      return null\n    }\n  }\n}\n\nexport class Delete extends React.Component {\n  onClick = () => {\n    const decision = window.confirm(\n      pgettext(\n        \"event delete\",\n        \"Are you sure you wish to delete this event? This action is not reversible!\"\n      )\n    )\n    if (decision) {\n      this.delete()\n    }\n  }\n\n  delete = () => {\n    store.dispatch(\n      post.patch(this.props.post, {\n        isDeleted: true,\n      })\n    )\n\n    ajax.delete(this.props.post.api.index).then(\n      () => {\n        snackbar.success(pgettext(\"event delete\", \"Event has been deleted.\"))\n      },\n      (rejection) => {\n        if (rejection.status === 400) {\n          snackbar.error(rejection.detail[0])\n        } else {\n          snackbar.apiError(rejection)\n        }\n\n        store.dispatch(\n          post.patch(this.props.post, {\n            isDeleted: false,\n          })\n        )\n      }\n    )\n  }\n\n  render() {\n    return (\n      <button type=\"button\" className=\"btn btn-link\" onClick={this.onClick}>\n        {pgettext(\"event delete btn\", \"Delete\")}\n      </button>\n    )\n  }\n}\n","import React from \"react\"\nimport escapeHtml from \"misago/utils/escape-html\"\nimport Controls from \"./controls\"\n\nconst DATE_ABBR = '<abbr title=\"%(absolute)s\">%(relative)s</abbr>'\nconst DATE_URL = '<a href=\"%(url)s\" title=\"%(absolute)s\">%(relative)s</a>'\nconst USER_SPAN = '<span class=\"item-title\">%(user)s</span>'\nconst USER_URL = '<a href=\"%(url)s\" class=\"item-title\">%(user)s</a>'\n\nexport default function (props) {\n  return (\n    <ul className=\"list-inline event-info\">\n      <Hidden {...props} />\n      <Poster {...props} />\n      <Controls {...props} />\n    </ul>\n  )\n}\n\nexport function Hidden(props) {\n  if (props.post.is_hidden) {\n    let user = null\n    if (props.post.url.hidden_by) {\n      user = interpolate(\n        USER_URL,\n        {\n          url: escapeHtml(props.post.url.hidden_by),\n          user: escapeHtml(props.post.hidden_by_name),\n        },\n        true\n      )\n    } else {\n      user = interpolate(\n        USER_SPAN,\n        {\n          user: escapeHtml(props.post.hidden_by_name),\n        },\n        true\n      )\n    }\n\n    const date = interpolate(\n      DATE_ABBR,\n      {\n        absolute: escapeHtml(props.post.hidden_on.format(\"LLL\")),\n        relative: escapeHtml(props.post.hidden_on.fromNow()),\n      },\n      true\n    )\n\n    const message = interpolate(\n      escapeHtml(\n        pgettext(\"event info\", \"Hidden by %(event_by)s %(event_on)s.\")\n      ),\n      {\n        event_by: user,\n        event_on: date,\n      },\n      true\n    )\n\n    return (\n      <li\n        className=\"event-hidden-message\"\n        dangerouslySetInnerHTML={{ __html: message }}\n      />\n    )\n  } else {\n    return null\n  }\n}\n\nexport function Poster(props) {\n  let user = null\n  if (props.post.poster) {\n    user = interpolate(\n      USER_URL,\n      {\n        url: escapeHtml(props.post.poster.url),\n        user: escapeHtml(props.post.poster_name),\n      },\n      true\n    )\n  } else {\n    user = interpolate(\n      USER_SPAN,\n      {\n        user: escapeHtml(props.post.poster_name),\n      },\n      true\n    )\n  }\n\n  const date = interpolate(\n    DATE_URL,\n    {\n      url: escapeHtml(props.post.url.index),\n      absolute: escapeHtml(props.post.posted_on.format(\"LLL\")),\n      relative: escapeHtml(props.post.posted_on.fromNow()),\n    },\n    true\n  )\n\n  const message = interpolate(\n    escapeHtml(pgettext(\"event info\", \"By %(event_by)s %(event_on)s.\")),\n    {\n      event_by: user,\n      event_on: date,\n    },\n    true\n  )\n\n  return (\n    <li\n      className=\"event-posters\"\n      dangerouslySetInnerHTML={{ __html: message }}\n    />\n  )\n}\n","import React from \"react\"\nimport escapeHtml from \"misago/utils/escape-html\"\n\nconst MESSAGE = {\n  pinned_globally: pgettext(\n    \"event message\",\n    \"Thread has been pinned globally.\"\n  ),\n  pinned_locally: pgettext(\n    \"event message\",\n    \"Thread has been pinned in category.\"\n  ),\n  unpinned: pgettext(\"event message\", \"Thread has been unpinned.\"),\n\n  approved: pgettext(\"event message\", \"Thread has been approved.\"),\n\n  opened: pgettext(\"event message\", \"Thread has been opened.\"),\n  closed: pgettext(\"event message\", \"Thread has been closed.\"),\n\n  unhid: pgettext(\"event message\", \"Thread has been revealed.\"),\n  hid: pgettext(\"event message\", \"Thread has been made hidden.\"),\n\n  tookover: pgettext(\"event message\", \"Took thread over.\"),\n\n  owner_left: pgettext(\n    \"event message\",\n    \"Owner has left thread. This thread is now closed.\"\n  ),\n  participant_left: pgettext(\"event message\", \"Participant has left thread.\"),\n}\n\nconst ITEM_LINK = '<a href=\"%(url)s\" class=\"item-title\">%(name)s</a>'\nconst ITEM_SPAN = '<span class=\"item-title\">%(name)s</span>'\n\nexport default function (props) {\n  if (MESSAGE[props.post.event_type]) {\n    return <p className=\"event-message\">{MESSAGE[props.post.event_type]}</p>\n  } else if (props.post.event_type === \"changed_title\") {\n    return <ChangedTitle {...props} />\n  } else if (props.post.event_type === \"moved\") {\n    return <Moved {...props} />\n  } else if (props.post.event_type === \"merged\") {\n    return <Merged {...props} />\n  } else if (props.post.event_type === \"changed_owner\") {\n    return <ChangedOwner {...props} />\n  } else if (props.post.event_type === \"added_participant\") {\n    return <AddedParticipant {...props} />\n  } else if (props.post.event_type === \"removed_participant\") {\n    return <RemovedParticipant {...props} />\n  } else {\n    return null\n  }\n}\n\nexport function ChangedTitle(props) {\n  const msgstring = escapeHtml(\n    pgettext(\n      \"event message\",\n      \"Thread title has been changed from %(old_title)s.\"\n    )\n  )\n  const oldTitle = interpolate(\n    ITEM_SPAN,\n    {\n      name: escapeHtml(props.post.event_context.old_title),\n    },\n    true\n  )\n  const message = interpolate(\n    msgstring,\n    {\n      old_title: oldTitle,\n    },\n    true\n  )\n\n  return (\n    <p\n      className=\"event-message\"\n      dangerouslySetInnerHTML={{ __html: message }}\n    />\n  )\n}\n\nexport function Moved(props) {\n  const msgstring = escapeHtml(\n    pgettext(\"event message\", \"Thread has been moved from %(from_category)s.\")\n  )\n  const fromCategory = interpolate(\n    ITEM_LINK,\n    {\n      url: escapeHtml(props.post.event_context.from_category.url),\n      name: escapeHtml(props.post.event_context.from_category.name),\n    },\n    true\n  )\n\n  const message = interpolate(\n    msgstring,\n    {\n      from_category: fromCategory,\n    },\n    true\n  )\n\n  return (\n    <p\n      className=\"event-message\"\n      dangerouslySetInnerHTML={{ __html: message }}\n    />\n  )\n}\n\nexport function Merged(props) {\n  const msgstring = escapeHtml(\n    pgettext(\n      \"event message\",\n      \"The %(merged_thread)s thread has been merged into this thread.\"\n    )\n  )\n  const mergedThread = interpolate(\n    ITEM_SPAN,\n    {\n      name: escapeHtml(props.post.event_context.merged_thread),\n    },\n    true\n  )\n\n  const message = interpolate(\n    msgstring,\n    {\n      merged_thread: mergedThread,\n    },\n    true\n  )\n\n  return (\n    <p\n      className=\"event-message\"\n      dangerouslySetInnerHTML={{ __html: message }}\n    />\n  )\n}\n\nexport function ChangedOwner(props) {\n  const msgstring = escapeHtml(\n    pgettext(\"event message\", \"Changed thread owner to %(user)s.\")\n  )\n  const newOwner = interpolate(\n    ITEM_LINK,\n    {\n      url: escapeHtml(props.post.event_context.user.url),\n      name: escapeHtml(props.post.event_context.user.username),\n    },\n    true\n  )\n\n  const message = interpolate(\n    msgstring,\n    {\n      user: newOwner,\n    },\n    true\n  )\n\n  return (\n    <p\n      className=\"event-message\"\n      dangerouslySetInnerHTML={{ __html: message }}\n    />\n  )\n}\n\nexport function AddedParticipant(props) {\n  const msgstring = escapeHtml(\n    pgettext(\"event message\", \"Added %(user)s to thread.\")\n  )\n  const newOwner = interpolate(\n    ITEM_LINK,\n    {\n      url: escapeHtml(props.post.event_context.user.url),\n      name: escapeHtml(props.post.event_context.user.username),\n    },\n    true\n  )\n\n  const message = interpolate(\n    msgstring,\n    {\n      user: newOwner,\n    },\n    true\n  )\n\n  return (\n    <p\n      className=\"event-message\"\n      dangerouslySetInnerHTML={{ __html: message }}\n    />\n  )\n}\n\nexport function RemovedParticipant(props) {\n  const msgstring = escapeHtml(\n    pgettext(\"event message\", \"Removed %(user)s from thread.\")\n  )\n  const newOwner = interpolate(\n    ITEM_LINK,\n    {\n      url: escapeHtml(props.post.event_context.user.url),\n      name: escapeHtml(props.post.event_context.user.username),\n    },\n    true\n  )\n\n  const message = interpolate(\n    msgstring,\n    {\n      user: newOwner,\n    },\n    true\n  )\n\n  return (\n    <p\n      className=\"event-message\"\n      dangerouslySetInnerHTML={{ __html: message }}\n    />\n  )\n}\n","import React from \"react\"\n\nexport default function ({ post }) {\n  if (post.is_read) return null\n\n  return (\n    <div className=\"event-label\">\n      <span className=\"label label-unread\">\n        {pgettext(\"event unread label\", \"New event\")}\n      </span>\n    </div>\n  )\n}\n","import React from \"react\"\nimport ajax from \"misago/services/ajax\"\n\nexport default class extends React.Component {\n  constructor(props) {\n    super(props)\n\n    this.initialized = false\n    this.primed = false\n    this.observer = null\n  }\n\n  initialize = (element) => {\n    this.initialized = true\n\n    this.observer = new IntersectionObserver((entries) =>\n      entries.forEach(this.callback)\n    )\n    this.observer.observe(element)\n  }\n\n  callback = (entry) => {\n    if (!entry.isIntersecting || this.props.post.is_read || this.primed) {\n      return\n    }\n\n    window.setTimeout(() => {\n      ajax.post(this.props.post.api.read)\n    }, 0)\n\n    this.primed = true\n    this.destroy()\n  }\n\n  destroy() {\n    if (this.observer) {\n      this.observer.disconnect()\n      this.observer = null\n    }\n  }\n\n  componentWillUnmount() {\n    this.destroy()\n  }\n\n  render() {\n    const ready = !this.initialized && !this.primed && !this.props.post.is_read\n\n    return (\n      <div\n        className={this.props.className}\n        ref={(node) => {\n          if (node && ready) {\n            this.initialize(node)\n          }\n        }}\n      >\n        {this.props.children}\n      </div>\n    )\n  }\n}\n","import React from \"react\"\nimport Icon from \"./icon\"\nimport Info from \"./info\"\nimport Message from \"./message\"\nimport UnreadLabel from \"./unread-label\"\nimport Waypoint from \"../waypoint\"\n\nexport default function (props) {\n  let className = \"event\"\n  if (props.post.isDeleted) {\n    className = \"hide\"\n  } else if (props.post.is_hidden) {\n    className = \"event post-hidden\"\n  }\n\n  return (\n    <li id={\"post-\" + props.post.id} className={className}>\n      <UnreadLabel post={props.post} />\n      <div className=\"event-body\">\n        <div className=\"event-icon\">\n          <Icon {...props} />\n        </div>\n        <Waypoint className=\"event-content\" post={props.post}>\n          <Message {...props} />\n          <Info {...props} />\n        </Waypoint>\n      </div>\n    </li>\n  )\n}\n","import React from \"react\"\nimport misago from \"misago\"\nimport escapeHtml from \"misago/utils/escape-html\"\nimport formatFilesize from \"misago/utils/file-size\"\n\nconst DATE_ABBR = '<abbr title=\"%(absolute)s\">%(relative)s</abbr>'\nconst USER_SPAN = '<span class=\"item-title\">%(user)s</span>'\nconst USER_URL = '<a href=\"%(url)s\" class=\"item-title\">%(user)s</a>'\n\nexport default function (props) {\n  return (\n    <div className=\"col-xs-12 col-md-6\">\n      <AttachmentPreview {...props} />\n      <div className=\"post-attachment\">\n        <a\n          href={props.attachment.url.index}\n          className=\"attachment-name item-title\"\n          target=\"_blank\"\n        >\n          {props.attachment.filename}\n        </a>\n        <AttachmentDetails {...props} />\n      </div>\n    </div>\n  )\n}\n\nexport function AttachmentPreview(props) {\n  if (props.attachment.is_image) {\n    return (\n      <div className=\"post-attachment-preview\">\n        <AttachmentThumbnail {...props} />\n      </div>\n    )\n  } else {\n    return (\n      <div className=\"post-attachment-preview\">\n        <AttachmentIcon {...props} />\n      </div>\n    )\n  }\n}\n\nexport function AttachmentIcon(props) {\n  return (\n    <a href={props.attachment.url.index} className=\"material-icon\">\n      insert_drive_file\n    </a>\n  )\n}\n\nexport function AttachmentThumbnail(props) {\n  const url = props.attachment.url.thumb || props.attachment.url.index\n  return (\n    <a\n      className=\"post-thumbnail\"\n      href={props.attachment.url.index}\n      target=\"_blank\"\n      style={{ backgroundImage: 'url(\"' + escapeHtml(url) + '\")' }}\n    />\n  )\n}\n\nexport function AttachmentDetails(props) {\n  let user = null\n  if (props.attachment.url.uploader) {\n    user = interpolate(\n      USER_URL,\n      {\n        url: escapeHtml(props.attachment.url.uploader),\n        user: escapeHtml(props.attachment.uploader_name),\n      },\n      true\n    )\n  } else {\n    user = interpolate(\n      USER_SPAN,\n      {\n        user: escapeHtml(props.attachment.uploader_name),\n      },\n      true\n    )\n  }\n\n  const date = interpolate(\n    DATE_ABBR,\n    {\n      absolute: escapeHtml(props.attachment.uploaded_on.format(\"LLL\")),\n      relative: escapeHtml(props.attachment.uploaded_on.fromNow()),\n    },\n    true\n  )\n\n  const message = interpolate(\n    escapeHtml(\n      pgettext(\n        \"post attachment\",\n        \"%(filetype)s, %(size)s, uploaded by %(uploader)s %(uploaded_on)s.\"\n      )\n    ),\n    {\n      filetype: props.attachment.filetype,\n      size: formatFilesize(props.attachment.size),\n      uploader: user,\n      uploaded_on: date,\n    },\n    true\n  )\n\n  return (\n    <p\n      className=\"post-attachment-description\"\n      dangerouslySetInnerHTML={{ __html: message }}\n    />\n  )\n}\n","import React from \"react\"\nimport batch from \"misago/utils/batch\"\nimport Attachment from \"./attachment\"\n\nexport default function (props) {\n  if (!isVisible(props.post)) {\n    return null\n  }\n\n  return (\n    <div className=\"post-attachments\">\n      {batch(props.post.attachments, 2).map((row) => {\n        const key = row\n          .map((a) => {\n            return a ? a.id : 0\n          })\n          .join(\"_\")\n        return <Row key={key} row={row} />\n      })}\n    </div>\n  )\n}\n\nexport function isVisible(post) {\n  return (!post.is_hidden || post.acl.can_see_hidden) && post.attachments\n}\n\nexport function Row(props) {\n  return (\n    <div className=\"row\">\n      {props.row.map((attachment) => {\n        return (\n          <Attachment\n            attachment={attachment}\n            key={attachment ? attachment.id : 0}\n          />\n        )\n      })}\n    </div>\n  )\n}\n","import React from \"react\"\nimport Waypoint from \"../waypoint\"\nimport MisagoMarkup from \"misago/components/misago-markup\"\nimport escapeHtml from \"misago/utils/escape-html\"\n\nconst HIDDEN_BY_URL = '<a href=\"%(url)s\" class=\"item-title\">%(user)s</a>'\nconst HIDDEN_BY_SPAN = '<span class=\"item-title\">%(user)s</span>'\nconst HIDDEN_ON =\n  '<abbr class=\"last-title\" title=\"%(absolute)s\">%(relative)s</abbr>'\n\nexport default function (props) {\n  if (props.post.is_hidden && !props.post.acl.can_see_hidden) {\n    return <Hidden {...props} />\n  } else if (props.post.content) {\n    return <Default {...props} />\n  } else {\n    return <Invalid {...props} />\n  }\n}\n\nexport function Default({ post }) {\n  const poster = \"@\" + (post.poster ? post.poster.username : post.poster_name)\n\n  return (\n    <Waypoint className=\"post-body\" post={post}>\n      <MisagoMarkup author={poster} markup={post.content} />\n    </Waypoint>\n  )\n}\n\nexport function Hidden(props) {\n  let user = null\n  if (props.post.hidden_by) {\n    user = interpolate(\n      HIDDEN_BY_URL,\n      {\n        url: escapeHtml(props.post.url.hidden_by),\n        user: escapeHtml(props.post.hidden_by_name),\n      },\n      true\n    )\n  } else {\n    user = interpolate(\n      HIDDEN_BY_SPAN,\n      {\n        user: escapeHtml(props.post.hidden_by_name),\n      },\n      true\n    )\n  }\n\n  const date = interpolate(\n    HIDDEN_ON,\n    {\n      absolute: escapeHtml(props.post.hidden_on.format(\"LLL\")),\n      relative: escapeHtml(props.post.hidden_on.fromNow()),\n    },\n    true\n  )\n\n  const message = interpolate(\n    escapeHtml(\n      pgettext(\"post body hidden\", \"Hidden by %(hidden_by)s %(hidden_on)s.\")\n    ),\n    {\n      hidden_by: user,\n      hidden_on: date,\n    },\n    true\n  )\n\n  return (\n    <Waypoint className=\"post-body post-body-hidden\" post={props.post}>\n      <p className=\"lead\">\n        {pgettext(\n          \"post body hidden\",\n          \"This post is hidden. You cannot see its contents.\"\n        )}\n      </p>\n      <p className=\"text-muted\" dangerouslySetInnerHTML={{ __html: message }} />\n    </Waypoint>\n  )\n}\n\nexport function Invalid(props) {\n  return (\n    <Waypoint className=\"post-body post-body-invalid\" post={props.post}>\n      <p className=\"lead\">\n        {pgettext(\n          \"post body invalid\",\n          \"This post's contents cannot be displayed.\"\n        )}\n      </p>\n      <p className=\"text-muted\">\n        {pgettext(\n          \"post body invalid\",\n          \"This error is caused by invalid post content manipulation.\"\n        )}\n      </p>\n    </Waypoint>\n  )\n}\n","import React from \"react\"\n\nexport function FlagBestAnswer({ post, thread, user }) {\n  if (!(isVisible(post) && post.id === thread.best_answer)) {\n    return null\n  }\n\n  let message = null\n  if (user.id && thread.best_answer_marked_by === user.id) {\n    message = interpolate(\n      pgettext(\n        \"post best answer flag\",\n        \"Marked as best answer by you %(marked_on)s.\"\n      ),\n      {\n        marked_on: thread.best_answer_marked_on.fromNow(),\n      },\n      true\n    )\n  } else {\n    message = interpolate(\n      pgettext(\n        \"post best answer flag\",\n        \"Marked as best answer by %(marked_by)s %(marked_on)s.\"\n      ),\n      {\n        marked_by: thread.best_answer_marked_by_name,\n        marked_on: thread.best_answer_marked_on.fromNow(),\n      },\n      true\n    )\n  }\n\n  return (\n    <div className=\"post-status-message post-status-best-answer\">\n      <span className=\"material-icon\">check_box</span>\n      <p>{message}</p>\n    </div>\n  )\n}\n\nexport function FlagHidden(props) {\n  if (!(isVisible(props.post) && props.post.is_hidden)) {\n    return null\n  }\n\n  return (\n    <div className=\"post-status-message post-status-hidden\">\n      <span className=\"material-icon\">visibility_off</span>\n      <p>\n        {pgettext(\n          \"post hidden flag\",\n          \"This post is hidden. Only users with permission may see its contents.\"\n        )}\n      </p>\n    </div>\n  )\n}\n\nexport function FlagUnapproved(props) {\n  if (!(isVisible(props.post) && props.post.is_unapproved)) {\n    return null\n  }\n\n  return (\n    <div className=\"post-status-message post-status-unapproved\">\n      <span className=\"material-icon\">remove_circle_outline</span>\n      <p>\n        {pgettext(\n          \"post unapproved flag\",\n          \"This post is unapproved. Only users with permission to approve posts and its author may see its contents.\"\n        )}\n      </p>\n    </div>\n  )\n}\n\nexport function FlagProtected(props) {\n  if (!(isVisible(props.post) && props.post.is_protected)) {\n    return null\n  }\n\n  return (\n    <div className=\"post-status-message post-status-protected visible-xs-block\">\n      <span className=\"material-icon\">lock_outline</span>\n      <p>\n        {pgettext(\n          \"post protected flag\",\n          \"This post is protected. Only moderators may change it.\"\n        )}\n      </p>\n    </div>\n  )\n}\n\nexport function isVisible(post) {\n  return !post.is_hidden || post.acl.can_see_hidden\n}\n","import moment from \"moment\"\nimport * as thread from \"misago/reducers/thread\"\nimport * as post from \"misago/reducers/post\"\nimport ajax from \"misago/services/ajax\"\nimport snackbar from \"misago/services/snackbar\"\nimport store from \"misago/services/store\"\n\nexport function approve(props) {\n  store.dispatch(\n    post.patch(props.post, {\n      is_unapproved: false,\n    })\n  )\n\n  const ops = [{ op: \"replace\", path: \"is-unapproved\", value: false }]\n\n  const previousState = {\n    is_unapproved: props.post.is_unapproved,\n  }\n\n  patch(props, ops, previousState)\n}\n\nexport function protect(props) {\n  store.dispatch(\n    post.patch(props.post, {\n      is_protected: true,\n    })\n  )\n\n  const ops = [{ op: \"replace\", path: \"is-protected\", value: true }]\n\n  const previousState = {\n    is_protected: props.post.is_protected,\n  }\n\n  patch(props, ops, previousState)\n}\n\nexport function unprotect(props) {\n  store.dispatch(\n    post.patch(props.post, {\n      is_protected: false,\n    })\n  )\n\n  const ops = [{ op: \"replace\", path: \"is-protected\", value: false }]\n\n  const previousState = {\n    is_protected: props.post.is_protected,\n  }\n\n  patch(props, ops, previousState)\n}\n\nexport function hide(props) {\n  store.dispatch(\n    post.patch(props.post, {\n      is_hidden: true,\n      hidden_on: moment(),\n      hidden_by_name: props.user.username,\n      url: Object.assign(props.post.url, {\n        hidden_by: props.user.url,\n      }),\n    })\n  )\n\n  const ops = [{ op: \"replace\", path: \"is-hidden\", value: true }]\n\n  const previousState = {\n    is_hidden: props.post.is_hidden,\n    hidden_on: props.post.hidden_on,\n    hidden_by_name: props.post.hidden_by_name,\n    url: props.post.url,\n  }\n\n  patch(props, ops, previousState)\n}\n\nexport function unhide(props) {\n  store.dispatch(\n    post.patch(props.post, {\n      is_hidden: false,\n    })\n  )\n\n  const ops = [{ op: \"replace\", path: \"is-hidden\", value: false }]\n\n  const previousState = {\n    is_hidden: props.post.is_hidden,\n  }\n\n  patch(props, ops, previousState)\n}\n\nexport function like(props) {\n  const lastLikes = props.post.last_likes || []\n  const concatedLikes = [props.user].concat(lastLikes)\n  const finalLikes =\n    concatedLikes.length > 3 ? concatedLikes.slice(0, -1) : concatedLikes\n\n  store.dispatch(\n    post.patch(props.post, {\n      is_liked: true,\n      likes: props.post.likes + 1,\n      last_likes: finalLikes,\n    })\n  )\n\n  const ops = [{ op: \"replace\", path: \"is-liked\", value: true }]\n\n  const previousState = {\n    is_liked: props.post.is_liked,\n    likes: props.post.likes,\n    last_likes: props.post.last_likes,\n  }\n\n  patch(props, ops, previousState)\n}\n\nexport function unlike(props) {\n  store.dispatch(\n    post.patch(props.post, {\n      is_liked: false,\n      likes: props.post.likes - 1,\n      last_likes: props.post.last_likes.filter((user) => {\n        return !user.id || user.id !== props.user.id\n      }),\n    })\n  )\n\n  const ops = [{ op: \"replace\", path: \"is-liked\", value: false }]\n\n  const previousState = {\n    is_liked: props.post.is_liked,\n    likes: props.post.likes,\n    last_likes: props.post.last_likes,\n  }\n\n  patch(props, ops, previousState)\n}\n\nexport function patch(props, ops, previousState) {\n  ajax.patch(props.post.api.index, ops).then(\n    (newState) => {\n      store.dispatch(post.patch(props.post, newState))\n    },\n    (rejection) => {\n      if (rejection.status === 400) {\n        snackbar.error(rejection.detail[0])\n      } else {\n        snackbar.apiError(rejection)\n      }\n\n      store.dispatch(post.patch(props.post, previousState))\n    }\n  )\n}\n\nexport function remove(props) {\n  let confirmed = window.confirm(\n    pgettext(\n      \"post delete\",\n      \"Are you sure you want to delete this post? This action is not reversible!\"\n    )\n  )\n  if (!confirmed) {\n    return\n  }\n\n  store.dispatch(\n    post.patch(props.post, {\n      isDeleted: true,\n    })\n  )\n\n  ajax.delete(props.post.api.index).then(\n    () => {\n      snackbar.success(pgettext(\"post delete\", \"Post has been deleted.\"))\n    },\n    (rejection) => {\n      if (rejection.status === 400) {\n        snackbar.error(rejection.detail)\n      } else {\n        snackbar.apiError(rejection)\n      }\n\n      store.dispatch(\n        post.patch(props.post, {\n          isDeleted: false,\n        })\n      )\n    }\n  )\n}\n\nexport function markAsBestAnswer(props) {\n  const { post, user } = props\n\n  store.dispatch(\n    thread.update({\n      best_answer: post.id,\n      best_answer_is_protected: post.is_protected,\n      best_answer_marked_on: moment(),\n      best_answer_marked_by: user.id,\n      best_answer_marked_by_name: user.username,\n      best_answer_marked_by_slug: user.slug,\n    })\n  )\n\n  const ops = [\n    { op: \"replace\", path: \"best-answer\", value: post.id },\n    { op: \"add\", path: \"acl\", value: true },\n  ]\n\n  const previousState = {\n    best_answer: props.thread.best_answer,\n    best_answer_is_protected: props.thread.best_answer_is_protected,\n    best_answer_marked_on: props.thread.best_answer_marked_on,\n    best_answer_marked_by: props.thread.best_answer_marked_by,\n    best_answer_marked_by_name: props.thread.best_answer_marked_by_name,\n    best_answer_marked_by_slug: props.thread.best_answer_marked_by_slug,\n  }\n\n  patchThread(props, ops, previousState)\n}\n\nexport function unmarkBestAnswer(props) {\n  const { post } = props\n\n  store.dispatch(\n    thread.update({\n      best_answer: null,\n      best_answer_is_protected: false,\n      best_answer_marked_on: null,\n      best_answer_marked_by: null,\n      best_answer_marked_by_name: null,\n      best_answer_marked_by_slug: null,\n    })\n  )\n\n  const ops = [\n    { op: \"remove\", path: \"best-answer\", value: post.id },\n    { op: \"add\", path: \"acl\", value: true },\n  ]\n\n  const previousState = {\n    best_answer: props.thread.best_answer,\n    best_answer_is_protected: props.thread.best_answer_is_protected,\n    best_answer_marked_on: props.thread.best_answer_marked_on,\n    best_answer_marked_by: props.thread.best_answer_marked_by,\n    best_answer_marked_by_name: props.thread.best_answer_marked_by_name,\n    best_answer_marked_by_slug: props.thread.best_answer_marked_by_slug,\n  }\n\n  patchThread(props, ops, previousState)\n}\n\nexport function patchThread(props, ops, previousState) {\n  ajax.patch(props.thread.api.index, ops).then(\n    (newState) => {\n      if (newState.best_answer_marked_on) {\n        newState.best_answer_marked_on = moment(newState.best_answer_marked_on)\n      }\n      store.dispatch(thread.update(newState))\n    },\n    (rejection) => {\n      if (rejection.status === 400) {\n        snackbar.error(rejection.detail[0])\n      } else {\n        snackbar.apiError(rejection)\n      }\n\n      store.dispatch(thread.update(previousState))\n    }\n  )\n}\n","import React from \"react\"\nimport moment from \"moment\"\nimport Avatar from \"misago/components/avatar\"\nimport Message from \"misago/components/modal-message\"\nimport Loader from \"misago/components/modal-loader\"\nimport ajax from \"misago/services/ajax\"\n\nexport default class extends React.Component {\n  constructor(props) {\n    super(props)\n\n    this.state = {\n      isReady: false,\n\n      error: null,\n      likes: [],\n    }\n  }\n\n  componentDidMount() {\n    ajax.get(this.props.post.api.likes).then(\n      (data) => {\n        this.setState({\n          isReady: true,\n          likes: data.map(hydrateLike),\n        })\n      },\n      (rejection) => {\n        this.setState({\n          isReady: true,\n          error: rejection.detail,\n        })\n      }\n    )\n  }\n\n  render() {\n    if (this.state.error) {\n      return (\n        <ModalDialog className=\"modal-message\">\n          <Message message={this.state.error} />\n        </ModalDialog>\n      )\n    } else if (this.state.isReady) {\n      if (this.state.likes.length) {\n        return (\n          <ModalDialog className=\"modal-sm\" likes={this.state.likes}>\n            <LikesList likes={this.state.likes} />\n          </ModalDialog>\n        )\n      }\n\n      return (\n        <ModalDialog className=\"modal-message\">\n          <Message\n            message={pgettext(\n              \"post likes modal\",\n              \"No users have liked this post.\"\n            )}\n          />\n        </ModalDialog>\n      )\n    }\n\n    return (\n      <ModalDialog className=\"modal-sm\">\n        <Loader />\n      </ModalDialog>\n    )\n  }\n}\n\nexport function hydrateLike(data) {\n  return Object.assign({}, data, {\n    liked_on: moment(data.liked_on),\n  })\n}\n\nexport function ModalDialog({ className, children, likes }) {\n  let title = pgettext(\"post likes modal title\", \"Post Likes\")\n  if (likes) {\n    const likesCount = likes.length\n    const message = npgettext(\n      \"post likes modal\",\n      \"%(likes)s like\",\n      \"%(likes)s likes\",\n      likesCount\n    )\n\n    title = interpolate(message, { likes: likesCount }, true)\n  }\n\n  return (\n    <div className={\"modal-dialog \" + (className || \"\")} role=\"document\">\n      <div className=\"modal-content\">\n        <div className=\"modal-header\">\n          <button\n            aria-label={pgettext(\"modal\", \"Close\")}\n            className=\"close\"\n            data-dismiss=\"modal\"\n            type=\"button\"\n          >\n            <span aria-hidden=\"true\">&times;</span>\n          </button>\n          <h4 className=\"modal-title\">{title}</h4>\n        </div>\n        {children}\n      </div>\n    </div>\n  )\n}\n\nexport function LikesList(props) {\n  return (\n    <div className=\"modal-body modal-post-likers\">\n      <ul className=\"media-list\">\n        {props.likes.map((like) => {\n          return <LikeDetails key={like.id} {...like} />\n        })}\n      </ul>\n    </div>\n  )\n}\n\nexport function LikeDetails(props) {\n  if (props.url) {\n    const user = {\n      id: props.liker_id,\n      avatars: props.avatars,\n    }\n\n    return (\n      <li className=\"media\">\n        <div className=\"media-left\">\n          <a className=\"user-avatar\" href={props.url}>\n            <Avatar size=\"50\" user={user} />\n          </a>\n        </div>\n        <div className=\"media-body\">\n          <a className=\"item-title\" href={props.url}>\n            {props.username}\n          </a>{\" \"}\n          <LikeDate likedOn={props.liked_on} />\n        </div>\n      </li>\n    )\n  }\n\n  return (\n    <li className=\"media\">\n      <div className=\"media-left\">\n        <span className=\"user-avatar\">\n          <Avatar size=\"50\" />\n        </span>\n      </div>\n      <div className=\"media-body\">\n        <strong>{props.username}</strong> <LikeDate likedOn={props.liked_on} />\n      </div>\n    </li>\n  )\n}\n\nexport function LikeDate(props) {\n  return (\n    <span className=\"text-muted\" title={props.likedOn.format(\"LLL\")}>\n      {props.likedOn.fromNow()}\n    </span>\n  )\n}\n","import React from \"react\"\nimport * as actions from \"./controls/actions\"\nimport LikesModal from \"misago/components/post-likes\"\nimport modal from \"misago/services/modal\"\nimport posting from \"misago/services/posting\"\n\nexport default function (props) {\n  if (!isVisible(props.post)) return null\n\n  return (\n    <div className=\"post-footer\">\n      <MarkAsBestAnswer {...props} />\n      <MarkAsBestAnswerCompact {...props} />\n      <Like {...props} />\n      <Likes\n        lastLikes={props.post.last_likes}\n        likes={props.post.likes}\n        {...props}\n      />\n      <LikesCompact likes={props.post.likes} {...props} />\n      <Reply {...props} />\n      <Quote {...props} />\n      <Edit {...props} />\n    </div>\n  )\n}\n\nexport function isVisible(post) {\n  return (\n    (!post.is_hidden || post.acl.can_see_hidden) &&\n    (post.acl.can_reply ||\n      post.acl.can_edit ||\n      (post.acl.can_see_likes && (post.last_likes || []).length) ||\n      post.acl.can_like)\n  )\n}\n\nexport class MarkAsBestAnswer extends React.Component {\n  onClick = () => {\n    actions.markAsBestAnswer(this.props)\n  }\n\n  render() {\n    const { post, thread } = this.props\n\n    if (!thread.acl.can_mark_best_answer) return null\n    if (!post.acl.can_mark_as_best_answer) return null\n    if (thread.best_answer && !thread.acl.can_change_best_answer) return null\n\n    return (\n      <button\n        className=\"hidden-xs btn btn-default btn-sm pull-left\"\n        disabled={this.props.post.isBusy || post.id === thread.best_answer}\n        onClick={this.onClick}\n        type=\"button\"\n      >\n        <span className=\"material-icon\">check_box</span>\n        {pgettext(\"post footer btn\", \"Best answer\")}\n      </button>\n    )\n  }\n}\n\nexport class MarkAsBestAnswerCompact extends React.Component {\n  onClick = () => {\n    actions.markAsBestAnswer(this.props)\n  }\n\n  render() {\n    const { post, thread } = this.props\n\n    if (!thread.acl.can_mark_best_answer) return null\n    if (!post.acl.can_mark_as_best_answer) return null\n    if (thread.best_answer && !thread.acl.can_change_best_answer) return null\n\n    return (\n      <button\n        className=\"visible-xs-inline-block btn btn-default btn-sm pull-left\"\n        disabled={this.props.post.isBusy || post.id === thread.best_answer}\n        onClick={this.onClick}\n        type=\"button\"\n      >\n        <span className=\"material-icon\">check_box</span>\n      </button>\n    )\n  }\n}\n\nexport class Like extends React.Component {\n  onClick = () => {\n    if (this.props.post.is_liked) {\n      actions.unlike(this.props)\n    } else {\n      actions.like(this.props)\n    }\n  }\n\n  render() {\n    if (!this.props.post.acl.can_like) return null\n\n    let className = \"btn btn-default btn-sm pull-left\"\n    if (this.props.post.is_liked) {\n      className = \"btn btn-success btn-sm pull-left\"\n    }\n\n    return (\n      <button\n        className={className}\n        disabled={this.props.post.isBusy}\n        onClick={this.onClick}\n        type=\"button\"\n      >\n        {this.props.post.is_liked\n          ? pgettext(\"post footer btn\", \"Liked\")\n          : pgettext(\"post footer btn\", \"Like\")}\n      </button>\n    )\n  }\n}\n\nexport class Likes extends React.Component {\n  onClick = () => {\n    modal.show(<LikesModal post={this.props.post} />)\n  }\n\n  render() {\n    const hasLikes = (this.props.post.last_likes || []).length > 0\n    if (!this.props.post.acl.can_see_likes || !hasLikes) return null\n\n    if (this.props.post.acl.can_see_likes === 2) {\n      return (\n        <button\n          className=\"btn btn-link btn-sm pull-left hidden-xs\"\n          onClick={this.onClick}\n          type=\"button\"\n        >\n          {getLikesMessage(this.props.likes, this.props.lastLikes)}\n        </button>\n      )\n    }\n\n    return (\n      <p className=\"pull-left hidden-xs\">\n        {getLikesMessage(this.props.likes, this.props.lastLikes)}\n      </p>\n    )\n  }\n}\n\nexport class LikesCompact extends Likes {\n  render() {\n    const hasLikes = (this.props.post.last_likes || []).length > 0\n    if (!this.props.post.acl.can_see_likes || !hasLikes) return null\n\n    if (this.props.post.acl.can_see_likes === 2) {\n      return (\n        <button\n          className=\"btn btn-link btn-sm likes-compact pull-left visible-xs-block\"\n          onClick={this.onClick}\n          type=\"button\"\n        >\n          <span className=\"material-icon\">favorite</span>\n          {this.props.likes}\n        </button>\n      )\n    }\n\n    return (\n      <p className=\"likes-compact pull-left visible-xs-block\">\n        <span className=\"material-icon\">favorite</span>\n        {this.props.likes}\n      </p>\n    )\n  }\n}\n\nexport function getLikesMessage(likes, users) {\n  const usernames = users.slice(0, 3).map((u) => u.username)\n\n  if (usernames.length == 1) {\n    return interpolate(\n      pgettext(\"post likes\", \"%(user)s likes this.\"),\n      {\n        user: usernames[0],\n      },\n      true\n    )\n  }\n\n  const hiddenLikes = likes - usernames.length\n\n  const otherUsers = usernames.slice(0, -1).join(\", \")\n  const lastUser = usernames.slice(-1)[0]\n\n  const usernamesList = interpolate(\n    pgettext(\"post likes\", \"%(users)s and %(last_user)s\"),\n    {\n      users: otherUsers,\n      last_user: lastUser,\n    },\n    true\n  )\n\n  if (hiddenLikes === 0) {\n    return interpolate(\n      pgettext(\"post likes\", \"%(users)s like this.\"),\n      {\n        users: usernamesList,\n      },\n      true\n    )\n  }\n\n  const message = npgettext(\n    \"post likes\",\n    \"%(users)s and %(likes)s other user like this.\",\n    \"%(users)s and %(likes)s other users like this.\",\n    hiddenLikes\n  )\n\n  return interpolate(\n    message,\n    {\n      users: usernames.join(\", \"),\n      likes: hiddenLikes,\n    },\n    true\n  )\n}\n\nexport class Reply extends React.Component {\n  onClick = () => {\n    posting.open({\n      mode: \"REPLY\",\n\n      thread: this.props.thread,\n      config: this.props.thread.api.editor,\n      submit: this.props.thread.api.posts.index,\n    })\n  }\n\n  render() {\n    if (this.props.post.acl.can_reply) {\n      return (\n        <button\n          className=\"btn btn-default btn-sm pull-right\"\n          type=\"button\"\n          onClick={this.onClick}\n        >\n          {pgettext(\"post footer btn\", \"Reply\")}\n        </button>\n      )\n    } else {\n      return null\n    }\n  }\n}\n\nexport class Quote extends React.Component {\n  onClick = () => {\n    posting.open({\n      mode: \"QUOTE\",\n\n      thread: this.props.thread,\n      config: this.props.thread.api.editor,\n      submit: this.props.thread.api.posts.index,\n\n      context: {\n        reply: this.props.post.id,\n      },\n    })\n  }\n\n  render() {\n    if (this.props.post.acl.can_reply) {\n      return (\n        <button\n          className=\"btn btn-default btn-sm pull-right\"\n          type=\"button\"\n          onClick={this.onClick}\n        >\n          {pgettext(\"post footer btn\", \"Quote\")}\n        </button>\n      )\n    } else {\n      return null\n    }\n  }\n}\n\nexport class Edit extends React.Component {\n  onClick = () => {\n    posting.open({\n      mode: \"EDIT\",\n\n      thread: this.props.thread,\n      post: this.props.post,\n      config: this.props.post.api.editor,\n      submit: this.props.post.api.index,\n    })\n  }\n\n  render() {\n    if (this.props.post.acl.can_edit) {\n      return (\n        <button\n          className=\"hidden-xs btn btn-default btn-sm pull-right\"\n          type=\"button\"\n          onClick={this.onClick}\n        >\n          {pgettext(\"post footer btn\", \"Edit\")}\n        </button>\n      )\n    } else {\n      return null\n    }\n  }\n}\n","import React from \"react\"\nimport Form from \"misago/components/form\"\nimport FormGroup from \"misago/components/form-group\"\nimport * as post from \"misago/reducers/post\"\nimport ajax from \"misago/services/ajax\"\nimport modal from \"misago/services/modal\"\nimport snackbar from \"misago/services/snackbar\"\nimport store from \"misago/services/store\"\n\nexport default class extends Form {\n  constructor(props) {\n    super(props)\n\n    this.state = {\n      isLoading: false,\n\n      url: \"\",\n\n      validators: {\n        url: [],\n      },\n      errors: {},\n    }\n  }\n\n  clean() {\n    if (!this.state.url.trim().length) {\n      snackbar.error(\n        pgettext(\n          \"post move modal\",\n          \"You have to enter link to the other thread.\"\n        )\n      )\n      return false\n    }\n\n    return true\n  }\n\n  send() {\n    return ajax.post(this.props.thread.api.posts.move, {\n      new_thread: this.state.url,\n      posts: [this.props.post.id],\n    })\n  }\n\n  handleSuccess(success) {\n    store.dispatch(\n      post.patch(this.props.post, {\n        isDeleted: true,\n      })\n    )\n\n    modal.hide()\n\n    snackbar.success(\n      pgettext(\n        \"post move modal\",\n        \"Selected post was moved to the other thread.\"\n      )\n    )\n  }\n\n  handleError(rejection) {\n    if (rejection.status === 400) {\n      snackbar.error(rejection.detail)\n    } else {\n      snackbar.apiError(rejection)\n    }\n  }\n\n  onUrlChange = (event) => {\n    this.changeValue(\"url\", event.target.value)\n  }\n\n  render() {\n    return (\n      <div className=\"modal-dialog\" role=\"document\">\n        <form onSubmit={this.handleSubmit}>\n          <div className=\"modal-content\">\n            <ModalHeader />\n            <div className=\"modal-body\">\n              <FormGroup\n                for=\"id_url\"\n                label={pgettext(\n                  \"post move modal field\",\n                  \"Link to thread you want to move post to\"\n                )}\n              >\n                <input\n                  className=\"form-control\"\n                  disabled={this.state.isLoading}\n                  id=\"id_url\"\n                  onChange={this.onUrlChange}\n                  value={this.state.url}\n                />\n              </FormGroup>\n            </div>\n            <div className=\"modal-footer\">\n              <button\n                className=\"btn btn-primary\"\n                disabled={this.state.isLoading}\n              >\n                {pgettext(\"post move modal btn\", \"Move post\")}\n              </button>\n            </div>\n          </div>\n        </form>\n      </div>\n    )\n  }\n}\n\nexport function ModalHeader(props) {\n  return (\n    <div className=\"modal-header\">\n      <button\n        aria-label={pgettext(\"modal\", \"Close\")}\n        className=\"close\"\n        data-dismiss=\"modal\"\n        type=\"button\"\n      >\n        <span aria-hidden=\"true\">&times;</span>\n      </button>\n      <h4 className=\"modal-title\">\n        {pgettext(\"post move modal title\", \"Move post\")}\n      </h4>\n    </div>\n  )\n}\n","import React from \"react\"\n\nexport default function (props) {\n  return (\n    <div className=\"modal-body post-changelog-diff\">\n      <ul className=\"list-unstyled\">\n        {props.diff.map((item, i) => {\n          return <DiffItem item={item} key={i} />\n        })}\n      </ul>\n    </div>\n  )\n}\n\nexport function DiffItem(props) {\n  if (props.item[0] === \"?\") return null\n\n  return (\n    <li className={getItemClassName(props.item)}>{cleanItem(props.item)}</li>\n  )\n}\n\nexport function getItemClassName(item) {\n  let className = \"diff-item\"\n  if (item[0] === \"-\") {\n    className += \" diff-item-sub\"\n  } else if (item[0] === \"+\") {\n    className += \" diff-item-add\"\n  }\n  return className\n}\n\nexport function cleanItem(item) {\n  return item.substr(2)\n}\n","import React from \"react\"\nimport Button from \"misago/components/button\"\n\nexport default class extends React.Component {\n  onClick = () => {\n    this.props.revertEdit(this.props.edit.id)\n  }\n\n  render() {\n    if (!this.props.canRevert) return null\n\n    return (\n      <div className=\"modal-footer visible-xs-block\">\n        <Button\n          className=\"btn-default btn-sm btn-block\"\n          disabled={this.props.disabled}\n          onClick={this.onClick}\n          title={pgettext(\n            \"post revert btn\",\n            \"Revert post to state from before this edit.\"\n          )}\n        >\n          {pgettext(\"post revert btn\", \"Revert\")}\n        </Button>\n      </div>\n    )\n  }\n}\n","import React from \"react\"\nimport Button from \"misago/components/button\"\nimport escapeHtml from \"misago/utils/escape-html\"\n\nconst DATE_ABBR = '<abbr title=\"%(absolute)s\">%(relative)s</abbr>'\nconst USER_SPAN = '<span class=\"item-title\">%(user)s</span>'\nconst USER_URL = '<a href=\"%(url)s\" class=\"item-title\">%(user)s</a>'\n\nexport default class extends React.Component {\n  goLast = () => {\n    this.props.goToEdit()\n  }\n\n  goForward = () => {\n    this.props.goToEdit(this.props.edit.next)\n  }\n\n  goBack = () => {\n    this.props.goToEdit(this.props.edit.previous)\n  }\n\n  revertEdit = () => {\n    this.props.revertEdit(this.props.edit.id)\n  }\n\n  render() {\n    return (\n      <div className=\"modal-toolbar post-changelog-toolbar\">\n        <div className=\"row\">\n          <div className=\"col-xs-12 col-sm-4\">\n            <div className=\"row\">\n              <div className=\"col-xs-4\">\n                <GoBackBtn\n                  disabled={this.props.disabled}\n                  edit={this.props.edit}\n                  onClick={this.goBack}\n                />\n              </div>\n              <div className=\"col-xs-4\">\n                <GoForwardBtn\n                  disabled={this.props.disabled}\n                  edit={this.props.edit}\n                  onClick={this.goForward}\n                />\n              </div>\n              <div className=\"col-xs-4\">\n                <GoLastBtn\n                  disabled={this.props.disabled}\n                  edit={this.props.edit}\n                  onClick={this.goLast}\n                />\n              </div>\n            </div>\n          </div>\n          <div className=\"col-xs-12 col-sm-5 xs-margin-top-half post-change-label\">\n            <Label edit={this.props.edit} />\n          </div>\n          <RevertBtn\n            canRevert={this.props.canRevert}\n            disabled={this.props.disabled}\n            onClick={this.revertEdit}\n          />\n        </div>\n      </div>\n    )\n  }\n}\n\nexport function GoBackBtn(props) {\n  return (\n    <Button\n      className=\"btn-default btn-block btn-icon btn-sm\"\n      disabled={props.disabled || !props.edit.previous}\n      onClick={props.onClick}\n      title={pgettext(\"post history modal btn\", \"See previous change\")}\n    >\n      <span className=\"material-icon\">chevron_left</span>\n    </Button>\n  )\n}\n\nexport function GoForwardBtn(props) {\n  return (\n    <Button\n      className=\"btn-default btn-block btn-icon btn-sm\"\n      disabled={props.disabled || !props.edit.next}\n      onClick={props.onClick}\n      title={pgettext(\"post history modal btn\", \"See next change\")}\n    >\n      <span className=\"material-icon\">chevron_right</span>\n    </Button>\n  )\n}\n\nexport function GoLastBtn(props) {\n  return (\n    <Button\n      className=\"btn-default btn-block btn-icon btn-sm\"\n      disabled={props.disabled || !props.edit.next}\n      onClick={props.onClick}\n      title={pgettext(\"post history modal btn\", \"See previous change\")}\n    >\n      <span className=\"material-icon\">last_page</span>\n    </Button>\n  )\n}\n\nexport function RevertBtn(props) {\n  if (!props.canRevert) return null\n\n  return (\n    <div className=\"col-sm-3 hidden-xs\">\n      <Button\n        className=\"btn-default btn-sm btn-block\"\n        disabled={props.disabled}\n        onClick={props.onClick}\n        title={pgettext(\n          \"post revert btn\",\n          \"Revert post to state from before this edit.\"\n        )}\n      >\n        {pgettext(\"post revert btn\", \"Revert\")}\n      </Button>\n    </div>\n  )\n}\n\nexport function Label(props) {\n  let user = null\n  if (props.edit.url.editor) {\n    user = interpolate(\n      USER_URL,\n      {\n        url: escapeHtml(props.edit.url.editor),\n        user: escapeHtml(props.edit.editor_name),\n      },\n      true\n    )\n  } else {\n    user = interpolate(\n      USER_SPAN,\n      {\n        user: escapeHtml(props.edit.editor_name),\n      },\n      true\n    )\n  }\n\n  const date = interpolate(\n    DATE_ABBR,\n    {\n      absolute: escapeHtml(props.edit.edited_on.format(\"LLL\")),\n      relative: escapeHtml(props.edit.edited_on.fromNow()),\n    },\n    true\n  )\n\n  const message = interpolate(\n    escapeHtml(\n      pgettext(\"post history modal\", \"By %(edited_by)s %(edited_on)s.\")\n    ),\n    {\n      edited_by: user,\n      edited_on: date,\n    },\n    true\n  )\n\n  return <p dangerouslySetInnerHTML={{ __html: message }} />\n}\n","import React from \"react\"\nimport Diff from \"./diff\"\nimport Footer from \"./footer\"\nimport Toolbar from \"./toolbar\"\nimport { hydrateEdit } from \"./utils\"\nimport Message from \"misago/components/modal-message\"\nimport Loader from \"misago/components/modal-loader\"\nimport * as post from \"misago/reducers/post\"\nimport ajax from \"misago/services/ajax\"\nimport modal from \"misago/services/modal\"\nimport snackbar from \"misago/services/snackbar\"\nimport store from \"misago/services/store\"\n\nexport default class extends React.Component {\n  constructor(props) {\n    super(props)\n\n    this.state = {\n      isReady: false,\n      isBusy: true,\n\n      canRevert: props.post.acl.can_edit,\n\n      error: null,\n      edit: null,\n    }\n  }\n\n  componentDidMount() {\n    this.goToEdit()\n  }\n\n  goToEdit = (edit = null) => {\n    this.setState({\n      isBusy: true,\n    })\n\n    let url = this.props.post.api.edits\n    if (edit !== null) {\n      url += \"?edit=\" + edit\n    }\n\n    ajax.get(url).then(\n      (data) => {\n        this.setState({\n          isReady: true,\n          isBusy: false,\n          edit: hydrateEdit(data),\n        })\n      },\n      (rejection) => {\n        this.setState({\n          isReady: true,\n          isBusy: false,\n          error: rejection.detail,\n        })\n      }\n    )\n  }\n\n  revertEdit = (edit) => {\n    if (this.state.isBusy) return\n\n    const confirmation = window.confirm(\n      pgettext(\n        \"post revert\",\n        \"Are you sure you with to revert this post to the state from before this edit?\"\n      )\n    )\n    if (!confirmation) return\n\n    this.setState({\n      isBusy: true,\n    })\n\n    const url = this.props.post.api.edits + \"?edit=\" + edit\n    ajax.post(url).then(\n      (data) => {\n        const hydratedPost = post.hydrate(data)\n        store.dispatch(post.patch(data, hydratedPost))\n\n        snackbar.success(\n          pgettext(\"post revert\", \"Post has been reverted to previous state.\")\n        )\n        modal.hide()\n      },\n      (rejection) => {\n        snackbar.apiError(rejection)\n\n        this.setState({\n          isBusy: false,\n        })\n      }\n    )\n  }\n\n  render() {\n    if (this.state.error) {\n      return (\n        <ModalDialog className=\"modal-dialog modal-message\">\n          <Message message={this.state.error} />\n        </ModalDialog>\n      )\n    } else if (this.state.isReady) {\n      return (\n        <ModalDialog>\n          <Toolbar\n            canRevert={this.state.canRevert}\n            disabled={this.state.isBusy}\n            edit={this.state.edit}\n            goToEdit={this.goToEdit}\n            revertEdit={this.revertEdit}\n          />\n          <Diff diff={this.state.edit.diff} />\n          <Footer\n            canRevert={this.state.canRevert}\n            disabled={this.state.isBusy}\n            edit={this.state.edit}\n            revertEdit={this.revertEdit}\n          />\n        </ModalDialog>\n      )\n    }\n\n    return (\n      <ModalDialog>\n        <Loader />\n      </ModalDialog>\n    )\n  }\n}\n\nexport function ModalDialog(props) {\n  return (\n    <div className={props.className || \"modal-dialog\"} role=\"document\">\n      <div className=\"modal-content\">\n        <div className=\"modal-header\">\n          <button\n            aria-label={pgettext(\"modal\", \"Close\")}\n            className=\"close\"\n            data-dismiss=\"modal\"\n            type=\"button\"\n          >\n            <span aria-hidden=\"true\">&times;</span>\n          </button>\n          <h4 className=\"modal-title\">\n            {pgettext(\"post history modal title\", \"Post edits history\")}\n          </h4>\n        </div>\n        {props.children}\n      </div>\n    </div>\n  )\n}\n","import moment from \"moment\"\n\nexport function hydrateEdit(json) {\n  return Object.assign({}, json, {\n    edited_on: moment(json.edited_on),\n  })\n}\n","import React from \"react\"\nimport Button from \"misago/components/button\"\nimport Form from \"misago/components/form\"\nimport FormGroup from \"misago/components/form-group\"\nimport CategorySelect from \"misago/components/category-select\"\nimport ModalLoader from \"misago/components/modal-loader\"\nimport Select from \"misago/components/select\"\nimport * as post from \"misago/reducers/post\"\nimport ajax from \"misago/services/ajax\"\nimport modal from \"misago/services/modal\"\nimport snackbar from \"misago/services/snackbar\"\nimport store from \"misago/services/store\"\nimport * as validators from \"misago/utils/validators\"\n\nexport default function (props) {\n  return <PostingConfig {...props} Form={ModerationForm} />\n}\n\nexport class PostingConfig extends React.Component {\n  constructor(props) {\n    super(props)\n\n    this.state = {\n      isLoaded: false,\n      isError: false,\n\n      categories: [],\n    }\n  }\n\n  componentDidMount() {\n    ajax.get(misago.get(\"THREAD_EDITOR_API\")).then(\n      (data) => {\n        // hydrate categories, extract posting options\n        const categories = data.map((item) => {\n          return Object.assign(item, {\n            disabled: item.post === false,\n            label: item.name,\n            value: item.id,\n            post: item.post,\n          })\n        })\n\n        this.setState({\n          isLoaded: true,\n          categories,\n        })\n      },\n      (rejection) => {\n        this.setState({\n          isError: rejection.detail,\n        })\n      }\n    )\n  }\n\n  render() {\n    if (this.state.isError) {\n      return <Error message={this.state.isError} />\n    } else if (this.state.isLoaded) {\n      return (\n        <ModerationForm {...this.props} categories={this.state.categories} />\n      )\n    } else {\n      return <Loader />\n    }\n  }\n}\n\nexport class ModerationForm extends Form {\n  constructor(props) {\n    super(props)\n\n    this.state = {\n      isLoading: false,\n\n      title: \"\",\n      category: null,\n      categories: props.categories,\n      weight: 0,\n      is_hidden: 0,\n      is_closed: false,\n\n      validators: {\n        title: [validators.required()],\n      },\n\n      errors: {},\n    }\n\n    this.isHiddenChoices = [\n      {\n        value: 0,\n        icon: \"visibility\",\n        label: pgettext(\"thread hidden switch choice\", \"No\"),\n      },\n      {\n        value: 1,\n        icon: \"visibility_off\",\n        label: pgettext(\"thread hidden switch choice\", \"Yes\"),\n      },\n    ]\n\n    this.isClosedChoices = [\n      {\n        value: false,\n        icon: \"lock_outline\",\n        label: pgettext(\"thread closed switch choice\", \"No\"),\n      },\n      {\n        value: true,\n        icon: \"lock\",\n        label: pgettext(\"thread closed switch choice\", \"Yes\"),\n      },\n    ]\n\n    this.acl = {}\n    this.props.categories.forEach((category) => {\n      if (category.post) {\n        if (!this.state.category) {\n          this.state.category = category.id\n        }\n\n        this.acl[category.id] = {\n          can_pin_threads: category.post.pin,\n          can_close_threads: category.post.close,\n          can_hide_threads: category.post.hide,\n        }\n      }\n    })\n  }\n\n  clean() {\n    if (this.isValid()) {\n      return true\n    } else {\n      snackbar.error(gettext(\"Form contains errors.\"))\n      this.setState({\n        errors: this.validate(),\n      })\n      return false\n    }\n  }\n\n  send() {\n    return ajax.post(this.props.thread.api.posts.split, {\n      title: this.state.title,\n      category: this.state.category,\n      weight: this.state.weight,\n      is_hidden: this.state.is_hidden,\n      is_closed: this.state.is_closed,\n      posts: [this.props.post.id],\n    })\n  }\n\n  handleSuccess(apiResponse) {\n    store.dispatch(\n      post.patch(this.props.post, {\n        isDeleted: true,\n      })\n    )\n\n    modal.hide()\n\n    snackbar.success(\n      pgettext(\"post split modal\", \"Selected post was split into new thread.\")\n    )\n  }\n\n  handleError(rejection) {\n    if (rejection.status === 400) {\n      this.setState({\n        errors: Object.assign({}, this.state.errors, rejection),\n      })\n      snackbar.error(gettext(\"Form contains errors.\"))\n    } else {\n      snackbar.apiError(rejection)\n    }\n  }\n\n  onCategoryChange = (ev) => {\n    const categoryId = ev.target.value\n    const newState = {\n      category: categoryId,\n    }\n\n    if (this.acl[categoryId].can_pin_threads < newState.weight) {\n      newState.weight = 0\n    }\n\n    if (!this.acl[categoryId].can_hide_threads) {\n      newState.is_hidden = 0\n    }\n\n    if (!this.acl[categoryId].can_close_threads) {\n      newState.is_closed = false\n    }\n\n    this.setState(newState)\n  }\n\n  getWeightChoices() {\n    const choices = [\n      {\n        value: 0,\n        icon: \"remove\",\n        label: pgettext(\"thread weight choice\", \"Not pinned\"),\n      },\n      {\n        value: 1,\n        icon: \"bookmark_border\",\n        label: pgettext(\"thread weight choice\", \"Pinned in category\"),\n      },\n    ]\n\n    if (this.acl[this.state.category].can_pin_threads == 2) {\n      choices.push({\n        value: 2,\n        icon: \"bookmark\",\n        label: pgettext(\"thread weight choice\", \"Pinned globally\"),\n      })\n    }\n\n    return choices\n  }\n\n  renderWeightField() {\n    if (this.acl[this.state.category].can_pin_threads) {\n      return (\n        <FormGroup\n          label={pgettext(\"posts split modal field\", \"Thread weight\")}\n          for=\"id_weight\"\n          labelClass=\"col-sm-4\"\n          controlClass=\"col-sm-8\"\n        >\n          <Select\n            id=\"id_weight\"\n            onChange={this.bindInput(\"weight\")}\n            value={this.state.weight}\n            choices={this.getWeightChoices()}\n          />\n        </FormGroup>\n      )\n    } else {\n      return null\n    }\n  }\n\n  renderHiddenField() {\n    if (this.acl[this.state.category].can_hide_threads) {\n      return (\n        <FormGroup\n          label={pgettext(\"posts split modal field\", \"Hide thread\")}\n          for=\"id_is_hidden\"\n          labelClass=\"col-sm-4\"\n          controlClass=\"col-sm-8\"\n        >\n          <Select\n            id=\"id_is_closed\"\n            onChange={this.bindInput(\"is_hidden\")}\n            value={this.state.is_hidden}\n            choices={this.isHiddenChoices}\n          />\n        </FormGroup>\n      )\n    } else {\n      return null\n    }\n  }\n\n  renderClosedField() {\n    if (this.acl[this.state.category].can_close_threads) {\n      return (\n        <FormGroup\n          label={pgettext(\"posts split modal field\", \"Close thread\")}\n          for=\"id_is_closed\"\n          labelClass=\"col-sm-4\"\n          controlClass=\"col-sm-8\"\n        >\n          <Select\n            id=\"id_is_closed\"\n            onChange={this.bindInput(\"is_closed\")}\n            value={this.state.is_closed}\n            choices={this.isClosedChoices}\n          />\n        </FormGroup>\n      )\n    } else {\n      return null\n    }\n  }\n\n  render() {\n    return (\n      <Modal className=\"modal-dialog\">\n        <form onSubmit={this.handleSubmit}>\n          <div className=\"modal-body\">\n            <FormGroup\n              label={pgettext(\"posts split modal field\", \"Thread title\")}\n              for=\"id_title\"\n              labelClass=\"col-sm-4\"\n              controlClass=\"col-sm-8\"\n              validation={this.state.errors.title}\n            >\n              <input\n                id=\"id_title\"\n                className=\"form-control\"\n                type=\"text\"\n                onChange={this.bindInput(\"title\")}\n                value={this.state.title}\n              />\n            </FormGroup>\n            <div className=\"clearfix\" />\n\n            <FormGroup\n              label={pgettext(\"posts split modal field\", \"Category\")}\n              for=\"id_category\"\n              labelClass=\"col-sm-4\"\n              controlClass=\"col-sm-8\"\n              validation={this.state.errors.category}\n            >\n              <CategorySelect\n                id=\"id_category\"\n                onChange={this.onCategoryChange}\n                value={this.state.category}\n                choices={this.state.categories}\n              />\n            </FormGroup>\n            <div className=\"clearfix\" />\n\n            {this.renderWeightField()}\n            {this.renderHiddenField()}\n            {this.renderClosedField()}\n          </div>\n          <div className=\"modal-footer\">\n            <Button className=\"btn-primary\" loading={this.state.isLoading}>\n              {pgettext(\"posts split modal btn\", \"Split post\")}\n            </Button>\n          </div>\n        </form>\n      </Modal>\n    )\n  }\n}\n\nexport function Loader() {\n  return (\n    <Modal className=\"modal-dialog\">\n      <ModalLoader />\n    </Modal>\n  )\n}\n\nexport function Error(props) {\n  return (\n    <Modal className=\"modal-dialog modal-message\">\n      <div className=\"message-icon\">\n        <span className=\"material-icon\">info_outline</span>\n      </div>\n      <div className=\"message-body\">\n        <p className=\"lead\">\n          {pgettext(\n            \"post split modal\",\n            \"You can't move this post at the moment.\"\n          )}\n        </p>\n        <p>{props.message}</p>\n      </div>\n    </Modal>\n  )\n}\n\nexport function Modal(props) {\n  return (\n    <div className={props.className} role=\"document\">\n      <div className=\"modal-content\">\n        <div className=\"modal-header\">\n          <button\n            aria-label={pgettext(\"modal\", \"Close\")}\n            className=\"close\"\n            data-dismiss=\"modal\"\n            type=\"button\"\n          >\n            <span aria-hidden=\"true\">&times;</span>\n          </button>\n          <h4 className=\"modal-title\">\n            {pgettext(\"posts split modal title\", \"Split post into new thread\")}\n          </h4>\n        </div>\n        {props.children}\n      </div>\n    </div>\n  )\n}\n","import React from \"react\"\nimport modal from \"misago/services/modal\"\nimport posting from \"misago/services/posting\"\nimport * as moderation from \"./actions\"\nimport MoveModal from \"./move\"\nimport PostChangelog from \"misago/components/post-changelog\"\nimport SplitModal from \"./split\"\n\nexport default function (props) {\n  return (\n    <ul className=\"dropdown-menu dropdown-menu-right stick-to-bottom\">\n      <Permalink {...props} />\n      <Edit {...props} />\n      <MarkAsBestAnswer {...props} />\n      <UnmarkMarkBestAnswer {...props} />\n      <PostEdits {...props} />\n      <Approve {...props} />\n      <Move {...props} />\n      <Split {...props} />\n      <Protect {...props} />\n      <Unprotect {...props} />\n      <Hide {...props} />\n      <Unhide {...props} />\n      <Delete {...props} />\n    </ul>\n  )\n}\n\nexport class Permalink extends React.Component {\n  onClick = () => {\n    let permaUrl = window.location.protocol + \"//\"\n    permaUrl += window.location.host\n    permaUrl += this.props.post.url.index\n\n    prompt(pgettext(\"post permalink\", \"Permament link to this post:\"), permaUrl)\n  }\n\n  render() {\n    return (\n      <li>\n        <button className=\"btn btn-link\" onClick={this.onClick} type=\"button\">\n          <span className=\"material-icon\">link</span>\n          {pgettext(\"post options permalink btn\", \"Permament link\")}\n        </button>\n      </li>\n    )\n  }\n}\n\nexport class Edit extends React.Component {\n  onClick = () => {\n    posting.open({\n      mode: \"EDIT\",\n\n      thread: this.props.thread,\n      post: this.props.post,\n      config: this.props.post.api.editor,\n      submit: this.props.post.api.index,\n    })\n  }\n\n  render() {\n    if (!this.props.post.acl.can_edit) return null\n\n    return (\n      <li>\n        <button className=\"btn btn-link\" onClick={this.onClick} type=\"button\">\n          <span className=\"material-icon\">edit</span>\n          {pgettext(\"post options edit btn\", \"Edit\")}\n        </button>\n      </li>\n    )\n  }\n}\n\nexport class MarkAsBestAnswer extends React.Component {\n  onClick = () => {\n    moderation.markAsBestAnswer(this.props)\n  }\n\n  render() {\n    const { post, thread } = this.props\n\n    if (!thread.acl.can_mark_best_answer) return null\n    if (!post.acl.can_mark_as_best_answer) return null\n    if (post.id === thread.best_answer) return null\n    if (thread.best_answer && !thread.acl.can_change_best_answer) return null\n\n    return (\n      <li>\n        <button className=\"btn btn-link\" onClick={this.onClick} type=\"button\">\n          <span className=\"material-icon\">check_box</span>\n          {pgettext(\"post options best answer btn\", \"Mark as best answer\")}\n        </button>\n      </li>\n    )\n  }\n}\n\nexport class UnmarkMarkBestAnswer extends React.Component {\n  onClick = () => {\n    moderation.unmarkBestAnswer(this.props)\n  }\n\n  render() {\n    const { post, thread } = this.props\n\n    if (post.id !== thread.best_answer) return null\n    if (!thread.acl.can_unmark_best_answer) return null\n\n    return (\n      <li>\n        <button className=\"btn btn-link\" onClick={this.onClick} type=\"button\">\n          <span className=\"material-icon\">check_box_outline_blank</span>\n          {pgettext(\"post options best answer btn\", \"Unmark best answer\")}\n        </button>\n      </li>\n    )\n  }\n}\n\nexport class PostEdits extends React.Component {\n  onClick = () => {\n    modal.show(<PostChangelog post={this.props.post} />)\n  }\n\n  render() {\n    const isHidden =\n      this.props.post.is_hidden && !this.props.post.acl.can_see_hidden\n    const isUnedited = this.props.post.edits === 0\n    if (isHidden || isUnedited) return null\n\n    const message = npgettext(\n      \"post edits\",\n      \"This post was edited %(edits)s time.\",\n      \"This post was edited %(edits)s times.\",\n      this.props.post.edits\n    )\n\n    const title = interpolate(\n      message,\n      {\n        edits: this.props.post.edits,\n      },\n      true\n    )\n\n    return (\n      <li>\n        <button className=\"btn btn-link\" onClick={this.onClick} type=\"button\">\n          <span className=\"material-icon\">edit</span>\n          {pgettext(\"post options edit btn\", \"Changes history\")}\n        </button>\n      </li>\n    )\n  }\n}\n\nexport class Approve extends React.Component {\n  onClick = () => {\n    moderation.approve(this.props)\n  }\n\n  render() {\n    if (!this.props.post.acl.can_approve) return null\n    if (!this.props.post.is_unapproved) return null\n\n    return (\n      <li>\n        <button className=\"btn btn-link\" onClick={this.onClick} type=\"button\">\n          <span className=\"material-icon\">done</span>\n          {pgettext(\"post options approve btn\", \"Approve\")}\n        </button>\n      </li>\n    )\n  }\n}\n\nexport class Move extends React.Component {\n  onClick = () => {\n    modal.show(<MoveModal {...this.props} />)\n  }\n\n  render() {\n    if (!this.props.post.acl.can_move) return null\n\n    return (\n      <li>\n        <button className=\"btn btn-link\" onClick={this.onClick} type=\"button\">\n          <span className=\"material-icon\">arrow_forward</span>\n          {pgettext(\"post options move btn\", \"Move\")}\n        </button>\n      </li>\n    )\n  }\n}\n\nexport class Split extends React.Component {\n  onClick = () => {\n    modal.show(<SplitModal {...this.props} />)\n  }\n\n  render() {\n    if (!this.props.post.acl.can_move) return null\n\n    return (\n      <li>\n        <button className=\"btn btn-link\" onClick={this.onClick} type=\"button\">\n          <span className=\"material-icon\">call_split</span>\n          {pgettext(\"post options split btn\", \"Split\")}\n        </button>\n      </li>\n    )\n  }\n}\n\nexport class Protect extends React.Component {\n  onClick = () => {\n    moderation.protect(this.props)\n  }\n\n  render() {\n    if (!this.props.post.acl.can_protect) return null\n    if (this.props.post.is_protected) return null\n\n    return (\n      <li>\n        <button className=\"btn btn-link\" onClick={this.onClick} type=\"button\">\n          <span className=\"material-icon\">lock_outline</span>\n          {pgettext(\"post options protect btn\", \"Protect\")}\n        </button>\n      </li>\n    )\n  }\n}\n\nexport class Unprotect extends React.Component {\n  onClick = () => {\n    moderation.unprotect(this.props)\n  }\n\n  render() {\n    if (!this.props.post.acl.can_protect) return null\n    if (!this.props.post.is_protected) return null\n\n    return (\n      <li>\n        <button className=\"btn btn-link\" onClick={this.onClick} type=\"button\">\n          <span className=\"material-icon\">lock_open</span>\n          {pgettext(\"post options protect btn\", \"Remove protection\")}\n        </button>\n      </li>\n    )\n  }\n}\n\nexport class Hide extends React.Component {\n  onClick = () => {\n    moderation.hide(this.props)\n  }\n\n  render() {\n    const { post, thread } = this.props\n\n    if (post.id === thread.best_answer) return null\n    if (!post.acl.can_hide) return null\n    if (post.is_hidden) return null\n\n    return (\n      <li>\n        <button className=\"btn btn-link\" onClick={this.onClick} type=\"button\">\n          <span className=\"material-icon\">visibility_off</span>\n          {pgettext(\"post options hide btn\", \"Hide\")}\n        </button>\n      </li>\n    )\n  }\n}\n\nexport class Unhide extends React.Component {\n  onClick = () => {\n    moderation.unhide(this.props)\n  }\n\n  render() {\n    if (!this.props.post.acl.can_unhide) return null\n    if (!this.props.post.is_hidden) return null\n\n    return (\n      <li>\n        <button className=\"btn btn-link\" onClick={this.onClick} type=\"button\">\n          <span className=\"material-icon\">visibility</span>\n          {pgettext(\"post options hide btn\", \"Unhide\")}\n        </button>\n      </li>\n    )\n  }\n}\n\nexport class Delete extends React.Component {\n  onClick = () => {\n    moderation.remove(this.props)\n  }\n\n  render() {\n    const { post, thread } = this.props\n\n    if (post.id === thread.best_answer) return null\n    if (!post.acl.can_delete) return null\n\n    return (\n      <li>\n        <button className=\"btn btn-link\" onClick={this.onClick} type=\"button\">\n          <span className=\"material-icon\">clear</span>\n          {pgettext(\"post options delete btn\", \"Delete\")}\n        </button>\n      </li>\n    )\n  }\n}\n","import React from \"react\"\nimport Dropdown from \"./dropdown\"\n\nexport default function (props) {\n  return (\n    <div className=\"pull-right dropdown\">\n      <button\n        aria-expanded=\"true\"\n        aria-haspopup=\"true\"\n        className=\"btn btn-default btn-icon dropdown-toggle\"\n        data-toggle=\"dropdown\"\n        type=\"button\"\n      >\n        <span className=\"material-icon\">expand_more</span>\n      </button>\n      <Dropdown {...props} />\n    </div>\n  )\n}\n","import React from \"react\"\nimport * as posts from \"misago/reducers/posts\"\nimport store from \"misago/services/store\"\n\nexport default class extends React.Component {\n  onClick = () => {\n    if (this.props.post.isSelected) {\n      store.dispatch(posts.deselect(this.props.post))\n    } else {\n      store.dispatch(posts.select(this.props.post))\n    }\n  }\n\n  render() {\n    if (\n      !(this.props.thread.acl.can_merge_posts || isVisible(this.props.post.acl))\n    ) {\n      return null\n    }\n\n    return (\n      <div className=\"pull-right\">\n        <button\n          className=\"btn btn-default btn-icon\"\n          onClick={this.onClick}\n          type=\"button\"\n        >\n          <span className=\"material-icon\">\n            {this.props.post.isSelected\n              ? \"check_box\"\n              : \"check_box_outline_blank\"}\n          </span>\n        </button>\n      </div>\n    )\n  }\n}\n\nexport function isVisible(acl) {\n  return (\n    acl.can_approve ||\n    acl.can_hide ||\n    acl.can_protect ||\n    acl.can_unhide ||\n    acl.can_delete ||\n    acl.can_move\n  )\n}\n","import React from \"react\"\nimport Controls from \"./controls\"\nimport Select from \"./select\"\nimport {\n  StatusIcon,\n  getStatusClassName,\n  getStatusDescription,\n} from \"misago/components/user-status\"\nimport PostChangelog from \"misago/components/post-changelog\"\nimport Timestamp from \"misago/components/Timestamp\"\nimport modal from \"misago/services/modal\"\n\nexport default function (props) {\n  return (\n    <div className=\"post-heading\">\n      <UnreadLabel {...props} />\n      <UnreadCompact {...props} />\n      <PostedOn {...props} />\n      <PostedOnCompact {...props} />\n      <PostEdits {...props} />\n      <PostEditsCompacts {...props} />\n      <ProtectedLabel {...props} />\n      <Select {...props} />\n      <Controls {...props} />\n    </div>\n  )\n}\n\nexport function UnreadLabel(props) {\n  if (props.post.is_read) return null\n\n  return (\n    <span className=\"label label-unread hidden-xs\">\n      {pgettext(\"post unread label\", \"New post\")}\n    </span>\n  )\n}\n\nexport function UnreadCompact(props) {\n  if (props.post.is_read) return null\n\n  return (\n    <span className=\"label label-unread visible-xs-inline-block\">\n      {pgettext(\"post unread label\", \"New\")}\n    </span>\n  )\n}\n\nexport function PostedOn(props) {\n  return (\n    <a href={props.post.url.index} className=\"btn btn-link posted-on hidden-xs\">\n      <Timestamp datetime={props.post.posted_on.toISOString()} />\n    </a>\n  )\n}\n\nexport function PostedOnCompact(props) {\n  return (\n    <a\n      href={props.post.url.index}\n      className=\"btn btn-link posted-on visible-xs-inline-block\"\n    >\n      {props.post.posted_on.fromNow()}\n    </a>\n  )\n}\n\nexport class PostEdits extends React.Component {\n  onClick = () => {\n    modal.show(<PostChangelog post={this.props.post} />)\n  }\n\n  render() {\n    const isHidden =\n      this.props.post.is_hidden && !this.props.post.acl.can_see_hidden\n    const isUnedited = this.props.post.edits === 0\n    if (isHidden || isUnedited) return null\n\n    const tooltip = npgettext(\n      \"post edits stat\",\n      \"This post was edited %(edits)s time.\",\n      \"This post was edited %(edits)s times.\",\n      this.props.post.edits\n    )\n\n    const title = interpolate(\n      tooltip,\n      {\n        edits: this.props.post.edits,\n      },\n      true\n    )\n\n    const label = npgettext(\n      \"post edits stat\",\n      \"edited %(edits)s time\",\n      \"edited %(edits)s times\",\n      this.props.post.edits\n    )\n\n    return (\n      <button\n        className=\"btn btn-link btn-see-edits hidden-xs\"\n        onClick={this.onClick}\n        title={title}\n        type=\"button\"\n      >\n        {interpolate(\n          label,\n          {\n            edits: this.props.post.edits,\n          },\n          true\n        )}\n      </button>\n    )\n  }\n}\n\nexport class PostEditsCompacts extends PostEdits {\n  render() {\n    const isHidden =\n      this.props.post.is_hidden && !this.props.post.acl.can_see_hidden\n    const isUnedited = this.props.post.edits === 0\n    if (isHidden || isUnedited) return null\n\n    const label = npgettext(\n      \"post edits stat\",\n      \"%(edits)s edit\",\n      \"%(edits)s edits\",\n      this.props.post.edits\n    )\n\n    return (\n      <button\n        className=\"btn btn-link btn-see-edits visible-xs-inline-block\"\n        onClick={this.onClick}\n        type=\"button\"\n      >\n        {interpolate(\n          label,\n          {\n            edits: this.props.post.edits,\n          },\n          true\n        )}\n      </button>\n    )\n  }\n}\n\nexport function ProtectedLabel(props) {\n  const postAuthor = props.post.poster && props.post.poster.id === props.user.id\n  const hasAcl = props.post.acl.can_protect\n  const isVisible =\n    props.user.id && props.post.is_protected && (postAuthor || hasAcl)\n\n  if (!isVisible) {\n    return null\n  }\n\n  return (\n    <span\n      className=\"label label-protected hidden-xs\"\n      title={pgettext(\n        \"post protected label\",\n        \"This post is protected and may not be edited.\"\n      )}\n    >\n      <span className=\"material-icon\">lock_outline</span>\n      {pgettext(\"post protected label\", \"protected\")}\n    </span>\n  )\n}\n","import React from \"react\"\nimport Avatar from \"misago/components/avatar\"\nimport Controls from \"misago/components/posts-list/post/controls\"\nimport Select from \"misago/components/posts-list/post/select\"\n\nexport default function ({ post, thread }) {\n  return (\n    <div className=\"post-side post-side-anonymous\">\n      <Select post={post} thread={thread} />\n      <Controls post={post} thread={thread} />\n      <div className=\"media\">\n        <div className=\"media-left\">\n          <span>\n            <Avatar className=\"poster-avatar\" size={100} />\n          </span>\n        </div>\n        <div className=\"media-body\">\n          <span className=\"media-heading item-title\">{post.poster_name}</span>\n\n          <span className=\"user-title user-title-anonymous\">\n            {pgettext(\"post removed poster username\", \"Removed user\")}\n          </span>\n        </div>\n      </div>\n    </div>\n  )\n}\n","export default function ({ title, rank }) {\n  return rank.is_tab || !!title || !!rank.title\n}\n","import React from \"react\"\nimport hasVisibleTitle from \"./has-visible-title\"\n\nexport default function ({ poster }) {\n  const message = npgettext(\n    \"poster stats\",\n    \"%(posts)s post\",\n    \"%(posts)s posts\",\n    poster.posts\n  )\n\n  let className = \"user-postcount\"\n  if (hasVisibleTitle(poster)) {\n    className += \" hidden-xs hidden-sm\"\n  }\n\n  return (\n    <span className={className}>\n      {interpolate(\n        message,\n        {\n          posts: poster.posts,\n        },\n        true\n      )}\n    </span>\n  )\n}\n","import React from \"react\"\nimport UserStatus, { StatusLabel } from \"misago/components/user-status\"\nimport hasVisibleTitle from \"./has-visible-title\"\n\nexport default function ({ poster }) {\n  let className = \"hidden-xs\"\n  if (hasVisibleTitle(poster)) {\n    className += \" hidden-sm\"\n  }\n\n  return (\n    <span className={className}>\n      <UserStatus status={poster.status}>\n        <StatusLabel status={poster.status} user={poster} />\n      </UserStatus>\n    </span>\n  )\n}\n","import React from \"react\"\n\nexport default function ({ rank, title }) {\n  let userTitle = title || rank.title\n  if (!userTitle && rank.is_tab) {\n    userTitle = rank.name\n  }\n\n  if (!userTitle) return null\n\n  let className = \"user-title\"\n  if (rank.css_class) {\n    className += \" user-title-\" + rank.css_class\n  }\n\n  if (rank.is_tab) {\n    return (\n      <div className={className}>\n        <a href={rank.url}>{userTitle}</a>\n      </div>\n    )\n  }\n\n  return <div className={className}>{userTitle}</div>\n}\n","import React from \"react\"\nimport Avatar from \"misago/components/avatar\"\nimport Controls from \"misago/components/posts-list/post/controls\"\nimport Select from \"misago/components/posts-list/post/select\"\nimport UserStatus, { StatusIcon } from \"misago/components/user-status\"\nimport UserPostcount from \"./user-postcount\"\nimport UserStatusLabel from \"./user-status\"\nimport UserTitle from \"./user-title\"\n\nexport default function ({ post, thread }) {\n  const { poster } = post\n\n  return (\n    <div className=\"post-side post-side-registered\">\n      <Select post={post} thread={thread} />\n      <Controls post={post} thread={thread} />\n      <div className=\"media\">\n        <div className=\"media-left\">\n          <a href={poster.url}>\n            <Avatar className=\"poster-avatar\" size={100} user={poster} />\n          </a>\n        </div>\n        <div className=\"media-body\">\n          <div className=\"media-heading\">\n            <a className=\"item-title\" href={poster.url}>\n              {poster.username}\n            </a>\n            <UserStatus status={poster.status}>\n              <StatusIcon status={poster.status} />\n            </UserStatus>\n          </div>\n\n          <UserTitle rank={poster.rank} title={poster.title} />\n\n          <UserStatusLabel poster={poster} />\n          <UserPostcount poster={poster} />\n        </div>\n      </div>\n    </div>\n  )\n}\n","import React from \"react\"\nimport Anonymous from \"./anonymous\"\nimport Registered from \"./registered\"\n\nexport default function (props) {\n  if (props.post.poster) {\n    return <Registered {...props} />\n  }\n\n  return <Anonymous {...props} />\n}\n","import React from \"react\"\nimport Attachments from \"./attachments\"\nimport Body from \"./body\"\nimport {\n  FlagBestAnswer,\n  FlagHidden,\n  FlagUnapproved,\n  FlagProtected,\n} from \"./flags\"\nimport Footer from \"./footer\"\nimport Header from \"./header\"\nimport PostSide from \"./post-side\"\n\nexport default function (props) {\n  let className = \"post\"\n  if (props.post.isDeleted) {\n    className = \"hide\"\n  } else if (props.post.is_hidden && !props.post.acl.can_see_hidden) {\n    className = \"post post-hidden\"\n  }\n\n  if (props.post.poster && props.post.poster.rank.css_class) {\n    className += \" post-\" + props.post.poster.rank.css_class\n  }\n\n  if (!props.post.is_read) {\n    className += \" post-new\"\n  }\n\n  return (\n    <li id={\"post-\" + props.post.id} className={className}>\n      <div className=\"panel panel-default panel-post\">\n        <div className=\"panel-body\">\n          <PostSide {...props} />\n          <div className=\"panel-content\">\n            <Header {...props} />\n            <FlagBestAnswer {...props} />\n            <FlagUnapproved {...props} />\n            <FlagProtected {...props} />\n            <FlagHidden {...props} />\n            <Body {...props} />\n            <Attachments {...props} />\n            <Footer {...props} />\n          </div>\n        </div>\n      </div>\n    </li>\n  )\n}\n","import React from \"react\"\nimport Avatar from \"misago/components/avatar\"\nimport * as random from \"misago/utils/random\"\n\nconst PostPreview = () => (\n  <li className=\"post\">\n    <div className=\"panel panel-default panel-post\">\n      <div className=\"panel-body\">\n        <div className=\"post-side post-side-registered\">\n          <div className=\"media\">\n            <div className=\"media-left\">\n              <span>\n                <Avatar className=\"poster-avatar\" size=\"100\" />\n              </span>\n            </div>\n            <div className=\"media-body\">\n              <span className=\"media-heading item-title\">\n                <span className=\"ui-preview-text\" style={{ width: \"80px\" }}>\n                  &nbsp;\n                </span>\n              </span>\n              <span className=\"user-title user-title-anonymous\">\n                <span className=\"ui-preview-text\" style={{ width: \"60px\" }}>\n                  &nbsp;\n                </span>\n              </span>\n            </div>\n          </div>\n        </div>\n        <div className=\"panel-content\">\n          <div className=\"post-body\">\n            <article className=\"misago-markup\">\n              <p className=\"ui-preview-text\" style={{ width: \"100%\" }}>\n                &nbsp;\n              </p>\n              <p className=\"ui-preview-text\" style={{ width: \"70%\" }}>\n                &nbsp;\n              </p>\n              <p\n                className=\"ui-preview-text hidden-xs hidden-sm\"\n                style={{ width: \"85%\" }}\n              >\n                &nbsp;\n              </p>\n            </article>\n          </div>\n        </div>\n      </div>\n    </div>\n  </li>\n)\n\nexport default PostPreview\n","import React from \"react\"\nimport Event from \"./event\"\nimport Post from \"./post\"\nimport PostPreview from \"./post/preview\"\n\nexport default function (props) {\n  if (!props.posts.isLoaded) {\n    return (\n      <ul className=\"posts-list ui-preview\">\n        <PostPreview />\n      </ul>\n    )\n  }\n\n  return (\n    <ul className=\"posts-list ui-ready\">\n      {props.posts.results.map((post) => {\n        return <ListItem key={post.id} post={post} {...props} />\n      })}\n    </ul>\n  )\n}\n\nexport function ListItem(props) {\n  if (props.post.is_event) {\n    return <Event {...props} />\n  }\n\n  return <Post {...props} />\n}\n","import React from \"react\"\n\nconst ThreadFlags = ({ thread }) => (\n  <ul className=\"thread-flags\">\n    {thread.weight == 2 && (\n      <li\n        className=\"thread-flag-pinned-globally\"\n        title={pgettext(\"thread flag\", \"Pinned globally\")}\n      >\n        <span className=\"material-icon\">bookmark</span>\n      </li>\n    )}\n    {thread.weight == 1 && (\n      <li\n        className=\"thread-flag-pinned-locally\"\n        title={pgettext(\"thread flag\", \"Pinned in category\")}\n      >\n        <span className=\"material-icon\">bookmark_outline</span>\n      </li>\n    )}\n    {thread.best_answer && (\n      <li\n        className=\"thread-flag-answered\"\n        title={pgettext(\"thread flag\", \"Answered\")}\n      >\n        <span className=\"material-icon\">check_circle</span>\n      </li>\n    )}\n    {thread.has_poll && (\n      <li className=\"thread-flag-poll\" title={pgettext(\"thread flag\", \"Poll\")}>\n        <span className=\"material-icon\">poll</span>\n      </li>\n    )}\n    {(thread.is_unapproved || thread.has_unapproved_posts) && (\n      <li\n        className=\"thread-flag-unapproved\"\n        title={\n          thread.is_unapproved\n            ? pgettext(\"thread flag\", \"Awaiting approval\")\n            : pgettext(\"thread flag\", \"Has unapproved posts\")\n        }\n      >\n        <span className=\"material-icon\">visibility</span>\n      </li>\n    )}\n    {thread.is_closed && (\n      <li\n        className=\"thread-flag-closed\"\n        title={pgettext(\"thread flag\", \"Closed\")}\n      >\n        <span className=\"material-icon\">lock</span>\n      </li>\n    )}\n    {thread.is_hidden && (\n      <li\n        className=\"thread-flag-hidden\"\n        title={pgettext(\"thread flag\", \"Hidden\")}\n      >\n        <span className=\"material-icon\">visibility_off</span>\n      </li>\n    )}\n  </ul>\n)\n\nexport default ThreadFlags\n","import React from \"react\"\n\nconst ThreadReplies = ({ thread }) => (\n  <span\n    className=\"threads-replies\"\n    title={interpolate(\n      npgettext(\n        \"thread replies stat\",\n        \"%(replies)s reply\",\n        \"%(replies)s replies\",\n        thread.replies\n      ),\n      { replies: thread.replies },\n      true\n    )}\n  >\n    <span className=\"material-icon\">chat_bubble_outline</span>\n    {thread.replies > 980\n      ? Math.round(thread.replies / 1000) + \"K\"\n      : thread.replies}\n  </span>\n)\n\nexport default ThreadReplies\n","import React from \"react\"\nimport Avatar from \"./avatar\"\n\nconst ThreadStarterCard = ({ thread }) => (\n  <div className=\"thread-user-card\">\n    <div className=\"thread-user-card-media\">\n      {thread.starter ? (\n        <a href={thread.url.starter}>\n          <Avatar size={40} user={thread.starter} />\n        </a>\n      ) : (\n        <Avatar size={40} />\n      )}\n    </div>\n    <div className=\"thread-user-card-body\">\n      <div className=\"thread-user-card-header\">\n        {thread.starter ? (\n          <a\n            className=\"item-title\"\n            href={thread.url.starter}\n            title={pgettext(\"thread starter info\", \"Thread author\")}\n          >\n            {thread.starter.username}\n          </a>\n        ) : (\n          <span\n            className=\"item-title\"\n            title={pgettext(\"thread starter info\", \"Thread author\")}\n          >\n            {thread.starter_name}\n          </span>\n        )}\n      </div>\n      <div>\n        <span\n          className=\"text-muted\"\n          title={interpolate(\n            pgettext(\"thread starter info\", \"Started on: %(timestamp)s\"),\n            {\n              timestamp: thread.started_on.format(\"LLL\"),\n            },\n            true\n          )}\n        >\n          {thread.started_on.fromNow()}\n        </span>\n      </div>\n    </div>\n  </div>\n)\n\nexport default ThreadStarterCard\n","import React from \"react\"\nimport Form from \"misago/components/form\"\nimport FormGroup from \"misago/components/form-group\"\nimport { getTitleValidators } from \"misago/components/posting/utils/validators\"\nimport * as thread from \"misago/reducers/thread\"\nimport ajax from \"misago/services/ajax\"\nimport modal from \"misago/services/modal\"\nimport snackbar from \"misago/services/snackbar\"\nimport store from \"misago/services/store\"\n\nexport default class extends Form {\n  constructor(props) {\n    super(props)\n\n    this.state = {\n      isLoading: false,\n\n      title: props.thread.title,\n\n      validators: {\n        title: getTitleValidators(),\n      },\n      errors: {},\n    }\n  }\n\n  clean() {\n    if (!this.state.title.trim().length) {\n      snackbar.error(\n        pgettext(\"thread title form\", \"You have to enter thread title.\")\n      )\n      return false\n    }\n\n    const errors = this.validate()\n\n    if (errors.title) {\n      snackbar.error(errors.title[0])\n      return false\n    }\n\n    return true\n  }\n\n  send() {\n    // freeze thread\n    store.dispatch(thread.busy())\n\n    return ajax.patch(this.props.thread.api.index, [\n      { op: \"replace\", path: \"title\", value: this.state.title },\n    ])\n  }\n\n  handleSuccess = (data) => {\n    this.handleSuccessUnmounted(data)\n\n    // keep form loading\n    this.setState({\n      isLoading: true,\n    })\n\n    modal.hide()\n  }\n\n  handleSuccessUnmounted = (data) => {\n    store.dispatch(thread.release())\n    store.dispatch(thread.update(data))\n  }\n\n  handleError = (rejection) => {\n    store.dispatch(thread.release())\n\n    if (rejection.status === 400) {\n      snackbar.error(rejection.detail[0])\n    } else {\n      snackbar.apiError(rejection)\n    }\n  }\n\n  onChange = (event) => {\n    this.changeValue(\"title\", event.target.value)\n  }\n\n  render() {\n    return (\n      <div className=\"modal-dialog modal-lg\" role=\"document\">\n        <form onSubmit={this.handleSubmit}>\n          <div className=\"modal-content\">\n            <ModalHeader />\n            <div className=\"modal-body\">\n              <FormGroup\n                for=\"id_modal_title\"\n                label={pgettext(\"thread title form field\", \"Thread title\")}\n              >\n                <input\n                  className=\"form-control\"\n                  disabled={this.state.isLoading || this.props.thread.isBusy}\n                  id=\"id_modal_title\"\n                  onChange={this.onChange}\n                  value={this.state.title}\n                />\n              </FormGroup>\n            </div>\n            <div className=\"modal-footer\">\n              <button\n                className=\"btn btn-default\"\n                data-dismiss=\"modal\"\n                disabled={this.state.isLoading}\n                type=\"button\"\n              >\n                {pgettext(\"thread title form btn\", \"Cancel\")}\n              </button>\n              <button\n                className=\"btn btn-primary\"\n                disabled={this.state.isLoading || this.props.thread.isBusy}\n              >\n                {pgettext(\"thread title form btn\", \"Change title\")}\n              </button>\n            </div>\n          </div>\n        </form>\n      </div>\n    )\n  }\n}\n\nexport function ModalHeader(props) {\n  return (\n    <div className=\"modal-header\">\n      <button\n        aria-label={pgettext(\"modal\", \"Close\")}\n        className=\"close\"\n        data-dismiss=\"modal\"\n        type=\"button\"\n      >\n        <span aria-hidden=\"true\">&times;</span>\n      </button>\n      <h4 className=\"modal-title\">\n        {pgettext(\"thread title form title\", \"Change title\")}\n      </h4>\n    </div>\n  )\n}\n","import React from \"react\"\nimport Button from \"./button\"\nimport Form from \"./form\"\nimport FormGroup from \"./form-group\"\nimport ajax from \"misago/services/ajax\"\nimport modal from \"misago/services/modal\"\n\nexport default class extends Form {\n  constructor(props) {\n    super(props)\n\n    this.state = {\n      isLoading: false,\n\n      bestAnswer: \"0\",\n      poll: \"0\",\n    }\n  }\n\n  clean() {\n    if (this.props.polls && this.state.poll === \"0\") {\n      const confirmation = window.confirm(\n        pgettext(\n          \"merge threads conflict form\",\n          \"Are you sure you want to delete all polls?\"\n        )\n      )\n      return confirmation\n    }\n\n    return true\n  }\n\n  send() {\n    const data = Object.assign({}, this.props.data, {\n      best_answer: this.state.bestAnswer,\n      poll: this.state.poll,\n    })\n\n    return ajax.post(this.props.api, data)\n  }\n\n  handleSuccess = (success) => {\n    this.props.onSuccess(success)\n    modal.hide()\n  }\n\n  handleError = (rejection) => {\n    this.props.onError(rejection)\n  }\n\n  onBestAnswerChange = (event) => {\n    this.changeValue(\"bestAnswer\", event.target.value)\n  }\n\n  onPollChange = (event) => {\n    this.changeValue(\"poll\", event.target.value)\n  }\n\n  render() {\n    return (\n      <div className=\"modal-dialog\" role=\"document\">\n        <div className=\"modal-content\">\n          <div className=\"modal-header\">\n            <button\n              aria-label={pgettext(\"modal\", \"Close\")}\n              className=\"close\"\n              data-dismiss=\"modal\"\n              type=\"button\"\n            >\n              <span aria-hidden=\"true\">&times;</span>\n            </button>\n            <h4 className=\"modal-title\">\n              {pgettext(\"merge threads conflict modal title\", \"Merge threads\")}\n            </h4>\n          </div>\n          <form onSubmit={this.handleSubmit}>\n            <div className=\"modal-body\">\n              <BestAnswerSelect\n                choices={this.props.bestAnswers}\n                onChange={this.onBestAnswerChange}\n                value={this.state.bestAnswer}\n              />\n              <PollSelect\n                choices={this.props.polls}\n                onChange={this.onPollChange}\n                value={this.state.poll}\n              />\n            </div>\n            <div className=\"modal-footer\">\n              <button\n                className=\"btn btn-default\"\n                data-dismiss=\"modal\"\n                disabled={this.state.isLoading}\n                type=\"button\"\n              >\n                {pgettext(\"merge threads conflict btn\", \"Cancel\")}\n              </button>\n              <Button className=\"btn-primary\" loading={this.state.isLoading}>\n                {pgettext(\"merge threads conflict btn\", \"Merge threads\")}\n              </Button>\n            </div>\n          </form>\n        </div>\n      </div>\n    )\n  }\n}\n\nexport function BestAnswerSelect({ choices, onChange, value }) {\n  if (!choices) return null\n\n  return (\n    <FormGroup\n      label={pgettext(\"merge threads conflict best answer\", \"Best answer\")}\n      helpText={pgettext(\n        \"merge threads conflict best answer\",\n        \"Select the best answer for your newly merged thread. No posts will be deleted during the merge.\"\n      )}\n      for=\"id_best_answer\"\n    >\n      <select\n        className=\"form-control\"\n        id=\"id_best_answer\"\n        onChange={onChange}\n        value={value}\n      >\n        {choices.map((choice) => {\n          return (\n            <option value={choice[0]} key={choice[0]}>\n              {choice[1]}\n            </option>\n          )\n        })}\n      </select>\n    </FormGroup>\n  )\n}\n\nexport function PollSelect({ choices, onChange, value }) {\n  if (!choices) return null\n\n  return (\n    <FormGroup\n      label={pgettext(\"merge threads conflict poll\", \"Poll\")}\n      helpText={pgettext(\n        \"merge threads conflict poll\",\n        \"Select the poll for your newly merged thread. Rejected polls will be permanently deleted and cannot be recovered.\"\n      )}\n      for=\"id_poll\"\n    >\n      <select\n        className=\"form-control\"\n        id=\"id_poll\"\n        onChange={onChange}\n        value={value}\n      >\n        {choices.map((choice) => {\n          return (\n            <option value={choice[0]} key={choice[0]}>\n              {choice[1]}\n            </option>\n          )\n        })}\n      </select>\n    </FormGroup>\n  )\n}\n","import React from \"react\"\nimport Form from \"misago/components/form\"\nimport FormGroup from \"misago/components/form-group\"\nimport MergeConflict from \"misago/components/merge-conflict\"\nimport * as thread from \"misago/reducers/thread\"\nimport ajax from \"misago/services/ajax\"\nimport modal from \"misago/services/modal\"\nimport snackbar from \"misago/services/snackbar\"\nimport store from \"misago/services/store\"\n\nexport default class extends Form {\n  constructor(props) {\n    super(props)\n\n    this.state = {\n      isLoading: false,\n\n      url: \"\",\n\n      validators: {\n        url: [],\n      },\n      errors: {},\n    }\n  }\n\n  clean() {\n    if (!this.state.url.trim().length) {\n      snackbar.error(\n        pgettext(\n          \"thread merge form\",\n          \"You have to enter link to the other thread.\"\n        )\n      )\n      return false\n    }\n\n    return true\n  }\n\n  send() {\n    // freeze thread\n    store.dispatch(thread.busy())\n\n    return ajax.post(this.props.thread.api.merge, {\n      other_thread: this.state.url,\n    })\n  }\n\n  handleSuccess = (success) => {\n    this.handleSuccessUnmounted(success)\n\n    // keep form loading\n    this.setState({\n      isLoading: true,\n    })\n  }\n\n  handleSuccessUnmounted = (success) => {\n    snackbar.success(\n      pgettext(\"thread merge form\", \"Thread has been merged with other one.\")\n    )\n    window.location = success.url\n  }\n\n  handleError = (rejection) => {\n    store.dispatch(thread.release())\n\n    if (rejection.status === 400) {\n      if (rejection.best_answers || rejection.polls) {\n        modal.show(\n          <MergeConflict\n            api={this.props.thread.api.merge}\n            bestAnswers={rejection.best_answers}\n            data={{ other_thread: this.state.url }}\n            polls={rejection.polls}\n            onError={this.handleError}\n            onSuccess={this.handleSuccessUnmounted}\n          />\n        )\n      } else if (rejection.best_answer) {\n        snackbar.error(rejection.best_answer[0])\n      } else if (rejection.poll) {\n        snackbar.error(rejection.poll[0])\n      } else {\n        snackbar.error(rejection.detail)\n      }\n    } else {\n      snackbar.apiError(rejection)\n    }\n  }\n\n  onUrlChange = (event) => {\n    this.changeValue(\"url\", event.target.value)\n  }\n\n  render() {\n    return (\n      <div className=\"modal-dialog\" role=\"document\">\n        <form onSubmit={this.handleSubmit}>\n          <div className=\"modal-content\">\n            <ModalHeader />\n            <div className=\"modal-body\">\n              <FormGroup\n                for=\"id_url\"\n                label={pgettext(\n                  \"thread merge form field\",\n                  \"Link to thread you want to merge with\"\n                )}\n                help_text={pgettext(\n                  \"thread merge form field\",\n                  \"Merge will delete current thread and move its contents to the thread specified here.\"\n                )}\n              >\n                <input\n                  className=\"form-control\"\n                  disabled={this.state.isLoading || this.props.thread.isBusy}\n                  id=\"id_url\"\n                  onChange={this.onUrlChange}\n                  value={this.state.url}\n                />\n              </FormGroup>\n            </div>\n            <div className=\"modal-footer\">\n              <button\n                className=\"btn btn-default\"\n                data-dismiss=\"modal\"\n                disabled={this.state.isLoading}\n                type=\"button\"\n              >\n                {pgettext(\"thread merge form btn\", \"Cancel\")}\n              </button>\n              <button\n                className=\"btn btn-primary\"\n                disabled={this.state.isLoading || this.props.thread.isBusy}\n              >\n                {pgettext(\"thread merge form btn\", \"Merge thread\")}\n              </button>\n            </div>\n          </div>\n        </form>\n      </div>\n    )\n  }\n}\n\nexport function ModalHeader(props) {\n  return (\n    <div className=\"modal-header\">\n      <button\n        aria-label={pgettext(\"modal\", \"Close\")}\n        className=\"close\"\n        data-dismiss=\"modal\"\n        type=\"button\"\n      >\n        <span aria-hidden=\"true\">&times;</span>\n      </button>\n      <h4 className=\"modal-title\">\n        {pgettext(\"thread merge form title\", \"Merge thread\")}\n      </h4>\n    </div>\n  )\n}\n","import React from \"react\"\nimport Form from \"misago/components/form\"\nimport FormGroup from \"misago/components/form-group\"\nimport CategorySelect from \"misago/components/category-select\"\nimport ModalLoader from \"misago/components/modal-loader\"\nimport * as posts from \"misago/reducers/posts\"\nimport * as thread from \"misago/reducers/thread\"\nimport misago from \"misago\"\nimport ajax from \"misago/services/ajax\"\nimport modal from \"misago/services/modal\"\nimport snackbar from \"misago/services/snackbar\"\nimport store from \"misago/services/store\"\n\nexport default class extends Form {\n  constructor(props) {\n    super(props)\n\n    this.state = {\n      isReady: false,\n      isLoading: false,\n      isError: false,\n\n      category: null,\n      categories: [],\n    }\n  }\n\n  componentDidMount() {\n    ajax.get(misago.get(\"THREAD_EDITOR_API\")).then(\n      (data) => {\n        let category = null\n\n        // hydrate categories, extract posting options\n        const categories = data.map((item) => {\n          // pick first category that allows posting and if it may, override it with initial one\n          if (item.post !== false && !category) {\n            category = item.id\n          }\n\n          return Object.assign(item, {\n            disabled: item.post === false,\n            label: item.name,\n            value: item.id,\n          })\n        })\n\n        this.setState({\n          isReady: true,\n\n          category,\n          categories,\n        })\n      },\n      (rejection) => {\n        this.setState({\n          isError: rejection.detail,\n        })\n      }\n    )\n  }\n\n  send() {\n    // freeze thread\n    store.dispatch(thread.busy())\n\n    return ajax.patch(this.props.thread.api.index, [\n      { op: \"replace\", path: \"category\", value: this.state.category },\n    ])\n  }\n\n  handleSuccess() {\n    // refresh thread and displayed posts\n    ajax\n      .get(this.props.thread.api.posts.index, { page: this.props.posts.page })\n      .then(\n        (data) => {\n          store.dispatch(thread.replace(data))\n          store.dispatch(posts.load(data.post_set))\n          store.dispatch(thread.release())\n\n          snackbar.success(\n            pgettext(\"thread move form\", \"Thread has been moved.\")\n          )\n          modal.hide()\n        },\n        (rejection) => {\n          store.dispatch(thread.release())\n          snackbar.apiError(rejection)\n        }\n      )\n  }\n\n  handleError(rejection) {\n    if (rejection.status === 400) {\n      snackbar.error(rejection.detail[0])\n    } else {\n      snackbar.apiError(rejection)\n    }\n  }\n\n  onCategoryChange = (event) => {\n    this.changeValue(\"category\", event.target.value)\n  }\n\n  render() {\n    if (this.state.isReady) {\n      return (\n        <div className=\"modal-dialog\" role=\"document\">\n          <form onSubmit={this.handleSubmit}>\n            <div className=\"modal-content\">\n              <ModalHeader />\n              <div className=\"modal-body\">\n                <FormGroup\n                  for=\"id_category\"\n                  label={pgettext(\"thread move form field\", \"New category\")}\n                >\n                  <CategorySelect\n                    choices={this.state.categories}\n                    disabled={this.state.isLoading || this.props.thread.isBusy}\n                    id=\"id_category\"\n                    onChange={this.onCategoryChange}\n                    value={this.state.category}\n                  />\n                </FormGroup>\n              </div>\n              <div className=\"modal-footer\">\n                <button\n                  className=\"btn btn-default\"\n                  data-dismiss=\"modal\"\n                  disabled={this.state.isLoading}\n                  type=\"button\"\n                >\n                  {pgettext(\"thread move form btn\", \"Cancel\")}\n                </button>\n                <button\n                  className=\"btn btn-primary\"\n                  disabled={this.state.isLoading || this.props.thread.isBusy}\n                >\n                  {pgettext(\"thread move form btn\", \"Move thread\")}\n                </button>\n              </div>\n            </div>\n          </form>\n        </div>\n      )\n    } else if (this.state.isError) {\n      return <ModalMessage message={this.state.isError} />\n    } else {\n      return <ModalLoading />\n    }\n  }\n}\n\nexport function ModalHeader(props) {\n  return (\n    <div className=\"modal-header\">\n      <button\n        aria-label={pgettext(\"modal\", \"Close\")}\n        className=\"close\"\n        data-dismiss=\"modal\"\n        type=\"button\"\n      >\n        <span aria-hidden=\"true\">&times;</span>\n      </button>\n      <h4 className=\"modal-title\">\n        {pgettext(\"thread move form title\", \"Move thread\")}\n      </h4>\n    </div>\n  )\n}\n\nexport function ModalLoading(props) {\n  return (\n    <div className=\"modal-dialog\" role=\"document\">\n      <div className=\"modal-content\">\n        <ModalHeader />\n        <ModalLoader />\n      </div>\n    </div>\n  )\n}\n\nexport function ModalMessage(props) {\n  return (\n    <div className=\"modal-dialog modal-message\" role=\"document\">\n      <div className=\"modal-content\">\n        <ModalHeader />\n        <div className=\"message-icon\">\n          <span className=\"material-icon\">info_outline</span>\n        </div>\n        <div className=\"message-body\">\n          <p className=\"lead\">\n            {pgettext(\n              \"thread move form\",\n              \"You can't move this thread at the moment.\"\n            )}\n          </p>\n          <p>{props.message}</p>\n          <button\n            className=\"btn btn-default\"\n            data-dismiss=\"modal\"\n            type=\"button\"\n          >\n            {pgettext(\"thread move form dismiss btn\", \"Ok\")}\n          </button>\n        </div>\n      </div>\n    </div>\n  )\n}\n","import React from \"react\"\nimport * as thread from \"misago/reducers/thread\"\nimport ajax from \"misago/services/ajax\"\nimport modal from \"misago/services/modal\"\nimport snackbar from \"misago/services/snackbar\"\nimport store from \"misago/services/store\"\nimport ThreadChangeTitleModal from \"./ThreadChangeTitleModal\"\nimport MergeModal from \"./merge\"\nimport MoveModal from \"./move\"\n\nexport default class extends React.Component {\n  callApi = (ops, successMessage) => {\n    store.dispatch(thread.busy())\n\n    // by the chance update thread acl too\n    ops.push({ op: \"add\", path: \"acl\", value: true })\n\n    ajax.patch(this.props.thread.api.index, ops).then(\n      (data) => {\n        store.dispatch(thread.update(data))\n        store.dispatch(thread.release())\n        snackbar.success(successMessage)\n      },\n      (rejection) => {\n        store.dispatch(thread.release())\n        if (rejection.status === 400) {\n          snackbar.error(rejection.detail[0])\n        } else {\n          snackbar.apiError(rejection)\n        }\n      }\n    )\n  }\n\n  changeTitle = () => {\n    modal.show(<ThreadChangeTitleModal thread={this.props.thread} />)\n  }\n\n  pinGlobally = () => {\n    this.callApi(\n      [\n        {\n          op: \"replace\",\n          path: \"weight\",\n          value: 2,\n        },\n      ],\n      pgettext(\"thread moderation\", \"Thread has been pinned globally.\")\n    )\n  }\n\n  pinLocally = () => {\n    this.callApi(\n      [\n        {\n          op: \"replace\",\n          path: \"weight\",\n          value: 1,\n        },\n      ],\n      pgettext(\"thread moderation\", \"Thread has been pinned in category.\")\n    )\n  }\n\n  unpin = () => {\n    this.callApi(\n      [\n        {\n          op: \"replace\",\n          path: \"weight\",\n          value: 0,\n        },\n      ],\n      pgettext(\"thread moderation\", \"Thread has been unpinned.\")\n    )\n  }\n\n  approve = () => {\n    this.callApi(\n      [\n        {\n          op: \"replace\",\n          path: \"is-unapproved\",\n          value: false,\n        },\n      ],\n      pgettext(\"thread moderation\", \"Thread has been approved.\")\n    )\n  }\n\n  open = () => {\n    this.callApi(\n      [\n        {\n          op: \"replace\",\n          path: \"is-closed\",\n          value: false,\n        },\n      ],\n      gettext(\"Thread has been opened.\")\n    )\n  }\n\n  close = () => {\n    this.callApi(\n      [\n        {\n          op: \"replace\",\n          path: \"is-closed\",\n          value: true,\n        },\n      ],\n      pgettext(\"thread moderation\", \"Thread has been closed.\")\n    )\n  }\n\n  unhide = () => {\n    this.callApi(\n      [\n        {\n          op: \"replace\",\n          path: \"is-hidden\",\n          value: false,\n        },\n      ],\n      pgettext(\"thread moderation\", \"Thread has been made visible.\")\n    )\n  }\n\n  hide = () => {\n    this.callApi(\n      [\n        {\n          op: \"replace\",\n          path: \"is-hidden\",\n          value: true,\n        },\n      ],\n      pgettext(\"thread moderation\", \"Thread has been made hidden.\")\n    )\n  }\n\n  move = () => {\n    modal.show(\n      <MoveModal posts={this.props.posts} thread={this.props.thread} />\n    )\n  }\n\n  merge = () => {\n    modal.show(<MergeModal thread={this.props.thread} />)\n  }\n\n  delete = () => {\n    if (\n      !window.confirm(\n        pgettext(\n          \"thread moderation\",\n          \"Are you sure you want to delete this thread?\"\n        )\n      )\n    ) {\n      return\n    }\n\n    store.dispatch(thread.busy())\n\n    ajax.delete(this.props.thread.api.index).then(\n      (data) => {\n        snackbar.success(\n          pgettext(\"thread moderation\", \"Thread has been deleted.\")\n        )\n        window.location = this.props.thread.category.url.index\n      },\n      (rejection) => {\n        store.dispatch(thread.release())\n        snackbar.apiError(rejection)\n      }\n    )\n  }\n\n  render() {\n    const { moderation } = this.props\n\n    return (\n      <ul className=\"dropdown-menu dropdown-menu-right stick-to-bottom\">\n        {!!moderation.edit && (\n          <li>\n            <button\n              className=\"btn btn-link\"\n              onClick={this.changeTitle}\n              type=\"button\"\n            >\n              <span className=\"material-icon\">edit</span>\n              {pgettext(\"thread moderation btn\", \"Change title\")}\n            </button>\n          </li>\n        )}\n        {!!moderation.pinGlobally && (\n          <li>\n            <button\n              className=\"btn btn-link\"\n              onClick={this.pinGlobally}\n              type=\"button\"\n            >\n              <span className=\"material-icon\">bookmark</span>\n              {pgettext(\"thread moderation btn\", \"Pin globally\")}\n            </button>\n          </li>\n        )}\n        {!!moderation.pinLocally && (\n          <li>\n            <button\n              className=\"btn btn-link\"\n              onClick={this.pinLocally}\n              type=\"button\"\n            >\n              <span className=\"material-icon\">bookmark_border</span>\n              {pgettext(\"thread moderation btn\", \"Pin in category\")}\n            </button>\n          </li>\n        )}\n        {!!moderation.unpin && (\n          <li>\n            <button className=\"btn btn-link\" onClick={this.unpin} type=\"button\">\n              <span className=\"material-icon\">panorama_fish_eye</span>\n              {pgettext(\"thread moderation btn\", \"Unpin\")}\n            </button>\n          </li>\n        )}\n        {!!moderation.move && (\n          <li>\n            <button className=\"btn btn-link\" onClick={this.move} type=\"button\">\n              <span className=\"material-icon\">arrow_forward</span>\n              {pgettext(\"thread moderation btn\", \"Move\")}\n            </button>\n          </li>\n        )}\n        {!!moderation.merge && (\n          <li>\n            <button className=\"btn btn-link\" onClick={this.merge} type=\"button\">\n              <span className=\"material-icon\">call_merge</span>\n              {pgettext(\"thread moderation btn\", \"Merge\")}\n            </button>\n          </li>\n        )}\n        {!!moderation.approve && (\n          <li>\n            <button\n              className=\"btn btn-link\"\n              onClick={this.approve}\n              type=\"button\"\n            >\n              <span className=\"material-icon\">done</span>\n              {pgettext(\"thread moderation btn\", \"Approve\")}\n            </button>\n          </li>\n        )}\n        {!!moderation.open && (\n          <li>\n            <button className=\"btn btn-link\" onClick={this.open} type=\"button\">\n              <span className=\"material-icon\">lock_open</span>\n              {pgettext(\"thread moderation btn\", \"Open\")}\n            </button>\n          </li>\n        )}\n        {!!moderation.close && (\n          <li>\n            <button className=\"btn btn-link\" onClick={this.close} type=\"button\">\n              <span className=\"material-icon\">lock_outline</span>\n              {pgettext(\"thread moderation btn\", \"Close\")}\n            </button>\n          </li>\n        )}\n        {!!moderation.unhide && (\n          <li>\n            <button\n              className=\"btn btn-link\"\n              onClick={this.unhide}\n              type=\"button\"\n            >\n              <span className=\"material-icon\">visibility</span>\n              {pgettext(\"thread moderation btn\", \"Unhide\")}\n            </button>\n          </li>\n        )}\n        {!!moderation.hide && (\n          <li>\n            <button className=\"btn btn-link\" onClick={this.hide} type=\"button\">\n              <span className=\"material-icon\">visibility_off</span>\n              {pgettext(\"thread moderation btn\", \"Hide\")}\n            </button>\n          </li>\n        )}\n        {!!moderation.delete && (\n          <li>\n            <button\n              className=\"btn btn-link\"\n              onClick={this.delete}\n              type=\"button\"\n            >\n              <span className=\"material-icon\">clear</span>\n              {pgettext(\"thread moderation btn\", \"Delete\")}\n            </button>\n          </li>\n        )}\n      </ul>\n    )\n  }\n}\n","import ThreadModerationOptions from \"./controls\"\n\nexport default ThreadModerationOptions\n","import React from \"react\"\nimport ThreadModerationOptions from \"./moderation/thread\"\n\nconst ThreadModeration = ({ thread, posts, moderation }) => (\n  <div className=\"dropdown\">\n    <button\n      type=\"button\"\n      className=\"btn btn-default btn-outline btn-icon dropdown-toggle\"\n      title={pgettext(\"thread options btn\", \"Thread options\")}\n      data-toggle=\"dropdown\"\n      aria-haspopup=\"true\"\n      aria-expanded=\"false\"\n      disabled={thread.isBusy}\n    >\n      <span className=\"material-icon\">settings</span>\n    </button>\n    <ThreadModerationOptions\n      thread={thread}\n      posts={posts}\n      moderation={moderation}\n    />\n  </div>\n)\n\nexport default ThreadModeration\n","import classnames from \"classnames\"\nimport React from \"react\"\nimport { connect } from \"react-redux\"\nimport { update } from \"../../reducers/thread\"\nimport snackbar from \"../../services/snackbar\"\nimport { ApiMutation } from \"../Api\"\nimport { DropdownSubheader } from \"../Dropdown\"\n\nconst ThreadWatchButton = ({ dispatch, dropup, stickToBottom, thread }) => (\n  <ApiMutation url={thread.api.watch}>\n    {(mutate, { loading }) => {\n      function setNotifications(notifications) {\n        if (thread.notifications !== notifications) {\n          dispatch(update({ notifications }))\n          mutate({\n            json: { notifications },\n            onError: (error) => {\n              snackbar.apiError(error)\n              dispatch(update({ notifications: thread.notifications }))\n            },\n          })\n        }\n      }\n\n      return (\n        <div className={dropup ? \"dropup\" : \"dropdown\"}>\n          <button\n            className=\"btn btn-default btn-outline btn-block\"\n            aria-expanded=\"true\"\n            aria-haspopup=\"true\"\n            data-toggle=\"dropdown\"\n            type=\"button\"\n          >\n            <span className=\"material-icon\">\n              {getIcon(thread.notifications)}\n            </span>\n            {getLabel(thread.notifications)}\n          </button>\n          <ul\n            className={classnames(\"dropdown-menu dropdown-menu-right\", {\n              \"stick-to-bottom\": stickToBottom,\n            })}\n          >\n            <DropdownSubheader>\n              {pgettext(\"watch thread\", \"Notify about new replies\")}\n            </DropdownSubheader>\n            <li>\n              <button\n                className=\"btn btn-link\"\n                disabled={loading}\n                onClick={() => setNotifications(2)}\n              >\n                <span className=\"material-icon\">mail</span>\n                {pgettext(\"watch thread\", \"On site and with e-mail\")}\n              </button>\n            </li>\n            <li>\n              <button\n                className=\"btn btn-link\"\n                disabled={loading}\n                onClick={() => setNotifications(1)}\n              >\n                <span className=\"material-icon\">notifications_active</span>\n                {pgettext(\"watch thread\", \"On site only\")}\n              </button>\n            </li>\n            <li>\n              <button\n                className=\"btn btn-link\"\n                disabled={loading}\n                onClick={() => setNotifications(0)}\n              >\n                <span className=\"material-icon\">notifications_none</span>\n                {pgettext(\"watch thread\", \"Don't notify\")}\n              </button>\n            </li>\n          </ul>\n        </div>\n      )\n    }}\n  </ApiMutation>\n)\n\nfunction getIcon(notifications) {\n  if (notifications === 2) return \"mail\"\n  if (notifications === 1) return \"notifications_active\"\n\n  return \"notifications_none\"\n}\n\nfunction getLabel(notifications) {\n  if (notifications) {\n    return pgettext(\"watch thread\", \"Watching\")\n  }\n\n  return pgettext(\"watch thread\", \"Watch\")\n}\n\nconst ThreadWatchButtonConnected = connect()(ThreadWatchButton)\n\nexport default ThreadWatchButtonConnected\n","import classnames from \"classnames\"\nimport React from \"react\"\n\nconst Breadcrumbs = ({ children, className }) => (\n  <ul className={classnames(\"breadcrumbs\", className)}>{children}</ul>\n)\n\nexport default Breadcrumbs\n","import classnames from \"classnames\"\nimport React from \"react\"\n\nconst BreadcrumbsCategory = ({ category, className }) => (\n  <li className={classnames(\"breadcrumbs-item\", className)}>\n    <a href={category.url.index}>\n      <span\n        className=\"material-icon\"\n        style={{ color: category.color || \"inherit\" }}\n      >\n        label\n      </span>\n      {!!category.short_name && (\n        <span\n          className=\"breadcrumbs-item-name hidden-sm hidden-md hidden-lg\"\n          title={category.name}\n        >\n          {category.short_name}\n        </span>\n      )}\n      {!!category.short_name && (\n        <span className=\"breadcrumbs-item-name hidden-xs\">{category.name}</span>\n      )}\n      {!category.short_name && (\n        <span className=\"breadcrumbs-item-name\">{category.name}</span>\n      )}\n    </a>\n  </li>\n)\n\nexport default BreadcrumbsCategory\n","import classnames from \"classnames\"\nimport React from \"react\"\n\nconst BreadcrumbsRootCategory = ({ category, className }) => (\n  <li className={classnames(\"breadcrumbs-item\", className)}>\n    <a href={category.url.index}>\n      <span className=\"material-icon\">chevron_right</span>\n      <span className=\"breadcrumbs-item-name\">\n        {category.special_role === \"root_category\"\n          ? pgettext(\"breadcrumb\", \"Threads\")\n          : pgettext(\"breadcrumb\", \"Private threads\")}\n      </span>\n    </a>\n  </li>\n)\n\nexport default BreadcrumbsRootCategory\n","import React from \"react\"\nimport {\n  Breadcrumbs,\n  BreadcrumbsCategory,\n  BreadcrumbsRootCategory,\n} from \"../../Breadcrumbs\"\n\nconst ThreadHeaderBreadcrumbs = ({ breadcrumbs }) => (\n  <Breadcrumbs>\n    {breadcrumbs.map((category) =>\n      category.special_role ? (\n        <BreadcrumbsRootCategory key={category.id} category={category} />\n      ) : (\n        <BreadcrumbsCategory key={category.id} category={category} />\n      )\n    )}\n  </Breadcrumbs>\n)\n\nexport default ThreadHeaderBreadcrumbs\n","import React from \"react\"\nimport { FlexRow, FlexRowCol, FlexRowSection } from \"../../FlexRow\"\nimport ThreadFlags from \"../../ThreadFlags\"\nimport ThreadReplies from \"../../ThreadReplies\"\nimport ThreadStarterCard from \"../../ThreadStarterCard\"\nimport {\n  PageHeader,\n  PageHeaderBanner,\n  PageHeaderContainer,\n  PageHeaderDetails,\n} from \"../../PageHeader\"\nimport ThreadModeration from \"../ThreadModeration\"\nimport ThreadWatchButton from \"../ThreadWatchButton\"\nimport ThreadHeaderBreadcrumbs from \"./ThreadHeaderBreadcrumbs\"\n\nconst ThreadHeader = ({ styleName, thread, posts, user, moderation }) => (\n  <PageHeaderContainer>\n    <PageHeader styleName={styleName}>\n      <PageHeaderBanner styleName={styleName}>\n        <ThreadHeaderBreadcrumbs breadcrumbs={thread.path} />\n        <h1>{thread.title}</h1>\n      </PageHeaderBanner>\n      <PageHeaderDetails className=\"page-header-thread-details\">\n        <FlexRow>\n          <FlexRowSection auto>\n            <FlexRowCol shrink>\n              <ThreadStarterCard thread={thread} />\n            </FlexRowCol>\n            <FlexRowCol auto />\n            {thread.replies > 0 && (\n              <FlexRowCol shrink>\n                <ThreadReplies thread={thread} />\n              </FlexRowCol>\n            )}\n            {hasFlags(thread) && (\n              <FlexRowCol shrink>\n                <ThreadFlags thread={thread} />\n              </FlexRowCol>\n            )}\n          </FlexRowSection>\n          {user.is_authenticated && (\n            <FlexRowSection>\n              <FlexRowCol>\n                <ThreadWatchButton thread={thread} />\n              </FlexRowCol>\n              {moderation.enabled && (\n                <FlexRowCol shrink>\n                  <ThreadModeration\n                    thread={thread}\n                    posts={posts}\n                    moderation={moderation}\n                  />\n                </FlexRowCol>\n              )}\n            </FlexRowSection>\n          )}\n        </FlexRow>\n      </PageHeaderDetails>\n    </PageHeader>\n  </PageHeaderContainer>\n)\n\nconst hasFlags = (thread) => {\n  return (\n    thread.is_closed ||\n    thread.is_hidden ||\n    thread.is_unapproved ||\n    thread.weight > 0 ||\n    thread.best_answer ||\n    thread.has_poll ||\n    thread.has_unapproved_posts\n  )\n}\n\nexport default ThreadHeader\n","import ThreadHeader from \"./ThreadHeader\"\n\nexport default ThreadHeader\n","import React from \"react\"\nimport { Link, withRouter } from \"react-router\"\nimport { Dropdown } from \"../Dropdown\"\n\nconst ThreadPaginator = ({ router, baseUrl, posts, scrollToTop }) => (\n  <div className=\"thread-paginator\">\n    {posts.isLoaded && posts.first ? (\n      <Link\n        className=\"btn btn-default btn-outline btn-icon\"\n        to={baseUrl}\n        title={pgettext(\"paginator\", \"Go to first page\")}\n        onClick={scrollToTop ? resetScroll : null}\n      >\n        <span className=\"material-icon\">first_page</span>\n      </Link>\n    ) : (\n      <button\n        className=\"btn btn-default btn-outline btn-icon\"\n        title={pgettext(\"paginator\", \"Go to first page\")}\n        type=\"button\"\n        disabled\n      >\n        <span className=\"material-icon\">first_page</span>\n      </button>\n    )}\n    {posts.isLoaded && posts.previous ? (\n      <Link\n        className=\"btn btn-default btn-outline btn-icon\"\n        to={baseUrl + (posts.previous > 1 ? posts.previous + \"/\" : \"\")}\n        title={pgettext(\"paginator\", \"Go to previous page\")}\n        onClick={scrollToTop ? resetScroll : null}\n      >\n        <span className=\"material-icon\">chevron_left</span>\n      </Link>\n    ) : (\n      <button\n        className=\"btn btn-default btn-outline btn-icon\"\n        title={pgettext(\"paginator\", \"Go to previous page\")}\n        type=\"button\"\n        disabled\n      >\n        <span className=\"material-icon\">chevron_left</span>\n      </button>\n    )}\n    <Dropdown\n      toggle={({ aria, toggle }) => (\n        <button\n          {...aria}\n          className=\"btn btn-default btn-block btn-outline\"\n          type=\"button\"\n          disabled={!posts.isLoaded}\n          onClick={toggle}\n        >\n          {getLabel(posts.page, posts.pages)}\n        </button>\n      )}\n      onOpen={(dropdown) => {\n        dropdown.querySelector(\"input\").focus()\n      }}\n    >\n      {({ close }) => (\n        <form\n          className=\"thread-paginator-form\"\n          onSubmit={(event) => {\n            if (posts.isLoaded) {\n              const formData = new FormData(event.target)\n              const page = parseInt(formData.get(\"page\"))\n\n              if (\n                page &&\n                page != posts.page &&\n                page >= 1 &&\n                page <= posts.pages\n              ) {\n                const url = page > 1 ? baseUrl + page + \"/\" : baseUrl\n                router.push({ pathname: url })\n              }\n            }\n\n            event.preventDefault()\n            close()\n\n            if (scrollToTop) {\n              resetScroll()\n            }\n          }}\n        >\n          <input\n            className=\"form-control\"\n            name=\"page\"\n            type=\"number\"\n            min={1}\n            max={posts.pages}\n            placeholder={pgettext(\"paginator input\", \"Page\")}\n            disabled={!posts.isLoaded}\n          />\n          <button\n            className=\"btn btn-primary\"\n            type=\"submit\"\n            disabled={!posts.isLoaded}\n          >\n            {pgettext(\"paginator\", \"Go\")}\n          </button>\n        </form>\n      )}\n    </Dropdown>\n    {posts.isLoaded && posts.next ? (\n      <Link\n        className=\"btn btn-default btn-outline btn-icon\"\n        to={baseUrl + posts.next + \"/\"}\n        title={pgettext(\"paginator\", \"Go to next page\")}\n        onClick={scrollToTop ? resetScroll : null}\n      >\n        <span className=\"material-icon\">chevron_right</span>\n      </Link>\n    ) : (\n      <button\n        className=\"btn btn-default btn-outline btn-icon\"\n        title={pgettext(\"paginator\", \"Go to next page\")}\n        type=\"button\"\n        disabled\n      >\n        <span className=\"material-icon\">chevron_right</span>\n      </button>\n    )}\n    {posts.isLoaded && posts.last ? (\n      <Link\n        className=\"btn btn-default btn-outline btn-icon\"\n        to={baseUrl + posts.last + \"/\"}\n        title={pgettext(\"paginator\", \"Go to last page\")}\n        onClick={scrollToTop ? resetScroll : null}\n      >\n        <span className=\"material-icon\">last_page</span>\n      </Link>\n    ) : (\n      <button\n        className=\"btn btn-default btn-outline btn-icon\"\n        title={pgettext(\"paginator\", \"Go to last page\")}\n        type=\"button\"\n        disabled\n      >\n        <span className=\"material-icon\">last_page</span>\n      </button>\n    )}\n  </div>\n)\n\nfunction getLabel(page, pages) {\n  return pgettext(\"paginator\", \"Page %(page)s of %(pages)s\")\n    .replace(\"%(page)s\", page)\n    .replace(\"%(pages)s\", pages)\n}\n\nfunction resetScroll() {\n  window.scrollTo(0, 0)\n}\n\nconst ThreadPaginatorConnected = withRouter(ThreadPaginator)\n\nexport default ThreadPaginatorConnected\n","import React from \"react\"\n\nexport default function ({ errors, posts }) {\n  return (\n    <div className=\"modal-dialog\" role=\"document\">\n      <div className=\"modal-content\">\n        <div className=\"modal-header\">\n          <button\n            aria-label={pgettext(\"modal\", \"Close\")}\n            className=\"close\"\n            data-dismiss=\"modal\"\n            type=\"button\"\n          >\n            <span aria-hidden=\"true\">&times;</span>\n          </button>\n          <h4 className=\"modal-title\">\n            {pgettext(\"thread posts moderation modal title\", \"Moderation\")}\n          </h4>\n        </div>\n        <div className=\"modal-body\">\n          <p className=\"lead\">\n            {pgettext(\n              \"thread posts moderation modal\",\n              \"One or more posts could not be changed:\"\n            )}\n          </p>\n\n          <ul className=\"list-unstyled list-errored-items\">\n            {errors.map((post) => {\n              return (\n                <PostErrors\n                  errors={post.detail}\n                  key={post.id}\n                  post={posts[post.id]}\n                />\n              )\n            })}\n          </ul>\n        </div>\n      </div>\n    </div>\n  )\n}\n\nexport function PostErrors({ errors, post }) {\n  const heading = interpolate(\n    pgettext(\"thread posts moderation modal\", \"%(username)s on %(posted_on)s\"),\n    {\n      posted_on: post.posted_on.format(\"LL, LT\"),\n      username: post.poster_name,\n    },\n    true\n  )\n\n  return (\n    <li>\n      <h5>{heading}:</h5>\n      {errors.map((error, i) => {\n        return <p key={i}>{error}</p>\n      })}\n    </li>\n  )\n}\n","import moment from \"moment\"\nimport React from \"react\"\nimport * as post from \"misago/reducers/post\"\nimport * as posts from \"misago/reducers/posts\"\nimport ajax from \"misago/services/ajax\"\nimport modal from \"misago/services/modal\"\nimport snackbar from \"misago/services/snackbar\"\nimport store from \"misago/services/store\"\nimport ErrorsList from \"./errors-list\"\n\nexport function approve(props) {\n  const { selection } = props\n\n  const ops = [{ op: \"replace\", path: \"is-unapproved\", value: false }]\n\n  const newState = selection.map((post) => {\n    return {\n      id: post.id,\n      is_unapproved: false,\n    }\n  })\n\n  const previousState = selection.map((post) => {\n    return {\n      id: post.id,\n      is_unapproved: post.is_unapproved,\n    }\n  })\n\n  patch(props, ops, newState, previousState)\n}\n\nexport function protect(props) {\n  const { selection } = props\n\n  const ops = [{ op: \"replace\", path: \"is-protected\", value: true }]\n\n  const newState = selection.map((post) => {\n    return {\n      id: post.id,\n      is_protected: true,\n    }\n  })\n\n  const previousState = selection.map((post) => {\n    return {\n      id: post.id,\n      is_protected: post.is_protected,\n    }\n  })\n\n  patch(props, ops, newState, previousState)\n}\n\nexport function unprotect(props) {\n  const { selection } = props\n\n  const ops = [{ op: \"replace\", path: \"is-protected\", value: false }]\n\n  const newState = selection.map((post) => {\n    return {\n      id: post.id,\n      is_protected: false,\n    }\n  })\n\n  const previousState = selection.map((post) => {\n    return {\n      id: post.id,\n      is_protected: post.is_protected,\n    }\n  })\n\n  patch(props, ops, newState, previousState)\n}\n\nexport function hide(props) {\n  const { selection } = props\n\n  const ops = [{ op: \"replace\", path: \"is-hidden\", value: true }]\n\n  const newState = selection.map((post) => {\n    return {\n      id: post.id,\n      is_hidden: true,\n      hidden_on: moment(),\n      hidden_by_name: props.user.username,\n      url: Object.assign(post.url, {\n        hidden_by: props.user.url,\n      }),\n    }\n  })\n\n  const previousState = selection.map((post) => {\n    return {\n      id: post.id,\n      is_hidden: post.is_hidden,\n      hidden_on: post.hidden_on,\n      hidden_by_name: post.hidden_by_name,\n      url: post.url,\n    }\n  })\n\n  patch(props, ops, newState, previousState)\n}\n\nexport function unhide(props) {\n  const { selection } = props\n\n  const ops = [{ op: \"replace\", path: \"is-hidden\", value: false }]\n\n  const newState = selection.map((post) => {\n    return {\n      id: post.id,\n      is_hidden: false,\n      hidden_on: moment(),\n      hidden_by_name: props.user.username,\n      url: Object.assign(post.url, {\n        hidden_by: props.user.url,\n      }),\n    }\n  })\n\n  const previousState = selection.map((post) => {\n    return {\n      id: post.id,\n      is_hidden: post.is_hidden,\n      hidden_on: post.hidden_on,\n      hidden_by_name: post.hidden_by_name,\n      url: post.url,\n    }\n  })\n\n  patch(props, ops, newState, previousState)\n}\n\nexport function patch(props, ops, newState, previousState) {\n  const { selection, thread } = props\n\n  // patch selected items\n  newState.forEach((item) => {\n    post.patch(item, item)\n  })\n\n  // deselect all the things\n  store.dispatch(posts.deselectAll())\n\n  // call ajax\n  const data = {\n    ops,\n\n    ids: selection.map((post) => {\n      return post.id\n    }),\n  }\n\n  ajax.patch(thread.api.posts.index, data).then(\n    (data) => {\n      data.forEach((item) => {\n        store.dispatch(post.patch(item, item))\n      })\n    },\n    (rejection) => {\n      if (rejection.status !== 400) {\n        // rollback all\n        previousState.forEach((item) => {\n          store.dispatch(post.patch(item, item))\n        })\n        return snackbar.apiError(rejection)\n      }\n\n      let errors = []\n      let rollback = []\n\n      rejection.forEach((item) => {\n        if (item.detail) {\n          errors.push(item)\n          rollback.push(item.id)\n        } else {\n          store.dispatch(post.patch(item, item))\n        }\n\n        previousState.forEach((item) => {\n          if (rollback.indexOf(item) !== -1) {\n            store.dispatch(post.patch(item, item))\n          }\n        })\n      })\n\n      let posts = {}\n      selection.forEach((item) => {\n        posts[item.id] = item\n      })\n\n      modal.show(<ErrorsList errors={errors} posts={posts} />)\n    }\n  )\n}\n\nexport function merge(props) {\n  let confirmed = window.confirm(\n    pgettext(\n      \"merge posts\",\n      \"Are you sure you want to merge selected posts? This action is not reversible!\"\n    )\n  )\n  if (!confirmed) {\n    return\n  }\n\n  props.selection.slice(1).map((selection) => {\n    store.dispatch(\n      post.patch(selection, {\n        isDeleted: true,\n      })\n    )\n  })\n\n  ajax\n    .post(props.thread.api.posts.merge, {\n      posts: props.selection.map((post) => post.id),\n    })\n    .then(\n      (data) => {\n        store.dispatch(post.patch(data, post.hydrate(data)))\n      },\n      (rejection) => {\n        if (rejection.status === 400) {\n          snackbar.error(rejection.detail)\n        } else {\n          snackbar.apiError(rejection)\n        }\n\n        props.selection.slice(1).map((selection) => {\n          store.dispatch(\n            post.patch(selection, {\n              isDeleted: false,\n            })\n          )\n        })\n      }\n    )\n\n  store.dispatch(posts.deselectAll())\n}\n\nexport function remove(props) {\n  let confirmed = window.confirm(\n    pgettext(\n      \"delete posts\",\n      \"Are you sure you want to delete selected posts? This action is not reversible!\"\n    )\n  )\n  if (!confirmed) {\n    return\n  }\n\n  props.selection.map((selection) => {\n    store.dispatch(\n      post.patch(selection, {\n        isDeleted: true,\n      })\n    )\n  })\n\n  const ids = props.selection.map((post) => {\n    return post.id\n  })\n\n  ajax.delete(props.thread.api.posts.index, ids).then(\n    () => {\n      return\n    },\n    (rejection) => {\n      if (rejection.status === 400) {\n        snackbar.error(rejection.detail)\n      } else {\n        snackbar.apiError(rejection)\n      }\n\n      props.selection.map((selection) => {\n        store.dispatch(\n          post.patch(selection, {\n            isDeleted: false,\n          })\n        )\n      })\n    }\n  )\n\n  store.dispatch(posts.deselectAll())\n}\n","import React from \"react\"\nimport Button from \"misago/components/button\"\nimport Form from \"misago/components/form\"\nimport FormGroup from \"misago/components/form-group\"\nimport * as post from \"misago/reducers/post\"\nimport ajax from \"misago/services/ajax\"\nimport modal from \"misago/services/modal\"\nimport snackbar from \"misago/services/snackbar\"\nimport store from \"misago/services/store\"\n\nexport default class extends Form {\n  constructor(props) {\n    super(props)\n\n    this.state = {\n      isLoading: false,\n\n      url: \"\",\n\n      validators: {\n        url: [],\n      },\n      errors: {},\n    }\n  }\n\n  clean() {\n    if (!this.state.url.trim().length) {\n      snackbar.error(\n        pgettext(\n          \"thread posts moderation move\",\n          \"You have to enter link to the other thread.\"\n        )\n      )\n      return false\n    }\n\n    return true\n  }\n\n  send() {\n    return ajax.post(this.props.thread.api.posts.move, {\n      new_thread: this.state.url,\n      posts: this.props.selection.map((post) => post.id),\n    })\n  }\n\n  handleSuccess(success) {\n    this.props.selection.forEach((selection) => {\n      store.dispatch(\n        post.patch(selection, {\n          isDeleted: true,\n        })\n      )\n    })\n\n    modal.hide()\n\n    snackbar.success(\n      pgettext(\n        \"thread posts moderation move\",\n        \"Selected posts were moved to the other thread.\"\n      )\n    )\n  }\n\n  handleError(rejection) {\n    if (rejection.status === 400) {\n      snackbar.error(rejection.detail)\n    } else {\n      snackbar.apiError(rejection)\n    }\n  }\n\n  onUrlChange = (event) => {\n    this.changeValue(\"url\", event.target.value)\n  }\n\n  render() {\n    return (\n      <div className=\"modal-dialog\" role=\"document\">\n        <form onSubmit={this.handleSubmit}>\n          <div className=\"modal-content\">\n            <ModalHeader />\n            <div className=\"modal-body\">\n              <FormGroup\n                for=\"id_url\"\n                label={pgettext(\n                  \"thread posts moderation move\",\n                  \"Link to thread you want to move posts to\"\n                )}\n              >\n                <input\n                  className=\"form-control\"\n                  disabled={this.state.isLoading}\n                  id=\"id_url\"\n                  onChange={this.onUrlChange}\n                  value={this.state.url}\n                />\n              </FormGroup>\n            </div>\n            <div className=\"modal-footer\">\n              <button\n                className=\"btn btn-default\"\n                data-dismiss=\"modal\"\n                disabled={this.state.isLoading}\n                type=\"button\"\n              >\n                {pgettext(\"thread posts moderation move btn\", \"Cancel\")}\n              </button>\n              <button\n                className=\"btn btn-primary\"\n                disabled={this.state.isLoading}\n              >\n                {pgettext(\"thread posts moderation move btn\", \"Move posts\")}\n              </button>\n            </div>\n          </div>\n        </form>\n      </div>\n    )\n  }\n}\n\nexport function ModalHeader(props) {\n  return (\n    <div className=\"modal-header\">\n      <button\n        aria-label={pgettext(\"modal\", \"Close\")}\n        className=\"close\"\n        data-dismiss=\"modal\"\n        type=\"button\"\n      >\n        <span aria-hidden=\"true\">&times;</span>\n      </button>\n      <h4 className=\"modal-title\">\n        {pgettext(\"thread posts moderation move title\", \"Move posts\")}\n      </h4>\n    </div>\n  )\n}\n","import React from \"react\"\nimport Button from \"misago/components/button\"\nimport Form from \"misago/components/form\"\nimport FormGroup from \"misago/components/form-group\"\nimport CategorySelect from \"misago/components/category-select\"\nimport ModalLoader from \"misago/components/modal-loader\"\nimport Select from \"misago/components/select\"\nimport * as post from \"misago/reducers/post\"\nimport ajax from \"misago/services/ajax\"\nimport modal from \"misago/services/modal\"\nimport snackbar from \"misago/services/snackbar\"\nimport store from \"misago/services/store\"\nimport * as validators from \"misago/utils/validators\"\nimport ErrorsModal from \"./errors-list\"\n\nexport default function (props) {\n  return <PostingConfig {...props} Form={ModerationForm} />\n}\n\nexport class PostingConfig extends React.Component {\n  constructor(props) {\n    super(props)\n\n    this.state = {\n      isLoaded: false,\n      isError: false,\n\n      categories: [],\n    }\n  }\n\n  componentDidMount() {\n    ajax.get(misago.get(\"THREAD_EDITOR_API\")).then(\n      (data) => {\n        // hydrate categories, extract posting options\n        const categories = data.map((item) => {\n          return Object.assign(item, {\n            disabled: item.post === false,\n            label: item.name,\n            value: item.id,\n            post: item.post,\n          })\n        })\n\n        this.setState({\n          isLoaded: true,\n          categories,\n        })\n      },\n      (rejection) => {\n        this.setState({\n          isError: rejection.detail,\n        })\n      }\n    )\n  }\n\n  render() {\n    if (this.state.isError) {\n      return <Error message={this.state.isError} />\n    } else if (this.state.isLoaded) {\n      return (\n        <ModerationForm {...this.props} categories={this.state.categories} />\n      )\n    } else {\n      return <Loader />\n    }\n  }\n}\n\nexport class ModerationForm extends Form {\n  constructor(props) {\n    super(props)\n\n    this.state = {\n      isLoading: false,\n\n      title: \"\",\n      category: null,\n      categories: props.categories,\n      weight: 0,\n      is_hidden: 0,\n      is_closed: false,\n\n      validators: {\n        title: [validators.required()],\n      },\n\n      errors: {},\n    }\n\n    this.isHiddenChoices = [\n      {\n        value: 0,\n        icon: \"visibility\",\n        label: pgettext(\"thread hidden switch choice\", \"No\"),\n      },\n      {\n        value: 1,\n        icon: \"visibility_off\",\n        label: pgettext(\"thread hidden switch choice\", \"Yes\"),\n      },\n    ]\n\n    this.isClosedChoices = [\n      {\n        value: false,\n        icon: \"lock_outline\",\n        label: pgettext(\"thread closed switch choice\", \"No\"),\n      },\n      {\n        value: true,\n        icon: \"lock\",\n        label: pgettext(\"thread closed switch choice\", \"Yes\"),\n      },\n    ]\n\n    this.acl = {}\n    this.props.categories.forEach((category) => {\n      if (category.post) {\n        if (!this.state.category) {\n          this.state.category = category.id\n        }\n\n        this.acl[category.id] = {\n          can_pin_threads: category.post.pin,\n          can_close_threads: category.post.close,\n          can_hide_threads: category.post.hide,\n        }\n      }\n    })\n  }\n\n  clean() {\n    if (this.isValid()) {\n      return true\n    } else {\n      snackbar.error(gettext(\"Form contains errors.\"))\n      this.setState({\n        errors: this.validate(),\n      })\n      return false\n    }\n  }\n\n  send() {\n    return ajax.post(this.props.thread.api.posts.split, {\n      title: this.state.title,\n      category: this.state.category,\n      weight: this.state.weight,\n      is_hidden: this.state.is_hidden,\n      is_closed: this.state.is_closed,\n      posts: this.props.selection.map((post) => post.id),\n    })\n  }\n\n  handleSuccess(apiResponse) {\n    this.props.selection.forEach((selection) => {\n      store.dispatch(\n        post.patch(selection, {\n          isDeleted: true,\n        })\n      )\n    })\n\n    modal.hide()\n\n    snackbar.success(\n      pgettext(\n        \"posts moderation split\",\n        \"Selected posts were split into new thread.\"\n      )\n    )\n  }\n\n  handleError(rejection) {\n    if (rejection.status === 400) {\n      this.setState({\n        errors: Object.assign({}, this.state.errors, rejection),\n      })\n      snackbar.error(gettext(\"Form contains errors.\"))\n    } else if (rejection.status === 403 && Array.isArray(rejection)) {\n      modal.show(<ErrorsModal errors={rejection} />)\n    } else {\n      snackbar.apiError(rejection)\n    }\n  }\n\n  onCategoryChange = (ev) => {\n    const categoryId = ev.target.value\n    const newState = {\n      category: categoryId,\n    }\n\n    if (this.acl[categoryId].can_pin_threads < newState.weight) {\n      newState.weight = 0\n    }\n\n    if (!this.acl[categoryId].can_hide_threads) {\n      newState.is_hidden = 0\n    }\n\n    if (!this.acl[categoryId].can_close_threads) {\n      newState.is_closed = false\n    }\n\n    this.setState(newState)\n  }\n\n  getWeightChoices() {\n    const choices = [\n      {\n        value: 0,\n        icon: \"remove\",\n        label: pgettext(\"thread weight choice\", \"Not pinned\"),\n      },\n      {\n        value: 1,\n        icon: \"bookmark_border\",\n        label: pgettext(\"thread weight choice\", \"Pinned in category\"),\n      },\n    ]\n\n    if (this.acl[this.state.category].can_pin_threads == 2) {\n      choices.push({\n        value: 2,\n        icon: \"bookmark\",\n        label: pgettext(\"thread weight choice\", \"Pinned globally\"),\n      })\n    }\n\n    return choices\n  }\n\n  renderWeightField() {\n    if (this.acl[this.state.category].can_pin_threads) {\n      return (\n        <FormGroup\n          label={pgettext(\"posts moderation split field\", \"Thread weight\")}\n          for=\"id_weight\"\n          labelClass=\"col-sm-4\"\n          controlClass=\"col-sm-8\"\n        >\n          <Select\n            id=\"id_weight\"\n            onChange={this.bindInput(\"weight\")}\n            value={this.state.weight}\n            choices={this.getWeightChoices()}\n          />\n        </FormGroup>\n      )\n    } else {\n      return null\n    }\n  }\n\n  renderHiddenField() {\n    if (this.acl[this.state.category].can_hide_threads) {\n      return (\n        <FormGroup\n          label={pgettext(\"posts moderation split field\", \"Hide thread\")}\n          for=\"id_is_hidden\"\n          labelClass=\"col-sm-4\"\n          controlClass=\"col-sm-8\"\n        >\n          <Select\n            id=\"id_is_closed\"\n            onChange={this.bindInput(\"is_hidden\")}\n            value={this.state.is_hidden}\n            choices={this.isHiddenChoices}\n          />\n        </FormGroup>\n      )\n    } else {\n      return null\n    }\n  }\n\n  renderClosedField() {\n    if (this.acl[this.state.category].can_close_threads) {\n      return (\n        <FormGroup\n          label={pgettext(\"posts moderation split field\", \"Close thread\")}\n          for=\"id_is_closed\"\n          labelClass=\"col-sm-4\"\n          controlClass=\"col-sm-8\"\n        >\n          <Select\n            id=\"id_is_closed\"\n            onChange={this.bindInput(\"is_closed\")}\n            value={this.state.is_closed}\n            choices={this.isClosedChoices}\n          />\n        </FormGroup>\n      )\n    } else {\n      return null\n    }\n  }\n\n  render() {\n    return (\n      <Modal className=\"modal-dialog\">\n        <form onSubmit={this.handleSubmit}>\n          <div className=\"modal-body\">\n            <FormGroup\n              label={pgettext(\"posts moderation split field\", \"Thread title\")}\n              for=\"id_title\"\n              labelClass=\"col-sm-4\"\n              controlClass=\"col-sm-8\"\n              validation={this.state.errors.title}\n            >\n              <input\n                id=\"id_title\"\n                className=\"form-control\"\n                type=\"text\"\n                onChange={this.bindInput(\"title\")}\n                value={this.state.title}\n              />\n            </FormGroup>\n            <div className=\"clearfix\" />\n\n            <FormGroup\n              label={pgettext(\"posts moderation split field\", \"Category\")}\n              for=\"id_category\"\n              labelClass=\"col-sm-4\"\n              controlClass=\"col-sm-8\"\n              validation={this.state.errors.category}\n            >\n              <CategorySelect\n                id=\"id_category\"\n                onChange={this.onCategoryChange}\n                value={this.state.category}\n                choices={this.state.categories}\n              />\n            </FormGroup>\n            <div className=\"clearfix\" />\n\n            {this.renderWeightField()}\n            {this.renderHiddenField()}\n            {this.renderClosedField()}\n          </div>\n          <div className=\"modal-footer\">\n            <button\n              className=\"btn btn-default\"\n              data-dismiss=\"modal\"\n              disabled={this.state.isLoading}\n              type=\"button\"\n            >\n              {pgettext(\"posts moderation split btn\", \"Cancel\")}\n            </button>\n            <Button className=\"btn-primary\" loading={this.state.isLoading}>\n              {pgettext(\"posts moderation split btn\", \"Split posts\")}\n            </Button>\n          </div>\n        </form>\n      </Modal>\n    )\n  }\n}\n\nexport function Loader() {\n  return (\n    <Modal className=\"modal-dialog\">\n      <ModalLoader />\n    </Modal>\n  )\n}\n\nexport function Error(props) {\n  return (\n    <Modal className=\"modal-dialog modal-message\">\n      <div className=\"message-icon\">\n        <span className=\"material-icon\">info_outline</span>\n      </div>\n      <div className=\"message-body\">\n        <p className=\"lead\">\n          {pgettext(\n            \"posts moderation split\",\n            \"You can't move selected posts at the moment.\"\n          )}\n        </p>\n        <p>{props.message}</p>\n        <button className=\"btn btn-default\" data-dismiss=\"modal\" type=\"button\">\n          {pgettext(\"posts moderation split dismiss btn\", \"Ok\")}\n        </button>\n      </div>\n    </Modal>\n  )\n}\n\nexport function Modal(props) {\n  return (\n    <div className={props.className} role=\"document\">\n      <div className=\"modal-content\">\n        <div className=\"modal-header\">\n          <button\n            aria-label={pgettext(\"modal\", \"Close\")}\n            className=\"close\"\n            data-dismiss=\"modal\"\n            type=\"button\"\n          >\n            <span aria-hidden=\"true\">&times;</span>\n          </button>\n          <h4 className=\"modal-title\">\n            {pgettext(\n              \"posts moderation split title\",\n              \"Split posts into new thread\"\n            )}\n          </h4>\n        </div>\n        {props.children}\n      </div>\n    </div>\n  )\n}\n","import React from \"react\"\nimport modal from \"misago/services/modal\"\nimport * as moderation from \"./actions\"\nimport MoveModal from \"./move\"\nimport SplitModal from \"./split\"\n\nexport default function (props) {\n  return (\n    <ul className=\"dropdown-menu dropdown-menu-right stick-to-bottom\">\n      <Approve {...props} />\n      <Merge {...props} />\n      <Move {...props} />\n      <Split {...props} />\n      <Protect {...props} />\n      <Unprotect {...props} />\n      <Unhide {...props} />\n      <Hide {...props} />\n      <Delete {...props} />\n    </ul>\n  )\n}\n\nexport class Approve extends React.Component {\n  onClick = () => {\n    moderation.approve(this.props)\n  }\n\n  render() {\n    const isVisible = this.props.selection.find((post) => {\n      return post.acl.can_approve && post.is_unapproved\n    })\n\n    if (!isVisible) return null\n\n    return (\n      <li>\n        <button type=\"button\" className=\"btn btn-link\" onClick={this.onClick}>\n          <span className=\"material-icon\">done</span>\n          {pgettext(\"thread posts moderation\", \"Approve\")}\n        </button>\n      </li>\n    )\n  }\n}\n\nexport class Merge extends React.Component {\n  onClick = () => {\n    moderation.merge(this.props)\n  }\n\n  render() {\n    const isVisible =\n      this.props.selection.length > 1 &&\n      this.props.selection.find((post) => {\n        return post.acl.can_merge\n      })\n\n    if (!isVisible) return null\n\n    return (\n      <li>\n        <button type=\"button\" className=\"btn btn-link\" onClick={this.onClick}>\n          <span className=\"material-icon\">call_merge</span>\n          {pgettext(\"thread posts moderation\", \"Merge\")}\n        </button>\n      </li>\n    )\n  }\n}\n\nexport class Move extends React.Component {\n  onClick = () => {\n    modal.show(<MoveModal {...this.props} />)\n  }\n\n  render() {\n    const isVisible = this.props.selection.find((post) => {\n      return post.acl.can_move\n    })\n\n    if (!isVisible) return null\n\n    return (\n      <li>\n        <button type=\"button\" className=\"btn btn-link\" onClick={this.onClick}>\n          <span className=\"material-icon\">arrow_forward</span>\n          {pgettext(\"thread posts moderation\", \"Move\")}\n        </button>\n      </li>\n    )\n  }\n}\n\nexport class Split extends React.Component {\n  onClick = () => {\n    modal.show(<SplitModal {...this.props} />)\n  }\n\n  render() {\n    const isVisible = this.props.selection.find((post) => {\n      return post.acl.can_move\n    })\n\n    if (!isVisible) return null\n\n    return (\n      <li>\n        <button type=\"button\" className=\"btn btn-link\" onClick={this.onClick}>\n          <span className=\"material-icon\">call_split</span>\n          {pgettext(\"thread posts moderation\", \"Split\")}\n        </button>\n      </li>\n    )\n  }\n}\n\nexport class Protect extends React.Component {\n  onClick = () => {\n    moderation.protect(this.props)\n  }\n\n  render() {\n    const isVisible = this.props.selection.find((post) => {\n      return !post.is_protected && post.acl.can_protect\n    })\n\n    if (!isVisible) return null\n\n    return (\n      <li>\n        <button type=\"button\" className=\"btn btn-link\" onClick={this.onClick}>\n          <span className=\"material-icon\">lock_outline</span>\n          {pgettext(\"thread posts moderation\", \"Protect\")}\n        </button>\n      </li>\n    )\n  }\n}\n\nexport class Unprotect extends React.Component {\n  onClick = () => {\n    moderation.unprotect(this.props)\n  }\n\n  render() {\n    const isVisible = this.props.selection.find((post) => {\n      return post.is_protected && post.acl.can_protect\n    })\n\n    if (!isVisible) return null\n\n    return (\n      <li>\n        <button type=\"button\" className=\"btn btn-link\" onClick={this.onClick}>\n          <span className=\"material-icon\">lock_open</span>\n          {pgettext(\"thread posts moderation\", \"Unprotect\")}\n        </button>\n      </li>\n    )\n  }\n}\n\nexport class Hide extends React.Component {\n  onClick = () => {\n    moderation.hide(this.props)\n  }\n\n  render() {\n    const isVisible = this.props.selection.find((post) => {\n      return post.acl.can_hide && !post.is_hidden\n    })\n\n    if (!isVisible) return null\n\n    return (\n      <li>\n        <button type=\"button\" className=\"btn btn-link\" onClick={this.onClick}>\n          <span className=\"material-icon\">visibility_off</span>\n          {pgettext(\"thread posts moderation\", \"Hide\")}\n        </button>\n      </li>\n    )\n  }\n}\n\nexport class Unhide extends React.Component {\n  onClick = () => {\n    moderation.unhide(this.props)\n  }\n\n  render() {\n    const isVisible = this.props.selection.find((post) => {\n      return post.acl.can_unhide && post.is_hidden\n    })\n\n    if (!isVisible) return null\n\n    return (\n      <li>\n        <button type=\"button\" className=\"btn btn-link\" onClick={this.onClick}>\n          <span className=\"material-icon\">visibility</span>\n          {pgettext(\"thread posts moderation\", \"Unhide\")}\n        </button>\n      </li>\n    )\n  }\n}\n\nexport class Delete extends React.Component {\n  onClick = () => {\n    moderation.remove(this.props)\n  }\n\n  render() {\n    const isVisible = this.props.selection.find((post) => {\n      return post.acl.can_delete\n    })\n\n    if (!isVisible) return null\n\n    return (\n      <li>\n        <button type=\"button\" className=\"btn btn-link\" onClick={this.onClick}>\n          <span className=\"material-icon\">clear</span>\n          {pgettext(\"thread posts moderation\", \"Delete\")}\n        </button>\n      </li>\n    )\n  }\n}\n","import React from \"react\"\nimport { ThreadPostsModerationOptions } from \"./moderation/posts\"\n\nconst ThreadPostsModeration = ({ thread, user, selection, dropup }) => (\n  <div className={dropup ? \"dropup\" : \"dropdown\"}>\n    <button\n      type=\"button\"\n      className=\"btn btn-default btn-outline btn-icon dropdown-toggle\"\n      title={pgettext(\"post options btn\", \"Posts options\")}\n      data-toggle=\"dropdown\"\n      aria-haspopup=\"true\"\n      aria-expanded=\"false\"\n      disabled={selection.length === 0}\n    >\n      <span className=\"material-icon\">settings</span>\n    </button>\n    <ThreadPostsModerationOptions\n      thread={thread}\n      user={user}\n      selection={selection}\n    />\n  </div>\n)\n\nexport default ThreadPostsModeration\n","import React from \"react\"\n\nconst ThreadReplyButton = ({ onClick }) => (\n  <button\n    className=\"btn btn-primary btn-outline btn-block\"\n    type=\"button\"\n    onClick={onClick}\n  >\n    <span className=\"material-icon\">chat</span>\n    {pgettext(\"thread reply btn\", \"Reply\")}\n  </button>\n)\n\nexport default ThreadReplyButton\n","import React from \"react\"\nimport { Toolbar, ToolbarItem, ToolbarSection, ToolbarSpacer } from \"../Toolbar\"\nimport ThreadPaginator from \"./ThreadPaginator\"\nimport ThreadPostsModeration from \"./ThreadPostsModeration\"\nimport ThreadReplyButton from \"./ThreadReplyButton\"\nimport ThreadWatchButton from \"./ThreadWatchButton\"\n\nconst ThreadToolbarBottom = ({\n  thread,\n  posts,\n  user,\n  selection,\n  moderation,\n  onReply,\n}) => (\n  <Toolbar>\n    {posts.pages > 1 && (\n      <ToolbarSection>\n        <ToolbarItem>\n          <ThreadPaginator\n            baseUrl={thread.url.index}\n            posts={posts}\n            scrollToTop\n          />\n        </ToolbarItem>\n      </ToolbarSection>\n    )}\n    <ToolbarSpacer />\n    {user.is_authenticated && (\n      <ToolbarSection>\n        <ToolbarItem className=\"hidden-xs\">\n          <ThreadWatchButton thread={thread} dropup />\n        </ToolbarItem>\n        {thread.acl.can_reply && (\n          <ToolbarItem>\n            <ThreadReplyButton onClick={onReply} />\n          </ToolbarItem>\n        )}\n        {moderation.enabled && (\n          <ToolbarItem shrink>\n            <ThreadPostsModeration\n              thread={thread}\n              user={user}\n              selection={selection}\n              dropup\n            />\n          </ToolbarItem>\n        )}\n      </ToolbarSection>\n    )}\n    {user.is_authenticated && (\n      <ToolbarSection className=\"hidden-sm hidden-md hidden-lg\">\n        <ToolbarItem>\n          <ThreadWatchButton thread={thread} dropup />\n        </ToolbarItem>\n      </ToolbarSection>\n    )}\n  </Toolbar>\n)\n\nexport default ThreadToolbarBottom\n","import React from \"react\"\nimport { Toolbar, ToolbarItem, ToolbarSection, ToolbarSpacer } from \"../Toolbar\"\n\nconst ThreadToolbarThird = () => (\n  <Toolbar className=\"thread-toolbar-third\">\n    <ToolbarSpacer />\n    <ToolbarSection>\n      <ToolbarItem>\n        <button\n          className=\"btn btn-muted btn-block\"\n          type=\"button\"\n          onClick={() => window.scrollTo(0, 0)}\n        >\n          <span className=\"material-icon\">arrow_upward</span>\n          {pgettext(\"go up\", \"Go to top\")}\n        </button>\n      </ToolbarItem>\n    </ToolbarSection>\n  </Toolbar>\n)\n\nexport default ThreadToolbarThird\n","import classnames from \"classnames\"\nimport React from \"react\"\n\nconst ThreadPollButton = ({ compact, disabled, onClick }) => (\n  <button\n    className={classnames(\"btn btn-default btn-outline\", {\n      \"btn-block\": !compact,\n      \"btn-icon\": compact,\n    })}\n    type=\"button\"\n    title={compact ? pgettext(\"thread poll btn\", \"Add poll\") : null}\n    disabled={disabled}\n    onClick={onClick}\n  >\n    <span className=\"material-icon\">poll</span>\n    {!compact && pgettext(\"thread poll btn\", \"Add poll\")}\n  </button>\n)\n\nexport default ThreadPollButton\n","import React from \"react\"\nimport { Link } from \"react-router\"\n\nconst ThreadShortcutsButton = ({ user, thread, posts }) => (\n  <div className=\"dropdown\">\n    <button\n      className=\"btn btn-default btn-outline btn-icon\"\n      title={pgettext(\"thread shortcuts btn\", \"Shortcuts\")}\n      aria-expanded=\"true\"\n      aria-haspopup=\"true\"\n      data-toggle=\"dropdown\"\n      type=\"button\"\n    >\n      <span className=\"material-icon\">bookmark</span>\n    </button>\n    <ul className=\"dropdown-menu\">\n      {!!posts.first && (\n        <li>\n          <Link className=\"btn btn-link\" href={thread.url.index}>\n            <span className=\"material-icon\">place</span>\n            {pgettext(\"thread shortcut btn\", \"Go to first post\")}\n          </Link>\n        </li>\n      )}\n      {user.is_authenticated && thread.is_new && (\n        <li>\n          <a className=\"btn btn-link\" href={thread.url.new_post}>\n            <span className=\"material-icon\">comment</span>\n            {pgettext(\"thread shortcut btn\", \"Go to new post\")}\n          </a>\n        </li>\n      )}\n      {thread.best_answer && (\n        <li>\n          <a className=\"btn btn-link\" href={thread.url.best_answer}>\n            <span className=\"material-icon\">check_circle</span>\n            {pgettext(\"thread shortcut btn\", \"Go to best answer\")}\n          </a>\n        </li>\n      )}\n      {thread.has_unapproved_posts && thread.acl.can_approve && (\n        <li>\n          <a className=\"btn btn-link\" href={thread.url.unapproved_post}>\n            <span className=\"material-icon\">visibility</span>\n            {pgettext(\"thread shortcut btn\", \"Go to unapproved post\")}\n          </a>\n        </li>\n      )}\n      <li>\n        <a className=\"btn btn-link\" href={thread.url.last_post}>\n          <span className=\"material-icon\">reply</span>\n          {pgettext(\"thread shortcut btn\", \"Go to last post\")}\n        </a>\n      </li>\n    </ul>\n  </div>\n)\n\nexport default ThreadShortcutsButton\n","import React from \"react\"\nimport { Toolbar, ToolbarItem, ToolbarSection, ToolbarSpacer } from \"../Toolbar\"\nimport ThreadPaginator from \"./ThreadPaginator\"\nimport ThreadPollButton from \"./ThreadPollButton\"\nimport ThreadPostsModeration from \"./ThreadPostsModeration\"\nimport ThreadReplyButton from \"./ThreadReplyButton\"\nimport ThreadShortcutsButton from \"./ThreadShortcutsButton\"\n\nconst ThreadToolbarTop = ({\n  thread,\n  posts,\n  user,\n  pollDisabled,\n  selection,\n  moderation,\n  onPoll,\n  onReply,\n}) => (\n  <Toolbar>\n    <ToolbarSection className=\"hidden-xs\">\n      <ToolbarItem>\n        <ThreadShortcutsButton posts={posts} thread={thread} user={user} />\n      </ToolbarItem>\n      {posts.pages > 1 && (\n        <ToolbarItem>\n          <ThreadPaginator baseUrl={thread.url.index} posts={posts} />\n        </ToolbarItem>\n      )}\n    </ToolbarSection>\n    <ToolbarSpacer />\n    {thread.acl.can_start_poll && !thread.poll && (\n      <ToolbarSection className=\"hidden-xs\">\n        <ToolbarItem>\n          <ThreadPollButton disabled={pollDisabled} onClick={onPoll} />\n        </ToolbarItem>\n      </ToolbarSection>\n    )}\n    {thread.acl.can_reply ? (\n      <ToolbarSection>\n        <ToolbarItem className=\"hidden-sm hidden-md hidden-lg\" shrink>\n          <ThreadShortcutsButton posts={posts} thread={thread} user={user} />\n        </ToolbarItem>\n        <ToolbarItem>\n          <ThreadReplyButton onClick={onReply} />\n        </ToolbarItem>\n        {thread.acl.can_start_poll && !thread.poll && (\n          <ToolbarItem className=\"hidden-sm hidden-md hidden-lg\" shrink>\n            <ThreadPollButton\n              disabled={pollDisabled}\n              onClick={onPoll}\n              compact\n            />\n          </ToolbarItem>\n        )}\n        {moderation.enabled && (\n          <ToolbarItem className=\"hidden-xs\" shrink>\n            <ThreadPostsModeration\n              thread={thread}\n              user={user}\n              selection={selection}\n            />\n          </ToolbarItem>\n        )}\n      </ToolbarSection>\n    ) : (\n      <ToolbarSection>\n        <ToolbarItem className=\"hidden-sm hidden-md hidden-lg\" shrink>\n          <ThreadShortcutsButton posts={posts} thread={thread} user={user} />\n        </ToolbarItem>\n        {thread.acl.can_start_poll && !thread.poll && (\n          <ToolbarItem>\n            <ThreadPollButton disabled={pollDisabled} onClick={onPoll} />\n          </ToolbarItem>\n        )}\n        {moderation.enabled && (\n          <ToolbarItem shrink>\n            <ThreadPostsModeration\n              thread={thread}\n              user={user}\n              selection={selection}\n            />\n          </ToolbarItem>\n        )}\n      </ToolbarSection>\n    )}\n    {posts.pages > 1 && (\n      <ToolbarSection className=\"hidden-sm hidden-md hidden-lg\">\n        <ToolbarItem>\n          <ThreadPaginator baseUrl={thread.url.index} posts={posts} />\n        </ToolbarItem>\n      </ToolbarSection>\n    )}\n  </Toolbar>\n)\n\nexport default ThreadToolbarTop\n","import React from \"react\"\nimport Participants from \"misago/components/participants\"\nimport { Poll, PollForm } from \"misago/components/poll\"\nimport PostsList from \"misago/components/posts-list\"\nimport * as participants from \"misago/reducers/participants\"\nimport * as poll from \"misago/reducers/poll\"\nimport * as posts from \"misago/reducers/posts\"\nimport * as thread from \"misago/reducers/thread\"\nimport ajax from \"misago/services/ajax\"\nimport polls from \"misago/services/polls\"\nimport snackbar from \"misago/services/snackbar\"\nimport posting from \"misago/services/posting\"\nimport store from \"misago/services/store\"\nimport title from \"misago/services/page-title\"\nimport { PostingQuoteSelection } from \"../posting\"\nimport PageContainer from \"../PageContainer\"\nimport ThreadHeader from \"./ThreadHeader\"\nimport ThreadToolbarBottom from \"./ThreadToolbarBottom\"\nimport ThreadToolbarThird from \"./ThreadToolbarThird\"\nimport ThreadToolbarTop from \"./ThreadToolbarTop\"\n\nexport default class extends React.Component {\n  constructor(props) {\n    super(props)\n\n    this.state = {\n      editPoll: false,\n    }\n  }\n\n  componentDidMount() {\n    if (this.shouldFetchData()) {\n      this.fetchData()\n      this.setPageTitle()\n    }\n\n    this.startPollingApi()\n  }\n\n  componentDidUpdate() {\n    if (this.shouldFetchData()) {\n      this.fetchData()\n      this.startPollingApi()\n      this.setPageTitle()\n    }\n  }\n\n  componentWillUnmount() {\n    this.stopPollingApi()\n  }\n\n  shouldFetchData() {\n    if (this.props.posts.isLoaded) {\n      const page = (this.props.params.page || 1) * 1\n      return page != this.props.posts.page\n    } else {\n      return false\n    }\n  }\n\n  fetchData() {\n    store.dispatch(posts.unload())\n\n    ajax\n      .get(\n        this.props.thread.api.posts.index,\n        {\n          page: this.props.params.page || 1,\n        },\n        \"posts\"\n      )\n      .then(\n        (data) => {\n          this.update(data)\n        },\n        (rejection) => {\n          snackbar.apiError(rejection)\n        }\n      )\n  }\n\n  startPollingApi() {\n    polls.start({\n      poll: \"thread-posts\",\n\n      url: this.props.thread.api.posts.index,\n      data: {\n        page: this.props.params.page || 1,\n      },\n      update: this.update,\n\n      frequency: 120 * 1000,\n      delayed: true,\n    })\n  }\n\n  stopPollingApi() {\n    polls.stop(\"thread-posts\")\n  }\n\n  setPageTitle() {\n    title.set({\n      title: this.props.thread.title,\n      parent: this.props.thread.category.name,\n      page: (this.props.params.page || 1) * 1,\n    })\n  }\n\n  update = (data) => {\n    store.dispatch(thread.replace(data))\n    store.dispatch(posts.load(data.post_set))\n\n    if (data.participants) {\n      store.dispatch(participants.replace(data.participants))\n    }\n\n    if (data.poll) {\n      store.dispatch(poll.replace(data.poll))\n    }\n\n    this.setPageTitle()\n  }\n\n  openPollForm = () => {\n    this.setState({ editPoll: true })\n  }\n\n  closePollForm = () => {\n    this.setState({ editPoll: false })\n  }\n\n  openReplyForm = () => {\n    posting.open({\n      mode: \"REPLY\",\n\n      thread: this.props.thread,\n      config: this.props.thread.api.editor,\n      submit: this.props.thread.api.posts.index,\n    })\n  }\n\n  render() {\n    const category = this.props.thread.category\n\n    let className = \"page page-thread\"\n    if (category.css_class) {\n      className += \" page-thread-\" + category.css_class\n    }\n\n    const styleName =\n      category.special_role === \"private_threads\"\n        ? \"private-threads\"\n        : category.css_class || \"category-threads\"\n\n    const threadModeration = getThreadModeration(\n      this.props.thread,\n      this.props.user\n    )\n\n    const postsModeration = getPostsModeration(\n      this.props.posts.results,\n      this.props.user\n    )\n    const selection = this.props.posts.results.filter((post) => post.isSelected)\n\n    return (\n      <div className={className}>\n        <ThreadHeader\n          styleName={styleName}\n          thread={this.props.thread}\n          posts={this.props.posts}\n          user={this.props.user}\n          moderation={threadModeration}\n        />\n        <PageContainer>\n          <Participants\n            participants={this.props.participants}\n            thread={this.props.thread}\n            user={this.props.user}\n          />\n          <ThreadToolbarTop\n            thread={this.props.thread}\n            posts={this.props.posts}\n            user={this.props.user}\n            selection={selection}\n            moderation={postsModeration}\n            pollDisabled={this.state.editPoll}\n            onPoll={this.openPollForm}\n            onReply={this.openReplyForm}\n          />\n          {this.state.editPoll ? (\n            <PollForm\n              poll={this.props.poll}\n              thread={this.props.thread}\n              close={this.closePollForm}\n            />\n          ) : (\n            <Poll\n              poll={this.props.poll}\n              thread={this.props.thread}\n              user={this.props.user}\n              edit={this.openPollForm}\n            />\n          )}\n          {this.props.thread.acl.can_reply ? (\n            <PostingQuoteSelection\n              posting={{\n                mode: \"REPLY\",\n\n                thread: this.props.thread,\n                config: this.props.thread.api.editor,\n                submit: this.props.thread.api.posts.index,\n              }}\n            >\n              <PostsList {...this.props} />\n            </PostingQuoteSelection>\n          ) : (\n            <PostsList {...this.props} />\n          )}\n          <ThreadToolbarBottom\n            thread={this.props.thread}\n            posts={this.props.posts}\n            user={this.props.user}\n            selection={selection}\n            moderation={postsModeration}\n            onReply={this.openReplyForm}\n          />\n          <ThreadToolbarThird />\n        </PageContainer>\n      </div>\n    )\n  }\n}\n\nconst getThreadModeration = (thread, user) => {\n  const moderation = {\n    enabled: false,\n    edit: false,\n    approve: false,\n    close: false,\n    open: false,\n    hide: false,\n    unhide: false,\n    move: false,\n    merge: false,\n    pinGlobally: false,\n    pinLocally: false,\n    unpin: false,\n    delete: false,\n  }\n\n  if (!user.is_authenticated) return moderation\n\n  moderation.edit = thread.acl.can_edit\n  moderation.approve = thread.acl.can_approve && thread.is_unapproved\n  moderation.close = thread.acl.can_close && !thread.is_closed\n  moderation.open = thread.acl.can_close && thread.is_closed\n  moderation.hide = thread.acl.can_hide && !thread.is_hidden\n  moderation.unhide = thread.acl.can_unhide && thread.is_hidden\n  moderation.move = thread.acl.can_move\n  moderation.merge = thread.acl.can_merge\n  moderation.pinGlobally = thread.acl.can_pin_globally && thread.weight < 2\n  moderation.pinLocally = thread.acl.can_pin && thread.weight !== 1\n  moderation.unpin =\n    (thread.acl.can_pin && thread.weight === 1) ||\n    (thread.acl.can_pin_globally && thread.weight === 2)\n  moderation.delete = thread.acl.can_delete\n\n  moderation.enabled =\n    moderation.edit ||\n    moderation.approve ||\n    moderation.close ||\n    moderation.open ||\n    moderation.hide ||\n    moderation.unhide ||\n    moderation.move ||\n    moderation.merge ||\n    moderation.pinGlobally ||\n    moderation.pinLocally ||\n    moderation.unpin ||\n    moderation.delete\n\n  return moderation\n}\n\nconst getPostsModeration = (posts, user) => {\n  const moderation = {\n    enabled: false,\n    approve: false,\n    move: false,\n    merge: false,\n    protect: false,\n    hide: false,\n    delete: false,\n  }\n\n  if (!user.is_authenticated) return moderation\n\n  posts.forEach((post) => {\n    if (!post.is_event) {\n      if (post.acl.can_approve && post.is_unapproved) {\n        moderation.approve = true\n      }\n      if (post.acl.can_move) moderation.move = true\n      if (post.acl.can_merge) moderation.merge = true\n      if (post.acl.can_protect || post.acl.can_unprotect) {\n        moderation.protect = true\n      }\n      if (post.acl.can_hide || post.acl.can_unhide) {\n        moderation.hide = true\n      }\n      if (post.acl.can_delete) moderation.delete = true\n\n      if (\n        moderation.approve ||\n        moderation.move ||\n        moderation.merge ||\n        moderation.protect ||\n        moderation.hide ||\n        moderation.delete\n      ) {\n        moderation.enabled = true\n      }\n    }\n  })\n\n  return moderation\n}\n","import { connect } from \"react-redux\"\nimport Route from \"misago/components/thread/route\"\nimport misago from \"misago/index\"\n\nexport function select(store) {\n  return {\n    participants: store.participants,\n    poll: store.poll,\n    posts: store.posts,\n    thread: store.thread,\n    tick: store.tick.tick,\n    user: store.auth.user,\n  }\n}\n\nexport function paths() {\n  const thread = misago.get(\"THREAD\")\n  const basePath = thread.url.index.replace(\n    thread.slug + \"-\" + thread.pk,\n    \":slug\"\n  )\n  return [\n    {\n      path: basePath,\n      component: connect(select)(Route),\n    },\n    {\n      path: basePath + \":page/\",\n      component: connect(select)(Route),\n    },\n  ]\n}\n","import { paths } from \"misago/components/thread/root\"\nimport misago from \"misago/index\"\nimport mount from \"misago/utils/routed-component\"\n\nexport default function initializer(context) {\n  if (context.has(\"THREAD\") && context.has(\"POSTS\")) {\n    mount({\n      paths: paths(),\n    })\n  }\n}\n\nmisago.addInitializer({\n  name: \"component:thread\",\n  initializer: initializer,\n  after: \"store\",\n})\n","export class Include {\n  init(staticUrl) {\n    this._staticUrl = staticUrl\n    this._included = []\n  }\n\n  include(script, remote = false) {\n    if (this._included.indexOf(script) === -1) {\n      this._included.push(script)\n      this._include(script, remote)\n    }\n  }\n\n  _include(script, remote) {\n    $.ajax({\n      url: (!remote ? this._staticUrl : \"\") + script,\n      cache: true,\n      dataType: \"script\",\n    })\n  }\n}\n\nexport default new Include()\n","import ReactDOM from \"react-dom\"\nimport mount from \"misago/utils/mount-component\"\n\nexport class Modal {\n  init(element) {\n    this._element = element\n\n    this._modal = $(element).modal({ show: false })\n\n    this._modal.on(\"hidden.bs.modal\", () => {\n      ReactDOM.unmountComponentAtNode(this._element)\n    })\n  }\n\n  show(component) {\n    mount(component, this._element.id)\n    this._modal.modal(\"show\")\n  }\n\n  hide() {\n    this._modal.modal(\"hide\")\n  }\n}\n\nexport default new Modal()\n","export var initialState = {\n  tick: 0,\n}\n\nexport const TICK = \"TICK\"\n\nexport function doTick() {\n  return {\n    type: TICK,\n  }\n}\n\nexport default function tick(state = initialState, action = null) {\n  if (action.type === TICK) {\n    return Object.assign({}, state, {\n      tick: state.tick + 1,\n    })\n  } else {\n    return state\n  }\n}\n","export var initialState = {\n  type: \"info\",\n  message: \"\",\n  isVisible: false,\n}\n\nexport const SHOW_SNACKBAR = \"SHOW_SNACKBAR\"\nexport const HIDE_SNACKBAR = \"HIDE_SNACKBAR\"\n\nexport function showSnackbar(message, type) {\n  return {\n    type: SHOW_SNACKBAR,\n    message,\n    messageType: type,\n  }\n}\n\nexport function hideSnackbar() {\n  return {\n    type: HIDE_SNACKBAR,\n  }\n}\n\nexport default function snackbar(state = initialState, action = null) {\n  if (action.type === SHOW_SNACKBAR) {\n    return {\n      type: action.messageType,\n      message: action.message,\n      isVisible: true,\n    }\n  } else if (action.type === HIDE_SNACKBAR) {\n    return Object.assign({}, state, {\n      isVisible: false,\n    })\n  } else {\n    return state\n  }\n}\n","import misago from \"misago\"\nimport reducer, { initialState } from \"misago/reducers/search\"\nimport store from \"misago/services/store\"\n\nexport default function initializer() {\n  store.addReducer(\n    \"search\",\n    reducer,\n    Object.assign({}, initialState, {\n      providers: misago.get(\"SEARCH_PROVIDERS\") || [],\n      query: misago.get(\"SEARCH_QUERY\") || \"\",\n    })\n  )\n}\n\nmisago.addInitializer({\n  name: \"reducer:search\",\n  initializer: initializer,\n  before: \"store\",\n})\n","import React from \"react\"\n\nexport default class extends React.Component {\n  getClassName() {\n    if (this.props.value) {\n      return \"btn btn-yes-no btn-yes-no-on\"\n    } else {\n      return \"btn btn-yes-no btn-yes-no-off\"\n    }\n  }\n\n  getIcon() {\n    if (!!this.props.value) {\n      return this.props.iconOn || \"check_box\"\n    } else {\n      return this.props.iconOff || \"check_box_outline_blank\"\n    }\n  }\n\n  getLabel() {\n    if (!!this.props.value) {\n      return this.props.labelOn || pgettext(\"yesno switch choice\", \"yes\")\n    } else {\n      return this.props.labelOff || pgettext(\"yesno switch choice\", \"no\")\n    }\n  }\n\n  toggle = () => {\n    this.props.onChange({\n      target: {\n        value: !this.props.value,\n      },\n    })\n  }\n\n  render() {\n    return (\n      <button\n        type=\"button\"\n        onClick={this.toggle}\n        className={this.getClassName()}\n        id={this.props.id || null}\n        aria-describedby={this.props[\"aria-describedby\"] || null}\n        disabled={this.props.disabled || false}\n      >\n        <span className=\"material-icon\">{this.getIcon()}</span>\n        <span className=\"btn-text\">{this.getLabel()}</span>\n      </button>\n    )\n  }\n}\n","class OrderedList {\n  constructor(items) {\n    this.isOrdered = false\n    this._items = items || []\n  }\n\n  add(key, item, order) {\n    this._items.push({\n      key: key,\n      item: item,\n\n      after: order ? order.after || null : null,\n      before: order ? order.before || null : null,\n    })\n  }\n\n  get(key, value) {\n    for (var i = 0; i < this._items.length; i++) {\n      if (this._items[i].key === key) {\n        return this._items[i].item\n      }\n    }\n\n    return value\n  }\n\n  has(key) {\n    return this.get(key) !== undefined\n  }\n\n  values() {\n    var values = []\n    for (var i = 0; i < this._items.length; i++) {\n      values.push(this._items[i].item)\n    }\n    return values\n  }\n\n  order(values_only) {\n    if (!this.isOrdered) {\n      this._items = this._order(this._items)\n      this.isOrdered = true\n    }\n\n    if (values_only || typeof values_only === \"undefined\") {\n      return this.values()\n    } else {\n      return this._items\n    }\n  }\n\n  orderedValues() {\n    return this.order(true)\n  }\n\n  _order(unordered) {\n    // Index of unordered items\n    var index = []\n    unordered.forEach(function (item) {\n      index.push(item.key)\n    })\n\n    // Ordered items\n    var ordered = []\n    var ordering = []\n\n    // First pass: register items that\n    // don't specify their order\n    unordered.forEach(function (item) {\n      if (!item.after && !item.before) {\n        ordered.push(item)\n        ordering.push(item.key)\n      }\n    })\n\n    // Second pass: register items that\n    // specify their before to \"_end\"\n    unordered.forEach(function (item) {\n      if (item.before === \"_end\") {\n        ordered.push(item)\n        ordering.push(item.key)\n      }\n    })\n\n    // Third pass: keep iterating items\n    // until we hit iterations limit or finish\n    // ordering list\n    function insertItem(item) {\n      var insertAt = -1\n      if (ordering.indexOf(item.key) === -1) {\n        if (item.after) {\n          insertAt = ordering.indexOf(item.after)\n          if (insertAt !== -1) {\n            insertAt += 1\n          }\n        } else if (item.before) {\n          insertAt = ordering.indexOf(item.before)\n        }\n\n        if (insertAt !== -1) {\n          ordered.splice(insertAt, 0, item)\n          ordering.splice(insertAt, 0, item.key)\n        }\n      }\n    }\n\n    var iterations = 200\n    while (iterations > 0 && index.length !== ordering.length) {\n      iterations -= 1\n      unordered.forEach(insertItem)\n    }\n\n    return ordered\n  }\n}\n\nexport default OrderedList\n","class AjaxLoader {\n  constructor() {\n    this.element = document.getElementById(\"misago-ajax-loader\")\n    this.requests = 0\n    this.timeout = null\n  }\n\n  show = () => {\n    this.requests += 1\n    this.update()\n  }\n\n  hide = () => {\n    if (this.requests) {\n      this.requests -= 1\n      this.update()\n    }\n  }\n\n  update = () => {\n    if (this.timeout) {\n      window.clearTimeout(this.timeout)\n    }\n\n    if (this.requests) {\n      this.element.classList.add(\"busy\")\n      this.element.classList.remove(\"complete\")\n    } else {\n      this.element.classList.remove(\"busy\")\n      this.element.classList.add(\"complete\")\n\n      this.timeout = setTimeout(() => {\n        this.element.classList.remove(\"complete\")\n      }, 1500)\n    }\n  }\n}\n\nexport function useLoader(target) {\n  const silent = target.closest(\"[hx-silent]\")\n  if (silent) {\n    return silent.getAttribute(\"hx-silent\") !== \"true\"\n  }\n\n  return true\n}\n\nexport default AjaxLoader\n","import htmx from \"htmx.org\"\n\nclass BulkModeration {\n  constructor(options) {\n    this.menu = options.menu ? document.querySelector(options.menu) : null\n    this.form = options.form\n    this.modal = options.modal\n    this.actions = document.querySelectorAll(options.actions)\n    this.selection = options.selection\n    this.control = document.querySelector(options.button.selector)\n    this.text = options.button.text\n\n    this.update()\n    this.registerEvents()\n    this.registerActions()\n  }\n\n  registerActions = () => {\n    this.actions.forEach((element) => {\n      if (element.getAttribute(\"moderation-action\") === \"remove-selection\") {\n        element.addEventListener(\"click\", this.onRemoveSelection)\n      } else {\n        element.addEventListener(\"click\", this.onAction)\n      }\n    })\n  }\n\n  onAction = (event) => {\n    const form = document.querySelector(this.form)\n    const data = {}\n\n    new FormData(form).forEach((value, key) => {\n      if (typeof data[key] === \"undefined\") {\n        data[key] = []\n      }\n      data[key].push(value)\n    })\n\n    const target = event.target\n    data.moderation = target.getAttribute(\"moderation-action\")\n\n    if (target.getAttribute(\"moderation-multistage\") === \"true\") {\n      htmx\n        .ajax(\"POST\", document.location.href, {\n          target: this.modal,\n          swap: \"innerHTML\",\n          values: data,\n        })\n        .then(() => {\n          $(this.modal).modal(\"show\")\n        })\n    } else {\n      htmx.ajax(\"POST\", document.location.href, {\n        target: \"#misago-htmx-root\",\n        swap: \"outerHTML\",\n        values: data,\n      })\n    }\n  }\n\n  onRemoveSelection = (event) => {\n    document.querySelectorAll(this.selection).forEach((element) => {\n      element.checked = false\n    })\n    this.update()\n  }\n\n  registerEvents = () => {\n    document.body.addEventListener(\"click\", ({ target }) => {\n      if (target.tagName === \"INPUT\" && target.type === \"checkbox\") {\n        this.update()\n      }\n    })\n\n    htmx.onLoad(() => this.update())\n  }\n\n  update = () => {\n    const selection = document.querySelectorAll(this.selection).length\n\n    this.control.innerText = this.text.replace(\"%(number)s\", selection)\n    this.control.disabled = !selection\n\n    if (this.menu) {\n      if (selection) {\n        this.menu.classList.add(\"visible\")\n      } else {\n        this.menu.classList.remove(\"visible\")\n      }\n    }\n  }\n}\n\nexport default BulkModeration\n","class ControlShadow {\n  constructor() {\n    this._shadow = null\n  }\n\n  getQueryBoundingClientRect(control, query) {\n    const shadow = this._getShadowElement()\n\n    const rectControl = control.getBoundingClientRect()\n    shadow.style.width = `${rectControl.width}px`\n    shadow.style.height = `${rectControl.height}px`\n\n    shadow.setAttribute(\"class\", control.getAttribute(\"class\"))\n    shadow.innerHTML = query.prefix || \"\"\n\n    const marker = document.createElement(\"span\")\n    marker.innerHTML = query.value\n    shadow.appendChild(marker)\n\n    const rectShadow = shadow.getBoundingClientRect()\n    const rectMarker = marker.getBoundingClientRect()\n\n    return {\n      bottom:\n        rectControl.bottom -\n        rectMarker.bottom -\n        rectShadow.bottom +\n        control.scrollTop,\n      height: rectMarker.height,\n      left: rectControl.left + rectMarker.left - rectShadow.left,\n      right: rectControl.right - rectMarker.right - rectShadow.right,\n      top:\n        rectControl.top + rectMarker.top - rectShadow.top - control.scrollTop,\n      width: rectMarker.width,\n      x: rectControl.x + rectMarker.x - rectShadow.x,\n      y: rectControl.y + rectMarker.y - rectShadow.y,\n    }\n  }\n\n  _getShadowElement() {\n    if (this._shadow) {\n      return this._shadow\n    }\n\n    const shadow = this._createShadowElement()\n    document.body.appendChild(shadow)\n    this._shadow = shadow\n    return shadow\n  }\n\n  _createShadowElement() {\n    const shadow = document.createElement(\"pre\")\n    shadow.ariaHidden = true\n    shadow.style.position = \"absolute\"\n    shadow.style.top = 0\n    shadow.style.left = \"-9999px\"\n    shadow.style.opacity = 0\n    shadow.style.zIndex = -999\n    return shadow\n  }\n}\n\nconst shadow = new ControlShadow()\n\nexport default shadow\n","import shadow from \"./ControlShadow\"\n\nclass AnchorInput {\n  constructor(element) {\n    this.element = element\n  }\n\n  getTarget = (query) => {\n    const rect = shadow.getQueryBoundingClientRect(this.element, query)\n\n    return {\n      getBoundingClientRect() {\n        return rect\n      },\n    }\n  }\n}\n\nexport default AnchorInput\n","const DELAY_DEBOUNCED = 1000\nconst DELAY_INITIAL = 100\n\nconst KEY_CANCEL = {\n  Delete: true,\n  Space: true,\n  MetaLeft: true,\n  MetaRight: true,\n  End: true,\n  Enter: true,\n  ArrowUp: true,\n  ArrowDown: true,\n  ArrowLeft: true,\n  ArrowRight: true,\n}\n\nconst KEY_SELECT = {\n  Escape: true,\n  Enter: true,\n  ArrowUp: true,\n  ArrowDown: true,\n}\n\nclass Autocomplete {\n  constructor(config) {\n    this.control = config.control\n    this.anchor = config.anchor\n    this.source = config.source\n    this.getQuery = config.getQuery\n    this.select = config.select\n    this.errors = config.errors || true\n\n    this.keyCancel = config.keyOverride\n      ? Object.assign({}, KEY_CANCEL, config.keyOverride)\n      : KEY_CANCEL\n\n    this.onSelect = config.onSelect\n\n    this.delay = {\n      debounced: DELAY_DEBOUNCED,\n      initial: DELAY_INITIAL,\n    }\n\n    if (config.delay) {\n      if (typeof config.delay.debounced !== \"undefined\") {\n        this.delay.debounced = config.delay.debounced\n      }\n      if (typeof config.delay.initial !== \"undefined\") {\n        this.delay.initial = config.delay.initial\n      }\n    }\n\n    this._debounce = null\n\n    this.control.addEventListener(\"keydown\", this.onKeyDown)\n    this.control.addEventListener(\"keyup\", this.onKeyUp)\n  }\n\n  onKeyDown = (event) => {\n    if (KEY_SELECT[event.code] && this.select.visible) {\n      event.preventDefault()\n    }\n  }\n\n  onKeyUp = (event) => {\n    if (this.keyCancel[event.code] && this.select.visible) {\n      this.select.handleKey(event.code)\n      event.preventDefault()\n    } else if (this.keyCancel[event.code]) {\n      this.select.hide()\n    } else {\n      const query = this.getQuery(event.target)\n\n      if (query) {\n        this.showSuggestions(query)\n      } else {\n        this.select.hide()\n      }\n    }\n  }\n\n  showSuggestions = (query) => {\n    if (!query.value.trim()) {\n      return\n    }\n\n    if (!!this._debounce) {\n      window.clearTimeout(this._debounce)\n      this._debounce = null\n    }\n\n    this._debounce = window.setTimeout(\n      () => {\n        this.source(query, this.errors)\n          .then((data) => {\n            if (this.select && this.onSelect) {\n              this.select.show(query, data, this.onSelect)\n            } else {\n              console.warn(\n                \"Autocomplete was initialized without the 'select' or 'onSelect' options.\"\n              )\n            }\n          })\n          .then(() => {\n            this._debounce = null\n          })\n      },\n      this._debounce ? this.delay.debounced : this.delay.initial\n    )\n  }\n\n  isEventTarget = (event) => {\n    return this.select.isEventTarget(event)\n  }\n}\n\nexport default Autocomplete\n","import { computePosition, flip, offset, shift } from \"@floating-ui/dom\"\n\nclass SelectUser {\n  constructor(config) {\n    this.element = document.createElement(\"div\")\n    this.element.classList.add(\"autocomplete-user-popup\")\n    document.body.appendChild(this.element)\n\n    this.anchor = config.anchor\n    this.placement = config.placement || \"bottom\"\n    this.offset = config.offset || 6\n    this.shift = config.shift || { padding: 8 }\n\n    this.choice = 0\n    this.choices = []\n    this.maxChoice = 0\n\n    this.query = null\n    this.callback = null\n\n    this.visible = false\n\n    document.body.addEventListener(\"click\", (event) => {\n      if (this.visible && !this.element.contains(event.target)) {\n        this.hide()\n      }\n    })\n  }\n\n  updateChoices(query, choices, callback) {\n    const children = choices.map((choice, index) => {\n      const element = document.createElement(\"button\")\n      element.setAttribute(\"type\", \"button\")\n      element.classList.add(\"autocomplete-user-popup-choice\")\n\n      if (index === 0) {\n        element.classList.add(\"active\")\n      }\n\n      const avatars = choice.avatar.filter(({ size }) => size >= 24)\n      const avatarsHd = choice.avatar.filter(({ size }) => size >= 48)\n\n      const img = document.createElement(\"img\")\n      img.classList.add(\"autocomplete-user-popup-choice-avatar\")\n      img.setAttribute(\"src\", avatars[avatars.length - 1].url)\n      img.setAttribute(\"srcset\", avatarsHd[avatarsHd.length - 1].url)\n      img.setAttribute(\"alt\", \"\")\n      element.appendChild(img)\n\n      const span = document.createElement(\"span\")\n      span.classList.add(\"autocomplete-user-popup-choice-username\")\n      span.innerText = choice.username\n      element.appendChild(span)\n\n      element.addEventListener(\"click\", () => {\n        callback(choice, query)\n        this.hide()\n      })\n      return element\n    })\n\n    this.element.replaceChildren(...children)\n  }\n\n  updateActiveChoice() {\n    for (let index = 0; index < this.element.children.length; index++) {\n      const choice = this.element.children[index]\n      if (index === this.choice) {\n        choice.classList.add(\"active\")\n      } else {\n        choice.classList.remove(\"active\")\n      }\n    }\n  }\n\n  handleKey = (keyCode) => {\n    if (keyCode === \"Enter\") {\n      this.callback(this.choices[this.choice], this.query)\n      this.hide()\n    } else if (keyCode === \"ArrowUp\") {\n      if (this.choice > 0) {\n        this.choice--\n      } else {\n        this.choice = this.maxChoice\n      }\n      this.updateActiveChoice()\n    } else if (keyCode === \"ArrowDown\") {\n      if (this.choice < this.maxChoice) {\n        this.choice++\n      } else {\n        this.choice = 0\n      }\n      this.updateActiveChoice()\n    } else if (keyCode === \"Escape\") {\n      this.hide()\n    }\n  }\n\n  isEventTarget = (event) => {\n    if (event.relatedTarget) {\n      return !!this.element.contains(event.relatedTarget)\n    } else if (event.target) {\n      return !!this.element.contains(event.target)\n    } else {\n      return false\n    }\n  }\n\n  show = (query, choices, callback) => {\n    if (choices.length === 0) {\n      this.hide()\n    } else {\n      this.updateChoices(query, choices, callback)\n      this.element.classList.add(\"show\")\n\n      const target = this.anchor.getTarget(query)\n\n      computePosition(target, this.element, {\n        placement: this.placement,\n        middleware: [offset(this.offset), flip(), shift(this.shift)],\n      }).then(({ x, y }) => {\n        Object.assign(this.element.style, {\n          left: `${x}px`,\n          top: `${y}px`,\n        })\n      })\n\n      this.choices = choices\n      this.choice = 0\n      this.maxChoice = choices.length - 1\n\n      this.query = query\n      this.callback = callback\n\n      this.visible = true\n    }\n  }\n\n  hide = () => {\n    this.element.classList.remove(\"show\")\n    this.visible = false\n  }\n}\n\nexport default SelectUser\n","export default async function getHttpResponseErrorMessage(response) {\n  if (\n    typeof response.getResponseHeader !== \"undefined\" &&\n    response.getResponseHeader(\"content-type\") === \"application/json\"\n  ) {\n    const data = JSON.parse(response.response)\n    if (data.error) {\n      return data.error\n    }\n  } else if (response.headers.get(\"content-type\") === \"application/json\") {\n    const data = await response.json()\n    if (data.error) {\n      return data.error\n    }\n  }\n\n  if (response.status === 404) {\n    return pgettext(\"htmx response error\", \"Page not found\")\n  }\n\n  if (response.status === 403) {\n    return pgettext(\"htmx response error\", \"Permission denied\")\n  }\n\n  if (response.status === 0) {\n    return pgettext(\"htmx response error\", \"Site could not be reached\")\n  }\n\n  return pgettext(\"htmx response error\", \"Unexpected error\")\n}\n","import htmx from \"htmx.org\"\nimport getHttpResponseErrorMessage from \"./getHttpResponseErrorMessage\"\n\nconst SNACKBAR_TTL = 6\n\nconst container = document.getElementById(\"misago-snackbars\")\nlet timeout = null\n\nexport function removeSnackbars() {\n  container.replaceChildren()\n}\n\nfunction renderSnackbars() {\n  if (timeout) {\n    window.clearTimeout(timeout)\n  }\n\n  container.querySelectorAll(\".snackbar\").forEach((element) => {\n    element.classList.add(\"in\")\n  })\n\n  timeout = window.setTimeout(() => {\n    container.querySelectorAll(\".snackbar\").forEach((element) => {\n      element.classList.add(\"out\")\n      timeout = window.setTimeout(removeSnackbars, 1000)\n    })\n  }, SNACKBAR_TTL * 1000)\n}\n\nexport function snackbar(type, message) {\n  removeSnackbars()\n\n  if (timeout) {\n    window.clearTimeout(timeout)\n  }\n\n  const element = document.createElement(\"div\")\n  element.classList.add(\"snackbar\")\n  element.classList.add(\"snackbar-\" + type)\n  element.innerText = message\n  element.role = \"alert\"\n  container.appendChild(element)\n\n  timeout = window.setTimeout(renderSnackbars, 100)\n}\n\nexport function info(message) {\n  snackbar(\"info\", message)\n}\n\nexport function success(message) {\n  snackbar(\"success\", message)\n}\n\nexport function warning(message) {\n  snackbar(\"warning\", message)\n}\n\nexport function error(message) {\n  snackbar(\"danger\", message)\n}\n\nexport async function httpResponseError(response) {\n  snackbar(\"danger\", await getHttpResponseErrorMessage(response))\n}\n\nhtmx.onLoad(renderSnackbars)\n","import { httpResponseError } from \"../snackbars\"\n\nclass SourceUsers {\n  constructor() {\n    this.cache = {}\n    this.url = window.misago_suggest_users\n  }\n\n  get = ({ value, exclude }, showErrors) => {\n    let url = this.url + \"?query=\" + encodeURIComponent(value)\n    if (exclude && Array.isArray(exclude)) {\n      exclude.forEach(function (item) {\n        if (item) {\n          url += \"&exclude=\" + encodeURIComponent(item)\n        }\n      })\n    }\n\n    if (this.cache[url]) {\n      return Promise.resolve(this.cache[url])\n    }\n\n    return fetch(url).then(\n      async (response) => {\n        if (!response.ok) {\n          if (showErrors) {\n            httpResponseError(response)\n          }\n          console.error(response)\n          return []\n        }\n\n        const { results } = await response.json()\n        this.cache[url] = results\n        return results\n      },\n      () => {\n        return []\n      }\n    )\n  }\n}\n\nconst _users = new SourceUsers()\n\nfunction users(query, showErrors) {\n  return _users.get(query, showErrors)\n}\n\nexport { users }\n","export function deleteElement(element, callback) {\n  element.classList.remove(\"animation-fade-in\")\n\n  element\n    .querySelectorAll(\"button, input, select, textarea\")\n    .forEach((child) => {\n      child.setAttribute(\"disabled\", \"\")\n    })\n\n  element.addEventListener(\"animationend\", ({ animationName }) => {\n    if (animationName === \"deleteElementAnimation\") {\n      element.remove()\n\n      if (callback) {\n        callback()\n      }\n    }\n  })\n\n  element.classList.add(\"animation-delete\")\n}\n\nexport function slideUpElement(element, options) {\n  element\n    .querySelectorAll(\"button, input, select, textarea\")\n    .forEach((child) => {\n      child.setAttribute(\"disabled\", \"\")\n    })\n\n  element.classList.add(\"animation-slide-up\")\n\n  const duration = (options && options.duration) || 350\n  const height = element.clientHeight\n  const opacity = element.style.opacity || 1\n\n  let start\n  element.style.overflow = \"hidden\"\n\n  function onFrame(timestamp) {\n    if (start === undefined) {\n      start = timestamp\n    }\n\n    const progress = Math.min((timestamp - start) / duration, 1)\n    const animation = Math.sin(((1 - progress) * Math.PI) / 2)\n\n    element.style.height = Math.floor(height * animation) + \"px\"\n    element.style.opacity = opacity * animation\n\n    if (progress < 1) {\n      requestAnimationFrame(onFrame)\n    } else {\n      element.remove()\n\n      if (options && options.callback) {\n        options.callback()\n      }\n    }\n  }\n\n  requestAnimationFrame(onFrame)\n}\n","import htmx from \"htmx.org\"\n\nconst DEBOUNCE = 1000\n\nconst cache = {}\n\nexport function registerElementValidator(element) {\n  const active = element.getAttribute(\"misago-validate-active\")\n  if (active) {\n    return\n  }\n\n  const url = element.getAttribute(\"misago-validate\")\n  const user = element.getAttribute(\"misago-validate-user\")\n  const strip =\n    element.getAttribute(\"misago-validate-strip\") == \"false\" ? false : true\n  const input = element.querySelector(\"input\")\n  const csrf = input.closest(\"form\").querySelector(\"input[type=hidden]\")\n\n  if (!url || !input) {\n    return\n  }\n\n  if (!cache[url]) {\n    cache[url] = {}\n  }\n\n  element.setAttribute(\"misago-validate-active\", \"true\")\n\n  let timeout = null\n\n  input.addEventListener(\"keyup\", (event) => {\n    let value = event.target.value\n    if (strip) {\n      value = value.trim()\n    }\n\n    if (value.trim().length === 0) {\n      clearFormControlValidationState(element)\n      return\n    }\n\n    if (cache[url][value]) {\n      setFormControlValidationState(element, input, cache[url][value])\n    } else {\n      if (timeout) {\n        window.clearTimeout(timeout)\n      }\n\n      timeout = window.setTimeout(async () => {\n        const { errors } = await callValidationUrl(url, csrf, value, user)\n        cache[url][value] = errors\n        setFormControlValidationState(element, input, errors)\n      }, DEBOUNCE)\n    }\n  })\n}\n\nfunction setFormControlValidationState(element, input, errors) {\n  if (errors.length) {\n    setFormControlErrorValidationState(element, input, errors)\n  } else {\n    setFormControlSuccessValidationState(element)\n  }\n}\n\nfunction setFormControlErrorValidationState(element, input, errors) {\n  element.classList.remove(\"has-success\")\n  element.classList.add(\"has-error\")\n\n  clearFormControlValidationMessages(element)\n\n  errors.forEach((error) => {\n    const message = document.createElement(\"p\")\n    message.className = \"help-block\"\n    message.setAttribute(\"misago-dynamic-message\", \"true\")\n    message.innerText = error\n    input.after(message)\n  })\n}\n\nfunction setFormControlSuccessValidationState(element) {\n  element.classList.remove(\"has-error\")\n  element.classList.add(\"has-success\")\n\n  clearFormControlValidationMessages(element)\n}\n\nfunction clearFormControlValidationState(element) {\n  element.classList.remove(\"has-error\")\n  element.classList.remove(\"has-success\")\n\n  clearFormControlValidationMessages(element)\n}\n\nfunction clearFormControlValidationMessages(element) {\n  element\n    .querySelectorAll(\"[misago-dynamic-message]\")\n    .forEach((i) => i.remove())\n}\n\nasync function callValidationUrl(url, csrf, value, user) {\n  const data = new FormData()\n  data.set(csrf.name, csrf.value)\n  data.set(\"value\", value)\n  if (user) {\n    data.set(\"user\", user)\n  }\n\n  const response = await fetch(url, {\n    method: \"POST\",\n    mode: \"cors\",\n    credentials: \"same-origin\",\n    body: data,\n  })\n  return await response.json()\n}\n\nexport function registerValidators(element) {\n  const target = element || document\n  target.querySelectorAll(\"[misago-validate]\").forEach(registerElementValidator)\n}\n\nhtmx.onLoad(registerValidators)\n","import { error, httpResponseError } from \"./snackbars\"\n\nfunction handleResponseError(event) {\n  if (isEventVisible(event)) {\n    httpResponseError(event.detail.xhr)\n  }\n}\n\nfunction handleSendError(event) {\n  if (isEventVisible(event)) {\n    const message = pgettext(\"htmx response error\", \"Site could not be reached\")\n    error(message)\n  }\n}\n\nfunction handleTimeoutError(event) {\n  if (isEventVisible(event)) {\n    const message = pgettext(\n      \"htmx response error\",\n      \"Site took too long to reply\"\n    )\n    error(message)\n  }\n}\n\nfunction isEventVisible({ detail }) {\n  const silent = getEventTargetSilentAttr(detail.target)\n  return !(silent === \"true\" && detail.requestConfig.verb === \"get\")\n}\n\nfunction getEventTargetSilentAttr(target) {\n  const element = target.closest(\"[hx-silent]\")\n  if (element) {\n    return element.getAttribute(\"hx-silent\")\n  }\n  return null\n}\n\nexport function setupHtmxErrors() {\n  document.addEventListener(\"htmx:responseError\", handleResponseError)\n  document.addEventListener(\"htmx:sendError\", handleSendError)\n  document.addEventListener(\"htmx:timeout\", handleTimeoutError)\n}\n\nsetupHtmxErrors()\n","import htmx from \"htmx.org\"\n\nconst templates = {}\n\nfunction onEvent(name, event) {\n  if (\n    name === \"htmx:beforeRequest\" &&\n    event.target &&\n    event.detail &&\n    event.detail.target\n  ) {\n    const template = getLoaderTemplate(event.target)\n    if (template) {\n      event.detail.target.replaceChildren(template.content.cloneNode(true))\n    }\n  }\n}\n\nfunction getLoaderTemplate(element) {\n  const selector = getClosestAttribute(element, \"tpl-loader\")\n  if (!selector) {\n    return null\n  }\n\n  if (typeof templates[selector] === \"undefined\") {\n    const template = document.querySelector(selector)\n    templates[selector] = template || null\n  }\n\n  return templates[selector]\n}\n\nfunction getClosestAttribute(element, attr) {\n  const el = element.closest(\"[\" + attr + \"]\")\n  return el ? el.getAttribute(attr) : null\n}\n\nhtmx.defineExtension(\"loader-tpl\", {\n  onEvent,\n})\n","import htmx from \"htmx.org\"\n\nimport { dateRelative, dateRelativeShort, fullDateTime } from \"./formats\"\n\nconst cache = {}\n\nexport function updateTimestamp(element) {\n  const timestamp = element.getAttribute(\"misago-timestamp\")\n  const format = element.getAttribute(\"misago-timestamp-format\")\n\n  if (!cache[timestamp]) {\n    cache[timestamp] = new Date(timestamp)\n  }\n\n  if (format !== \"full\" && !element.hasAttribute(\"misago-timestamp-title\")) {\n    element.setAttribute(\"misago-timestamp-title\", \"true\")\n    element.setAttribute(\"title\", fullDateTime.format(cache[timestamp]))\n  }\n\n  if (format === \"short\") {\n    element.textContent = dateRelativeShort(cache[timestamp])\n  } else if (format === \"full\") {\n    element.textContent = fullDateTime.format(cache[timestamp])\n  } else {\n    element.textContent = dateRelative(cache[timestamp])\n  }\n}\n\nexport function startTimestampsUpdates() {\n  document.querySelectorAll(\"[misago-timestamp]\").forEach(updateTimestamp)\n\n  updateTimestamps()\n  window.setInterval(updateTimestamps, 1000 * 55)\n}\n\nexport function updateTimestamps(element) {\n  const target = element || document\n  target.querySelectorAll(\"[misago-timestamp]\").forEach(updateTimestamp)\n}\n\nstartTimestampsUpdates()\nhtmx.onLoad(updateTimestamps)\n","import { updateTimestamps } from \"./timestamps\"\n\nexport default class Lightbox {\n  constructor() {\n    this.modal = null\n    this.pager = null\n    this.details = null\n    this.zoom = null\n    this.download = null\n    this.link = null\n    this.container = null\n    this.caption = null\n\n    this.state = null\n    this.template = null\n\n    document.addEventListener(\"DOMContentLoaded\", this._onDOMContentLoaded)\n  }\n\n  _onDOMContentLoaded = () => {\n    this.modal = document.getElementById(\"misago-lightbox-modal\")\n    if (this.modal) {\n      this.pager = this.modal.querySelector(\"[misago-lightbox-pager]\")\n      this.details = this.modal.querySelector(\"[misago-lightbox-details]\")\n      this.zoom = this.modal.querySelector(\"[misago-lightbox-zoom]\")\n      this.download = this.modal.querySelector(\"[misago-lightbox-download]\")\n      this.link = this.modal.querySelector(\"[misago-lightbox-link]\")\n      this.container = this.modal.querySelector(\"[misago-lightbox-container]\")\n      this.caption = this.modal.querySelector(\"[misago-lightbox-caption]\")\n\n      this.template = document.getElementById(\"lightbox-image-caption\")\n\n      this._registerEvents()\n    }\n  }\n\n  _registerEvents() {\n    document.addEventListener(\"click\", (event) => {\n      const image = event.target.closest(\"img[misago-lightbox-media]\")\n      if (!!image) {\n        this.onImageClick(event, image)\n      } else {\n        const button = event.target.closest(\"[misago-lightbox-button]\")\n        if (!!button) {\n          this.onMediaButtonClick(event, button)\n        }\n      }\n    })\n\n    this.modal.querySelector(\"[data-dismiss]\").addEventListener(\"click\", () => {\n      this.onHideLightbox()\n    })\n\n    this.modal\n      .querySelector(\"[misago-lightbox-previous]\")\n      .addEventListener(\"click\", () => {\n        this.state.index = (this.state.index || this.state.total) - 1\n        this.state.media = this.state.items[this.state.index]\n        this.updateLightbox()\n      })\n\n    this.modal\n      .querySelector(\"[misago-lightbox-next]\")\n      .addEventListener(\"click\", () => {\n        this.state.index += 1\n        if (this.state.index === this.state.total) {\n          this.state.index = 0\n        }\n\n        this.state.media = this.state.items[this.state.index]\n        this.updateLightbox()\n      })\n  }\n\n  onImageClick(event, image) {\n    event.preventDefault()\n\n    const root = image.closest(\"[misago-lightbox-root]\")\n    this.state = this.getInitialState(root, image)\n\n    this.updateLightbox()\n    this.showLightbox()\n  }\n\n  onMediaButtonClick(event, button) {\n    event.preventDefault()\n\n    const root = button.closest(\"[misago-lightbox-root]\")\n    const media = button\n      .closest(\"[misago-lightbox-context]\")\n      .querySelector(\"[misago-lightbox-media]\")\n    this.state = this.getInitialState(root, media)\n\n    this.updateLightbox()\n    this.showLightbox()\n  }\n\n  getInitialState(root, media) {\n    const items = this.getRootMedia(root, media)\n    const index = items.map(({ active }) => active).indexOf(true)\n\n    return {\n      items,\n      media: items[index],\n      index: index,\n      total: items.length,\n    }\n  }\n\n  getRootMedia(root, media) {\n    const items = []\n    root.querySelectorAll(\"[misago-lightbox-media]\").forEach((element) => {\n      const context = element.closest(\"[misago-lightbox-context]\")\n      const link = element.closest(\"a\")\n\n      items.push({\n        element,\n        active: element === media,\n        video: element.tagName === \"VIDEO\",\n        image: element.tagName === \"IMG\",\n        caption: !!context ? context.querySelector(\"template\") : null,\n        details: !!context\n          ? context.getAttribute(\"misago-lightbox-details\")\n          : null,\n        download: !!context\n          ? context.getAttribute(\"misago-lightbox-download\")\n          : null,\n        link: !context && link,\n        url: !!context\n          ? context.getAttribute(\"misago-lightbox-url\")\n          : element.getAttribute(\"src\"),\n      })\n    })\n\n    return items\n  }\n\n  updateLightbox() {\n    this.updateLightboxPager()\n    this.updateLightboxOptions()\n    this.updateLightboxNav()\n    this.updateLightboxContainer()\n    this.updateLightboxCaption()\n  }\n\n  updateLightboxPager() {\n    const { state, pager } = this\n    if (state.total > 1) {\n      pager.textContent = pager\n        .getAttribute(\"misago-lightbox-pager\")\n        .replace(\"%(total)s\", state.total)\n        .replace(\"%(index)s\", state.index + 1)\n      pager.classList.remove(\"d-none\")\n    } else {\n      pager.textContent = \"\"\n      pager.classList.add(\"d-none\")\n    }\n  }\n\n  updateLightboxOptions() {\n    const { media } = this.state\n\n    this.updateLightboxOption(this.details, media.details)\n    this.updateLightboxOption(this.download, media.download && media.url)\n    this.updateLightboxOption(this.link, media.link && media.link.href)\n    this.updateLightboxOption(this.zoom, media.url)\n  }\n\n  updateLightboxOption(element, value) {\n    if (value) {\n      element.setAttribute(\"href\", value)\n      element.classList.remove(\"d-none\")\n    } else {\n      element.classList.add(\"d-none\")\n    }\n  }\n\n  updateLightboxNav() {\n    const { state } = this\n    this.modal\n      .querySelectorAll(\"[misago-lightbox-previous], [misago-lightbox-next]\")\n      .forEach(function (button) {\n        if (state.total > 1) {\n          button.classList.remove(\"d-none\")\n        } else {\n          button.classList.add(\"d-none\")\n        }\n      })\n  }\n\n  updateLightboxContainer() {\n    const { state, container } = this\n    const { media } = state\n\n    if (media.image) {\n      this.updateLightboxContainerWithImage(container, media)\n    } else if (media.video) {\n      this.updateLightboxContainerWithVideo(container, media)\n    }\n  }\n\n  updateLightboxContainerWithImage(container, media) {\n    const img = document.createElement(\"img\")\n    img.setAttribute(\"src\", media.url)\n    img.setAttribute(\"alt\", \"\")\n\n    const a = document.createElement(\"a\")\n    a.setAttribute(\"href\", media.url)\n    a.setAttribute(\"target\", \"_blank\")\n    a.appendChild(img)\n\n    container.replaceChildren(a)\n  }\n\n  updateLightboxContainerWithVideo(container, media) {\n    const video = document.createElement(\"video\")\n    video.innerHTML = media.element.innerHTML\n    video.setAttribute(\"controls\", \"true\")\n    video.setAttribute(\"preload\", \"metadata\")\n    container.replaceChildren(video)\n  }\n\n  updateLightboxCaption() {\n    const { state, caption } = this\n    const { media } = state\n\n    if (media.caption) {\n      const template = media.caption.content.cloneNode(true)\n      updateTimestamps(template)\n      caption.replaceChildren(template)\n    } else {\n      const template = this.template.content.cloneNode(true)\n      const name = template.querySelector(\"[lightbox-image-caption-name]\")\n      const description = template.querySelector(\n        \"[lightbox-image-caption-description]\"\n      )\n\n      name.removeAttribute(\"lightbox-image-caption-name\")\n      description.removeAttribute(\"lightbox-image-caption-description\")\n\n      const alt = (media.element.getAttribute(\"alt\") || \"\").trim()\n      const title = (media.element.getAttribute(\"title\") || \"\").trim()\n      const src = media.element.getAttribute(\"src\")\n\n      const nameText =\n        title && alt\n          ? title + \"  \" + alt\n          : title || alt || this.cleanDisplayFilename(src)\n\n      name.textContent = this.shortenLongString(nameText)\n      if (name.textContent !== nameText) {\n        name.setAttribute(\"title\", nameText)\n      }\n\n      if (media.link) {\n        const a = document.createElement(\"a\")\n        const href = media.link.getAttribute(\"href\")\n        a.setAttribute(\"href\", href)\n        a.setAttribute(\"target\", \"_blank\")\n        a.textContent = this.cleanDisplayUrl(href)\n        description.appendChild(a)\n      } else if (title || alt) {\n        description.textContent = this.cleanDisplayUrl(src)\n      } else {\n        description.remove()\n      }\n\n      caption.replaceChildren(template)\n    }\n  }\n\n  cleanDisplayFilename(href) {\n    const slash = href.lastIndexOf(\"/\")\n    if (slash === -1) {\n      return this.cleanDisplayUrl(href)\n    }\n\n    const filename = href.substring(slash + 1).trim()\n    if (filename) {\n      return this.shortenLongString(filename)\n    }\n\n    return this.cleanDisplayUrl(href)\n  }\n\n  cleanDisplayUrl(href) {\n    let clean = href\n    if (clean.startsWith(\"https://\")) {\n      clean = clean.substring(8)\n    } else if (clean.startsWith(\"http://\")) {\n      clean = clean.substring(7)\n    }\n    return this.shortenLongString(clean)\n  }\n\n  shortenLongString(value) {\n    if (value.length <= 80) {\n      return value\n    }\n\n    const prefix = value.substring(0, 35)\n    const suffix = value.substring(value.length - 40)\n    return prefix + \"...\" + suffix\n  }\n\n  showLightbox() {\n    document.querySelectorAll(\"video\").forEach((video) => video.pause())\n    $(this.modal).modal(\"show\")\n  }\n\n  onHideLightbox() {\n    this.modal.querySelectorAll(\"video\").forEach((video) => video.pause())\n  }\n}\n","import { Autocomplete, AnchorInput, SelectUser, sources } from \"./Autocomplete\"\n\nconst RE_LOOKBACK = /(^|[^\\p{L}\\p{N}])@[a-z0-9_\\-]*$/giu\nconst RE_LOOKAHEAD = /^[\\p{L}\\p{N}]/giu\n\nclass Mention {\n  constructor(control) {\n    this.autocomplete = new Autocomplete({\n      control,\n      source: sources.users,\n      select: new SelectUser({\n        anchor: new AnchorInput(control),\n        placement: \"top\",\n      }),\n      getQuery: this.getQuery,\n      onSelect: this.onSelect,\n    })\n  }\n\n  getQuery = (control) => {\n    const { start, end, closed, prefix, suffix } = this.getSelection(control)\n\n    if (!closed) {\n      return null\n    }\n\n    const prefixMatch = prefix.match(RE_LOOKBACK)\n    const suffixMatch = suffix.match(RE_LOOKAHEAD)\n\n    const prefixMatchClean = prefixMatch ? prefixMatch[0].trim() : \"\"\n    const suffixMatchClean = suffixMatch ? suffixMatch[0].trim() : \"\"\n\n    if (prefixMatchClean.length < 2 || suffixMatchClean) {\n      return null\n    }\n\n    return {\n      control,\n      start: start - prefixMatchClean.length,\n      end: end,\n      prefix: prefix.substring(0, start - prefixMatchClean.length + 1),\n      value: prefixMatchClean.substring(1),\n    }\n  }\n\n  getSelection(control) {\n    const text = control.value\n    const selectionStart = control.selectionStart\n    const selectionEnd = control.selectionEnd\n\n    const prefix = text.substring(0, selectionStart)\n    const suffix = text.substring(selectionEnd)\n    const value =\n      selectionStart < selectionEnd\n        ? text.substring(selectionStart, selectionEnd)\n        : \"\"\n\n    return {\n      text,\n      start: selectionStart,\n      end: selectionEnd,\n      closed: selectionStart === selectionEnd,\n      value,\n      prefix,\n      suffix,\n    }\n  }\n\n  onSelect = (choice, query) => {\n    const { control, start, end } = query\n    const { username } = choice\n\n    const value = control.value\n    const prefix = value.substring(0, start)\n    const suffix = value.substring(end)\n    control.value = prefix + \"@\" + username + \" \" + suffix\n\n    window.setTimeout(() => {\n      const scroll = control.scrollTop\n      control.focus()\n      control.scrollTop = scroll\n\n      const caret = start + username.length + 2\n      control.setSelectionRange(caret, caret)\n    }, 100)\n  }\n}\n\nexport default Mention\n","export const CSRF_FIELD_NAME = \"csrfmiddlewaretoken\"\n\nexport function getCSRFToken() {\n  const element = document.querySelector(\n    'input[name=\"' + CSRF_FIELD_NAME + '\"]'\n  )\n\n  if (element) {\n    return element.value\n  }\n\n  return null\n}\n\nexport function appendCSRFTokenToForm(form) {\n  form.append(CSRF_FIELD_NAME, getCSRFToken())\n}\n","export default function renderTemplate(template, data) {\n  const node = template.content.cloneNode(true)\n\n  node.querySelectorAll(\"[misago-tpl-if]\").forEach((element) => {\n    const variable = element.getAttribute(\"misago-tpl-if\")\n    if (getVariableValue(data, variable)) {\n      element.removeAttribute(\"misago-tpl-if\")\n    } else {\n      element.remove()\n    }\n  })\n\n  node.querySelectorAll(\"[misago-tpl-ifnot]\").forEach((element) => {\n    const variable = element.getAttribute(\"misago-tpl-ifnot\")\n    if (getVariableValue(data, variable)) {\n      element.remove()\n    } else {\n      element.removeAttribute(\"misago-tpl-ifnot\")\n    }\n  })\n\n  node.querySelectorAll(\"[misago-tpl-var]\").forEach((element) => {\n    const variable = element.getAttribute(\"misago-tpl-var\")\n    element.innerText = getVariableValue(data, variable) || \"\"\n    element.removeAttribute(\"misago-tpl-var\")\n  })\n\n  node.querySelectorAll(\"[misago-tpl-attr]\").forEach((element) => {\n    const attr = element.getAttribute(\"misago-tpl-attr\")\n    if (attr.indexOf(\":\") !== \":\") {\n      const name = attr.substring(0, attr.indexOf(\":\")).trim()\n      const variable = attr.substring(attr.indexOf(\":\") + 1).trim()\n      const value = variable ? getVariableValue(data, variable) : undefined\n\n      if (name && value) {\n        element.setAttribute(name, value)\n      }\n    }\n    element.removeAttribute(\"misago-tpl-attr\")\n  })\n\n  return node\n}\n\nfunction getVariableValue(data, variable) {\n  if (variable.indexOf(\".\") === -1) {\n    return data[variable]\n  } else {\n    let value = data\n    for (const part of variable.split(\".\")) {\n      if (part && typeof value[part] !== \"undefined\") {\n        value = value[part]\n      } else {\n        return undefined\n      }\n    }\n    return value\n  }\n}\n","import { appendCSRFTokenToForm } from \"../csrf\"\nimport getRandomString from \"../getRandomString\"\nimport renderTemplate from \"../renderTemplate\"\nimport * as snackbar from \"../snackbars\"\n\nexport default class MarkupEditorUploader {\n  constructor(editor, element) {\n    this.editor = editor\n\n    this.element = element\n    this.textarea = editor.getTextarea(element)\n\n    this.lists = {\n      media: element.querySelector('[misago-editor-attachments=\"media\"]'),\n      other: element.querySelector('[misago-editor-attachments=\"other\"]'),\n    }\n\n    this.templates = {\n      error: document.getElementById(\"attachment-upload-error-template\"),\n      media: document.getElementById(\"attachment-media-template\"),\n      mediaFooter: document.getElementById(\"attachment-media-footer-template\"),\n      mediaFailedFooter: document.getElementById(\n        \"attachment-media-failed-footer-template\"\n      ),\n      other: document.getElementById(\"attachment-other-template\"),\n      otherFailed: document.getElementById(\"attachment-other-failed-template\"),\n      otherUploaded: document.getElementById(\n        \"attachment-other-uploaded-template\"\n      ),\n    }\n\n    const attachmentsElement = element.querySelector(\n      \"[misago-editor-attachments]\"\n    )\n    this.field = {\n      name: element.getAttribute(\"misago-editor-attachments-name\"),\n      element: attachmentsElement,\n    }\n\n    this.accept = {\n      all: this._getAcceptedExtensions(\n        attachmentsElement.getAttribute(\"misago-editor-accept-attachments\")\n      ),\n      image: this._getAcceptedExtensions(\n        attachmentsElement.getAttribute(\"misago-editor-accept-image\")\n      ),\n      video: this._getAcceptedExtensions(\n        attachmentsElement.getAttribute(\"misago-editor-accept-video\")\n      ),\n    }\n\n    this.uploadUrl = this._getUploadUrl(element)\n    this.canUpload = !!this.uploadUrl && !!this.accept.all\n  }\n\n  _getUploadUrl(element) {\n    return element.getAttribute(\"misago-editor-attachments-url\") || null\n  }\n\n  _getAcceptedExtensions(extensions) {\n    return extensions.split(\",\").map((item) => item.trim())\n  }\n\n  showPermissionDeniedError() {\n    snackbar.error(\n      pgettext(\"markup editor upload\", \"You can't upload attachments\")\n    )\n  }\n\n  prompt(options) {\n    const accept = options ? options.accept : \"all\"\n    const insert = options ? options.insert : false\n\n    const input = document.createElement(\"input\")\n    input.setAttribute(\"type\", \"file\")\n    input.setAttribute(\n      \"accept\",\n      (this.accept[accept] || this.accept.all).join(\",\")\n    )\n    input.setAttribute(\"multiple\", true)\n    input.classList.add(\"d-none\")\n\n    input.addEventListener(\"change\", (event) => {\n      const files = event.target.files\n      if (files.length) {\n        this.uploadFiles(files, insert)\n      }\n      input.remove()\n    })\n\n    this.element.appendChild(input)\n    input.click()\n  }\n\n  _getAcceptAttributeStr(accept) {\n    return (this.accept[accept] || this.accept.all).join(\",\")\n  }\n\n  uploadFiles(files, insert) {\n    const allowedFiles = []\n\n    for (let i = 0; i < files.length; i++) {\n      const file = files[i]\n      if (this._isFileTypeAccepted(file)) {\n        allowedFiles.push(file)\n      } else {\n        snackbar.error(\n          pgettext(\n            \"markup editor upload\",\n            \"%(name)s: uploaded file type is not allowed.\"\n          ).replace(\"%(name)s\", file.name)\n        )\n      }\n    }\n\n    if (!allowedFiles) {\n      return { keys: [], files: [] }\n    }\n\n    const keys = []\n    const elements = {}\n\n    const data = new FormData()\n    appendCSRFTokenToForm(data)\n\n    allowedFiles.forEach((file) => {\n      const key = getRandomString(16)\n      keys.push(key)\n      data.append(\"keys\", key)\n      data.append(\"upload\", file)\n\n      elements[key] = this._createUploadUI(file, key)\n    })\n\n    if (insert) {\n      this._insertAttachmentsInTextarea(keys, allowedFiles)\n    }\n\n    const request = new XMLHttpRequest()\n\n    this._addOnLoadedEventListener(request, keys, elements)\n    this._addOnProgressEventListener(request, keys, elements)\n\n    request.open(\"POST\", this.uploadUrl)\n    request.send(data)\n\n    return { keys, files: allowedFiles }\n  }\n\n  _isFileTypeAccepted(file) {\n    return this._isFileTypeInList(file, this.accept.all)\n  }\n\n  _isFileTypeImage(file) {\n    return this._isFileTypeInList(file, this.accept.image)\n  }\n\n  _isFileTypeVideo(file) {\n    return this._isFileTypeInList(file, this.accept.video)\n  }\n\n  _isFileTypeInList(file, list) {\n    const name = file.name.toLowerCase()\n    for (const extension of list) {\n      if (name.substring(name.length - extension.length) === extension) {\n        return true\n      }\n    }\n    return false\n  }\n\n  _insertAttachmentsInTextarea(keys, files) {\n    const markup = []\n\n    for (let i = 0; i < keys.length; i++) {\n      const key = keys[i]\n      const file = files[i]\n      markup.push(\"<attachment=\" + file.name + \":\" + key + \">\")\n    }\n\n    if (markup) {\n      const selection = this.editor.getSelection(this.textarea)\n      selection.insert(markup.join(\"\\n\"), { whitespace: \"\\n\\n\" })\n    }\n  }\n\n  _addOnLoadedEventListener(request, keys, elements) {\n    request.addEventListener(\"loadend\", () => {\n      if (request.readyState === XMLHttpRequest.DONE) {\n        if (request.status === 200) {\n          this._handleUploadSuccess(request, keys, elements)\n        } else {\n          this._handleUploadError(request, keys)\n        }\n\n        keys.forEach((key) => (elements[key] = null))\n      }\n    })\n  }\n\n  _handleUploadSuccess(request, keys, elements) {\n    try {\n      const { attachments, errors } = JSON.parse(request.response)\n\n      this._replaceTextareaPlaceholders(this.textarea, keys, attachments)\n\n      if (errors) {\n        const helpText = this.element.querySelector(\n          \"[misago-editor-attachments-help]\"\n        )\n        keys.forEach((key) => {\n          const error = errors[key]\n          if (error) {\n            this._updateUploadUIWithError(key, helpText, error)\n          }\n        })\n      }\n\n      if (attachments) {\n        attachments.forEach((attachment) => {\n          try {\n            this._updateUploadUI(attachment, elements[attachment.key])\n            this._createAttachmentIDField(attachment)\n          } catch (error) {\n            console.error(error)\n          }\n        })\n      }\n    } catch (error) {\n      snackbar.error(\n        pgettext(\"markup editor upload\", \"Unexpected upload API response\")\n      )\n      console.error(error)\n    }\n  }\n\n  _handleUploadError(request, keys) {\n    if (request.status === 0) {\n      snackbar.error(\n        pgettext(\"markup editor upload\", \"Site could not be reached\")\n      )\n    } else if (request.status >= 400 && request.status < 500) {\n      try {\n        snackbar.error(JSON.parse(request.response).error)\n      } catch (error) {\n        snackbar.error(\n          pgettext(\n            \"markup editor upload\",\n            \"Unexpected upload API error response\"\n          )\n        )\n        console.error(error)\n      }\n    } else {\n      snackbar.error(\n        pgettext(\"markup editor upload\", \"Unexpected error during upload\")\n      )\n    }\n\n    keys.forEach((key) => {\n      this._updateUploadUIWithError(key)\n    })\n  }\n\n  _addOnProgressEventListener(request, keys, elements) {\n    request.upload.addEventListener(\"progress\", (event) => {\n      if (event.lengthComputable) {\n        const progress = Math.ceil((event.loaded * 100) / event.total)\n        for (const key of keys) {\n          const progressBar = elements[key].querySelector(\".progress-bar\")\n          progressBar.setAttribute(\"aria-valuenow\", progress)\n          progressBar.style.width = progress + \"%\"\n        }\n      }\n    })\n  }\n\n  _replaceTextareaPlaceholders(textarea, keys, attachments) {\n    const results = {}\n    keys.forEach((key) => (results[key] = null))\n    if (attachments) {\n      attachments.forEach(\n        (attachment) => (results[attachment.key] = attachment)\n      )\n    }\n\n    const selection = this.editor.getSelection(textarea)\n    selection.replaceAttachments(function ({ id: key }) {\n      const attachment = results[key]\n      if (attachment) {\n        return \"<attachment=\" + attachment.name + \":\" + attachment.id + \">\"\n      } else if (attachment === null) {\n        return \"\"\n      }\n    })\n  }\n\n  _createUploadUI(file, key) {\n    const data = {\n      key,\n      file,\n      name: file.name,\n      isImage: false,\n      isVideo: false,\n    }\n\n    if (this._isFileTypeImage(file)) {\n      data.isImage = true\n      this._createMediaUploadUI(data)\n    } else if (this._isFileTypeVideo(file)) {\n      data.isVideo = true\n      this._createMediaUploadUI(data)\n    } else {\n      this._createOtherUploadUI(data)\n    }\n\n    return this.editor.getAttachmentByKey(key)\n  }\n\n  _createMediaUploadUI(data) {\n    const element = renderTemplate(this.templates.media, data)\n\n    if (data.isImage) {\n      const image = element.querySelector(\"[misago-tpl-image]\")\n      const buffer = new FileReader()\n      buffer.onload = () => {\n        image.style.backgroundImage = \"url('\" + buffer.result + \"')\"\n      }\n      buffer.readAsDataURL(data.file)\n    } else if (data.isVideo) {\n      const video = element.querySelector(\"video\")\n      const buffer = new FileReader()\n      buffer.onload = () => {\n        const source = document.createElement(\"source\")\n        source.setAttribute(\"src\", buffer.result)\n        source.setAttribute(\"type\", data.file.type)\n        video.append(source)\n      }\n      buffer.readAsDataURL(data.file)\n    }\n\n    this._addUIToAttachmentsList(this.lists.media, element)\n  }\n\n  _createOtherUploadUI(data) {\n    const element = renderTemplate(this.templates.other, data)\n    this._addUIToAttachmentsList(this.lists.other, element)\n  }\n\n  _addUIToAttachmentsList(list, element) {\n    list.querySelector(\"ul\").prepend(element)\n    list.classList.remove(\"d-none\")\n  }\n\n  _createAttachmentIDField(attachment) {\n    const input = document.createElement(\"input\")\n    input.setAttribute(\"type\", \"hidden\")\n    input.setAttribute(\"name\", this.field.name)\n    input.setAttribute(\"value\", attachment.id)\n    this.field.element.appendChild(input)\n  }\n\n  _updateUploadUI(attachment, element) {\n    if (attachment.filetype[\"is_media\"]) {\n      this._updateMediaUploadUI(attachment, element)\n    } else {\n      this._updateOtherUploadUI(attachment, element)\n    }\n  }\n\n  _updateMediaUploadUI(attachment, element) {\n    const footer = renderTemplate(this.templates.mediaFooter, attachment)\n\n    footer\n      .querySelector(\"[misago-editor-attachment]\")\n      .setAttribute(\n        \"misago-editor-attachment\",\n        attachment.name + \":\" + attachment.id\n      )\n\n    element.querySelector(\"[misago-tpl-footer]\").replaceWith(footer)\n  }\n\n  _updateOtherUploadUI(attachment, element) {\n    const item = renderTemplate(this.templates.otherUploaded, attachment)\n\n    item\n      .querySelector(\"[misago-editor-attachment]\")\n      .setAttribute(\n        \"misago-editor-attachment\",\n        attachment.name + \":\" + attachment.id\n      )\n\n    element.replaceWith(item)\n  }\n\n  _updateUploadUIWithError(key, helpText, error) {\n    if (error) {\n      this._createErrorMessage(key, error, helpText)\n    }\n\n    const attachment = this.editor.getAttachmentByKey(key)\n    const footer = attachment.querySelector(\"[misago-tpl-footer]\")\n    if (footer) {\n      // Media attachment\n      const template = renderTemplate(this.templates.mediaFailedFooter, { key })\n      footer.replaceWith(template)\n    } else {\n      // Other attachment\n      const upload = attachment.querySelector(\"[misago-tpl-upload]\")\n      const button = upload.closest(\"li\").querySelector(\"button\")\n\n      button.setAttribute(\"misago-editor-action\", \"attachment-error-dismiss\")\n      button.setAttribute(\"misago-editor-attachment-key\", key)\n      button.removeAttribute(\"disabled\")\n\n      upload.replaceWith(renderTemplate(this.templates.otherFailed))\n    }\n  }\n\n  _createErrorMessage(key, error, insertAfter) {\n    const errorTemplate = renderTemplate(this.templates.error, { key, error })\n    insertAfter.after(errorTemplate)\n  }\n}\n","const ALPHABET =\n  \"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz\"\nconst ALPHABET_LENGTH = ALPHABET.length\n\nexport default function getRandomString(length) {\n  let string = \"\"\n  for (let i = 0; i < length; i++) {\n    string += ALPHABET[Math.floor(Math.random() * ALPHABET_LENGTH)]\n  }\n  return string\n}\n","class MarkupEditorModal {\n  constructor() {\n    this.selection = null\n    this.element = null\n    this.form = null\n\n    document.addEventListener(\"DOMContentLoaded\", () => {\n      this.element = this.getElement()\n      if (this.element) {\n        this.form = this.element.querySelector(\"form\")\n        this.initForm(this.form)\n      }\n    })\n  }\n\n  getElement() {\n    throw \"Subclasses of 'MarkupEditorModal' must implement 'getElement' method\"\n  }\n\n  initForm(form) {\n    form.addEventListener(\"submit\", (event) => {\n      event.preventDefault()\n      const data = new FormData(event.target)\n      this.submit(data, this.selection)\n      return false\n    })\n  }\n\n  reset() {\n    this.element.querySelectorAll(\"input\").forEach((input) => {\n      input.value = \"\"\n    })\n  }\n\n  setData(form, selection) {}\n\n  submit(data, selection) {}\n\n  show(selection) {\n    this.reset()\n    this.selection = selection\n    this.setData(this.form, selection)\n    $(this.element).modal(\"show\")\n  }\n\n  hide() {\n    $(this.element).modal(\"hide\")\n  }\n}\n\nexport class MarkupEditorLinkModal extends MarkupEditorModal {\n  getElement() {\n    return document.getElementById(\"markup-editor-link-modal\")\n  }\n\n  setData(form, selection) {\n    form.querySelector('[name=\"text\"]').value = selection.text().trim()\n  }\n\n  submit(data, selection) {\n    const url = cleanUrl(data.get(\"url\").trim())\n    const text = data.get(\"text\").trim()\n\n    if (url) {\n      if (text) {\n        if (isUnsafeForMarkdown(url, text)) {\n          selection.replace(\"[url=\" + url + \"]\" + text + \"[/url]\")\n        } else {\n          selection.replace(\"[\" + text + \"](\" + url + \")\")\n        }\n      } else {\n        selection.replace(\"<\" + url + \">\")\n      }\n\n      this.hide()\n    }\n  }\n}\n\nexport class MarkupEditorImageModal extends MarkupEditorModal {\n  getElement() {\n    return document.getElementById(\"markup-editor-image-modal\")\n  }\n\n  submit(data, selection) {\n    const url = cleanUrl(data.get(\"url\").trim())\n    const text = data.get(\"text\").trim()\n\n    if (url) {\n      if (text) {\n        if (isUnsafeForMarkdown(url, text)) {\n          selection.replace(\"[img=\" + url + \"]\" + text + \"[/img]\")\n        } else {\n          selection.replace(\"![\" + text + \"](\" + url + \")\")\n        }\n      } else if (isUnsafeForMarkdown(url, text)) {\n        selection.replace(\"[img]\" + url + \"[/img]\")\n      } else {\n        selection.replace(\"!(\" + url + \")\")\n      }\n\n      this.hide()\n    }\n  }\n}\n\nfunction isUnsafeForMarkdown(url, text) {\n  if (url.indexOf(\"(\") >= 0) return true\n  if (url.indexOf(\")\") >= 0) return true\n  if (text.indexOf(\"[\") >= 0) return true\n  if (text.indexOf(\"]\") >= 0) return true\n\n  return false\n}\n\nfunction cleanUrl(url) {\n  if (startsWith(url, \"http://\") || startsWith(url, \"https://\")) {\n    return url\n  }\n\n  return \"http://\" + url\n}\n\nfunction startsWith(text, prefix) {\n  return text.toLowerCase().substring(0, prefix.length) === prefix\n}\n\nexport class MarkupEditorQuoteModal extends MarkupEditorModal {\n  getElement() {\n    return document.getElementById(\"markup-editor-quote-modal\")\n  }\n\n  setData(form, selection) {\n    form.querySelector('[name=\"text\"]').value = selection.text().trim()\n  }\n\n  submit(data, selection) {\n    const author = data.get(\"author\").trim()\n    const text = data.get(\"text\").trim()\n\n    if (text) {\n      const prefix = this.getQuotePrefix(selection, author)\n      const suffix = \"\\n[/quote]\\n\\n\"\n\n      selection.replace(prefix + text + suffix, {\n        start: prefix.length,\n        end: suffix.length,\n      })\n\n      this.hide()\n    }\n  }\n\n  getQuotePrefix(selection, author) {\n    const prefix = selection.prefix().trim().length ? \"\\n\\n\" : \"\"\n    if (author) {\n      return prefix + \"[quote=\" + author + \"]\\n\"\n    }\n    return prefix + \"[quote]\\n\"\n  }\n}\n\nexport class MarkupEditorCodeModal extends MarkupEditorModal {\n  getElement() {\n    return document.getElementById(\"markup-editor-code-modal\")\n  }\n\n  setData(form, selection) {\n    form.querySelector('[name=\"code\"]').value = selection.text().trim()\n  }\n\n  submit(data, selection) {\n    const info = data.get(\"info\")\n    const syntax = data.get(\"syntax\")\n    const code = data.get(\"code\")\n\n    if (code) {\n      const prefix = this.getCodePrefix(selection)\n      const args = this.getCodeArguments(info, syntax)\n      const delimiter = this.getCodeDelimiter(args, code)\n\n      const markup =\n        prefix + delimiter + args + \"\\n\" + code + \"\\n\" + delimiter + \"\\n\\n\"\n\n      selection.replace(markup, { start: markup.length })\n\n      this.hide()\n    }\n  }\n\n  getCodeArguments(info, syntax) {\n    const cleanInfo = (info || \"\").trim()\n    const cleanSyntax = (syntax || \"\").trim()\n\n    if (cleanInfo && cleanSyntax) {\n      return cleanInfo + \", syntax: \" + cleanSyntax\n    }\n\n    return cleanInfo || cleanSyntax || \"\"\n  }\n\n  getCodeDelimiter(args, code) {\n    let delimiter = args.startsWith(\"`\") ? \"~\" : \"`\"\n    while (delimiter.length < 3 || code.indexOf(delimiter) !== -1) {\n      delimiter += delimiter[0]\n    }\n    return delimiter\n  }\n\n  getCodePrefix(selection) {\n    return selection.prefix().trim().length ? \"\\n\\n\" : \"\"\n  }\n}\n","import htmx from \"htmx.org\"\nimport Mention from \"../Mention\"\nimport * as animations from \"../animations\"\nimport MarkupEditorUploader from \"./uploader\"\nimport {\n  MarkupEditorCodeModal,\n  MarkupEditorImageModal,\n  MarkupEditorLinkModal,\n  MarkupEditorQuoteModal,\n} from \"./modals\"\n\nclass MarkupEditor {\n  constructor() {\n    this.actions = {}\n\n    this.codeModal = new MarkupEditorCodeModal()\n    this.linkModal = new MarkupEditorLinkModal()\n    this.imageModal = new MarkupEditorImageModal()\n    this.quoteModal = new MarkupEditorQuoteModal()\n\n    this.mentions = {}\n\n    this.resizeDebounce = null\n\n    window.addEventListener(\"resize\", (event) => {\n      if (this.resizeDebounce) {\n        window.clearTimeout(this.resizeDebounce)\n      }\n\n      this.resizeDebounce = window.setTimeout(this._onWindowResize, 200)\n    })\n  }\n\n  _onWindowResize = () => {\n    document\n      .querySelectorAll(\"[misago-editor-active]\")\n      .forEach(this._resizeEditor)\n  }\n\n  _resizeEditor = (element) => {\n    const constraints = this._getResizeConstraints(element)\n    const firstToolbar = element.querySelector(\".markup-editor-toolbar-left\")\n    const secondToolbar = element.querySelector(\n      \".markup-editor-toolbar-secondary\"\n    )\n    const moreBtn = element.querySelector(\"[misago-editor-more]\")\n\n    let takenSpace = 0\n    const items = []\n    for (let i = 0; i < firstToolbar.children.length; i++) {\n      const child = firstToolbar.children[i]\n      if (child.getAttribute(\"misago-editor-more\") !== \"true\") {\n        items.push({\n          index: i,\n          priority: parseInt(child.getAttribute(\"misago-editor-priority\") || 0),\n          display: true,\n        })\n\n        if (child.clientWidth) {\n          takenSpace += constraints.btn\n        }\n      }\n    }\n\n    if (takenSpace > constraints.toolbar) {\n      const limit = constraints.toolbar - constraints.btn\n      items.sort((a, b) => {\n        if (a.priority > b.priority) {\n          return 1\n        } else if (a.priority < b.priority) {\n          return -1\n        }\n        return 0\n      })\n\n      items.forEach((item) => {\n        if (takenSpace > limit) {\n          firstToolbar.children[item.index].classList.add(\"d-none\")\n          secondToolbar.children[item.index].classList.remove(\"d-none\")\n          item.display = false\n          takenSpace -= constraints.btn\n        } else {\n          firstToolbar.children[item.index].classList.remove(\"d-none\")\n          secondToolbar.children[item.index].classList.add(\"d-none\")\n          item.display = true\n        }\n      })\n    } else if (takenSpace + constraints.btn < constraints.toolbar) {\n      takenSpace = 0\n      const limit = constraints.toolbar\n      items.sort((a, b) => {\n        if (a.priority > b.priority) {\n          return -1\n        } else if (a.priority < b.priority) {\n          return 1\n        }\n        return 0\n      })\n\n      items.forEach((item) => {\n        if (takenSpace + constraints.btn < limit) {\n          firstToolbar.children[item.index].classList.remove(\"d-none\")\n          secondToolbar.children[item.index].classList.add(\"d-none\")\n          item.display = true\n          takenSpace += constraints.btn\n        } else {\n          firstToolbar.children[item.index].classList.add(\"d-none\")\n          secondToolbar.children[item.index].classList.remove(\"d-none\")\n          item.display = false\n        }\n      })\n    }\n\n    if (items.filter((item) => !item.display).length === 0) {\n      moreBtn.classList.add(\"d-none\")\n      secondToolbar.classList.remove(\"show\")\n    } else {\n      moreBtn.classList.remove(\"d-none\")\n    }\n  }\n\n  _getResizeConstraints = (element) => {\n    const toolbar = element.querySelector(\".markup-editor-toolbar-left\")\n\n    let btnWidth = 0\n    toolbar.querySelectorAll(\"button\").forEach((child) => {\n      let childWidth = child.clientWidth\n      const childStyle = window.getComputedStyle(child)\n      childWidth += parseInt(parseFloat(childStyle.borderLeftWidth))\n      childWidth += parseInt(parseFloat(childStyle.borderRightWidth))\n      childWidth += parseInt(parseFloat(childStyle.marginLeft))\n      childWidth += parseInt(parseFloat(childStyle.marginRight))\n\n      if (childWidth > btnWidth) {\n        btnWidth = childWidth\n      }\n    })\n\n    const toolbarWidth = toolbar.parentElement.clientWidth - btnWidth\n\n    return {\n      btn: btnWidth,\n      toolbar: toolbarWidth,\n    }\n  }\n\n  setAction = (name, init) => {\n    this.actions[name] = init\n  }\n\n  activate = (element) => {\n    if (element.getAttribute(\"misago-editor-active\") !== \"true\") {\n      this._setEditorActive(element)\n      this._setEditorFocus(element)\n      this._setEditorActions(element)\n      this._setEditorPasteUpload(element)\n      this._setEditorDropUpload(element)\n      this._resizeEditor(element)\n\n      const textarea = this.getTextarea(element)\n      this.mentions[textarea.id] = new Mention(textarea)\n    }\n  }\n\n  _setEditorActive(element) {\n    element.setAttribute(\"misago-editor-active\", \"true\")\n  }\n\n  _setEditorFocus(element) {\n    const focusEvents = [\"focusin\", \"click\"]\n    const className = \"markup-editor-focused\"\n\n    focusEvents.forEach((event) => {\n      element.addEventListener(event, () => {\n        element.classList.add(className)\n      })\n    })\n\n    focusEvents.forEach((event) => {\n      document.addEventListener(event, (event) => {\n        if (!element.contains(event.target)) {\n          element.classList.remove(className)\n        }\n      })\n    })\n  }\n\n  _setEditorActions(element) {\n    const textarea = this.getTextarea(element)\n\n    element.addEventListener(\"click\", (event) => {\n      const target = event.target.closest(\"[misago-editor-action]\")\n      if (!target) {\n        return null\n      }\n\n      const actionName = target.getAttribute(\"misago-editor-action\")\n      if (!actionName) {\n        return null\n      }\n\n      event.preventDefault()\n\n      const action = this.actions[actionName]\n      if (action) {\n        action({\n          textarea,\n          target,\n          editor: this,\n          selection: new MarkupEditorSelection(textarea),\n        })\n      } else {\n        console.warn(\"Undefined editor action: \" + actionName)\n      }\n    })\n\n    element\n      .querySelector(\"[misago-editor-more]\")\n      .addEventListener(\"click\", () => {\n        const secondToolbar = element.querySelector(\n          \".markup-editor-toolbar-secondary\"\n        )\n        if (secondToolbar.classList.contains(\"show\")) {\n          secondToolbar.classList.remove(\"show\")\n        } else {\n          secondToolbar.classList.add(\"show\")\n        }\n      })\n  }\n\n  _setEditorPasteUpload = (element) => {\n    element.addEventListener(\"paste\", (event) => {\n      if (event.clipboardData.files.length) {\n        const uploader = new MarkupEditorUploader(this, element)\n        if (!uploader.canUpload) {\n          uploader.showPermissionDeniedError()\n        } else {\n          event.preventDefault()\n          const textarea = event.target.closest(\"textarea\")\n          uploader.uploadFiles(event.clipboardData.files, textarea)\n        }\n      }\n    })\n  }\n\n  _setEditorDropUpload = (element) => {\n    const className = \"markup-editor-drag-drop\"\n    const elements = [element.querySelector(\"textarea\")]\n\n    const attachments = element.querySelector(\"[misago-editor-attachments]\")\n    if (attachments) {\n      elements.push(attachments)\n    }\n\n    elements.forEach((child) => {\n      child.addEventListener(\"drop\", (event) => {\n        const uploader = new MarkupEditorUploader(this, element)\n        if (event.dataTransfer.files.length) {\n          event.preventDefault()\n          if (!uploader.canUpload) {\n            uploader.showPermissionDeniedError()\n          } else if (event.dataTransfer.files) {\n            const textarea = event.target.closest(\"textarea\")\n            uploader.uploadFiles(event.dataTransfer.files, textarea)\n          }\n        }\n\n        child.classList.remove(className)\n      })\n\n      child.addEventListener(\"dragenter\", (event) => {\n        event.preventDefault()\n      })\n\n      child.addEventListener(\"dragleave\", () => {\n        child.classList.remove(className)\n      })\n\n      child.addEventListener(\"dragover\", (event) => {\n        child.classList.add(className)\n        event.preventDefault()\n      })\n    })\n  }\n\n  getTextarea(element) {\n    return element.querySelector(\"textarea\")\n  }\n\n  getSelection(textarea) {\n    return new MarkupEditorSelection(textarea)\n  }\n\n  showFilePrompt(element, options) {\n    const uploader = new MarkupEditorUploader(\n      this,\n      element.closest(\"[misago-editor-active]\")\n    )\n\n    if (!uploader.canUpload) {\n      uploader.showPermissionDeniedError()\n    } else {\n      uploader.prompt(options)\n    }\n  }\n\n  showCodeModal(selection) {\n    this.codeModal.show(selection)\n  }\n\n  showLinkModal(selection) {\n    this.linkModal.show(selection)\n  }\n\n  showImageModal(selection) {\n    this.imageModal.show(selection)\n  }\n\n  showQuoteModal(selection) {\n    this.quoteModal.show(selection)\n  }\n\n  getAttachmentByKey(key) {\n    return document.querySelector('[misago-editor-upload-key=\"' + key + '\"]')\n  }\n\n  removeAttachmentElement(element) {\n    const list = element.closest(\"ul\")\n\n    animations.deleteElement(element, function () {\n      if (!list.querySelector(\"li\")) {\n        const container = list.closest(\".markup-editor-attachments-list\")\n        container.classList.add(\"d-none\")\n      }\n    })\n  }\n}\n\nclass MarkupEditorSelection {\n  constructor(textarea) {\n    this.textarea = textarea\n    this._range = this._getRange()\n  }\n\n  get() {\n    return this._range\n  }\n\n  prefix() {\n    return this._range.prefix\n  }\n\n  suffix() {\n    return this._range.suffix\n  }\n\n  zero() {\n    return this._range.length === 0\n  }\n\n  empty() {\n    return this._range.text.trim().length === 0\n  }\n\n  text() {\n    return this._range.text\n  }\n\n  wrap(prefix, suffix) {\n    let value = this._range.prefix\n    value += prefix + this._range.text + suffix\n    value += this._range.suffix\n\n    this.textarea.value = value\n\n    this._range.start += prefix.length\n    this._range.end += prefix.length\n    this._range.length = this._range.end - this._range.start\n\n    this.refocus()\n  }\n\n  replace(text, options) {\n    const value = this._range.prefix + text + this._range.suffix\n    this.textarea.value = value\n\n    if (options && options.start) {\n      this._range.start += options.start\n    }\n\n    this._range.end = this._range.start + text.length\n\n    if (options) {\n      if (options.start) {\n        this._range.end -= options.start\n      }\n      if (options.end) {\n        this._range.end -= options.end\n      }\n    }\n\n    this._range.length = this._range.end - this._range.start\n\n    this.refocus()\n  }\n\n  insert(text, options) {\n    const whitespace = (options && options.whitespace) || \"\"\n\n    const prefix = whitespace\n      ? this._range.prefix.trimEnd()\n      : this._range.prefix\n    const suffix = whitespace ? this._range.suffix.trim() : this._range.suffix\n\n    let whitespaces = 1\n    let value = prefix\n\n    if (prefix.length && whitespace) {\n      value += whitespace\n      whitespaces += 1\n    }\n\n    value += text + whitespace + suffix\n    this.textarea.value = value\n\n    const caret = prefix.length + text.length + whitespace.length * whitespaces\n    this._range.end = this._range.start = caret\n    this._range.length = 0\n\n    this.refocus()\n  }\n\n  replaceAttachments(callback) {\n    this.textarea.value = this.textarea.value.replace(\n      /<attachment=(.+?)>/gi,\n      function (match, p1) {\n        if (p1.match(/:/g).length !== 1) {\n          return match\n        }\n\n        let value = p1.trim()\n        while (value.substring(0, 1) === '\"') {\n          value = value.substring(1)\n        }\n        while (value.substring(value.length - 1) === '\"') {\n          value = value.substring(0, value.length - 1)\n        }\n\n        const name = value.substring(0, value.indexOf(\":\")).trim()\n        const id = value.substring(value.indexOf(\":\") + 1).trim()\n\n        if ((name, id)) {\n          const result = callback({ match, name, id })\n          if (typeof result === \"string\" || result instanceof String) {\n            return result\n          }\n        }\n\n        return match\n      }\n    )\n  }\n\n  refocus() {\n    window.setTimeout(() => {\n      const scroll = this.textarea.scrollTop\n      this.textarea.focus()\n      this.textarea.scrollTop = scroll\n\n      const caret = this._range.start\n      this.textarea.setSelectionRange(caret, caret + this._range.length)\n    }, 250)\n  }\n\n  _getRange() {\n    if (document.selection) {\n      this.textarea.focus()\n      const range = document.selection.createRange()\n      const length = range.text.length\n      range.moveStart(\"character\", -this.textarea.value.length)\n      return this._createRange(\n        this.textarea,\n        range.text.length - length,\n        range.text.length\n      )\n    }\n\n    if (this.textarea.selectionStart || this.textarea.selectionStart == \"0\") {\n      return this._createRange(\n        this.textarea,\n        this.textarea.selectionStart,\n        this.textarea.selectionEnd\n      )\n    }\n  }\n\n  _createRange(textarea, start, end) {\n    return {\n      start: start,\n      end: end,\n      length: end - start,\n      text: textarea.value.substring(start, end),\n      prefix: textarea.value.substring(0, start),\n      suffix: textarea.value.substring(end),\n    }\n  }\n}\n\nconst editor = new MarkupEditor()\n\nexport default editor\n\neditor.setAction(\"strong\", function ({ selection }) {\n  if (selection.empty()) {\n    selection.replace(\"**\" + pgettext(\"example markup\", \"Strong text\") + \"**\", {\n      start: 2,\n      end: 2,\n    })\n  } else {\n    selection.wrap(\"**\", \"**\")\n  }\n})\n\neditor.setAction(\"emphasis\", function ({ selection }) {\n  if (selection.empty()) {\n    selection.replace(\n      \"_\" + pgettext(\"example markup\", \"Text with emphasis\") + \"_\",\n      { start: 1, end: 1 }\n    )\n  } else {\n    selection.wrap(\"_\", \"_\")\n  }\n})\n\neditor.setAction(\"strikethrough\", function ({ selection }) {\n  if (selection.empty()) {\n    selection.replace(\n      \"~~\" + pgettext(\"example markup\", \"Text with strikethrough\") + \"~~\",\n      { start: 2, end: 2 }\n    )\n  } else {\n    selection.wrap(\"~~\", \"~~\")\n  }\n})\n\neditor.setAction(\"horizontal-ruler\", function ({ selection }) {\n  selection.insert(\"- - -\", { whitespace: \"\\n\\n\" })\n})\n\neditor.setAction(\"link\", function ({ editor, selection }) {\n  editor.showLinkModal(selection)\n})\n\neditor.setAction(\"image\", function ({ editor, selection }) {\n  editor.showImageModal(selection)\n})\n\neditor.setAction(\"quote\", function ({ editor, selection }) {\n  editor.showQuoteModal(selection)\n})\n\neditor.setAction(\"spoiler\", function ({ selection }) {\n  const prefix = selection.prefix().trim().length\n    ? \"\\n\\n[spoiler]\\n\"\n    : \"[spoiler]\\n\"\n  const suffix = \"\\n[/spoiler]\\n\\n\"\n\n  if (selection.empty()) {\n    selection.replace(\n      prefix + pgettext(\"example markup\", \"Spoiler text\") + suffix,\n      { start: prefix.length, end: suffix.length }\n    )\n  } else {\n    selection.wrap(prefix, suffix)\n  }\n})\n\neditor.setAction(\"code\", function ({ editor, selection }) {\n  editor.showCodeModal(selection)\n})\n\neditor.setAction(\"attachment\", function ({ target, selection }) {\n  const attachment = target.getAttribute(\"misago-editor-attachment\")\n  if (attachment) {\n    selection.insert(\"<attachment=\" + attachment + \">\", { whitespace: \"\\n\\n\" })\n  }\n})\n\neditor.setAction(\"image-upload\", function ({ editor, target }) {\n  editor.showFilePrompt(target, { accept: \"image\", insert: true })\n})\n\neditor.setAction(\"attachment-upload\", function ({ editor, target }) {\n  editor.showFilePrompt(target)\n})\n\neditor.setAction(\"attachment-delete\", function ({ editor, target, selection }) {\n  const attachment = target.getAttribute(\"misago-editor-attachment\")\n  const name = target\n    .closest(\"[misago-editor-deleted-attachments-name]\")\n    .getAttribute(\"misago-editor-deleted-attachments-name\")\n\n  selection.replaceAttachments(function ({ id }) {\n    if (id === attachment) {\n      return \"\"\n    }\n\n    return false\n  })\n\n  const element = target.closest(\"li\")\n  editor.removeAttachmentElement(element)\n\n  const input = document.createElement(\"input\")\n  input.setAttribute(\"type\", \"hidden\")\n  input.setAttribute(\"name\", name)\n  input.setAttribute(\"value\", attachment)\n\n  const attachments = target.closest(\"[misago-editor-attachments]\")\n  attachments.appendChild(input)\n})\n\neditor.setAction(\n  \"attachment-error-dismiss\",\n  function ({ editor, target, selection }) {\n    const key = target.getAttribute(\"misago-editor-attachment-key\")\n\n    selection.replaceAttachments(function (attachment) {\n      if (attachment.id === key) {\n        return \"\"\n      }\n\n      return false\n    })\n\n    const message = document.querySelector(\n      '[misago-editor-attachment-error=\"' + key + '\"]'\n    )\n    if (message) {\n      animations.deleteElement(message)\n    }\n\n    const attachment = editor.getAttachmentByKey(key)\n    if (attachment) {\n      editor.removeAttachmentElement(attachment)\n    }\n  }\n)\n\neditor.setAction(\"formatting-help\", function ({ target }) {\n  const modal = document.getElementById(\"markup-editor-formatting-help\")\n  const element = target.closest(\"a\")\n\n  htmx\n    .ajax(\"GET\", element.href, {\n      target: modal,\n      swap: \"innerHTML\",\n    })\n    .then(() => {\n      $(modal).modal(\"show\")\n    })\n})\n","import editor from \"./editor\"\n\nexport default editor\n\nexport function activateEditors() {\n  document\n    .querySelectorAll(\"[misago-editor-active='false']\")\n    .forEach(editor.activate)\n}\n","import htmx from \"htmx.org\"\n\nfunction activatePollChoicesControl(element) {\n  element.setAttribute(\"m-poll-choices-control\", \"true\")\n\n  const maxChoices = Number(element.getAttribute(\"max-choices\") || 0)\n\n  element.addEventListener(\"keyup\", function (event) {\n    const input = event.target.closest(\"input\")\n    const newChoices = element.querySelectorAll(\"[m-poll-new-choice]\").length\n\n    if (\n      input &&\n      input.value.trim() &&\n      (!maxChoices || newChoices < maxChoices)\n    ) {\n      const listItem = event.target.closest(\"li\")\n      if (!listItem.nextElementSibling) {\n        const newListItem = listItem.cloneNode(true)\n        const newInput = newListItem.querySelector(\"input\")\n\n        newInput.value = \"\"\n        newInput.name = input.name\n\n        listItem.after(newListItem)\n      }\n    }\n  })\n}\n\nexport default activatePollChoicesControl\n\nhtmx.onLoad(function () {\n  document\n    .querySelectorAll(\"[m-poll-choices-control]\")\n    .forEach(function (element) {\n      if (!element.getAttribute(\"m-poll-choices-control\")) {\n        activatePollChoicesControl(element)\n      }\n    })\n})\n","import htmx from \"htmx.org\"\n\nexport function activatePageSelectForms() {\n  document.querySelectorAll(\"[misago-page-form]\").forEach((element) => {\n    if (element.getAttribute(\"misago-page-form\") === \"\") {\n      activatePageSelectForm(element)\n    }\n  })\n}\n\nexport function activatePageSelectForm(form) {\n  form.setAttribute(\"misago-page-form\", \"true\")\n  form.addEventListener(\"submit\", (event) => {\n    const page = form.getAttribute(\"misago-page\")\n    const input = event.target.querySelector(\"input\")\n    const value = input.value\n    if (value >= input.min && value <= input.max && value != page) {\n      let url = form.getAttribute(\"misago-page-url\")\n      if (value > 1) {\n        url += value + \"/\"\n      }\n\n      window.history.pushState({}, \"\", url)\n      document.getElementById(\"misago-page-scroll-target\").scrollIntoView()\n\n      htmx.ajax(\"GET\", url, {\n        target: \"#misago-htmx-root\",\n        swap: \"outerHTML\",\n      })\n    }\n\n    const toggle = form.closest(\".dropdown\").querySelector(\"[data-toggle]\")\n    if (toggle) {\n      $().dropdown(\"toggle\")\n    }\n\n    event.preventDefault()\n    return false\n  })\n}\n\nhtmx.onLoad(activatePageSelectForms)\n","class QuoteCursorPosition {\n  constructor(tether) {\n    this.tether = tether\n\n    this.shadow = this.createShadow()\n    this.padding = null\n  }\n\n  createShadow() {\n    const shadow = document.createElement(\"div\")\n    shadow.ariaHidden = true\n    shadow.style.position = \"absolute\"\n    shadow.style.top = 0\n    shadow.style.left = \"-9999px\"\n    shadow.style.opacity = 0\n    shadow.style.zIndex = -999\n\n    document.body.appendChild(shadow)\n\n    return shadow\n  }\n\n  getPosition(root, range) {\n    const { element } = root\n\n    this.shadow.setAttribute(\"class\", element.getAttribute(\"class\"))\n\n    const rangeClone = range.cloneRange()\n    rangeClone.setStart(element.childNodes[0], 0)\n\n    const rangeRect = rangeClone.getBoundingClientRect()\n    this.shadow.style.width = `${rangeRect.width}px`\n\n    if (this.padding === null) {\n      const padding = window\n        .getComputedStyle(element)\n        .getPropertyValue(\"padding-top\")\n      this.padding = parseFloat(padding.substring(0, padding.length - 2))\n    }\n\n    this.shadow.replaceChildren(...rangeClone.cloneContents().childNodes)\n\n    const tether = this.findTether(this.shadow.childNodes)\n    if (!tether) {\n      this.shadow.replaceChildren()\n      return null\n    }\n\n    const shadowRect = this.shadow.getBoundingClientRect()\n    const tetherRect = tether.getBoundingClientRect()\n    const tetherOffset = tetherRect.x - shadowRect.x + tetherRect.width\n\n    const rect = {\n      top: rangeRect.bottom,\n      bottom: rangeRect.bottom + 1,\n      left: rangeRect.x + tetherOffset,\n      right: rangeRect.x + tetherOffset + 1,\n      height: 1,\n      width: 1,\n      x: rangeRect.x + tetherOffset.x,\n      y: rangeRect.bottom,\n    }\n\n    this.shadow.replaceChildren()\n\n    return {\n      getBoundingClientRect() {\n        return rect\n      },\n    }\n  }\n\n  findTether(nodes) {\n    let result = null\n\n    const { rules } = this.tether\n    for (let i = 0; i < nodes.length; i++) {\n      const node = nodes[i]\n\n      for (let i = 0; i < rules.length; i++) {\n        const { func } = rules[i]\n        result = func(this, node) || result\n      }\n    }\n\n    return result\n  }\n}\n\nexport default QuoteCursorPosition\n","class QuoteSelection {\n  constructor(extractor, renderer, postprocess) {\n    this.extractor = extractor\n    this.renderer = renderer\n    this.postprocess = postprocess\n  }\n\n  getQuote(root) {\n    let result = this.extractNodes(root.childNodes)\n    result = this.postprocessNodes(root, result)\n    if (result.length === 0) {\n      return \"\"\n    }\n    return this.renderNodes(result).trim()\n  }\n\n  extractNodes(nodes, stack) {\n    const state = {\n      nodes,\n      node: null,\n      result: [],\n      stack: stack || [],\n      pos: 0,\n      posMax: nodes.length - 1,\n    }\n\n    const { rules } = this.extractor\n    while (state.pos <= state.posMax) {\n      let match = false\n\n      const node = nodes[state.pos]\n      state.node = node\n\n      for (let r = 0; r < rules.length; r++) {\n        const rule = rules[r].func\n        if (rule(this, state)) {\n          match = true\n          break\n        }\n      }\n\n      state.pos += match ? 0 : 1\n    }\n\n    return state.result\n  }\n\n  postprocessNodes(root, nodes) {\n    let result = nodes\n\n    const { rules } = this.postprocess\n    for (let i = 0; i < rules.length; i++) {\n      result = rules[i].func(this, root, result)\n    }\n\n    return result\n  }\n\n  renderNodes(nodes) {\n    const state = {\n      nodes,\n      node: null,\n      text: \"\",\n      pos: 0,\n      posMax: nodes.length - 1,\n    }\n\n    const { rules } = this.renderer\n    while (state.pos <= state.posMax) {\n      let match = false\n\n      const node = nodes[state.pos]\n      state.node = node\n\n      for (let r = 0; r < rules.length; r++) {\n        const rule = rules[r].func\n        if (rule(this, state)) {\n          match = true\n          break\n        }\n      }\n\n      state.pos += match ? 0 : 1\n    }\n\n    return state.text\n  }\n}\n\nexport default QuoteSelection\n","class Ruleset {\n  constructor(rules) {\n    this.rules = rules || []\n  }\n\n  push(name, func) {\n    this.rules.push({ name, func })\n  }\n\n  replace(name, func) {\n    this.rules = this.rules.map((rule) => {\n      if (rule.name === name) {\n        return { name, func }\n      } else {\n        return rule\n      }\n    })\n  }\n\n  before(beforeName, name, func) {\n    const rules = []\n    this.rules.forEach((rule) => {\n      rules.push({ name, func })\n      if (rule.name === beforeName) {\n        rules.push(rule)\n      }\n    })\n    this.rules = rules\n  }\n\n  after(afterName, name, func) {\n    const rules = []\n    this.rules.forEach((rule) => {\n      if (rule.name === afterName) {\n        rules.push(rule)\n      }\n      rules.push({ name, func })\n    })\n    this.rules = rules\n  }\n}\n\nexport default Ruleset\n","export default function getQuotedCode(node) {\n  const code = getCodeTextContent(node)\n  return dedentTrimCode(code)\n}\n\nfunction getCodeTextContent(node) {\n  let text = \"\"\n  for (let i = 0; i < node.childNodes.length; i++) {\n    const child = node.childNodes[i]\n    if (child.nodeType === Node.TEXT_NODE) {\n      text += child.textContent\n    } else if (child.nodeName === \"SPAN\") {\n      text += getCodeTextContent(child)\n    }\n  }\n  return text\n}\n\nfunction dedentTrimCode(code) {\n  const lines = splitLines(trimCodeBlankLines(code))\n\n  let dedent = -1\n  for (let i = 0; i < lines.length; i++) {\n    const line = lines[i]\n    if (line.trim()) {\n      const lineDedent = lines[i].length - lines[i].trimStart().length\n      if (dedent === -1 || lineDedent < dedent) {\n        dedent = lineDedent\n      }\n    }\n  }\n\n  if (dedent) {\n    for (let i = 0; i < lines.length; i++) {\n      lines[i] = lines[i].substring(dedent)\n    }\n  }\n\n  return lines.join(\"\\n\")\n}\n\nfunction trimCodeBlankLines(code) {\n  const cleanLines = []\n  const lines = splitLines(code)\n  for (let i = 0; i < lines.length; i++) {\n    const line = lines[i]\n    if (cleanLines.length || line.trim()) {\n      cleanLines.push(line.trimEnd())\n    }\n  }\n  return cleanLines.join(\"\\n\").trimEnd()\n}\n\nfunction splitLines(text) {\n  return text.split(/\\r?\\n/)\n}\n","import getQuotedCode from \"./getQuotedCode\"\n\nfunction attachment(selection, state) {\n  const { result, node } = state\n\n  if (node.nodeName !== \"DIV\" && node.nodeName !== \"SPAN\") {\n    return false\n  }\n\n  const attachment = node.getAttribute(\"misago-rich-text-attachment\")\n  if (!attachment) {\n    return false\n  }\n\n  if (!node.childNodes.length) {\n    return false\n  }\n\n  result.push({\n    type: \"attachment\",\n    args: attachment,\n  })\n\n  state.pos += 1\n  return true\n}\n\nfunction youtube(selection, state) {\n  const { result, node } = state\n\n  if (node.nodeName !== \"DIV\") {\n    return false\n  }\n\n  const url = node.getAttribute(\"misago-rich-text-youtube\")\n  if (!url) {\n    return false\n  }\n\n  result.push({\n    type: \"youtube\",\n    url,\n  })\n\n  state.pos += 1\n  return true\n}\n\nconst HEADER_NODES = {\n  H1: true,\n  H2: true,\n  H3: true,\n  H4: true,\n  H5: true,\n  H6: true,\n}\n\nfunction header(selection, state) {\n  const { result, node, stack } = state\n\n  if (!HEADER_NODES[node.nodeName]) {\n    return false\n  }\n\n  const children = selection.extractNodes(\n    node.childNodes,\n    stack.concat([\"header\"])\n  )\n\n  if (!children.length) {\n    state.pos += 1\n    return true\n  }\n\n  const level = parseInt(node.nodeName.substring(1))\n\n  result.push({\n    type: \"header\",\n    level,\n    children,\n  })\n\n  state.pos += 1\n  return true\n}\n\nfunction quote(selection, state) {\n  const { result, node, stack } = state\n\n  if (node.nodeName !== \"ASIDE\") {\n    return false\n  }\n\n  const blockquote = node.querySelector(\"blockquote[misago-rich-text-quote]\")\n  if (!blockquote) {\n    return false\n  }\n\n  const info = blockquote.getAttribute(\"misago-rich-text-quote\")\n\n  const children = selection.extractNodes(\n    blockquote.childNodes,\n    stack.concat([\"quote\"])\n  )\n\n  if (!children.length) {\n    state.pos += 1\n    return true\n  }\n\n  result.push({\n    type: \"quote\",\n    info,\n    children,\n  })\n\n  state.pos += 1\n  return true\n}\n\nfunction spoiler(selection, state) {\n  const { result, node, stack } = state\n\n  if (node.nodeName !== \"DETAILS\") {\n    return false\n  }\n\n  const body = node.querySelector(\"div[misago-rich-text-spoiler]\")\n  if (!body) {\n    return false\n  }\n\n  const info = body.getAttribute(\"misago-rich-text-spoiler\")\n\n  const children = selection.extractNodes(\n    body.childNodes,\n    stack.concat([\"quote\"])\n  )\n\n  if (!children.length) {\n    state.pos += 1\n    return true\n  }\n\n  result.push({\n    type: \"spoiler\",\n    info,\n    children,\n  })\n\n  state.pos += 1\n  return true\n}\n\nfunction code(selection, state) {\n  const { result, node, stack } = state\n\n  if (!(node.nodeName === \"DIV\" || node.nodeName === \"PRE\")) {\n    return false\n  }\n\n  const code = node.querySelector(\"code[misago-rich-text-code]\")\n  if (!code) {\n    return false\n  }\n\n  const info = code.getAttribute(\"misago-rich-text-code\")\n  const content = getQuotedCode(code)\n\n  result.push({\n    type: \"code\",\n    info,\n    content,\n  })\n\n  state.pos += 1\n  return true\n}\n\nfunction paragraph(selection, state) {\n  const { result, node, stack } = state\n\n  if (node.nodeName !== \"P\") {\n    return false\n  }\n\n  const children = selection.extractNodes(\n    node.childNodes,\n    stack.concat([\"paragraph\"])\n  )\n\n  if (!children.length) {\n    state.pos += 1\n    return true\n  }\n\n  result.push({\n    type: \"paragraph\",\n    children,\n  })\n\n  state.pos += 1\n  return true\n}\n\nfunction table(selection, state) {\n  const { result, node, stack } = state\n\n  if (\n    node.nodeName !== \"DIV\" ||\n    node.getAttribute(\"misago-rich-text\") !== \"table-container\"\n  ) {\n    return false\n  }\n\n  const tables = Array.from(node.childNodes).filter(function (node) {\n    return node.nodeName === \"TABLE\"\n  })\n\n  if (tables.length !== 1) {\n    return false\n  }\n\n  const table = tables[0]\n\n  const children = selection.extractNodes(\n    table.childNodes,\n    stack.concat([\"table\"])\n  )\n\n  if (!children.length) {\n    state.pos += 1\n    return true\n  }\n\n  result.push({\n    type: \"table\",\n    children,\n  })\n\n  state.pos += 1\n  return true\n}\n\nfunction table_head(selection, state) {\n  const { result, node, stack } = state\n\n  if (node.nodeName !== \"THEAD\") {\n    return false\n  }\n\n  const children = selection.extractNodes(\n    node.childNodes,\n    stack.concat([\"table_head\"])\n  )\n\n  if (!children.length) {\n    state.pos += 1\n    return true\n  }\n\n  result.push({\n    type: \"table_head\",\n    children,\n  })\n\n  state.pos += 1\n  return true\n}\n\nfunction table_body(selection, state) {\n  const { result, node, stack } = state\n\n  if (node.nodeName !== \"TBODY\") {\n    return false\n  }\n\n  const children = selection.extractNodes(\n    node.childNodes,\n    stack.concat([\"table_body\"])\n  )\n\n  if (!children.length) {\n    state.pos += 1\n    return true\n  }\n\n  result.push({\n    type: \"table_body\",\n    children,\n  })\n\n  state.pos += 1\n  return true\n}\n\nfunction table_row(selection, state) {\n  const { result, node, stack } = state\n\n  if (node.nodeName !== \"TR\") {\n    return false\n  }\n\n  const children = selection.extractNodes(\n    node.childNodes,\n    stack.concat([\"table_row\"])\n  )\n\n  if (!children.length) {\n    state.pos += 1\n    return true\n  }\n\n  result.push({\n    type: \"table_row\",\n    id: node.id,\n    children,\n  })\n\n  state.pos += 1\n  return true\n}\n\nfunction table_th(selection, state) {\n  const { result, node, stack } = state\n\n  if (node.nodeName !== \"TH\") {\n    return false\n  }\n\n  const children = selection.extractNodes(\n    node.childNodes,\n    stack.concat([\"table_th\"])\n  )\n\n  if (!children.length) {\n    state.pos += 1\n    return true\n  }\n\n  const { index, alignment } = getTableCellMeta(node)\n\n  result.push({\n    type: \"table_th\",\n    index,\n    alignment,\n    children,\n  })\n\n  state.pos += 1\n  return true\n}\n\nfunction table_td(selection, state) {\n  const { result, node, stack } = state\n\n  if (node.nodeName !== \"TD\") {\n    return false\n  }\n\n  const children = selection.extractNodes(\n    node.childNodes,\n    stack.concat([\"table_td\"])\n  )\n\n  if (!children.length) {\n    state.pos += 1\n    return true\n  }\n\n  const { index, alignment } = getTableCellMeta(node)\n\n  result.push({\n    type: \"table_td\",\n    index,\n    alignment,\n    children,\n  })\n\n  state.pos += 1\n  return true\n}\n\nfunction getTableCellMeta(node) {\n  const meta = node.getAttribute(\"misago-rich-text-col\")\n  if (!meta) {\n    return { index: null, alignment: \"c\" }\n  }\n\n  const values = meta.split(\":\")\n  return { index: parseInt(values[0] || \"0\"), alignment: values[1] || \"c\" }\n}\n\nfunction list(selection, state) {\n  const { result, node, stack } = state\n\n  if (node.nodeName !== \"OL\" && node.nodeName !== \"UL\") {\n    return false\n  }\n\n  const ordered = node.nodeName === \"OL\"\n\n  const children = selection.extractNodes(\n    node.childNodes,\n    stack.concat([\"list\"])\n  )\n\n  if (!children.length) {\n    state.pos += 1\n    return true\n  }\n\n  result.push({\n    type: \"list\",\n    ordered,\n    children,\n  })\n\n  state.pos += 1\n  return true\n}\n\nfunction list_item(selection, state) {\n  const { result, node, stack } = state\n\n  if (node.nodeName !== \"LI\") {\n    return false\n  }\n\n  const children = selection.extractNodes(\n    node.childNodes,\n    stack.concat([\"list_item\"])\n  )\n\n  if (!children.length) {\n    state.pos += 1\n    return true\n  }\n\n  result.push({\n    type: \"list_item\",\n    children,\n  })\n\n  state.pos += 1\n  return true\n}\n\nfunction hr(selection, state) {\n  const { result, node, stack } = state\n\n  if (node.nodeName !== \"HR\") {\n    return false\n  }\n\n  result.push({\n    type: \"hr\",\n  })\n\n  state.pos += 1\n  return true\n}\n\nfunction image(selection, state) {\n  const { result, node } = state\n\n  if (node.nodeName !== \"IMG\") {\n    return false\n  }\n\n  const url = (node.getAttribute(\"src\") || \"\").trim()\n  const alt = (node.getAttribute(\"alt\") || \"\").trim() || null\n  const title = (node.getAttribute(\"title\") || \"\").trim() || null\n\n  if (!url) {\n    return false\n  }\n\n  result.push({\n    type: \"image\",\n    url,\n    alt,\n    title,\n  })\n\n  state.pos += 1\n  return true\n}\n\nfunction mention(selection, state) {\n  const { result, node } = state\n\n  if (!(node.nodeName === \"A\" || node.nodeName === \"SPAN\")) {\n    return false\n  }\n\n  if (!node.getAttribute(\"misago-rich-text-mention\")) {\n    return false\n  }\n\n  result.push({\n    type: \"text\",\n    content: node.textContent,\n  })\n\n  state.pos += 1\n  return true\n}\n\nfunction link(selection, state) {\n  const { result, node, stack } = state\n\n  if (node.nodeName !== \"A\") {\n    return false\n  }\n\n  result.push({\n    type: \"link\",\n    href: node.getAttribute(\"href\"),\n    auto: node.getAttribute(\"misago-rich-text\") === \"autolink\",\n    children: selection.extractNodes(node.childNodes, stack.concat([\"link\"])),\n  })\n\n  state.pos += 1\n  return true\n}\n\nfunction strong_text(selection, state) {\n  const { result, node, stack } = state\n\n  if (node.nodeName !== \"STRONG\") {\n    return false\n  }\n\n  result.push({\n    type: \"strong\",\n    children: selection.extractNodes(\n      node.childNodes,\n      stack.concat([\"strong_text\"])\n    ),\n  })\n\n  state.pos += 1\n  return true\n}\n\nfunction emphasis_text(selection, state) {\n  const { result, node, stack } = state\n\n  if (node.nodeName !== \"EM\") {\n    return false\n  }\n\n  result.push({\n    type: \"emphasis\",\n    children: selection.extractNodes(\n      node.childNodes,\n      stack.concat([\"emphasis_text\"])\n    ),\n  })\n\n  state.pos += 1\n  return true\n}\n\nfunction bold_text(selection, state) {\n  const { result, node, stack } = state\n\n  if (node.nodeName !== \"B\") {\n    return false\n  }\n\n  result.push({\n    type: \"bold\",\n    children: selection.extractNodes(\n      node.childNodes,\n      stack.concat([\"bold_text\"])\n    ),\n  })\n\n  state.pos += 1\n  return true\n}\n\nfunction italic_text(selection, state) {\n  const { result, node, stack } = state\n\n  if (node.nodeName !== \"I\") {\n    return false\n  }\n\n  result.push({\n    type: \"italic\",\n    children: selection.extractNodes(\n      node.childNodes,\n      stack.concat([\"italic_text\"])\n    ),\n  })\n\n  state.pos += 1\n  return true\n}\n\nfunction underline_text(selection, state) {\n  const { result, node, stack } = state\n\n  if (node.nodeName !== \"U\") {\n    return false\n  }\n\n  result.push({\n    type: \"underline\",\n    children: selection.extractNodes(\n      node.childNodes,\n      stack.concat([\"underline_text\"])\n    ),\n  })\n\n  state.pos += 1\n  return true\n}\n\nfunction strikethrough_text(selection, state) {\n  const { result, node, stack } = state\n\n  if (node.nodeName !== \"DEL\") {\n    return false\n  }\n\n  result.push({\n    type: \"strikethrough\",\n    children: selection.extractNodes(\n      node.childNodes,\n      stack.concat([\"strikethrough_text\"])\n    ),\n  })\n\n  state.pos += 1\n  return true\n}\n\nfunction inline_code(selection, state) {\n  const { result, node, stack } = state\n\n  if (node.nodeName !== \"CODE\") {\n    return false\n  }\n\n  result.push({\n    type: \"inline_code\",\n    content: node.textContent,\n  })\n\n  state.pos += 1\n  return true\n}\n\nfunction softbreak(selection, state) {\n  const { result, node, stack } = state\n\n  if (node.nodeName !== \"BR\") {\n    return false\n  }\n\n  result.push({\n    type: \"softbreak\",\n  })\n\n  state.pos += 1\n  return true\n}\n\nfunction text(selection, state) {\n  const { result, node, stack } = state\n\n  if (node.nodeType !== Node.TEXT_NODE) {\n    return false\n  }\n\n  if (node.textContent === \"\\n\") {\n    state.pos += 1\n    return true\n  }\n\n  result.push({\n    type: \"text\",\n    content: node.textContent,\n  })\n\n  state.pos += 1\n  return true\n}\n\nexport default [\n  { name: \"attachment\", func: attachment },\n  { name: \"youtube\", func: youtube },\n  { name: \"header\", func: header },\n  { name: \"quote\", func: quote },\n  { name: \"spoiler\", func: spoiler },\n  { name: \"code\", func: code },\n  { name: \"paragraph\", func: paragraph },\n  { name: \"table\", func: table },\n  { name: \"table_head\", func: table_head },\n  { name: \"table_body\", func: table_body },\n  { name: \"table_row\", func: table_row },\n  { name: \"table_th\", func: table_th },\n  { name: \"table_td\", func: table_td },\n  { name: \"list\", func: list },\n  { name: \"list_item\", func: list_item },\n  { name: \"hr\", func: hr },\n  { name: \"image\", func: image },\n  { name: \"mention\", func: mention },\n  { name: \"link\", func: link },\n  { name: \"strong_text\", func: strong_text },\n  { name: \"emphasis_text\", func: emphasis_text },\n  { name: \"bold_text\", func: bold_text },\n  { name: \"italic_text\", func: italic_text },\n  { name: \"underline_text\", func: underline_text },\n  { name: \"strikethrough_text\", func: strikethrough_text },\n  { name: \"inline_code\", func: inline_code },\n  { name: \"softbreak\", func: softbreak },\n  { name: \"text\", func: text },\n]\n","import getQuotedCode from \"./getQuotedCode\"\n\nfunction attachment(selection, root, nodes) {\n  const { ancestor } = root\n  const container = ancestor.closest(\"[misago-rich-text-attachment]\")\n\n  if (!container) {\n    return nodes\n  }\n\n  const args = container.getAttribute(\"misago-rich-text-attachment\")\n\n  return [\n    {\n      type: \"attachment\",\n      args,\n    },\n  ]\n}\n\nfunction youtube(selection, root, nodes) {\n  const { ancestor } = root\n  const container = ancestor.closest(\"[misago-rich-text-youtube]\")\n\n  if (!container) {\n    return nodes\n  }\n\n  const url = container.getAttribute(\"misago-rich-text-youtube\")\n  if (!url) {\n    return nodes\n  }\n\n  return [\n    {\n      type: \"youtube\",\n      url,\n    },\n  ]\n}\n\nfunction code(selection, root, nodes) {\n  const { ancestor } = root\n  const container = ancestor.closest(\"[misago-rich-text-code]\")\n\n  if (!container) {\n    return nodes\n  }\n\n  const info = container.getAttribute(\"misago-rich-text-code\")\n  const content = getQuotedCode(root)\n\n  return [\n    {\n      type: \"code\",\n      info,\n      content,\n    },\n  ]\n}\n\nfunction table(selection, root, nodes) {\n  return nodes.map((node) => {\n    if (node.type === \"table\") {\n      return fixTable(selection, node)\n    } else {\n      return node\n    }\n  })\n}\n\nfunction fixTable(selection, table) {\n  let result = fixTableHeader(selection, table)\n  return fixTableColumns(selection, result)\n}\n\nfunction fixTableHeader(selection, table) {\n  if (table.children[0].type === \"table_head\") {\n    return table\n  }\n\n  const thead = {\n    type: \"table_head\",\n    children: [{ type: \"table_row\", children: [] }],\n  }\n\n  table.children = [thead, table.children[0]]\n\n  return table\n}\n\nfunction fixTableColumns(selection, table) {\n  const element = document\n    .getElementById(table.children[1].children[0].id)\n    .closest(\"table\")\n\n  const head = table.children[0]\n  const body = table.children[1]\n\n  const cols = {}\n  head.children.forEach(function (row) {\n    row.children.forEach(function (cell) {\n      cols[cell.index] = true\n    })\n  })\n\n  body.children.forEach(function (row) {\n    row.children.forEach(function (cell) {\n      cols[cell.index] = true\n    })\n  })\n\n  head.children[0].children = selection.extractNodes(\n    Array.from(element.querySelector(\"thead tr\").childNodes)\n      .filter((node) => node.nodeName === \"TH\")\n      .filter((_, index) => cols[index])\n  )\n\n  body.children.forEach((row) => {\n    row.children = selection.extractNodes(\n      Array.from(document.getElementById(row.id).childNodes)\n        .filter((node) => node.nodeName === \"TD\")\n        .filter((_, index) => cols[index])\n    )\n  })\n\n  return table\n}\n\nfunction table_head(selection, root, nodes) {\n  if (!nodes || nodes[0].type !== \"table_head\") {\n    return nodes\n  }\n\n  const table = root.ancestor.closest(\"table\")\n\n  const cols = {}\n  nodes.forEach(function (rowset) {\n    rowset.children.forEach(function (row) {\n      row.children.forEach(function (cell) {\n        cols[cell.index] = true\n      })\n    })\n  })\n\n  const thead = {\n    type: \"table_head\",\n    children: [\n      {\n        type: \"table_row\",\n        children: selection.extractNodes(\n          Array.from(table.querySelector(\"thead tr\").childNodes)\n            .filter((node) => node.nodeName === \"TH\")\n            .filter((_, index) => cols[index])\n        ),\n      },\n    ],\n  }\n\n  const tbody = {\n    type: \"table_body\",\n    children: nodes[1].children.map((row) => {\n      row.children = selection.extractNodes(\n        Array.from(document.getElementById(row.id).childNodes)\n          .filter((node) => node.nodeName === \"TD\")\n          .filter((_, index) => cols[index])\n      )\n      return row\n    }),\n  }\n\n  return [\n    {\n      type: \"table\",\n      children: [thead, tbody],\n    },\n  ]\n}\n\nfunction table_row(selection, root, nodes) {\n  if (!nodes || nodes[0].type !== \"table_row\") {\n    return nodes\n  }\n\n  const table = root.ancestor.closest(\"table\")\n\n  const cols = {}\n  nodes.forEach(function (row) {\n    row.children.forEach(function (cell) {\n      cols[cell.index] = true\n    })\n  })\n\n  const thead = {\n    type: \"table_head\",\n    children: [\n      {\n        type: \"table_row\",\n        children: selection.extractNodes(\n          Array.from(table.querySelector(\"thead tr\").childNodes)\n            .filter((node) => node.nodeName === \"TH\")\n            .filter((_, index) => cols[index])\n        ),\n      },\n    ],\n  }\n\n  const tbody = {\n    type: \"table_body\",\n    children: nodes.map((row) => {\n      row.children = selection.extractNodes(\n        Array.from(document.getElementById(row.id).childNodes)\n          .filter((node) => node.nodeName === \"TD\")\n          .filter((_, index) => cols[index])\n      )\n      return row\n    }),\n  }\n\n  return [\n    {\n      type: \"table\",\n      children: [thead, tbody],\n    },\n  ]\n}\n\nfunction table_th(selection, root, nodes) {\n  if (!nodes || nodes[0].type !== \"table_th\") {\n    return nodes\n  }\n\n  const cols = {}\n  nodes.forEach(function (cell) {\n    cols[cell.index] = true\n  })\n\n  const thead = {\n    type: \"table_head\",\n    children: [\n      {\n        type: \"table_row\",\n        children: selection.extractNodes(\n          Array.from(root.ancestor.closest(\"tr\").childNodes)\n            .filter((node) => node.nodeName === \"TH\")\n            .filter((_, index) => cols[index])\n        ),\n      },\n    ],\n  }\n\n  return [\n    {\n      type: \"table\",\n      children: [thead],\n    },\n  ]\n}\n\nfunction table_td(selection, root, nodes) {\n  if (!nodes || nodes[0].type !== \"table_td\") {\n    return nodes\n  }\n\n  const table = root.ancestor.closest(\"table\")\n  const header = Array.from(table.querySelector(\"thead tr\").childNodes).filter(\n    (node) => node.nodeName === \"TH\"\n  )\n\n  const thead = {\n    type: \"table_head\",\n    children: [{ type: \"table_row\", children: [] }],\n  }\n\n  nodes.forEach(function (node) {\n    thead.children[0].children.push(\n      selection.extractNodes([header[node.index]])[0]\n    )\n  })\n\n  const cols = {}\n  nodes.forEach(function (cell) {\n    cols[cell.index] = true\n  })\n\n  const tbody = {\n    type: \"table_body\",\n    children: [\n      {\n        type: \"table_row\",\n        children: selection.extractNodes(\n          Array.from(root.ancestor.closest(\"tr\").childNodes)\n            .filter((node) => node.nodeName === \"TD\")\n            .filter((_, index) => cols[index])\n        ),\n      },\n    ],\n  }\n\n  return [\n    {\n      type: \"table\",\n      children: [thead, tbody],\n    },\n  ]\n}\n\nfunction table_content(selection, root, nodes) {\n  const td = root.ancestor.closest(\"td\")\n\n  if (!td) {\n    return nodes\n  }\n\n  const table = root.ancestor.closest(\"table\")\n  const header = Array.from(table.querySelector(\"thead tr\").childNodes).filter(\n    (node) => node.nodeName === \"TH\"\n  )\n\n  const node = Object.assign(selection.extractNodes([td])[0], {\n    children: nodes,\n  })\n\n  return [\n    {\n      type: \"table\",\n      children: [\n        {\n          type: \"table_head\",\n          children: [\n            {\n              type: \"table_row\",\n              children: selection.extractNodes([header[node.index]]),\n            },\n          ],\n        },\n        {\n          type: \"table_body\",\n          children: [\n            {\n              type: \"table_row\",\n              children: [node],\n            },\n          ],\n        },\n      ],\n    },\n  ]\n}\n\nfunction list(selection, root, nodes) {\n  if (root.ancestor.nodeName === \"OL\" || root.ancestor.nodeName === \"UL\") {\n    return [\n      {\n        type: \"list\",\n        ordered: root.ancestor.nodeName === \"OL\",\n        children: nodes,\n      },\n    ]\n  }\n\n  return nodes\n}\n\nfunction blocks(selection, root, nodes) {\n  let spoiler = false\n  let quote = false\n\n  let result = nodes\n\n  let parent = root.ancestor\n  while (!parent.hasAttribute(\"misago-quote-root\")) {\n    if (parent.hasAttribute(\"misago-rich-text-spoiler\")) {\n      spoiler = true\n      result = [\n        {\n          type: \"spoiler\",\n          info: parent.getAttribute(\"misago-rich-text-spoiler\"),\n          children: result,\n        },\n      ]\n    } else if (parent.hasAttribute(\"misago-rich-text-quote\")) {\n      quote = true\n      result = [\n        {\n          type: \"quote\",\n          info: parent.getAttribute(\"misago-rich-text-quote\"),\n          children: result,\n        },\n      ]\n    }\n\n    if (spoiler && quote) {\n      return result\n    }\n\n    parent = parent.parentNode\n  }\n\n  return result\n}\n\nfunction quote_wrapper(selection, root, nodes) {\n  if (!nodes) {\n    return false\n  }\n\n  if (!wrapNodesInQuote(nodes)) {\n    return nodes\n  }\n\n  return [\n    {\n      type: \"quote\",\n      info: root.info,\n      children: nodes,\n    },\n  ]\n}\n\nfunction wrapNodesInQuote(nodes) {\n  if (nodes.length !== 1) {\n    return true\n  }\n\n  if (nodes[0].type === \"quote\" && nodes[0].info) {\n    return false\n  }\n\n  if (nodes[0].type === \"spoiler\") {\n    return wrapNodesInQuote(nodes[0].children)\n  }\n\n  return true\n}\n\nexport default [\n  { name: \"attachment\", func: attachment },\n  { name: \"youtube\", func: youtube },\n  { name: \"code\", func: code },\n  { name: \"table\", func: table },\n  { name: \"table_head\", func: table_head },\n  { name: \"table_row\", func: table_row },\n  { name: \"table_th\", func: table_th },\n  { name: \"table_td\", func: table_td },\n  { name: \"table_content\", func: table_content },\n  { name: \"list\", func: list },\n  { name: \"blocks\", func: blocks },\n  { name: \"quote_wrapper\", func: quote_wrapper },\n]\n","export function escapeBBCodeArg(arg) {\n  return escapeQuotes(escapeBrackets(escapeBackslash(arg)))\n}\n\nexport function escapeBBCodeContents(arg) {\n  return escapeBrackets(escapeBackslash(arg))\n}\n\nexport function escapeMarkdownLink(arg) {\n  return escapeQuotes(escapeParentheses(escapeBackslash(arg)))\n}\n\nexport function escapeMarkdownLinkText(arg) {\n  return escapeQuotes(escapeBrackets(escapeBackslash(arg)))\n}\n\nexport function escapeMarkdownLinkTitle(arg) {\n  return escapeMarkdownLink(arg)\n}\n\nexport function escapeMarkdownImageTitle(arg) {\n  let escaped = escapeBackslash(arg)\n  escaped = escaped.replaceAll(\"(\", \"\\\\(\")\n  escaped = escaped.replaceAll(\")\", \"\\\\)\")\n  return escaped.replaceAll('\"', '\\\\\"')\n}\n\nexport function escapeAutolink(arg) {\n  return escapeBackslash(arg).replaceAll(\"<\", \"\\\\<\").replaceAll(\">\", \"\\\\>\")\n}\n\nexport function escapeInlineCode(arg) {\n  return escapeBackslash(arg).replaceAll(\"`\", \"\\\\`\").replaceAll(\"`\", \"\\\\`\")\n}\n\nexport function escapeTableCell(arg) {\n  return escapeBackslash(arg).replaceAll(\"|\", \"\\\\|\")\n}\n\nexport function escapeBackslash(text) {\n  return text.replaceAll(\"\\\\\", \"\\\\\\\\\")\n}\n\nexport function escapeBrackets(text) {\n  return text.replaceAll(\"[\", \"\\\\[\").replaceAll(\"]\", \"\\\\]\")\n}\n\nexport function escapeParentheses(text) {\n  return text.replaceAll(\"(\", \"\\\\(\").replaceAll(\")\", \"\\\\)\")\n}\n\nexport function escapeQuotes(text) {\n  return text.replaceAll('\"', '\\\\\"').replaceAll(\"'\", \"\\\\'\")\n}\n","import {\n  escapeAutolink,\n  escapeBBCodeArg,\n  escapeBBCodeContents,\n  escapeInlineCode,\n  escapeMarkdownLink,\n  escapeMarkdownLinkText,\n  escapeMarkdownLinkTitle,\n  escapeTableCell,\n} from \"./escape\"\n\nfunction attachment(selection, state) {\n  const { node } = state\n\n  if (node.type !== \"attachment\") {\n    return false\n  }\n\n  if (state.text) {\n    if (state.nodes[state.pos - 1].type === \"attachment\") {\n      state.text += \"\\n\"\n    } else {\n      state.text += \"\\n\\n\"\n    }\n  }\n\n  state.text += \"<attachment=\" + node.args + \">\"\n  state.pos += 1\n\n  return true\n}\n\nfunction youtube(selection, state) {\n  const { node } = state\n\n  if (node.type !== \"youtube\") {\n    return false\n  }\n\n  if (state.text) {\n    state.text += \"\\n\\n\"\n  }\n\n  state.text += node.url\n  state.pos += 1\n\n  return true\n}\n\nfunction header(selection, state) {\n  const { node } = state\n\n  if (node.type !== \"header\") {\n    return false\n  }\n\n  const text = selection.renderNodes(node.children).trim()\n  if (!text) {\n    return false\n  }\n\n  if (state.text) {\n    state.text += \"\\n\\n\"\n  }\n\n  const prefix = \"#\".repeat(node.level)\n  state.text += prefix + \" \" + text\n  state.pos += 1\n\n  return true\n}\n\nfunction quote(selection, state) {\n  const { node } = state\n\n  if (node.type !== \"quote\") {\n    return false\n  }\n\n  const text = selection.renderNodes(node.children).trim()\n  if (!text) {\n    return false\n  }\n\n  if (state.text) {\n    state.text += \"\\n\\n\"\n  }\n\n  const { info } = node\n\n  state.text += \"[quote\" + (info ? \"=\" + escapeBBCodeArg(info) : \"\") + \"]\\n\"\n  state.text += text\n  state.text += \"\\n[/quote]\"\n  state.pos += 1\n\n  return true\n}\n\nfunction code(selection, state) {\n  const { node } = state\n\n  if (node.type !== \"code\") {\n    return false\n  }\n\n  const { info, content } = node\n\n  if (!node.content) {\n    return false\n  }\n\n  if (state.text) {\n    state.text += \"\\n\\n\"\n  }\n\n  state.text += \"[code\" + (info ? \"=\" + escapeBBCodeArg(info) : \"\") + \"]\\n\"\n  state.text += content\n  state.text += \"\\n[/code]\"\n  state.pos += 1\n\n  return true\n}\n\nfunction spoiler(selection, state) {\n  const { node } = state\n\n  if (node.type !== \"spoiler\") {\n    return false\n  }\n\n  const text = selection.renderNodes(node.children).trim()\n  if (!text) {\n    return false\n  }\n\n  if (state.text) {\n    state.text += \"\\n\\n\"\n  }\n\n  const { info } = node\n\n  state.text += \"[spoiler\" + (info ? \"=\" + escapeBBCodeArg(info) : \"\") + \"]\\n\"\n  state.text += text\n  state.text += \"\\n[/spoiler]\"\n  state.pos += 1\n\n  return true\n}\n\nfunction paragraph(selection, state) {\n  const { node } = state\n\n  if (node.type !== \"paragraph\") {\n    return false\n  }\n\n  const text = selection.renderNodes(node.children).trim()\n  if (!text) {\n    return false\n  }\n\n  if (state.text) {\n    state.text += \"\\n\\n\"\n  }\n\n  state.text += text\n  state.pos += 1\n\n  return true\n}\n\nfunction table(selection, state) {\n  const { node } = state\n\n  if (node.type !== \"table\") {\n    return false\n  }\n\n  if (state.text) {\n    state.text += \"\\n\\n\"\n  }\n\n  const alignment = []\n  const lengths = []\n  const rows = []\n\n  // thead.tr.th\n  node.children.forEach(function (tbody) {\n    if (tbody.type === \"table_head\") {\n      const row = tbody.children[0].children.map(function (cell) {\n        const text = getTableCellText(selection, cell)\n        alignment.push(cell.alignment)\n        lengths.push(Math.max(text.length, 3))\n        return text\n      })\n      rows.push(row)\n    } else if (tbody.type === \"table_body\") {\n      tbody.children.forEach(function (table_row) {\n        const row = table_row.children.map(function (cell, index) {\n          const text = getTableCellText(selection, cell)\n          lengths[index] = Math.max(text.length, lengths[index] || 0, 3)\n          return text\n        })\n        rows.push(row)\n      })\n    }\n  })\n\n  const table = []\n  rows.forEach(function (cols, index) {\n    const row = cols.map(function (text, col) {\n      return text + \" \".repeat(lengths[col] - text.length)\n    })\n\n    table.push(\"| \" + row.join(\" | \") + \" | \")\n\n    if (index === 0) {\n      const header = cols.map(function (_, col) {\n        if (alignment[col] === \"l\") {\n          return \"-\".repeat(lengths[col])\n        } else if (alignment[col] === \"r\") {\n          return \"-\".repeat(lengths[col] - 1) + \":\"\n        } else if (alignment[col] === \"c\") {\n          return \":\" + \"-\".repeat(lengths[col] - 2) + \":\"\n        }\n      })\n      table.push(\"| \" + header.join(\" | \") + \" | \")\n    }\n  })\n\n  state.text += table.join(\"\\n\")\n  state.pos += 1\n\n  return true\n}\n\nfunction getTableCellText(selection, node) {\n  return escapeTableCell(selection.renderNodes(node.children).trim())\n}\n\nfunction list(selection, state) {\n  const { node } = state\n\n  if (node.type !== \"list\") {\n    return false\n  }\n\n  if (state.text) {\n    state.text += \"\\n\\n\"\n  }\n\n  const items = node.children.map((item, index) => {\n    const prefix = node.ordered ? index + 1 + \". \" : \"* \"\n    const text = selection.renderNodes(item.children).trim()\n    const lines = text.split(/\\r?\\n|\\r|\\n/g).map((line, lineIndex) => {\n      if (lineIndex === 0) {\n        return prefix + line.trim()\n      } else {\n        return \" \".repeat(prefix.length) + line.trim()\n      }\n    })\n    return lines.join(\"\\n\")\n  })\n\n  state.text += items.join(\"\\n\")\n  state.pos += 1\n\n  return true\n}\n\nfunction hr(selection, state) {\n  const { node } = state\n\n  if (node.type !== \"hr\") {\n    return false\n  }\n\n  if (state.text) {\n    state.text += \"\\n\\n\"\n  }\n\n  state.text += \"- - -\"\n  state.pos += 1\n\n  return true\n}\n\nfunction image(selection, state) {\n  const { node } = state\n\n  if (node.type !== \"image\") {\n    return false\n  }\n\n  const { url, alt, title } = node\n\n  if (alt || title) {\n    state.text += \"!\"\n    if (alt) {\n      state.text += \"[\" + escapeMarkdownLinkText(alt) + \"]\"\n    }\n    state.text += \"(\" + escapeMarkdownLink(url)\n    if (title) {\n      state.text += ' \"' + escapeMarkdownLinkTitle(title) + '\"'\n    }\n    state.text += \")\"\n  } else {\n    state.text += \"[img]\" + escapeBBCodeContents(url) + \"[/img]\"\n  }\n\n  state.pos += 1\n\n  return true\n}\n\nfunction link(selection, state) {\n  const { node } = state\n\n  if (node.type !== \"link\") {\n    return false\n  }\n\n  const { auto, children, href } = node\n  const text = selection.renderNodes(children)\n\n  if (auto) {\n    state.text += \"<\" + escapeAutolink(href) + \">\"\n  } else {\n    state.text += \"[url=\" + escapeBBCodeArg(href) + \"]\" + text + \"[/url]\"\n  }\n\n  state.pos += 1\n\n  return true\n}\n\nfunction strong_text(selection, state) {\n  const { node } = state\n\n  if (node.type !== \"strong\") {\n    return false\n  }\n\n  const text = selection.renderNodes(node.children)\n  if (!text) {\n    return false\n  }\n\n  const delimiter = text.indexOf(\"_\") === -1 ? \"__\" : \"**\"\n  state.text += delimiter + text + delimiter\n  state.pos += 1\n\n  return true\n}\n\nfunction emphasis_text(selection, state) {\n  const { node } = state\n\n  if (node.type !== \"emphasis\") {\n    return false\n  }\n\n  const text = selection.renderNodes(node.children)\n  if (!text) {\n    return false\n  }\n\n  const delimiter = text.indexOf(\"_\") === -1 ? \"_\" : \"**\"\n  state.text += delimiter + text + delimiter\n  state.pos += 1\n\n  return true\n}\n\nfunction bold_text(selection, state) {\n  const { node } = state\n\n  if (node.type !== \"bold\") {\n    return false\n  }\n\n  const text = selection.renderNodes(node.children)\n  if (!text) {\n    return false\n  }\n\n  state.text += \"[b]\" + text + \"[/b]\"\n  state.pos += 1\n\n  return true\n}\n\nfunction italic_text(selection, state) {\n  const { node } = state\n\n  if (node.type !== \"italic\") {\n    return false\n  }\n\n  const text = selection.renderNodes(node.children)\n  if (!text) {\n    return false\n  }\n\n  state.text += \"[i]\" + text + \"[/i]\"\n  state.pos += 1\n\n  return true\n}\n\nfunction underline_text(selection, state) {\n  const { node } = state\n\n  if (node.type !== \"underline\") {\n    return false\n  }\n\n  const text = selection.renderNodes(node.children)\n  if (!text) {\n    return false\n  }\n\n  state.text += \"[u]\" + text + \"[/u]\"\n  state.pos += 1\n\n  return true\n}\n\nfunction strikethrough_text(selection, state) {\n  const { node } = state\n\n  if (node.type !== \"strikethrough\") {\n    return false\n  }\n\n  const text = selection.renderNodes(node.children)\n  if (!text) {\n    return false\n  }\n\n  state.text += \"[s]\" + text + \"[/s]\"\n  state.pos += 1\n\n  return true\n}\n\nfunction inline_code(selection, state) {\n  const { node } = state\n\n  if (node.type !== \"inline_code\") {\n    return false\n  }\n\n  const { content } = node\n  if (!content) {\n    return false\n  }\n\n  state.text += \"`\" + escapeInlineCode(content) + \"`\"\n  state.pos += 1\n\n  return true\n}\n\nfunction softbreak(selection, state) {\n  const { node } = state\n\n  if (node.type !== \"softbreak\") {\n    return false\n  }\n\n  state.text += \"\\n\"\n\n  state.pos += 1\n  return true\n}\n\nfunction text(selection, state) {\n  const { node } = state\n\n  if (node.type !== \"text\") {\n    return false\n  }\n\n  // We rely on 'softbreak' rule for explicit line breaks\n  state.text += node.content.replaceAll(\"\\n\", \"\")\n  state.pos += 1\n\n  return true\n}\n\nexport default [\n  { name: \"attachment\", func: attachment },\n  { name: \"youtube\", func: youtube },\n  { name: \"header\", func: header },\n  { name: \"quote\", func: quote },\n  { name: \"code\", func: code },\n  { name: \"spoiler\", func: spoiler },\n  { name: \"paragraph\", func: paragraph },\n  { name: \"table\", func: table },\n  { name: \"list\", func: list },\n  { name: \"hr\", func: hr },\n  { name: \"image\", func: image },\n  { name: \"link\", func: link },\n  { name: \"strong_text\", func: strong_text },\n  { name: \"emphasis_text\", func: emphasis_text },\n  { name: \"bold_text\", func: bold_text },\n  { name: \"italic_text\", func: italic_text },\n  { name: \"underline_text\", func: underline_text },\n  { name: \"strikethrough_text\", func: strikethrough_text },\n  { name: \"inline_code\", func: inline_code },\n  { name: \"softbreak\", func: softbreak },\n  { name: \"text\", func: text },\n]\n","function attachment(cursor, node) {\n  if (node.nodeName !== \"DIV\" && node.nodeName !== \"SPAN\") {\n    return null\n  }\n\n  if (!node.hasAttribute(\"misago-rich-text-attachment\")) {\n    return null\n  }\n\n  return node\n}\n\nfunction youtube(cursor, node) {\n  if (node.nodeName !== \"DIV\") {\n    return null\n  }\n\n  if (!node.hasAttribute(\"misago-rich-text-youtube\")) {\n    return null\n  }\n\n  return node\n}\n\nconst HEADER_NODES = {\n  H1: true,\n  H2: true,\n  H3: true,\n  H4: true,\n  H5: true,\n  H6: true,\n}\n\nfunction header(cursor, node) {\n  if (!HEADER_NODES[node.nodeName]) {\n    return null\n  }\n\n  return cursor.findTether(node.childNodes)\n}\n\nfunction quote(cursor, node) {\n  if (node.nodeName !== \"ASIDE\") {\n    return null\n  }\n\n  const blockquote = node.querySelector(\"blockquote[misago-rich-text-quote]\")\n  if (!blockquote) {\n    return null\n  }\n\n  return cursor.findTether(blockquote.childNodes)\n}\n\nfunction spoiler(cursor, node) {\n  if (node.nodeName !== \"DETAILS\") {\n    return null\n  }\n\n  const body = node.querySelector(\"div[misago-rich-text-spoiler]\")\n  if (!body) {\n    return null\n  }\n\n  return cursor.findTether(body.childNodes)\n}\n\nfunction code(cursor, node) {\n  if (!(node.nodeName === \"DIV\" || node.nodeName === \"PRE\")) {\n    return null\n  }\n\n  const code = node.querySelector(\"code[misago-rich-text-code]\")\n  if (!code) {\n    return null\n  }\n\n  const result = code.childNodes[code.childNodes.length - 1]\n  if (result.nodeName === \"SPAN\") {\n    return cursor.findTether(result.childNodes)\n  }\n\n  return cursor.findTether(code.childNodes)\n}\n\nfunction paragraph(cursor, node) {\n  if (node.nodeName !== \"P\") {\n    return null\n  }\n\n  return cursor.findTether(node.childNodes)\n}\n\nconst TABLE_NODES = {\n  TABLE: true,\n  THEAD: true,\n  TBODY: true,\n  TR: true,\n  TH: true,\n  TD: true,\n}\n\nfunction table(cursor, node) {\n  if (\n    node.nodeName === \"DIV\" &&\n    node.getAttribute(\"misago-rich-text\") === \"table-container\"\n  ) {\n    return cursor.findTether(node.childNodes)\n  }\n\n  if (!node.nodeName || !TABLE_NODES[node.nodeName]) {\n    return null\n  }\n\n  return cursor.findTether(node.childNodes)\n}\n\nconst LIST_NODES = {\n  OL: true,\n  UL: true,\n  LI: true,\n}\n\nfunction list(cursor, node) {\n  if (!node.nodeName || !LIST_NODES[node.nodeName]) {\n    return null\n  }\n\n  return cursor.findTether(node.childNodes)\n}\n\nfunction hr(cursor, node) {\n  if (node.nodeName !== \"HR\") {\n    return null\n  }\n\n  return node\n}\n\nfunction image(cursor, node) {\n  if (node.nodeName !== \"IMG\") {\n    return null\n  }\n\n  return node\n}\n\nfunction link(cursor, node) {\n  if (node.nodeName !== \"A\") {\n    return null\n  }\n\n  return cursor.findTether(node.childNodes)\n}\n\nfunction strong_text(cursor, node) {\n  if (node.nodeName !== \"STRONG\") {\n    return null\n  }\n\n  return cursor.findTether(node.childNodes)\n}\n\nfunction emphasis_text(cursor, node) {\n  if (node.nodeName !== \"EM\") {\n    return null\n  }\n\n  return cursor.findTether(node.childNodes)\n}\n\nfunction bold_text(cursor, node) {\n  if (node.nodeName !== \"B\") {\n    return null\n  }\n\n  return cursor.findTether(node.childNodes)\n}\n\nfunction italic_text(cursor, node) {\n  if (node.nodeName !== \"I\") {\n    return null\n  }\n\n  return cursor.findTether(node.childNodes)\n}\n\nfunction underline_text(cursor, node) {\n  if (node.nodeName !== \"U\") {\n    return null\n  }\n\n  return cursor.findTether(node.childNodes)\n}\n\nfunction strikethrough_text(cursor, node) {\n  if (node.nodeName !== \"DEL\") {\n    return null\n  }\n\n  return cursor.findTether(node.childNodes)\n}\n\nfunction inline_code(cursor, node) {\n  if (node.nodeName !== \"CODE\") {\n    return null\n  }\n\n  return cursor.findTether(node.childNodes)\n}\n\nfunction text(cursor, node) {\n  if (node.nodeType !== Node.TEXT_NODE) {\n    return null\n  }\n\n  const text = node.textContent.trimEnd()\n  if (!text) {\n    return null\n  }\n\n  const range = document.createRange()\n  range.selectNode(node)\n  range.setStart(node, text.length)\n  range.setEnd(node, text.length)\n\n  return range\n}\n\nexport default [\n  { name: \"attachment\", func: attachment },\n  { name: \"youtube\", func: youtube },\n  { name: \"header\", func: header },\n  { name: \"quote\", func: quote },\n  { name: \"spoiler\", func: spoiler },\n  { name: \"code\", func: code },\n  { name: \"paragraph\", func: paragraph },\n  { name: \"table\", func: table },\n  { name: \"list\", func: list },\n  { name: \"hr\", func: hr },\n  { name: \"image\", func: image },\n  { name: \"link\", func: link },\n  { name: \"strong_text\", func: strong_text },\n  { name: \"emphasis_text\", func: emphasis_text },\n  { name: \"bold_text\", func: bold_text },\n  { name: \"italic_text\", func: italic_text },\n  { name: \"underline_text\", func: underline_text },\n  { name: \"strikethrough_text\", func: strikethrough_text },\n  { name: \"inline_code\", func: inline_code },\n  { name: \"text\", func: text },\n]\n","import quote from \"./Quote\"\nimport QuoteSelection from \"./QuoteSelection\"\nimport Ruleset from \"./Ruleset\"\n\nexport default quote\n\nexport { QuoteSelection, Ruleset }\n","import { computePosition, flip, offset, shift } from \"@floating-ui/dom\"\nimport * as snackbar from \"../snackbars\"\nimport QuoteCursorPosition from \"./QuoteCursorPosition\"\nimport QuoteSelection from \"./QuoteSelection\"\nimport Ruleset from \"./Ruleset\"\nimport extractorRules from \"./extractor\"\nimport postprocessRules from \"./postprocess\"\nimport rendererRules from \"./renderer\"\nimport tetherRules from \"./tether\"\n\nclass Quote {\n  constructor() {\n    this.extractor = new Ruleset(extractorRules)\n    this.postprocess = new Ruleset(postprocessRules)\n    this.renderer = new Ruleset(rendererRules)\n    this.tether = new Ruleset(tetherRules)\n\n    this.selecting = false\n    this.debounce = null\n\n    this.options = null\n    this.toolbar = null\n    this.cursor = null\n\n    this.range = null\n    this.root = null\n    this.quote = null\n  }\n\n  activate = (options) => {\n    if (\n      (options.reply || options.quote) &&\n      typeof window.getSelection !== \"undefined\"\n    ) {\n      document.addEventListener(\"mousedown\", this.onSelectStart)\n      document.addEventListener(\"mouseup\", this.onSelectEnd)\n      document.addEventListener(\"selectionchange\", this.onSelectChange)\n\n      this.options = options\n      this.toolbar = this.createToolbar()\n      this.cursor = new QuoteCursorPosition(this.tether)\n    }\n  }\n\n  onSelectStart = () => {\n    this.selecting = true\n  }\n\n  onSelectEnd = () => {\n    this.selecting = false\n    this.updateSelection()\n  }\n\n  onSelectChange = () => {\n    if (this.selecting) {\n      return\n    }\n\n    if (this.debounce) {\n      window.clearTimeout(this.debounce)\n    }\n\n    this.debounce = window.setTimeout(this.updateSelection, 300)\n  }\n\n  updateSelection = () => {\n    if (this.selecting) {\n      return\n    }\n\n    if (this.updateState()) {\n      this.showToolbar()\n    } else {\n      this.hideToolbar()\n    }\n  }\n\n  updateState() {\n    this.range = null\n    this.root = null\n\n    const selection = window.getSelection()\n    if (\n      !selection ||\n      selection.isCollapsed ||\n      selection.type !== \"Range\" ||\n      selection.rangeCount === 0\n    ) {\n      return false\n    }\n\n    const range = this.getRange(selection)\n    const root = this.getRangeRoot(range)\n\n    if (!root) {\n      return false\n    }\n\n    this.range = range\n    this.root = root\n    this.quote = this.getSelectionQuote(root)\n\n    return this.range && this.root && this.quote\n  }\n\n  clearState() {\n    this.selecting = true\n\n    this.range = null\n    this.root = null\n    this.quote = null\n\n    this.hideToolbar()\n\n    window.setTimeout(() => {\n      this.selecting = false\n    }, 300)\n  }\n\n  getRange(selection) {\n    if (selection.rangeCount === 1) {\n      return selection.getRangeAt(0)\n    }\n\n    // Separate logic for FireFox\n    // https://bugzilla.mozilla.org/show_bug.cgi?id=753718\n    const start = selection.getRangeAt(0)\n    const end = selection.getRangeAt(selection.rangeCount - 1)\n\n    const range = new Range()\n    range.setStart(start.startContainer, start.startOffset)\n    range.setEnd(end.endContainer, end.endOffset)\n\n    return range\n  }\n\n  getRangeRoot(range) {\n    const ancestor = this.getCommonAncestor(range)\n    if (!ancestor) {\n      return null\n    }\n\n    const root = ancestor.closest(\"[misago-quote-root]\")\n    if (root) {\n      return {\n        element: root,\n        info: root.getAttribute(\"misago-quote-root\"),\n        ancestor,\n        childNodes: range.cloneContents().childNodes,\n      }\n    }\n    return null\n  }\n\n  getCommonAncestor(range) {\n    const ancestor = range.commonAncestorContainer\n    if (!ancestor) {\n      return null\n    } else if (ancestor.nodeType === Node.TEXT_NODE) {\n      return ancestor.parentNode\n    }\n    return ancestor\n  }\n\n  getSelectionQuote(root) {\n    const selection = new QuoteSelection(\n      this.extractor,\n      this.renderer,\n      this.postprocess\n    )\n    const quote = selection.getQuote(root)\n\n    if (quote) {\n      return \"\\n\\n\" + selection.getQuote(root) + \"\\n\\n\"\n    }\n\n    return \"\"\n  }\n\n  createToolbar() {\n    const toolbar = document.createElement(\"div\")\n    toolbar.className = \"quote-toolbar\"\n\n    if (this.options.reply) {\n      const reply = this.createToolbarButton(\n        pgettext(\"quote toolbar\", \"Reply\"),\n        \"reply\",\n        this.reply\n      )\n      toolbar.appendChild(reply)\n    }\n\n    if (this.options.quote) {\n      const quote = this.createToolbarButton(\n        pgettext(\"quote toolbar\", \"Copy quote\"),\n        \"content_copy\",\n        this.copyQuote\n      )\n      toolbar.appendChild(quote)\n    }\n\n    document.body.appendChild(toolbar)\n\n    return toolbar\n  }\n\n  createToolbarButton(text, icon, callback) {\n    const btn = document.createElement(\"button\")\n    btn.className = \"quote-toolbar-btn\"\n\n    const btnIcon = document.createElement(\"span\")\n    btnIcon.className = \"material-icon\"\n    btnIcon.innerText = icon\n    btn.appendChild(btnIcon)\n\n    const btnText = document.createElement(\"span\")\n    btnText.className = \"quote-toolbar-btn-text\"\n    btnText.innerText = text\n    btn.appendChild(btnText)\n\n    btn.addEventListener(\"click\", callback)\n    return btn\n  }\n\n  showToolbar() {\n    const position = this.cursor.getPosition(this.root, this.range)\n    if (!position) {\n      return\n    }\n\n    this.toolbar.classList.add(\"show\")\n\n    computePosition(position, this.toolbar, {\n      placement: \"bottom\",\n      middleware: [offset(4), flip(), shift({ padding: 8 })],\n    }).then(({ x, y }) => {\n      Object.assign(this.toolbar.style, {\n        left: `${x}px`,\n        top: `${y}px`,\n      })\n    })\n  }\n\n  hideToolbar() {\n    this.toolbar.classList.remove(\"show\")\n  }\n\n  reply = () => {\n    const form = document.getElementById(\"misago-htmx-quick-reply\")\n\n    if (form && this.quote) {\n      const textarea = form.querySelector(\".markup-editor-textarea\")\n      if (textarea) {\n        if (textarea.value.trim()) {\n          textarea.value += this.quote\n        } else {\n          textarea.value = this.quote.trimStart()\n        }\n        snackbar.info(pgettext(\"quote toolbar\", \"Quote added to reply\"))\n      }\n    }\n\n    this.clearState()\n  }\n\n  copyQuote = async () => {\n    if (this.quote) {\n      try {\n        await navigator.clipboard.writeText(this.quote)\n        snackbar.info(pgettext(\"quote toolbar\", \"Quote copied to clipboard\"))\n      } catch (error) {\n        console.error(error.message)\n      }\n    }\n\n    this.clearState()\n  }\n}\n\nconst quote = new Quote()\n\nexport default quote\n","import htmx from \"htmx.org\"\nimport * as snackbars from \"./snackbars\"\n\nexport function activateRichText() {\n  document\n    .querySelectorAll(\"[misago-rich-text-code] button\")\n    .forEach((element) => {\n      element.addEventListener(\"click\", copyCode)\n    })\n}\n\nasync function copyCode(event) {\n  const element = event.target.closest(\"[misago-rich-text-code]\")\n  if (!!element) {\n    event.preventDefault()\n    const code = element.querySelector(\"code\").textContent\n    if (code.trim()) {\n      await navigator.clipboard.writeText(code)\n      snackbars.info(pgettext(\"code copied\", \"Code copied\"))\n    }\n  }\n}\n\nhtmx.onLoad(activateRichText)\n","import htmx from \"htmx.org\"\n\nfunction updateTabGroups(hash) {\n  if (!hash) {\n    return\n  }\n\n  document.querySelectorAll(\".tab-group\").forEach(function (element) {\n    updateTabGroup(hash, element)\n  })\n}\n\nfunction updateTabGroup(hash, element) {\n  let oldNav = null\n  let newNav = null\n\n  element.querySelectorAll(\".tab-group-nav a\").forEach(function (nav) {\n    if (nav.getAttribute(\"href\") === hash) {\n      newNav = nav\n    }\n    if (nav.classList.contains(\"active\")) {\n      oldNav = nav\n    }\n  })\n\n  const oldTab = element.querySelector(\".tab-group-tab.visible\")\n  const newTab = findTab(hash.substring(1), element)\n\n  if (newNav && newTab && newNav != oldNav && newTab !== oldTab) {\n    newNav.classList.add(\"active\")\n    newTab.classList.add(\"visible\")\n\n    if (oldNav) {\n      oldNav.classList.remove(\"active\")\n    }\n\n    if (oldTab) {\n      oldTab.classList.remove(\"visible\")\n    }\n\n    const event = new CustomEvent(\"misago:updated-tab\", {\n      bubbles: true,\n      target: element,\n      oldTab,\n      newTab,\n    })\n    element.dispatchEvent(event)\n  }\n}\n\nfunction findTab(hash, element) {\n  const tabs = element.querySelectorAll(\"[misago-tab-group-tab]\")\n  for (let i = 0; i < tabs.length; i++) {\n    const tab = tabs[i]\n    if (tab.getAttribute(\"misago-tab-group-tab\") === hash) {\n      return tab\n    }\n  }\n  return null\n}\n\nwindow.addEventListener(\"hashchange\", function () {\n  updateTabGroups(window.location.hash)\n})\n\nhtmx.onLoad(function () {\n  updateTabGroups(window.location.hash)\n})\n\nexport { updateTabGroups }\n","import htmx from \"htmx.org\"\nimport { Autocomplete, AnchorInput, SelectUser, sources } from \"./Autocomplete\"\n\nconst DATA_ATTRIBUTE_ELEMENT = \"m-user-multiple-choice\"\nconst DATA_ATTRIBUTE_INPUT = \"m-user-multiple-choice-input\"\n\nconst SELECTOR_ELEMENT = `[${DATA_ATTRIBUTE_ELEMENT}]`\nconst SELECTOR_INPUT = `[${DATA_ATTRIBUTE_INPUT}]`\n\nconst TEMPLATE_ID = \"m-user-multiple-choice-template\"\n\nconst CLASS_NAME_FOCUS = \"focused\"\n\nconst EVENT_FOCUS = [\"focusin\", \"click\"]\n\nconst KEY_OVERRIDE = {\n  Delete: false,\n  Space: false,\n  ArrowLeft: false,\n  ArrowRight: false,\n}\n\nclass UserMultipleChoice {\n  constructor() {\n    this.autocomplete = null\n    this.element = null\n    this.input = null\n    this.template = null\n  }\n\n  activate = (element) => {\n    if (element.getAttribute(DATA_ATTRIBUTE_ELEMENT) === \"true\") {\n      return\n    }\n\n    element.setAttribute(DATA_ATTRIBUTE_ELEMENT, \"true\")\n\n    this.element = element\n    this.maxChoices = Number(element.getAttribute(\"maxchoices\") || 1)\n    this.input = document.querySelector(SELECTOR_INPUT)\n    this.template = document.getElementById(TEMPLATE_ID)\n\n    this.updateInputDisabled()\n\n    function getQuery(control) {\n      const value = control.value.trim().replace(/\\s+/, \"\")\n      if (value.length) {\n        const exclude = []\n        element.querySelectorAll(\"[m-user-id]\").forEach(function (item) {\n          exclude.push(item.getAttribute(\"m-user-id\"))\n        })\n        return { exclude, value }\n      }\n      return null\n    }\n\n    const onSelect = (choice) => {\n      const item = this.template.content.cloneNode(true)\n\n      item.querySelector(\"li\").setAttribute(\"m-user-id\", choice.id)\n      item.querySelector(\"input\").value = choice.slug\n      item.querySelector('slot[name=\"username\"]').replaceWith(choice.username)\n\n      const avatars = choice.avatar\n        .filter(function ({ size }) {\n          return size >= 32\n        })\n        .reverse()\n\n      const img = item.querySelector(\"img\")\n      if (avatars.length) {\n        img.setAttribute(\"src\", avatars[0].url)\n      } else {\n        img.remove()\n      }\n\n      this.input.value = \"\"\n      this.input.parentElement.before(item)\n      this.updateInputDisabled()\n\n      if (!this.input.disabled) {\n        this.input.focus()\n      }\n\n      this.focus()\n    }\n\n    this.autocomplete = new Autocomplete({\n      control: this.input,\n      keyOverride: KEY_OVERRIDE,\n      source: sources.users,\n      select: new SelectUser({\n        anchor: new AnchorInput(this.input),\n        placement: \"bottom-start\",\n      }),\n      getQuery,\n      onSelect,\n    })\n\n    EVENT_FOCUS.forEach((eventName) => {\n      element.addEventListener(eventName, this.focus)\n    })\n\n    EVENT_FOCUS.forEach((eventName) => {\n      document.addEventListener(eventName, (event) => {\n        if (\n          !element.contains(event.target) &&\n          !this.autocomplete.isEventTarget(event)\n        ) {\n          this.blur()\n        }\n      })\n    })\n\n    this.element.addEventListener(\"click\", (event) => {\n      const button = event.target.closest(\"button\")\n      if (button) {\n        this.deleteItem(button.closest(\"li\"))\n      }\n      this.focus()\n    })\n\n    let backspacePressed = false\n\n    this.input.addEventListener(\"keydown\", (event) => {\n      if (event.key === \"Backspace\") {\n        if (!backspacePressed) {\n          backspacePressed = true\n          if (event.target.value.trim() === \"\") {\n            const lastItem = event.target.closest(\"li\").previousElementSibling\n            if (lastItem) {\n              this.deleteItem(lastItem)\n            }\n          }\n        }\n      }\n    })\n\n    this.input.addEventListener(\"keyup\", function (event) {\n      if (event.key === \"Backspace\") {\n        backspacePressed = false\n      }\n    })\n  }\n\n  focus = () => {\n    this.element.classList.add(CLASS_NAME_FOCUS)\n  }\n\n  blur = () => {\n    this.element.classList.remove(CLASS_NAME_FOCUS)\n  }\n\n  deleteItem = (element) => {\n    element.remove()\n    this.updateInputDisabled()\n  }\n\n  updateInputDisabled = () => {\n    this.input.disabled =\n      this.element.querySelectorAll(\"li\").length - 1 >= this.maxChoices\n  }\n}\n\nconst singleton = new UserMultipleChoice()\n\nhtmx.onLoad(function () {\n  const element = document.querySelector(SELECTOR_ELEMENT)\n  if (element) {\n    singleton.activate(element)\n  }\n})\n\nexport default singleton\n\nexport { UserMultipleChoice }\n","import \"bootstrap/js/transition\"\nimport \"bootstrap/js/affix\"\nimport \"bootstrap/js/modal\"\nimport \"bootstrap/js/dropdown\"\nimport \"at-js\"\nimport \"cropit\"\nimport \"jquery-caret\"\nimport htmx from \"htmx.org\"\nimport OrderedList from \"misago/utils/ordered-list\"\nimport \"misago/style/index.less\"\nimport AjaxLoader, { useLoader } from \"./AjaxLoader\"\nimport BulkModeration from \"./BulkModeration\"\nimport { Mention } from \"./Autocomplete\"\nimport { deleteElement, slideUpElement } from \"./animations\"\nimport \"./focusOn\"\nimport \"./formValidators\"\nimport \"./htmxErrors\"\nimport \"./htmxExtensionLoaderTpl\"\nimport Lightbox from \"./lightbox\"\nimport editor, { activateEditors } from \"./editor\"\nimport \"./pagination\"\nimport activatePollChoicesControl from \"./PollChoicesControl\"\nimport quote from \"./Quote\"\nimport \"./richtext\"\nimport * as snackbars from \"./snackbars\"\nimport { updateTabGroups } from \"./TabGroups\"\nimport userMultipleChoice from \"./UserMultipleChoice\"\nimport \"./scrollTo\"\nimport \"./timestamps\"\n\nconst loader = new AjaxLoader()\nconst lightbox = new Lightbox()\n\nhtmx.config.historyEnabled = false\nhtmx.config.historyCacheSize = 0\n\nexport class Misago {\n  constructor() {\n    this._initializers = []\n    this._context = {}\n\n    this.htmx = htmx\n\n    this.loader = loader\n    this.editor = editor\n    this.lightbox = lightbox\n    this.quote = quote\n\n    this.deleteElement = deleteElement\n    this.slideUpElement = slideUpElement\n\n    this.activatePollChoicesControl = activatePollChoicesControl\n    this.tabGroups = updateTabGroups\n    this.userMultipleChoice = userMultipleChoice\n  }\n\n  addInitializer(initializer) {\n    this._initializers.push({\n      key: initializer.name,\n\n      item: initializer.initializer,\n\n      after: initializer.after,\n      before: initializer.before,\n    })\n  }\n\n  init(context) {\n    this._context = context\n\n    var initOrder = new OrderedList(this._initializers).orderedValues()\n    initOrder.forEach((initializer) => {\n      initializer(this)\n    })\n  }\n\n  // context accessors\n  has(key) {\n    return !!this._context[key]\n  }\n\n  get(key, fallback) {\n    if (this.has(key)) {\n      return this._context[key]\n    } else {\n      return fallback || undefined\n    }\n  }\n\n  pop(key) {\n    if (this.has(key)) {\n      let value = this._context[key]\n      this._context[key] = null\n      return value\n    } else {\n      return undefined\n    }\n  }\n\n  snackbar(type, message) {\n    snackbars.snackbar(type, message)\n  }\n\n  snackbarInfo(message) {\n    snackbars.info(message)\n  }\n\n  snackbarSuccess(message) {\n    snackbars.success(message)\n  }\n\n  snackbarWarning(message) {\n    snackbars.warning(message)\n  }\n\n  snackbarError(message) {\n    snackbars.error(message)\n  }\n\n  snackbarHttpResponseError(response) {\n    snackbars.httpResponseError(response)\n  }\n\n  bulkModeration(options) {\n    return new BulkModeration(options)\n  }\n\n  hideMarkAsReadModal = () => {\n    $(\"#mark-as-read\").modal(\"hide\")\n  }\n\n  mention = (control) => {\n    return new Mention(control)\n  }\n}\n\n// create the singleton\nconst misago = new Misago()\n\n// expose it globally\nwindow.misago = misago\n\n// and export it for tests and stuff\nexport default misago\n\n// Register ajax loader events\ndocument.addEventListener(\"htmx:beforeRequest\", ({ target }) => {\n  if (useLoader(target)) {\n    loader.show()\n  }\n})\n\ndocument.addEventListener(\"htmx:afterRequest\", ({ target }) => {\n  if (useLoader(target)) {\n    loader.hide()\n  }\n})\n\n// Register editor events\ndocument.addEventListener(\"htmx:load\", activateEditors)\n\n// Hide moderation modal\ndocument.addEventListener(\"misago:afterModeration\", () => {\n  $(\"#threads-moderation-modal\").modal(\"hide\")\n})\n\ndocument.addEventListener(\"misago:afterUpdateMembers\", () => {\n  $(\"#add-members-modal\").modal(\"hide\")\n})\n\n// Custom misago-confirm attribute\ndocument.addEventListener(\"submit\", function (event) {\n  const element = event.target.closest(\"form[misago-confirm]\")\n  if (!!element && !window.confirm(element.getAttribute(\"misago-confirm\"))) {\n    event.preventDefault()\n  }\n})\n","import moment from \"moment\"\nimport React from \"react\"\n\nexport default class extends React.Component {\n  getReasonMessage() {\n    if (this.props.message.html) {\n      return (\n        <div\n          className=\"lead\"\n          dangerouslySetInnerHTML={{\n            __html: this.props.message.html,\n          }}\n        />\n      )\n    } else {\n      return <p className=\"lead\">{this.props.message.plain}</p>\n    }\n  }\n\n  getExpirationMessage() {\n    if (this.props.expires) {\n      if (this.props.expires.isAfter(moment())) {\n        let title = interpolate(\n          pgettext(\"banned page\", \"This ban expires on %(expires_on)s.\"),\n          {\n            expires_on: this.props.expires.format(\"LL, LT\"),\n          },\n          true\n        )\n\n        let message = interpolate(\n          pgettext(\"banned page\", \"This ban expires %(expires_on)s.\"),\n          {\n            expires_on: this.props.expires.fromNow(),\n          },\n          true\n        )\n\n        return <abbr title={title}>{message}</abbr>\n      } else {\n        return pgettext(\"banned page\", \"This ban has expired.\")\n      }\n    } else {\n      return pgettext(\"banned page\", \"This ban is permanent.\")\n    }\n  }\n\n  render() {\n    return (\n      <div className=\"page page-error page-error-banned\">\n        <div className=\"container\">\n          <div className=\"message-panel\">\n            <div className=\"message-icon\">\n              <span className=\"material-icon\">highlight_off</span>\n            </div>\n            <div className=\"message-body\">\n              {this.getReasonMessage()}\n              <p className=\"message-footnote\">{this.getExpirationMessage()}</p>\n            </div>\n          </div>\n        </div>\n      </div>\n    )\n  }\n}\n","import moment from \"moment\"\nimport React from \"react\"\nimport ReactDOM from \"react-dom\"\nimport { Provider, connect } from \"react-redux\"\nimport BannedPage from \"misago/components/banned-page\"\nimport misago from \"misago/index\"\nimport store from \"misago/services/store\"\n\nlet select = function (state) {\n  return state.tick\n}\n\nlet RedrawedBannedPage = connect(select)(BannedPage)\n\nexport default function (ban, changeState) {\n  ReactDOM.render(\n    <Provider store={store.getStore()}>\n      <RedrawedBannedPage\n        message={ban.message}\n        expires={ban.expires_on ? moment(ban.expires_on) : null}\n      />\n    </Provider>,\n\n    document.getElementById(\"page-mount\")\n  )\n\n  if (typeof changeState === \"undefined\" || changeState) {\n    let forumName = misago.get(\"SETTINGS\").forum_name\n    document.title =\n      pgettext(\"banned error title\", \"You are banned\") + \" | \" + forumName\n    window.history.pushState({}, \"\", misago.get(\"BANNED_URL\"))\n  }\n}\n","import misago from \"misago/index\"\nimport reducer from \"misago/reducers/profile-details\"\nimport store from \"misago/services/store\"\n\nexport default function initializer() {\n  let initialState = null\n  if (misago.has(\"PROFILE_DETAILS\")) {\n    initialState = misago.get(\"PROFILE_DETAILS\")\n  }\n\n  store.addReducer(\"profile-details\", reducer, initialState || {})\n}\n\nmisago.addInitializer({\n  name: \"reducer:profile-details\",\n  initializer: initializer,\n  before: \"store\",\n})\n","import misago from \"misago/index\"\nimport reducer, { hydrate } from \"misago/reducers/poll\"\nimport store from \"misago/services/store\"\n\nexport default function initializer() {\n  let initialState = null\n  if (misago.has(\"THREAD\") && misago.get(\"THREAD\").poll) {\n    initialState = hydrate(misago.get(\"THREAD\").poll)\n  } else {\n    initialState = {}\n  }\n\n  store.addReducer(\"poll\", reducer, initialState)\n}\n\nmisago.addInitializer({\n  name: \"reducer:poll\",\n  initializer: initializer,\n  before: \"store\",\n})\n","import React from \"react\"\n\nexport default class extends React.Component {\n  getHelpText() {\n    if (this.props.helpText) {\n      return <p className=\"help-block\">{this.props.helpText}</p>\n    } else {\n      return null\n    }\n  }\n\n  render() {\n    return (\n      <div className=\"panel-body panel-message-body\">\n        <div className=\"message-icon\">\n          <span className=\"material-icon\">\n            {this.props.icon || \"info_outline\"}\n          </span>\n        </div>\n        <div className=\"message-body\">\n          <p className=\"lead\">{this.props.message}</p>\n          {this.getHelpText()}\n        </div>\n      </div>\n    )\n  }\n}\n","export const locale = window.misago_locale || \"en-us\"\n\nexport const momentAgo = pgettext(\"time ago\", \"moment ago\")\nexport const momentAgoShort = pgettext(\"time ago\", \"now\")\nexport const dayAt = pgettext(\"day at time\", \"%(day)s at %(time)s\")\nexport const soonAt = pgettext(\"day at time\", \"Today at %(time)s\")\nexport const tomorrowAt = pgettext(\"day at time\", \"Tomorrow at %(time)s\")\nexport const yesterdayAt = pgettext(\"day at time\", \"Yesterday at %(time)s\")\n\nexport const minutesShort = pgettext(\"short minutes\", \"%(time)sm\")\nexport const hoursShort = pgettext(\"short hours\", \"%(time)sh\")\nexport const daysShort = pgettext(\"short days\", \"%(time)sd\")\n\nexport const relativeNumeric = new Intl.RelativeTimeFormat(locale, {\n  numeric: \"always\",\n  style: \"long\",\n})\n\nexport const fullDateTime = new Intl.DateTimeFormat(locale, {\n  dateStyle: \"full\",\n  timeStyle: \"medium\",\n})\n\nexport const thisYearDate = new Intl.DateTimeFormat(locale, {\n  month: \"long\",\n  day: \"numeric\",\n})\n\nexport const otherYearDate = new Intl.DateTimeFormat(locale, {\n  year: \"numeric\",\n  month: \"long\",\n  day: \"numeric\",\n})\n\nexport const short = new Intl.DateTimeFormat(locale, {\n  year: \"2-digit\",\n  month: \"short\",\n  day: \"numeric\",\n})\n\nexport const weekday = new Intl.DateTimeFormat(locale, {\n  weekday: \"long\",\n})\n\nexport const shortTime = new Intl.DateTimeFormat(locale, { timeStyle: \"short\" })\n\nexport const thisYearShort = new Intl.DateTimeFormat(locale, {\n  month: \"short\",\n  day: \"numeric\",\n})\n\nexport const otherYearShort = new Intl.DateTimeFormat(locale, {\n  month: \"short\",\n  year: \"numeric\",\n})\n\nexport function dateRelative(date) {\n  const now = new Date()\n  const diff = Math.round((date - now) / 1000)\n  const absDiff = Math.abs(diff)\n  const sign = diff < 1 ? -1 : 1\n\n  if (absDiff < 90) {\n    return momentAgo\n  }\n\n  if (absDiff < 60 * 47) {\n    const minutes = Math.round(absDiff / 60) * sign\n    return relativeNumeric.format(minutes, \"minute\")\n  }\n\n  if (absDiff < 3600 * 3) {\n    const hours = Math.round(absDiff / 3600) * sign\n    return relativeNumeric.format(hours, \"hour\")\n  }\n\n  if (isSameDay(now, date)) {\n    if (diff > 0) {\n      return soonAt.replace(\"%(time)s\", shortTime.format(date))\n    }\n\n    return shortTime.format(date)\n  }\n\n  if (isYesterday(date)) {\n    return yesterdayAt.replace(\"%(time)s\", shortTime.format(date))\n  }\n\n  if (isTomorrow(date)) {\n    return tomorrowAt.replace(\"%(time)s\", shortTime.format(date))\n  }\n\n  if (diff < 0 && absDiff < 3600 * 24 * 6) {\n    const day = weekday.format(date)\n    return formatDayAtTime(day, date)\n  }\n\n  if (now.getFullYear() == date.getFullYear()) {\n    return thisYearDate.format(date)\n  }\n\n  return otherYearDate.format(date)\n}\n\nexport function isSameDay(now, date) {\n  return (\n    now.getFullYear() == date.getFullYear() &&\n    now.getMonth() == date.getMonth() &&\n    now.getDate() == date.getDate()\n  )\n}\n\nexport function isYesterday(date) {\n  const yesterday = new Date()\n  yesterday.setDate(yesterday.getDate() - 1)\n  return isSameDay(yesterday, date)\n}\n\nexport function isTomorrow(date) {\n  const yesterday = new Date()\n  yesterday.setDate(yesterday.getDate() + 1)\n  return isSameDay(yesterday, date)\n}\n\nexport function formatDayAtTime(day, date) {\n  return dayAt\n    .replace(\"%(day)s\", day)\n    .replace(\"%(time)s\", shortTime.format(date))\n}\n\nexport function dateRelativeShort(date) {\n  const now = new Date()\n  const absDiff = Math.abs(Math.round((date - now) / 1000))\n\n  if (absDiff < 60) {\n    return momentAgoShort\n  }\n\n  if (absDiff < 60 * 55) {\n    const minutes = Math.round(absDiff / 60)\n    return minutesShort.replace(\"%(time)s\", minutes)\n  }\n\n  if (absDiff < 3600 * 24) {\n    const hours = Math.round(absDiff / 3600)\n    return hoursShort.replace(\"%(time)s\", hours)\n  }\n\n  if (absDiff < 86400 * 7) {\n    const days = Math.round(absDiff / 86400)\n    return daysShort.replace(\"%(time)s\", days)\n  }\n\n  if (date.getFullYear() === now.getFullYear()) {\n    return thisYearShort.format(date)\n  }\n\n  return otherYearShort.format(date)\n}\n","import misago from \"misago/index\"\nimport reducer, { hydrate } from \"misago/reducers/thread\"\nimport store from \"misago/services/store\"\n\nexport default function initializer() {\n  let initialState = null\n  if (misago.has(\"THREAD\")) {\n    initialState = hydrate(misago.get(\"THREAD\"))\n  } else {\n    initialState = {\n      isBusy: false,\n    }\n  }\n\n  store.addReducer(\"thread\", reducer, initialState)\n}\n\nmisago.addInitializer({\n  name: \"reducer:thread\",\n  initializer: initializer,\n  before: \"store\",\n})\n","import misago from \"misago/index\"\nimport showBannedPage from \"misago/utils/banned-page\"\n\nexport default function initializer(context) {\n  if (context.has(\"BAN_MESSAGE\")) {\n    showBannedPage(context.get(\"BAN_MESSAGE\"), false)\n  }\n}\n\nmisago.addInitializer({\n  name: \"component:banmed-page\",\n  initializer: initializer,\n  after: \"store\",\n})\n","import React from \"react\"\nimport { connect } from \"react-redux\"\nimport { updateAuthenticatedUser } from \"../../reducers/auth\"\nimport { ApiFetch } from \"../Api\"\n\nfunction NotificationsFetch({\n  children,\n  filter,\n  query,\n  dispatch,\n  unreadNotifications,\n  disabled,\n}) {\n  return (\n    <ApiFetch\n      url={getApiUrl(filter, query)}\n      disabled={disabled}\n      onData={(data) => {\n        if (data.unreadNotifications != unreadNotifications) {\n          dispatch(\n            updateAuthenticatedUser({\n              unreadNotifications: data.unreadNotifications,\n            })\n          )\n        }\n      }}\n    >\n      {({ data, loading, error, refetch }) => {\n        return children({ data, loading, error, refetch })\n      }}\n    </ApiFetch>\n  )\n}\n\nfunction getApiUrl(filter, query) {\n  let api = misago.get(\"NOTIFICATIONS_API\") + \"?limit=30\"\n  api += \"&filter=\" + filter\n\n  if (query) {\n    if (query.after) {\n      api += \"&after=\" + query.after\n    }\n    if (query.before) {\n      api += \"&before=\" + query.before\n    }\n  }\n\n  return api\n}\n\nfunction selectState({ auth }) {\n  if (!auth.user) {\n    return { unreadNotifications: null }\n  }\n\n  return {\n    unreadNotifications: auth.user.unreadNotifications,\n  }\n}\n\nconst NotificationsFetchConnected = connect(selectState)(NotificationsFetch)\n\nexport default NotificationsFetchConnected\n","import React from \"react\"\nimport MisagoMarkup from \"misago/components/misago-markup\"\n\nexport default function (props) {\n  if (props.post.content) {\n    return <Default {...props} />\n  } else {\n    return <Invalid {...props} />\n  }\n}\n\nexport function Default(props) {\n  return (\n    <div className=\"post-body\">\n      <MisagoMarkup markup={props.post.headline || props.post.content} />\n    </div>\n  )\n}\n\nexport function Invalid(props) {\n  return (\n    <div className=\"post-body post-body-invalid\">\n      <p className=\"lead\">\n        {pgettext(\n          \"post body invalid\",\n          \"This post's contents cannot be displayed.\"\n        )}\n      </p>\n      <p className=\"text-muted\">\n        {pgettext(\n          \"post body invalid\",\n          \"This error is caused by invalid post content manipulation.\"\n        )}\n      </p>\n    </div>\n  )\n}\n","import React from \"react\"\n\nexport default function ({ post }) {\n  const { category, thread } = post\n\n  const tooltip = interpolate(\n    pgettext(\"posts feed item header\", \"posted %(posted_on)s\"),\n    {\n      posted_on: post.posted_on.format(\"LL, LT\"),\n    },\n    true\n  )\n\n  return (\n    <div className=\"post-heading\">\n      <a className=\"btn btn-link item-title\" href={thread.url}>\n        {thread.title}\n      </a>\n      <a className=\"btn btn-link post-category\" href={category.url.index}>\n        {category.name}\n      </a>\n      <a\n        href={post.url.index}\n        className=\"btn btn-link posted-on\"\n        title={tooltip}\n      >\n        {post.posted_on.fromNow()}\n      </a>\n    </div>\n  )\n}\n","import React from \"react\"\n\nexport default function ({ post }) {\n  return (\n    <a className=\"btn btn-default btn-icon pull-right\" href={post.url.index}>\n      <span className=\"btn-text-left hidden-xs\">\n        {pgettext(\"go to post link\", \"See post\")}\n      </span>\n      <span className=\"material-icon\">chevron_right</span>\n    </a>\n  )\n}\n","import React from \"react\"\nimport Avatar from \"misago/components/avatar\"\nimport GoToButton from \"./button\"\n\nexport default function ({ post }) {\n  return (\n    <div className=\"post-side post-side-anonymous\">\n      <GoToButton post={post} />\n      <div className=\"media\">\n        <div className=\"media-left\">\n          <span>\n            <Avatar className=\"poster-avatar\" size={50} />\n          </span>\n        </div>\n        <div className=\"media-body\">\n          <div className=\"media-heading\">\n            <span className=\"item-title\">{post.poster_name}</span>\n          </div>\n          <span className=\"user-title user-title-anonymous\">\n            {pgettext(\"post removed poster username\", \"Removed user\")}\n          </span>\n        </div>\n      </div>\n    </div>\n  )\n}\n","import React from \"react\"\n\nexport default function ({ rank, title }) {\n  let userTitle = title || rank.title || rank.name\n\n  let className = \"user-title\"\n  if (rank.css_class) {\n    className += \" user-title-\" + rank.css_class\n  }\n\n  if (rank.is_tab) {\n    return (\n      <a className={className} href={rank.url}>\n        {userTitle}\n      </a>\n    )\n  }\n\n  return <span className={className}>{userTitle}</span>\n}\n","import React from \"react\"\nimport Avatar from \"misago/components/avatar\"\nimport GoToButton from \"./button\"\nimport UserTitle from \"./user-title\"\n\nexport default function ({ post, poster }) {\n  return (\n    <div className=\"post-side post-side-registered\">\n      <GoToButton post={post} />\n      <div className=\"media\">\n        <div className=\"media-left\">\n          <a href={poster.url}>\n            <Avatar className=\"poster-avatar\" size={50} user={poster} />\n          </a>\n        </div>\n        <div className=\"media-body\">\n          <div className=\"media-heading\">\n            <a className=\"item-title\" href={poster.url}>\n              {poster.username}\n            </a>\n          </div>\n          <UserTitle title={poster.title} rank={poster.rank} />\n        </div>\n      </div>\n    </div>\n  )\n}\n","import React from \"react\"\nimport Anonymous from \"./anonymous\"\nimport Registered from \"./registered\"\n\nexport default function ({ post, poster }) {\n  if (poster && poster.id) {\n    return <Registered post={post} poster={poster} />\n  }\n\n  return <Anonymous post={post} />\n}\n","import React from \"react\"\nimport Body from \"./body\"\nimport Header from \"./header\"\nimport PostSide from \"./post-side\"\n\nexport default function ({ post, poster }) {\n  const user = poster || post.poster\n\n  let className = \"post\"\n  if (user && user.rank.css_class) {\n    className += \" post-\" + user.rank.css_class\n  }\n\n  return (\n    <li className={className} id={\"post-\" + post.id}>\n      <div className=\"panel panel-default panel-post\">\n        <div className=\"panel-body\">\n          <div className=\"panel-content\">\n            <PostSide post={post} poster={user} />\n            <Header post={post} />\n            <Body post={post} />\n          </div>\n        </div>\n      </div>\n    </li>\n  )\n}\n","import React from \"react\"\nimport Avatar from \"misago/components/avatar\"\nimport * as random from \"misago/utils/random\"\n\nexport default function () {\n  return (\n    <ul className=\"posts-list post-feed ui-preview\">\n      <li className=\"post\">\n        <div className=\"panel panel-default panel-post\">\n          <div className=\"panel-body\">\n            <div className=\"panel-content\">\n              <div className=\"post-side post-side-anonymous\">\n                <div className=\"media\">\n                  <div className=\"media-left\">\n                    <span>\n                      <Avatar className=\"poster-avatar\" size={50} />\n                    </span>\n                  </div>\n                  <div className=\"media-body\">\n                    <div className=\"media-heading\">\n                      <span className=\"item-title\">\n                        <span\n                          className=\"ui-preview-text\"\n                          style={{ width: random.int(30, 200) + \"px\" }}\n                        >\n                          &nbsp;\n                        </span>\n                      </span>\n                    </div>\n                    <span className=\"user-title user-title-anonymous\">\n                      <span\n                        className=\"ui-preview-text\"\n                        style={{ width: random.int(30, 200) + \"px\" }}\n                      >\n                        &nbsp;\n                      </span>\n                    </span>\n                  </div>\n                </div>\n              </div>\n              <div className=\"post-heading\">\n                <span\n                  className=\"ui-preview-text\"\n                  style={{ width: random.int(30, 200) + \"px\" }}\n                >\n                  &nbsp;\n                </span>\n              </div>\n              <div className=\"post-body\">\n                <article className=\"misago-markup\">\n                  <p>\n                    <span\n                      className=\"ui-preview-text\"\n                      style={{ width: random.int(30, 200) + \"px\" }}\n                    >\n                      &nbsp;\n                    </span>\n                    &nbsp;\n                    <span\n                      className=\"ui-preview-text\"\n                      style={{ width: random.int(30, 200) + \"px\" }}\n                    >\n                      &nbsp;\n                    </span>\n                    &nbsp;\n                    <span\n                      className=\"ui-preview-text\"\n                      style={{ width: random.int(30, 200) + \"px\" }}\n                    >\n                      &nbsp;\n                    </span>\n                  </p>\n                </article>\n              </div>\n            </div>\n          </div>\n        </div>\n      </li>\n    </ul>\n  )\n}\n","import React from \"react\"\nimport Post from \"./post\"\nimport Preview from \"./preview\"\n\nexport default function ({ isReady, posts, poster }) {\n  if (!isReady) {\n    return <Preview />\n  }\n\n  return (\n    <ul className=\"posts-list post-feed ui-ready\">\n      {posts.map((post) => {\n        return <Post key={post.id} post={post} poster={poster} />\n      })}\n    </ul>\n  )\n}\n","export const LOAD_DETAILS = \"LOAD_DETAILS\"\n\nexport function load(newState) {\n  return {\n    type: LOAD_DETAILS,\n\n    newState,\n  }\n}\n\nexport default function details(state = {}, action = null) {\n  switch (action.type) {\n    case LOAD_DETAILS:\n      return action.newState\n\n    default:\n      return state\n  }\n}\n","import React from \"react\"\n\nexport default class extends React.Component {\n  isValidated() {\n    return typeof this.props.validation !== \"undefined\"\n  }\n\n  getClassName() {\n    let className = \"form-group\"\n    if (this.isValidated()) {\n      className += \" has-feedback\"\n      if (this.props.validation === null) {\n        className += \" has-success\"\n      } else {\n        className += \" has-error\"\n      }\n    }\n    return className\n  }\n\n  getFeedback() {\n    if (this.props.validation) {\n      return (\n        <div className=\"help-block errors\">\n          {this.props.validation.map((error, i) => {\n            return <p key={this.props.for + \"FeedbackItem\" + i}>{error}</p>\n          })}\n        </div>\n      )\n    } else {\n      return null\n    }\n  }\n\n  getFeedbackDescription() {\n    if (this.isValidated()) {\n      return (\n        <span id={this.props.for + \"_status\"} className=\"sr-only\">\n          {this.props.validation\n            ? pgettext(\"field validation status\", \"(error)\")\n            : pgettext(\"field validation status\", \"(success)\")}\n        </span>\n      )\n    } else {\n      return null\n    }\n  }\n\n  getHelpText() {\n    if (this.props.helpText) {\n      return <p className=\"help-block\">{this.props.helpText}</p>\n    } else {\n      return null\n    }\n  }\n\n  render() {\n    return (\n      <div className={this.getClassName()}>\n        <label\n          className={\"control-label \" + (this.props.labelClass || \"\")}\n          htmlFor={this.props.for || \"\"}\n        >\n          {this.props.label + \":\"}\n        </label>\n        <div className={this.props.controlClass || \"\"}>\n          {this.props.children}\n          {this.getFeedbackDescription()}\n          {this.getFeedback()}\n          {this.getHelpText()}\n          {this.props.extra || null}\n        </div>\n      </div>\n    )\n  }\n}\n","import React from \"react\"\nimport misago from \"misago\"\nimport escapeHtml from \"misago/utils/escape-html\"\n\nconst AGREEMENT_URL = '<a href=\"%(url)s\" target=\"_blank\">%(agreement)s</a>'\n\nconst RegisterLegalFootnote = (props) => {\n  const {\n    errors,\n    privacyPolicy,\n    termsOfService,\n    onPrivacyPolicyChange,\n    onTermsOfServiceChange,\n  } = props\n\n  const termsOfServiceId = misago.get(\"TERMS_OF_SERVICE_ID\")\n  const termsOfServiceUrl = misago.get(\"TERMS_OF_SERVICE_URL\")\n\n  const privacyPolicyId = misago.get(\"PRIVACY_POLICY_ID\")\n  const privacyPolicyUrl = misago.get(\"PRIVACY_POLICY_URL\")\n\n  if (!termsOfServiceId && !privacyPolicyId) return null\n\n  return (\n    <div>\n      <LegalAgreement\n        agreement={pgettext(\n          \"register form agreement prompt\",\n          \"the terms of service\"\n        )}\n        checked={termsOfService !== null}\n        errors={errors.termsOfService}\n        url={termsOfServiceUrl}\n        value={termsOfServiceId}\n        onChange={onTermsOfServiceChange}\n      />\n      <LegalAgreement\n        agreement={pgettext(\n          \"register form agreement prompt\",\n          \"the privacy policy\"\n        )}\n        checked={privacyPolicy !== null}\n        errors={errors.privacyPolicy}\n        url={privacyPolicyUrl}\n        value={privacyPolicyId}\n        onChange={onPrivacyPolicyChange}\n      />\n    </div>\n  )\n}\n\nconst LegalAgreement = (props) => {\n  const { agreement, checked, errors, url, value, onChange } = props\n\n  if (!url) return null\n\n  const agreementHtml = interpolate(\n    AGREEMENT_URL,\n    { agreement: escapeHtml(agreement), url: escapeHtml(url) },\n    true\n  )\n  const label = interpolate(\n    pgettext(\n      \"register form agreement prompt\",\n      \"I have read and accept %(agreement)s.\"\n    ),\n    { agreement: agreementHtml },\n    true\n  )\n\n  return (\n    <div className=\"checkbox legal-footnote\">\n      <label>\n        <input\n          checked={checked}\n          type=\"checkbox\"\n          value={value}\n          onChange={onChange}\n        />\n        <span dangerouslySetInnerHTML={{ __html: label }} />\n      </label>\n      {errors &&\n        errors.map((error, i) => (\n          <div className=\"help-block errors\" key={i}>\n            {error}\n          </div>\n        ))}\n    </div>\n  )\n}\n\nexport default RegisterLegalFootnote\n","import misago from \"misago/index\"\nimport title from \"misago/services/page-title\"\n\nexport default function initializer(context) {\n  title.init(\n    context.get(\"SETTINGS\").forum_index_title,\n    context.get(\"SETTINGS\").forum_name\n  )\n}\n\nmisago.addInitializer({\n  name: \"page-title\",\n  initializer: initializer,\n})\n","import React from \"react\"\nimport ajax from \"misago/services/ajax\"\n\nexport default class AcceptAgreement extends React.Component {\n  constructor(props) {\n    super(props)\n\n    this.state = { submiting: false }\n  }\n\n  handleDecline = () => {\n    if (this.state.submiting) return\n\n    const confirmation = window.confirm(\n      pgettext(\n        \"accept agreement prompt\",\n        \"Declining will result in immediate deactivation and deletion of your account. This action is not reversible.\"\n      )\n    )\n    if (!confirmation) return\n\n    this.setState({ submiting: true })\n\n    ajax.post(this.props.api, { accept: false }).then(() => {\n      window.location.reload(true)\n    })\n  }\n\n  handleAccept = () => {\n    if (this.state.submiting) return\n\n    this.setState({ submiting: true })\n\n    ajax.post(this.props.api, { accept: true }).then(() => {\n      window.location.reload(true)\n    })\n  }\n\n  render() {\n    return (\n      <div>\n        <button\n          className=\"btn btn-default\"\n          disabled={this.state.submiting}\n          type=\"buton\"\n          onClick={this.handleDecline}\n        >\n          {pgettext(\"accept agreement choice\", \"Decline\")}\n        </button>\n        <button\n          className=\"btn btn-primary\"\n          disabled={this.state.submiting}\n          type=\"buton\"\n          onClick={this.handleAccept}\n        >\n          {pgettext(\"accept agreement choice\", \"Accept and continue\")}\n        </button>\n      </div>\n    )\n  }\n}\n","import React from \"react\"\nimport misago from \"misago/index\"\nimport AcceptAgreement from \"misago/components/accept-agreement\"\nimport mount from \"misago/utils/mount-component\"\n\nexport default function initializer(context) {\n  if (document.getElementById(\"required-agreement-mount\")) {\n    mount(\n      <AcceptAgreement api={context.get(\"REQUIRED_AGREEMENT_API\")} />,\n      \"required-agreement-mount\",\n      false\n    )\n  }\n}\n\nmisago.addInitializer({\n  name: \"component:accept-agreement\",\n  initializer: initializer,\n  after: \"store\",\n})\n","import React from \"react\"\n\nexport default class extends React.Component {\n  constructor(props) {\n    super(props)\n\n    this.state = {\n      dropdown: false,\n    }\n  }\n\n  toggleNav = () => {\n    this.setState({\n      dropdown: !this.state.dropdown,\n    })\n  }\n\n  hideNav = () => {\n    this.setState({\n      dropdown: false,\n    })\n  }\n\n  getCompactNavClassName() {\n    if (this.state.dropdown) {\n      return \"compact-nav open\"\n    } else {\n      return \"compact-nav\"\n    }\n  }\n}\n","import React from \"react\"\n\nexport default class extends React.Component {\n  getChoice() {\n    let choice = null\n    this.props.choices.map((item) => {\n      if (item.value === this.props.value) {\n        choice = item\n      }\n    })\n    return choice\n  }\n\n  getIcon() {\n    return this.getChoice().icon\n  }\n\n  getLabel() {\n    return this.getChoice().label\n  }\n\n  change = (value) => {\n    return () => {\n      this.props.onChange({\n        target: {\n          value: value,\n        },\n      })\n    }\n  }\n\n  render() {\n    return (\n      <div className=\"btn-group btn-select-group\">\n        <button\n          type=\"button\"\n          className=\"btn btn-select dropdown-toggle\"\n          id={this.props.id || null}\n          data-toggle=\"dropdown\"\n          aria-haspopup=\"true\"\n          aria-expanded=\"false\"\n          aria-describedby={this.props[\"aria-describedby\"] || null}\n          disabled={this.props.disabled || false}\n        >\n          <Icon icon={this.getIcon()} />\n          {this.getLabel()}\n        </button>\n        <ul className=\"dropdown-menu\">\n          {this.props.choices.map((item, i) => {\n            return (\n              <li key={i}>\n                <button\n                  type=\"button\"\n                  className=\"btn-link\"\n                  onClick={this.change(item.value)}\n                >\n                  <Icon icon={item.icon} />\n                  {item.label}\n                </button>\n              </li>\n            )\n          })}\n        </ul>\n      </div>\n    )\n  }\n}\n\nexport function Icon({ icon }) {\n  if (!icon) return null\n\n  return <span className=\"material-icon\">{icon}</span>\n}\n","export default function (a, b) {\n  let ids = []\n  return a.concat(b).filter(function (item) {\n    if (ids.indexOf(item.id) === -1) {\n      ids.push(item.id)\n      return true\n    } else {\n      return false\n    }\n  })\n}\n","import React from \"react\"\nimport ReactDOM from \"react-dom\"\nimport { Provider } from \"react-redux\"\nimport { Router, browserHistory } from \"react-router\"\nimport store from \"misago/services/store\"\n\nconst rootElement = document.getElementById(\"page-mount\")\n\nexport default function (options) {\n  let routes = {\n    component: options.component || null,\n    childRoutes: [],\n  }\n\n  if (options.root) {\n    routes.childRoutes = [\n      {\n        path: options.root,\n        onEnter: function (nextState, replaceState) {\n          replaceState(null, options.paths[0].path)\n        },\n      },\n    ].concat(options.paths)\n  } else {\n    routes.childRoutes = options.paths\n  }\n\n  ReactDOM.render(\n    <Provider store={store.getStore()}>\n      <Router routes={routes} history={browserHistory} />\n    </Provider>,\n    rootElement\n  )\n}\n","import misago from \"misago/index\"\nimport modal from \"misago/services/modal\"\n\nexport default function initializer() {\n  let element = document.getElementById(\"modal-mount\")\n  if (element) {\n    modal.init(element)\n  }\n}\n\nmisago.addInitializer({\n  name: \"modal\",\n  initializer: initializer,\n  before: \"store\",\n})\n","export const REPLACE_PARTICIPANTS = \"REPLACE_PARTICIPANTS\"\n\nexport function replace(newState) {\n  return {\n    type: REPLACE_PARTICIPANTS,\n    state: newState,\n  }\n}\n\nexport default function participants(state = [], action = null) {\n  switch (action.type) {\n    case REPLACE_PARTICIPANTS:\n      return action.state\n\n    default:\n      return state\n  }\n}\n","const EMAIL =\n  /^(([^<>()[\\]\\.,;:\\s@\\\"]+(\\.[^<>()[\\]\\.,;:\\s@\\\"]+)*)|(\\\".+\\\"))@(([^<>()[\\]\\.,;:\\s@\\\"]+\\.)+[^<>()[\\]\\.,;:\\s@\\\"]{2,})$/i\nconst USERNAME = new RegExp(\"^[0-9a-z_]+$\", \"i\")\nconst USERNAME_ALPHANUMERIC = new RegExp(\"[0-9a-z]\", \"i\")\n\nexport function required(message) {\n  return function (value) {\n    if (\n      value === false ||\n      value === null ||\n      String(value).trim().length === 0\n    ) {\n      return message || gettext(\"This field is required.\")\n    }\n  }\n}\n\nexport function requiredTermsOfService(message) {\n  const error = pgettext(\n    \"agreement validator\",\n    \"You have to accept the terms of service.\"\n  )\n  return required(message || error)\n}\n\nexport function requiredPrivacyPolicy(message) {\n  const error = pgettext(\n    \"agreement validator\",\n    \"You have to accept the privacy policy.\"\n  )\n  return required(message || error)\n}\n\nexport function email(message) {\n  return function (value) {\n    if (!EMAIL.test(value)) {\n      return (\n        message || pgettext(\"email validator\", \"Enter a valid e-mail address.\")\n      )\n    }\n  }\n}\n\nexport function minLength(limitValue, message) {\n  return function (value) {\n    var returnMessage = \"\"\n    var length = value.trim().length\n\n    if (length < limitValue) {\n      if (message) {\n        returnMessage = message(limitValue, length)\n      } else {\n        returnMessage = npgettext(\n          \"value length validator\",\n          \"Ensure this value has at least %(limit_value)s character (it has %(show_value)s).\",\n          \"Ensure this value has at least %(limit_value)s characters (it has %(show_value)s).\",\n          limitValue\n        )\n      }\n      return interpolate(\n        returnMessage,\n        {\n          limit_value: limitValue,\n          show_value: length,\n        },\n        true\n      )\n    }\n  }\n}\n\nexport function maxLength(limitValue, message) {\n  return function (value) {\n    var returnMessage = \"\"\n    var length = value.trim().length\n\n    if (length > limitValue) {\n      if (message) {\n        returnMessage = message(limitValue, length)\n      } else {\n        returnMessage = npgettext(\n          \"value length validator\",\n          \"Ensure this value has at most %(limit_value)s character (it has %(show_value)s).\",\n          \"Ensure this value has at most %(limit_value)s characters (it has %(show_value)s).\",\n          limitValue\n        )\n      }\n      return interpolate(\n        returnMessage,\n        {\n          limit_value: limitValue,\n          show_value: length,\n        },\n        true\n      )\n    }\n  }\n}\n\nexport function usernameMinLength(lengthMin) {\n  var message = function (lengthMin) {\n    return npgettext(\n      \"username length validator\",\n      \"Username must be at least %(limit_value)s character long.\",\n      \"Username must be at least %(limit_value)s characters long.\",\n      lengthMin\n    )\n  }\n  return minLength(lengthMin, message)\n}\n\nexport function usernameMaxLength(lengthMax) {\n  var message = function (lengthMax) {\n    return npgettext(\n      \"username length validator\",\n      \"Username cannot be longer than %(limit_value)s character.\",\n      \"Username cannot be longer than %(limit_value)s characters.\",\n      lengthMax\n    )\n  }\n  return maxLength(lengthMax, message)\n}\n\nexport function usernameContent() {\n  return function (value) {\n    const valueTrimmed = value.trim()\n    if (!USERNAME.test(valueTrimmed)) {\n      return pgettext(\n        \"username validator\",\n        \"Username can only contain Latin alphabet letters, digits, and an underscore sign.\"\n      )\n    }\n    if (!USERNAME_ALPHANUMERIC.test(valueTrimmed)) {\n      return pgettext(\n        \"username validator\",\n        \"Username must contain Latin alphabet letters or digits.\"\n      )\n    }\n  }\n}\n\nexport function passwordMinLength(limitValue) {\n  return function (value) {\n    const length = value.length\n\n    if (length < limitValue) {\n      const returnMessage = npgettext(\n        \"password length validator\",\n        \"Valid password must be at least %(limit_value)s character long.\",\n        \"Valid password must be at least %(limit_value)s characters long.\",\n        limitValue\n      )\n\n      return interpolate(\n        returnMessage,\n        {\n          limit_value: limitValue,\n          show_value: length,\n        },\n        true\n      )\n    }\n  }\n}\n","import classnames from \"classnames\"\nimport React from \"react\"\nimport { connect } from \"react-redux\"\nimport {\n  DropdownDivider,\n  DropdownHeader,\n  DropdownMenuItem,\n  DropdownPills,\n  DropdownSubheader,\n} from \"../Dropdown\"\nimport RegisterButton from \"../RegisterButton\"\nimport SignInButton from \"../SignInButton\"\n\nfunction SiteNavMenu({ isAnonymous, close, dropdown, overlay }) {\n  const baseUrl = misago.get(\"MISAGO_PATH\")\n  const settings = misago.get(\"SETTINGS\")\n  const mainItems = misago.get(\"main_menu\")\n  const extraItems = misago.get(\"extraMenuItems\")\n  const extraFooterItems = misago.get(\"extraFooterItems\")\n  const categories = misago.get(\"categories_menu\")\n  const users = misago.get(\"usersLists\")\n  const authDelegated = settings.enable_oauth2_client\n\n  const topNav = []\n  mainItems.forEach((item) => {\n    topNav.push({ title: item.label, url: item.url })\n  })\n\n  topNav.push({\n    title: pgettext(\"site nav\", \"Search\"),\n    url: baseUrl + \"search/\",\n  })\n\n  const footerNav = []\n\n  const tosTitle = misago.get(\"TERMS_OF_SERVICE_TITLE\")\n  const tosUrl = misago.get(\"TERMS_OF_SERVICE_URL\")\n  if (tosTitle && tosUrl) {\n    footerNav.push({\n      title: tosTitle,\n      url: tosUrl,\n    })\n  }\n\n  const privacyTitle = misago.get(\"PRIVACY_POLICY_TITLE\")\n  const privacyUrl = misago.get(\"PRIVACY_POLICY_URL\")\n  if (privacyTitle && privacyUrl) {\n    footerNav.push({\n      title: privacyTitle,\n      url: privacyUrl,\n    })\n  }\n\n  return (\n    <ul\n      className={classnames(\"site-nav-menu\", {\n        \"dropdown-menu-list\": dropdown,\n        \"overlay-menu-list\": overlay,\n      })}\n    >\n      {isAnonymous && (\n        <DropdownHeader className=\"site-nav-sign-in-message\">\n          {pgettext(\"cta\", \"You are not signed in\")}\n        </DropdownHeader>\n      )}\n      {isAnonymous && (\n        <DropdownPills className=\"site-nav-sign-in-options\">\n          <SignInButton onClick={close} />\n          {!authDelegated && <RegisterButton onClick={close} />}\n        </DropdownPills>\n      )}\n      <DropdownSubheader>{settings.forum_name}</DropdownSubheader>\n      {topNav.map((item) => (\n        <DropdownMenuItem key={item.url}>\n          <a href={item.url}>{item.title}</a>\n        </DropdownMenuItem>\n      ))}\n      {extraItems.map((item, index) => (\n        <DropdownMenuItem key={index} className={item.className}>\n          <a\n            href={item.url}\n            target={item.targetBlank ? \"_blank\" : null}\n            rel={item.rel}\n          >\n            {item.title}\n          </a>\n        </DropdownMenuItem>\n      ))}\n      {!!users.length && <DropdownDivider className=\"site-nav-users-divider\" />}\n      {!!users.length && (\n        <DropdownSubheader className=\"site-nav-users\">\n          {pgettext(\"site nav section\", \"Users\")}\n        </DropdownSubheader>\n      )}\n      {users.map((item) => (\n        <DropdownMenuItem key={item.url}>\n          <a href={item.url}>{item.name}</a>\n        </DropdownMenuItem>\n      ))}\n      <DropdownDivider className=\"site-nav-categories-divider\" />\n      <DropdownSubheader className=\"site-nav-categories\">\n        {pgettext(\"site nav section\", \"Categories\")}\n      </DropdownSubheader>\n      {categories.map((category) =>\n        category.is_vanilla ? (\n          <DropdownMenuItem\n            className=\"site-nav-category-header\"\n            key={category.id}\n          >\n            <a href={category.url}>{category.name}</a>\n          </DropdownMenuItem>\n        ) : (\n          <DropdownMenuItem\n            className={classnames(\"site-nav-category\", {\n              \"site-nav-category-last\": category.last,\n            })}\n            key={category.id}\n          >\n            <a href={category.url}>\n              <span>{category.name}</span>\n              <span\n                className={classnames(\n                  \"threads-list-item-category threads-list-category-label\",\n                  { \"threads-list-category-label-color\": !!category.color }\n                )}\n                style={{ \"--label-color\": category.color }}\n              >\n                {category.short_name || category.name}\n              </span>\n            </a>\n          </DropdownMenuItem>\n        )\n      )}\n      {(!!footerNav.length || !!extraFooterItems.length) && (\n        <DropdownDivider className=\"site-nav-footer-divider\" />\n      )}\n      {(!!footerNav.length || !!extraFooterItems.length) && (\n        <DropdownSubheader className=\"site-nav-footer\">\n          {pgettext(\"site nav section\", \"Footer\")}\n        </DropdownSubheader>\n      )}\n      {extraFooterItems.map((item, index) => (\n        <DropdownMenuItem key={index} className={item.className}>\n          <a\n            href={item.url}\n            target={item.targetBlank ? \"_blank\" : null}\n            rel={item.rel}\n          >\n            {item.title}\n          </a>\n        </DropdownMenuItem>\n      ))}\n      {footerNav.map((item) => (\n        <DropdownMenuItem key={item.url}>\n          <a href={item.url}>{item.title}</a>\n        </DropdownMenuItem>\n      ))}\n    </ul>\n  )\n}\n\nfunction select(state) {\n  return {\n    isAnonymous: !state.auth.user.id,\n  }\n}\n\nconst SiteNavMenuConnected = connect(select)(SiteNavMenu)\n\nexport default SiteNavMenuConnected\n","import React from \"react\"\nimport SiteNavMenu from \"./SiteNavMenu\"\n\nexport default function SiteNavDropdown({ close }) {\n  return <SiteNavMenu close={close} dropdown />\n}\n","import React from \"react\"\nimport { connect } from \"react-redux\"\nimport { close } from \"../../reducers/overlay\"\nimport { Overlay, OverlayHeader } from \"../Overlay\"\nimport SiteNavMenu from \"./SiteNavMenu\"\n\nexport function SiteNavOverlay({ dispatch, isOpen }) {\n  return (\n    <Overlay open={isOpen}>\n      <OverlayHeader>{pgettext(\"site nav title\", \"Menu\")}</OverlayHeader>\n      <SiteNavMenu close={() => dispatch(close())} overlay />\n    </Overlay>\n  )\n}\n\nfunction select(state) {\n  return {\n    isOpen: state.overlay.siteNav,\n  }\n}\n\nconst SiteNavOverlayConnected = connect(select)(SiteNavOverlay)\n\nexport default SiteNavOverlayConnected\n","import misago from \"misago/index\"\nimport { patch } from \"misago/reducers/auth\"\nimport ajax from \"misago/services/ajax\"\nimport snackbar from \"misago/services/snackbar\"\nimport store from \"misago/services/store\"\n\nconst AUTH_SYNC_RATE = 45 // sync user with backend every 45 seconds\n\nexport default function initializer(context) {\n  if (context.get(\"isAuthenticated\")) {\n    window.setInterval(function () {\n      ajax.get(context.get(\"AUTH_API\")).then(function (data) {\n        store.dispatch(patch(data))\n      })\n    }, AUTH_SYNC_RATE * 1000)\n  }\n}\n\nmisago.addInitializer({\n  name: \"auth-sync\",\n  initializer: initializer,\n  after: \"auth\",\n})\n","export class Ajax {\n  constructor() {\n    this._cookieName = null\n    this._csrfToken = null\n    this._locks = {}\n  }\n\n  init(cookieName) {\n    this._cookieName = cookieName\n  }\n\n  getCsrfToken() {\n    if (document.cookie.indexOf(this._cookieName) !== -1) {\n      let cookieRegex = new RegExp(this._cookieName + \"=([^;]*)\")\n      let cookie = document.cookie.match(cookieRegex)[0]\n      return cookie ? cookie.split(\"=\")[1] : null\n    } else {\n      return null\n    }\n  }\n\n  request(method, url, data) {\n    let self = this\n    return new Promise(function (resolve, reject) {\n      let xhr = {\n        url: url,\n        method: method,\n        headers: {\n          \"X-CSRFToken\": self.getCsrfToken(),\n        },\n\n        data: data ? JSON.stringify(data) : null,\n        contentType: \"application/json; charset=utf-8\",\n        dataType: \"json\",\n\n        success: function (data) {\n          resolve(data)\n        },\n\n        error: function (jqXHR) {\n          let rejection = jqXHR.responseJSON || {}\n\n          rejection.status = jqXHR.status\n\n          if (rejection.status === 0) {\n            rejection.detail = pgettext(\n              \"ajax client error\",\n              \"Could not connect to the site.\"\n            )\n          }\n\n          if (rejection.status === 404) {\n            if (!rejection.detail || rejection.detail === \"NOT FOUND\") {\n              rejection.detail = pgettext(\n                \"ajax client error\",\n                \"Action link is invalid.\"\n              )\n            }\n          }\n\n          if (rejection.status === 500 && !rejection.detail) {\n            rejection.detail = pgettext(\n              \"ajax client error\",\n              \"Unknown error has occurred.\"\n            )\n          }\n\n          rejection.statusText = jqXHR.statusText\n\n          reject(rejection)\n        },\n      }\n\n      $.ajax(xhr)\n    })\n  }\n\n  get(url, params, lock) {\n    if (params) {\n      url += \"?\" + $.param(params)\n    }\n\n    if (lock) {\n      let self = this\n\n      // update url in existing lock?\n      if (this._locks[lock]) {\n        this._locks[lock].url = url\n      }\n\n      // immediately dereference promise handlers without doing anything\n      // we are already waiting for existing response to resolve\n      if (this._locks[lock] && this._locks[lock].waiter) {\n        return {\n          then: function () {\n            return\n          },\n        }\n\n        // return promise that will begin when original one resolves\n      } else if (this._locks[lock] && this._locks[lock].wait) {\n        this._locks[lock].waiter = true\n\n        return new Promise(function (resolve, reject) {\n          let wait = function (url) {\n            // keep waiting on promise\n            if (self._locks[lock].wait) {\n              window.setTimeout(function () {\n                wait(url)\n              }, 300)\n\n              // poll for new url\n            } else if (self._locks[lock].url !== url) {\n              wait(self._locks[lock].url)\n\n              // ajax backend for response\n            } else {\n              self._locks[lock].waiter = false\n              self.request(\"GET\", self._locks[lock].url).then(\n                function (data) {\n                  if (self._locks[lock].url === url) {\n                    resolve(data)\n                  } else {\n                    self._locks[lock].waiter = true\n                    wait(self._locks[lock].url)\n                  }\n                },\n                function (rejection) {\n                  if (self._locks[lock].url === url) {\n                    reject(rejection)\n                  } else {\n                    self._locks[lock].waiter = true\n                    wait(self._locks[lock].url)\n                  }\n                }\n              )\n            }\n          }\n\n          window.setTimeout(function () {\n            wait(url)\n          }, 300)\n        })\n\n        // setup new lock without waiter\n      } else {\n        this._locks[lock] = {\n          url,\n          wait: true,\n          waiter: false,\n        }\n\n        return new Promise(function (resolve, reject) {\n          self.request(\"GET\", url).then(\n            function (data) {\n              self._locks[lock].wait = false\n              if (self._locks[lock].url === url) {\n                resolve(data)\n              }\n            },\n            function (rejection) {\n              self._locks[lock].wait = false\n              if (self._locks[lock].url === url) {\n                reject(rejection)\n              }\n            }\n          )\n        })\n      }\n    } else {\n      return this.request(\"GET\", url)\n    }\n  }\n\n  post(url, data) {\n    return this.request(\"POST\", url, data)\n  }\n\n  patch(url, data) {\n    return this.request(\"PATCH\", url, data)\n  }\n\n  put(url, data) {\n    return this.request(\"PUT\", url, data)\n  }\n\n  delete(url, data) {\n    return this.request(\"DELETE\", url, data)\n  }\n\n  upload(url, data, progress) {\n    let self = this\n    return new Promise(function (resolve, reject) {\n      let xhr = {\n        url: url,\n        method: \"POST\",\n        headers: {\n          \"X-CSRFToken\": self.getCsrfToken(),\n        },\n\n        data: data,\n        contentType: false,\n        processData: false,\n\n        xhr: function () {\n          let xhr = new window.XMLHttpRequest()\n          xhr.upload.addEventListener(\n            \"progress\",\n            function (evt) {\n              if (evt.lengthComputable) {\n                progress(Math.round((evt.loaded / evt.total) * 100))\n              }\n            },\n            false\n          )\n          return xhr\n        },\n\n        success: function (response) {\n          resolve(response)\n        },\n\n        error: function (jqXHR) {\n          let rejection = jqXHR.responseJSON || {}\n\n          rejection.status = jqXHR.status\n\n          if (rejection.status === 0) {\n            rejection.detail = pgettext(\n              \"api error\",\n              \"Could not connect to the site.\"\n            )\n          }\n\n          if (rejection.status === 413 && !rejection.detail) {\n            rejection.detail = pgettext(\n              \"api error\",\n              \"Upload was rejected by the site as too large.\"\n            )\n          }\n\n          if (rejection.status === 404) {\n            if (!rejection.detail || rejection.detail === \"NOT FOUND\") {\n              rejection.detail = pgettext(\n                \"api error\",\n                \"Action link is invalid.\"\n              )\n            }\n          }\n\n          if (rejection.status === 500 && !rejection.detail) {\n            rejection.detail = pgettext(\n              \"api error\",\n              \"Unknown error has occurred.\"\n            )\n          }\n\n          rejection.statusText = jqXHR.statusText\n\n          reject(rejection)\n        },\n      }\n\n      $.ajax(xhr)\n    })\n  }\n}\n\nexport default new Ajax()\n","import React from \"react\"\n\nexport default class extends React.Component {\n  isActive() {\n    if (this.props.isControlled) {\n      return this.props.isActive\n    } else {\n      if (this.props.path) {\n        return document.location.pathname.indexOf(this.props.path) === 0\n      } else {\n        return false\n      }\n    }\n  }\n\n  getClassName() {\n    if (this.isActive()) {\n      return (\n        (this.props.className || \"\") +\n        \" \" +\n        (this.props.activeClassName || \"active\")\n      )\n    } else {\n      return this.props.className || \"\"\n    }\n  }\n\n  render() {\n    return <li className={this.getClassName()}>{this.props.children}</li>\n  }\n}\n","import React from \"react\"\nimport ReactDOM from \"react-dom\"\nimport { Provider } from \"react-redux\"\nimport store from \"misago/services/store\"\n\nexport default function (Component, rootElementId, connected = true) {\n  let rootElement = document.getElementById(rootElementId)\n\n  let finalComponent = Component.props ? Component : <Component />\n\n  if (rootElement) {\n    if (connected) {\n      ReactDOM.render(\n        <Provider store={store.getStore()}>{finalComponent}</Provider>,\n\n        rootElement\n      )\n    } else {\n      ReactDOM.render(finalComponent, rootElement)\n    }\n  }\n}\n","import moment from \"moment\"\nimport { hydrateUser } from \"./users\"\n\nexport const PATCH_POST = \"PATCH_POST\"\n\nexport function hydrate(json) {\n  return Object.assign({}, json, {\n    posted_on: moment(json.posted_on),\n    updated_on: moment(json.updated_on),\n    hidden_on: moment(json.hidden_on),\n\n    attachments: json.attachments\n      ? json.attachments.map(hydrateAttachment)\n      : null,\n    poster: json.poster ? hydrateUser(json.poster) : null,\n\n    isSelected: false,\n    isBusy: false,\n    isDeleted: false,\n  })\n}\n\nexport function hydrateAttachment(json) {\n  return Object.assign({}, json, {\n    uploaded_on: moment(json.uploaded_on),\n  })\n}\n\nexport function patch(post, patch) {\n  return {\n    type: PATCH_POST,\n    post,\n    patch,\n  }\n}\n\nexport default function post(state = {}, action = null) {\n  switch (action.type) {\n    case PATCH_POST:\n      if (state.id == action.post.id) {\n        return Object.assign({}, state, action.patch)\n      }\n      return state\n\n    default:\n      return state\n  }\n}\n","import React from \"react\"\nimport { ListGroupEmpty } from \"../ListGroup\"\n\nexport default function NotificationsListEmpty({ filter }) {\n  return (\n    <ListGroupEmpty\n      icon={\n        filter === \"unread\" ? \"sentiment_very_satisfied\" : \"notifications_none\"\n      }\n      message={emptyMessage(filter)}\n    />\n  )\n}\n\nfunction emptyMessage(filter) {\n  if (filter === \"read\") {\n    return pgettext(\n      \"notifications list\",\n      \"You don't have any read notifications.\"\n    )\n  } else if (filter === \"unread\") {\n    return pgettext(\n      \"notifications list\",\n      \"You don't have any unread notifications.\"\n    )\n  }\n\n  return pgettext(\"notifications list\", \"You don't have any notifications.\")\n}\n","import classnames from \"classnames\"\nimport React from \"react\"\nimport { ListGroup } from \"../ListGroup\"\n\nexport default function NotificationsListGroup({ className, children }) {\n  return (\n    <div className={classnames(\"notifications-list\", className)}>\n      <ListGroup>{children}</ListGroup>\n    </div>\n  )\n}\n","import React from \"react\"\nimport Avatar from \"../avatar\"\n\nexport default function NotificationsListItemActor({ notification }) {\n  if (!!notification.actor) {\n    return (\n      <a\n        href={notification.actor.url}\n        className=\"notifications-list-item-actor\"\n        title={notification.actor.username}\n      >\n        <Avatar size={30} user={notification.actor} />\n      </a>\n    )\n  }\n\n  return (\n    <span\n      className=\"threads-list-item-last-poster\"\n      title={notification.actor_name || null}\n    >\n      <Avatar size={30} />\n    </span>\n  )\n}\n","import classnames from \"classnames\"\nimport React from \"react\"\n\nexport default function NotificationsListItemMessage({ notification }) {\n  return (\n    <a\n      href={notification.url}\n      className={classnames(\"notification-message\", {\n        \"notification-message-read\": notification.isRead,\n        \"notification-message-unread\": !notification.isRead,\n      })}\n      dangerouslySetInnerHTML={{ __html: notification.message }}\n    />\n  )\n}\n","import React from \"react\"\n\nexport default function NotificationsListItemReadStatus({ notification }) {\n  if (notification.isRead) {\n    return (\n      <div\n        className=\"notifications-list-item-read-status\"\n        title={pgettext(\"notification status\", \"Read notification\")}\n      >\n        <span className=\"notification-read-icon\"></span>\n      </div>\n    )\n  }\n\n  return (\n    <div\n      className=\"notifications-list-item-read-status\"\n      title={pgettext(\"notification status\", \"Unread notification\")}\n    >\n      <span className=\"notification-unread-icon\"></span>\n    </div>\n  )\n}\n","import React from \"react\"\nimport Timestamp from \"../Timestamp\"\n\nexport default function NotificationsListItemTimestamp({ notification }) {\n  return (\n    <div className=\"notifications-list-item-timestamp\">\n      <Timestamp datetime={notification.createdAt} />\n    </div>\n  )\n}\n","import classnames from \"classnames\"\nimport React from \"react\"\nimport { ListGroupItem } from \"../ListGroup\"\nimport NotificationsListItemActor from \"./NotificationsListItemActor\"\nimport NotificationsListItemMessage from \"./NotificationsListItemMessage\"\nimport NotificationsListItemReadStatus from \"./NotificationsListItemReadStatus\"\nimport NotificationsListItemTimestamp from \"./NotificationsListItemTimestamp\"\n\nexport default function NotificationsListItem({ notification }) {\n  return (\n    <ListGroupItem\n      key={notification.id}\n      className={classnames(\"notifications-list-item\", {\n        \"notifications-list-item-read\": notification.isRead,\n        \"notifications-list-item-unread\": !notification.isRead,\n      })}\n    >\n      <div className=\"notifications-list-item-left-col\">\n        <div className=\"notifications-list-item-col-actor\">\n          <NotificationsListItemActor notification={notification} />\n        </div>\n        <div className=\"notifications-list-item-col-read-icon\">\n          <NotificationsListItemReadStatus notification={notification} />\n        </div>\n      </div>\n      <div className=\"notifications-list-item-right-col\">\n        <div className=\"notifications-list-item-col-message\">\n          <NotificationsListItemMessage notification={notification} />\n        </div>\n        <div className=\"notifications-list-item-col-timestamp\">\n          <NotificationsListItemTimestamp notification={notification} />\n        </div>\n      </div>\n    </ListGroupItem>\n  )\n}\n","import React from \"react\"\nimport NotificationsListEmpty from \"./NotificationsListEmpty\"\nimport NotificationsListGroup from \"./NotificationsListGroup\"\nimport NotificationsListItem from \"./NotificationsListItem\"\n\nexport default function NotificationsList({ filter, items }) {\n  return (\n    <NotificationsListGroup\n      className={\n        items.length > 0\n          ? \"notifications-list-ready\"\n          : \"notifications-list-pending\"\n      }\n    >\n      {items.length === 0 && <NotificationsListEmpty filter={filter} />}\n      {items.map((notification) => (\n        <NotificationsListItem\n          key={notification.id}\n          notification={notification}\n        />\n      ))}\n    </NotificationsListGroup>\n  )\n}\n","import React from \"react\"\nimport { ListGroupError } from \"../ListGroup\"\nimport NotificationsListGroup from \"./NotificationsListGroup\"\n\nexport default function NotificationsListError({ error }) {\n  const detail = errorDetail(error)\n\n  return (\n    <NotificationsListGroup className=\"notifications-list-pending\">\n      <ListGroupError\n        icon=\"notifications_off\"\n        message={pgettext(\n          \"notifications list\",\n          \"Notifications could not be loaded.\"\n        )}\n        detail={detail}\n      />\n    </NotificationsListGroup>\n  )\n}\n\nfunction errorDetail(error) {\n  if (error.status === 0) {\n    return gettext(\n      \"Check your internet connection and try refreshing the site.\"\n    )\n  }\n\n  if (error.data && error.data.detail) {\n    return error.data.detail\n  }\n}\n","import React from \"react\"\nimport { ListGroupLoading } from \"../ListGroup\"\nimport NotificationsListGroup from \"./NotificationsListGroup\"\n\nexport default function NotificationsListLoading() {\n  return (\n    <NotificationsListGroup className=\"notifications-list-pending\">\n      <ListGroupLoading\n        message={pgettext(\"notifications list\", \"Loading notifications...\")}\n      />\n    </NotificationsListGroup>\n  )\n}\n","import moment from \"moment\"\nimport {\n  UPDATE_AVATAR,\n  UPDATE_USERNAME,\n  hydrateStatus,\n} from \"misago/reducers/users\"\n\nexport const HYDRATE_PROFILE = \"HYDRATE_PROFILE\"\nexport const PATCH_PROFILE = \"PATCH_PROFILE\"\n\nexport function hydrate(profile) {\n  return {\n    type: HYDRATE_PROFILE,\n    profile,\n  }\n}\n\nexport function patch(patch) {\n  return {\n    type: PATCH_PROFILE,\n    patch,\n  }\n}\n\nexport default function auth(state = {}, action = null) {\n  switch (action.type) {\n    case HYDRATE_PROFILE:\n      return Object.assign({}, action.profile, {\n        joined_on: moment(action.profile.joined_on),\n        status: hydrateStatus(action.profile.status),\n      })\n\n    case PATCH_PROFILE:\n      return Object.assign({}, state, action.patch)\n\n    case UPDATE_AVATAR:\n      if (state.id === action.userId) {\n        return Object.assign({}, state, {\n          avatars: action.avatars,\n        })\n      }\n      return state\n\n    case UPDATE_USERNAME:\n      if (state.id === action.userId) {\n        return Object.assign({}, state, {\n          username: action.username,\n          slug: action.slug,\n        })\n      }\n      return state\n\n    default:\n      return state\n  }\n}\n","import moment from \"moment\"\nimport concatUnique from \"misago/utils/concat-unique\"\n\nexport const APPEND_USERS = \"APPEND_USERS\"\nexport const HYDRATE_USERS = \"HYDRATE_USERS\"\nexport const UPDATE_AVATAR = \"UPDATE_AVATAR\"\nexport const UPDATE_USERNAME = \"UPDATE_USERNAME\"\n\nexport function append(items) {\n  return {\n    type: APPEND_USERS,\n    items,\n  }\n}\n\nexport function hydrate(items) {\n  return {\n    type: HYDRATE_USERS,\n    items,\n  }\n}\n\nexport function hydrateStatus(status) {\n  if (status) {\n    return Object.assign({}, status, {\n      last_click: status.last_click ? moment(status.last_click) : null,\n      banned_until: status.banned_until ? moment(status.banned_until) : null,\n    })\n  } else {\n    return null\n  }\n}\n\nexport function hydrateUser(user) {\n  return Object.assign({}, user, {\n    joined_on: moment(user.joined_on),\n    status: hydrateStatus(user.status),\n  })\n}\n\nexport function updateAvatar(user, avatars) {\n  return {\n    type: UPDATE_AVATAR,\n    userId: user.id,\n    avatars,\n  }\n}\n\nexport function updateUsername(user, username, slug) {\n  return {\n    type: UPDATE_USERNAME,\n    userId: user.id,\n    username,\n    slug,\n  }\n}\n\nexport default function user(state = [], action = null) {\n  switch (action.type) {\n    case APPEND_USERS:\n      return concatUnique(state, action.items.map(hydrateUser))\n\n    case HYDRATE_USERS:\n      return action.items.map(hydrateUser)\n\n    case UPDATE_AVATAR:\n      return state.map(function (item) {\n        item = Object.assign({}, item)\n        if (item.id === action.userId) {\n          item.avatars = action.avatars\n        }\n\n        return item\n      })\n\n    default:\n      return state\n  }\n}\n","import classnames from \"classnames\"\nimport React from \"react\"\n\nconst Toolbar = ({ children, className }) => (\n  <nav className={classnames(\"toolbar\", className)}>{children}</nav>\n)\n\nexport default Toolbar\n","import classnames from \"classnames\"\nimport React from \"react\"\n\nconst ToolbarItem = ({ children, className, shrink }) => (\n  <div\n    className={classnames(\"toolbar-item\", className, {\n      \"toolbar-item-shrink\": shrink,\n    })}\n  >\n    {children}\n  </div>\n)\n\nexport default ToolbarItem\n","import classnames from \"classnames\"\nimport React from \"react\"\n\nconst ToolbarSection = ({ auto, children, className }) => (\n  <div\n    className={classnames(\n      \"toolbar-section\",\n      { \"toolbar-section-auto\": auto },\n      className\n    )}\n  >\n    {children}\n  </div>\n)\n\nexport default ToolbarSection\n","import classnames from \"classnames\"\nimport React from \"react\"\n\nconst ToolbarSpacer = ({ className }) => (\n  <div className={classnames(\"toolbar-spacer\", className)} />\n)\n\nexport default ToolbarSpacer\n","import React from \"react\"\nimport {\n  PageHeader,\n  PageHeaderBanner,\n  PageHeaderContainer,\n} from \"../PageHeader\"\n\nconst Header = ({ backendName }) => {\n  const pageTitleTpl = pgettext(\"social auth title\", \"Sign in with %(backend)s\")\n  const pageTitle = interpolate(pageTitleTpl, { backend: backendName }, true)\n\n  return (\n    <PageHeaderContainer>\n      <PageHeader styleName=\"social-auth\">\n        <PageHeaderBanner styleName=\"social-auth\">\n          <h1>{pageTitle}</h1>\n        </PageHeaderBanner>\n      </PageHeader>\n    </PageHeaderContainer>\n  )\n}\n\nexport default Header\n","import React from \"react\"\nimport misago from \"misago\"\nimport RegisterLegalFootnote from \"misago/components/RegisterLegalFootnote\"\nimport Button from \"misago/components/button\"\nimport Form from \"misago/components/form\"\nimport FormGroup from \"misago/components/form-group\"\nimport ajax from \"misago/services/ajax\"\nimport snackbar from \"misago/services/snackbar\"\nimport * as validators from \"misago/utils/validators\"\nimport PageContainer from \"../PageContainer\"\nimport Header from \"./header\"\n\nexport default class Register extends Form {\n  constructor(props) {\n    super(props)\n\n    const formValidators = {\n      email: [validators.email()],\n      username: [validators.usernameContent()],\n    }\n\n    if (!!misago.get(\"TERMS_OF_SERVICE_ID\")) {\n      formValidators.termsOfService = [validators.requiredTermsOfService()]\n    }\n\n    if (!!misago.get(\"PRIVACY_POLICY_ID\")) {\n      formValidators.privacyPolicy = [validators.requiredPrivacyPolicy()]\n    }\n\n    this.state = {\n      email: props.email || \"\",\n      emailProtected: !!props.email,\n      username: props.username || \"\",\n\n      termsOfService: null,\n      privacyPolicy: null,\n\n      validators: formValidators,\n      errors: {},\n\n      isLoading: false,\n    }\n  }\n\n  clean() {\n    let errors = this.validate()\n    let lengths = [\n      this.state.email.trim().length,\n      this.state.username.trim().length,\n    ]\n\n    if (lengths.indexOf(0) !== -1) {\n      snackbar.error(pgettext(\"social auth form\", \"Fill out all fields.\"))\n      return false\n    }\n\n    const { validators } = this.state\n\n    const checkTermsOfService = !!misago.get(\"TERMS_OF_SERVICE_ID\")\n    if (checkTermsOfService && this.state.termsOfService === null) {\n      snackbar.error(validators.termsOfService[0](null))\n      return false\n    }\n\n    const checkPrivacyPolicy = !!misago.get(\"PRIVACY_POLICY_ID\")\n    if (checkPrivacyPolicy && this.state.privacyPolicy === null) {\n      snackbar.error(validators.privacyPolicy[0](null))\n      return false\n    }\n\n    return true\n  }\n\n  send() {\n    return ajax.post(this.props.url, {\n      email: this.state.email,\n      username: this.state.username,\n      terms_of_service: this.state.termsOfService,\n      privacy_policy: this.state.privacyPolicy,\n    })\n  }\n\n  handleSuccess(response) {\n    const { onRegistrationComplete } = this.props\n    onRegistrationComplete(response)\n  }\n\n  handleError(rejection) {\n    if (rejection.status === 200) {\n      // We've entered \"errored\" state because response is HTML instead of exptected JSON\n      const { onRegistrationComplete } = this.props\n      const { username } = this.state\n      onRegistrationComplete({ activation: \"active\", step: \"done\", username })\n    } else if (rejection.status === 400) {\n      const stateUpdate = { errors: rejection }\n      if (rejection.email) {\n        stateUpdate.emailProtected = false\n      }\n      this.setState(stateUpdate)\n    } else {\n      snackbar.apiError(rejection)\n    }\n  }\n\n  handlePrivacyPolicyChange = (event) => {\n    const value = event.target.value\n    this.handleToggleAgreement(\"privacyPolicy\", value)\n  }\n\n  handleTermsOfServiceChange = (event) => {\n    const value = event.target.value\n    this.handleToggleAgreement(\"termsOfService\", value)\n  }\n\n  handleToggleAgreement = (agreement, value) => {\n    this.setState((prevState, props) => {\n      if (prevState[agreement] === null) {\n        const errors = { ...prevState.errors, [agreement]: null }\n        return { errors, [agreement]: value }\n      }\n\n      const validator = this.state.validators[agreement][0]\n      const errors = { ...prevState.errors, [agreement]: [validator(null)] }\n      return { errors, [agreement]: null }\n    })\n  }\n\n  render() {\n    const { backend_name } = this.props\n    const { email, emailProtected, username, isLoading } = this.state\n\n    let emailHelpText = null\n    if (emailProtected) {\n      const emailHelpTextTpl = pgettext(\n        \"social auth form\",\n        \"Your e-mail address has been verified by %(backend)s.\"\n      )\n      emailHelpText = interpolate(\n        emailHelpTextTpl,\n        { backend: backend_name },\n        true\n      )\n    }\n\n    return (\n      <div className=\"page page-social-auth page-social-auth-register\">\n        <Header backendName={backend_name} />\n        <PageContainer>\n          <div className=\"row\">\n            <div className=\"col-md-6 col-md-offset-3\">\n              <form onSubmit={this.handleSubmit}>\n                <div className=\"panel panel-default panel-form\">\n                  <div className=\"panel-heading\">\n                    <h3 className=\"panel-title\">\n                      {pgettext(\n                        \"social auth form title\",\n                        \"Complete your account\"\n                      )}\n                    </h3>\n                  </div>\n                  <div className=\"panel-body\">\n                    <FormGroup\n                      for=\"id_username\"\n                      label={pgettext(\"social auth form field\", \"Username\")}\n                      validation={this.state.errors.username}\n                    >\n                      <input\n                        type=\"text\"\n                        id=\"id_username\"\n                        className=\"form-control\"\n                        disabled={isLoading}\n                        onChange={this.bindInput(\"username\")}\n                        value={username}\n                      />\n                    </FormGroup>\n                    <FormGroup\n                      for=\"id_email\"\n                      label={pgettext(\n                        \"social auth form field\",\n                        \"E-mail address\"\n                      )}\n                      helpText={emailHelpText}\n                      validation={\n                        emailProtected ? null : this.state.errors.email\n                      }\n                    >\n                      <input\n                        type=\"email\"\n                        id=\"id_email\"\n                        className=\"form-control\"\n                        disabled={isLoading || emailProtected}\n                        onChange={this.bindInput(\"email\")}\n                        value={email}\n                      />\n                    </FormGroup>\n                    <RegisterLegalFootnote\n                      errors={this.state.errors}\n                      privacyPolicy={this.state.privacyPolicy}\n                      termsOfService={this.state.termsOfService}\n                      onPrivacyPolicyChange={this.handlePrivacyPolicyChange}\n                      onTermsOfServiceChange={this.handleTermsOfServiceChange}\n                    />\n                  </div>\n                  <div className=\"panel-footer\">\n                    <Button\n                      className=\"btn-primary\"\n                      loading={this.state.isLoading}\n                    >\n                      {pgettext(\"social auth form btn\", \"Sign in\")}\n                    </Button>\n                  </div>\n                </div>\n              </form>\n            </div>\n          </div>\n        </PageContainer>\n      </div>\n    )\n  }\n}\n","import React from \"react\"\nimport misago from \"misago\"\nimport PageContainer from \"../PageContainer\"\nimport Header from \"./header\"\n\nconst Complete = ({ activation, backend_name, username }) => {\n  let icon = \"\"\n  let message = \"\"\n  if (activation === \"user\") {\n    message = pgettext(\n      \"account activation required\",\n      \"%(username)s, your account has been created but you need to activate it before you will be able to sign in.\"\n    )\n  } else if (activation === \"admin\") {\n    message = pgettext(\n      \"account activation required\",\n      \"%(username)s, your account has been created but the site administrator will have to activate it before you will be able to sign in.\"\n    )\n  } else {\n    message = pgettext(\n      \"social auth complete\",\n      \"%(username)s, your account has been created and you have been signed in to it.\"\n    )\n  }\n\n  if (activation === \"active\") {\n    icon = \"check\"\n  } else {\n    icon = \"info_outline\"\n  }\n\n  return (\n    <div className=\"page page-social-auth page-social-auth-register\">\n      <Header backendName={backend_name} />\n      <PageContainer>\n        <div className=\"row\">\n          <div className=\"col-md-6 col-md-offset-3\">\n            <div className=\"panel panel-default panel-form\">\n              <div className=\"panel-heading\">\n                <h3 className=\"panel-title\">\n                  {pgettext(\n                    \"social auth complete title\",\n                    \"Registration completed!\"\n                  )}\n                </h3>\n              </div>\n              <div className=\"panel-body panel-message-body\">\n                <div className=\"message-icon\">\n                  <span className=\"material-icon\">{icon}</span>\n                </div>\n                <div className=\"message-body\">\n                  <p className=\"lead\">\n                    {interpolate(message, { username }, true)}\n                  </p>\n                  <p className=\"help-block\">\n                    <a\n                      className=\"btn btn-default\"\n                      href={misago.get(\"MISAGO_PATH\")}\n                    >\n                      {pgettext(\n                        \"social auth complete link\",\n                        \"Return to forum index\"\n                      )}\n                    </a>\n                  </p>\n                </div>\n              </div>\n            </div>\n          </div>\n        </div>\n      </PageContainer>\n    </div>\n  )\n}\n\nexport default Complete\n","import React from \"react\"\nimport Register from \"./register\"\nimport Complete from \"./complete\"\n\nexport default class SocialAuth extends React.Component {\n  constructor(props) {\n    super(props)\n\n    this.state = {\n      step: props.step,\n\n      activation: props.activation || \"\",\n      email: props.email || \"\",\n      username: props.username || \"\",\n    }\n  }\n\n  handleRegistrationComplete = ({ activation, email, step, username }) => {\n    this.setState({ activation, email, step, username })\n  }\n\n  render() {\n    const { backend_name, url } = this.props\n    const { activation, email, step, username } = this.state\n\n    if (step === \"register\") {\n      return (\n        <Register\n          backend_name={backend_name}\n          email={email}\n          url={url}\n          username={username}\n          onRegistrationComplete={this.handleRegistrationComplete}\n        />\n      )\n    }\n\n    return (\n      <Complete\n        activation={activation}\n        backend_name={backend_name}\n        email={email}\n        url={url}\n        username={username}\n      />\n    )\n  }\n}\n","import React from \"react\"\nimport SocialAuth from \"misago/components/social-auth\"\nimport misago from \"misago\"\nimport mount from \"misago/utils/mount-component\"\n\nexport default function initializer(context) {\n  if (context.get(\"CURRENT_LINK\") === \"misago:social-complete\") {\n    const props = context.get(\"SOCIAL_AUTH_FORM\")\n    mount(<SocialAuth {...props} />, \"page-mount\")\n  }\n}\n\nmisago.addInitializer({\n  name: \"component:social-auth\",\n  initializer: initializer,\n  after: \"store\",\n})\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\tid: moduleId,\n\t\tloaded: false,\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n\t// Flag the module as loaded\n\tmodule.loaded = true;\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n// expose the modules object (__webpack_modules__)\n__webpack_require__.m = __webpack_modules__;\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.f = {};\n// This file contains only the entry chunk.\n// The chunk loading function for additional chunks\n__webpack_require__.e = (chunkId) => {\n\treturn Promise.all(Object.keys(__webpack_require__.f).reduce((promises, key) => {\n\t\t__webpack_require__.f[key](chunkId, promises);\n\t\treturn promises;\n\t}, []));\n};","// This function allow to reference async chunks\n__webpack_require__.u = (chunkId) => {\n\t// return url for filenames based on template\n\treturn \"\" + \"hljs\" + \".js\";\n};","// This function allow to reference async chunks\n__webpack_require__.miniCssF = (chunkId) => {\n\t// return url for filenames based on template\n\treturn undefined;\n};","__webpack_require__.g = (function() {\n\tif (typeof globalThis === 'object') return globalThis;\n\ttry {\n\t\treturn this || new Function('return this')();\n\t} catch (e) {\n\t\tif (typeof window === 'object') return window;\n\t}\n})();","__webpack_require__.hmd = (module) => {\n\tmodule = Object.create(module);\n\tif (!module.children) module.children = [];\n\tObject.defineProperty(module, 'exports', {\n\t\tenumerable: true,\n\t\tset: () => {\n\t\t\tthrow new Error('ES Modules may not assign module.exports or exports.*, Use ESM export syntax, instead: ' + module.id);\n\t\t}\n\t});\n\treturn module;\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","__webpack_require__.nmd = (module) => {\n\tmodule.paths = [];\n\tif (!module.children) module.children = [];\n\treturn module;\n};","var scriptUrl;\nif (__webpack_require__.g.importScripts) scriptUrl = __webpack_require__.g.location + \"\";\nvar document = __webpack_require__.g.document;\nif (!scriptUrl && document) {\n\tif (document.currentScript && document.currentScript.tagName.toUpperCase() === 'SCRIPT')\n\t\tscriptUrl = document.currentScript.src;\n\tif (!scriptUrl) {\n\t\tvar scripts = document.getElementsByTagName(\"script\");\n\t\tif(scripts.length) {\n\t\t\tvar i = scripts.length - 1;\n\t\t\twhile (i > -1 && (!scriptUrl || !/^http(s?):/.test(scriptUrl))) scriptUrl = scripts[i--].src;\n\t\t}\n\t}\n}\n// When supporting browsers where an automatic publicPath is not supported you must specify an output.publicPath manually via configuration\n// or pass an empty string (\"\") and set the __webpack_public_path__ variable from your code to use your own logic.\nif (!scriptUrl) throw new Error(\"Automatic publicPath is not supported in this browser\");\nscriptUrl = scriptUrl.replace(/^blob:/, \"\").replace(/#.*$/, \"\").replace(/\\?.*$/, \"\").replace(/\\/[^\\/]+$/, \"/\");\n__webpack_require__.p = scriptUrl;","// no baseURI\n\n// object to store loaded and loading chunks\n// undefined = chunk not loaded, null = chunk preloaded/prefetched\n// [resolve, reject, Promise] = chunk loading, 0 = chunk loaded\nvar installedChunks = {\n\t123: 0\n};\n\n__webpack_require__.f.j = (chunkId, promises) => {\n\t\t// JSONP chunk loading for javascript\n\t\tvar installedChunkData = __webpack_require__.o(installedChunks, chunkId) ? installedChunks[chunkId] : undefined;\n\t\tif(installedChunkData !== 0) { // 0 means \"already installed\".\n\n\t\t\t// a Promise means \"currently loading\".\n\t\t\tif(installedChunkData) {\n\t\t\t\tpromises.push(installedChunkData[2]);\n\t\t\t} else {\n\t\t\t\tif(true) { // all chunks have JS\n\t\t\t\t\t// setup Promise in chunk cache\n\t\t\t\t\tvar promise = new Promise((resolve, reject) => (installedChunkData = installedChunks[chunkId] = [resolve, reject]));\n\t\t\t\t\tpromises.push(installedChunkData[2] = promise);\n\n\t\t\t\t\t// start chunk loading\n\t\t\t\t\tvar url = __webpack_require__.p + __webpack_require__.u(chunkId);\n\t\t\t\t\t// create error before stack unwound to get useful stacktrace later\n\t\t\t\t\tvar error = new Error();\n\t\t\t\t\tvar loadingEnded = (event) => {\n\t\t\t\t\t\tif(__webpack_require__.o(installedChunks, chunkId)) {\n\t\t\t\t\t\t\tinstalledChunkData = installedChunks[chunkId];\n\t\t\t\t\t\t\tif(installedChunkData !== 0) installedChunks[chunkId] = undefined;\n\t\t\t\t\t\t\tif(installedChunkData) {\n\t\t\t\t\t\t\t\tvar errorType = event && (event.type === 'load' ? 'missing' : event.type);\n\t\t\t\t\t\t\t\tvar realSrc = event && event.target && event.target.src;\n\t\t\t\t\t\t\t\terror.message = 'Loading chunk ' + chunkId + ' failed.\\n(' + errorType + ': ' + realSrc + ')';\n\t\t\t\t\t\t\t\terror.name = 'ChunkLoadError';\n\t\t\t\t\t\t\t\terror.type = errorType;\n\t\t\t\t\t\t\t\terror.request = realSrc;\n\t\t\t\t\t\t\t\tinstalledChunkData[1](error);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t};\n\t\t\t\t\t__webpack_require__.l(url, loadingEnded, \"chunk-\" + chunkId, chunkId);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n};\n\n// no prefetching\n\n// no preloaded\n\n// no HMR\n\n// no HMR manifest\n\n__webpack_require__.O.j = (chunkId) => (installedChunks[chunkId] === 0);\n\n// install a JSONP callback for chunk loading\nvar webpackJsonpCallback = (parentChunkLoadingFunction, data) => {\n\tvar [chunkIds, moreModules, runtime] = data;\n\t// add \"moreModules\" to the modules object,\n\t// then flag all \"chunkIds\" as loaded and fire callback\n\tvar moduleId, chunkId, i = 0;\n\tif(chunkIds.some((id) => (installedChunks[id] !== 0))) {\n\t\tfor(moduleId in moreModules) {\n\t\t\tif(__webpack_require__.o(moreModules, moduleId)) {\n\t\t\t\t__webpack_require__.m[moduleId] = moreModules[moduleId];\n\t\t\t}\n\t\t}\n\t\tif(runtime) var result = runtime(__webpack_require__);\n\t}\n\tif(parentChunkLoadingFunction) parentChunkLoadingFunction(data);\n\tfor(;i < chunkIds.length; i++) {\n\t\tchunkId = chunkIds[i];\n\t\tif(__webpack_require__.o(installedChunks, chunkId) && installedChunks[chunkId]) {\n\t\t\tinstalledChunks[chunkId][0]();\n\t\t}\n\t\tinstalledChunks[chunkId] = 0;\n\t}\n\treturn __webpack_require__.O(result);\n}\n\nvar chunkLoadingGlobal = self[\"webpackChunkmisago\"] = self[\"webpackChunkmisago\"] || [];\nchunkLoadingGlobal.forEach(webpackJsonpCallback.bind(null, 0));\nchunkLoadingGlobal.push = webpackJsonpCallback.bind(null, chunkLoadingGlobal.push.bind(chunkLoadingGlobal));","// startup\n// Load entry module and return exports\n// This entry module depends on other loaded chunks and execution need to be delayed\n__webpack_require__.O(undefined, [121], () => (__webpack_require__(73971)))\n__webpack_require__.O(undefined, [121], () => (__webpack_require__(54422)))\n__webpack_require__.O(undefined, [121], () => (__webpack_require__(91864)))\n__webpack_require__.O(undefined, [121], () => (__webpack_require__(8142)))\n__webpack_require__.O(undefined, [121], () => (__webpack_require__(19876)))\n__webpack_require__.O(undefined, [121], () => (__webpack_require__(84979)))\n__webpack_require__.O(undefined, [121], () => (__webpack_require__(61516)))\n__webpack_require__.O(undefined, [121], () => (__webpack_require__(80879)))\n__webpack_require__.O(undefined, [121], () => (__webpack_require__(1697)))\n__webpack_require__.O(undefined, [121], () => (__webpack_require__(55972)))\n__webpack_require__.O(undefined, [121], () => (__webpack_require__(64508)))\n__webpack_require__.O(undefined, [121], () => (__webpack_require__(55667)))\n__webpack_require__.O(undefined, [121], () => (__webpack_require__(20475)))\n__webpack_require__.O(undefined, [121], () => (__webpack_require__(62077)))\n__webpack_require__.O(undefined, [121], () => (__webpack_require__(745)))\n__webpack_require__.O(undefined, [121], () => (__webpack_require__(35594)))\n__webpack_require__.O(undefined, [121], () => (__webpack_require__(10771)))\n__webpack_require__.O(undefined, [121], () => (__webpack_require__(44613)))\n__webpack_require__.O(undefined, [121], () => (__webpack_require__(17726)))\n__webpack_require__.O(undefined, [121], () => (__webpack_require__(98270)))\n__webpack_require__.O(undefined, [121], () => (__webpack_require__(68906)))\n__webpack_require__.O(undefined, [121], () => (__webpack_require__(63677)))\n__webpack_require__.O(undefined, [121], () => (__webpack_require__(26413)))\n__webpack_require__.O(undefined, [121], () => (__webpack_require__(65290)))\n__webpack_require__.O(undefined, [121], () => (__webpack_require__(52433)))\n__webpack_require__.O(undefined, [121], () => (__webpack_require__(8238)))\n__webpack_require__.O(undefined, [121], () => (__webpack_require__(88771)))\n__webpack_require__.O(undefined, [121], () => (__webpack_require__(51379)))\n__webpack_require__.O(undefined, [121], () => (__webpack_require__(83484)))\n__webpack_require__.O(undefined, [121], () => (__webpack_require__(6344)))\n__webpack_require__.O(undefined, [121], () => (__webpack_require__(56840)))\n__webpack_require__.O(undefined, [121], () => (__webpack_require__(19194)))\n__webpack_require__.O(undefined, [121], () => (__webpack_require__(26678)))\n__webpack_require__.O(undefined, [121], () => (__webpack_require__(30530)))\n__webpack_require__.O(undefined, [121], () => (__webpack_require__(75617)))\n__webpack_require__.O(undefined, [121], () => (__webpack_require__(50241)))\n__webpack_require__.O(undefined, [121], () => (__webpack_require__(74676)))\n__webpack_require__.O(undefined, [121], () => (__webpack_require__(40669)))\n__webpack_require__.O(undefined, [121], () => (__webpack_require__(68335)))\n__webpack_require__.O(undefined, [121], () => (__webpack_require__(72396)))\n__webpack_require__.O(undefined, [121], () => (__webpack_require__(39303)))\n__webpack_require__.O(undefined, [121], () => (__webpack_require__(10035)))\n__webpack_require__.O(undefined, [121], () => (__webpack_require__(79932)))\n__webpack_require__.O(undefined, [121], () => (__webpack_require__(10500)))\n__webpack_require__.O(undefined, [121], () => (__webpack_require__(13497)))\n__webpack_require__.O(undefined, [121], () => (__webpack_require__(55385)))\n__webpack_require__.O(undefined, [121], () => (__webpack_require__(67582)))\n__webpack_require__.O(undefined, [121], () => (__webpack_require__(60319)))\n__webpack_require__.O(undefined, [121], () => (__webpack_require__(25155)))\n__webpack_require__.O(undefined, [121], () => (__webpack_require__(51596)))\nvar __webpack_exports__ = __webpack_require__.O(undefined, [121], () => (__webpack_require__(25583)))\n__webpack_exports__ = __webpack_require__.O(__webpack_exports__);\n"],"names":["deferred","inProgress","dataWebpackPrefix","ResetPasswordForm","props","state","isLoading","password","this","trim","length","snackbar","error","pgettext","ajax","post","misago","get","apiResponse","callback","rejection","status","ban","showBannedPage","apiError","className","onSubmit","handleSubmit","type","placeholder","disabled","onChange","bindInput","value","loading","Form","PasswordChangedPage","interpolate","username","user","modal","show","SignInModal","getMessage","onClick","showSignIn","React","auth","softSignOut","$","remove","ReactDOM","document","getElementById","complete","addInitializer","name","initializer","mount","after","validateRequired","required","event","changeValue","target","newState","formErrors","errors","validateField","setState","preventDefault","clean","promise","send","then","success","handleSuccess","handleError","validators","optional","validatedFields","hasOwnProperty","push","i","fieldErrors","validate","field","requiredError","validationError","store","local","_store","_local","_modal","syncSession","watchState","getState","isAuthenticated","set","watch","dispatch","signIn","signOut","hide","window","location","search","setTimeout","NavbarBranding","logo","logoXs","text","url","href","src","alt","NavbarExtraMenu","items","role","map","item","index","targetBlank","rel","title","NotificationsDropdownBody","children","showAll","showUnread","unread","Dropdown","NotificationsDropdownBodyPill","active","classnames","NotificationsFetch","filter","data","NotificationsList","results","NavbarNotificationsToggle","id","badge","NavbarNotificationsDropdown","toggle","isOpen","menuClassName","menuAlignRight","NavbarPrivateThreads","NavbarSearchToggle","NavbarSearchDropdown","querySelector","focus","NavbarSiteNavToggle","NavbarSiteNavDropdown","close","SiteNav","NavbarUserNavToggle","size","NavbarUserNavDropdown","UserNav","connect","settings","branding","logo_small","logo_text","extraMenuItems","email","avatars","unreadNotifications","unreadPrivateThreads","unread_private_threads","searchUrl","notificationsUrl","privateThreadsUrl","authDelegated","enable_oauth2_client","showSearch","acl","can_search","showPrivateThreads","can_use_private_threads","overlay","SignInButton","RegisterButton","context","root","getStore","SearchResultsList","ListGroup","SearchMessage","message","SearchResultPost","thread","dangerouslySetInnerHTML","__html","headline","content","category","poster","poster_name","Timestamp","datetime","posted_on","SearchResultUser","rank","joined_on","SearchResults","query","threads","users","count","encodeURIComponent","npgettext","replace","SearchResultsEmpty","SearchResultsError","detail","errorDetail","gettext","SearchResultsLoading","CACHE","SearchFetch","debounce","clearTimeout","Api","cache","resultsCount","forEach","result","isResultEmpty","SearchInput","setQuery","SearchQuery","SearchDropdown","open","Overlay","onOpen","polls","init","tick","now","Date","diff","Math","ceil","abs","round","date","timeout","scheduleNextUpdate","displayed","narrow","dateRelativeShort","dateRelative","fullDateTime","format","styleName","header","storage","element","_element","_component","component","addClass","removeClass","dropdown","before","unsetBeforeUnload","_props","_isOpen","_isClosing","_mount","classList","_observer","unobserve","_spacer","style","height","_mode","_ajax","_snackbar","ResizeObserver","entries","contentRect","_beforeunloadSet","addEventListener","beforeUnload","capture","removeEventListener","returnValue","mode","submit","_realOpen","Object","assign","config","confirm","add","observe","setBeforeUnload","addReducer","reducer","initialState","MODERATION_PERMISSIONS","hydrateThread","moderation","thread_acl","options","perm","action","concatUnique","sort","sorting","itemCategory","categoriesMap","lft","rght","weight","patchedState","patch","updateSearch","urlQuery","indexOf","substring","history","pushState","q","providers","provider","updateUsers","updatePosts","PageHeader","FlexRow","auto","onQueryChange","shrink","activeClassName","to","icon","Badge","PageContainer","SearchTime","time","p","copy","isReady","posts","LoadMore","isBusy","api","page","next","appendPosts","updateProvider","more","Blankslate","components","route","cols","select","paths","path","TYPES_CLASSES","info","warning","Snackbar","snackbarClass","isVisible","getSnackbarClass","localStorage","prefix","_prefix","_watchers","e","newValueJson","JSON","parse","newValue","watcher","key","oldValue","setItem","stringify","itemString","getItem","bytes","roundSize","toFixed","body","closest","selector","getAttribute","scrollIntoView","behavior","ALPHA","ALPHA_LEN","getRandomString","len","chars","floor","random","join","isAnonymous","captcha","include","m","RequestLinkForm","isValid","code","LinkSent","reset","RequestActivationLink","_polls","kwargs","stop","poll","poolServer","_stopped","update","frequency","delayed","pollId","OPEN_SITE_NAV","OPEN_SEARCH","OPEN_NOTIFICATIONS","OPEN_PRIVATE_THREADS","OPEN_USER_NAV","CLOSE","openSiteNav","openSearch","openNotifications","openUserNav","siteNav","notifications","privateThreads","userNav","_include","_isLoaded","inputs","zxcvbn","score","_loadedPromise","_loadingPromise","self","Promise","resolve","reject","wait","tries","showActivation","form","append","find","val","getCsrfToken","pathname","buttonLabel","formLabel","labelClassName","getActivationButton","contains","menu","prevState","handleClick","prevProps","onClose","ref","aria","ariaProps","DropdownDivider","DropdownFooter","listItem","DropdownHeader","DropdownMenuItem","DropdownPills","DropdownSubheader","getPageUrl","baseUrl","slug","pages","trackedPeriod","days","getEmptyMessage","hiddenOnMobile","getClassName","width","css_class","is_tab","rankUrl","size2x","getUserStatus","getRankName","getUserTitle","counter","meta","posters","getLeadMessage","hydrate","isLoaded","tracked_period","has","initWithPreloadedData","pop","initWithoutPreloadedData","startPolling","start","list","extra","parent","string","subString","toLowerCase","n","pos","step","stringCount","showStatus","first","previous","last","Toolbar","params","nextProps","description","html","getRankDescription","getComponent","WithDropdown","Rank","ActivePosters","Users","rowWidth","padding","rows","row","BUSY_THREAD","RELEASE_THREAD","REPLACE_THREAD","UPDATE_THREAD","UPDATE_THREAD_ACL","json","started_on","moment","last_post_on","best_answer_marked_on","busy","release","updateAcl","REMOVE_POLL","REPLACE_POLL","_timeout","hideSnackbar","alert","showSnackbar","getSrc","srcSet","avatar","av","resolveAvatarForSize","participants","REPLACE_SEARCH","UPDATE_SEARCH","UPDATE_SEARCH_PROVIDER","int","min","max","helpText","getHelpText","PanelMessage","PostingQuoteSelection","range","getQuoteSelection","rect","getBoundingClientRect","posting","globalState","getGlobalState","quote","getQuoteMarkup","focusEditor","default","onMouseUp","selected","onTouchEnd","position","left","scrollX","top","bottom","scrollY","reply","textarea","selectionStart","selectionEnd","container","getSelection","selection","rangeCount","getRangeAt","isRangeContained","isPostContained","isAnyTextSelected","cloneContents","node","commonAncestorContainer","parentNode","nodeName","dataset","noquote","childNodes","child","nodeType","Node","TEXT_NODE","textContent","metadata","getQuoteMetadata","markup","convertNodesToMarkup","suffix","codeBlock","getQuoteCodeBlock","syntax","isNodeInlineCodeBlock","isNodeElementWithQuoteMetadata","getQuoteMetadataFromNode","ELEMENT_NODE","block","author","isNodeCodeBlock","getNodeCodeBlockMeta","nodes","stack","convertNodeToMarkup","SIMPLE_NODE_MAPPINGS","H1","H2","H3","H4","H5","H6","STRONG","EM","DEL","B","U","I","SUB","SUP","toUpperCase","innerText","level","misagoReply","setGlobalState","clearGlobalState","attachments","attachment","isRemoved","a","MarkupAttachmentModal","is_image","filename","filetype","formatFilesize","uploaded_on","fromNow","uploader","uploader_name","wrapSelection","def","caret","setSelectionRange","replaceSelection","end","createRange","moveStart","scroll","scrollTop","progress","thumb","getAttachmentMarkup","canProtect","empty","preview","isProtected","submitText","showPreview","closePreview","enableProtection","disableProtection","MarkupCodeModal","ev","for","label","LANGUAGES","validation","undefined","MarkupFormattingHelpModal","ExampleFormatting","ExampleFormattingSpoiler","reveal","URL_PATTERN","RegExp","isUrl","str","test","textUrl","file","maxSize","max_attachment_size","limit","upload","concat","refreshState","FormData","updateAttachments","actions","insertSpoiler","input","createElement","multiple","files","uploadFile","click","parsed","stopPropagation","dataTransfer","onAttachmentsChange","clipboardData","kind","getAsFile","focused","atwho","at","displayTpl","insertTpl","searchKey","callbacks","remoteFilter","getJSON","on","_storage","source","controller","substr","headPos","endPos","setMentions","onDrop","onFocus","onPaste","onBlur","post_length_min","CLASS_ACTIVE","CLASS_DEFAULT","CLASS_MINIMIZED","CLASS_FULLSCREEN","fullscreen","minimized","minimize","fullscreenEnter","fullscreenExit","PostingThreadOptions","isClosed","isHidden","isPinned","unhide","pinGlobally","pinLocally","unpin","icons","closed","hidden","pinned","getIcons","pin","categories","categoryOptions","getTitleValidators","getPostValidators","loadSuccess","loadError","non_field_errors","dialogProps","onCancel","PostingDialogStart","showOptions","onTitleChange","choices","onCategoryChange","onHide","onUnhide","onPinGlobally","onPinLocally","onUnpin","onPostChange","usernames","removedBlanks","split","cleanUsernames","PostingDialogStartPrivate","onToChange","quoteText","newPost","onQuote","newContext","appendData","PostingDialogReply","method","originalPost","protect","is_protected","can_protect","originalPostSameAsCurrentPost","noAttachementsAdded","put","PostingDialogEditReply","ytRegExp","highlightCode","embedYoutubePlayers","_youtube","hljs","codeblocks","querySelectorAll","highlightElement","anchors","onlyChild","parseYoutubeUrl","youtubeMovie","swapYoutubePlayer","youtube","video","player","replaceWith","wrap","cleanedUrl","cleanUrl","match","getVideoIdFromUrl","timebit","bits","parseInt","onebox","render","documentNode","revealSpoiler","nextState","btn","webpackContext","req","webpackContextResolve","__webpack_require__","o","Error","keys","module","exports","BaseCaptcha","_context","NoCaptcha","QACaptcha","question","help_text","labelClass","controlClass","ReCaptchaComponent","grecaptcha","sitekey","siteKey","response","binding","ReCaptcha","recaptcha_site_key","captcha_type","_captcha","load","validator","ADD_NAME_CHANGE","APPEND_HISTORY","HYDRATE_HISTORY","addNameChange","change","changedBy","hydrateNamechange","namechange","changed_on","slice","unshift","changed_by","changed_by_username","new_username","old_username","UPDATE_AVATAR","userId","UPDATE_USERNAME","Button","defaultProps","array","indexTitle","forumName","_indexTitle","_forumName","finalTitle","callApi","avatarType","onComplete","showError","gravatar","setGravatar","crop_src","showCrop","showUpload","galleries","showGallery","userPeview","getAvatarPreview","getGravatarButton","setGenerated","getCropButton","getUploadButton","getGalleryButton","cropit","deviceRatio","cropitOffset","crop","offset","x","y","zoom","crop_tmp","dataUrl","cropperWidth","getAvatarSize","initialWidth","exportZoom","imageState","getImagePath","onImageLoaded","zoomLevel","imageSize","offsetX","offsetY","cropAvatar","showIndex","image","validateFile","URL","createObjectURL","uploaded","filesize","fileSize","invalidTypeMsg","allowed_mime_types","extensionFound","loweredFilename","allowed_extensions","extension","extensions","pickFile","getUploadRequirements","getUploadProgressLabel","getUploadProgress","renderCrop","renderUpload","GalleryItem","Gallery","batch","images","save","ChangeAvatarError","reason","getErrorReason","AvatarIndex","AvatarUpload","AvatarCrop","AvatarGallery","updateAvatar","completeFlow","getBody","logout","UserNavMenu","selectAvatar","ChangeAvatarModal","optionsMore","adminUrl","changeAvatar","revealOptions","UserNavDropdown","is_banned","is_hidden","is_online_hidden","is_offline_hidden","is_online","is_offline","getClass","StatusIcon","getIcon","StatusLabel","banned_until","ban_expires","last_click","getHelp","getLabel","STYLES","LABELS","_score","_password","_inputs","loaded","cacheStale","scorePassword","getScore","RegisterForm","handleToggleAgreement","agreement","criteria","passwordMinLength","min_length","formValidators","max_length","termsOfService","privacyPolicy","terms_of_service","privacy_policy","__all__","display","StartSocialAuth","buttonClassName","RegisterLegalFootnote","onPrivacyPolicyChange","handlePrivacyPolicyChange","onTermsOfServiceChange","handleTermsOfServiceChange","RegisterComplete","activation","getLead","getSubscript","completeRegistration","account_activation","all","showRegisterForm","minLength","thread_title_length_min","limitValue","limit_value","show_value","maxLength","thread_title_length_max","post_length_max","validatePostLengthMin","FormHeader","socialAuth","pk","button_text","button_color","color","finalButtonLabel","site","Status","JoinDate","Posts","Threads","Followers","getStatClassName","followers","stat","userTitle","colClassName","Array","apply","Number","call","APPEND_POSTS","SELECT_POST","DESELECT_POST","DESELECT_POSTS","LOAD_POSTS","UNLOAD_POSTS","UPDATE_POSTS","deselect","deselectAll","hydratePost","isSelected","unload","selectedPosts","deseletedPosts","deseletedAllPosts","resultsIds","PATCH_POST","reducedPosts","postReducer","attr","BUSY_POLL","RELEASE_POLL","UPDATE_POLL","hasSelectedChoices","endsOn","setInterval","doTick","repeat","_reducers","_initialState","createStore","combineReducers","expires_on","profile","user_message","staff_message","isAfter","getUserMessage","getStaffMessage","getExpirationMessage","getPanelBody","fieldname","fields","groups","group","f","initial","onSuccess","CancelButton","cancel","FormDisplay","SafeValue","onEdit","showEditButton","details","editing","newDetails","loadDetails","profileDetails","edit","edit_details","loadItems","Feed","loadMore","emptyMessage","LoadMoreButton","loadUsers","setSpecialProps","PRELOADED_DATA_KEY","TITLE","API_FILTER","apiUrl","getMoreButton","getListBody","renderUserAvatar","renderUsername","changes","loadChanges","is_followed","follow","canMessage","can_start_private_threads","isProfileOwner","is_avatar_locked","avatar_lock_user_message","avatar_lock_staff_message","moderate_avatar","avatar_hash","iconOn","iconOff","labelOn","labelOff","getFormBody","getModalBody","moderate_username","updateUsername","countdown","isDeleted","with_content","getButtonLabel","getDeletedBody","getForm","AvatarControls","ChangeUsername","DeleteAccount","showAvatarDialog","rename","showRenameDialog","showDeleteDialog","is_active","ProfileModerationButton","available","getModeration","can_follow","delete","is_anonymous","can_rename","can_moderate_avatar","can_delete","COMPONENTS","follows","Follows","Details","UsernameHistory","BanDetails","Profile","NotificationsOverlayBody","NotificationsOverlayBodyPill","NotificationsOverlay","reload","signedIn","signedOut","refresh","AuthMessage","RequestResetForm","showInactivePage","AccountInactivePage","getActivateButton","RequestPasswordReset","UPDATE_AUTHENTICATED_USER","PATCH_USER","SIGN_IN","SIGN_OUT","updateAuthenticatedUser","soft","updatedState","BODY_CLASS","scrollOrigin","pageYOffset","scrollTo","closeOnNavigation","NotificationsHeader","subtitle","parts","forum_name","PillsNav","PillsNavLink","link","NotificationsPills","basename","NotificationsPagination","NotificationsPaginationLink","hasPrevious","firstCursor","lastCursor","hasNext","NotificationsToolbar","markAllAsRead","getSubtitle","getBaseUrl","refetch","readAll","mutating","toolbarProps","onError","replaceState","browserHistory","routes","NotificationsRoute","startsWith","ApiFetch","onData","fetch","credentials","signal","setCache","headers","request","mutation","AbortController","urlChanged","disabledChanged","abort","hasCache","getCache","ApiMutation","mutate","csrfToken","cookieName","misago_csrf","cookie","cookieRegex","ListGroupItem","ListGroupEmpty","ListGroupError","ListGroupLoading","ListGroupMessage","DELEGATE_AUTH","LOGIN_URL","op","ModalHeader","onUsernameChange","can_add_participants","participant","confirmed","isUser","is_owner","can_change_owner","isModerator","can_moderate_private_threads","userIsOwner","UserStatus","isOwner","getUserIsOwner","utils","choice","PollChoice","hash","proc","votes","getVotesLabel","ChoiceVotes","UserChoice","hydratedData","voters","voter","voted_on","ModalBody","ChoicesList","ChoiceDetails","VotesCount","VotesList","Voter","VoteDate","isPollOver","showVoting","is_public","can_edit","can_see_votes","can_vote","allow_revotes","controls","canVote","canChangeVote","ChangeVote","SeeVotes","Edit","Delete","control","newThreadAcl","DATE_ABBR","PollVotes","PollLength","PollIsPublic","PollCreation","escapeHtml","getPoster","getPostedOn","absolute","relative","ends_on","getEndsOn","PollChoicesLeft","choicesLeft","PollAllowRevote","ChoiceSelect","toggleChoice","getChoicesLeft","allowed_choices","getChoiceFromHash","deselectChoice","selectChoice","showResults","getIsPollOver","setChoices","canDelete","onDelete","onAdd","every","isEdit","PollPublicSwitch","ICON","changed_title","pinned_globally","pinned_locally","unpinned","moved","merged","approved","opened","unhid","hid","changed_owner","tookover","added_participant","owner_left","participant_left","removed_participant","event_type","can_hide","Hide","Unhide","hidden_on","hidden_by_name","hidden_by","USER_SPAN","USER_URL","Hidden","Poster","event_by","event_on","MESSAGE","ITEM_LINK","ITEM_SPAN","ChangedTitle","Moved","Merged","ChangedOwner","AddedParticipant","RemovedParticipant","msgstring","oldTitle","event_context","old_title","fromCategory","from_category","mergedThread","merged_thread","newOwner","is_read","initialized","observer","IntersectionObserver","entry","isIntersecting","primed","read","destroy","disconnect","ready","initialize","AttachmentPreview","AttachmentDetails","AttachmentThumbnail","AttachmentIcon","backgroundImage","can_see_hidden","Row","Default","Invalid","FlagBestAnswer","best_answer","best_answer_marked_by","marked_on","marked_by","best_answer_marked_by_name","FlagHidden","FlagUnapproved","is_unapproved","FlagProtected","ops","previousState","markAsBestAnswer","best_answer_is_protected","best_answer_marked_by_slug","patchThread","likes","hydrateLike","ModalDialog","LikesList","liked_on","likesCount","like","LikeDetails","liker_id","LikeDate","likedOn","can_reply","can_see_likes","last_likes","can_like","MarkAsBestAnswer","MarkAsBestAnswerCompact","Like","Likes","lastLikes","LikesCompact","Reply","Quote","can_mark_best_answer","can_mark_as_best_answer","can_change_best_answer","concatedLikes","finalLikes","is_liked","hasLikes","getLikesMessage","u","hiddenLikes","otherUsers","lastUser","usernamesList","last_user","editor","move","new_thread","onUrlChange","DiffItem","revertEdit","canRevert","goToEdit","GoBackBtn","goBack","GoForwardBtn","goForward","GoLastBtn","goLast","Label","RevertBtn","editor_name","edited_on","edited_by","edits","hydratedPost","PostingConfig","ModerationForm","isError","Loader","categoryId","can_pin_threads","can_hide_threads","can_close_threads","is_closed","isHiddenChoices","isClosedChoices","getWeightChoices","Modal","renderWeightField","renderHiddenField","renderClosedField","Permalink","UnmarkMarkBestAnswer","PostEdits","Approve","Move","Split","Protect","Unprotect","permaUrl","protocol","host","prompt","can_unmark_best_answer","isUnedited","can_approve","can_move","can_unhide","can_merge_posts","UnreadLabel","UnreadCompact","PostedOn","PostedOnCompact","PostEditsCompacts","ProtectedLabel","toISOString","tooltip","postAuthor","hasAcl","hasVisibleTitle","ListItem","is_event","has_poll","has_unapproved_posts","replies","starter","starter_name","timestamp","handleSuccessUnmounted","bestAnswer","BestAnswerSelect","bestAnswers","onBestAnswerChange","PollSelect","onPollChange","best_answers","merge","other_thread","post_set","ModalMessage","ModalLoading","successMessage","changeTitle","approve","dropup","stickToBottom","setNotifications","short_name","special_role","breadcrumbs","hasFlags","is_authenticated","enabled","resetScroll","ThreadPaginatorConnected","withRouter","router","scrollToTop","formData","PostErrors","heading","ids","rollback","isArray","Merge","can_merge","onReply","compact","is_new","new_post","unapproved_post","last_post","pollDisabled","onPoll","can_start_poll","setPageTitle","editPoll","shouldFetchData","fetchData","startPollingApi","stopPollingApi","threadModeration","getThreadModeration","postsModeration","getPostsModeration","openPollForm","openReplyForm","closePollForm","can_close","can_pin_globally","can_pin","can_unprotect","basePath","Route","staticUrl","_staticUrl","_included","script","remote","dataType","TICK","SHOW_SNACKBAR","HIDE_SNACKBAR","messageType","isOrdered","_items","order","values","values_only","_order","unordered","ordered","ordering","insertItem","insertAt","splice","iterations","useLoader","silent","requests","onRemoveSelection","onAction","htmx","swap","checked","tagName","onLoad","button","registerEvents","registerActions","_shadow","shadow","_getShadowElement","rectControl","setAttribute","innerHTML","marker","appendChild","rectShadow","rectMarker","right","_createShadowElement","ariaHidden","opacity","zIndex","getQueryBoundingClientRect","KEY_CANCEL","Space","MetaLeft","MetaRight","End","Enter","ArrowUp","ArrowDown","ArrowLeft","ArrowRight","KEY_SELECT","Escape","visible","keyCancel","handleKey","getQuery","showSuggestions","_debounce","onSelect","console","warn","delay","debounced","isEventTarget","anchor","keyOverride","onKeyDown","onKeyUp","keyCode","maxChoice","updateActiveChoice","relatedTarget","updateChoices","getTarget","computePosition","placement","middleware","flip","shift","avatarsHd","img","span","replaceChildren","getHttpResponseErrorMessage","getResponseHeader","removeSnackbars","renderSnackbars","SNACKBAR_TTL","httpResponseError","_users","showErrors","exclude","ok","misago_suggest_users","deleteElement","animationName","slideUpElement","duration","clientHeight","overflow","requestAnimationFrame","onFrame","animation","sin","PI","registerElementValidator","strip","csrf","setFormControlValidationState","callValidationUrl","clearFormControlValidationMessages","clearFormControlValidationState","setFormControlErrorValidationState","setFormControlSuccessValidationState","isEventVisible","requestConfig","verb","xhr","templates","defineExtension","onEvent","template","el","getClosestAttribute","getLoaderTemplate","cloneNode","updateTimestamp","hasAttribute","updateTimestamps","Lightbox","pager","download","caption","_registerEvents","_onDOMContentLoaded","onImageClick","onMediaButtonClick","onHideLightbox","total","media","updateLightbox","getInitialState","showLightbox","getRootMedia","updateLightboxPager","updateLightboxOptions","updateLightboxNav","updateLightboxContainer","updateLightboxCaption","updateLightboxOption","updateLightboxContainerWithImage","updateLightboxContainerWithVideo","removeAttribute","nameText","cleanDisplayFilename","shortenLongString","cleanDisplayUrl","slash","lastIndexOf","pause","RE_LOOKBACK","RE_LOOKAHEAD","prefixMatch","suffixMatch","prefixMatchClean","suffixMatchClean","autocomplete","Autocomplete","sources","SelectUser","AnchorInput","CSRF_FIELD_NAME","renderTemplate","variable","getVariableValue","part","MarkupEditorUploader","getTextarea","lists","other","mediaFooter","mediaFailedFooter","otherFailed","otherUploaded","attachmentsElement","accept","_getAcceptedExtensions","uploadUrl","_getUploadUrl","canUpload","insert","uploadFiles","allowedFiles","_isFileTypeAccepted","elements","ALPHABET","_createUploadUI","_insertAttachmentsInTextarea","XMLHttpRequest","_addOnLoadedEventListener","_addOnProgressEventListener","_isFileTypeInList","whitespace","readyState","DONE","_handleUploadSuccess","_handleUploadError","_replaceTextareaPlaceholders","_updateUploadUIWithError","_updateUploadUI","_createAttachmentIDField","lengthComputable","progressBar","replaceAttachments","isImage","isVideo","_isFileTypeImage","_createMediaUploadUI","_isFileTypeVideo","_createOtherUploadUI","getAttachmentByKey","buffer","FileReader","onload","readAsDataURL","_addUIToAttachmentsList","prepend","_updateMediaUploadUI","_updateOtherUploadUI","footer","_createErrorMessage","insertAfter","errorTemplate","MarkupEditorModal","getElement","initForm","setData","MarkupEditorLinkModal","isUnsafeForMarkdown","MarkupEditorImageModal","MarkupEditorQuoteModal","getQuotePrefix","MarkupEditorCodeModal","getCodePrefix","args","getCodeArguments","delimiter","getCodeDelimiter","cleanInfo","cleanSyntax","MarkupEditor","_resizeEditor","constraints","_getResizeConstraints","firstToolbar","secondToolbar","moreBtn","takenSpace","priority","clientWidth","toolbar","b","btnWidth","childWidth","childStyle","getComputedStyle","parseFloat","borderLeftWidth","borderRightWidth","marginLeft","marginRight","toolbarWidth","parentElement","_setEditorActive","_setEditorFocus","_setEditorActions","_setEditorPasteUpload","_setEditorDropUpload","mentions","Mention","showPermissionDeniedError","codeModal","linkModal","imageModal","quoteModal","resizeDebounce","_onWindowResize","focusEvents","actionName","MarkupEditorSelection","animations","_range","_getRange","refocus","trimEnd","whitespaces","p1","String","_createRange","setAction","showLinkModal","showImageModal","showQuoteModal","showCodeModal","showFilePrompt","removeAttachmentElement","activatePollChoicesControl","maxChoices","newChoices","nextElementSibling","newListItem","newInput","QuoteCursorPosition","tether","createShadow","rangeClone","cloneRange","setStart","rangeRect","getPropertyValue","findTether","shadowRect","tetherRect","tetherOffset","rules","func","QuoteSelection","extractor","renderer","postprocess","extractNodes","postprocessNodes","renderNodes","posMax","r","rule","beforeName","afterName","getQuotedCode","lines","splitLines","cleanLines","line","trimCodeBlankLines","dedent","lineDedent","trimStart","dedentTrimCode","getCodeTextContent","HEADER_NODES","getTableCellMeta","alignment","blockquote","tables","from","table","wrapNodesInQuote","ancestor","fixTableHeader","head","cell","_","fixTableColumns","fixTable","rowset","thead","tbody","td","spoiler","escapeBBCodeArg","arg","escapeQuotes","escapeBrackets","escapeBackslash","escapeMarkdownLink","replaceAll","getTableCellText","lengths","table_row","col","lineIndex","escapeBBCodeContents","TABLE_NODES","TABLE","THEAD","TBODY","TR","TH","TD","LIST_NODES","OL","UL","LI","cursor","selectNode","setEnd","onSelectStart","onSelectEnd","onSelectChange","createToolbar","selecting","updateSelection","updateState","showToolbar","hideToolbar","clearState","navigator","clipboard","writeText","Ruleset","extractorRules","postprocessRules","rendererRules","tetherRules","isCollapsed","getRange","getRangeRoot","getSelectionQuote","Range","startContainer","startOffset","endContainer","endOffset","getCommonAncestor","getQuote","createToolbarButton","copyQuote","btnIcon","btnText","getPosition","copyCode","snackbars","updateTabGroups","oldNav","newNav","nav","oldTab","newTab","tabs","tab","findTab","CustomEvent","bubbles","dispatchEvent","updateTabGroup","DATA_ATTRIBUTE_ELEMENT","SELECTOR_ELEMENT","SELECTOR_INPUT","CLASS_NAME_FOCUS","EVENT_FOCUS","KEY_OVERRIDE","singleton","updateInputDisabled","reverse","eventName","blur","deleteItem","backspacePressed","lastItem","previousElementSibling","activate","loader","AjaxLoader","lightbox","historyEnabled","historyCacheSize","_initializers","tabGroups","userMultipleChoice","OrderedList","orderedValues","fallback","BulkModeration","plain","expires","getReasonMessage","RedrawedBannedPage","BannedPage","changeState","locale","misago_locale","momentAgo","momentAgoShort","dayAt","soonAt","tomorrowAt","yesterdayAt","minutesShort","hoursShort","daysShort","relativeNumeric","Intl","RelativeTimeFormat","numeric","DateTimeFormat","dateStyle","timeStyle","thisYearDate","month","day","otherYearDate","year","weekday","shortTime","thisYearShort","otherYearShort","absDiff","sign","minutes","hours","isSameDay","yesterday","setDate","getDate","isYesterday","isTomorrow","formatDayAtTime","getFullYear","getMonth","getApiUrl","LOAD_DETAILS","isValidated","htmlFor","getFeedbackDescription","getFeedback","LegalAgreement","agreementHtml","termsOfServiceId","termsOfServiceUrl","privacyPolicyId","privacyPolicyUrl","forum_index_title","AcceptAgreement","submiting","handleDecline","handleAccept","getChoice","Icon","rootElement","childRoutes","onEnter","REPLACE_PARTICIPANTS","EMAIL","USERNAME","USERNAME_ALPHANUMERIC","requiredTermsOfService","requiredPrivacyPolicy","returnMessage","usernameMinLength","lengthMin","usernameMaxLength","lengthMax","usernameContent","valueTrimmed","SiteNavMenuConnected","mainItems","extraItems","extraFooterItems","topNav","footerNav","tosTitle","tosUrl","privacyTitle","privacyUrl","is_vanilla","SiteNavDropdown","AUTH_SYNC_RATE","_cookieName","_csrfToken","_locks","contentType","jqXHR","responseJSON","statusText","lock","param","waiter","processData","evt","isControlled","isActive","Component","rootElementId","connected","finalComponent","updated_on","hydrateAttachment","hydrateUser","NotificationsListEmpty","NotificationsListGroup","NotificationsListItemActor","notification","actor","actor_name","NotificationsListItemMessage","isRead","NotificationsListItemReadStatus","NotificationsListItemTimestamp","createdAt","NotificationsListItem","NotificationsListError","NotificationsListLoading","HYDRATE_PROFILE","PATCH_PROFILE","hydrateStatus","APPEND_USERS","HYDRATE_USERS","backendName","pageTitleTpl","pageTitle","backend","Register","emailProtected","onRegistrationComplete","stateUpdate","backend_name","emailHelpText","emailHelpTextTpl","SocialAuth","handleRegistrationComplete","__webpack_module_cache__","moduleId","cachedModule","__webpack_modules__","O","chunkIds","fn","notFulfilled","Infinity","fulfilled","j","getter","__esModule","d","definition","defineProperty","enumerable","chunkId","reduce","promises","miniCssF","g","globalThis","Function","hmd","create","obj","prop","prototype","l","done","needAttach","scripts","getElementsByTagName","s","charset","nc","onScriptComplete","prev","onerror","doneFns","removeChild","bind","Symbol","toStringTag","nmd","scriptUrl","importScripts","currentScript","installedChunks","installedChunkData","errorType","realSrc","webpackJsonpCallback","parentChunkLoadingFunction","moreModules","runtime","some","chunkLoadingGlobal","__webpack_exports__"],"sourceRoot":""}