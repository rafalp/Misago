(()=>{var e,t,n,a={745:(e,t,n)=>{"use strict";var a,i=n(73971),o=n(9417),r=n(64467),s=n(73620),u=n(23029),l=n(92901),c=n(15361),d=n(61801),p=n(53954),h=n(40927),m=n.n(h),f=n(40961),v=n.n(f),A=n(39227),g=n(849),y=n(24832),b=n(92069),D=n(1657),x=n(70490),k=n(29904),_=n(74017),N=n(74692);function C(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,a=(0,p.A)(e);if(t){var i=(0,p.A)(this).constructor;n=Reflect.construct(a,arguments,i)}else n=a.apply(this,arguments);return(0,d.A)(this,n)}}var E=function(e){(0,c.A)(n,e);var t=C(n);function n(e){var a;return(0,u.A)(this,n),(a=t.call(this,e)).state={isLoading:!1,password:""},a}return(0,l.A)(n,[{key:"clean",value:function(){return!!this.state.password.trim().length||(k.A.error(pgettext("password reset form","Enter new password.")),!1)}},{key:"send",value:function(){return b.A.post(i.A.get("CHANGE_PASSWORD_API"),{password:this.state.password})}},{key:"handleSuccess",value:function(e){this.props.callback(e)}},{key:"handleError",value:function(e){403===e.status&&e.ban?(0,_.A)(e.ban):k.A.apiError(e)}},{key:"render",value:function(){return(0,s.A)("div",{className:"well well-form well-form-reset-password"},void 0,(0,s.A)("form",{onSubmit:this.handleSubmit},void 0,(0,s.A)("div",{className:"form-group"},void 0,(0,s.A)("div",{className:"control-input"},void 0,(0,s.A)("input",{type:"password",className:"form-control",placeholder:pgettext("password reset form field","Enter new password"),disabled:this.state.isLoading,onChange:this.bindInput("password"),value:this.state.password}))),(0,s.A)(A.A,{className:"btn-primary btn-block",loading:this.state.isLoading},void 0,pgettext("password reset form btn","Change password"))))}}]),n}(g.A),w=function(e){(0,c.A)(n,e);var t=C(n);function n(){return(0,u.A)(this,n),t.apply(this,arguments)}return(0,l.A)(n,[{key:"getMessage",value:function(){return interpolate(pgettext("password reset form","%(username)s, your password has been changed."),{username:this.props.user.username},!0)}},{key:"showSignIn",value:function(){x.A.show(y.A)}},{key:"render",value:function(){return(0,s.A)("div",{className:"page page-message page-message-success page-forgotten-password-changed"},void 0,(0,s.A)("div",{className:"container"},void 0,(0,s.A)("div",{className:"message-panel"},void 0,a||(a=(0,s.A)("div",{className:"message-icon"},void 0,(0,s.A)("span",{className:"material-icon"},void 0,"check"))),(0,s.A)("div",{className:"message-body"},void 0,(0,s.A)("p",{className:"lead"},void 0,this.getMessage()),(0,s.A)("p",{},void 0,pgettext("password reset form","Sign in using new password to continue.")),(0,s.A)("p",{},void 0,(0,s.A)("button",{type:"button",className:"btn btn-primary",onClick:this.showSignIn},void 0,pgettext("password reset form btn","Sign in")))))))}}]),n}(m().Component),F=function(e){(0,c.A)(n,e);var t=C(n);function n(){var e;(0,u.A)(this,n);for(var a=arguments.length,i=new Array(a),l=0;l<a;l++)i[l]=arguments[l];return e=t.call.apply(t,[this].concat(i)),(0,r.A)((0,o.A)(e),"complete",function(e){D.A.softSignOut(),N('#hidden-login-form input[name="next"]').remove(),v().render((0,s.A)(w,{user:e}),document.getElementById("page-mount"))}),e}return(0,l.A)(n,[{key:"render",value:function(){return(0,s.A)(E,{callback:this.complete})}}]),n}(m().Component),R=n(92979);i.A.addInitializer({name:"component:reset-password-form",initializer:function(){document.getElementById("reset-password-form-mount")&&(0,R.A)(F,"reset-password-form-mount",!1)},after:"store"})},849:(e,t,n)=>{"use strict";n.d(t,{A:()=>f});var a=n(23029),i=n(92901),o=n(9417),r=n(15361),s=n(61801),u=n(53954),l=n(64467),c=n(40927),d=n.n(c),p=n(89077),h=n(29904);var m=(0,p.mw)(),f=function(e){(0,r.A)(d,e);var t,n,c=(t=d,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}(),function(){var e,a=(0,u.A)(t);if(n){var i=(0,u.A)(this).constructor;e=Reflect.construct(a,arguments,i)}else e=a.apply(this,arguments);return(0,s.A)(this,e)});function d(){var e;(0,a.A)(this,d);for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return e=c.call.apply(c,[this].concat(n)),(0,l.A)((0,o.A)(e),"bindInput",function(t){return function(n){e.changeValue(t,n.target.value)}}),(0,l.A)((0,o.A)(e),"changeValue",function(t,n){var a=(0,l.A)({},t,n),i=e.state.errors||{};i[t]=e.validateField(t,a[t]),a.errors=i,e.setState(a)}),(0,l.A)((0,o.A)(e),"handleSubmit",function(t){if(t&&t.preventDefault(),!e.state.isLoading&&e.clean()){e.setState({isLoading:!0});var n=e.send();n?n.then(function(t){e.setState({isLoading:!1}),e.handleSuccess(t)},function(t){e.setState({isLoading:!1}),e.handleError(t)}):e.setState({isLoading:!1})}}),e}return(0,i.A)(d,[{key:"validate",value:function(){var e={};if(!this.state.validators)return e;var t={required:this.state.validators.required||this.state.validators,optional:this.state.validators.optional||{}},n=[];for(var a in t.required)t.required.hasOwnProperty(a)&&t.required[a]&&n.push(a);for(var i in t.optional)t.optional.hasOwnProperty(i)&&t.optional[i]&&n.push(i);for(var o in n){var r=n[o],s=this.validateField(r,this.state[r]);null===s?e[r]=null:s&&(e[r]=s)}return e}},{key:"isValid",value:function(){var e=this.validate();for(var t in e)if(e.hasOwnProperty(t)&&null!==e[t])return!1;return!0}},{key:"validateField",value:function(e,t){var n=[];if(!this.state.validators)return n;var a={required:(this.state.validators.required||this.state.validators)[e],optional:(this.state.validators.optional||{})[e]},i=m(t)||!1;if(a.required){if(i)n=[i];else for(var o in a.required){var r=a.required[o](t);r&&n.push(r)}return n.length?n:null}if(!1===i&&a.optional){for(var s in a.optional){var u=a.optional[s](t);u&&n.push(u)}return n.length?n:null}return!1}},{key:"clean",value:function(){return!0}},{key:"send",value:function(){return null}},{key:"handleSuccess",value:function(e){}},{key:"handleError",value:function(e){h.A.apiError(e)}}]),d}(d().Component)},1657:(e,t,n)=>{"use strict";n.d(t,{A:()=>r});var a=n(23029),i=n(92901),o=n(63426);const r=new(function(){function e(){(0,a.A)(this,e)}return(0,i.A)(e,[{key:"init",value:function(e,t,n){this._store=e,this._local=t,this._modal=n,this.syncSession(),this.watchState()}},{key:"syncSession",value:function(){var e=this._store.getState().auth;e.isAuthenticated?this._local.set("auth",{isAuthenticated:!0,username:e.user.username}):this._local.set("auth",{isAuthenticated:!1})}},{key:"watchState",value:function(){var e=this,t=this._store.getState().auth;this._local.watch("auth",function(n){n.isAuthenticated?e._store.dispatch((0,o.Jv)({username:n.username})):t.isAuthenticated&&e._store.dispatch((0,o.CI)())}),this._modal.hide()}},{key:"signIn",value:function(e){this._store.dispatch((0,o.Jv)(e)),this._local.set("auth",{isAuthenticated:!0,username:e.username}),this._modal.hide()}},{key:"signOut",value:function(){this._store.dispatch((0,o.CI)()),this._local.set("auth",{isAuthenticated:!1}),this._modal.hide()}},{key:"softSignOut",value:function(){this._store.dispatch((0,o.CI)(!0)),this._local.set("auth",{isAuthenticated:!1}),this._modal.hide()}}]),e}())},1697:(e,t,n)=>{"use strict";var a,i=n(73620),o=n(40927),r=n.n(o),s=n(40961),u=n.n(s),l=n(67467),c=n(22926),d=n(41484),p=n(68333),h=n(23029),m=n(92901),f=n(15361),v=n(61801),A=n(53954),g=n(70490),y=n(24832);const b=function(e){(0,f.A)(r,e);var t,n,o=(t=r,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}(),function(){var e,a=(0,A.A)(t);if(n){var i=(0,A.A)(this).constructor;e=Reflect.construct(a,arguments,i)}else e=a.apply(this,arguments);return(0,v.A)(this,e)});function r(){return(0,h.A)(this,r),o.apply(this,arguments)}return(0,m.A)(r,[{key:"componentDidMount",value:function(){"?modal=login"===window.document.location.search&&window.setTimeout(function(){return g.A.show(a||(a=(0,i.A)(y.A,{})))},300)}},{key:"render",value:function(){return null}}]),r}(r().Component);function D(e){var t=e.logo,n=e.logoXs,a=e.text,o=e.url;return t?(0,i.A)("div",{className:"navbar-branding"},void 0,(0,i.A)("a",{href:o,className:"navbar-branding-logo"},void 0,(0,i.A)("img",{src:t,alt:a}))):(0,i.A)("div",{className:"navbar-branding"},void 0,!!n&&(0,i.A)("a",{href:o,className:"navbar-branding-logo-xs"},void 0,(0,i.A)("img",{src:n,alt:a})),!!a&&(0,i.A)("a",{href:o,className:"navbar-branding-text"},void 0,a))}function x(e){var t=e.items;return(0,i.A)("ul",{className:"navbar-extra-menu",role:"nav"},void 0,t.map(function(e,t){return(0,i.A)("li",{className:e.className},t,(0,i.A)("a",{href:e.url,target:e.targetBlank?"_blank":null,rel:e.rel},void 0,e.title))}))}var k,_=n(25913),N=n(9417),C=n(64467),E=n(61092),w=n(93420),F=n(32485),R=n.n(F);function S(e){var t=e.children,n=e.showAll,a=e.showUnread,o=e.unread;return(0,i.A)("div",{className:"notifications-dropdown-body"},void 0,(0,i.A)(_.hO,{},void 0,pgettext("notifications title","Notifications")),(0,i.A)(_.Qb,{},void 0,(0,i.A)(B,{active:!o,onClick:n},void 0,pgettext("notifications dropdown","All")),(0,i.A)(B,{active:o,onClick:a},void 0,pgettext("notifications dropdown","Unread"))),t,(0,i.A)(_.Xy,{},void 0,(0,i.A)("a",{className:"btn btn-default btn-block",href:misago.get("NOTIFICATIONS_URL")},void 0,pgettext("notifications","See all notifications"))))}function B(e){var t=e.active,n=e.children,a=e.onClick;return(0,i.A)("button",{className:R()("btn",{"btn-primary":t,"btn-default":!t}),type:"button",onClick:a},void 0,n)}const L=function(e){(0,f.A)(o,e);var t,n,a=(t=o,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}(),function(){var e,a=(0,A.A)(t);if(n){var i=(0,A.A)(this).constructor;e=Reflect.construct(a,arguments,i)}else e=a.apply(this,arguments);return(0,v.A)(this,e)});function o(e){var t;return(0,h.A)(this,o),t=a.call(this,e),(0,C.A)((0,N.A)(t),"render",function(){return(0,i.A)(S,{unread:t.state.unread,showAll:function(){return t.setState({unread:!1})},showUnread:function(){return t.setState({unread:!0})}},void 0,(0,i.A)(E.A,{filter:t.state.unread?"unread":"all",disabled:!t.props.active},void 0,function(e){var n=e.data,a=e.loading,o=e.error;return a?k||(k=(0,i.A)(w.BG,{})):o?(0,i.A)(w.n8,{error:o}):(0,i.A)(w.$y,{filter:t.state.unread?"unread":"all",items:n?n.results:[]})}))}),t.state={unread:!1,url:""},t}return(0,m.A)(o,[{key:"getApiUrl",value:function(){return misago.get("NOTIFICATIONS_API")+"?limit=20"+(this.state.unread?"&filter=unread":"")}}]),o}(r().Component);function T(e){var t=e.id,n=e.className,a=e.badge,o=e.url,r=e.active,s=e.onClick,u=a?pgettext("navbar","You have unread notifications!"):pgettext("navbar","Open notifications");return(0,i.A)("a",{id:t,className:R()("btn btn-navbar-icon",n,{active:r}),href:o,title:u,onClick:s},void 0,!!a&&(0,i.A)("span",{className:"navbar-item-badge"},void 0,a),(0,i.A)("span",{className:"material-icon"},void 0,a?"notifications_active":"notifications_none"))}function O(e){var t=e.id,n=e.className,a=e.badge,o=e.url;return(0,i.A)(_.ms,{id:t,toggle:function(e){var t=e.isOpen,r=e.toggle;return(0,i.A)(T,{className:n,active:t,badge:a,url:o,onClick:function(e){e.preventDefault(),r()}})},menuClassName:"notifications-dropdown",menuAlignRight:!0},void 0,function(e){var t=e.isOpen;return(0,i.A)(L,{active:t})})}var P;function I(e){var t=e.id,n=e.className,a=e.badge,o=e.url,r=e.active,s=e.onClick,u=a?pgettext("navbar","You have unread private threads!"):pgettext("navbar","Open private threads");return(0,i.A)("a",{id:t,className:R()("btn btn-navbar-icon",n,{active:r}),href:o,title:u,onClick:s},void 0,!!a&&(0,i.A)("span",{className:"navbar-item-badge"},void 0,a),P||(P=(0,i.A)("span",{className:"material-icon"},void 0,"inbox")))}var q,U,j,M=n(4549);function z(e){var t=e.id,n=e.className,a=e.url,o=e.active,r=e.onClick;return(0,i.A)("a",{id:t,className:R()("btn btn-navbar-icon",n,{active:o}),href:a,title:pgettext("navbar","Open search"),onClick:r},void 0,q||(q=(0,i.A)("span",{className:"material-icon"},void 0,"search")))}function H(e){var t=e.id,n=e.className,a=e.url;return(0,i.A)(_.ms,{id:t,toggle:function(e){var t=e.isOpen,o=e.toggle;return(0,i.A)(z,{className:n,active:t,url:a,onClick:function(e){e.preventDefault(),o(),window.setTimeout(function(){document.querySelector(".search-dropdown .form-control-search").focus()},0)}})},menuClassName:"search-dropdown",menuAlignRight:!0},void 0,function(){return U||(U=(0,i.A)(M.G,{}))})}function V(e){var t=e.id,n=e.className,a=e.active,o=e.onClick;return(0,i.A)("button",{id:t,className:R()("btn btn-navbar-icon",n,{active:a}),title:pgettext("navbar","Open menu"),type:"button",onClick:o},void 0,j||(j=(0,i.A)("span",{className:"material-icon"},void 0,"menu")))}var Y=n(91043);function W(e){var t=e.id,n=e.className;return(0,i.A)(_.ms,{id:t,toggle:function(e){var t=e.isOpen,a=e.toggle;return(0,i.A)(V,{className:n,active:t,onClick:a})},menuClassName:"site-nav-dropdown",menuAlignRight:!0},void 0,function(e){e.isOpen;var t=e.close;return(0,i.A)(Y.Cn,{close:t})})}var G=n(30330);function Q(e){var t=e.id,n=e.className,a=e.user,o=e.active,r=e.onClick;return(0,i.A)("a",{id:t,className:R()("btn-navbar-image",n,{active:o}),href:a.url,title:pgettext("navbar","Open your options"),onClick:r},void 0,(0,i.A)(G.Ay,{user:a,size:34}))}var K,X,J,$,Z=n(39671);function ee(e){var t=e.id,n=e.className,a=e.user;return(0,i.A)(_.ms,{id:t,toggle:function(e){var t=e.isOpen,o=e.toggle;return(0,i.A)(Q,{className:n,active:t,user:a,onClick:function(e){e.preventDefault(),o()}})},menuClassName:"user-nav-dropdown",menuAlignRight:!0},void 0,function(e){e.isOpen;var t=e.close;return(0,i.A)(Z.QE,{close:t})})}const te=(0,l.Ng)(function(e){var t=misago.get("SETTINGS"),n=e.auth.user;return{branding:{logo:t.logo,logoXs:t.logo_small,text:t.logo_text,url:misago.get("MISAGO_PATH")},extraMenuItems:misago.get("extraMenuItems"),user:n.id?{id:n.id,username:n.username,email:n.email,avatars:n.avatars,unreadNotifications:n.unreadNotifications,unreadPrivateThreads:n.unread_private_threads,url:n.url}:null,searchUrl:misago.get("SEARCH_URL"),notificationsUrl:misago.get("NOTIFICATIONS_URL"),privateThreadsUrl:misago.get("PRIVATE_THREADS_URL"),authDelegated:t.enable_oauth2_client,showSearch:!!n.acl.can_search,showPrivateThreads:!!n&&!!n.acl.can_use_private_threads}})(function(e){var t=e.dispatch,n=e.branding,a=e.extraMenuItems,o=e.authDelegated,s=e.user,u=e.searchUrl,l=e.notificationsUrl,h=e.privateThreadsUrl,m=e.showSearch,f=e.showPrivateThreads;return(0,i.A)("div",{className:"container navbar-container"},void 0,r().createElement(D,n),(0,i.A)("div",{className:"navbar-right"},void 0,a.length>0&&(0,i.A)(x,{items:a}),!!m&&(0,i.A)(H,{id:"navbar-search-dropdown",url:u}),!!m&&(0,i.A)(z,{id:"navbar-search-overlay",url:u,onClick:function(e){t(c.rf()),e.preventDefault()}}),K||(K=(0,i.A)(W,{id:"navbar-site-nav-dropdown"})),(0,i.A)(V,{id:"navbar-site-nav-overlay",onClick:function(){t(c.hF())}}),!!f&&(0,i.A)(I,{id:"navbar-private-threads",badge:s.unreadPrivateThreads,url:h}),!!s&&(0,i.A)(O,{id:"navbar-notifications-dropdown",badge:s.unreadNotifications,url:l}),!!s&&(0,i.A)(T,{id:"navbar-notifications-overlay",badge:s.unreadNotifications,url:l,onClick:function(e){t(c.BL()),e.preventDefault()}}),!!s&&(0,i.A)(ee,{id:"navbar-user-nav-dropdown",user:s}),!!s&&(0,i.A)(Q,{id:"navbar-user-nav-overlay",user:s,onClick:function(e){t(c.jc()),e.preventDefault()}}),!s&&(X||(X=(0,i.A)(p.A,{className:"btn-navbar-sign-in"}))),!s&&!o&&(J||(J=(0,i.A)(d.A,{className:"btn-navbar-register"}))),!s&&!o&&($||($=(0,i.A)(b,{})))))});var ne,ae=n(52762);misago.addInitializer({name:"component:navbar",initializer:function(e){var t=document.getElementById("misago-navbar");u().render((0,i.A)(l.Kq,{store:ae.A.getStore()},void 0,ne||(ne=(0,i.A)(te,{}))),t)},after:"store"})},4549:(e,t,n)=>{"use strict";n.d(t,{G:()=>L,P:()=>P});var a=n(73620),i=n(40927),o=n.n(i),r=n(23029),s=n(92901),u=n(15361),l=n(61801),c=n(53954),d=n(65407),p=n(67369);function h(e){var t=e.children;return(0,a.A)(p.yq,{className:"search-results-list"},void 0,t)}function m(){return(0,a.A)(h,{},void 0,(0,a.A)(p.Bl,{message:pgettext("search cta","Enter search query (at least 3 characters).")}))}var f=n(7050);function v(e){var t=e.post;return(0,a.A)(p.HU,{className:"search-result"},void 0,(0,a.A)("a",{href:t.url.index},void 0,(0,a.A)("div",{className:"search-result-card"},void 0,(0,a.A)("div",{className:"search-result-name"},void 0,t.thread.title),(0,a.A)("div",{className:"search-result-summary",dangerouslySetInnerHTML:{__html:t.headline||t.content}}),(0,a.A)("ul",{className:"search-result-details"},void 0,(0,a.A)("li",{},void 0,(0,a.A)("b",{},void 0,t.category.name)),(0,a.A)("li",{},void 0,t.poster?t.poster.username:t.poster_name),(0,a.A)("li",{},void 0,(0,a.A)(f.A,{datetime:t.posted_on}))))))}var A,g,y,b=n(30330);function D(e){var t=e.user,n=t.title||t.rank.title;return(0,a.A)(p.HU,{className:"search-result"},void 0,(0,a.A)("a",{href:t.url},void 0,(0,a.A)(b.Ay,{user:t,size:32}),(0,a.A)("div",{className:"search-result-card"},void 0,(0,a.A)("div",{className:"search-result-name"},void 0,t.username),(0,a.A)("ul",{className:"search-result-details"},void 0,!!n&&(0,a.A)("li",{},void 0,(0,a.A)("b",{},void 0,n)),(0,a.A)("li",{},void 0,t.rank.name),(0,a.A)("li",{},void 0,(0,a.A)(f.A,{datetime:t.joined_on}))))))}function x(e){var t=e.query,n=e.results,i=n[0],o=n[1],r=i.results.count;return(0,a.A)(h,{},void 0,o.results.results.map(function(e){return(0,a.A)(D,{user:e},e.id)}),i.results.results.map(function(e){return(0,a.A)(v,{post:e},e.id)}),r>0&&(0,a.A)(p.HU,{},void 0,(0,a.A)("a",{href:i.url+"?q="+encodeURIComponent(t),className:"btn btn-default btn-block"},void 0,npgettext("search results list","See all %(count)s result.","See all %(count)s results.",i.results.count).replace("%(count)s",i.results.count))))}function k(){return(0,a.A)(h,{},void 0,(0,a.A)(p.FI,{message:pgettext("search results","The search returned no results.")}))}function _(e){var t=e.error;return(0,a.A)(h,{},void 0,(0,a.A)(p.OJ,{message:pgettext("search results","The search could not be completed."),detail:N(t)}))}function N(e){return 0===e.status?gettext("Check your internet connection and try refreshing the site."):e.data&&e.data.detail?e.data.detail:void 0}function C(){return(0,a.A)(h,{},void 0,(0,a.A)(p.Uf,{message:pgettext("search results","Searching...")}))}var E={},w=function(e){(0,u.A)(o,e);var t,n,i=(t=o,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}(),function(){var e,a=(0,c.A)(t);if(n){var i=(0,c.A)(this).constructor;e=Reflect.construct(a,arguments,i)}else e=a.apply(this,arguments);return(0,l.A)(this,e)});function o(e){var t;return(0,r.A)(this,o),(t=i.call(this,e)).state={query:t.props.query.trim()},t.debounce=null,t}return(0,s.A)(o,[{key:"componentDidUpdate",value:function(){var e=this,t=this.props.query.trim();this.state.query!=t&&(this.debounce&&window.clearTimeout(this.debounce),this.debounce=window.setTimeout(function(){e.setState({query:t})},750))}},{key:"componentWillUnmount",value:function(){this.debounce&&window.clearTimeout(this.debounce)}},{key:"render",value:function(){var e,t=this;return(0,a.A)(d.V,{url:(e=this.state.query,misago.get("SEARCH_API")+"?q="+encodeURIComponent(e)),cache:E,disabled:this.state.query.length<3},void 0,function(e){var n=e.data,i=e.loading,o=e.error;return t.state.query.length<3?A||(A=(0,a.A)(m,{})):i?g||(g=(0,a.A)(C,{})):o?(0,a.A)(_,{error:o}):function(e){if(null===e)return!0;var t=0;return e.forEach(function(e){t+=e.results.count}),0===t}(n)?y||(y=(0,a.A)(k,{})):null!==n?(0,a.A)(x,{query:t.state.query,results:n}):null})}}]),o}(o().Component);function F(e){var t=e.query,n=e.setQuery;return(0,a.A)("div",{className:"search-input"},void 0,(0,a.A)("input",{className:"form-control form-control-search",type:"text",placeholder:pgettext("cta","Search"),value:t,onChange:function(e){return n(e.target.value)}}))}var R=n(9417),S=n(64467);var B=function(e){(0,u.A)(i,e);var t,n,a=(t=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}(),function(){var e,a=(0,c.A)(t);if(n){var i=(0,c.A)(this).constructor;e=Reflect.construct(a,arguments,i)}else e=a.apply(this,arguments);return(0,l.A)(this,e)});function i(e){var t;return(0,r.A)(this,i),t=a.call(this,e),(0,S.A)((0,R.A)(t),"setQuery",function(e){t.setState({query:e})}),t.state={query:""},t}return(0,s.A)(i,[{key:"render",value:function(){return this.props.children({query:this.state.query,setQuery:this.setQuery})}}]),i}(o().Component);function L(){return(0,a.A)(B,{},void 0,function(e){var t=e.query,n=e.setQuery;return(0,a.A)("div",{className:"search-dropdown-body"},void 0,(0,a.A)(F,{query:t,setQuery:n}),(0,a.A)(w,{query:t}))})}var T=n(67467),O=n(64015);const P=(0,T.Ng)(function(e){return{open:e.overlay.search}})(function(e){var t=e.open;return(0,a.A)(O.h,{open:t,onOpen:function(){window.setTimeout(function(){document.querySelector("#search-mount .form-control-search").focus()},0)}},void 0,(0,a.A)(O.e,{},void 0,pgettext("cta","Search")),(0,a.A)(B,{},void 0,function(e){var t=e.query,n=e.setQuery;return(0,a.A)("div",{className:"search-overlay-body"},void 0,(0,a.A)(F,{query:t,setQuery:n}),(0,a.A)("div",{className:"search-results-container"},void 0,(0,a.A)(w,{query:t})))}))})},6344:(e,t,n)=>{"use strict";var a=n(73971),i=n(92069),o=n(29904),r=n(22557);a.A.addInitializer({name:"polls",initializer:function(){r.A.init(i.A,o.A)}})},7050:(e,t,n)=>{"use strict";n.d(t,{A:()=>f});var a=n(73620),i=n(23029),o=n(92901),r=n(9417),s=n(15361),u=n(61801),l=n(53954),c=n(64467),d=n(40927),p=n.n(d),h=n(79678);function m(e){return{tick:e.tick+1}}const f=function(e){(0,s.A)(p,e);var t,n,d=(t=p,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}(),function(){var e,a=(0,l.A)(t);if(n){var i=(0,l.A)(this).constructor;e=Reflect.construct(a,arguments,i)}else e=a.apply(this,arguments);return(0,u.A)(this,e)});function p(e){var t;return(0,i.A)(this,p),t=d.call(this,e),(0,c.A)((0,r.A)(t),"scheduleNextUpdate",function(){var e=new Date,n=Math.ceil(Math.abs(Math.round((t.date-e)/1e3)));n<3600?t.timeout=window.setTimeout(function(){t.setState(m),t.scheduleNextUpdate()},5e4):n<86400&&(t.timeout=window.setTimeout(function(){t.setState(m)},24e5))}),t.state={tick:0},t.date=new Date(e.datetime),t.timeout=null,t}return(0,o.A)(p,[{key:"componentDidMount",value:function(){this.scheduleNextUpdate()}},{key:"componentWillUnmount",value:function(){this.timeout&&window.clearTimeout(this.timeout)}},{key:"render",value:function(){var e=this.props.narrow?(0,h.H7)(this.date):(0,h.FI)(this.date);return(0,a.A)("attr",{title:this.props.title?this.props.title.replace("%(timestamp)s",h.hs.format(this.date)):h.hs.format(this.date)},void 0,e)}}]),p}(p().Component)},8041:(e,t,n)=>{"use strict";n.d(t,{zY:()=>s,d4:()=>u,ud:()=>l,Le:()=>c,hA:()=>d});var a,i=n(73620),o=n(32485),r=n.n(o);n(40927);const s=function(e){var t=e.children,n=e.className,o=e.styleName;return(0,i.A)("div",{className:r()("page-header",n,o&&"page-header-"+o)},void 0,(0,i.A)("div",{className:"page-header-bg-image"},void 0,(0,i.A)("div",{className:"page-header-bg-overlay"},void 0,a||(a=(0,i.A)("div",{className:"page-header-image"})),t)))},u=function(e){var t=e.children,n=e.className,a=e.styleName;return(0,i.A)("div",{className:r()("page-header-banner",n,a&&"page-header-banner-"+a)},void 0,(0,i.A)("div",{className:"page-header-banner-bg-image"},void 0,(0,i.A)("div",{className:"page-header-banner-bg-overlay"},void 0,t)))},l=function(e){var t=e.children;return(0,i.A)("div",{className:"container page-header-container"},void 0,t)},c=function(e){var t=e.children,n=e.className;return(0,i.A)("div",{className:r()("page-header-details",n)},void 0,t)},d=function(e){var t=e.styleName,n=e.header,a=e.message;return(0,i.A)(l,{},void 0,(0,i.A)(s,{styleName:t},void 0,(0,i.A)(u,{styleName:t},void 0,(0,i.A)("h1",{},void 0,n)),a&&(0,i.A)(c,{styleName:t},void 0,a)))}},8142:(e,t,n)=>{"use strict";var a=n(73971),i=n(1657),o=n(70490),r=n(52762),s=n(17772);a.A.addInitializer({name:"auth",initializer:function(){i.A.init(r.A,s.A,o.A)},after:"store"})},8238:(e,t,n)=>{"use strict";var a=n(73971),i=n(23029),o=n(92901),r=n(92979),s=n(74692);const u=new(function(){function e(){(0,i.A)(this,e)}return(0,o.A)(e,[{key:"init",value:function(e){this._element=e,this._component=null}},{key:"show",value:function(e){this._component===e?this.hide():(this._component=e,(0,r.A)(e,this._element.id),s(this._element).addClass("open"))}},{key:"showConnected",value:function(e,t){this._component===e?this.hide():(this._component=e,(0,r.A)(t,this._element.id,!0),s(this._element).addClass("open"))}},{key:"hide",value:function(){s(this._element).removeClass("open"),this._component=null}}]),e}());a.A.addInitializer({name:"dropdown",initializer:function(){var e=document.getElementById("mobile-navbar-dropdown-mount");e&&u.init(e)},before:"store"})},9801:(e,t,n)=>{"use strict";n.d(t,{A:()=>p});var a=n(23029),i=n(92901),o=n(64467),r=n(40927),s=n.n(r),u=n(40961),l=n.n(u),c=n(34047),d=n(92979);const p=new(function(){function e(){var t=this;(0,a.A)(this,e),(0,o.A)(this,"close",function(){t.unsetBeforeUnload(),t._props=null,t._isOpen&&!t._isClosing&&(t._isClosing=!0,t._mount.classList.remove("show"),window.setTimeout(function(){l().unmountComponentAtNode(t._mount),t._observer.unobserve(t._mount),t._spacer.style.height="0px;",t._isClosing=!1,t._isOpen=!1,t._mode=null},300))})}return(0,i.A)(e,[{key:"init",value:function(e,t,n){var a=this;this._ajax=e,this._snackbar=t,this._mount=n,this._mode=null,this._spacer=document.getElementById("posting-spacer"),this._observer=new ResizeObserver(function(e){a._spacer.style.height=e[0].contentRect.height+"px"}),this._isOpen=!1,this._isClosing=!1,this._beforeunloadSet=!1,this._props=null}},{key:"isOpen",value:function(){return this._isOpen}},{key:"setBeforeUnload",value:function(){this._beforeunloadSet||(window.addEventListener("beforeunload",this.beforeUnload,{capture:!0}),this._beforeunloadSet=!0)}},{key:"unsetBeforeUnload",value:function(){window.removeEventListener("beforeunload",this.beforeUnload,{capture:!0}),this._beforeunloadSet=!1}},{key:"beforeUnload",value:function(e){return e.returnValue="true","true"}},{key:"open",value:function(e){if(!1===this._isOpen)"QUOTE"===e.mode?this._mode="REPLY":this._mode=e.mode,this._isOpen=e.submit,this._realOpen(Object.assign({},e,{mode:this._mode}));else if("QUOTE"===e.mode)this._realOpen(Object.assign({},this._props,{config:e.config,context:e.context}));else if(this._isOpen!==e.submit){var t=gettext("You are already working on other message. Do you want to discard it?");window.confirm(t)&&(this._mode=e.mode,this._isOpen=e.submit,this._realOpen(e))}else"REPLY"==this._mode&&"REPLY"==e.mode&&this._realOpen(e)}},{key:"_realOpen",value:function(e){(0,d.A)(s().createElement(c.Ay,e),this._mount.id),this._props=e,this._mount.classList.add("show"),this._observer.observe(this._mount),this.setBeforeUnload()}}]),e}())},10035:(e,t,n)=>{"use strict";var a=n(73971),i=n(72235),o=n(52762);a.A.addInitializer({name:"reducer:snackbar",initializer:function(){o.A.addReducer("snackbar",i.Ay,i.ue)},before:"store"})},10500:(e,t,n)=>{"use strict";var a=n(73971),i=(n(95093),n(86552)),o=["can_announce","can_approve","can_close","can_hide","can_move","can_merge","can_pin","can_review"];function r(e){return Object.assign({},e,{moderation:(t=e.acl,n=[],o.forEach(function(e){t[e]&&n.push(e)}),n)});var t,n}function s(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;switch(t.type){case"APPEND_THREADS":return(0,i.A)(t.items.map(r),e).sort(t.sorting);case"DELETE_THREAD":return e.filter(function(e){return e.id!==t.thread.id});case"FILTER_THREADS":return e.filter(function(e){var n=t.categoriesMap[e.category];return n.lft>=t.category.lft&&n.rght<=t.category.rght||2==e.weight});case"HYDRATE_THREADS":return t.items.map(r);case"PATCH_THREAD":var n=e.map(function(e){return e.id===t.thread.id?Object.assign({},e,t.patch):e});return t.sorting?n.sort(t.sorting):n;case"SORT_THREADS":return e.sort(t.sorting);default:return e}}var u=n(52762);a.A.addInitializer({name:"reducer:threads",initializer:function(){u.A.addReducer("threads",s,[])},before:"store"})},10771:(e,t,n)=>{"use strict";var a,i=n(67467),o=n(73620),r=n(58168),s=n(40927),u=n.n(s),l=n(48995),c=n(23029),d=n(92901),p=n(9417),h=n(15361),m=n(61801),f=n(53954),v=n(64467),A=n(73971),g=n(849),y=n(50425),b=n(32148),D=n(97414),x=n(92069),k=n(29904),_=n(52762),N=n(22107),C=n(8041);var E=function(e){(0,h.A)(r,e);var t,n,i=(t=r,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}(),function(){var e,a=(0,f.A)(t);if(n){var i=(0,f.A)(this).constructor;e=Reflect.construct(a,arguments,i)}else e=a.apply(this,arguments);return(0,m.A)(this,e)});function r(e){var t;return(0,c.A)(this,r),t=i.call(this,e),(0,v.A)((0,p.A)(t),"onQueryChange",function(e){t.changeValue("query",e.target.value)}),t.state={isLoading:!1,query:e.search.query},t}return(0,d.A)(r,[{key:"componentDidMount",value:function(){this.state.query.length&&this.handleSubmit()}},{key:"clean",value:function(){return!!this.state.query.trim().length||(k.A.error(pgettext("search form","You have to enter search query.")),!1)}},{key:"send",value:function(){_.A.dispatch((0,b.yo)({isLoading:!0}));var e=this.state.query.trim(),t=window.location.href,n=t.indexOf("?q=");return n>0&&(t=t.substring(0,n+3)),window.history.pushState({},"",t+encodeURIComponent(e)),x.A.get(A.A.get("SEARCH_API"),{q:e})}},{key:"handleSuccess",value:function(e){_.A.dispatch((0,b.yo)({query:this.state.query.trim(),isLoading:!1,providers:e})),e.forEach(function(e){"users"===e.id?_.A.dispatch((0,D.Qv)(e.results.results)):"threads"===e.id&&_.A.dispatch((0,y.Hh)(e.results))})}},{key:"handleError",value:function(e){k.A.apiError(e),_.A.dispatch((0,b.yo)({isLoading:!1}))}},{key:"render",value:function(){return(0,o.A)("form",{onSubmit:this.handleSubmit},void 0,(0,o.A)(C.ud,{},void 0,(0,o.A)(C.zY,{styleName:"site-search"},void 0,(0,o.A)(C.d4,{styleName:"site-search"},void 0,(0,o.A)("h1",{},void 0,pgettext("search form title","Search"))),(0,o.A)(C.Le,{className:"page-header-search-form"},void 0,(0,o.A)(N.Ye,{},void 0,(0,o.A)(N.P3,{auto:!0},void 0,(0,o.A)(N.MT,{},void 0,(0,o.A)("input",{className:"form-control",disabled:this.state.isLoading,type:"text",value:this.state.query,placeholder:pgettext("search form input","Search"),onChange:this.onQueryChange})),(0,o.A)(N.MT,{shrink:!0},void 0,(0,o.A)("button",{className:"btn btn-secondary btn-icon btn-outline",title:pgettext("search form btn","Search"),disabled:this.state.isLoading},void 0,a||(a=(0,o.A)("span",{className:"material-icon"},void 0,"search"))))))))))}}]),r}(g.A),w=n(28542);function F(e){return(0,o.A)("div",{className:"list-group nav-side"},void 0,e.providers.map(function(e){return(0,o.A)(w.N_,{activeClassName:"active",className:"list-group-item",to:e.url},e.id,(0,o.A)("span",{className:"material-icon"},void 0,e.icon),e.name,(0,o.A)(R,{results:e.results}))}))}function R(e){if(!e.results)return null;var t=e.results.count;return t>1e6?t=Math.ceil(t/1e6)+"KK":t>1e3&&(t=Math.ceil(t/1e3)+"K"),(0,o.A)("span",{className:"badge"},void 0,t)}function S(e){return(0,o.A)("div",{className:"page page-search"},void 0,(0,o.A)(E,{provider:e.provider,search:e.search}),(0,o.A)(l.A,{},void 0,(0,o.A)("div",{className:"row"},void 0,(0,o.A)("div",{className:"col-md-3"},void 0,(0,o.A)(F,{providers:e.search.providers})),(0,o.A)("div",{className:"col-md-9"},void 0,e.children,(0,o.A)(B,{provider:e.provider,search:e.search})))))}function B(e){var t=null;if(e.search.providers.forEach(function(n){n.id===e.provider.id&&(t=n.time)}),null===t)return null;var n=pgettext("search time","Search took %(time)s s");return(0,o.A)("footer",{className:"search-footer"},void 0,(0,o.A)("p",{},void 0,interpolate(n,{time:t},!0)))}var L=n(81994),T=n(39227);function O(e){return(0,o.A)("div",{},void 0,(0,o.A)(L.A,{isReady:!0,posts:e.results}),u().createElement(P,e))}n(35248);var P=function(e){(0,h.A)(i,e);var t,n,a=(t=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}(),function(){var e,a=(0,f.A)(t);if(n){var i=(0,f.A)(this).constructor;e=Reflect.construct(a,arguments,i)}else e=a.apply(this,arguments);return(0,m.A)(this,e)});function i(){var e;(0,c.A)(this,i);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return e=a.call.apply(a,[this].concat(n)),(0,v.A)((0,p.A)(e),"onClick",function(){_.A.dispatch((0,y.yo)({isBusy:!0})),x.A.get(e.props.provider.api,{q:e.props.query,page:e.props.next}).then(function(e){e.forEach(function(e){"threads"===e.id&&(_.A.dispatch((0,y.BC)(e.results)),_.A.dispatch((0,b.f9)(e)))}),_.A.dispatch((0,y.yo)({isBusy:!1}))},function(e){k.A.apiError(e),_.A.dispatch((0,y.yo)({isBusy:!1}))})}),e}return(0,d.A)(i,[{key:"render",value:function(){return this.props.more?(0,o.A)("div",{className:"pager-more"},void 0,(0,o.A)(T.A,{className:"btn btn-default btn-outline",loading:this.props.isBusy,onClick:this.onClick},void 0,pgettext("search threads btn","Show more"))):null}}]),i}(u().Component);function I(e){var t=e.children,n=e.loading,a=e.posts,i=e.query;return a&&a.count?t:i.length?(0,o.A)("p",{className:"lead"},void 0,n?pgettext("search threads","Loading results..."):pgettext("search threads","No threads matching search query have been found.")):(0,o.A)("p",{className:"lead"},void 0,pgettext("search threads","Enter at least two characters to search threads."))}var q=n(49954);function U(e){var t=e.children,n=e.loading,a=e.query;return e.users.length?t:a.length?(0,o.A)("p",{className:"lead"},void 0,n?pgettext("search users","Loading results..."):pgettext("search users","No users matching search query have been found.")):(0,o.A)("p",{className:"lead"},void 0,pgettext("search users","Enter at least two characters to search users."))}var j={threads:function(e){return(0,o.A)(S,{provider:e.route.provider,search:e.search},void 0,(0,o.A)(I,{loading:e.search.isLoading,query:e.search.query,posts:e.posts},void 0,u().createElement(O,(0,r.A)({provider:e.route.provider,query:e.search.query},e.posts))))},users:function(e){return(0,o.A)(S,{provider:e.route.provider,search:e.search},void 0,(0,o.A)(U,{loading:e.search.isLoading,query:e.search.query,users:e.users},void 0,(0,o.A)(q.A,{cols:3,isReady:!e.search.isLoading,users:e.users})))}};function M(e){return{posts:e.posts,search:e.search,tick:e.tick.tick,user:e.auth.user,users:e.users}}var z=n(88095);A.A.addInitializer({name:"component:search",initializer:function(e){var t;"misago:search"===e.get("CURRENT_LINK")&&(0,z.A)({paths:(t=A.A.get("SEARCH_PROVIDERS"),t.map(function(e){return{path:e.url,component:(0,i.Ng)(M)(j[e.id]),provider:e}}))})},after:"store"})},13497:(e,t,n)=>{"use strict";var a=n(73971),i=n(71569),o=n(52762);a.A.addInitializer({name:"reducer:tick",initializer:function(){o.A.addReducer("tick",i.Ay,i.ue)},before:"store"})},17726:(e,t,n)=>{"use strict";var a=n(67467),i=n(73971),o=n(73620),r=n(23029),s=n(92901),u=n(15361),l=n(61801),c=n(53954),d=n(40927);var p={info:"alert-info",success:"alert-success",warning:"alert-warning",error:"alert-danger"},h=function(e){(0,u.A)(i,e);var t,n,a=(t=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}(),function(){var e,a=(0,c.A)(t);if(n){var i=(0,c.A)(this).constructor;e=Reflect.construct(a,arguments,i)}else e=a.apply(this,arguments);return(0,l.A)(this,e)});function i(){return(0,r.A)(this,i),a.apply(this,arguments)}return(0,s.A)(i,[{key:"getSnackbarClass",value:function(){var e="alerts-snackbar";return this.props.isVisible?e+=" in":e+=" out",e}},{key:"render",value:function(){return(0,o.A)("div",{className:this.getSnackbarClass()},void 0,(0,o.A)("p",{className:"alert "+p[this.props.type]},void 0,this.props.message))}}]),i}(n.n(d)().Component);function m(e){return e.snackbar}var f=n(92979);i.A.addInitializer({name:"component:snackbar",initializer:function(){(0,f.A)((0,a.Ng)(m)(h),"snackbar-mount")},after:"snackbar"})},17772:(e,t,n)=>{"use strict";n.d(t,{A:()=>r});var a=n(23029),i=n(92901),o=window.localStorage;const r=new(function(){function e(){(0,a.A)(this,e)}return(0,i.A)(e,[{key:"init",value:function(e){var t=this;this._prefix=e,this._watchers=[],window.addEventListener("storage",function(e){var n=JSON.parse(e.newValue);t._watchers.forEach(function(t){t.key===e.key&&e.oldValue!==e.newValue&&t.callback(n)})})}},{key:"set",value:function(e,t){o.setItem(this._prefix+e,JSON.stringify(t))}},{key:"get",value:function(e){var t=o.getItem(this._prefix+e);return t?JSON.parse(t):null}},{key:"watch",value:function(e,t){this._watchers.push({key:this._prefix+e,callback:t})}}]),e}())},18524:(e,t,n)=>{"use strict";function a(e){return e>1073741824?i(e/1073741824)+" GB":e>1048576?i(e/1048576)+" MB":e>1024?i(e/1024)+" KB":i(e)+" B"}function i(e){return e.toFixed(1)}n.d(t,{A:()=>a})},18764:()=>{document.body.addEventListener("click",function(e){var t=e.target.closest("[misago-scroll-to]");if(t){var n=t.getAttribute("misago-scroll-to"),a=document.querySelector(n);a&&(e.preventDefault(),a.scrollIntoView({behavior:"instant"}))}})},19086:(e,t,n)=>{"use strict";n.d(t,{Ay:()=>o});var a="12345678990abcdefghijklmnopqrstuvwxyz",i=a.length;function o(e){for(var t=[],n=0;n<e;n++){var o=Math.floor(Math.random()*i);t.push(a[o])}return t.join("")}},19194:(e,t,n)=>{"use strict";var a=n(73971),i=n(63426),o=n(52762);a.A.addInitializer({name:"reducer:auth",initializer:function(e){o.A.addReducer("auth",i.Ay,Object.assign({isAuthenticated:e.get("isAuthenticated"),isAnonymous:!e.get("isAuthenticated"),user:e.get("user")},i.ue))},before:"store"})},19876:(e,t,n)=>{"use strict";var a=n(73971),i=n(92069),o=n(36629),r=n(69387),s=n(29904);a.A.addInitializer({name:"captcha",initializer:function(e){o.Ay.init(e,i.A,r.A,s.A)}})},20127:(e,t,n)=>{"use strict";n.d(t,{A:()=>i});var a={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#039;"};function i(e){return e.replace(/[&<>"']/g,function(e){return a[e]})}},20475:(e,t,n)=>{"use strict";var a,i=n(73971),o=n(9417),r=n(64467),s=n(73620),u=n(23029),l=n(92901),c=n(15361),d=n(61801),p=n(53954),h=n(40927),m=n.n(h),f=n(39227),v=n(849),A=n(92069),g=n(29904),y=n(89077),b=n(74017);function D(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,a=(0,p.A)(e);if(t){var i=(0,p.A)(this).constructor;n=Reflect.construct(a,arguments,i)}else n=a.apply(this,arguments);return(0,d.A)(this,n)}}var x=function(e){(0,c.A)(n,e);var t=D(n);function n(e){var a;return(0,u.A)(this,n),(a=t.call(this,e)).state={isLoading:!1,email:"",validators:{email:[y.Rp()]}},a}return(0,l.A)(n,[{key:"clean",value:function(){return!!this.isValid()||(g.A.error(pgettext("request activation link form","Enter a valid e-mail address.")),!1)}},{key:"send",value:function(){return A.A.post(i.A.get("SEND_ACTIVATION_API"),{email:this.state.email})}},{key:"handleSuccess",value:function(e){this.props.callback(e)}},{key:"handleError",value:function(e){["already_active","inactive_admin"].indexOf(e.code)>-1?g.A.info(e.detail):403===e.status&&e.ban?(0,b.A)(e.ban):g.A.apiError(e)}},{key:"render",value:function(){return(0,s.A)("div",{className:"well well-form well-form-request-activation-link"},void 0,(0,s.A)("form",{onSubmit:this.handleSubmit},void 0,(0,s.A)("div",{className:"form-group"},void 0,(0,s.A)("div",{className:"control-input"},void 0,(0,s.A)("input",{type:"text",className:"form-control",placeholder:pgettext("request activation link form field","Your e-mail address"),disabled:this.state.isLoading,onChange:this.bindInput("email"),value:this.state.email}))),(0,s.A)(f.A,{className:"btn-primary btn-block",loading:this.state.isLoading},void 0,pgettext("request activation link form btn","Send link"))))}}]),n}(v.A),k=function(e){(0,c.A)(n,e);var t=D(n);function n(){return(0,u.A)(this,n),t.apply(this,arguments)}return(0,l.A)(n,[{key:"getMessage",value:function(){return interpolate(pgettext("request activation link form","Activation link was sent to %(email)s"),{email:this.props.user.email},!0)}},{key:"render",value:function(){return(0,s.A)("div",{className:"well well-form well-form-request-activation-link well-done"},void 0,(0,s.A)("div",{className:"done-message"},void 0,a||(a=(0,s.A)("div",{className:"message-icon"},void 0,(0,s.A)("span",{className:"material-icon"},void 0,"check"))),(0,s.A)("div",{className:"message-body"},void 0,(0,s.A)("p",{},void 0,this.getMessage())),(0,s.A)("button",{className:"btn btn-primary btn-block",type:"button",onClick:this.props.callback},void 0,pgettext("request activation link form btn","Request another link"))))}}]),n}(m().Component),_=function(e){(0,c.A)(n,e);var t=D(n);function n(e){var a;return(0,u.A)(this,n),a=t.call(this,e),(0,r.A)((0,o.A)(a),"complete",function(e){a.setState({complete:e})}),(0,r.A)((0,o.A)(a),"reset",function(){a.setState({complete:!1})}),a.state={complete:!1},a}return(0,l.A)(n,[{key:"render",value:function(){return this.state.complete?(0,s.A)(k,{user:this.state.complete,callback:this.reset}):(0,s.A)(x,{callback:this.complete})}}]),n}(m().Component),N=n(92979);i.A.addInitializer({name:"component:request-activation-link",initializer:function(){document.getElementById("request-activation-link-mount")&&(0,N.A)(_,"request-activation-link-mount",!1)},after:"store"})},22107:(e,t,n)=>{"use strict";n.d(t,{Ye:()=>r,MT:()=>s,P3:()=>u});var a=n(73620),i=n(32485),o=n.n(i);n(40927);const r=function(e){var t=e.children,n=e.className;return(0,a.A)("div",{className:o()("flex-row",n)},void 0,t)},s=function(e){var t=e.children,n=e.className,i=e.shrink;return(0,a.A)("div",{className:o()("flex-row-col",n,{"flex-row-col-shrink":i})},void 0,t)},u=function(e){var t=e.auto,n=e.children,i=e.className;return(0,a.A)("div",{className:o()("flex-row-section",{"flex-row-section-auto":t},i)},void 0,n)}},22557:(e,t,n)=>{"use strict";n.d(t,{A:()=>o});var a=n(23029),i=n(92901);const o=new(function(){function e(){(0,a.A)(this,e)}return(0,i.A)(e,[{key:"init",value:function(e,t){this._ajax=e,this._snackbar=t,this._polls={}}},{key:"start",value:function(e){var t=this;this.stop(e.poll);var n=function n(){t._polls[e.poll]=e,t._ajax.get(e.url,e.data||null).then(function(a){t._polls[e.poll]._stopped||(e.update(a),t._polls[e.poll].timeout=window.setTimeout(n,e.frequency))},function(n){t._polls[e.poll]._stopped||(e.error?e.error(n):t._snackbar.apiError(n))})};e.delayed?this._polls[e.poll]={timeout:window.setTimeout(n,e.frequency)}:n()}},{key:"stop",value:function(e){this._polls[e]&&(window.clearTimeout(this._polls[e].timeout),this._polls[e]._stopped=!0)}}]),e}())},22926:(e,t,n)=>{"use strict";n.d(t,{Ay:()=>f,BL:()=>d,VN:()=>h,hF:()=>l,jc:()=>p,rf:()=>c,ue:()=>m});var a="OPEN_SITE_NAV",i="OPEN_SEARCH",o="OPEN_NOTIFICATIONS",r="OPEN_PRIVATE_THREADS",s="OPEN_USER_NAV",u="CLOSE_OVERLAYS";function l(){return{type:a}}function c(){return{type:i}}function d(){return{type:o}}function p(){return{type:s}}function h(){return{type:u}}var m={siteNav:!1,search:!1,notifications:!1,privateThreads:!1,userNav:!1};function f(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:m;switch((arguments.length>1&&void 0!==arguments[1]?arguments[1]:null).type){case a:return Object.assign({},e,m,{siteNav:!0});case i:return Object.assign({},e,m,{search:!0});case o:return Object.assign({},e,m,{notifications:!0});case r:return Object.assign({},e,m,{privateThreads:!0});case s:return Object.assign({},e,m,{userNav:!0});case u:return Object.assign({},e,m);default:return e}}},24272:(e,t,n)=>{"use strict";n.d(t,{A:()=>o});var a=n(23029),i=n(92901);const o=new(function(){function e(){(0,a.A)(this,e)}return(0,i.A)(e,[{key:"init",value:function(e){this._include=e,this._isLoaded=!1}},{key:"scorePassword",value:function(e,t){return this._isLoaded?zxcvbn(e,t).score:0}},{key:"load",value:function(){return this._isLoaded?this._loadedPromise():(this._include.include("misago/js/zxcvbn.js"),this._loadingPromise())}},{key:"_loadingPromise",value:function(){var e=this;return new Promise(function(t,n){!function a(){var i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;(i+=1)>200?n():"undefined"==typeof zxcvbn?window.setTimeout(function(){a(i)},200):(e._isLoaded=!0,t())}()})}},{key:"_loadedPromise",value:function(){return new Promise(function(e){e()})}}]),e}())},24832:(e,t,n)=>{"use strict";n.d(t,{A:()=>y});var a,i=n(73620),o=n(23029),r=n(92901),s=n(15361),u=n(61801),l=n(53954),c=(n(40927),n(73971)),d=n(39227),p=n(849),h=n(48354),m=n(92069),f=n(70490),v=n(29904),A=n(74017),g=n(74692);var y=function(e){(0,s.A)(y,e);var t,n,p=(t=y,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}(),function(){var e,a=(0,l.A)(t);if(n){var i=(0,l.A)(this).constructor;e=Reflect.construct(a,arguments,i)}else e=a.apply(this,arguments);return(0,u.A)(this,e)});function y(e){var t;return(0,o.A)(this,y),(t=p.call(this,e)).state={isLoading:!1,showActivation:!1,username:"",password:"",validators:{username:[],password:[]}},t}return(0,r.A)(y,[{key:"clean",value:function(){return!!this.isValid()||(v.A.error(pgettext("sign in modal","Fill out both fields.")),!1)}},{key:"send",value:function(){return m.A.post(c.A.get("AUTH_API"),{username:this.state.username,password:this.state.password})}},{key:"handleSuccess",value:function(){var e=g("#hidden-login-form");e.append('<input type="text" name="username" />'),e.append('<input type="password" name="password" />'),e.find('input[type="hidden"]').val(m.A.getCsrfToken()),e.find('input[name="next"]').val(window.location.pathname),e.find('input[name="username"]').val(this.state.username),e.find('input[name="password"]').val(this.state.password),e.submit(),this.setState({isLoading:!0})}},{key:"handleError",value:function(e){400===e.status?"inactive_admin"===e.code?v.A.info(e.detail):"inactive_user"===e.code?(v.A.info(e.detail),this.setState({showActivation:!0})):"banned"===e.code?((0,A.A)(e.detail),f.A.hide()):v.A.error(e.detail):403===e.status&&e.ban?((0,A.A)(e.ban),f.A.hide()):v.A.apiError(e)}},{key:"getActivationButton",value:function(){return this.state.showActivation?(0,i.A)("a",{className:"btn btn-success btn-block",href:c.A.get("REQUEST_ACTIVATION_URL")},void 0,pgettext("sign in modal btn","Activate account")):null}},{key:"render",value:function(){return(0,i.A)("div",{className:"modal-dialog modal-sm modal-sign-in",role:"document"},void 0,(0,i.A)("div",{className:"modal-content"},void 0,(0,i.A)("div",{className:"modal-header"},void 0,(0,i.A)("button",{"aria-label":pgettext("modal","Close"),className:"close","data-dismiss":"modal",type:"button"},void 0,a||(a=(0,i.A)("span",{"aria-hidden":"true"},void 0,"Ã—"))),(0,i.A)("h4",{className:"modal-title"},void 0,pgettext("sign in modal title","Sign in"))),(0,i.A)("form",{onSubmit:this.handleSubmit},void 0,(0,i.A)("div",{className:"modal-body"},void 0,(0,i.A)(h.A,{buttonLabel:pgettext("sign in modal","Sign in with %(site)s"),formLabel:pgettext("sign in modal","Or use your forum account:"),labelClassName:"text-center"}),(0,i.A)("div",{className:"form-group"},void 0,(0,i.A)("div",{className:"control-input"},void 0,(0,i.A)("input",{className:"form-control input-lg",disabled:this.state.isLoading,id:"id_username",onChange:this.bindInput("username"),placeholder:pgettext("sign in modal field","Username or e-mail"),type:"text",value:this.state.username}))),(0,i.A)("div",{className:"form-group"},void 0,(0,i.A)("div",{className:"control-input"},void 0,(0,i.A)("input",{className:"form-control input-lg",disabled:this.state.isLoading,id:"id_password",onChange:this.bindInput("password"),placeholder:pgettext("sign in modal field","Password"),type:"password",value:this.state.password})))),(0,i.A)("div",{className:"modal-footer"},void 0,this.getActivationButton(),(0,i.A)(d.A,{className:"btn-primary btn-block",loading:this.state.isLoading},void 0,pgettext("sign in modal btn","Sign in")),(0,i.A)("a",{className:"btn btn-default btn-block",href:c.A.get("FORGOTTEN_PASSWORD_URL")},void 0,pgettext("sign in modal btn","Forgot password?"))))))}}]),y}(p.A)},25155:(e,t,n)=>{"use strict";var a=n(73971),i=n(52762);a.A.addInitializer({name:"store",initializer:function(){i.A.init()},before:"_end"})},25583:(e,t,n)=>{"use strict";var a=n(73971),i=n(69387),o=n(24272);a.A.addInitializer({name:"zxcvbn",initializer:function(){o.A.init(i.A)}})},25913:(e,t,n)=>{"use strict";n.d(t,{ms:()=>m,rx:()=>A,Xy:()=>g,hO:()=>y,_2:()=>b,Qb:()=>D,dX:()=>x});var a=n(23029),i=n(92901),o=n(9417),r=n(15361),s=n(61801),u=n(53954),l=n(64467),c=n(32485),d=n.n(c),p=n(40927),h=n.n(p);var m=function(e){(0,r.A)(p,e);var t,n,c=(t=p,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}(),function(){var e,a=(0,u.A)(t);if(n){var i=(0,u.A)(this).constructor;e=Reflect.construct(a,arguments,i)}else e=a.apply(this,arguments);return(0,s.A)(this,e)});function p(e){var t;return(0,a.A)(this,p),t=c.call(this,e),(0,l.A)((0,o.A)(t),"handleClick",function(e){t.state.isOpen&&(!t.root.contains(e.target)||t.menu.contains(e.target)&&e.target.closest("a"))&&t.setState({isOpen:!1})}),(0,l.A)((0,o.A)(t),"toggle",function(){t.setState(function(e){return{isOpen:!e.isOpen}})}),(0,l.A)((0,o.A)(t),"close",function(){t.setState({isOpen:!1})}),t.state={isOpen:!1},t.root=null,t.dropdown=null,t}return(0,i.A)(p,[{key:"componentDidMount",value:function(){window.addEventListener("click",this.handleClick)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("click",this.handleClick)}},{key:"componentDidUpdate",value:function(e,t){t.isOpen!==this.state.isOpen&&(this.state.isOpen&&this.props.onOpen&&this.props.onOpen(this.root),!this.state.isOpen&&this.props.onClose&&this.props.onClose(this.root))}},{key:"render",value:function(){var e=this,t=this.state.isOpen;return h().createElement("div",{id:this.props.id,className:d()("dropdown",{open:t},this.props.className),ref:function(t){t&&!e.element&&(e.root=t)}},this.props.toggle({isOpen:t,toggle:this.toggle,aria:f(t)}),h().createElement("div",{className:d()("dropdown-menu",{"dropdown-menu-right":this.props.menuAlignRight},this.props.menuClassName),ref:function(t){t&&!e.menu&&(e.menu=t)},role:"menu"},this.props.children({isOpen:t,close:this.close})))}}]),p}(h().Component);function f(e){return{"aria-haspopup":"true","aria-expanded":e?"true":"false"}}var v=n(73620);function A(e){var t=e.className;return(0,v.A)("li",{className:d()("divider",t)})}function g(e){var t=e.children;return e.listItem?(0,v.A)("li",{className:"dropdown-footer"},void 0,t):(0,v.A)("div",{className:"dropdown-footer"},void 0,t)}function y(e){var t=e.className,n=e.children;return(0,v.A)("div",{className:d()("dropdown-header",t)},void 0,n)}function b(e){var t=e.className,n=e.children;return(0,v.A)("li",{className:d()("dropdown-menu-item",t)},void 0,n)}function D(e){var t=e.className,n=e.children;return(0,v.A)("div",{className:d()("dropdown-pills",t)},void 0,n)}function x(e){var t=e.className,n=e.children;return(0,v.A)("li",{className:d()("dropdown-subheader",t)},void 0,n)}},26413:(e,t,n)=>{"use strict";var a,i=n(73620),o=n(23029),r=n(92901),s=n(15361),u=n(61801),l=n(53954),c=n(40927),d=n.n(c),p=n(67467),h=n(9417),m=n(64467),f=n(48995),v=n(28542),A=n(92324),g=function(e,t){var n=e;return"rank"===t.component?n+=t.slug:n+=t.component,n+"/"};const y=function(e){var t=e.baseUrl,n=e.page,o=e.pages;return(0,i.A)("div",{className:"nav-container"},void 0,(0,i.A)("div",{className:"dropdown hidden-sm hidden-md hidden-lg"},void 0,(0,i.A)("button",{className:"btn btn-default btn-block btn-outline dropdown-toggle",type:"button","data-toggle":"dropdown","aria-haspopup":"true","aria-expanded":"false"},void 0,a||(a=(0,i.A)("span",{className:"material-icon"},void 0,"menu")),n.name),(0,i.A)("ul",{className:"dropdown-menu stick-to-bottom"},void 0,o.map(function(e){var n=g(t,e);return(0,i.A)("li",{},n,(0,i.A)(v.N_,{to:n},void 0,e.name))}))),(0,i.A)("ul",{className:"nav nav-pills hidden-xs",role:"menu"},void 0,o.map(function(e){var n=g(t,e);return(0,i.A)(A.A,{path:n},n,(0,i.A)(v.N_,{to:n},void 0,e.name))})))};var b,D,x=function(e){(0,s.A)(c,e);var t,n,a=(t=c,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}(),function(){var e,a=(0,l.A)(t);if(n){var i=(0,l.A)(this).constructor;e=Reflect.construct(a,arguments,i)}else e=a.apply(this,arguments);return(0,u.A)(this,e)});function c(){return(0,o.A)(this,c),a.apply(this,arguments)}return(0,r.A)(c,[{key:"getEmptyMessage",value:function(){return interpolate(npgettext("top posters empty","No users have posted any new messages during last %(days)s day.","No users have posted any new messages during last %(days)s days.",this.props.trackedPeriod),{days:this.props.trackedPeriod},!0)}},{key:"render",value:function(){return(0,i.A)("div",{className:"active-posters-list"},void 0,(0,i.A)(f.A,{},void 0,(0,i.A)(y,{baseUrl:misago.get("USERS_LIST_URL"),page:this.props.page,pages:misago.get("USERS_LISTS")}),(0,i.A)("p",{className:"lead"},void 0,this.getEmptyMessage())))}}]),c}(d().Component),k=n(30330),_=n(33097);var N=function(e){(0,s.A)(c,e);var t,n,a=(t=c,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}(),function(){var e,a=(0,l.A)(t);if(n){var i=(0,l.A)(this).constructor;e=Reflect.construct(a,arguments,i)}else e=a.apply(this,arguments);return(0,u.A)(this,e)});function c(){return(0,o.A)(this,c),a.apply(this,arguments)}return(0,r.A)(c,[{key:"shouldComponentUpdate",value:function(){return!1}},{key:"getClassName",value:function(){return this.props.hiddenOnMobile?"list-group-item hidden-xs hidden-sm":"list-group-item"}},{key:"render",value:function(){return(0,i.A)("li",{className:this.getClassName()},void 0,b||(b=(0,i.A)("div",{className:"rank-user-avatar"},void 0,(0,i.A)("span",{},void 0,(0,i.A)(k.Ay,{size:"50"})))),(0,i.A)("div",{className:"rank-user"},void 0,(0,i.A)("div",{className:"user-name"},void 0,(0,i.A)("span",{className:"item-title"},void 0,(0,i.A)("span",{className:"ui-preview-text",style:{width:_.W(30,80)+"px"}},void 0,"Â "))),(0,i.A)("div",{className:"user-details"},void 0,(0,i.A)("span",{className:"user-status"},void 0,D||(D=(0,i.A)("span",{className:"status-icon ui-preview-text"},void 0,"Â ")),(0,i.A)("span",{className:"status-label ui-preview-text hidden-xs hidden-sm",style:{width:_.W(30,50)+"px"}},void 0,"Â ")),(0,i.A)("span",{className:"rank-name"},void 0,(0,i.A)("span",{className:"ui-preview-text",style:{width:_.W(30,50)+"px"}},void 0,"Â ")),(0,i.A)("span",{className:"user-title hidden-xs hidden-sm"},void 0,(0,i.A)("span",{className:"ui-preview-text",style:{width:_.W(30,50)+"px"}},void 0,"Â "))),(0,i.A)("div",{className:"user-compact-stats visible-xs-block"},void 0,(0,i.A)("span",{className:"rank-position"},void 0,(0,i.A)("strong",{},void 0,(0,i.A)("span",{className:"ui-preview-text",style:{width:_.W(20,30)+"px"}},void 0,"Â ")),(0,i.A)("small",{},void 0,pgettext("top posters list item","Rank"))),(0,i.A)("span",{className:"rank-posts-counted"},void 0,(0,i.A)("strong",{},void 0,(0,i.A)("span",{className:"ui-preview-text",style:{width:_.W(20,30)+"px"}},void 0,"Â ")),(0,i.A)("small",{},void 0,pgettext("top posters list item","Ranked posts"))))),(0,i.A)("div",{className:"rank-position hidden-xs"},void 0,(0,i.A)("strong",{},void 0,(0,i.A)("span",{className:"ui-preview-text",style:{width:_.W(20,30)+"px"}},void 0,"Â ")),(0,i.A)("small",{},void 0,pgettext("top posters list item","Rank"))),(0,i.A)("div",{className:"rank-posts-counted hidden-xs"},void 0,(0,i.A)("strong",{},void 0,(0,i.A)("span",{className:"ui-preview-text",style:{width:_.W(20,30)+"px"}},void 0,"Â ")),(0,i.A)("small",{},void 0,pgettext("top posters list item","Ranked posts"))),(0,i.A)("div",{className:"rank-posts-total hidden-xs"},void 0,(0,i.A)("strong",{},void 0,(0,i.A)("span",{className:"ui-preview-text",style:{width:_.W(20,30)+"px"}},void 0,"Â ")),(0,i.A)("small",{},void 0,pgettext("top posters list item","Total posts"))))}}]),c}(d().Component);var C,E=function(e){(0,s.A)(c,e);var t,n,a=(t=c,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}(),function(){var e,a=(0,l.A)(t);if(n){var i=(0,l.A)(this).constructor;e=Reflect.construct(a,arguments,i)}else e=a.apply(this,arguments);return(0,u.A)(this,e)});function c(){return(0,o.A)(this,c),a.apply(this,arguments)}return(0,r.A)(c,[{key:"shouldComponentUpdate",value:function(){return!1}},{key:"render",value:function(){return(0,i.A)("div",{className:"active-posters-list"},void 0,(0,i.A)(f.A,{},void 0,(0,i.A)(y,{baseUrl:misago.get("USERS_LIST_URL"),page:this.props.page,pages:misago.get("USERS_LISTS")}),(0,i.A)("p",{className:"lead ui-preview"},void 0,(0,i.A)("span",{className:"ui-preview-text",style:{width:_.W(50,220)+"px"}},void 0,"Â ")),(0,i.A)("div",{className:"active-posters ui-preview"},void 0,(0,i.A)("ul",{className:"list-group"},void 0,[0,1,2].map(function(e){return(0,i.A)(N,{hiddenOnMobile:e>0},e)})))))}}]),c}(d().Component),w=n(41467),F=n(73971);var R=function(e){(0,s.A)(c,e);var t,n,a=(t=c,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}(),function(){var e,a=(0,l.A)(t);if(n){var i=(0,l.A)(this).constructor;e=Reflect.construct(a,arguments,i)}else e=a.apply(this,arguments);return(0,u.A)(this,e)});function c(){return(0,o.A)(this,c),a.apply(this,arguments)}return(0,r.A)(c,[{key:"getClassName",value:function(){return this.props.rank.css_class?"list-group-item list-group-rank-"+this.props.rank.css_class:"list-group-item"}},{key:"getUserStatus",value:function(){return this.props.user.status?(0,i.A)(w.Ay,{user:this.props.user,status:this.props.user.status},void 0,(0,i.A)(w.kW,{user:this.props.user,status:this.props.user.status}),(0,i.A)(w.VX,{user:this.props.user,status:this.props.user.status,className:"status-label hidden-xs hidden-sm"})):(0,i.A)("span",{className:"user-status"},void 0,C||(C=(0,i.A)("span",{className:"status-icon ui-preview-text"},void 0,"Â ")),(0,i.A)("span",{className:"status-label ui-preview-text hidden-xs hidden-sm",style:{width:_.W(30,50)+"px"}},void 0,"Â "))}},{key:"getRankName",value:function(){if(!this.props.rank.is_tab)return(0,i.A)("span",{className:"rank-name item-title"},void 0,this.props.rank.name);var e=F.A.get("USERS_LIST_URL")+this.props.rank.slug+"/";return(0,i.A)(v.N_,{to:e,className:"rank-name item-title"},void 0,this.props.rank.name)}},{key:"getUserTitle",value:function(){return this.props.user.title?(0,i.A)("span",{className:"user-title hidden-xs hidden-sm"},void 0,this.props.user.title):null}},{key:"render",value:function(){return(0,i.A)("li",{className:this.getClassName()},void 0,(0,i.A)("div",{className:"rank-user-avatar"},void 0,(0,i.A)("a",{href:this.props.user.url},void 0,(0,i.A)(k.Ay,{user:this.props.user,size:50,size2x:64}))),(0,i.A)("div",{className:"rank-user"},void 0,(0,i.A)("div",{className:"user-name"},void 0,(0,i.A)("a",{href:this.props.user.url,className:"item-title"},void 0,this.props.user.username)),(0,i.A)("div",{className:"user-details"},void 0,this.getUserStatus(),this.getRankName(),this.getUserTitle()),(0,i.A)("div",{className:"user-compact-stats visible-xs-block"},void 0,(0,i.A)("span",{className:"rank-position"},void 0,(0,i.A)("strong",{},void 0,"#",this.props.counter),(0,i.A)("small",{},void 0,pgettext("top posters list item","Rank"))),(0,i.A)("span",{className:"rank-posts-counted"},void 0,(0,i.A)("strong",{},void 0,this.props.user.meta.score),(0,i.A)("small",{},void 0,pgettext("top posters list item","Ranked posts"))))),(0,i.A)("div",{className:"rank-position hidden-xs"},void 0,(0,i.A)("strong",{},void 0,"#",this.props.counter),(0,i.A)("small",{},void 0,pgettext("top posters list item","Rank"))),(0,i.A)("div",{className:"rank-posts-counted hidden-xs"},void 0,(0,i.A)("strong",{},void 0,this.props.user.meta.score),(0,i.A)("small",{},void 0,pgettext("top posters list item","Ranked posts"))),(0,i.A)("div",{className:"rank-posts-total hidden-xs"},void 0,(0,i.A)("strong",{},void 0,this.props.user.posts),(0,i.A)("small",{},void 0,pgettext("top posters list item","Total posts"))))}}]),c}(d().Component);var S=function(e){(0,s.A)(c,e);var t,n,a=(t=c,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}(),function(){var e,a=(0,l.A)(t);if(n){var i=(0,l.A)(this).constructor;e=Reflect.construct(a,arguments,i)}else e=a.apply(this,arguments);return(0,u.A)(this,e)});function c(){return(0,o.A)(this,c),a.apply(this,arguments)}return(0,r.A)(c,[{key:"getLeadMessage",value:function(){var e=npgettext("top posters list","%(posters)s top poster from last %(days)s days.","%(posters)s top posters from last %(days)s days.",this.props.count);return interpolate(e,{posters:this.props.count,days:this.props.trackedPeriod},!0)}},{key:"render",value:function(){return(0,i.A)("div",{className:"active-posters-list"},void 0,(0,i.A)(f.A,{},void 0,(0,i.A)(y,{baseUrl:misago.get("USERS_LIST_URL"),page:this.props.page,pages:misago.get("USERS_LISTS")}),(0,i.A)("p",{className:"lead"},void 0,this.getLeadMessage()),(0,i.A)("div",{className:"active-posters ui-ready"},void 0,(0,i.A)("ul",{className:"list-group"},void 0,this.props.users.map(function(e,t){return(0,i.A)(R,{user:e,rank:e.rank,counter:t+1},e.id)})))))}}]),c}(d().Component),B=n(97414),L=n(22557),T=n(52762),O=n(39395);var P=function(e){(0,s.A)(c,e);var t,n,a=(t=c,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}(),function(){var e,a=(0,l.A)(t);if(n){var i=(0,l.A)(this).constructor;e=Reflect.construct(a,arguments,i)}else e=a.apply(this,arguments);return(0,u.A)(this,e)});function c(e){var t;return(0,o.A)(this,c),t=a.call(this,e),(0,m.A)((0,h.A)(t),"update",function(e){T.A.dispatch((0,B.Qv)(e.results)),t.setState({isLoaded:!0,trackedPeriod:e.tracked_period,count:e.count})}),F.A.has("USERS")?t.initWithPreloadedData(F.A.pop("USERS")):t.initWithoutPreloadedData(),t.startPolling(),t}return(0,r.A)(c,[{key:"initWithPreloadedData",value:function(e){this.state={isLoaded:!0,trackedPeriod:e.tracked_period,count:e.count},T.A.dispatch((0,B.Qv)(e.results))}},{key:"initWithoutPreloadedData",value:function(){this.state={isLoaded:!1}}},{key:"startPolling",value:function(){L.A.start({poll:"active-posters",url:F.A.get("USERS_API"),data:{list:"active"},frequency:9e4,update:this.update})}},{key:"componentDidMount",value:function(){O.A.set({title:this.props.route.extra.name,parent:pgettext("users page title","Users")})}},{key:"componentWillUnmount",value:function(){L.A.stop("active-posters")}},{key:"render",value:function(){var e={name:this.props.route.extra.name};return this.state.isLoaded?this.state.count>0?(0,i.A)(S,{page:e,users:this.props.users,trackedPeriod:this.state.trackedPeriod,count:this.state.count}):(0,i.A)(x,{page:e,trackedPeriod:this.state.trackedPeriod}):(0,i.A)(E,{page:e})}}]),c}(d().Component);var I=function(e){(0,s.A)(c,e);var t,n,a=(t=c,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}(),function(){var e,a=(0,l.A)(t);if(n){var i=(0,l.A)(this).constructor;e=Reflect.construct(a,arguments,i)}else e=a.apply(this,arguments);return(0,u.A)(this,e)});function c(){return(0,o.A)(this,c),a.apply(this,arguments)}return(0,r.A)(c,[{key:"getClassName",value:function(){return this.props.copy&&this.props.copy.length&&1===function(e,t){if(e=(e+"").toLowerCase(),(t=(t+"").toLowerCase()).length<=0)return 0;for(var n=0,a=0,i=t.length;(a=e.indexOf(t,a))>=0;)n+=1,a+=i;return n}(this.props.copy,"<p")&&-1===this.props.copy.indexOf("<br")?"page-lead lead":"page-lead"}},{key:"render",value:function(){return this.props.copy&&this.props.copy.length?(0,i.A)("div",{className:this.getClassName(),dangerouslySetInnerHTML:{__html:this.props.copy}}):null}}]),c}(d().Component),q=n(49954);const U=function(e){var t=e.users;return(0,i.A)(q.A,{cols:4,isReady:!0,showStatus:!0,users:t})};var j;const M=function(e){(0,s.A)(c,e);var t,n,a=(t=c,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}(),function(){var e,a=(0,l.A)(t);if(n){var i=(0,l.A)(this).constructor;e=Reflect.construct(a,arguments,i)}else e=a.apply(this,arguments);return(0,u.A)(this,e)});function c(){var e;(0,o.A)(this,c);for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return e=a.call.apply(a,[this].concat(n)),(0,m.A)((0,h.A)(e),"render",function(){return j||(j=(0,i.A)(q.A,{cols:4,isReady:!1}))}),e}return(0,r.A)(c,[{key:"shouldComponentUpdate",value:function(){return!1}}]),c}(d().Component);var z=n(98088);const H=function(e){var t=e.users;return t.more?(0,i.A)("p",{},void 0,interpolate(npgettext("rank users list","There is %(more)s more user with this rank.","There are %(more)s more users with this rank.",t.more),{more:t.more},!0)):(0,i.A)("p",{},void 0,pgettext("rank users list empty","There are no more users with this rank."))};var V,Y,W,G,Q,K,X,J;const $=function(e){var t=e.baseUrl,n=e.users;return(0,i.A)("div",{className:"misago-pagination"},void 0,n.isLoaded&&n.first?(0,i.A)(v.N_,{className:"btn btn-default btn-outline btn-icon",to:t,title:pgettext("rank users list paginator","Go to first page")},void 0,V||(V=(0,i.A)("span",{className:"material-icon"},void 0,"first_page"))):(0,i.A)("button",{className:"btn btn-default btn-outline btn-icon",title:pgettext("rank users list paginator","Go to first page"),type:"button",disabled:!0},void 0,Y||(Y=(0,i.A)("span",{className:"material-icon"},void 0,"first_page"))),n.isLoaded&&n.previous?(0,i.A)(v.N_,{className:"btn btn-default btn-outline btn-icon",to:t+(n.previous>1?n.previous+"/":""),title:pgettext("rank users list paginator","Go to previous page")},void 0,W||(W=(0,i.A)("span",{className:"material-icon"},void 0,"chevron_left"))):(0,i.A)("button",{className:"btn btn-default btn-outline btn-icon",title:pgettext("rank users list paginator","Go to previous page"),type:"button",disabled:!0},void 0,G||(G=(0,i.A)("span",{className:"material-icon"},void 0,"chevron_left"))),n.isLoaded&&n.next?(0,i.A)(v.N_,{className:"btn btn-default btn-outline btn-icon",to:t+n.next+"/",title:pgettext("rank users list paginator","Go to next page")},void 0,Q||(Q=(0,i.A)("span",{className:"material-icon"},void 0,"chevron_right"))):(0,i.A)("button",{className:"btn btn-default btn-outline btn-icon",title:pgettext("rank users list paginator","Go to next page"),type:"button",disabled:!0},void 0,K||(K=(0,i.A)("span",{className:"material-icon"},void 0,"chevron_right"))),n.isLoaded&&n.last?(0,i.A)(v.N_,{className:"btn btn-default btn-outline btn-icon",to:t+n.last+"/",title:pgettext("rank users list paginator","Go to last page")},void 0,X||(X=(0,i.A)("span",{className:"material-icon"},void 0,"last_page"))):(0,i.A)("button",{className:"btn btn-default btn-outline btn-icon",title:pgettext("rank users list paginator","Go to last page"),type:"button",disabled:!0},void 0,J||(J=(0,i.A)("span",{className:"material-icon"},void 0,"last_page"))))},Z=function(e){var t=e.baseUrl,n=e.users;return(0,i.A)(z.M7,{},void 0,(0,i.A)(z.rk,{},void 0,(0,i.A)(z.Tm,{},void 0,(0,i.A)($,{baseUrl:t,users:n}))),(0,i.A)(z.rk,{auto:!0},void 0,(0,i.A)(z.Tm,{},void 0,(0,i.A)(H,{users:n}))))};var ee;var te=function(e){(0,s.A)(c,e);var t,n,a=(t=c,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}(),function(){var e,a=(0,l.A)(t);if(n){var i=(0,l.A)(this).constructor;e=Reflect.construct(a,arguments,i)}else e=a.apply(this,arguments);return(0,u.A)(this,e)});function c(e){var t;return(0,o.A)(this,c),t=a.call(this,e),(0,m.A)((0,h.A)(t),"update",function(e){T.A.dispatch((0,B.Qv)(e.results)),e.isLoaded=!0,t.setState(e)}),F.A.has("USERS")?t.initWithPreloadedData(F.A.pop("USERS")):t.initWithoutPreloadedData(),t.startPolling(e.params.page||1),t}return(0,r.A)(c,[{key:"initWithPreloadedData",value:function(e){this.state=Object.assign(e,{isLoaded:!0}),T.A.dispatch((0,B.Qv)(e.results))}},{key:"initWithoutPreloadedData",value:function(){this.state={isLoaded:!1}}},{key:"startPolling",value:function(e){L.A.start({poll:"rank-users",url:F.A.get("USERS_API"),data:{rank:this.props.route.rank.id,page:e},frequency:9e4,update:this.update})}},{key:"componentDidMount",value:function(){O.A.set({title:this.props.route.rank.name,page:this.props.params.page||null,parent:pgettext("users page title","Users")})}},{key:"componentWillUnmount",value:function(){L.A.stop("rank-users")}},{key:"componentWillReceiveProps",value:function(e){this.props.params.page!==e.params.page&&(O.A.set({title:this.props.route.rank.name,page:e.params.page||null,parent:pgettext("users page title","Users")}),this.setState({isLoaded:!1}),L.A.stop("rank-users"),this.startPolling(e.params.page))}},{key:"getClassName",value:function(){return this.props.route.rank.css_class?"rank-users-list rank-users-"+this.props.route.rank.css_class:"rank-users-list"}},{key:"getRankDescription",value:function(){return this.props.route.rank.description?(0,i.A)("div",{className:"rank-description"},void 0,(0,i.A)(I,{copy:this.props.route.rank.description.html})):null}},{key:"getComponent",value:function(){return this.state.isLoaded?this.state.count>0?(0,i.A)(U,{users:this.props.users}):(0,i.A)("p",{className:"lead"},void 0,pgettext("rank users list","There are no users with this rank at the moment.")):ee||(ee=(0,i.A)(M,{}))}},{key:"render",value:function(){return(0,i.A)("div",{className:this.getClassName()},void 0,(0,i.A)(f.A,{},void 0,(0,i.A)(y,{baseUrl:F.A.get("USERS_LIST_URL"),page:{name:this.props.route.rank.name},pages:F.A.get("USERS_LISTS")}),this.getRankDescription(),this.getComponent(),(0,i.A)(Z,{baseUrl:F.A.get("USERS_LIST_URL")+this.props.route.rank.slug+"/",users:this.state})))}}]),c}(d().Component),ne=n(85057),ae=n(8041);var ie=function(e){(0,s.A)(c,e);var t,n,a=(t=c,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}(),function(){var e,a=(0,l.A)(t);if(n){var i=(0,l.A)(this).constructor;e=Reflect.construct(a,arguments,i)}else e=a.apply(this,arguments);return(0,u.A)(this,e)});function c(){return(0,o.A)(this,c),a.apply(this,arguments)}return(0,r.A)(c,[{key:"render",value:function(){return(0,i.A)("div",{className:"page page-users-lists"},void 0,(0,i.A)(ae.ud,{},void 0,(0,i.A)(ae.zY,{styleName:"users-lists"},void 0,(0,i.A)(ae.d4,{styleName:"users-lists"},void 0,(0,i.A)("h1",{},void 0,pgettext("users page title","Users"))))),this.props.children)}}]),c}(ne.A);function oe(e){return{tick:e.tick.tick,user:e.auth.user,users:e.users}}function re(){var e=[];return F.A.get("USERS_LISTS").forEach(function(t){"rank"===t.component?(e.push({path:F.A.get("USERS_LIST_URL")+t.slug+"/:page/",component:(0,p.Ng)(oe)(te),rank:t}),e.push({path:F.A.get("USERS_LIST_URL")+t.slug+"/",component:(0,p.Ng)(oe)(te),rank:t})):"active-posters"===t.component&&e.push({path:F.A.get("USERS_LIST_URL")+t.component+"/",component:(0,p.Ng)(oe)(P),extra:{name:t.name}})}),e}var se=n(88095);F.A.addInitializer({name:"component:users",initializer:function(e){e.has("USERS_LISTS")&&(0,se.A)({root:F.A.get("USERS_LIST_URL"),component:ie,paths:re()})},after:"store"})},26678:(e,t,n)=>{"use strict";var a=n(73971),i=n(22926),o=n(52762);a.A.addInitializer({name:"reducer:overlay",initializer:function(e){o.A.addReducer("overlay",i.Ay,i.ue)},before:"store"})},27860:(e,t,n)=>{"use strict";n.d(t,{A:()=>h});var a,i=n(73620),o=n(23029),r=n(92901),s=n(15361),u=n(61801),l=n(53954),c=n(40927),d=n.n(c),p=n(27944);var h=function(e){(0,s.A)(d,e);var t,n,c=(t=d,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}(),function(){var e,a=(0,l.A)(t);if(n){var i=(0,l.A)(this).constructor;e=Reflect.construct(a,arguments,i)}else e=a.apply(this,arguments);return(0,u.A)(this,e)});function d(){return(0,o.A)(this,d),c.apply(this,arguments)}return(0,r.A)(d,[{key:"render",value:function(){return a||(a=(0,i.A)("div",{className:"modal-body modal-loader"},void 0,(0,i.A)(p.A,{})))}}]),d}(d().Component)},27944:(e,t,n)=>{"use strict";n.d(t,{A:()=>o});var a,i=n(73620);function o(e){return(0,i.A)("div",{className:e.className||"loader"},void 0,a||(a=(0,i.A)("div",{className:"loader-spinning-wheel"})))}n(40927)},29124:(e,t,n)=>{"use strict";function a(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=[],i=[];if(e.forEach(function(e){i.push(e),i.length===t&&(a.push(i),i=[])}),!1!==n&&i.length>0&&i.length<t)for(var o=i.length;o<t;o++)i.push(n);return i.length&&a.push(i),a}n.d(t,{A:()=>a})},29156:(e,t,n)=>{"use strict";n.d(t,{Ay:()=>A,HC:()=>m,Qv:()=>d,S2:()=>p,_r:()=>h,iO:()=>v,yo:()=>f});var a=n(95093),i=n.n(a),o=n(51433),r="BUSY_THREAD",s="RELEASE_THREAD",u="REPLACE_THREAD",l="UPDATE_THREAD",c="UPDATE_THREAD_ACL";function d(e){return Object.assign({},e,{started_on:i()(e.started_on),last_post_on:i()(e.last_post_on),best_answer_marked_on:e.best_answer_marked_on?i()(e.best_answer_marked_on):null,isBusy:!1})}function p(){return{type:r}}function h(){return{type:s}}function m(e){return{type:u,state:arguments.length>1&&void 0!==arguments[1]&&arguments[1]?e:d(e)}}function f(e){return{type:l,data:e}}function v(e){return{type:c,data:e}}function A(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;switch(t.type){case r:return Object.assign({},e,{isBusy:!0});case s:return Object.assign({},e,{isBusy:!1});case o.Vr:return Object.assign({},e,{poll:null});case o.By:return Object.assign({},e,{poll:t.state});case u:return t.state;case l:return Object.assign({},e,t.data);case c:var n=Object.assign({},e.acl,t.data);return Object.assign({},e,{acl:n});default:return e}}},29904:(e,t,n)=>{"use strict";n.d(t,{A:()=>s});var a=n(23029),i=n(92901),o=n(64467),r=n(72235);const s=new(function(){function e(){var t=this;(0,a.A)(this,e),(0,o.A)(this,"alert",function(e,n){t._timeout?(window.clearTimeout(t._timeout),t._store.dispatch((0,r.Ui)()),t._timeout=window.setTimeout(function(){t._timeout=null,t.alert(e,n)},300)):(t._store.dispatch((0,r.td)(e,n)),t._timeout=window.setTimeout(function(){t._store.dispatch((0,r.Ui)()),t._timeout=null},5e3))}),(0,o.A)(this,"info",function(e){t.alert(e,"info")}),(0,o.A)(this,"success",function(e){t.alert(e,"success")}),(0,o.A)(this,"warning",function(e){t.alert(e,"warning")}),(0,o.A)(this,"error",function(e){t.alert(e,"error")}),(0,o.A)(this,"apiError",function(e){var n=e.data?e.data.detail:e.detail;n||(n=0===e.status?pgettext("api error","Could not connect to the site."):404===e.status?pgettext("api error","Action link is invalid."):pgettext("api error","Unknown error has occurred.")),403===e.status&&"Permission denied"===n&&(n=pgettext("api error","You don't have permission to perform this action.")),t.error(n)})}return(0,i.A)(e,[{key:"init",value:function(e){this._store=e,this._timeout=null}}]),e}())},30330:(e,t,n)=>{"use strict";n.d(t,{Ay:()=>o});var a=n(73620),i=(n(40927),n(73971));function o(e){var t=e.size||100,n=e.size2x||2*t;return(0,a.A)("img",{alt:"",className:e.className||"user-avatar",src:r(e.user,t),srcSet:r(e.user,n),width:e.height||t,height:e.height||t})}function r(e,t){return e&&e.id?function(e,t){var n=e[0];return e.forEach(function(e){e.size>=t&&(n=e)}),n}(e.avatars,t).url:i.A.get("BLANK_AVATAR_URL")}},30530:(e,t,n)=>{"use strict";var a=n(73971),i=n(89053),o=n(52762);a.A.addInitializer({name:"reducer:participants",initializer:function(){var e=null;a.A.has("THREAD")&&(e=a.A.get("THREAD").participants),o.A.addReducer("participants",i.Ay,e||[])},before:"store"})},32148:(e,t,n)=>{"use strict";n.d(t,{Ay:()=>l,f9:()=>u,ue:()=>r,yo:()=>s});var a="REPLACE_SEARCH",i="UPDATE_SEARCH",o="UPDATE_SEARCH_PROVIDER",r={isLoading:!1,query:"",providers:[]};function s(e){return{type:i,update:e}}function u(e){return{type:o,provider:e}}function l(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;switch(t.type){case a:return t.state;case i:return Object.assign({},e,t.update);case o:return Object.assign({},e,{providers:e.providers.map(function(e){return e.id===t.provider.id?t.provider:e})});default:return e}}},33097:(e,t,n)=>{"use strict";function a(e,t){return Math.floor(Math.random()*(t-e+1))+e}n.d(t,{W:()=>a})},33864:(e,t,n)=>{"use strict";n.d(t,{A:()=>l});var a=n(73620),i=n(23029),o=n(92901),r=n(15361),s=n(61801),u=n(53954);n(40927);var l=function(e){(0,r.A)(c,e);var t,n,l=(t=c,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}(),function(){var e,a=(0,u.A)(t);if(n){var i=(0,u.A)(this).constructor;e=Reflect.construct(a,arguments,i)}else e=a.apply(this,arguments);return(0,s.A)(this,e)});function c(){return(0,i.A)(this,c),l.apply(this,arguments)}return(0,o.A)(c,[{key:"getHelpText",value:function(){return this.props.helpText?(0,a.A)("p",{className:"help-block"},void 0,this.props.helpText):null}},{key:"render",value:function(){return(0,a.A)("div",{className:"modal-body"},void 0,(0,a.A)("div",{className:"message-icon"},void 0,(0,a.A)("span",{className:"material-icon"},void 0,this.props.icon||"info_outline")),(0,a.A)("div",{className:"message-body"},void 0,(0,a.A)("p",{className:"lead"},void 0,this.props.message),this.getHelpText(),(0,a.A)("button",{className:"btn btn-default","data-dismiss":"modal",type:"button"},void 0,pgettext("modal message dismiss btn","Ok"))))}}]),c}(n(76671).A)},34047:(e,t,n)=>{"use strict";n.d(t,{$e:()=>f,Ay:()=>ln,Xd:()=>T,h2:()=>k});var a,i=n(40927),o=n.n(i),r=n(73620),s=n(92901),u=n(23029),l=n(9417),c=n(15361),d=n(61801),p=n(53954),h=n(64467),m=n(9801);var f=function(e){(0,c.A)(f,e);var t,n,i=(t=f,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}(),function(){var e,a=(0,p.A)(t);if(n){var i=(0,p.A)(this).constructor;e=Reflect.construct(a,arguments,i)}else e=a.apply(this,arguments);return(0,d.A)(this,e)});function f(e){var t;return(0,u.A)(this,f),t=i.call(this,e),(0,h.A)((0,l.A)(t),"selected",function(){if(t.element){var e=A(t.element)||null,n=e?e.getBoundingClientRect():null;t.setState({range:e,rect:n})}}),(0,h.A)((0,l.A)(t),"reply",function(){if(m.A.isOpen()){var e=T();e&&!e.disabled&&(e.quote(k(t.state.range)),t.setState({range:null,rect:null}),v())}else{var n=k(t.state.range);m.A.open(Object.assign({},t.props.posting,{default:n})),t.setState({range:null,rect:null}),window.setTimeout(v,1e3)}}),(0,h.A)((0,l.A)(t),"render",function(){return(0,r.A)("div",{},void 0,o().createElement("div",{ref:function(e){e&&(t.element=e)},onMouseUp:t.selected,onTouchEnd:t.selected},t.props.children),!!t.state.rect&&(0,r.A)("div",{className:"quote-control",style:{position:"absolute",left:t.state.rect.left+window.scrollX,top:t.state.rect.bottom+window.scrollY}},void 0,a||(a=(0,r.A)("div",{className:"quote-control-arrow"})),(0,r.A)("div",{className:"quote-control-inner"},void 0,(0,r.A)("button",{className:"btn quote-control-btn",type:"button",onClick:t.reply},void 0,pgettext("post reply","Quote")))))}),t.state={range:null,rect:null},t.element=null,t}return(0,s.A)(f)}(o().Component);function v(){var e=document.querySelector("#posting-mount textarea");e.focus(),e.selectionStart=e.selectionEnd=e.value.length}var A=function(e){if(void 0!==window.getSelection){var t=window.getSelection();if(t&&"Range"===t.type&&1===t.rangeCount){var n=t.getRangeAt(0);if(g(n,e)&&y(n)&&b(n.cloneContents()))return n}}},g=function(e,t){var n=e.commonAncestorContainer;if(n===t)return!0;for(var a=n.parentNode;a;){if(a===t)return!0;a=a.parentNode}return!1},y=function(e){var t=e.commonAncestorContainer;if("ARTICLE"===t.nodeName)return!0;if(t.dataset&&"1"===t.dataset.noquote)return!1;for(var n=t.parentNode;n;){if(n.dataset&&"1"===n.dataset.noquote)return!1;if("ARTICLE"===n.nodeName)return!0;n=n.parentNode}return!1},b=function e(t){for(var n=0;n<t.childNodes.length;n++){var a=t.childNodes[n];if(a.nodeType===Node.TEXT_NODE&&a.textContent&&a.textContent.trim().length>0)return!0;if("IMG"===a.nodeName)return!0;if(e(a))return!0}return!1},D=n(45458),x=n(80296);const k=function(e){var t=_(e),n=S(e.cloneContents().childNodes,[]),a=t?'[quote="'.concat(t,'"]\n'):"[quote]\n",i="\n[/quote]\n\n",o=E(e);return o?(a+=o.syntax?"[code=".concat(o.syntax,"]\n"):"[code]\n",i="\n[/code]"+i):F(e)?(n=n.trim(),a+="`",i="`"+i):n=n.trim(),a+n+i};var _=function(e){var t=e.commonAncestorContainer;if(N(t))return C(t);for(var n=t.parentNode;n;){if(N(n))return C(n);n=n.parentNode}return""},N=function(e){return e.nodeType===Node.ELEMENT_NODE&&("ARTICLE"===e.nodeName||"BLOCKQUOTE"===e.nodeName&&e.dataset&&"quote"===e.dataset.block)},C=function(e){return e.dataset&&e.dataset.author||null},E=function(e){var t=e.commonAncestorContainer;if(w(t))return R(t);for(var n=t.parentNode;n;){if(w(n))return R(n);n=n.parentNode}return null},w=function(e){return"PRE"===e.nodeName},F=function(e){var t=e.commonAncestorContainer;if("CODE"===t.nodeName)return!0;for(var n=t.parentNode;n;){if(N(n))return!1;if("CODE"===n.nodeName)return!0;n=n.parentNode}return!1},R=function(e){return e.dataset?{syntax:e.dataset.syntax||null}:{syntax:null}},S=function(e,t){for(var n="",a=0;a<e.length;a++){var i=e[a];n+=L(i,t)}return n},B={H1:["\n\n# ",""],H2:["\n\n## ",""],H3:["\n\n### ",""],H4:["\n\n#### ",""],H5:["\n\n##### ",""],H6:["\n\n###### ",""],STRONG:["**","**"],EM:["*","*"],DEL:["~~","~~"],B:["[b]","[/b]"],U:["[u]","[/u]"],I:["[i]","[/i]"],SUB:["[sub]","[/sub]"],SUP:["[sup]","[/sup]"]},L=function(e,t){var n=e.dataset||{};if(e.nodeType===Node.TEXT_NODE)return e.textContent||"";if(e.nodeType===Node.ELEMENT_NODE){if(n.quote)return n.quote||"";if("1"===n.noquote)return""}if(e.nodeType===Node.ELEMENT_NODE&&n.quote&&n.quote.trim())return"";if("HR"===e.nodeName)return"\n\n- - -";if(B[e.nodeName]){var a=(0,x.A)(B[e.nodeName],2),i=a[0],o=a[1];return i+S(e.childNodes,[].concat((0,D.A)(t),[e.nodeName]))+o}if("A"===e.nodeName){var r=e.href,s=S(e.childNodes,[].concat((0,D.A)(t),[e.nodeName]));return s?"[".concat(s,"](").concat(r,")"):"!(".concat(r,")")}if("IMG"===e.nodeName){var u=e.src,l=e.alt;return l?"![".concat(l,"](").concat(u,")"):"!(".concat(u,")")}if("DIV"===e.nodeName||"ASIDE"===e.nodeName){var c=n.block&&n.block.toUpperCase();if(c&&B[c]){var d=(0,x.A)(B[c],2),p=d[0],h=d[1];return p+S(e.childNodes,[].concat((0,D.A)(t),[c]))+h}return S(e.childNodes,t)}if("BLOCKQUOTE"===e.nodeName){if("spoiler"===n.block){var m=S(e.childNodes,[].concat((0,D.A)(t),["SPOILER"])).trim();if(!m)return"";var f="\n[spoiler]\n";return(f+=m)+"\n[/spoiler]"}var v=S(e.childNodes,[].concat((0,D.A)(t),["QUOTE"])).trim();if(!v)return"";var A=C(e),g=A?"\n[quote=".concat(A,"]\n"):"\n\n[quote]\n";return(g+=v)+"\n[/quote]"}if("PRE"===e.nodeName){var y=n.syntax||null,b=e.querySelector("code"),k=b&&b.innerText||"";return k.trim()?"\n[code"+(y?"="+y:"")+"]"+k+"[/code]":""}if("CODE"===e.nodeName)return"`"+e.innerText+"`";if("P"===e.nodeName)return"\n"+S(e.childNodes,[].concat((0,D.A)(t),[e.nodeName]));if("UL"===e.nodeName||"OL"===e.nodeName)return(0===t.filter(function(e){return"OL"===e||"UL"===e}).length?"\n":"")+S(e.childNodes,[].concat((0,D.A)(t),[e.nodeName]));if("LI"===e.nodeName){for(var _="",N=t.filter(function(e){return"OL"===e||"UL"===e}).length,E=1;E<N;E++)_+="    ";_+="OL"===t[t.length-1]?n.index?n.index+". ":"1. ":"- ";var w=S(e.childNodes,[].concat((0,D.A)(t),[e.nodeName]));return w.trim()?"\n"+_+w:""}return"SPAN"===e.nodeName?S(e.childNodes,t):""};function T(){return window.misagoReply}function O(e,t){window.misagoReply={disabled:e,quote:t}}function P(){window.misagoReply=null}var I=n(51828),q=n(849),U=n(95093),j=n.n(U);function M(e){return e.filter(function(e){return e.id&&!e.isRemoved}).map(function(e){return e.id})}var z,H=n(44549),V=n(92069),Y=n(29904),W=n(32485),G=n.n(W),Q=n(73971),K=n(35248),X=n(70490),J=n(18524);function $(e){var t=e.attachment;return(0,r.A)("div",{className:"modal-dialog modal-lg",role:"document"},void 0,(0,r.A)("div",{className:"modal-content"},void 0,(0,r.A)("div",{className:"modal-header"},void 0,(0,r.A)("button",{"aria-label":pgettext("modal","Close"),className:"close","data-dismiss":"modal",type:"button"},void 0,z||(z=(0,r.A)("span",{"aria-hidden":"true"},void 0,"Ã—"))),(0,r.A)("h4",{className:"modal-title"},void 0,pgettext("markup editor","Attachment details"))),(0,r.A)("div",{className:"modal-body"},void 0,!!t.is_image&&(0,r.A)("div",{className:"markup-editor-attachment-modal-preview"},void 0,(0,r.A)("a",{href:t.url.index+"?shva=1",target:"_blank"},void 0,(0,r.A)("img",{src:t.url.index+"?shva=1",alt:""}))),(0,r.A)("div",{className:"markup-editor-attachment-modal-filename"},void 0,t.filename),(0,r.A)("div",{className:"row markup-editor-attachment-modal-details"},void 0,(0,r.A)("div",{className:"col-xs-12 col-md-3"},void 0,(0,r.A)("strong",{},void 0,t.filetype+", "+(0,J.A)(t.size)),(0,r.A)("div",{className:"text-muted"},void 0,(0,r.A)("small",{},void 0,pgettext("markup editor","Type and size")))),(0,r.A)("div",{className:"col-xs-12 col-md-4"},void 0,(0,r.A)("strong",{},void 0,(0,r.A)("abbr",{title:t.uploaded_on.format("LLL")},void 0,t.uploaded_on.fromNow())),(0,r.A)("div",{className:"text-muted"},void 0,(0,r.A)("small",{},void 0,pgettext("markup editor","Uploaded at")))),(0,r.A)("div",{className:"col-xs-12 col-md-3"},void 0,t.url.uploader?(0,r.A)("a",{href:t.url.uploader,target:"_blank",className:"item-title"},void 0,t.uploader_name):(0,r.A)("span",{className:"item-title"},void 0,t.uploader_name),(0,r.A)("div",{className:"text-muted"},void 0,(0,r.A)("small",{},void 0,pgettext("markup editor","Uploader")))))),(0,r.A)("div",{className:"modal-footer"},void 0,(0,r.A)("button",{className:"btn btn-default","data-dismiss":"modal",type:"button"},void 0,pgettext("modal","Close")))))}var Z,ee,te,ne,ae=function(e,t,n,a,i){var o=e.text||i||"",r=e.prefix;r+=n+o+a,t(r+=e.suffix),window.setTimeout(function(){se(e.textarea);var t=e.start+n.length;e.textarea.setSelectionRange(t,t+o.length)},250)},ie=function(e,t,n){var a=e.prefix;a+=n,t(a+=e.suffix),window.setTimeout(function(){se(e.textarea);var t=e.end+n.length;e.textarea.setSelectionRange(t,t)},250)},oe=function(e){if(document.selection){e.focus();var t=document.selection.createRange(),n=t.text.length;return t.moveStart("character",-e.value.length),re(e,t.text.length-n,t.text.length)}if(e.selectionStart||"0"==e.selectionStart)return re(e,e.selectionStart,e.selectionEnd)},re=function(e,t,n){return{textarea:e,start:t,end:n,text:e.value.substring(t,n),prefix:e.value.substring(0,t),suffix:e.value.substring(n)}};function se(e){var t=e.scrollTop;e.focus(),e.scrollTop=t}const ue=function(e){var t,n=e.attachment,a=e.disabled,i=e.element,o=e.setState,s=e.update;return(0,r.A)("div",{className:"markup-editor-attachments-item"},void 0,(0,r.A)("div",{className:"markup-editor-attachment"},void 0,(0,r.A)("div",{className:"markup-editor-attachment-details"},void 0,n.id?(0,r.A)("a",{className:"item-title",href:n.url.index+"?shva=1",target:"_blank",onClick:function(e){e.preventDefault(),X.A.show(t||(t=(0,r.A)($,{attachment:n})))}},void 0,n.filename):(0,r.A)("strong",{className:"item-title"},void 0,n.filename),(0,r.A)("div",{className:"text-muted"},void 0,(0,r.A)("ul",{className:"list-unstyled list-inline"},void 0,!n.id&&(0,r.A)("li",{},void 0,n.progress+"%"),!!n.filetype&&(0,r.A)("li",{},void 0,n.filetype),n.size>0&&(0,r.A)("li",{},void 0,(0,J.A)(n.size))))),!!n.id&&(0,r.A)("div",{className:"markup-editor-attachment-buttons"},void 0,(0,r.A)("button",{className:"btn btn-markup-editor-attachment btn-icon",title:pgettext("markup editor","Insert into message"),type:"button",disabled:a,onClick:function(){var e=function(e){var t="[";return e.is_image?(t+="!["+e.filename+"]",t+="("+(e.url.thumb||e.url.index)+"?shva=1)"):t+=e.filename,t+="]("+e.url.index+"?shva=1)"}(n),t=oe(i);ie(t,s,e)}},void 0,Z||(Z=(0,r.A)("span",{className:"material-icon"},void 0,"flip_to_front"))),(0,r.A)("button",{className:"btn btn-markup-editor-attachment btn-icon",title:pgettext("markup editor","Remove attachment"),type:"button",disabled:a,onClick:function(){o(function(e){var t=e.attachments;if(window.confirm(pgettext("markup editor","Remove this attachment?")))return{attachments:t.filter(function(e){return e.id!==n.id})}})}},void 0,ee||(ee=(0,r.A)("span",{className:"material-icon"},void 0,"close")))),!n.id&&!!n.key&&(0,r.A)("div",{className:"markup-editor-attachment-buttons"},void 0,n.error&&(0,r.A)("button",{className:"btn btn-markup-editor-attachment btn-icon",title:pgettext("markup editor","See error"),type:"button",onClick:function(){Y.A.error(interpolate(pgettext("markup editor","%(filename)s: %(error)s"),{filename:n.filename,error:n.error},!0))}},void 0,te||(te=(0,r.A)("span",{className:"material-icon"},void 0,"warning"))),(0,r.A)("button",{className:"btn btn-markup-editor-attachment btn-icon",title:pgettext("markup editor","Remove attachment"),type:"button",disabled:a,onClick:function(){o(function(e){return{attachments:e.attachments.filter(function(e){return e.key!==n.key})}})}},void 0,ne||(ne=(0,r.A)("span",{className:"material-icon"},void 0,"close"))))))},le=function(e){var t=e.attachments,n=e.disabled,a=e.element,i=e.setState,o=e.update;return(0,r.A)("div",{className:"markup-editor-attachments"},void 0,(0,r.A)("div",{className:"markup-editor-attachments-container"},void 0,t.map(function(e){return(0,r.A)(ue,{attachment:e,disabled:n,element:a,setState:i,update:o},e.key||e.id)})))};var ce,de=n(39227);const pe=function(e){var t=e.canProtect,n=e.disabled,a=e.empty,i=e.preview,o=e.isProtected,s=e.submitText,u=e.showPreview,l=e.closePreview,c=e.enableProtection,d=e.disableProtection;return(0,r.A)("div",{className:"markup-editor-footer"},void 0,!!t&&(0,r.A)(de.A,{className:"btn-default btn-icon hidden-sm hidden-md hidden-lg",title:o?pgettext("markup editor","Protected"):pgettext("markup editor","Protect"),type:"button",disabled:n,onClick:function(){o?d():c()}},void 0,(0,r.A)("span",{className:"material-icon"},void 0,o?"lock":"lock_open")),!!t&&(0,r.A)("div",{},void 0,(0,r.A)(de.A,{className:"btn-default hidden-xs",type:"button",disabled:n,onClick:function(){o?d():c()}},void 0,(0,r.A)("span",{className:"material-icon"},void 0,o?"lock":"lock_open"),o?pgettext("markup editor","Protected"):pgettext("markup editor","Protect"))),ce||(ce=(0,r.A)("div",{className:"markup-editor-spacer"})),i?(0,r.A)(de.A,{className:"btn-default btn-auto",type:"button",onClick:l},void 0,pgettext("markup editor","Edit")):(0,r.A)(de.A,{className:"btn-default btn-auto",disabled:n||a,type:"button",onClick:u},void 0,pgettext("markup editor","Preview")),(0,r.A)(de.A,{className:"btn-primary btn-auto",disabled:n||a},void 0,s||pgettext("markup editor","Post")))};var he,me=n(82743);var fe=function(e){(0,c.A)(i,e);var t,n,a=(t=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}(),function(){var e,a=(0,p.A)(t);if(n){var i=(0,p.A)(this).constructor;e=Reflect.construct(a,arguments,i)}else e=a.apply(this,arguments);return(0,d.A)(this,e)});function i(e){var t;return(0,u.A)(this,i),t=a.call(this,e),(0,h.A)((0,l.A)(t),"handleSubmit",function(e){e.preventDefault();var n=t.props,a=n.selection,i=n.update,o=t.state.syntax.trim(),r=t.state.text.trim();if(0===r.length)return t.setState({error:gettext("This field is required.")}),!1;var s=a.prefix.trim().length?"\n\n":"";return ie(Object.assign({},a,{text:r}),i,s+"```"+o+"\n"+r+"\n```\n\n"),X.A.hide(),!1}),t.state={error:null,syntax:"",text:e.selection.text},t}return(0,s.A)(i,[{key:"render",value:function(){var e=this;return(0,r.A)("div",{className:"modal-dialog modal-lg",role:"document"},void 0,(0,r.A)("div",{className:"modal-content"},void 0,(0,r.A)("div",{className:"modal-header"},void 0,(0,r.A)("button",{"aria-label":pgettext("modal","Close"),className:"close","data-dismiss":"modal",type:"button"},void 0,he||(he=(0,r.A)("span",{"aria-hidden":"true"},void 0,"Ã—"))),(0,r.A)("h4",{className:"modal-title"},void 0,pgettext("markup editor","Code"))),(0,r.A)("form",{onSubmit:this.handleSubmit},void 0,(0,r.A)("div",{className:"modal-body"},void 0,(0,r.A)(me.A,{for:"markup_code_syntax",label:pgettext("markup editor","Syntax highlighting")},void 0,(0,r.A)("select",{id:"markup_code_syntax",className:"form-control",value:this.state.syntax,onChange:function(t){return e.setState({syntax:t.target.value})}},void 0,(0,r.A)("option",{value:""},void 0,pgettext("markup editor","No syntax highlighting")),ve.map(function(e){var t=e.value,n=e.name;return(0,r.A)("option",{value:t},t,n)}))),(0,r.A)(me.A,{for:"markup_code_text",label:pgettext("markup editor","Code to insert"),validation:this.state.error?[this.state.error]:void 0},void 0,(0,r.A)("textarea",{id:"markup_code_text",className:"form-control",rows:"8",value:this.state.text,onChange:function(t){return e.setState({text:t.target.value})}}))),(0,r.A)("div",{className:"modal-footer"},void 0,(0,r.A)("button",{className:"btn btn-default","data-dismiss":"modal",type:"button"},void 0,pgettext("markup editor","Cancel")),(0,r.A)("button",{className:"btn btn-primary"},void 0,pgettext("markup editor","Insert code"))))))}}]),i}(o().Component),ve=[{value:"bash",name:"Bash"},{value:"c",name:"C"},{value:"c#",name:"C#"},{value:"c++",name:"C++"},{value:"css",name:"CSS"},{value:"diff",name:"Diff"},{value:"go",name:"Go"},{value:"graphql",name:"GraphQL"},{value:"html,",name:"HTML"},{value:"xml",name:"XML"},{value:"json",name:"JSON"},{value:"java",name:"Java"},{value:"javascript",name:"JavaScript"},{value:"kotlin",name:"Kotlin"},{value:"less",name:"Less"},{value:"lua",name:"Lua"},{value:"makefile",name:"Makefile"},{value:"markdown",name:"Markdown"},{value:"objective-C",name:"Objective-C"},{value:"php",name:"PHP"},{value:"perl",name:"Perl"},{value:"plain",name:"Plain"},{value:"text",name:"text"},{value:"python",name:"Python"},{value:"repl",name:"REPL"},{value:"r",name:"R"},{value:"ruby",name:"Ruby"},{value:"rust",name:"Rust"},{value:"scss",name:"SCSS"},{value:"sql",name:"SQL"},{value:"shell",name:"Shell Session"},{value:"swift",name:"Swift"},{value:"toml",name:"TOML"},{value:"ini",name:"INI"},{value:"typescript",name:"TypeScript"},{value:"visualbasic",name:"Visual Basic .NET"},{value:"webassembly",name:"WebAssembly"},{value:"yaml",name:"YAML"}];const Ae=fe;var ge,ye,be,De,xe,ke,_e,Ne,Ce,Ee,we,Fe,Re,Se,Be,Le,Te,Oe,Pe,Ie,qe,Ue,je,Me,ze,He,Ve,Ye,We,Ge,Qe,Ke,Xe,Je,$e,Ze,et,tt,nt,at,it,ot,rt,st,ut;function lt(){return(0,r.A)("div",{className:"modal-dialog modal-lg",role:"document"},void 0,(0,r.A)("div",{className:"modal-content"},void 0,(0,r.A)("div",{className:"modal-header"},void 0,(0,r.A)("button",{"aria-label":pgettext("modal","Close"),className:"close","data-dismiss":"modal",type:"button"},void 0,ge||(ge=(0,r.A)("span",{"aria-hidden":"true"},void 0,"Ã—"))),(0,r.A)("h4",{className:"modal-title"},void 0,pgettext("markup help","Formatting help"))),(0,r.A)("div",{className:"modal-body formatting-help"},void 0,(0,r.A)("h4",{},void 0,pgettext("markup help","Emphasis text")),(0,r.A)(ct,{markup:pgettext("markup help","_This text will have emphasis_"),result:(0,r.A)("p",{},void 0,(0,r.A)("em",{},void 0,pgettext("markup help","This text will have emphasis")))}),ye||(ye=(0,r.A)("hr",{})),(0,r.A)("h4",{},void 0,pgettext("markup help","Bold text")),(0,r.A)(ct,{markup:pgettext("markup help","**This text will be bold**"),result:(0,r.A)("p",{},void 0,(0,r.A)("strong",{},void 0,pgettext("markup help","This text will be bold")))}),be||(be=(0,r.A)("hr",{})),(0,r.A)("h4",{},void 0,pgettext("markup help","Removed text")),(0,r.A)(ct,{markup:pgettext("markup help","~~This text will be removed~~"),result:(0,r.A)("p",{},void 0,(0,r.A)("del",{},void 0,pgettext("markup help","This text will be removed")))}),De||(De=(0,r.A)("hr",{})),(0,r.A)("h4",{},void 0,pgettext("markup help","Bold text (BBCode)")),(0,r.A)(ct,{markup:pgettext("markup help","[b]This text will be bold[/b]"),result:(0,r.A)("p",{},void 0,(0,r.A)("b",{},void 0,pgettext("markup help","This text will be bold")))}),xe||(xe=(0,r.A)("hr",{})),(0,r.A)("h4",{},void 0,pgettext("markup help","Underlined text (BBCode)")),(0,r.A)(ct,{markup:pgettext("markup help","[u]This text will be underlined[/u]"),result:(0,r.A)("p",{},void 0,(0,r.A)("u",{},void 0,pgettext("markup help","This text will be underlined")))}),ke||(ke=(0,r.A)("hr",{})),(0,r.A)("h4",{},void 0,pgettext("markup help","Italics text (BBCode)")),(0,r.A)(ct,{markup:pgettext("markup help","[i]This text will be in italics[/i]"),result:(0,r.A)("p",{},void 0,(0,r.A)("i",{},void 0,pgettext("markup help","This text will be in italics")))}),_e||(_e=(0,r.A)("hr",{})),(0,r.A)("h4",{},void 0,pgettext("markup help","Link")),Ne||(Ne=(0,r.A)(ct,{markup:"<http://example.com>",result:(0,r.A)("p",{},void 0,(0,r.A)("a",{href:"#"},void 0,"example.com"))})),Ce||(Ce=(0,r.A)("hr",{})),(0,r.A)("h4",{},void 0,pgettext("markup help","Link with text")),(0,r.A)(ct,{markup:"["+pgettext("markup help","Link text")+"](http://example.com)",result:(0,r.A)("p",{},void 0,(0,r.A)("a",{href:"#"},void 0,pgettext("markup help","Link text")))}),Ee||(Ee=(0,r.A)("hr",{})),(0,r.A)("h4",{},void 0,pgettext("markup help","Link (BBCode)")),we||(we=(0,r.A)(ct,{markup:"[url]http://example.com[/url]",result:(0,r.A)("p",{},void 0,(0,r.A)("a",{href:"#"},void 0,"example.com"))})),Fe||(Fe=(0,r.A)("hr",{})),(0,r.A)("h4",{},void 0,pgettext("markup help","Link with text (BBCode)")),(0,r.A)(ct,{markup:"[url=http://example.com]"+pgettext("markup help","Link text")+"[/url]",result:(0,r.A)("p",{},void 0,(0,r.A)("a",{href:"#"},void 0,pgettext("markup help","Link text")))}),Re||(Re=(0,r.A)("hr",{})),(0,r.A)("h4",{},void 0,pgettext("markup help","Image")),Se||(Se=(0,r.A)(ct,{markup:"!(http://dummyimage.com/38/38)",result:(0,r.A)("p",{},void 0,(0,r.A)("img",{alt:"",src:"http://dummyimage.com/38/38"}))})),Be||(Be=(0,r.A)("hr",{})),(0,r.A)("h4",{},void 0,pgettext("markup help","Image with alternate text")),(0,r.A)(ct,{markup:"!["+pgettext("markup help","Image text")+"](http://dummyimage.com/38/38)",result:(0,r.A)("p",{},void 0,(0,r.A)("img",{alt:pgettext("markup help","Image text"),src:"http://dummyimage.com/38/38"}))}),Le||(Le=(0,r.A)("hr",{})),(0,r.A)("h4",{},void 0,pgettext("markup help","Image (BBCode)")),Te||(Te=(0,r.A)(ct,{markup:"[img]http://dummyimage.com/38/38[/img]",result:(0,r.A)("p",{},void 0,(0,r.A)("img",{alt:"",src:"http://dummyimage.com/38/38"}))})),Oe||(Oe=(0,r.A)("hr",{})),(0,r.A)("h4",{},void 0,pgettext("markup help","Mention user by their name")),Pe||(Pe=(0,r.A)(ct,{markup:"@username",result:(0,r.A)("p",{},void 0,(0,r.A)("a",{href:"#"},void 0,"@username"))})),Ie||(Ie=(0,r.A)("hr",{})),(0,r.A)("h4",{},void 0,pgettext("markup help","Heading 1")),(0,r.A)(ct,{markup:pgettext("markup help","# First level heading"),result:(0,r.A)("h1",{},void 0,pgettext("markup help","First level heading"))}),qe||(qe=(0,r.A)("hr",{})),(0,r.A)("h4",{},void 0,pgettext("markup help","Heading 2")),(0,r.A)(ct,{markup:pgettext("markup help","## Second level heading"),result:(0,r.A)("h2",{},void 0,pgettext("markup help","Second level heading"))}),Ue||(Ue=(0,r.A)("hr",{})),(0,r.A)("h4",{},void 0,pgettext("markup help","Heading 3")),(0,r.A)(ct,{markup:pgettext("markup help","### Third level heading"),result:(0,r.A)("h3",{},void 0,pgettext("markup help","Third level heading"))}),je||(je=(0,r.A)("hr",{})),(0,r.A)("h4",{},void 0,pgettext("markup help","Heading 4")),(0,r.A)(ct,{markup:pgettext("markup help","#### Fourth level heading"),result:(0,r.A)("h4",{},void 0,pgettext("markup help","Fourth level heading"))}),Me||(Me=(0,r.A)("hr",{})),(0,r.A)("h4",{},void 0,pgettext("markup help","Heading 5")),(0,r.A)(ct,{markup:pgettext("markup help","##### Fifth level heading"),result:(0,r.A)("h5",{},void 0,pgettext("markup help","Fifth level heading"))}),ze||(ze=(0,r.A)("hr",{})),(0,r.A)("h4",{},void 0,pgettext("markup help","Unordered list")),He||(He=(0,r.A)(ct,{markup:"- Lorem ipsum\n- Dolor met\n- Vulputate lectus",result:(0,r.A)("ul",{},void 0,(0,r.A)("li",{},void 0,"Lorem ipsum"),(0,r.A)("li",{},void 0,"Dolor met"),(0,r.A)("li",{},void 0,"Vulputate lectus"))})),Ve||(Ve=(0,r.A)("hr",{})),(0,r.A)("h4",{},void 0,pgettext("markup help","Ordered list")),Ye||(Ye=(0,r.A)(ct,{markup:"1. Lorem ipsum\n2. Dolor met\n3. Vulputate lectus",result:(0,r.A)("ol",{},void 0,(0,r.A)("li",{},void 0,"Lorem ipsum"),(0,r.A)("li",{},void 0,"Dolor met"),(0,r.A)("li",{},void 0,"Vulputate lectus"))})),We||(We=(0,r.A)("hr",{})),(0,r.A)("h4",{},void 0,pgettext("markup help","Quote text")),(0,r.A)(ct,{markup:"> "+pgettext("markup help","Quoted text"),result:(0,r.A)("blockquote",{},void 0,(0,r.A)("p",{},void 0,pgettext("markup help","Quoted text")))}),Ge||(Ge=(0,r.A)("hr",{})),(0,r.A)("h4",{},void 0,pgettext("markup help","Quote text (BBCode)")),(0,r.A)(ct,{markup:"[quote]\n"+pgettext("markup help","Quoted text")+"\n[/quote]",result:(0,r.A)("aside",{className:"quote-block"},void 0,(0,r.A)("div",{className:"quote-heading"},void 0,gettext("Quoted message:")),(0,r.A)("blockquote",{className:"quote-body"},void 0,(0,r.A)("p",{},void 0,pgettext("markup help","Quoted text"))))}),Qe||(Qe=(0,r.A)("hr",{})),(0,r.A)("h4",{},void 0,pgettext("markup help","Quote text with author (BBCode)")),(0,r.A)(ct,{markup:'[quote="'+pgettext("markup help","Quote author")+'"]\n'+pgettext("markup help","Quoted text")+"\n[/quote]",result:(0,r.A)("aside",{className:"quote-block"},void 0,(0,r.A)("div",{className:"quote-heading"},void 0,pgettext("markup help","Quote author has written:")),(0,r.A)("blockquote",{className:"quote-body"},void 0,(0,r.A)("p",{},void 0,pgettext("markup help","Quoted text"))))}),Ke||(Ke=(0,r.A)("hr",{})),(0,r.A)("h4",{},void 0,pgettext("markup help","Spoiler")),(0,r.A)(ct,{markup:"[spoiler]\n"+pgettext("markup help","Secret text")+"\n[/spoiler]",result:(0,r.A)(pt,{},void 0,pgettext("markup help","Secret text"))}),Xe||(Xe=(0,r.A)("hr",{})),(0,r.A)("h4",{},void 0,pgettext("markup help","Inline code")),(0,r.A)(ct,{markup:pgettext("markup help","`Inline code`"),result:(0,r.A)("p",{},void 0,(0,r.A)("code",{},void 0,pgettext("markup help","Inline code")))}),Je||(Je=(0,r.A)("hr",{})),(0,r.A)("h4",{},void 0,pgettext("markup help","Code block")),$e||($e=(0,r.A)(ct,{markup:'```\nalert("Hello world!");\n```',result:(0,r.A)("pre",{},void 0,(0,r.A)("code",{className:"hljs"},void 0,'alert("Hello world!");'))})),Ze||(Ze=(0,r.A)("hr",{})),(0,r.A)("h4",{},void 0,pgettext("markup help","Code block with syntax highlighting")),et||(et=(0,r.A)(ct,{markup:'```python\nprint("Hello world!");\n```',result:(0,r.A)("pre",{},void 0,(0,r.A)("code",{className:"hljs language-python"},void 0,(0,r.A)("span",{className:"hljs-built_in"},void 0,"print"),'("Hello world!");'))})),tt||(tt=(0,r.A)("hr",{})),(0,r.A)("h4",{},void 0,pgettext("markup help","Code block (BBCode)")),nt||(nt=(0,r.A)(ct,{markup:'[code]\nalert("Hello world!");\n[/code]',result:(0,r.A)("pre",{},void 0,(0,r.A)("code",{className:"hljs"},void 0,'alert("Hello world!");'))})),at||(at=(0,r.A)("hr",{})),(0,r.A)("h4",{},void 0,pgettext("markup help","Code block with syntax highlighting (BBCode)")),it||(it=(0,r.A)(ct,{markup:'[code="python"]\nprint("Hello world!");\n[/code]',result:(0,r.A)("pre",{},void 0,(0,r.A)("code",{className:"hljs language-python"},void 0,(0,r.A)("span",{className:"hljs-built_in"},void 0,"print"),'("Hello world!");'))})),ot||(ot=(0,r.A)("hr",{})),(0,r.A)("h4",{},void 0,pgettext("markup help","Horizontal rule")),rt||(rt=(0,r.A)(ct,{markup:"Lorem ipsum\n- - -\nDolor met",result:(0,r.A)("div",{},void 0,(0,r.A)("p",{},void 0,"Lorem ipsum"),(0,r.A)("hr",{}),(0,r.A)("p",{},void 0,"Dolor met"))})),st||(st=(0,r.A)("hr",{})),(0,r.A)("h4",{},void 0,pgettext("markup help","Horizontal rule (BBCode)")),ut||(ut=(0,r.A)(ct,{markup:"Lorem ipsum\n[hr]\nDolor met",result:(0,r.A)("div",{},void 0,(0,r.A)("p",{},void 0,"Lorem ipsum"),(0,r.A)("hr",{}),(0,r.A)("p",{},void 0,"Dolor met"))}))),(0,r.A)("div",{className:"modal-footer"},void 0,(0,r.A)("button",{className:"btn btn-default","data-dismiss":"modal",type:"button"},void 0,pgettext("modal","Close")))))}function ct(e){var t=e.markup,n=e.result;return(0,r.A)("div",{className:"formatting-help-item"},void 0,(0,r.A)("div",{className:"formatting-help-item-markup"},void 0,(0,r.A)("pre",{},void 0,(0,r.A)("code",{},void 0,t))),(0,r.A)("div",{className:"formatting-help-item-preview"},void 0,(0,r.A)("article",{className:"misago-markup"},void 0,n)))}var dt,pt=function(e){(0,c.A)(i,e);var t,n,a=(t=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}(),function(){var e,a=(0,p.A)(t);if(n){var i=(0,p.A)(this).constructor;e=Reflect.construct(a,arguments,i)}else e=a.apply(this,arguments);return(0,d.A)(this,e)});function i(e){var t;return(0,u.A)(this,i),(t=a.call(this,e)).state={reveal:!1},t}return(0,s.A)(i,[{key:"render",value:function(){var e=this;return(0,r.A)("aside",{className:this.state.reveal?"spoiler-block revealed":"spoiler-block"},void 0,(0,r.A)("blockquote",{className:"spoiler-body"},void 0,(0,r.A)("p",{},void 0,this.props.children)),!this.state.reveal&&(0,r.A)("div",{className:"spoiler-overlay"},void 0,(0,r.A)("button",{className:"spoiler-reveal",type:"button",onClick:function(){e.setState({reveal:!0})}},void 0,gettext("Reveal spoiler"))))}}]),i}(o().Component),ht=new RegExp("^(((ftps?)|(https?))://)","i");function mt(e){return ht.test(e.trim())}const ft=function(e){(0,c.A)(i,e);var t,n,a=(t=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}(),function(){var e,a=(0,p.A)(t);if(n){var i=(0,p.A)(this).constructor;e=Reflect.construct(a,arguments,i)}else e=a.apply(this,arguments);return(0,d.A)(this,e)});function i(e){var t;(0,u.A)(this,i),t=a.call(this,e),(0,h.A)((0,l.A)(t),"handleSubmit",function(e){e.preventDefault();var n=t.props,a=n.selection,i=n.update,o=t.state.text.trim(),r=t.state.url.trim();return 0===r.length?(t.setState({error:gettext("This field is required.")}),!1):(o.length>0?ie(a,i,"!["+o+"]("+r+")"):ie(a,i,"!("+r+")"),X.A.hide(),!1)});var n=e.selection.text.trim(),o=mt(n);return t.state={error:null,text:o?"":n,url:o?n:""},t}return(0,s.A)(i,[{key:"render",value:function(){var e=this;return(0,r.A)("div",{className:"modal-dialog",role:"document"},void 0,(0,r.A)("div",{className:"modal-content"},void 0,(0,r.A)("div",{className:"modal-header"},void 0,(0,r.A)("button",{"aria-label":pgettext("modal","Close"),className:"close","data-dismiss":"modal",type:"button"},void 0,dt||(dt=(0,r.A)("span",{"aria-hidden":"true"},void 0,"Ã—"))),(0,r.A)("h4",{className:"modal-title"},void 0,pgettext("markup editor","Image"))),(0,r.A)("form",{onSubmit:this.handleSubmit},void 0,(0,r.A)("div",{className:"modal-body"},void 0,(0,r.A)(me.A,{for:"markup_image_text",label:pgettext("markup editor","Image description"),helpText:pgettext("markup editor","Optional but recommended . Will be displayed instead of image when it fails to load.")},void 0,(0,r.A)("input",{id:"markup_image_text",className:"form-control",type:"text",value:this.state.text,onChange:function(t){return e.setState({text:t.target.value})}})),(0,r.A)(me.A,{for:"markup_image_url",label:pgettext("markup editor","Image URL"),validation:this.state.error?[this.state.error]:void 0},void 0,(0,r.A)("input",{id:"markup_image_url",className:"form-control",type:"text",value:this.state.url,placeholder:"http://domain.com/image.png",onChange:function(t){return e.setState({url:t.target.value})}}))),(0,r.A)("div",{className:"modal-footer"},void 0,(0,r.A)("button",{className:"btn btn-default","data-dismiss":"modal",type:"button"},void 0,pgettext("markup editor","Cancel")),(0,r.A)("button",{className:"btn btn-primary"},void 0,pgettext("markup editor","Insert image"))))))}}]),i}(o().Component);var vt;const At=function(e){(0,c.A)(i,e);var t,n,a=(t=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}(),function(){var e,a=(0,p.A)(t);if(n){var i=(0,p.A)(this).constructor;e=Reflect.construct(a,arguments,i)}else e=a.apply(this,arguments);return(0,d.A)(this,e)});function i(e){var t;(0,u.A)(this,i),t=a.call(this,e),(0,h.A)((0,l.A)(t),"handleSubmit",function(e){e.preventDefault();var n=t.props,a=n.selection,i=n.update,o=t.state.text.trim(),r=t.state.url.trim();return 0===r.length?(t.setState({error:gettext("This field is required.")}),!1):(o.length>0?ie(a,i,"["+o+"]("+r+")"):ie(a,i,"<"+r+">"),X.A.hide(),!1)});var n=e.selection.text.trim(),o=mt(n);return t.state={error:null,text:o?"":n,url:o?n:""},t}return(0,s.A)(i,[{key:"render",value:function(){var e=this;return(0,r.A)("div",{className:"modal-dialog",role:"document"},void 0,(0,r.A)("div",{className:"modal-content"},void 0,(0,r.A)("div",{className:"modal-header"},void 0,(0,r.A)("button",{"aria-label":pgettext("modal","Close"),className:"close","data-dismiss":"modal",type:"button"},void 0,vt||(vt=(0,r.A)("span",{"aria-hidden":"true"},void 0,"Ã—"))),(0,r.A)("h4",{className:"modal-title"},void 0,pgettext("markup editor","Link"))),(0,r.A)("form",{onSubmit:this.handleSubmit},void 0,(0,r.A)("div",{className:"modal-body"},void 0,(0,r.A)(me.A,{for:"markup_link_url",label:pgettext("markup editor","Link text"),helpText:pgettext("markup editor","Optional. Will be displayed instead of link's address.")},void 0,(0,r.A)("input",{id:"markup_link_text",className:"form-control",type:"text",value:this.state.text,onChange:function(t){return e.setState({text:t.target.value})}})),(0,r.A)(me.A,{for:"markup_link_url",label:pgettext("markup editor","Link address"),validation:this.state.error?[this.state.error]:void 0},void 0,(0,r.A)("input",{id:"markup_link_url",className:"form-control",type:"text",value:this.state.url,onChange:function(t){return e.setState({url:t.target.value})}}))),(0,r.A)("div",{className:"modal-footer"},void 0,(0,r.A)("button",{className:"btn btn-default","data-dismiss":"modal",type:"button"},void 0,pgettext("markup editor","Cancel")),(0,r.A)("button",{className:"btn btn-primary"},void 0,pgettext("markup editor","Insert link"))))))}}]),i}(o().Component);var gt;const yt=function(e){(0,c.A)(i,e);var t,n,a=(t=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}(),function(){var e,a=(0,p.A)(t);if(n){var i=(0,p.A)(this).constructor;e=Reflect.construct(a,arguments,i)}else e=a.apply(this,arguments);return(0,d.A)(this,e)});function i(e){var t;return(0,u.A)(this,i),t=a.call(this,e),(0,h.A)((0,l.A)(t),"handleSubmit",function(e){e.preventDefault();var n=t.props,a=n.selection,i=n.update,o=t.state.author.trim(),r=t.state.text.trim();if(0===r.length)return t.setState({error:gettext("This field is required.")}),!1;var s=a.prefix.trim().length?"\n\n":"";return ie(a,i,o?s+'[quote="'+o+'"]\n'+r+"\n[/quote]\n\n":s+"[quote]\n"+r+"\n[/quote]\n\n"),X.A.hide(),!1}),t.state={error:null,author:"",text:e.selection.text},t}return(0,s.A)(i,[{key:"render",value:function(){var e=this;return(0,r.A)("div",{className:"modal-dialog modal-lg",role:"document"},void 0,(0,r.A)("div",{className:"modal-content"},void 0,(0,r.A)("div",{className:"modal-header"},void 0,(0,r.A)("button",{"aria-label":pgettext("modal","Close"),className:"close","data-dismiss":"modal",type:"button"},void 0,gt||(gt=(0,r.A)("span",{"aria-hidden":"true"},void 0,"Ã—"))),(0,r.A)("h4",{className:"modal-title"},void 0,pgettext("markup editor","Quote"))),(0,r.A)("form",{onSubmit:this.handleSubmit},void 0,(0,r.A)("div",{className:"modal-body"},void 0,(0,r.A)(me.A,{for:"markup_quote_author",label:pgettext("markup editor","Quote's author or source"),helpText:pgettext("markup editor",'Optional. If it\'s username, put "@" before it ("@JohnDoe").')},void 0,(0,r.A)("input",{id:"markup_quote_author",className:"form-control",type:"text",value:this.state.author,onChange:function(t){return e.setState({author:t.target.value})}})),(0,r.A)(me.A,{for:"markup_quote_text",label:pgettext("markup editor","Quoted text"),validation:this.state.error?[this.state.error]:void 0},void 0,(0,r.A)("textarea",{id:"markup_quote_text",className:"form-control",rows:"8",value:this.state.text,onChange:function(t){return e.setState({text:t.target.value})}}))),(0,r.A)("div",{className:"modal-footer"},void 0,(0,r.A)("button",{className:"btn btn-default","data-dismiss":"modal",type:"button"},void 0,pgettext("markup editor","Cancel")),(0,r.A)("button",{className:"btn btn-primary"},void 0,pgettext("markup editor","Insert quote"))))))}}]),i}(o().Component),bt=function(e){var t=e.disabled,n=e.icon,a=e.title,i=e.onClick;return(0,r.A)("button",{className:"btn btn-markup-editor",title:a,type:"button",disabled:t,onClick:i},void 0,(0,r.A)("span",{className:"material-icon"},void 0,n))};var Dt=n(19086);const xt=function(e,t){var n=1024*Q.A.get("user").acl.max_attachment_size;if(e.size>n)Y.A.error(interpolate(pgettext("markup editor","File %(filename)s is bigger than %(limit)s."),{filename:e.name,limit:(0,J.A)(n)},!0));else{var a={id:null,key:(0,Dt.Ay)(32),error:null,uploaded_on:null,progress:0,filename:e.name,filetype:null,is_image:!1,size:e.size,url:null,uploader_name:null};t(function(e){var t=e.attachments;return{attachments:[a].concat(t)}});var i=function(){t(function(e){return{attachments:e.attachments.concat()}})},o=new FormData;o.append("upload",e),V.A.upload(Q.A.get("ATTACHMENTS_API"),o,function(e){a.progress=e,i()}).then(function(e){Object.assign(a,e,{uploaded_on:j()(e.uploaded_on)}),i()},function(e){400===e.status||413===e.status?(a.error=e.detail,Y.A.error(e.detail),i()):Y.A.apiError(e)})}};var kt,_t;const Nt=function(e){var t=e.disabled,n=e.element,a=e.update,i=e.updateAttachments,o=[{name:pgettext("markup editor","Strong"),icon:"format_bold",onClick:function(){ae(oe(n),a,"**","**",pgettext("example markup","Strong text"))}},{name:pgettext("markup editor","Emphasis"),icon:"format_italic",onClick:function(){ae(oe(n),a,"*","*",pgettext("example markup","Text with emphasis"))}},{name:pgettext("markup editor","Strikethrough"),icon:"format_strikethrough",onClick:function(){ae(oe(n),a,"~~","~~",pgettext("example markup","Text with strikethrough"))}},{name:pgettext("markup editor","Horizontal ruler"),icon:"remove",onClick:function(){ie(oe(n),a,"\n\n- - -\n\n")}},{name:pgettext("markup editor","Link"),icon:"insert_link",onClick:function(){var e=oe(n);X.A.show((0,r.A)(At,{selection:e,element:n,update:a}))}},{name:pgettext("markup editor","Image"),icon:"insert_photo",onClick:function(){var e=oe(n);X.A.show((0,r.A)(ft,{selection:e,element:n,update:a}))}},{name:pgettext("markup editor","Quote"),icon:"format_quote",onClick:function(){var e=oe(n);X.A.show((0,r.A)(yt,{selection:e,element:n,update:a}))}},{name:pgettext("markup editor","Spoiler"),icon:"visibility_off",onClick:function(){!function(e,t){var n=oe(e),a=n.prefix.trim().length?"\n\n":"";ae(n,t,a+"[spoiler]\n","\n[/spoiler]\n\n",pgettext("markup editor","Spoiler text"))}(n,a)}},{name:pgettext("markup editor","Code"),icon:"code",onClick:function(){var e=oe(n);X.A.show((0,r.A)(Ae,{selection:e,element:n,update:a}))}}];return Q.A.get("user").acl.max_attachment_size&&o.push({name:pgettext("markup editor","Upload file"),icon:"file_upload",onClick:function(){return e=i,(t=document.createElement("input")).type="file",t.multiple="multiple",t.addEventListener("change",function(){for(var n=0;n<t.files.length;n++)xt(t.files[n],e)}),void t.click();var e,t}}),(0,r.A)("div",{className:"markup-editor-toolbar"},void 0,(0,r.A)("div",{className:"markup-editor-toolbar-left"},void 0,o.map(function(e){var a=e.name,i=e.icon,o=e.onClick;return(0,r.A)(bt,{title:a,icon:i,disabled:t||!n,onClick:o},i)})),(0,r.A)("div",{className:"markup-editor-toolbar-right"},void 0,(0,r.A)("div",{className:"markup-editor-controls-dropdown"},void 0,(0,r.A)("button",{type:"button",className:"btn btn-markup-editor dropdown-toggle","data-toggle":"dropdown","aria-haspopup":"true","aria-expanded":"false",disabled:t||!n},void 0,kt||(kt=(0,r.A)("span",{className:"material-icon"},void 0,"more_vert"))),(0,r.A)("ul",{className:"dropdown-menu dropdown-menu-right stick-to-bottom"},void 0,o.map(function(e){var a=e.name,i=e.icon,o=e.onClick;return(0,r.A)("li",{},i,(0,r.A)("button",{type:"button",className:"btn-link",disabled:t||!n,onClick:o},void 0,(0,r.A)("span",{className:"material-icon"},void 0,i),a))}))),(0,r.A)(bt,{title:pgettext("markup editor","Open formatting help"),icon:"help_outline",onClick:function(){X.A.show(_t||(_t=(0,r.A)(lt,{})))}})))};var Ct=n(74692);const Et=function(e){(0,c.A)(i,e);var t,n,a=(t=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}(),function(){var e,a=(0,p.A)(t);if(n){var i=(0,p.A)(this).constructor;e=Reflect.construct(a,arguments,i)}else e=a.apply(this,arguments);return(0,d.A)(this,e)});function i(e){var t;return(0,u.A)(this,i),t=a.call(this,e),(0,h.A)((0,l.A)(t),"showPreview",function(){t.state.loading||(t.setState({loading:!0,preview:!0,element:null}),V.A.post(Q.A.get("PARSE_MARKUP_API"),{post:t.props.value}).then(function(e){t.setState({loading:!1,parsed:e.parsed})},function(e){400===e.status?Y.A.error(e.detail):Y.A.apiError(e),t.setState({loading:!1,preview:!1})}))}),(0,h.A)((0,l.A)(t),"closePreview",function(){t.setState({loading:!1,preview:!1})}),(0,h.A)((0,l.A)(t),"onDrop",function(e){if(e.preventDefault(),e.stopPropagation(),e.dataTransfer.files){var n=t.props.onAttachmentsChange;if(Q.A.get("user").acl.max_attachment_size)for(var a=0;a<e.dataTransfer.files.length;a++){var i=e.dataTransfer.files[a];xt(i,n)}}}),(0,h.A)((0,l.A)(t),"onPaste",function(e){for(var n=t.props.onAttachmentsChange,a=[],i=0;i<e.clipboardData.items.length;i++){var o=e.clipboardData.items[i];"file"===o.kind&&a.push(o.getAsFile())}if(a.length&&(e.preventDefault(),e.stopPropagation(),Q.A.get("user").acl.max_attachment_size))for(var r=0;r<a.length;r++)xt(a[r],n)}),(0,h.A)((0,l.A)(t),"render",function(){return(0,r.A)("div",{className:G()("markup-editor",{"markup-editor-focused":t.state.focused&&!t.state.preview})},void 0,(0,r.A)(Nt,{disabled:t.props.disabled||t.state.preview,element:t.state.element,update:function(e){return t.props.onChange({target:{value:e}})},updateAttachments:t.props.onAttachmentsChange}),t.state.preview?(0,r.A)("div",{className:"markup-editor-preview"},void 0,t.state.loading?(0,r.A)("div",{className:"markup-editor-preview-loading"},void 0,(0,r.A)("div",{className:"ui-preview"},void 0,(0,r.A)("span",{className:"ui-preview-text",style:{width:"240px"}}))):(0,r.A)(K.A,{className:"markup-editor-preview-contents",markup:t.state.parsed})):o().createElement("textarea",{className:"markup-editor-textarea form-control",placeholder:t.props.placeholder,value:t.props.value,disabled:t.props.disabled||t.state.loading,rows:6,ref:function(e){e&&t.state.element!==e&&(t.setState({element:e}),function(e,t){Ct(t).atwho({at:"@",displayTpl:'<li><img src="${avatar}" alt="">${username}</li>',insertTpl:"@${username}",searchKey:"username",callbacks:{remoteFilter:function(e,t){Ct.getJSON(Q.A.get("MENTION_API"),{q:e},t)}}}),Ct(t).on("inserted.atwho",function(t,n,a,i){var o=i.query,r=a.target.innerText.trim(),s=t.target.value.substr(0,o.headPos),u=t.target.value.substr(o.endPos);t.target.value=s+r+u,e.onChange(t);var l=o.headPos+r.length;t.target.setSelectionRange(l,l),t.target.focus()})}(t.props,e))},onChange:t.props.onChange,onDrop:t.onDrop,onFocus:function(){return t.setState({focused:!0})},onPaste:t.onPaste,onBlur:function(){return t.setState({focused:!1})}}),t.props.attachments.length>0&&(0,r.A)(le,{attachments:t.props.attachments,disabled:t.props.disabled||t.state.preview,element:t.state.element,setState:t.props.onAttachmentsChange,update:function(e){return t.props.onChange({target:{value:e}})}}),(0,r.A)(pe,{preview:t.state.preview,canProtect:t.props.canProtect,isProtected:t.props.isProtected,disabled:t.props.disabled,empty:t.props.value.trim().length<Q.A.get("SETTINGS").post_length_min||t.state.loading,enableProtection:t.props.enableProtection,disableProtection:t.props.disableProtection,showPreview:t.showPreview,closePreview:t.closePreview,submitText:t.props.submitText}))}),t.state={element:null,focused:!1,loading:!1,preview:!1,parsed:null},t}return(0,s.A)(i)}(o().Component);var wt=n(98088);var Ft="posting-active",Rt="posting-default",St="posting-minimized",Bt="posting-fullscreen";const Lt=function(e){(0,c.A)(i,e);var t,n,a=(t=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}(),function(){var e,a=(0,p.A)(t);if(n){var i=(0,p.A)(this).constructor;e=Reflect.construct(a,arguments,i)}else e=a.apply(this,arguments);return(0,d.A)(this,e)});function i(){return(0,u.A)(this,i),a.apply(this,arguments)}return(0,s.A)(i,[{key:"componentDidMount",value:function(){document.body.classList.add(Ft,Rt)}},{key:"componentWillUnmount",value:function(){document.body.classList.remove(Ft,Rt,St,Bt)}},{key:"componentWillReceiveProps",value:function(e){var t=e.fullscreen;e.minimized?(document.body.classList.remove(Rt,Bt),document.body.classList.add(St)):t?(document.body.classList.remove(Rt,St),document.body.classList.add(Bt)):(document.body.classList.remove(Bt,St),document.body.classList.add(Rt))}},{key:"render",value:function(){var e=this.props,t=e.children,n=e.fullscreen,a=e.minimized;return(0,r.A)("div",{className:G()("posting-dialog",{"posting-dialog-minimized":a,"posting-dialog-fullscreen":n&&!a})},void 0,(0,r.A)("div",{className:"posting-dialog-container"},void 0,t))}}]),i}(o().Component),Tt=function(e){var t=e.children;return(0,r.A)("div",{className:"posting-dialog-body"},void 0,t)};var Ot;const Pt=function(e){var t=e.close,n=e.message;return(0,r.A)("div",{className:"posting-dialog-error"},void 0,Ot||(Ot=(0,r.A)("div",{className:"posting-dialog-error-icon"},void 0,(0,r.A)("span",{className:"material-icon"},void 0,"error_outlined"))),(0,r.A)("div",{className:"posting-dialog-error-detail"},void 0,(0,r.A)("p",{},void 0,n),(0,r.A)("button",{type:"button",className:"btn btn-default",onClick:t},void 0,pgettext("modal","Close"))))};var It,qt,Ut,jt,Mt;const zt=function(e){var t=e.children,n=e.close,a=e.fullscreen,i=e.minimize,o=e.minimized,s=e.fullscreenEnter,u=e.fullscreenExit,l=e.open;return(0,r.A)("div",{className:"posting-dialog-header"},void 0,(0,r.A)("div",{className:"posting-dialog-caption"},void 0,t),o?(0,r.A)("button",{className:"btn btn-posting-dialog",title:pgettext("dialog","Open"),type:"button",onClick:l},void 0,It||(It=(0,r.A)("span",{className:"material-icon"},void 0,"expand_less"))):(0,r.A)("button",{className:"btn btn-posting-dialog",title:pgettext("dialog","Minimize"),type:"button",onClick:i},void 0,qt||(qt=(0,r.A)("span",{className:"material-icon"},void 0,"expand_more"))),a?(0,r.A)("button",{className:"btn btn-posting-dialog hidden-xs",title:pgettext("dialog","Exit the fullscreen mode"),type:"button",onClick:u},void 0,Ut||(Ut=(0,r.A)("span",{className:"material-icon"},void 0,"fullscreen_exit"))):(0,r.A)("button",{className:"btn btn-posting-dialog hidden-xs",title:pgettext("dialog","Enter the fullscreen mode"),type:"button",onClick:s},void 0,jt||(jt=(0,r.A)("span",{className:"material-icon"},void 0,"fullscreen"))),(0,r.A)("button",{className:"btn btn-posting-dialog",title:pgettext("dialog","Cancel"),type:"button",onClick:n},void 0,Mt||(Mt=(0,r.A)("span",{className:"material-icon"},void 0,"close"))))};var Ht,Vt,Yt,Wt,Gt,Qt,Kt,Xt,Jt;function $t(e){var t=e.isClosed,n=e.isHidden,a=e.isPinned,i=e.disabled,o=e.options,s=e.close,u=e.open,l=e.hide,c=e.unhide,d=e.pinGlobally,p=e.pinLocally,h=e.unpin,m=function(e,t,n){var a=[];return 2===n&&a.push("bookmark"),1===n&&a.push("bookmark_outline"),e&&a.push("lock"),t&&a.push("visibility_off"),a}(t,n,a);return(0,r.A)("div",{className:"dropdown"},void 0,(0,r.A)("button",{className:"btn btn-default btn-outline btn-icon",title:pgettext("post thread","Options"),"aria-expanded":"true","aria-haspopup":"true","data-toggle":"dropdown",type:"button",disabled:i},void 0,m.length>0?(0,r.A)("span",{className:"btn-icons-family"},void 0,m.map(function(e){return(0,r.A)("span",{className:"material-icon"},e,e)})):Ht||(Ht=(0,r.A)("span",{className:"material-icon"},void 0,"more_horiz"))),(0,r.A)("ul",{className:"dropdown-menu dropdown-menu-right stick-to-bottom"},void 0,2===o.pin&&2!==a&&(0,r.A)("li",{},void 0,(0,r.A)("button",{className:"btn btn-link",onClick:d,type:"button",disabled:i},void 0,Vt||(Vt=(0,r.A)("span",{className:"material-icon"},void 0,"bookmark")),pgettext("post thread","Pinned globally"))),o.pin>=a&&1!==a&&(0,r.A)("li",{},void 0,(0,r.A)("button",{className:"btn btn-link",onClick:p,type:"button",disabled:i},void 0,Yt||(Yt=(0,r.A)("span",{className:"material-icon"},void 0,"bookmark_outline")),pgettext("post thread","Pinned in category"))),o.pin>=a&&0!==a&&(0,r.A)("li",{},void 0,(0,r.A)("button",{className:"btn btn-link",onClick:h,type:"button",disabled:i},void 0,Wt||(Wt=(0,r.A)("span",{className:"material-icon"},void 0,"radio_button_unchecked")),pgettext("post thread","Not pinned"))),o.close&&!!t&&(0,r.A)("li",{},void 0,(0,r.A)("button",{className:"btn btn-link",onClick:u,type:"button",disabled:i},void 0,Gt||(Gt=(0,r.A)("span",{className:"material-icon"},void 0,"lock_outline")),pgettext("post thread","Open"))),o.close&&!t&&(0,r.A)("li",{},void 0,(0,r.A)("button",{className:"btn btn-link",onClick:s,type:"button",disabled:i},void 0,Qt||(Qt=(0,r.A)("span",{className:"material-icon"},void 0,"lock")),pgettext("post thread","Closed"))),o.hide&&!!n&&(0,r.A)("li",{},void 0,(0,r.A)("button",{className:"btn btn-link",onClick:c,type:"button",disabled:i},void 0,Kt||(Kt=(0,r.A)("span",{className:"material-icon"},void 0,"visibility")),pgettext("post thread","Visible"))),o.hide&&!n&&(0,r.A)("li",{},void 0,(0,r.A)("button",{className:"btn btn-link",onClick:l,type:"button",disabled:i},void 0,Xt||(Xt=(0,r.A)("span",{className:"material-icon"},void 0,"visibility_off")),pgettext("post thread","Hidden")))))}var Zt=function(e){(0,c.A)(i,e);var t,n,a=(t=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}(),function(){var e,a=(0,p.A)(t);if(n){var i=(0,p.A)(this).constructor;e=Reflect.construct(a,arguments,i)}else e=a.apply(this,arguments);return(0,d.A)(this,e)});function i(e){var t;return(0,u.A)(this,i),t=a.call(this,e),(0,h.A)((0,l.A)(t),"loadSuccess",function(e){var n=null,a=null,i=e.map(function(e){return!1===e.post||n&&e.id!=t.state.category||(n=e.id,a=e.post),Object.assign(e,{disabled:!1===e.post,label:e.name,value:e.id})});t.setState({isReady:!0,options:a,categories:i,category:n})}),(0,h.A)((0,l.A)(t),"loadError",function(e){t.setState({error:e.detail})}),(0,h.A)((0,l.A)(t),"onCancel",function(){if(0===t.state.post.length&&0===t.state.title.length&&0===t.state.attachments.length)return t.minimize(),m.A.close();window.confirm(pgettext("post thread","Are you sure you want to discard thread?"))&&(t.minimize(),m.A.close())}),(0,h.A)((0,l.A)(t),"onTitleChange",function(e){t.changeValue("title",e.target.value)}),(0,h.A)((0,l.A)(t),"onCategoryChange",function(e){var n=t.state.categories.find(function(t){return e.target.value==t.value}),a=t.state.pin;n.post.pin&&n.post.pin<a&&(a=n.post.pin),t.setState({category:n.id,categoryOptions:n.post,pin:a})}),(0,h.A)((0,l.A)(t),"onPostChange",function(e){t.changeValue("post",e.target.value)}),(0,h.A)((0,l.A)(t),"onAttachmentsChange",function(e){t.setState(e)}),(0,h.A)((0,l.A)(t),"onClose",function(){t.changeValue("close",!0)}),(0,h.A)((0,l.A)(t),"onOpen",function(){t.changeValue("close",!1)}),(0,h.A)((0,l.A)(t),"onPinGlobally",function(){t.changeValue("pin",2)}),(0,h.A)((0,l.A)(t),"onPinLocally",function(){t.changeValue("pin",1)}),(0,h.A)((0,l.A)(t),"onUnpin",function(){t.changeValue("pin",0)}),(0,h.A)((0,l.A)(t),"onHide",function(){t.changeValue("hide",!0)}),(0,h.A)((0,l.A)(t),"onUnhide",function(){t.changeValue("hide",!1)}),(0,h.A)((0,l.A)(t),"close",function(){t.minimize(),m.A.close()}),(0,h.A)((0,l.A)(t),"minimize",function(){t.setState({fullscreen:!1,minimized:!0})}),(0,h.A)((0,l.A)(t),"open",function(){t.setState({minimized:!1}),t.state.fullscreen}),(0,h.A)((0,l.A)(t),"fullscreenEnter",function(){t.setState({fullscreen:!0,minimized:!1})}),(0,h.A)((0,l.A)(t),"fullscreenExit",function(){t.setState({fullscreen:!1,minimized:!1})}),t.state={isReady:!1,isLoading:!1,error:null,minimized:!1,fullscreen:!1,options:null,title:"",category:e.category||null,categories:[],post:"",attachments:[],close:!1,hide:!1,pin:0,validators:{title:(0,H.oB)(),post:(0,H.GH)()},errors:{}},t}return(0,s.A)(i,[{key:"componentDidMount",value:function(){V.A.get(this.props.config).then(this.loadSuccess,this.loadError)}},{key:"clean",value:function(){if(!this.state.title.trim().length)return Y.A.error(pgettext("posting form","You have to enter thread title.")),!1;if(!this.state.post.trim().length)return Y.A.error(pgettext("posting form","You have to enter a message.")),!1;var e=this.validate();return e.title?(Y.A.error(e.title[0]),!1):!e.post||(Y.A.error(e.post[0]),!1)}},{key:"send",value:function(){return V.A.post(this.props.submit,{title:this.state.title,category:this.state.category,post:this.state.post,attachments:M(this.state.attachments),close:this.state.close,hide:this.state.hide,pin:this.state.pin})}},{key:"handleSuccess",value:function(e){this.setState({isLoading:!0}),this.close(),Y.A.success(pgettext("post thread","Your thread has been posted.")),window.location=e.url}},{key:"handleError",value:function(e){if(400===e.status){var t=[].concat(e.non_field_errors||[],e.category||[],e.title||[],e.post||[],e.attachments||[]);Y.A.error(t[0])}else Y.A.apiError(e)}},{key:"render",value:function(){var e={minimized:this.state.minimized,minimize:this.minimize,open:this.open,fullscreen:this.state.fullscreen,fullscreenEnter:this.fullscreenEnter,fullscreenExit:this.fullscreenExit,close:this.onCancel};if(this.state.error)return o().createElement(en,e,(0,r.A)(Pt,{message:this.state.error,close:this.close}));if(!this.state.isReady)return o().createElement(en,e,(0,r.A)("div",{className:"posting-loading ui-preview"},void 0,Jt||(Jt=(0,r.A)(wt.M7,{className:"posting-dialog-toolbar"},void 0,(0,r.A)(wt.rk,{className:"posting-dialog-thread-title",auto:!0},void 0,(0,r.A)(wt.Tm,{auto:!0},void 0,(0,r.A)("input",{className:"form-control",disabled:!0,type:"text"}))),(0,r.A)(wt.rk,{className:"posting-dialog-category-select",auto:!0},void 0,(0,r.A)(wt.Tm,{},void 0,(0,r.A)("input",{className:"form-control",disabled:!0,type:"text"}))))),(0,r.A)(Et,{attachments:[],value:"",submitText:pgettext("post thread submit","Start thread"),disabled:!0,onAttachmentsChange:function(){},onChange:function(){}})));var t=!!(this.state.options.close||this.state.options.hide||this.state.options.pin);return o().createElement(en,e,(0,r.A)("form",{className:"posting-dialog-form",onSubmit:this.handleSubmit},void 0,(0,r.A)(wt.M7,{className:"posting-dialog-toolbar"},void 0,(0,r.A)(wt.rk,{className:"posting-dialog-thread-title",auto:!0},void 0,(0,r.A)(wt.Tm,{auto:!0},void 0,(0,r.A)("input",{className:"form-control",disabled:this.state.isLoading,onChange:this.onTitleChange,placeholder:pgettext("post thread","Thread title"),type:"text",value:this.state.title}))),(0,r.A)(wt.rk,{className:"posting-dialog-category-select",auto:!0},void 0,(0,r.A)(wt.Tm,{},void 0,(0,r.A)(I.A,{choices:this.state.categories,disabled:this.state.isLoading,onChange:this.onCategoryChange,value:this.state.category})),t&&(0,r.A)(wt.Tm,{shrink:!0},void 0,(0,r.A)($t,{isClosed:this.state.close,isHidden:this.state.hide,isPinned:this.state.pin,disabled:this.state.isLoading,options:this.state.options,close:this.onClose,open:this.onOpen,hide:this.onHide,unhide:this.onUnhide,pinGlobally:this.onPinGlobally,pinLocally:this.onPinLocally,unpin:this.onUnpin})))),(0,r.A)(Et,{attachments:this.state.attachments,value:this.state.post,submitText:pgettext("post thread submit","Start thread"),disabled:this.state.isLoading,onAttachmentsChange:this.onAttachmentsChange,onChange:this.onPostChange})))}}]),i}(q.A),en=function(e){var t=e.children,n=e.close,a=e.minimized,i=e.minimize,o=e.open,s=e.fullscreen,u=e.fullscreenEnter,l=e.fullscreenExit;return(0,r.A)(Lt,{fullscreen:s,minimized:a},void 0,(0,r.A)(zt,{fullscreen:s,fullscreenEnter:u,fullscreenExit:l,minimized:a,minimize:i,open:o,close:n},void 0,pgettext("post thread","Start new thread")),(0,r.A)(Tt,{},void 0,t))};function tn(e){var t=e.split(",").map(function(e){return e.trim().toLowerCase()}).filter(function(e){return e.length>0});return t.filter(function(e,n){return t.indexOf(e)==n})}var nn=function(e){(0,c.A)(i,e);var t,n,a=(t=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}(),function(){var e,a=(0,p.A)(t);if(n){var i=(0,p.A)(this).constructor;e=Reflect.construct(a,arguments,i)}else e=a.apply(this,arguments);return(0,d.A)(this,e)});function i(e){var t;(0,u.A)(this,i),t=a.call(this,e),(0,h.A)((0,l.A)(t),"onCancel",function(){if(0===t.state.post.length&&0===t.state.title.length&&0===t.state.to.length&&0===t.state.attachments.length)return t.close();window.confirm(pgettext("post thread","Are you sure you want to discard private thread?"))&&t.close()}),(0,h.A)((0,l.A)(t),"onToChange",function(e){t.changeValue("to",e.target.value)}),(0,h.A)((0,l.A)(t),"onTitleChange",function(e){t.changeValue("title",e.target.value)}),(0,h.A)((0,l.A)(t),"onPostChange",function(e){t.changeValue("post",e.target.value)}),(0,h.A)((0,l.A)(t),"onAttachmentsChange",function(e){t.setState(e)}),(0,h.A)((0,l.A)(t),"close",function(){t.minimize(),m.A.close()}),(0,h.A)((0,l.A)(t),"minimize",function(){t.setState({fullscreen:!1,minimized:!0})}),(0,h.A)((0,l.A)(t),"open",function(){t.setState({minimized:!1}),t.state.fullscreen}),(0,h.A)((0,l.A)(t),"fullscreenEnter",function(){t.setState({fullscreen:!0,minimized:!1})}),(0,h.A)((0,l.A)(t),"fullscreenExit",function(){t.setState({fullscreen:!1,minimized:!1})});var n=(e.to||[]).map(function(e){return e.username}).join(", ");return t.state={isLoading:!1,error:null,minimized:!1,fullscreen:!1,to:n,title:"",post:"",attachments:[],validators:{title:(0,H.oB)(),post:(0,H.GH)()},errors:{}},t}return(0,s.A)(i,[{key:"clean",value:function(){if(!tn(this.state.to).length)return Y.A.error(pgettext("posting form","You have to enter at least one recipient.")),!1;if(!this.state.title.trim().length)return Y.A.error(pgettext("posting form","You have to enter thread title.")),!1;if(!this.state.post.trim().length)return Y.A.error(pgettext("posting form","You have to enter a message.")),!1;var e=this.validate();return e.title?(Y.A.error(e.title[0]),!1):!e.post||(Y.A.error(e.post[0]),!1)}},{key:"send",value:function(){return V.A.post(this.props.submit,{to:tn(this.state.to),title:this.state.title,post:this.state.post,attachments:M(this.state.attachments)})}},{key:"handleSuccess",value:function(e){this.setState({isLoading:!0}),this.close(),Y.A.success(pgettext("post thread","Your thread has been posted.")),window.location=e.url}},{key:"handleError",value:function(e){if(400===e.status){var t=[].concat(e.non_field_errors||[],e.to||[],e.title||[],e.post||[],e.attachments||[]);Y.A.error(t[0])}else Y.A.apiError(e)}},{key:"render",value:function(){var e={minimized:this.state.minimized,minimize:this.minimize,open:this.open,fullscreen:this.state.fullscreen,fullscreenEnter:this.fullscreenEnter,fullscreenExit:this.fullscreenExit,close:this.onCancel};return o().createElement(an,e,(0,r.A)("form",{className:"posting-dialog-form",onSubmit:this.handleSubmit},void 0,(0,r.A)(wt.M7,{className:"posting-dialog-toolbar"},void 0,(0,r.A)(wt.rk,{className:"posting-dialog-thread-recipients",auto:!0},void 0,(0,r.A)(wt.Tm,{auto:!0},void 0,(0,r.A)("input",{className:"form-control",disabled:this.state.isLoading,onChange:this.onToChange,placeholder:pgettext("post thread","Recipients, eg.: Danny, Lisa, Alice"),type:"text",value:this.state.to}))),(0,r.A)(wt.rk,{className:"posting-dialog-thread-title",auto:!0},void 0,(0,r.A)(wt.Tm,{auto:!0},void 0,(0,r.A)("input",{className:"form-control",disabled:this.state.isLoading,onChange:this.onTitleChange,placeholder:pgettext("post thread","Thread title"),type:"text",value:this.state.title})))),(0,r.A)(Et,{attachments:this.state.attachments,value:this.state.post,submitText:pgettext("post thread submit","Start thread"),disabled:this.state.isLoading,onAttachmentsChange:this.onAttachmentsChange,onChange:this.onPostChange})))}}]),i}(q.A),an=function(e){var t=e.children,n=e.close,a=e.minimized,i=e.minimize,o=e.open,s=e.fullscreen,u=e.fullscreenEnter,l=e.fullscreenExit;return(0,r.A)(Lt,{fullscreen:s,minimized:a},void 0,(0,r.A)(zt,{fullscreen:s,fullscreenEnter:u,fullscreenExit:l,minimized:a,minimize:i,open:o,close:n},void 0,pgettext("post thread","Start private thread")),(0,r.A)(Tt,{},void 0,t))};var on=function(e){(0,c.A)(i,e);var t,n,a=(t=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}(),function(){var e,a=(0,p.A)(t);if(n){var i=(0,p.A)(this).constructor;e=Reflect.construct(a,arguments,i)}else e=a.apply(this,arguments);return(0,d.A)(this,e)});function i(e){var t;return(0,u.A)(this,i),t=a.call(this,e),(0,h.A)((0,l.A)(t),"loadSuccess",function(e){t.setState({isReady:!0,post:e.post?'[quote="@'+e.poster+'"]\n'+e.post+"\n[/quote]":t.state.post}),t.quoteText=e.post?'[quote="@'+e.poster+'"]\n'+e.post+"\n[/quote]":t.state.post}),(0,h.A)((0,l.A)(t),"loadError",function(e){t.setState({error:e.detail})}),(0,h.A)((0,l.A)(t),"appendData",function(e){var n=e.post?'[quote="@'+e.poster+'"]\n'+e.post+"\n[/quote]\n\n":"";t.setState(function(e,t){return e.post.length>0?{post:e.post.trim()+"\n\n"+n}:{post:n}}),t.open()}),(0,h.A)((0,l.A)(t),"onCancel",function(){if(t.state.post===t.quoteText&&0===t.state.attachments.length)return t.close();window.confirm(pgettext("post reply","Are you sure you want to discard your reply?"))&&t.close()}),(0,h.A)((0,l.A)(t),"onPostChange",function(e){t.changeValue("post",e.target.value)}),(0,h.A)((0,l.A)(t),"onAttachmentsChange",function(e){t.setState(e)}),(0,h.A)((0,l.A)(t),"onQuote",function(e){t.setState(function(t){var n=t.post;return n.length>0?{post:n.trim()+"\n\n"+e}:{post:e}}),t.open()}),(0,h.A)((0,l.A)(t),"close",function(){t.minimize(),m.A.close()}),(0,h.A)((0,l.A)(t),"minimize",function(){t.setState({fullscreen:!1,minimized:!0})}),(0,h.A)((0,l.A)(t),"open",function(){t.setState({minimized:!1}),t.state.fullscreen}),(0,h.A)((0,l.A)(t),"fullscreenEnter",function(){t.setState({fullscreen:!0,minimized:!1})}),(0,h.A)((0,l.A)(t),"fullscreenExit",function(){t.setState({fullscreen:!1,minimized:!1})}),t.state={isReady:!1,isLoading:!1,error:null,minimized:!1,fullscreen:!1,post:t.props.default||"",attachments:[],validators:{post:(0,H.GH)()},errors:{}},t.quoteText="",t}return(0,s.A)(i,[{key:"componentDidMount",value:function(){V.A.get(this.props.config,this.props.context||null).then(this.loadSuccess,this.loadError),O(!1,this.onQuote)}},{key:"componentWillUnmount",value:function(){P()}},{key:"componentWillReceiveProps",value:function(e){var t=this.props.context,n=e.context;t&&n&&!n.reply||V.A.get(e.config,e.context||null).then(this.appendData,Y.A.apiError)}},{key:"clean",value:function(){if(!this.state.post.trim().length)return Y.A.error(pgettext("posting form","You have to enter a message.")),!1;var e=this.validate();return!e.post||(Y.A.error(e.post[0]),!1)}},{key:"send",value:function(){return O(!0,this.onQuote),V.A.post(this.props.submit,{post:this.state.post,attachments:M(this.state.attachments)})}},{key:"handleSuccess",value:function(e){this.setState({isLoading:!0}),this.close(),O(!1,this.onQuote),Y.A.success(pgettext("post reply","Your reply has been posted.")),window.location=e.url.index}},{key:"handleError",value:function(e){if(400===e.status){var t=[].concat(e.non_field_errors||[],e.post||[],e.attachments||[]);Y.A.error(t[0])}else Y.A.apiError(e);O(!1,this.onQuote)}},{key:"render",value:function(){var e={thread:this.props.thread,minimized:this.state.minimized,minimize:this.minimize,open:this.open,fullscreen:this.state.fullscreen,fullscreenEnter:this.fullscreenEnter,fullscreenExit:this.fullscreenExit,close:this.onCancel};return this.state.error?o().createElement(rn,e,(0,r.A)(Pt,{message:this.state.error,close:this.close})):this.state.isReady?o().createElement(rn,e,(0,r.A)("form",{className:"posting-dialog-form",method:"POST",onSubmit:this.handleSubmit},void 0,(0,r.A)(Et,{attachments:this.state.attachments,value:this.state.post,submitText:pgettext("post reply submit","Post reply"),disabled:this.state.isLoading,onAttachmentsChange:this.onAttachmentsChange,onChange:this.onPostChange}))):o().createElement(rn,e,(0,r.A)("div",{className:"posting-loading ui-preview"},void 0,(0,r.A)(Et,{attachments:[],value:"",submitText:pgettext("post reply submit","Post reply"),disabled:!0,onAttachmentsChange:function(){},onChange:function(){}})))}}]),i}(q.A),rn=function(e){var t=e.children,n=e.close,a=e.minimized,i=e.minimize,o=e.open,s=e.fullscreen,u=e.fullscreenEnter,l=e.fullscreenExit,c=e.thread;return(0,r.A)(Lt,{fullscreen:s,minimized:a},void 0,(0,r.A)(zt,{fullscreen:s,fullscreenEnter:u,fullscreenExit:l,minimized:a,minimize:i,open:o,close:n},void 0,interpolate(pgettext("post reply","Reply to: %(thread)s"),{thread:c.title},!0)),(0,r.A)(Tt,{},void 0,t))};var sn=function(e){(0,c.A)(i,e);var t,n,a=(t=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}(),function(){var e,a=(0,p.A)(t);if(n){var i=(0,p.A)(this).constructor;e=Reflect.construct(a,arguments,i)}else e=a.apply(this,arguments);return(0,d.A)(this,e)});function i(e){var t;return(0,u.A)(this,i),t=a.call(this,e),(0,h.A)((0,l.A)(t),"loadSuccess",function(e){var n;t.originalPost=e.post,t.setState({isReady:!0,post:e.post,attachments:(n=e.attachments,n.map(function(e){return Object.assign({},e,{uploaded_on:j()(e.uploaded_on)})})),protect:e.is_protected,canProtect:e.can_protect})}),(0,h.A)((0,l.A)(t),"loadError",function(e){t.setState({error:e.detail})}),(0,h.A)((0,l.A)(t),"appendData",function(e){var n=e.post?'[quote="@'+e.poster+'"]\n'+e.post+"\n[/quote]\n\n":"";t.setState(function(e,t){return e.post.length>0?{post:e.post.trim()+"\n\n"+n}:{post:n}}),t.open()}),(0,h.A)((0,l.A)(t),"onCancel",function(){var e=t.state.originalPost===t.state.post,n=0===t.state.attachments.length;if(e&&n)return t.close();window.confirm(pgettext("edit reply","Are you sure you want to discard changes?"))&&t.close()}),(0,h.A)((0,l.A)(t),"onProtect",function(){t.setState({protect:!0})}),(0,h.A)((0,l.A)(t),"onUnprotect",function(){t.setState({protect:!1})}),(0,h.A)((0,l.A)(t),"onPostChange",function(e){t.changeValue("post",e.target.value)}),(0,h.A)((0,l.A)(t),"onAttachmentsChange",function(e){t.setState(e)}),(0,h.A)((0,l.A)(t),"onQuote",function(e){t.setState(function(t){var n=t.post;return n.length>0?{post:n.trim()+"\n\n"+e}:{post:e}}),t.open()}),(0,h.A)((0,l.A)(t),"close",function(){t.minimize(),m.A.close()}),(0,h.A)((0,l.A)(t),"minimize",function(){t.setState({fullscreen:!1,minimized:!0})}),(0,h.A)((0,l.A)(t),"open",function(){t.setState({minimized:!1}),t.state.fullscreen}),(0,h.A)((0,l.A)(t),"fullscreenEnter",function(){t.setState({fullscreen:!0,minimized:!1})}),(0,h.A)((0,l.A)(t),"fullscreenExit",function(){t.setState({fullscreen:!1,minimized:!1})}),t.state={isReady:!1,isLoading:!1,error:!1,minimized:!1,fullscreen:!1,post:"",attachments:[],protect:!1,canProtect:!1,validators:{post:(0,H.GH)()},errors:{}},t.originalPost="",t}return(0,s.A)(i,[{key:"componentDidMount",value:function(){V.A.get(this.props.config).then(this.loadSuccess,this.loadError),O(!1,this.onQuote)}},{key:"componentWillUnmount",value:function(){P()}},{key:"componentWillReceiveProps",value:function(e){var t=this.props.context,n=e.context;t&&n&&t.reply===n.reply||V.A.get(e.config,e.context||null).then(this.appendData,Y.A.apiError)}},{key:"clean",value:function(){if(!this.state.post.trim().length)return Y.A.error(pgettext("posting form","You have to enter a message.")),!1;var e=this.validate();return!e.post||(Y.A.error(e.post[0]),!1)}},{key:"send",value:function(){return O(!0,this.onQuote),V.A.put(this.props.submit,{post:this.state.post,attachments:M(this.state.attachments),protect:this.state.protect})}},{key:"handleSuccess",value:function(e){this.setState({isLoading:!0}),this.close(),O(!1,this.onQuote),Y.A.success(pgettext("edit reply","Reply has been edited.")),window.location=e.url.index}},{key:"handleError",value:function(e){if(400===e.status){var t=[].concat(e.non_field_errors||[],e.category||[],e.title||[],e.post||[],e.attachments||[]);Y.A.error(t[0])}else Y.A.apiError(e);O(!1,this.onQuote)}},{key:"render",value:function(){var e=this,t={post:this.props.post,minimized:this.state.minimized,minimize:this.minimize,open:this.open,fullscreen:this.state.fullscreen,fullscreenEnter:this.fullscreenEnter,fullscreenExit:this.fullscreenExit,close:this.onCancel};return this.state.error?o().createElement(un,t,(0,r.A)(Pt,{message:this.state.error,close:this.close})):this.state.isReady?o().createElement(un,t,(0,r.A)("form",{className:"posting-dialog-form",method:"POST",onSubmit:this.handleSubmit},void 0,(0,r.A)(Et,{attachments:this.state.attachments,canProtect:this.state.canProtect,isProtected:this.state.protect,enableProtection:function(){return e.setState({protect:!0})},disableProtection:function(){return e.setState({protect:!1})},value:this.state.post,submitText:pgettext("edit reply submit","Edit reply"),disabled:this.state.isLoading,onAttachmentsChange:this.onAttachmentsChange,onChange:this.onPostChange}))):o().createElement(un,t,(0,r.A)("div",{className:"posting-loading ui-preview"},void 0,(0,r.A)(Et,{attachments:[],value:"",submitText:pgettext("edit reply submit","Edit reply"),disabled:!0,onAttachmentsChange:function(){},onChange:function(){}})))}}]),i}(q.A),un=function(e){var t=e.children,n=e.close,a=e.minimized,i=e.minimize,o=e.open,s=e.fullscreen,u=e.fullscreenEnter,l=e.fullscreenExit,c=e.post;return(0,r.A)(Lt,{fullscreen:s,minimized:a},void 0,(0,r.A)(zt,{fullscreen:s,fullscreenEnter:u,fullscreenExit:l,minimized:a,minimize:i,open:o,close:n},void 0,interpolate(pgettext("edit reply","Edit reply by %(poster)s from %(date)s"),{poster:c.poster?c.poster.username:c.poster_name,date:c.posted_on.fromNow()},!0)),(0,r.A)(Tt,{},void 0,t))};function ln(e){switch(e.mode){case"START":return o().createElement(Zt,e);case"START_PRIVATE":return o().createElement(nn,e);case"REPLY":return o().createElement(on,e);case"EDIT":return o().createElement(sn,e);default:return null}}},35248:(e,t,n)=>{"use strict";n.d(t,{A:()=>g});var a=n(23029),i=n(92901),o=n(15361),r=n(61801),s=n(53954),u=n(32485),l=n.n(u),c=n(40927),d=n.n(c),p=n(64467),h=n(74692),m=new RegExp("^.*(?:(?:youtu.be/|v/|vi/|u/w/|embed/)|(?:(?:watch)??v(?:i)?=|&v(?:i)?=))([^#&?]*).*");const f=new(function(){function e(){var t=this;(0,a.A)(this,e),(0,p.A)(this,"render",function(e){e&&(t.highlightCode(e),t.embedYoutubePlayers(e))}),this._youtube={}}return(0,i.A)(e,[{key:"highlightCode",value:function(e){n.e(386).then(n.bind(n,73060)).then(function(t){for(var n=t.default,a=e.querySelectorAll("pre>code"),i=0;i<a.length;i++)n.highlightElement(a[i])})}},{key:"embedYoutubePlayers",value:function(e){for(var t=e.querySelectorAll("p>a"),n=0;n<t.length;n++){var a=t[n],i=1===a.parentNode.childNodes.length;this._youtube[a.href]||(this._youtube[a.href]=v(a.href));var o=this._youtube[a.href];i&&o&&!1!==o.data&&this.swapYoutubePlayer(a,o)}}},{key:"swapYoutubePlayer",value:function(e,t){var n="https://www.youtube.com/embed/";n+=t.video,n+="?feature=oembed",t.start&&(n+="&start="+t.start);var a=h('<iframe class="embed-responsive-item" frameborder="0" src="'+n+'" allow="encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>');h(e).replaceWith(a),a.wrap('<div class="embed-responsive embed-responsive-16by9"></div>')}}]),e}());function v(e){var t=function(e){var t=e;return"https://"===e.substr(0,8)?t=t.substr(8):"http://"===e.substr(0,7)&&(t=t.substr(7)),"www."===t.substr(0,4)&&(t=t.substr(4)),t}(e),n=function(e){if(-1===e.indexOf("youtu"))return null;var t=e.match(m);return t?t[1]:null}(t);if(!n)return null;var a=0;if(t.indexOf("?")>0){var i=t.substr(t.indexOf("?")+1).split("&").filter(function(e){return"t="===e.substr(0,2)})[0];if(i){var o=i.substr(2).split("m");"s"===o[0].substr(-1)?a+=parseInt(o[0].substr(0,o[0].length-1)):(a+=60*parseInt(o[0]),o[1]&&"s"===o[1].substr(-1)&&(a+=parseInt(o[1].substr(0,o[1].length-1))))}}return{start:a,video:n}}var A=n(74692);var g=function(e){(0,o.A)(c,e);var t,n,u=(t=c,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}(),function(){var e,a=(0,s.A)(t);if(n){var i=(0,s.A)(this).constructor;e=Reflect.construct(a,arguments,i)}else e=a.apply(this,arguments);return(0,r.A)(this,e)});function c(){return(0,a.A)(this,c),u.apply(this,arguments)}return(0,i.A)(c,[{key:"componentDidMount",value:function(){f.render(this.documentNode),A(this.documentNode).find(".spoiler-reveal").click(y)}},{key:"componentDidUpdate",value:function(e,t){f.render(this.documentNode),A(this.documentNode).find(".spoiler-reveal").click(y)}},{key:"shouldComponentUpdate",value:function(e,t){return e.markup!==this.props.markup}},{key:"render",value:function(){var e=this;return d().createElement("article",{className:l()("misago-markup",this.props.className),dangerouslySetInnerHTML:{__html:this.props.markup},"data-author":this.props.author||void 0,ref:function(t){e.documentNode=t}})}}]),c}(d().Component);function y(e){var t=e.target;A(t).parent().parent().addClass("revealed")}},35358:(e,t,n)=>{var a={"./af":25177,"./af.js":25177,"./ar":61509,"./ar-dz":41488,"./ar-dz.js":41488,"./ar-kw":58676,"./ar-kw.js":58676,"./ar-ly":42353,"./ar-ly.js":42353,"./ar-ma":24496,"./ar-ma.js":24496,"./ar-sa":82682,"./ar-sa.js":82682,"./ar-tn":89756,"./ar-tn.js":89756,"./ar.js":61509,"./az":95533,"./az.js":95533,"./be":28959,"./be.js":28959,"./bg":47777,"./bg.js":47777,"./bm":54903,"./bm.js":54903,"./bn":61290,"./bn-bd":17357,"./bn-bd.js":17357,"./bn.js":61290,"./bo":31545,"./bo.js":31545,"./br":11470,"./br.js":11470,"./bs":44429,"./bs.js":44429,"./ca":7306,"./ca.js":7306,"./cs":56464,"./cs.js":56464,"./cv":73635,"./cv.js":73635,"./cy":64226,"./cy.js":64226,"./da":93601,"./da.js":93601,"./de":77853,"./de-at":26111,"./de-at.js":26111,"./de-ch":54697,"./de-ch.js":54697,"./de.js":77853,"./dv":60708,"./dv.js":60708,"./el":54691,"./el.js":54691,"./en-au":53872,"./en-au.js":53872,"./en-ca":28298,"./en-ca.js":28298,"./en-gb":56195,"./en-gb.js":56195,"./en-ie":66584,"./en-ie.js":66584,"./en-il":65543,"./en-il.js":65543,"./en-in":9033,"./en-in.js":9033,"./en-nz":79402,"./en-nz.js":79402,"./en-sg":43004,"./en-sg.js":43004,"./eo":32934,"./eo.js":32934,"./es":97650,"./es-do":20838,"./es-do.js":20838,"./es-mx":17730,"./es-mx.js":17730,"./es-us":56575,"./es-us.js":56575,"./es.js":97650,"./et":3035,"./et.js":3035,"./eu":3508,"./eu.js":3508,"./fa":119,"./fa.js":119,"./fi":90527,"./fi.js":90527,"./fil":95995,"./fil.js":95995,"./fo":52477,"./fo.js":52477,"./fr":85498,"./fr-ca":26435,"./fr-ca.js":26435,"./fr-ch":37892,"./fr-ch.js":37892,"./fr.js":85498,"./fy":37071,"./fy.js":37071,"./ga":41734,"./ga.js":41734,"./gd":70217,"./gd.js":70217,"./gl":77329,"./gl.js":77329,"./gom-deva":32124,"./gom-deva.js":32124,"./gom-latn":93383,"./gom-latn.js":93383,"./gu":95050,"./gu.js":95050,"./he":11713,"./he.js":11713,"./hi":43861,"./hi.js":43861,"./hr":26308,"./hr.js":26308,"./hu":90609,"./hu.js":90609,"./hy-am":17160,"./hy-am.js":17160,"./id":74063,"./id.js":74063,"./is":89374,"./is.js":89374,"./it":88383,"./it-ch":21827,"./it-ch.js":21827,"./it.js":88383,"./ja":23827,"./ja.js":23827,"./jv":89722,"./jv.js":89722,"./ka":41794,"./ka.js":41794,"./kk":27088,"./kk.js":27088,"./km":96870,"./km.js":96870,"./kn":84451,"./kn.js":84451,"./ko":63164,"./ko.js":63164,"./ku":98174,"./ku.js":98174,"./ky":78474,"./ky.js":78474,"./lb":79680,"./lb.js":79680,"./lo":15867,"./lo.js":15867,"./lt":45766,"./lt.js":45766,"./lv":69532,"./lv.js":69532,"./me":58076,"./me.js":58076,"./mi":41848,"./mi.js":41848,"./mk":30306,"./mk.js":30306,"./ml":73739,"./ml.js":73739,"./mn":99053,"./mn.js":99053,"./mr":86169,"./mr.js":86169,"./ms":73386,"./ms-my":92297,"./ms-my.js":92297,"./ms.js":73386,"./mt":77075,"./mt.js":77075,"./my":72264,"./my.js":72264,"./nb":22274,"./nb.js":22274,"./ne":8235,"./ne.js":8235,"./nl":92572,"./nl-be":43784,"./nl-be.js":43784,"./nl.js":92572,"./nn":54566,"./nn.js":54566,"./oc-lnc":69330,"./oc-lnc.js":69330,"./pa-in":29849,"./pa-in.js":29849,"./pl":94418,"./pl.js":94418,"./pt":79834,"./pt-br":48303,"./pt-br.js":48303,"./pt.js":79834,"./ro":24457,"./ro.js":24457,"./ru":82271,"./ru.js":82271,"./sd":1221,"./sd.js":1221,"./se":33478,"./se.js":33478,"./si":17538,"./si.js":17538,"./sk":5784,"./sk.js":5784,"./sl":46637,"./sl.js":46637,"./sq":86794,"./sq.js":86794,"./sr":45719,"./sr-cyrl":3322,"./sr-cyrl.js":3322,"./sr.js":45719,"./ss":56e3,"./ss.js":56e3,"./sv":41011,"./sv.js":41011,"./sw":40748,"./sw.js":40748,"./ta":11025,"./ta.js":11025,"./te":11885,"./te.js":11885,"./tet":28861,"./tet.js":28861,"./tg":86571,"./tg.js":86571,"./th":55802,"./th.js":55802,"./tk":59527,"./tk.js":59527,"./tl-ph":29231,"./tl-ph.js":29231,"./tlh":31052,"./tlh.js":31052,"./tr":85096,"./tr.js":85096,"./tzl":79846,"./tzl.js":79846,"./tzm":81765,"./tzm-latn":97711,"./tzm-latn.js":97711,"./tzm.js":81765,"./ug-cn":48414,"./ug-cn.js":48414,"./uk":16618,"./uk.js":16618,"./ur":57777,"./ur.js":57777,"./uz":57609,"./uz-latn":72475,"./uz-latn.js":72475,"./uz.js":57609,"./vi":21135,"./vi.js":21135,"./x-pseudo":64051,"./x-pseudo.js":64051,"./yo":82218,"./yo.js":82218,"./zh-cn":52648,"./zh-cn.js":52648,"./zh-hk":1632,"./zh-hk.js":1632,"./zh-mo":31541,"./zh-mo.js":31541,"./zh-tw":50304,"./zh-tw.js":50304};function i(e){var t=o(e);return n(t)}function o(e){if(!n.o(a,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return a[e]}i.keys=function(){return Object.keys(a)},i.resolve=o,e.exports=i,i.id=35358},35594:(e,t,n)=>{"use strict";var a,i=n(73620),o=(n(40927),n(40961)),r=n.n(o),s=n(67467),u=n(4549),l=n(52762);misago.addInitializer({name:"component:search-overlay",initializer:function(e){var t=document.getElementById("search-mount");r().render((0,i.A)(s.Kq,{store:l.A.getStore()},void 0,a||(a=(0,i.A)(u.P,{}))),t)},after:"store"})},36629:(e,t,n)=>{"use strict";n.d(t,{Ay:()=>y});var a,i=n(73620),o=n(15361),r=n(61801),s=n(53954),u=n(23029),l=n(92901),c=n(40927),d=n.n(c),p=n(82743);function h(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,a=(0,s.A)(e);if(t){var i=(0,s.A)(this).constructor;n=Reflect.construct(a,arguments,i)}else n=a.apply(this,arguments);return(0,r.A)(this,n)}}var m=function(){function e(){(0,u.A)(this,e)}return(0,l.A)(e,[{key:"init",value:function(e,t,n,a){this._context=e,this._ajax=t,this._include=n,this._snackbar=a}}]),e}(),f=function(e){(0,o.A)(n,e);var t=h(n);function n(){return(0,u.A)(this,n),t.apply(this,arguments)}return(0,l.A)(n,[{key:"load",value:function(){return new Promise(function(e){e()})}},{key:"validator",value:function(){return null}},{key:"component",value:function(){return null}}]),n}(m),v=function(e){(0,o.A)(n,e);var t=h(n);function n(){return(0,u.A)(this,n),t.apply(this,arguments)}return(0,l.A)(n,[{key:"load",value:function(){var e=this;return new Promise(function(t,n){e._ajax.get(e._context.get("CAPTCHA_API")).then(function(n){e.question=n.question,e.helpText=n.help_text,t()},function(){e._snackbar.error(pgettext("captcha field","Failed to load CAPTCHA.")),n()})})}},{key:"validator",value:function(){return[]}},{key:"component",value:function(e){return(0,i.A)(p.A,{label:this.question,for:"id_captcha",labelClass:e.labelClass||"",controlClass:e.controlClass||"",validation:e.form.state.errors.captcha,helpText:this.helpText||null},void 0,(0,i.A)("input",{"aria-describedby":"id_captcha_status",className:"form-control",disabled:e.form.state.isLoading,id:"id_captcha",onChange:e.form.bindInput("captcha"),type:"text",value:e.form.state.captcha}))}}]),n}(m),A=function(e){(0,o.A)(n,e);var t=h(n);function n(){return(0,u.A)(this,n),t.apply(this,arguments)}return(0,l.A)(n,[{key:"componentDidMount",value:function(){var e=this;grecaptcha.render("recaptcha",{sitekey:this.props.siteKey,callback:function(t){e.props.binding({target:{value:t}})}})}},{key:"render",value:function(){return a||(a=(0,i.A)("div",{id:"recaptcha"}))}}]),n}(d().Component),g=function(e){(0,o.A)(n,e);var t=h(n);function n(){return(0,u.A)(this,n),t.apply(this,arguments)}return(0,l.A)(n,[{key:"load",value:function(){return this._include.include("https://www.google.com/recaptcha/api.js",!0),new Promise(function(e){!function t(){"undefined"==typeof grecaptcha?window.setTimeout(function(){t()},200):e()}()})}},{key:"validator",value:function(){return[]}},{key:"component",value:function(e){return(0,i.A)(p.A,{label:pgettext("captcha field","Please solve the quick test"),for:"id_captcha",labelClass:e.labelClass||"",controlClass:e.controlClass||"",validation:e.form.state.errors.captcha,helpText:pgettext("captcha field","This test helps us prevent automated spam registrations on the site.")},void 0,(0,i.A)(A,{binding:e.form.bindInput("captcha"),siteKey:this._context.get("SETTINGS").recaptcha_site_key}))}}]),n}(m);const y=new(function(){function e(){(0,u.A)(this,e)}return(0,l.A)(e,[{key:"init",value:function(e,t,n,a){switch(e.get("SETTINGS").captcha_type){case"no":this._captcha=new f;break;case"qa":this._captcha=new v;break;case"re":this._captcha=new g}this._captcha.init(e,t,n,a)}},{key:"load",value:function(){return this._captcha.load()}},{key:"validator",value:function(){return this._captcha.validator()}},{key:"component",value:function(e){return this._captcha.component(e)}}]),e}())},37281:(e,t,n)=>{"use strict";n.d(t,{Ay:()=>m,BC:()=>d,Qv:()=>p,ry:()=>c});var a=n(95093),i=n.n(a),o=n(97414),r=n(86552),s="ADD_NAME_CHANGE",u="APPEND_HISTORY",l="HYDRATE_HISTORY";function c(e,t,n){return{type:s,change:e,user:t,changedBy:n}}function d(e){return{type:u,items:e}}function p(e){return{type:l,items:e}}function h(e){return Object.assign({},e,{changed_on:i()(e.changed_on)})}function m(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;switch(t.type){case s:var n=e.slice();return n.unshift({id:Math.floor(Date.now()/1e3),changed_by:t.changedBy,changed_by_username:t.changedBy.username,changed_on:i()(),new_username:t.change.username,old_username:t.user.username}),n;case u:return(0,r.A)(e,t.items.map(h));case l:return t.items.map(h);case o.ot:return e.map(function(e){return(e=Object.assign({},e)).changed_by&&e.changed_by.id===t.userId&&(e.changed_by=Object.assign({},e.changed_by,{avatars:t.avatars})),e});case o.xq:return e.map(function(e){return(e=Object.assign({},e)).changed_by&&e.changed_by.id===t.userId&&(e.changed_by=Object.assign({},e.changed_by,{username:t.username,slug:t.slug})),Object.assign({},e)});default:return e}}},38791:()=>{document.body.addEventListener("click",function(e){var t=e.target.getAttribute("misago-focus-on");if(t){e.preventDefault();var n=document.querySelector(t);n&&n.focus()}})},39227:(e,t,n)=>{"use strict";n.d(t,{A:()=>h});var a,i=n(73620),o=n(23029),r=n(92901),s=n(15361),u=n(61801),l=n(53954),c=n(40927),d=n.n(c),p=n(27944);var h=function(e){(0,s.A)(d,e);var t,n,c=(t=d,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}(),function(){var e,a=(0,l.A)(t);if(n){var i=(0,l.A)(this).constructor;e=Reflect.construct(a,arguments,i)}else e=a.apply(this,arguments);return(0,u.A)(this,e)});function d(){return(0,o.A)(this,d),c.apply(this,arguments)}return(0,r.A)(d,[{key:"render",value:function(){var e="btn "+this.props.className,t=this.props.disabled;return this.props.loading&&(e+=" btn-loading",t=!0),(0,i.A)("button",{className:e,disabled:t,onClick:this.props.onClick,type:this.props.onClick?"button":"submit"},void 0,this.props.children,this.props.loading?a||(a=(0,i.A)(p.A,{})):null)}}]),d}(d().Component);h.defaultProps={className:"btn-default",type:"submit",loading:!1,disabled:!1,onClick:null}},39303:(e,t,n)=>{"use strict";var a=n(73971);function i(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;switch(t.type){case"SELECT_ALL":return t.items;case"SELECT_NONE":return[];case"SELECT_ITEM":return function(e,t){if(-1===e.indexOf(t)){var n=e.slice();return n.push(t),n}return e.filter(function(e){return e!==t})}(e,t.item);default:return e}}var o=n(52762);a.A.addInitializer({name:"reducer:selection",initializer:function(){o.A.addReducer("selection",i,[])},before:"store"})},39395:(e,t,n)=>{"use strict";n.d(t,{A:()=>o});var a=n(23029),i=n(92901);const o=new(function(){function e(){(0,a.A)(this,e)}return(0,i.A)(e,[{key:"init",value:function(e,t){this._indexTitle=e,this._forumName=t}},{key:"set",value:function(e){if(e){"string"==typeof e&&(e={title:e});var t=e.title;e.page>1&&(t+=" ("+interpolate(pgettext("page title pagination","page: %(page)s"),{page:e.page},!0)+")"),e.parent&&(t+=" | "+e.parent),document.title=t+" | "+this._forumName}else document.title=this._indexTitle||this._forumName}}]),e}())},39671:(e,t,n)=>{"use strict";n.d(t,{QE:()=>ie,HF:()=>se});var a,i=n(45458),o=n(73620),r=n(23029),s=n(92901),u=n(9417),l=n(15361),c=n(61801),d=n(53954),p=n(64467),h=n(32485),m=n.n(h),f=n(40927),v=n.n(f),A=n(67467),g=n(70490),y=n(30330),b=n(39227),D=n(27944),x=n(92069),k=n(29904);var _,N=function(e){(0,l.A)(h,e);var t,n,i=(t=h,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}(),function(){var e,a=(0,d.A)(t);if(n){var i=(0,d.A)(this).constructor;e=Reflect.construct(a,arguments,i)}else e=a.apply(this,arguments);return(0,c.A)(this,e)});function h(e){var t;return(0,r.A)(this,h),t=i.call(this,e),(0,p.A)((0,u.A)(t),"setGravatar",function(){t.callApi("gravatar")}),(0,p.A)((0,u.A)(t),"setGenerated",function(){t.callApi("generated")}),t.state={isLoading:!1},t}return(0,s.A)(h,[{key:"callApi",value:function(e){var t=this;if(this.state.isLoading)return!1;this.setState({isLoading:!0}),x.A.post(this.props.user.api.avatar,{avatar:e}).then(function(e){t.setState({isLoading:!1}),k.A.success(e.detail),t.props.onComplete(e)},function(e){400===e.status?(k.A.error(e.detail),t.setState({isLoading:!1})):t.props.showError(e)})}},{key:"getGravatarButton",value:function(){return this.props.options.gravatar?(0,o.A)(b.A,{onClick:this.setGravatar,disabled:this.state.isLoading,className:"btn-default btn-block btn-avatar-gravatar"},void 0,pgettext("avatar modal btn","Download my Gravatar")):null}},{key:"getCropButton",value:function(){return this.props.options.crop_src?(0,o.A)(b.A,{className:"btn-default btn-block btn-avatar-crop",disabled:this.state.isLoading,onClick:this.props.showCrop},void 0,pgettext("avatar modal btn","Re-crop uploaded image")):null}},{key:"getUploadButton",value:function(){return this.props.options.upload?(0,o.A)(b.A,{className:"btn-default btn-block btn-avatar-upload",disabled:this.state.isLoading,onClick:this.props.showUpload},void 0,pgettext("avatar modal btn","Upload new image")):null}},{key:"getGalleryButton",value:function(){return this.props.options.galleries?(0,o.A)(b.A,{className:"btn-default btn-block btn-avatar-gallery",disabled:this.state.isLoading,onClick:this.props.showGallery},void 0,pgettext("avatar modal btn","Pick avatar from gallery")):null}},{key:"getAvatarPreview",value:function(){var e={id:this.props.user.id,avatars:this.props.options.avatars};return this.state.isLoading?(0,o.A)("div",{className:"avatar-preview preview-loading"},void 0,(0,o.A)(y.Ay,{size:"200",user:e}),a||(a=(0,o.A)(D.A,{}))):(0,o.A)("div",{className:"avatar-preview"},void 0,(0,o.A)(y.Ay,{size:"200",user:e}))}},{key:"render",value:function(){return(0,o.A)("div",{className:"modal-body modal-avatar-index"},void 0,(0,o.A)("div",{className:"row"},void 0,(0,o.A)("div",{className:"col-md-5"},void 0,this.getAvatarPreview()),(0,o.A)("div",{className:"col-md-7"},void 0,this.getGravatarButton(),(0,o.A)(b.A,{onClick:this.setGenerated,disabled:this.state.isLoading,className:"btn-default btn-block btn-avatar-generate"},void 0,pgettext("avatar modal btn","Generate my individual avatar")),this.getCropButton(),this.getUploadButton(),this.getGalleryButton())))}}]),h}(v().Component),C=n(74692);var E,w=function(e){(0,l.A)(i,e);var t,n,a=(t=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}(),function(){var e,a=(0,d.A)(t);if(n){var i=(0,d.A)(this).constructor;e=Reflect.construct(a,arguments,i)}else e=a.apply(this,arguments);return(0,c.A)(this,e)});function i(e){var t;return(0,r.A)(this,i),t=a.call(this,e),(0,p.A)((0,u.A)(t),"cropAvatar",function(){if(t.state.isLoading)return!1;t.setState({isLoading:!0});var e=t.props.upload?"crop_tmp":"crop_src",n=C(".crop-form"),a=n.cropit("exportZoom"),i=n.cropit("offset");x.A.post(t.props.user.api.avatar,{avatar:e,crop:{offset:{x:i.x*a,y:i.y*a},zoom:n.cropit("zoom")*a}}).then(function(e){t.props.onComplete(e),k.A.success(e.detail)},function(e){400===e.status?(k.A.error(e.detail),t.setState({isLoading:!1})):t.props.showError(e)})}),t.state={isLoading:!1,deviceRatio:1},t}return(0,s.A)(i,[{key:"getAvatarSize",value:function(){return this.props.upload?this.props.options.crop_tmp.size:this.props.options.crop_src.size}},{key:"getImagePath",value:function(){return this.props.upload?this.props.dataUrl:this.props.options.crop_src.url}},{key:"componentDidMount",value:function(){for(var e=this,t=C(".crop-form"),n=this.getAvatarSize(),a=t.width();a<n;)n/=2;var i=this.getAvatarSize()/n;t.width(n),t.cropit({width:n,height:n,exportZoom:i,imageState:{src:this.getImagePath()},onImageLoaded:function(){if(e.props.upload){var n=t.cropit("zoom"),a=t.cropit("imageSize");if(a.width>a.height){var i=(a.width*n-e.getAvatarSize())/-2;t.cropit("offset",{x:i,y:0})}else if(a.width<a.height){var o=(a.height*n-e.getAvatarSize())/-2;t.cropit("offset",{x:0,y:o})}else t.cropit("offset",{x:0,y:0})}else{var r=e.props.options.crop_src.crop;r&&(t.cropit("zoom",r.zoom),t.cropit("offset",{x:r.x,y:r.y}))}}})}},{key:"componentWillUnmount",value:function(){C(".crop-form").cropit("disable")}},{key:"render",value:function(){return(0,o.A)("div",{},void 0,_||(_=(0,o.A)("div",{className:"modal-body modal-avatar-crop"},void 0,(0,o.A)("div",{className:"crop-form"},void 0,(0,o.A)("div",{className:"cropit-preview"}),(0,o.A)("input",{type:"range",className:"cropit-image-zoom-input"})))),(0,o.A)("div",{className:"modal-footer"},void 0,(0,o.A)("div",{className:"col-md-6 col-md-offset-3"},void 0,(0,o.A)(b.A,{onClick:this.cropAvatar,loading:this.state.isLoading,className:"btn-primary btn-block"},void 0,this.props.upload?pgettext("avatar crop modal btn","Set avatar"):pgettext("avatar crop modal btn","Crop image")),(0,o.A)(b.A,{onClick:this.props.showIndex,disabled:this.state.isLoading,className:"btn-default btn-block"},void 0,pgettext("avatar crop modal btn","Cancel")))))}}]),i}(v().Component),F=n(18524);var R,S=function(e){(0,l.A)(i,e);var t,n,a=(t=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}(),function(){var e,a=(0,d.A)(t);if(n){var i=(0,d.A)(this).constructor;e=Reflect.construct(a,arguments,i)}else e=a.apply(this,arguments);return(0,c.A)(this,e)});function i(e){var t;return(0,r.A)(this,i),t=a.call(this,e),(0,p.A)((0,u.A)(t),"pickFile",function(){document.getElementById("avatar-hidden-upload").click()}),(0,p.A)((0,u.A)(t),"uploadFile",function(){var e=document.getElementById("avatar-hidden-upload").files[0];if(e){var n=t.validateFile(e);if(n)k.A.error(n);else{t.setState({image:e,preview:URL.createObjectURL(e),progress:0});var a=new FormData;a.append("avatar","upload"),a.append("image",e),x.A.upload(t.props.user.api.avatar,a,function(e){t.setState({progress:e})}).then(function(e){t.setState({options:e,uploaded:e.detail}),k.A.info(pgettext("avatar upload modal","Your image has been uploaded and you may now crop it."))},function(e){400===e.status||413===e.status?(k.A.error(e.detail),t.setState({isLoading:!1,image:null,progress:0})):t.props.showError(e)})}}}),t.state={image:null,preview:null,progress:0,uploaded:null,dataUrl:null},t}return(0,s.A)(i,[{key:"validateFile",value:function(e){if(e.size>this.props.options.upload.limit)return interpolate(pgettext("avatar upload modal","Selected file is too big. (%(filesize)s)"),{filesize:(0,F.A)(e.size)},!0);var t=pgettext("avatar upload modal","Selected file type is not supported.");if(-1===this.props.options.upload.allowed_mime_types.indexOf(e.type))return t;var n=!1,a=e.name.toLowerCase();return this.props.options.upload.allowed_extensions.map(function(e){a.substr(-1*e.length)===e&&(n=!0)}),!n&&t}},{key:"getUploadRequirements",value:function(e){var t=e.allowed_extensions.map(function(e){return e.substr(1)});return interpolate(pgettext("avatar upload modal","%(files)s files smaller than %(limit)s"),{files:t.join(", "),limit:(0,F.A)(e.limit)},!0)}},{key:"getUploadButton",value:function(){return(0,o.A)("div",{className:"modal-body modal-avatar-upload"},void 0,(0,o.A)(b.A,{className:"btn-pick-file",onClick:this.pickFile},void 0,E||(E=(0,o.A)("div",{className:"material-icon"},void 0,"input")),pgettext("avatar upload modal field","Select file")),(0,o.A)("p",{className:"text-muted"},void 0,this.getUploadRequirements(this.props.options.upload)))}},{key:"getUploadProgressLabel",value:function(){return interpolate(pgettext("avatar upload modal field","%(progress)s % complete"),{progress:this.state.progress},!0)}},{key:"getUploadProgress",value:function(){return(0,o.A)("div",{className:"modal-body modal-avatar-upload"},void 0,(0,o.A)("div",{className:"upload-progress"},void 0,(0,o.A)("img",{src:this.state.preview}),(0,o.A)("div",{className:"progress"},void 0,(0,o.A)("div",{className:"progress-bar",role:"progressbar","aria-valuenow":"{this.state.progress}","aria-valuemin":"0","aria-valuemax":"100",style:{width:this.state.progress+"%"}},void 0,(0,o.A)("span",{className:"sr-only"},void 0,this.getUploadProgressLabel())))))}},{key:"renderUpload",value:function(){return(0,o.A)("div",{},void 0,(0,o.A)("input",{type:"file",id:"avatar-hidden-upload",className:"hidden-file-upload",onChange:this.uploadFile}),this.state.image?this.getUploadProgress():this.getUploadButton(),(0,o.A)("div",{className:"modal-footer"},void 0,(0,o.A)("div",{className:"col-md-6 col-md-offset-3"},void 0,(0,o.A)(b.A,{onClick:this.props.showIndex,disabled:!!this.state.image,className:"btn-default btn-block"},void 0,pgettext("avatar upload modal btn","Cancel")))))}},{key:"renderCrop",value:function(){return(0,o.A)(w,{options:this.state.options,user:this.props.user,upload:this.state.uploaded,dataUrl:this.state.preview,onComplete:this.props.onComplete,showError:this.props.showError,showIndex:this.props.showIndex})}},{key:"render",value:function(){return this.state.uploaded?this.renderCrop():this.renderUpload()}}]),i}(v().Component),B=n(58168),L=(n(73971),n(29124));function T(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,a=(0,d.A)(e);if(t){var i=(0,d.A)(this).constructor;n=Reflect.construct(a,arguments,i)}else n=a.apply(this,arguments);return(0,c.A)(this,n)}}var O,P,I,q=function(e){(0,l.A)(n,e);var t=T(n);function n(){var e;(0,r.A)(this,n);for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return e=t.call.apply(t,[this].concat(i)),(0,p.A)((0,u.A)(e),"select",function(){e.props.select(e.props.id)}),e}return(0,s.A)(n,[{key:"getClassName",value:function(){return this.props.selection===this.props.id?this.props.disabled?"btn btn-avatar btn-disabled avatar-selected":"btn btn-avatar avatar-selected":this.props.disabled?"btn btn-avatar btn-disabled":"btn btn-avatar"}},{key:"render",value:function(){return(0,o.A)("button",{type:"button",className:this.getClassName(),disabled:this.props.disabled,onClick:this.select},void 0,(0,o.A)("img",{src:this.props.url}))}}]),n}(v().Component),U=function(e){(0,l.A)(n,e);var t=T(n);function n(){return(0,r.A)(this,n),t.apply(this,arguments)}return(0,s.A)(n,[{key:"render",value:function(){var e=this;return(0,o.A)("div",{className:"avatars-gallery"},void 0,(0,o.A)("h3",{},void 0,this.props.name),(0,o.A)("div",{className:"avatars-gallery-images"},void 0,(0,L.A)(this.props.images,4,null).map(function(t,n){return(0,o.A)("div",{className:"row"},n,t.map(function(t,n){return(0,o.A)("div",{className:"col-xs-3"},n,t?v().createElement(q,(0,B.A)({disabled:e.props.disabled,select:e.props.select,selection:e.props.selection},t)):R||(R=(0,o.A)("div",{className:"blank-avatar"})))}))})))}}]),n}(v().Component),j=function(e){(0,l.A)(n,e);var t=T(n);function n(e){var a;return(0,r.A)(this,n),a=t.call(this,e),(0,p.A)((0,u.A)(a),"select",function(e){a.setState({selection:e})}),(0,p.A)((0,u.A)(a),"save",function(){if(a.state.isLoading)return!1;a.setState({isLoading:!0}),x.A.post(a.props.user.api.avatar,{avatar:"galleries",image:a.state.selection}).then(function(e){a.setState({isLoading:!1}),k.A.success(e.detail),a.props.onComplete(e),a.props.showIndex()},function(e){400===e.status?(k.A.error(e.detail),a.setState({isLoading:!1})):a.props.showError(e)})}),a.state={selection:null,isLoading:!1},a}return(0,s.A)(n,[{key:"render",value:function(){var e=this;return(0,o.A)("div",{},void 0,(0,o.A)("div",{className:"modal-body modal-avatar-gallery"},void 0,this.props.options.galleries.map(function(t,n){return(0,o.A)(U,{name:t.name,images:t.images,selection:e.state.selection,disabled:e.state.isLoading,select:e.select},n)})),(0,o.A)("div",{className:"modal-footer"},void 0,(0,o.A)("div",{className:"row"},void 0,(0,o.A)("div",{className:"col-md-6 col-md-offset-3"},void 0,(0,o.A)(b.A,{onClick:this.save,loading:this.state.isLoading,disabled:!this.state.selection,className:"btn-primary btn-block"},void 0,this.state.selection?pgettext("avatar gallery modal btn","Save choice"):pgettext("avatar gallery modal btn","Select avatar")),(0,o.A)(b.A,{onClick:this.props.showIndex,disabled:this.state.isLoading,className:"btn-default btn-block"},void 0,pgettext("avatar gallery modal btn","Cancel"))))))}}]),n}(v().Component),M=n(27860),z=n(97414),H=n(52762);function V(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,a=(0,d.A)(e);if(t){var i=(0,d.A)(this).constructor;n=Reflect.construct(a,arguments,i)}else n=a.apply(this,arguments);return(0,c.A)(this,n)}}var Y=function(e){(0,l.A)(n,e);var t=V(n);function n(){return(0,r.A)(this,n),t.apply(this,arguments)}return(0,s.A)(n,[{key:"getErrorReason",value:function(){return this.props.reason?(0,o.A)("p",{dangerouslySetInnerHTML:{__html:this.props.reason}}):null}},{key:"render",value:function(){return(0,o.A)("div",{className:"modal-body"},void 0,O||(O=(0,o.A)("div",{className:"message-icon"},void 0,(0,o.A)("span",{className:"material-icon"},void 0,"remove_circle_outline"))),(0,o.A)("div",{className:"message-body"},void 0,(0,o.A)("p",{className:"lead"},void 0,this.props.message),this.getErrorReason(),(0,o.A)("button",{className:"btn btn-default","data-dismiss":"modal",type:"button"},void 0,pgettext("avatar modal dismiss","Ok"))))}}]),n}(v().Component),W=function(e){(0,l.A)(n,e);var t=V(n);function n(){var e;(0,r.A)(this,n);for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return e=t.call.apply(t,[this].concat(i)),(0,p.A)((0,u.A)(e),"showError",function(t){e.setState({error:t})}),(0,p.A)((0,u.A)(e),"showIndex",function(){e.setState({component:N})}),(0,p.A)((0,u.A)(e),"showUpload",function(){e.setState({component:S})}),(0,p.A)((0,u.A)(e),"showCrop",function(){e.setState({component:w})}),(0,p.A)((0,u.A)(e),"showGallery",function(){e.setState({component:j})}),(0,p.A)((0,u.A)(e),"completeFlow",function(t){H.A.dispatch((0,z.xG)(e.props.user,t.avatars)),e.setState({component:N,options:t})}),e}return(0,s.A)(n,[{key:"componentDidMount",value:function(){var e=this;x.A.get(this.props.user.api.avatar).then(function(t){e.setState({component:N,options:t,error:null})},function(t){e.showError(t)})}},{key:"getBody",value:function(){return this.state?this.state.error?(0,o.A)(Y,{message:this.state.error.detail,reason:this.state.error.reason}):(0,o.A)(this.state.component,{options:this.state.options,user:this.props.user,onComplete:this.completeFlow,showError:this.showError,showIndex:this.showIndex,showCrop:this.showCrop,showUpload:this.showUpload,showGallery:this.showGallery}):P||(P=(0,o.A)(M.A,{}))}},{key:"getClassName",value:function(){return this.state&&this.state.error?"modal-dialog modal-message modal-change-avatar":"modal-dialog modal-change-avatar"}},{key:"render",value:function(){return(0,o.A)("div",{className:this.getClassName(),role:"document"},void 0,(0,o.A)("div",{className:"modal-content"},void 0,(0,o.A)("div",{className:"modal-header"},void 0,(0,o.A)("button",{type:"button",className:"close","data-dismiss":"modal","aria-label":pgettext("modal","Close")},void 0,I||(I=(0,o.A)("span",{"aria-hidden":"true"},void 0,"Ã—"))),(0,o.A)("h4",{className:"modal-title"},void 0,pgettext("avatar modal title","Change your avatar"))),this.getBody()))}}]),n}(v().Component);function G(e){return{user:e.auth.user}}var Q,K,X,J,$,Z,ee=n(25913);function te(){document.getElementById("hidden-logout-form").submit()}var ne=function(e){(0,l.A)(i,e);var t,n,a=(t=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}(),function(){var e,a=(0,d.A)(t);if(n){var i=(0,d.A)(this).constructor;e=Reflect.construct(a,arguments,i)}else e=a.apply(this,arguments);return(0,c.A)(this,e)});function i(e){var t;return(0,r.A)(this,i),t=a.call(this,e),(0,p.A)((0,u.A)(t),"changeAvatar",function(){t.props.close(),g.A.show((0,A.Ng)(G)(W))}),(0,p.A)((0,u.A)(t),"revealOptions",function(){t.setState({options:t.props.options,optionsMore:!1})}),e.dropdown?t.state={options:e.options.slice(0,2),optionsMore:e.options.length>2}:t.state={options:e.options,optionsMore:!1},t}return(0,s.A)(i,[{key:"render",value:function(){var e=this.props,t=e.user,n=e.close,a=e.dropdown,i=e.overlay;if(!t)return null;var r=misago.get("ADMIN_URL");return(0,o.A)("ul",{className:m()("user-nav-menu",{"dropdown-menu-list":a,"overlay-menu-list":i})},void 0,(0,o.A)("li",{className:"dropdown-menu-item"},void 0,(0,o.A)("a",{href:t.url,className:"user-nav-profile"},void 0,(0,o.A)("strong",{},void 0,t.username),(0,o.A)("small",{},void 0,pgettext("user nav","Go to your profile")))),Q||(Q=(0,o.A)(ee.rx,{})),(0,o.A)(ee._2,{},void 0,(0,o.A)("a",{href:misago.get("NOTIFICATIONS_URL")},void 0,(0,o.A)("span",{className:"material-icon"},void 0,t.unreadNotifications?"notifications_active":"notifications_none"),pgettext("user nav","Notifications"),!!t.unreadNotifications&&(0,o.A)("span",{className:"badge"},void 0,t.unreadNotifications))),!!t.showPrivateThreads&&(0,o.A)(ee._2,{},void 0,(0,o.A)("a",{href:misago.get("PRIVATE_THREADS_URL")},void 0,K||(K=(0,o.A)("span",{className:"material-icon"},void 0,"inbox")),pgettext("user nav","Private threads"),!!t.unreadPrivateThreads&&(0,o.A)("span",{className:"badge"},void 0,t.unreadPrivateThreads))),!!r&&(0,o.A)(ee._2,{},void 0,(0,o.A)("a",{href:r,target:"_blank"},void 0,X||(X=(0,o.A)("span",{className:"material-icon"},void 0,"security")),pgettext("user nav","Admin control panel"))),J||(J=(0,o.A)(ee.rx,{})),(0,o.A)(ee.dX,{className:"user-nav-options"},void 0,pgettext("user nav section","Account settings")),(0,o.A)(ee._2,{},void 0,(0,o.A)("button",{className:"btn-link",onClick:this.changeAvatar,type:"button"},void 0,$||($=(0,o.A)("span",{className:"material-icon"},void 0,"portrait")),pgettext("user nav","Change avatar"))),this.state.options.map(function(e){return(0,o.A)(ee._2,{},e.icon,(0,o.A)("a",{href:e.url},void 0,(0,o.A)("span",{className:"material-icon"},void 0,e.icon),e.name))}),(0,o.A)(ee._2,{},void 0,(0,o.A)("button",{className:m()("btn-link",{"d-none":!this.state.optionsMore}),onClick:this.revealOptions,type:"button"},void 0,Z||(Z=(0,o.A)("span",{className:"material-icon"},void 0,"more_vertical")),pgettext("user nav","See more"))),!!a&&(0,o.A)(ee.Xy,{listItem:!0},void 0,(0,o.A)("button",{className:"btn btn-default btn-block",onClick:function(){te(),n()},type:"button"},void 0,pgettext("user nav","Log out"))))}}]),i}(v().Component);const ae=(0,A.Ng)(function(e){var t=e.auth.user;return t.id?{user:{username:t.username,unreadNotifications:t.unreadNotifications,unreadPrivateThreads:t.unread_private_threads,showPrivateThreads:t.acl.can_use_private_threads,url:t.url},options:(0,i.A)(misago.get("userOptions"))}:{user:null}})(ne);function ie(e){var t=e.close;return(0,o.A)(ae,{close:t,dropdown:!0})}var oe=n(22926),re=n(64015);const se=(0,A.Ng)(function(e){return{isOpen:e.overlay.userNav}})(function(e){var t=e.dispatch,n=e.isOpen;return(0,o.A)(re.h,{open:n},void 0,(0,o.A)(re.e,{},void 0,pgettext("user nav title","Your options")),(0,o.A)(ae,{close:function(){return t((0,oe.VN)())},overlay:!0}),(0,o.A)(ee.Xy,{},void 0,(0,o.A)("button",{className:"btn btn-default btn-block",onClick:function(){te(),t((0,oe.VN)())},type:"button"},void 0,pgettext("user nav","Log out"))))})},40669:(e,t,n)=>{"use strict";var a=n(73971),i=n(95271),o=n(52762);a.A.addInitializer({name:"reducer:profile-hydrate",initializer:function(){a.A.has("PROFILE")&&o.A.dispatch((0,i.Qv)(a.A.get("PROFILE")))},after:"store"})},41467:(e,t,n)=>{"use strict";n.d(t,{Ay:()=>p,VX:()=>m,kW:()=>h});var a=n(73620),i=n(23029),o=n(92901),r=n(15361),s=n(61801),u=n(53954),l=n(40927),c=n.n(l);function d(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,a=(0,u.A)(e);if(t){var i=(0,u.A)(this).constructor;n=Reflect.construct(a,arguments,i)}else n=a.apply(this,arguments);return(0,s.A)(this,n)}}var p=function(e){(0,r.A)(n,e);var t=d(n);function n(){return(0,i.A)(this,n),t.apply(this,arguments)}return(0,o.A)(n,[{key:"getClass",value:function(){return e=this.props.status,t="",e.is_banned?t="banned":e.is_hidden?t="offline":e.is_online_hidden?t="online":e.is_offline_hidden?t="offline":e.is_online?t="online":e.is_offline&&(t="offline"),"user-status user-"+t;var e,t}},{key:"render",value:function(){return(0,a.A)("span",{className:this.getClass()},void 0,this.props.children)}}]),n}(c().Component),h=function(e){(0,r.A)(n,e);var t=d(n);function n(){return(0,i.A)(this,n),t.apply(this,arguments)}return(0,o.A)(n,[{key:"getIcon",value:function(){return this.props.status.is_banned?"remove_circle_outline":this.props.status.is_hidden?"help_outline":this.props.status.is_online_hidden?"label":this.props.status.is_offline_hidden?"label_outline":this.props.status.is_online?"lens":this.props.status.is_offline?"panorama_fish_eye":void 0}},{key:"render",value:function(){return(0,a.A)("span",{className:"material-icon status-icon"},void 0,this.getIcon())}}]),n}(c().Component),m=function(e){(0,r.A)(n,e);var t=d(n);function n(){return(0,i.A)(this,n),t.apply(this,arguments)}return(0,o.A)(n,[{key:"getHelp",value:function(){return e=this.props.user,(t=this.props.status).is_banned?t.banned_until?interpolate(pgettext("user status","%(username)s is banned until %(ban_expires)s"),{username:e.username,ban_expires:t.banned_until.format("LL, LT")},!0):interpolate(pgettext("user status","%(username)s is banned"),{username:e.username},!0):t.is_hidden?interpolate(pgettext("user status","%(username)s is hiding presence"),{username:e.username},!0):t.is_online_hidden?interpolate(pgettext("user status","%(username)s is online (hidden)"),{username:e.username},!0):t.is_offline_hidden?interpolate(pgettext("user status","%(username)s was last seen %(last_click)s (hidden)"),{username:e.username,last_click:t.last_click.fromNow()},!0):t.is_online?interpolate(pgettext("user status","%(username)s is online"),{username:e.username},!0):t.is_offline?interpolate(pgettext("user status","%(username)s was last seen %(last_click)s"),{username:e.username,last_click:t.last_click.fromNow()},!0):void 0;var e,t}},{key:"getLabel",value:function(){return this.props.status.is_banned?pgettext("user status","Banned"):this.props.status.is_hidden?pgettext("user status","Hidden"):this.props.status.is_online_hidden?pgettext("user status","Online (hidden)"):this.props.status.is_offline_hidden?pgettext("user status","Offline (hidden)"):this.props.status.is_online?pgettext("user status","Online"):this.props.status.is_offline?pgettext("user status","Offline"):void 0}},{key:"render",value:function(){return(0,a.A)("span",{className:this.props.className||"status-label",title:this.getHelp()},void 0,this.getLabel())}}]),n}(c().Component)},41484:(e,t,n)=>{"use strict";n.d(t,{A:()=>V});var a=n(73620),i=n(23029),o=n(92901),r=n(9417),s=n(15361),u=n(61801),l=n(53954),c=n(64467),d=n(32485),p=n.n(d),h=n(40927),m=n.n(h),f=n(92069),v=n(36629),A=n(70490),g=n(29904),y=n(27944),b=n(58168),D=n(39227),x=n(849),k=n(82743),_=n(24272);var N,C,E,w=["progress-bar-danger","progress-bar-warning","progress-bar-warning","progress-bar-primary","progress-bar-success"],F=[pgettext("password strength indicator","Entered password is very weak."),pgettext("password strength indicator","Entered password is weak."),pgettext("password strength indicator","Entered password is average."),pgettext("password strength indicator","Entered password is strong."),pgettext("password strength indicator","Entered password is very strong.")],R=function(e){(0,s.A)(c,e);var t,n,r=(t=c,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}(),function(){var e,a=(0,l.A)(t);if(n){var i=(0,l.A)(this).constructor;e=Reflect.construct(a,arguments,i)}else e=a.apply(this,arguments);return(0,u.A)(this,e)});function c(e){var t;return(0,i.A)(this,c),(t=r.call(this,e))._score=0,t._password=null,t._inputs=[],t.state={loaded:!1},t}return(0,o.A)(c,[{key:"componentDidMount",value:function(){var e=this;_.A.load().then(function(){e.setState({loaded:!0})})}},{key:"getScore",value:function(e,t){var n=this,a=!1;return e!==this._password&&(a=!0),t.length!==this._inputs.length?a=!0:t.map(function(e,t){e.trim()!==n._inputs[t]&&(a=!0)}),a&&(this._score=_.A.scorePassword(e,t),this._password=e,this._inputs=t.map(function(e){return e.trim()})),this._score}},{key:"render",value:function(){if(!this.state.loaded)return null;var e=this.getScore(this.props.password,this.props.inputs);return(0,a.A)("div",{className:"help-block password-strength"},void 0,(0,a.A)("div",{className:"progress"},void 0,(0,a.A)("div",{className:"progress-bar "+w[e],style:{width:20+20*e+"%"},role:"progress-bar","aria-valuenow":e,"aria-valuemin":"0","aria-valuemax":"4"},void 0,(0,a.A)("span",{className:"sr-only"},void 0,F[e]))),(0,a.A)("p",{className:"text-small"},void 0,F[e]))}}]),c}(m().Component),S=n(82853),B=n(48354),L=n(73971),T=n(1657),O=n(74017),P=n(89077);function I(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,a)}return n}function q(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?I(Object(n),!0).forEach(function(t){(0,c.A)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):I(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function U(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,a=(0,l.A)(e);if(t){var i=(0,l.A)(this).constructor;n=Reflect.construct(a,arguments,i)}else n=a.apply(this,arguments);return(0,u.A)(this,n)}}var j,M=function(e){(0,s.A)(n,e);var t=U(n);function n(e){var a;(0,i.A)(this,n),a=t.call(this,e),(0,c.A)((0,r.A)(a),"handlePrivacyPolicyChange",function(e){var t=e.target.value;a.handleToggleAgreement("privacyPolicy",t)}),(0,c.A)((0,r.A)(a),"handleTermsOfServiceChange",function(e){var t=e.target.value;a.handleToggleAgreement("termsOfService",t)}),(0,c.A)((0,r.A)(a),"handleToggleAgreement",function(e,t){a.setState(function(n,i){if(null===n[e]){var o=q(q({},n.errors),{},(0,c.A)({},e,null));return(0,c.A)({errors:o},e,t)}var r=a.state.validators[e][0],s=q(q({},n.errors),{},(0,c.A)({},e,[r(null)]));return(0,c.A)({errors:s},e,null)})});var o=a.props.criteria,s=o.username,u=o.password,l=0;u.forEach(function(e){"MinimumLengthValidator"===e.name&&(l=e.min_length)});var d={username:[P.KP(),P.jC(s.min_length),P.FC(s.max_length)],email:[P.Rp()],password:[P.Oi(l)],captcha:v.Ay.validator()};return L.A.get("TERMS_OF_SERVICE_ID")&&(d.termsOfService=[P.xi()]),L.A.get("PRIVACY_POLICY_ID")&&(d.privacyPolicy=[P.Yc()]),a.state={isLoading:!1,username:"",email:"",password:"",captcha:"",termsOfService:null,privacyPolicy:null,validators:d,errors:{}},a}return(0,o.A)(n,[{key:"clean",value:function(){return!!this.isValid()||(g.A.error(gettext("Form contains errors.")),this.setState({errors:this.validate()}),!1)}},{key:"send",value:function(){return f.A.post(L.A.get("USERS_API"),{username:this.state.username,email:this.state.email,password:this.state.password,captcha:this.state.captcha,terms_of_service:this.state.termsOfService,privacy_policy:this.state.privacyPolicy})}},{key:"handleSuccess",value:function(e){this.props.callback(e)}},{key:"handleError",value:function(e){400===e.status?(this.setState({errors:Object.assign({},this.state.errors,e)}),e.__all__&&e.__all__.length>0?g.A.error(e.__all__[0]):g.A.error(gettext("Form contains errors."))):403===e.status&&e.ban?((0,O.A)(e.ban),A.A.hide()):g.A.apiError(e)}},{key:"render",value:function(){return(0,a.A)("div",{className:"modal-dialog modal-register",role:"document"},void 0,(0,a.A)("div",{className:"modal-content"},void 0,(0,a.A)("div",{className:"modal-header"},void 0,(0,a.A)("button",{type:"button",className:"close","data-dismiss":"modal","aria-label":pgettext("modal","Close")},void 0,N||(N=(0,a.A)("span",{"aria-hidden":"true"},void 0,"Ã—"))),(0,a.A)("h4",{className:"modal-title"},void 0,pgettext("register modal title","Register"))),(0,a.A)("form",{onSubmit:this.handleSubmit},void 0,(0,a.A)("input",{type:"type",style:{display:"none"}}),(0,a.A)("input",{type:"password",style:{display:"none"}}),(0,a.A)("div",{className:"modal-body"},void 0,(0,a.A)(B.A,{buttonClassName:"col-xs-12 col-sm-6",buttonLabel:pgettext("register modal field","Join with %(site)s"),formLabel:pgettext("register modal field","Or create forum account:")}),(0,a.A)(k.A,{label:pgettext("register modal field","Username"),for:"id_username",validation:this.state.errors.username},void 0,(0,a.A)("input",{type:"text",id:"id_username",className:"form-control","aria-describedby":"id_username_status",disabled:this.state.isLoading,onChange:this.bindInput("username"),value:this.state.username})),(0,a.A)(k.A,{label:pgettext("register modal field","E-mail"),for:"id_email",validation:this.state.errors.email},void 0,(0,a.A)("input",{type:"text",id:"id_email",className:"form-control","aria-describedby":"id_email_status",disabled:this.state.isLoading,onChange:this.bindInput("email"),value:this.state.email})),(0,a.A)(k.A,{label:pgettext("register modal field","Password"),for:"id_password",validation:this.state.errors.password,extra:(0,a.A)(R,{password:this.state.password,inputs:[this.state.username,this.state.email]})},void 0,(0,a.A)("input",{type:"password",id:"id_password",className:"form-control","aria-describedby":"id_password_status",disabled:this.state.isLoading,onChange:this.bindInput("password"),value:this.state.password})),v.Ay.component({form:this}),(0,a.A)(S.A,{errors:this.state.errors,privacyPolicy:this.state.privacyPolicy,termsOfService:this.state.termsOfService,onPrivacyPolicyChange:this.handlePrivacyPolicyChange,onTermsOfServiceChange:this.handleTermsOfServiceChange})),(0,a.A)("div",{className:"modal-footer"},void 0,(0,a.A)("button",{className:"btn btn-default","data-dismiss":"modal",disabled:this.state.isLoading,type:"button"},void 0,pgettext("register modal btn","Cancel")),(0,a.A)(D.A,{className:"btn-primary",loading:this.state.isLoading},void 0,pgettext("register modal btn","Register account"))))))}}]),n}(x.A),z=function(e){(0,s.A)(n,e);var t=U(n);function n(){return(0,i.A)(this,n),t.apply(this,arguments)}return(0,o.A)(n,[{key:"getLead",value:function(){return"user"===this.props.activation?pgettext("account activation required","%(username)s, your account has been created but you need to activate it before you will be able to sign in."):"admin"===this.props.activation?pgettext("account activation required","%(username)s, your account has been created but the site administrator will have to activate it before you will be able to sign in."):void 0}},{key:"getSubscript",value:function(){return"user"===this.props.activation?pgettext("account activation required","We have sent an e-mail to %(email)s with link that you have to click to activate your account."):"admin"===this.props.activation?pgettext("account activation required","We will send an e-mail to %(email)s when this takes place."):void 0}},{key:"render",value:function(){return(0,a.A)("div",{className:"modal-dialog modal-message modal-register",role:"document"},void 0,(0,a.A)("div",{className:"modal-content"},void 0,(0,a.A)("div",{className:"modal-header"},void 0,(0,a.A)("button",{type:"button",className:"close","data-dismiss":"modal","aria-label":pgettext("modal","Close")},void 0,C||(C=(0,a.A)("span",{"aria-hidden":"true"},void 0,"Ã—"))),(0,a.A)("h4",{className:"modal-title"},void 0,pgettext("register modal title","Registration complete"))),(0,a.A)("div",{className:"modal-body"},void 0,E||(E=(0,a.A)("div",{className:"message-icon"},void 0,(0,a.A)("span",{className:"material-icon"},void 0,"info_outline"))),(0,a.A)("div",{className:"message-body"},void 0,(0,a.A)("p",{className:"lead"},void 0,interpolate(this.getLead(),{username:this.props.username},!0)),(0,a.A)("p",{},void 0,interpolate(this.getSubscript(),{email:this.props.email},!0)),(0,a.A)("button",{className:"btn btn-default","data-dismiss":"modal",type:"button"},void 0,pgettext("register modal dismiss","Ok"))))))}}]),n}(m().Component),H=function(e){(0,s.A)(n,e);var t=U(n);function n(e){var a;return(0,i.A)(this,n),a=t.call(this,e),(0,c.A)((0,r.A)(a),"completeRegistration",function(e){"active"===e.activation?(A.A.hide(),T.A.signIn(e)):a.setState({complete:e})}),a.state={complete:!1},a}return(0,o.A)(n,[{key:"render",value:function(){return this.state.complete?(0,a.A)(z,{activation:this.state.complete.activation,email:this.state.complete.email,username:this.state.complete.username}):m().createElement(M,(0,b.A)({callback:this.completeRegistration},this.props))}}]),n}(m().Component);const V=function(e){(0,s.A)(h,e);var t,n,d=(t=h,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}(),function(){var e,a=(0,l.A)(t);if(n){var i=(0,l.A)(this).constructor;e=Reflect.construct(a,arguments,i)}else e=a.apply(this,arguments);return(0,u.A)(this,e)});function h(e){var t;return(0,i.A)(this,h),t=d.call(this,e),(0,c.A)((0,r.A)(t),"showRegisterForm",function(){t.props.onClick&&t.props.onClick(),"closed"===misago.get("SETTINGS").account_activation?g.A.info(pgettext("register form","Registration form is currently disabled by the site administrator.")):t.state.isLoaded?A.A.show((0,a.A)(H,{criteria:t.state.criteria})):(t.setState({isLoading:!0}),Promise.all([v.Ay.load(),f.A.get(misago.get("AUTH_CRITERIA_API"))]).then(function(e){t.setState({isLoading:!1,isLoaded:!0,criteria:e[1]}),A.A.show((0,a.A)(H,{criteria:e[1]}))},function(){t.setState({isLoading:!1}),g.A.error(pgettext("register form","Registration form is currently unavailable due to an error."))}))}),t.state={isLoading:!1,isLoaded:!1,criteria:null},t}return(0,o.A)(h,[{key:"render",value:function(){return(0,a.A)("button",{className:p()("btn btn-register",this.props.className,{"btn-block":this.props.block,"btn-loading":this.state.isLoading}),disabled:this.state.isLoading,onClick:this.showRegisterForm,type:"button"},void 0,pgettext("cta","Register"),this.state.isLoading?j||(j=(0,a.A)(y.A,{})):null)}}]),h}(m().Component)},44549:(e,t,n)=>{"use strict";n.d(t,{GH:()=>r,oB:()=>o});var a=n(89077),i=n(73971);function o(){return[(0,a.Bp)(i.A.get("SETTINGS").thread_title_length_min,function(e,t){var n=npgettext("thread title length validator","Thread title should be at least %(limit_value)s character long (it has %(show_value)s).","Thread title should be at least %(limit_value)s characters long (it has %(show_value)s).",e);return interpolate(n,{limit_value:e,show_value:t},!0)}),(0,a.Ru)(i.A.get("SETTINGS").thread_title_length_max,function(e,t){var n=npgettext("thread title length validator","Thread title cannot be longer than %(limit_value)s character (it has %(show_value)s).","Thread title cannot be longer than %(limit_value)s characters (it has %(show_value)s).",e);return interpolate(n,{limit_value:e,show_value:t},!0)})]}function r(){return i.A.get("SETTINGS").post_length_max?[s(),(0,a.Ru)(i.A.get("SETTINGS").post_length_max||1e6,function(e,t){var n=npgettext("post length validator","Posted message cannot be longer than %(limit_value)s character (it has %(show_value)s).","Posted message cannot be longer than %(limit_value)s characters (it has %(show_value)s).",e);return interpolate(n,{limit_value:e,show_value:t},!0)})]:[s()]}function s(){return(0,a.Bp)(i.A.get("SETTINGS").post_length_min,function(e,t){var n=npgettext("post length validator","Posted message should be at least %(limit_value)s character long (it has %(show_value)s).","Posted message should be at least %(limit_value)s characters long (it has %(show_value)s).",e);return interpolate(n,{limit_value:e,show_value:t},!0)})}},44613:(e,t,n)=>{"use strict";var a,i=n(73620),o=(n(40927),n(40961)),r=n.n(o),s=n(67467),u=n(91043),l=n(52762);misago.addInitializer({name:"component:site-nav-overlay",initializer:function(e){var t=document.getElementById("site-nav-mount");r().render((0,i.A)(s.Kq,{store:l.A.getStore()},void 0,a||(a=(0,i.A)(u.BE,{}))),t)},after:"store"})},48354:(e,t,n)=>{"use strict";n.d(t,{A:()=>s});var a,i=n(73620),o=(n(40927),n(73971)),r=function(e){var t=e.className,n=e.text;return n?(0,i.A)("h5",{className:t||""},void 0,n):null};const s=function(e){var t=e.buttonClassName,n=e.buttonLabel,s=e.formLabel,u=e.header,l=e.labelClassName,c=o.A.get("SOCIAL_AUTH");return 0===c.length?null:(0,i.A)("div",{className:"form-group form-social-auth"},void 0,(0,i.A)(r,{className:l,text:u}),(0,i.A)("div",{className:"row"},void 0,c.map(function(e){var a=e.pk,o=e.name,r=e.button_text,s=e.button_color,u=e.url,l="btn btn-block btn-default btn-social-"+a,c=s?{color:s}:null,d=r||interpolate(n,{site:o},!0);return(0,i.A)("div",{className:t||"col-xs-12"},a,(0,i.A)("a",{className:l,style:c,href:u},void 0,d))})),a||(a=(0,i.A)("hr",{})),(0,i.A)(r,{className:l,text:s}))}},48995:(e,t,n)=>{"use strict";n.d(t,{A:()=>i});var a=n(73620);n(40927);const i=function(e){var t=e.children;return(0,a.A)("div",{className:"container page-container"},void 0,t)}},49954:(e,t,n)=>{"use strict";n.d(t,{A:()=>R});var a,i=n(73620),o=n(40927),r=n.n(o),s=n(30330),u=n(41467);function l(e){var t=e.showStatus,n=e.user;return(0,i.A)("ul",{className:"list-unstyled"},void 0,(0,i.A)(c,{showStatus:t,user:n}),(0,i.A)(d,{user:n}),a||(a=(0,i.A)("li",{className:"user-stat-divider"})),(0,i.A)(p,{user:n}),(0,i.A)(h,{user:n}),(0,i.A)(m,{user:n}))}function c(e){var t=e.showStatus,n=e.user;return t?(0,i.A)("li",{className:"user-stat-status"},void 0,(0,i.A)(u.Ay,{status:n.status},void 0,(0,i.A)(u.VX,{status:n.status,user:n}))):null}function d(e){var t=e.user.joined_on,n=interpolate(pgettext("users list item","Joined on %(joined_on)s"),{joined_on:t.format("LL, LT")},!0),a=interpolate(pgettext("users list item","Joined %(joined_on)s"),{joined_on:t.fromNow()},!0);return(0,i.A)("li",{className:"user-stat-join-date"},void 0,(0,i.A)("abbr",{title:n},void 0,a))}function p(e){var t=e.user,n=f("user-stat-posts",t.posts),a=npgettext("users list item","%(posts)s post","%(posts)s posts",t.posts);return(0,i.A)("li",{className:n},void 0,interpolate(a,{posts:t.posts},!0))}function h(e){var t=e.user,n=f("user-stat-threads",t.threads),a=npgettext("users list item","%(threads)s thread","%(threads)s threads",t.threads);return(0,i.A)("li",{className:n},void 0,interpolate(a,{threads:t.threads},!0))}function m(e){var t=e.user,n=f("user-stat-followers",t.followers),a=npgettext("users list item","%(followers)s follower","%(followers)s followers",t.followers);return(0,i.A)("li",{className:n},void 0,interpolate(a,{followers:t.followers},!0))}function f(e,t){return 0===t?e+" user-stat-empty":e}function v(e){var t=e.rank,n=e.title||t.title||t.name,a="user-title";return t.css_class&&(a+=" user-title-"+t.css_class),t.is_tab?(0,i.A)("a",{className:a,href:t.url},void 0,n):(0,i.A)("span",{className:a},void 0,n)}function A(e){var t=e.showStatus,n=e.user,a=n.rank,o="panel user-card";return a.css_class&&(o+=" user-card-"+a.css_class),(0,i.A)("div",{className:o},void 0,(0,i.A)("div",{className:"panel-body"},void 0,(0,i.A)("div",{className:"row"},void 0,(0,i.A)("div",{className:"col-xs-3 user-card-left"},void 0,(0,i.A)("div",{className:"user-card-small-avatar"},void 0,(0,i.A)("a",{href:n.url},void 0,(0,i.A)(s.Ay,{size:"50",size2x:"80",user:n})))),(0,i.A)("div",{className:"col-xs-9 col-sm-12 user-card-body"},void 0,(0,i.A)("div",{className:"user-card-avatar"},void 0,(0,i.A)("a",{href:n.url},void 0,(0,i.A)(s.Ay,{size:"150",size2x:"200",user:n}))),(0,i.A)("div",{className:"user-card-username"},void 0,(0,i.A)("a",{href:n.url},void 0,n.username)),(0,i.A)("div",{className:"user-card-title"},void 0,(0,i.A)(v,{rank:a,title:n.title})),(0,i.A)("div",{className:"user-card-stats"},void 0,(0,i.A)(l,{showStatus:t,user:n}))))))}var g,y,b,D=n(23029),x=n(92901),k=n(15361),_=n(61801),N=n(53954),C=n(33097);var E,w=function(e){(0,k.A)(o,e);var t,n,a=(t=o,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}(),function(){var e,a=(0,N.A)(t);if(n){var i=(0,N.A)(this).constructor;e=Reflect.construct(a,arguments,i)}else e=a.apply(this,arguments);return(0,_.A)(this,e)});function o(){return(0,D.A)(this,o),a.apply(this,arguments)}return(0,x.A)(o,[{key:"shouldComponentUpdate",value:function(){return!1}},{key:"render",value:function(){return(0,i.A)("div",{className:"panel user-card user-card-preview"},void 0,(0,i.A)("div",{className:"panel-body"},void 0,(0,i.A)("div",{className:"row"},void 0,g||(g=(0,i.A)("div",{className:"col-xs-3 user-card-left"},void 0,(0,i.A)("div",{className:"user-card-small-avatar"},void 0,(0,i.A)("span",{},void 0,(0,i.A)(s.Ay,{size:"50",size2x:"80"}))))),(0,i.A)("div",{className:"col-xs-9 col-sm-12 user-card-body"},void 0,y||(y=(0,i.A)("div",{className:"user-card-avatar"},void 0,(0,i.A)("span",{},void 0,(0,i.A)(s.Ay,{size:"150",size2x:"200"})))),(0,i.A)("div",{className:"user-card-username"},void 0,(0,i.A)("span",{className:"ui-preview-text",style:{width:C.W(60,150)+"px"}},void 0,"Â ")),(0,i.A)("div",{className:"user-card-title"},void 0,(0,i.A)("span",{className:"ui-preview-text",style:{width:C.W(60,150)+"px"}},void 0,"Â ")),(0,i.A)("div",{className:"user-card-stats"},void 0,(0,i.A)("ul",{className:"list-unstyled"},void 0,(0,i.A)("li",{},void 0,(0,i.A)("span",{className:"ui-preview-text",style:{width:C.W(30,70)+"px"}},void 0,"Â ")),(0,i.A)("li",{},void 0,(0,i.A)("span",{className:"ui-preview-text",style:{width:C.W(30,70)+"px"}},void 0,"Â ")),b||(b=(0,i.A)("li",{className:"user-stat-divider"})),(0,i.A)("li",{},void 0,(0,i.A)("span",{className:"ui-preview-text",style:{width:C.W(30,70)+"px"}},void 0,"Â ")),(0,i.A)("li",{},void 0,(0,i.A)("span",{className:"ui-preview-text",style:{width:C.W(30,70)+"px"}},void 0,"Â "))))))))}}]),o}(r().Component);function F(e){var t=e.colClassName,n=e.cols,a=Array.apply(null,{length:n}).map(Number.call,Number);return(0,i.A)("div",{className:"users-cards-list ui-preview"},void 0,(0,i.A)("div",{className:"row"},void 0,a.map(function(e){var n=t;return 0!==e&&(n+=" hidden-xs"),3===e&&(n+=" hidden-sm"),(0,i.A)("div",{className:n},e,E||(E=(0,i.A)(w,{})))})))}function R(e){var t=e.cols,n=e.isReady,a=e.showStatus,o=e.users,r="col-xs-12 col-sm-4";return 4===t&&(r+=" col-md-3"),n?(0,i.A)("div",{className:"users-cards-list ui-ready"},void 0,(0,i.A)("div",{className:"row"},void 0,o.map(function(e){return(0,i.A)("div",{className:r},e.id,(0,i.A)(A,{showStatus:a,user:e}))}))):(0,i.A)(F,{colClassName:r,cols:t})}},50241:(e,t,n)=>{"use strict";var a=n(73971),i=n(50425),o=n(52762);a.A.addInitializer({name:"reducer:posts",initializer:function(){var e;e=a.A.has("POSTS")?(0,i.Qv)(a.A.get("POSTS")):{isLoaded:!1,isBusy:!1},o.A.addReducer("posts",i.Ay,e)},before:"store"})},50425:(e,t,n)=>{"use strict";n.d(t,{Ay:()=>y,BC:()=>v,GP:()=>A,Hh:()=>f,Lt:()=>d,NQ:()=>h,Qv:()=>m,wm:()=>p,yo:()=>g});var a=n(93386),i="APPEND_POSTS",o="SELECT_POST",r="DESELECT_POST",s="DESELECT_POSTS",u="LOAD_POSTS",l="UNLOAD_POSTS",c="UPDATE_POSTS";function d(e){return{type:o,post:e}}function p(e){return{type:r,post:e}}function h(){return{type:s}}function m(e){return Object.assign({},e,{results:e.results.map(a.Qv),isLoaded:!0,isBusy:!1,isSelected:!1})}function f(e){return{type:u,state:arguments.length>1&&void 0!==arguments[1]&&arguments[1]?e:m(e)}}function v(e){return{type:i,state:arguments.length>1&&void 0!==arguments[1]&&arguments[1]?e:m(e)}}function A(){return{type:l}}function g(e){return{type:c,update:e}}function y(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;switch(t.type){case o:var n=e.results.map(function(e){return e.id==t.post.id?Object.assign({},e,{isSelected:!0}):e});return Object.assign({},e,{results:n});case r:var d=e.results.map(function(e){return e.id==t.post.id?Object.assign({},e,{isSelected:!1}):e});return Object.assign({},e,{results:d});case s:var p=e.results.map(function(e){return Object.assign({},e,{isSelected:!1})});return Object.assign({},e,{results:p});case i:var h=e.results.slice(),m=e.results.map(function(e){return e.id});return t.state.results.map(function(e){-1===m.indexOf(e.id)&&h.push(e)}),Object.assign({},t.state,{results:h});case u:return t.state;case l:return Object.assign({},e,{isLoaded:!1});case c:return Object.assign({},e,t.update);case a.QB:var f=e.results.map(function(e){return(0,a.Ay)(e,t)});return Object.assign({},e,{results:f});default:return e}}},51379:(e,t,n)=>{"use strict";var a=n(95093),i=n.n(a),o=n(73971),r=n(74692);o.A.addInitializer({name:"moment",initializer:function(){i().locale(r("html").attr("lang"))}})},51433:(e,t,n)=>{"use strict";n.d(t,{Ay:()=>f,By:()=>u,HC:()=>h,Qv:()=>c,S2:()=>d,TF:()=>m,Vr:()=>s,_r:()=>p});var a=n(95093),i=n.n(a),o="BUSY_POLL",r="RELEASE_POLL",s="REMOVE_POLL",u="REPLACE_POLL",l="UPDATE_POLL";function c(e){var t=!1;for(var n in e.choices)if(e.choices[n].selected){t=!0;break}return Object.assign({},e,{posted_on:i()(e.posted_on),hasSelectedChoices:t,endsOn:e.length?i()(e.posted_on).add(e.length,"days"):null,isBusy:!1})}function d(){return{type:o}}function p(){return{type:r}}function h(e){return{type:u,state:arguments.length>1&&void 0!==arguments[1]&&arguments[1]?e:c(e)}}function m(){return{type:s}}function f(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;switch(t.type){case o:return Object.assign({},e,{isBusy:!0});case r:return Object.assign({},e,{isBusy:!1});case s:return{isBusy:!1};case u:return t.state;case l:return Object.assign({},e,t.data);default:return e}}},51596:(e,t,n)=>{"use strict";var a=n(73971),i=n(71569),o=n(52762);a.A.addInitializer({name:"tick-start",initializer:function(){window.setInterval(function(){o.A.dispatch((0,i.Ri)())},5e4)},after:"store"})},51828:(e,t,n)=>{"use strict";n.d(t,{A:()=>i});var a=n(73620);function i(e){return(0,a.A)("select",{className:e.className||"form-control",disabled:e.disabled||!1,id:e.id||null,onChange:e.onChange,value:e.value},void 0,e.choices.map(function(e){return(0,a.A)("option",{disabled:e.disabled||!1,value:e.value},e.value,"- - ".repeat(e.level)+e.label)}))}n(40927)},52433:(e,t,n)=>{"use strict";var a=n(73971),i=n(17772);a.A.addInitializer({name:"local-storage",initializer:function(){i.A.init("misago_")}})},52762:(e,t,n)=>{"use strict";n.d(t,{A:()=>r});var a=n(23029),i=n(92901),o=n(54384);const r=new(function(){function e(){(0,a.A)(this,e),this._store=null,this._reducers={},this._initialState={}}return(0,i.A)(e,[{key:"addReducer",value:function(e,t,n){this._reducers[e]=t,this._initialState[e]=n}},{key:"init",value:function(){this._store=(0,o.createStore)((0,o.combineReducers)(this._reducers),this._initialState)}},{key:"getStore",value:function(){return this._store}},{key:"getState",value:function(){return this._store.getState()}},{key:"dispatch",value:function(e){return this._store.dispatch(e)}}]),e}())},54422:(e,t,n)=>{"use strict";var a=n(73971),i=n(92069);a.A.addInitializer({name:"ajax",initializer:function(){i.A.init(a.A.get("CSRF_COOKIE_NAME"))}})},55385:(e,t,n)=>{"use strict";var a=n(73971),i=n(37281),o=n(52762);a.A.addInitializer({name:"reducer:username-history",initializer:function(){o.A.addReducer("username-history",i.Ay,[])},before:"store"})},55667:(e,t,n)=>{"use strict";var a,i=n(67467),o=n(73620),r=n(23029),s=n(92901),u=n(9417),l=n(15361),c=n(61801),d=n(53954),p=n(64467),h=n(40927),m=n.n(h),f=n(95093),v=n.n(f),A=n(27944);var g,y=function(e){(0,l.A)(u,e);var t,n,i=(t=u,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}(),function(){var e,a=(0,d.A)(t);if(n){var i=(0,d.A)(this).constructor;e=Reflect.construct(a,arguments,i)}else e=a.apply(this,arguments);return(0,c.A)(this,e)});function u(){return(0,r.A)(this,u),i.apply(this,arguments)}return(0,s.A)(u,[{key:"render",value:function(){return a||(a=(0,o.A)("div",{className:"panel-body panel-body-loading"},void 0,(0,o.A)(A.A,{className:"loader loader-spaced"})))}}]),u}(m().Component),b=n(76671),D=n(73971),x=n(22557),k=n(39395);var _,N=function(e){(0,l.A)(i,e);var t,n,a=(t=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}(),function(){var e,a=(0,d.A)(t);if(n){var i=(0,d.A)(this).constructor;e=Reflect.construct(a,arguments,i)}else e=a.apply(this,arguments);return(0,c.A)(this,e)});function i(e){var t;return(0,r.A)(this,i),t=a.call(this,e),(0,p.A)((0,u.A)(t),"update",function(e){e.expires_on&&(e.expires_on=v()(e.expires_on)),t.setState({isLoaded:!0,error:null,ban:e})}),(0,p.A)((0,u.A)(t),"error",function(e){t.setState({isLoaded:!0,error:e.detail,ban:null})}),D.A.has("PROFILE_BAN")?t.initWithPreloadedData(D.A.pop("PROFILE_BAN")):t.initWithoutPreloadedData(),t.startPolling(e.profile.api.ban),t}return(0,s.A)(i,[{key:"initWithPreloadedData",value:function(e){e.expires_on&&(e.expires_on=v()(e.expires_on)),this.state={isLoaded:!0,ban:e}}},{key:"initWithoutPreloadedData",value:function(){this.state={isLoaded:!1}}},{key:"startPolling",value:function(e){x.A.start({poll:"ban-details",url:e,frequency:9e4,update:this.update,error:this.error})}},{key:"componentDidMount",value:function(){k.A.set({title:pgettext("profile ban details title","Ban details"),parent:this.props.profile.username})}},{key:"componentWillUnmount",value:function(){x.A.stop("ban-details")}},{key:"getUserMessage",value:function(){return this.state.ban.user_message?(0,o.A)("div",{className:"panel-body ban-message ban-user-message"},void 0,(0,o.A)("h4",{},void 0,pgettext("profile ban details","User-shown ban message")),(0,o.A)("div",{className:"lead",dangerouslySetInnerHTML:{__html:this.state.ban.user_message.html}})):null}},{key:"getStaffMessage",value:function(){return this.state.ban.staff_message?(0,o.A)("div",{className:"panel-body ban-message ban-staff-message"},void 0,(0,o.A)("h4",{},void 0,pgettext("profile ban details","Team-shown ban message")),(0,o.A)("div",{className:"lead",dangerouslySetInnerHTML:{__html:this.state.ban.staff_message.html}})):null}},{key:"getExpirationMessage",value:function(){if(this.state.ban.expires_on){if(this.state.ban.expires_on.isAfter(v()())){var e=interpolate(pgettext("profile ban details","This ban expires on %(expires_on)s."),{expires_on:this.state.ban.expires_on.format("LL, LT")},!0),t=interpolate(pgettext("profile ban details","This ban expires %(expires_on)s."),{expires_on:this.state.ban.expires_on.fromNow()},!0);return(0,o.A)("abbr",{title:e},void 0,t)}return pgettext("profile ban details","This ban has expired.")}return interpolate(pgettext("profile ban details","%(username)s's ban is permanent."),{username:this.props.profile.username},!0)}},{key:"getPanelBody",value:function(){return this.state.ban?Object.keys(this.state.ban).length?(0,o.A)("div",{},void 0,this.getUserMessage(),this.getStaffMessage(),(0,o.A)("div",{className:"panel-body ban-expires"},void 0,(0,o.A)("h4",{},void 0,pgettext("profile ban details","Ban expiration")),(0,o.A)("p",{className:"lead"},void 0,this.getExpirationMessage()))):(0,o.A)("div",{},void 0,(0,o.A)(b.A,{message:pgettext("profile ban details","No ban is active at the moment.")})):this.state.error?(0,o.A)("div",{},void 0,(0,o.A)(b.A,{icon:"error_outline",message:this.state.error})):g||(g=(0,o.A)("div",{},void 0,(0,o.A)(y,{})))}},{key:"render",value:function(){return(0,o.A)("div",{className:"profile-ban-details"},void 0,(0,o.A)("div",{className:"panel panel-default"},void 0,(0,o.A)("div",{className:"panel-heading"},void 0,(0,o.A)("h3",{className:"panel-title"},void 0,pgettext("profile ban details title","Ban details"))),this.getPanelBody()))}}]),i}(m().Component);function C(e){return e.display?(0,o.A)(b.A,{helpText:pgettext("user profile details","No profile details are editable at this time."),message:pgettext("user profile details","This option is currently unavailable.")}):null}function E(e){return e.display?_||(_=(0,o.A)("div",{className:"panel-body"},void 0,(0,o.A)(A.A,{}))):null}var w=n(86511);var F=function(e){(0,l.A)(i,e);var t,n,a=(t=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}(),function(){var e,a=(0,d.A)(t);if(n){var i=(0,d.A)(this).constructor;e=Reflect.construct(a,arguments,i)}else e=a.apply(this,arguments);return(0,c.A)(this,e)});function i(){var e;(0,r.A)(this,i);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return e=a.call.apply(a,[this].concat(n)),(0,p.A)((0,u.A)(e),"onChange",function(t){var n=e.props,a=n.field;(0,n.onChange)(a.fieldname,t.target.value)}),e}return(0,s.A)(i,[{key:"render",value:function(){var e=this.props,t=e.disabled,n=e.field,a=e.value,i=n.input;return"select"===i.type?(0,o.A)(w.A,{choices:i.choices,disabled:t,id:"id_"+n.fieldname,onChange:this.onChange,value:a}):"textarea"===i.type?(0,o.A)("textarea",{className:"form-control",disabled:t,id:"id_"+n.fieldname,onChange:this.onChange,rows:"4",type:"text",value:a}):"text"===i.type?(0,o.A)("input",{className:"form-control",disabled:t,id:"id_"+n.fieldname,onChange:this.onChange,type:"text",value:a}):null}}]),i}(m().Component),R=n(82743);function S(e){var t=e.disabled,n=e.errors,a=e.fields,i=e.name,r=e.onChange,s=e.value;return(0,o.A)("fieldset",{},void 0,(0,o.A)("legend",{},void 0,i),a.map(function(e){return(0,o.A)(R.A,{for:"id_"+e.fieldname,helpText:e.help_text,label:e.label,validation:n[e.fieldname]},e.fieldname,(0,o.A)(F,{disabled:t,field:e,onChange:r,value:s[e.fieldname]}))}))}var B=n(39227),L=n(849),T=n(92069),O=n(29904);var P=function(e){(0,l.A)(i,e);var t,n,a=(t=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}(),function(){var e,a=(0,d.A)(t);if(n){var i=(0,d.A)(this).constructor;e=Reflect.construct(a,arguments,i)}else e=a.apply(this,arguments);return(0,c.A)(this,e)});function i(e){var t;(0,r.A)(this,i),t=a.call(this,e),(0,p.A)((0,u.A)(t),"onChange",function(e,n){t.setState((0,p.A)({},e,n))}),t.state={isLoading:!1,errors:{}};for(var n=e.groups.length,o=0;o<n;o++)for(var s=e.groups[o],l=s.fields.length,c=0;c<l;c++){var d=s.fields[c].fieldname,h=s.fields[c].initial;t.state[d]=h}return t}return(0,s.A)(i,[{key:"send",value:function(){var e=Object.assign({},this.state,{errors:null,isLoading:null});return T.A.post(this.props.api,e)}},{key:"handleSuccess",value:function(e){this.props.onSuccess(e)}},{key:"handleError",value:function(e){400===e.status?(O.A.error(gettext("Form contains errors.")),this.setState({errors:e})):O.A.apiError(e)}},{key:"render",value:function(){var e=this;return(0,o.A)("form",{onSubmit:this.handleSubmit},void 0,(0,o.A)("div",{className:"panel-body"},void 0,this.props.groups.map(function(t,n){return(0,o.A)(S,{disabled:e.state.isLoading,errors:e.state.errors,fields:t.fields,name:t.name,onChange:e.onChange,value:e.state},n)})),(0,o.A)("div",{className:"panel-footer text-right"},void 0,(0,o.A)(I,{disabled:this.state.isLoading,onCancel:this.props.onCancel})," ",(0,o.A)(B.A,{className:"btn-primary",loading:this.state.isLoading},void 0,pgettext("user profile details form btn","Save changes"))))}}]),i}(L.A);function I(e){var t=e.onCancel,n=e.disabled;return t?(0,o.A)("button",{className:"btn btn-default",disabled:n,onClick:t,type:"button"},void 0,pgettext("user profile details form btn","Cancel")):null}var q,U=function(e){(0,l.A)(i,e);var t,n,a=(t=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}(),function(){var e,a=(0,d.A)(t);if(n){var i=(0,d.A)(this).constructor;e=Reflect.construct(a,arguments,i)}else e=a.apply(this,arguments);return(0,c.A)(this,e)});function i(e){var t;return(0,r.A)(this,i),(t=a.call(this,e)).state={loading:!0,groups:null},t}return(0,s.A)(i,[{key:"componentDidMount",value:function(){var e=this;T.A.get(this.props.api).then(function(t){e.setState({loading:!1,groups:t})},function(t){O.A.apiError(t),e.props.cancel&&e.props.cancel()})}},{key:"render",value:function(){var e=this.state,t=e.groups,n=e.loading;return(0,o.A)("div",{className:"panel panel-default panel-form"},void 0,(0,o.A)("div",{className:"panel-heading"},void 0,(0,o.A)("h3",{className:"panel-title"},void 0,pgettext("user profile details form title","Edit details"))),(0,o.A)(E,{display:n}),(0,o.A)(C,{display:!n&&!t.length}),(0,o.A)(j,{api:this.props.api,display:!n&&t.length,groups:t,onCancel:this.props.onCancel,onSuccess:this.props.onSuccess}))}}]),i}(m().Component);function j(e){var t=e.api,n=e.display,a=e.groups,i=e.onCancel,r=e.onSuccess;return n?(0,o.A)(P,{api:t,groups:a,onCancel:i,onSuccess:r}):null}function M(e){var t=e.api,n=e.display,a=e.onCancel,i=e.onSuccess;return n?(0,o.A)(U,{api:t,onCancel:a,onSuccess:i}):null}function z(e){var t,n=e.isAuthenticated,a=e.profile;return t=n?pgettext("profile details empty","You are not sharing any details with others."):interpolate(pgettext("profile details empty","%(username)s is not sharing any details with others."),{username:a.username},!0),(0,o.A)("div",{className:"panel panel-default"},void 0,(0,o.A)("div",{className:"panel-body text-center lead"},void 0,t))}function H(e){var t=e.html,n=e.text,a=e.url;return t?(0,o.A)("div",{className:"form-control-static col-md-9",dangerouslySetInnerHTML:{__html:t}}):(0,o.A)("div",{className:"form-control-static col-md-9"},void 0,(0,o.A)(V,{text:n,url:a}))}function V(e){var t=e.text,n=e.url;return n?(0,o.A)("p",{},void 0,(0,o.A)("a",{href:n,target:"_blank",rel:"nofollow"},void 0,t||n)):t?(0,o.A)("p",{},void 0,t):null}function Y(e){return(0,o.A)("div",{className:"form-group"},void 0,(0,o.A)("strong",{className:"control-label col-md-3"},void 0,e.name,":"),m().createElement(H,e))}function W(e){var t=e.fields,n=e.name;return(0,o.A)("div",{className:"panel panel-default panel-profile-details-group"},void 0,(0,o.A)("div",{className:"panel-heading"},void 0,(0,o.A)("h3",{className:"panel-title"},void 0,n)),(0,o.A)("div",{className:"panel-body"},void 0,(0,o.A)("div",{className:"form-horizontal"},void 0,t.map(function(e){var t=e.fieldname,n=e.html,a=e.name,i=e.text,r=e.url;return(0,o.A)(Y,{name:a,html:n,text:i,url:r},t)}))))}function G(e){var t=e.display,n=e.groups,a=e.isAuthenticated,i=e.loading,r=e.profile;return t?i?q||(q=(0,o.A)(A.A,{})):n.length?(0,o.A)("div",{},void 0,n.map(function(e,t){return(0,o.A)(W,{fields:e.fields,name:e.name},t)})):(0,o.A)(z,{isAuthenticated:a,profile:r}):null}var Q=n(98088);const K=function(e){var t=e.onEdit,n=e.showEditButton;return(0,o.A)(Q.M7,{},void 0,(0,o.A)(Q.rk,{auto:!0},void 0,(0,o.A)(Q.Tm,{auto:!0},void 0,(0,o.A)("h3",{},void 0,pgettext("profile details title","Details")))),n&&(0,o.A)(Q.rk,{},void 0,(0,o.A)(Q.Tm,{},void 0,(0,o.A)("button",{className:"btn btn-default btn-outline btn-block",onClick:t,type:"button"},void 0,pgettext("profile details edit btn","Edit")))))};var X=n(82620);var J=function(e){(0,l.A)(i,e);var t,n,a=(t=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}(),function(){var e,a=(0,d.A)(t);if(n){var i=(0,d.A)(this).constructor;e=Reflect.construct(a,arguments,i)}else e=a.apply(this,arguments);return(0,c.A)(this,e)});function i(){return(0,r.A)(this,i),a.apply(this,arguments)}return(0,s.A)(i,[{key:"componentDidMount",value:function(){var e=this.props,t=e.data,n=e.dispatch,a=e.user;t&&t.id===a.id||T.A.get(this.props.user.api.details).then(function(e){n((0,X.Hh)(e))},function(e){O.A.apiError(e)})}},{key:"render",value:function(){return this.props.children}}]),i}(m().Component);var $=function(e){(0,l.A)(i,e);var t,n,a=(t=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}(),function(){var e,a=(0,d.A)(t);if(n){var i=(0,d.A)(this).constructor;e=Reflect.construct(a,arguments,i)}else e=a.apply(this,arguments);return(0,c.A)(this,e)});function i(e){var t;return(0,r.A)(this,i),t=a.call(this,e),(0,p.A)((0,u.A)(t),"onCancel",function(){t.setState({editing:!1})}),(0,p.A)((0,u.A)(t),"onEdit",function(){t.setState({editing:!0})}),(0,p.A)((0,u.A)(t),"onSuccess",function(e){var n,a=t.props,i=a.dispatch,o=a.isAuthenticated,r=a.profile;n=o?pgettext("profile details form","Your details have been changed."):interpolate(pgettext("profile details form","%(username)s's details have been changed."),{username:r.username},!0),O.A.info(n),i((0,X.Hh)(e)),t.setState({editing:!1})}),t.state={editing:!1},t}return(0,s.A)(i,[{key:"componentDidMount",value:function(){k.A.set({title:pgettext("profile details title","Details"),parent:this.props.profile.username})}},{key:"render",value:function(){var e=this.props,t=e.dispatch,n=e.isAuthenticated,a=e.profile,i=e.profileDetails,r=i.id!==a.id;return(0,o.A)(J,{data:i,dispatch:t,user:a},void 0,(0,o.A)("div",{className:"profile-details"},void 0,(0,o.A)(K,{onEdit:this.onEdit,showEditButton:!!i.edit&&!this.state.editing}),(0,o.A)(G,{display:!this.state.editing,groups:i.groups,isAuthenticated:n,loading:r,profile:a}),(0,o.A)(M,{api:a.api.edit_details,dispatch:t,display:this.state.editing,onCancel:this.onCancel,onSuccess:this.onSuccess})))}}]),i}(m().Component),Z=n(58168),ee=n(81994),te=n(50425),ne=n(52762);var ae,ie=function(e){(0,l.A)(i,e);var t,n,a=(t=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}(),function(){var e,a=(0,d.A)(t);if(n){var i=(0,d.A)(this).constructor;e=Reflect.construct(a,arguments,i)}else e=a.apply(this,arguments);return(0,c.A)(this,e)});function i(e){var t;return(0,r.A)(this,i),t=a.call(this,e),(0,p.A)((0,u.A)(t),"loadMore",function(){t.setState({isLoading:!0}),t.loadItems(t.props.posts.next)}),t.state={isLoading:!1},t}return(0,s.A)(i,[{key:"loadItems",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;T.A.get(this.props.api,{start:t||0}).then(function(n){0===t?ne.A.dispatch(te.Hh(n)):ne.A.dispatch(te.BC(n)),e.setState({isLoading:!1})},function(t){e.setState({isLoading:!1}),O.A.apiError(t)})}},{key:"componentDidMount",value:function(){k.A.set({title:this.props.title,parent:this.props.profile.username}),this.loadItems()}},{key:"render",value:function(){return(0,o.A)("div",{className:"profile-feed"},void 0,(0,o.A)(Q.M7,{},void 0,(0,o.A)(Q.rk,{auto:!0},void 0,(0,o.A)(Q.Tm,{auto:!0},void 0,(0,o.A)("h3",{},void 0,this.props.header)))),m().createElement(oe,(0,Z.A)({isLoading:this.state.isLoading,loadMore:this.loadMore},this.props)))}}]),i}(m().Component);function oe(e){return e.posts.isLoaded&&!e.posts.results.length?(0,o.A)("p",{className:"lead"},void 0,e.emptyMessage):(0,o.A)("div",{},void 0,(0,o.A)(ee.A,{isReady:e.posts.isLoaded,posts:e.posts.results,poster:e.profile}),(0,o.A)(re,{isLoading:e.isLoading,loadMore:e.loadMore,next:e.posts.next}))}function re(e){return e.next?(0,o.A)("div",{className:"pager-more"},void 0,(0,o.A)(B.A,{className:"btn btn-default btn-outline",loading:e.isLoading,onClick:e.loadMore},void 0,pgettext("profile load more btn","Show older activity"))):null}var se=function(e){(0,l.A)(i,e);var t,n,a=(t=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}(),function(){var e,a=(0,d.A)(t);if(n){var i=(0,d.A)(this).constructor;e=Reflect.construct(a,arguments,i)}else e=a.apply(this,arguments);return(0,c.A)(this,e)});function i(){return(0,r.A)(this,i),a.apply(this,arguments)}return(0,s.A)(i,[{key:"getClassName",value:function(){return this.props.className?"form-search "+this.props.className:"form-search"}},{key:"render",value:function(){return(0,o.A)("div",{className:this.getClassName()},void 0,(0,o.A)("input",{type:"text",className:"form-control",value:this.props.value,onChange:this.props.onChange,placeholder:this.props.placeholder||pgettext("quick search placeholder","Search...")}),ae||(ae=(0,o.A)("span",{className:"material-icon"},void 0,"search")))}}]),i}(m().Component),ue=n(49954),le=n(97414);var ce=function(e){(0,l.A)(i,e);var t,n,a=(t=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}(),function(){var e,a=(0,d.A)(t);if(n){var i=(0,d.A)(this).constructor;e=Reflect.construct(a,arguments,i)}else e=a.apply(this,arguments);return(0,c.A)(this,e)});function i(e){var t;return(0,r.A)(this,i),t=a.call(this,e),(0,p.A)((0,u.A)(t),"loadMore",function(){t.setState({isBusy:!0}),t.loadUsers(t.state.page+1,t.state.search)}),(0,p.A)((0,u.A)(t),"search",function(e){t.setState({isLoaded:!1,isBusy:!0,search:e.target.value,count:0,more:0,page:1,pages:1}),t.loadUsers(1,e.target.value)}),t.setSpecialProps(),D.A.has(t.PRELOADED_DATA_KEY)?t.initWithPreloadedData(D.A.pop(t.PRELOADED_DATA_KEY)):t.initWithoutPreloadedData(),t}return(0,s.A)(i,[{key:"setSpecialProps",value:function(){this.PRELOADED_DATA_KEY="PROFILE_FOLLOWERS",this.TITLE=pgettext("profile followers title","Followers"),this.API_FILTER="followers"}},{key:"initWithPreloadedData",value:function(e){this.state={isLoaded:!0,isBusy:!1,search:"",count:e.count,more:e.more,page:e.page,pages:e.pages},ne.A.dispatch((0,le.Qv)(e.results))}},{key:"initWithoutPreloadedData",value:function(){this.state={isLoaded:!1,isBusy:!1,search:"",count:0,more:0,page:1,pages:1},this.loadUsers()}},{key:"loadUsers",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,a=this.props.profile.api[this.API_FILTER];T.A.get(a,{search:n,page:t||1},"user-"+this.API_FILTER).then(function(n){1===t?ne.A.dispatch((0,le.Qv)(n.results)):ne.A.dispatch((0,le.BC)(n.results)),e.setState({isLoaded:!0,isBusy:!1,count:n.count,more:n.more,page:n.page,pages:n.pages})},function(e){O.A.apiError(e)})}},{key:"componentDidMount",value:function(){k.A.set({title:this.TITLE,parent:this.props.profile.username})}},{key:"getLabel",value:function(){if(this.state.isLoaded){if(this.state.search){var e=npgettext("profile followers","Found %(users)s user.","Found %(users)s users.",this.state.count);return interpolate(e,{users:this.state.count},!0)}if(this.props.profile.id===this.props.user.id){var t=npgettext("profile followers","You have %(users)s follower.","You have %(users)s followers.",this.state.count);return interpolate(t,{users:this.state.count},!0)}var n=npgettext("profile followers","%(username)s has %(users)s follower.","%(username)s has %(users)s followers.",this.state.count);return interpolate(n,{username:this.props.profile.username,users:this.state.count},!0)}return pgettext("Loading...")}},{key:"getEmptyMessage",value:function(){return this.state.search?pgettext("profile followers","Search returned no users matching specified criteria."):this.props.user.id===this.props.profile.id?pgettext("profile followers","You have no followers."):interpolate(pgettext("profile followers","%(username)s has no followers."),{username:this.props.profile.username},!0)}},{key:"getMoreButton",value:function(){return this.state.more?(0,o.A)("div",{className:"pager-more"},void 0,(0,o.A)(B.A,{className:"btn btn-default btn-outline",loading:this.state.isBusy,onClick:this.loadMore},void 0,interpolate(pgettext("profile followers","Show more (%(more)s)"),{more:this.state.more},!0))):null}},{key:"getListBody",value:function(){return this.state.isLoaded&&0===this.state.count?(0,o.A)("p",{className:"lead"},void 0,this.getEmptyMessage()):(0,o.A)("div",{},void 0,(0,o.A)(ue.A,{cols:3,isReady:this.state.isLoaded,users:this.props.users}),this.getMoreButton())}},{key:"getClassName",value:function(){return"profile-"+this.API_FILTER}},{key:"render",value:function(){return(0,o.A)("div",{className:this.getClassName()},void 0,(0,o.A)(Q.M7,{},void 0,(0,o.A)(Q.rk,{auto:!0},void 0,(0,o.A)(Q.Tm,{auto:!0},void 0,(0,o.A)("h3",{},void 0,this.getLabel()))),(0,o.A)(Q.rk,{},void 0,(0,o.A)(Q.Tm,{},void 0,(0,o.A)(se,{value:this.state.search,onChange:this.search,placeholder:pgettext("profile followers search","Search users...")})))),this.getListBody())}}]),i}(m().Component);var de=function(e){(0,l.A)(i,e);var t,n,a=(t=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}(),function(){var e,a=(0,d.A)(t);if(n){var i=(0,d.A)(this).constructor;e=Reflect.construct(a,arguments,i)}else e=a.apply(this,arguments);return(0,c.A)(this,e)});function i(){return(0,r.A)(this,i),a.apply(this,arguments)}return(0,s.A)(i,[{key:"setSpecialProps",value:function(){this.PRELOADED_DATA_KEY="PROFILE_FOLLOWS",this.TITLE=pgettext("profile follows title","Follows"),this.API_FILTER="follows"}},{key:"getLabel",value:function(){if(this.state.isLoaded){if(this.state.search){var e=npgettext("profile follows","Found %(users)s user.","Found %(users)s users.",this.state.count);return interpolate(e,{users:this.state.count},!0)}if(this.props.profile.id===this.props.user.id){var t=npgettext("profile follows","You are following %(users)s user.","You are following %(users)s users.",this.state.count);return interpolate(t,{users:this.state.count},!0)}var n=npgettext("profile follows","%(username)s is following %(users)s user.","%(username)s is following %(users)s users.",this.state.count);return interpolate(n,{username:this.props.profile.username,users:this.state.count},!0)}return pgettext("profile follows","Loading...")}},{key:"getEmptyMessage",value:function(){return this.state.search?pgettext("profile follows","Search returned no users matching specified criteria."):this.props.user.id===this.props.profile.id?pgettext("profile follows","You are not following any users."):interpolate(pgettext("profile follows","%(username)s is not following any users."),{username:this.props.profile.username},!0)}}]),i}(ce);var pe,he,me=function(e){(0,l.A)(i,e);var t,n,a=(t=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}(),function(){var e,a=(0,d.A)(t);if(n){var i=(0,d.A)(this).constructor;e=Reflect.construct(a,arguments,i)}else e=a.apply(this,arguments);return(0,c.A)(this,e)});function i(){return(0,r.A)(this,i),a.apply(this,arguments)}return(0,s.A)(i,[{key:"getEmptyMessage",value:function(){return this.props.emptyMessage?this.props.emptyMessage:pgettext("username history empty","Your account has no history of name changes.")}},{key:"render",value:function(){return(0,o.A)("div",{className:"username-history ui-ready"},void 0,(0,o.A)("ul",{className:"list-group"},void 0,(0,o.A)("li",{className:"list-group-item empty-message"},void 0,this.getEmptyMessage())))}}]),i}(m().Component),fe=n(30330);var ve=function(e){(0,l.A)(i,e);var t,n,a=(t=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}(),function(){var e,a=(0,d.A)(t);if(n){var i=(0,d.A)(this).constructor;e=Reflect.construct(a,arguments,i)}else e=a.apply(this,arguments);return(0,c.A)(this,e)});function i(){return(0,r.A)(this,i),a.apply(this,arguments)}return(0,s.A)(i,[{key:"renderUserAvatar",value:function(){return this.props.change.changed_by?(0,o.A)("a",{href:this.props.change.changed_by.url,className:"user-avatar-wrapper"},void 0,(0,o.A)(fe.Ay,{user:this.props.change.changed_by,size:"100"})):pe||(pe=(0,o.A)("span",{className:"user-avatar-wrapper"},void 0,(0,o.A)(fe.Ay,{size:"100"})))}},{key:"renderUsername",value:function(){return this.props.change.changed_by?(0,o.A)("a",{href:this.props.change.changed_by.url,className:"item-title"},void 0,this.props.change.changed_by.username):(0,o.A)("span",{className:"item-title"},void 0,this.props.change.changed_by_username)}},{key:"render",value:function(){return(0,o.A)("li",{className:"list-group-item"},this.props.change.id,(0,o.A)("div",{className:"change-avatar"},void 0,this.renderUserAvatar()),(0,o.A)("div",{className:"change-author"},void 0,this.renderUsername()),(0,o.A)("div",{className:"change"},void 0,(0,o.A)("span",{className:"old-username"},void 0,this.props.change.old_username),he||(he=(0,o.A)("span",{className:"material-icon"},void 0,"arrow_forward")),(0,o.A)("span",{className:"new-username"},void 0,this.props.change.new_username)),(0,o.A)("div",{className:"change-date"},void 0,(0,o.A)("abbr",{title:this.props.change.changed_on.format("LLL")},void 0,this.props.change.changed_on.fromNow())))}}]),i}(m().Component);var Ae,ge,ye=function(e){(0,l.A)(i,e);var t,n,a=(t=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}(),function(){var e,a=(0,d.A)(t);if(n){var i=(0,d.A)(this).constructor;e=Reflect.construct(a,arguments,i)}else e=a.apply(this,arguments);return(0,c.A)(this,e)});function i(){return(0,r.A)(this,i),a.apply(this,arguments)}return(0,s.A)(i,[{key:"render",value:function(){return(0,o.A)("div",{className:"username-history ui-ready"},void 0,(0,o.A)("ul",{className:"list-group"},void 0,this.props.changes.map(function(e){return(0,o.A)(ve,{change:e},e.id)})))}}]),i}(m().Component),be=n(33097);var De=function(e){(0,l.A)(i,e);var t,n,a=(t=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}(),function(){var e,a=(0,d.A)(t);if(n){var i=(0,d.A)(this).constructor;e=Reflect.construct(a,arguments,i)}else e=a.apply(this,arguments);return(0,c.A)(this,e)});function i(){return(0,r.A)(this,i),a.apply(this,arguments)}return(0,s.A)(i,[{key:"shouldComponentUpdate",value:function(){return!1}},{key:"getClassName",value:function(){return this.props.hiddenOnMobile?"list-group-item hidden-xs hidden-sm":"list-group-item"}},{key:"render",value:function(){return(0,o.A)("li",{className:this.getClassName()},void 0,Ae||(Ae=(0,o.A)("div",{className:"change-avatar"},void 0,(0,o.A)("span",{className:"user-avatar"},void 0,(0,o.A)(fe.Ay,{size:"100"})))),(0,o.A)("div",{className:"change-author"},void 0,(0,o.A)("span",{className:"ui-preview-text",style:{width:be.W(30,100)+"px"}},void 0,"Â ")),(0,o.A)("div",{className:"change"},void 0,(0,o.A)("span",{className:"ui-preview-text",style:{width:be.W(30,70)+"px"}},void 0,"Â "),ge||(ge=(0,o.A)("span",{className:"material-icon"},void 0,"arrow_forward")),(0,o.A)("span",{className:"ui-preview-text",style:{width:be.W(30,70)+"px"}},void 0,"Â ")),(0,o.A)("div",{className:"change-date"},void 0,(0,o.A)("span",{className:"ui-preview-text",style:{width:be.W(80,140)+"px"}},void 0,"Â ")))}}]),i}(m().Component);var xe,ke=function(e){(0,l.A)(i,e);var t,n,a=(t=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}(),function(){var e,a=(0,d.A)(t);if(n){var i=(0,d.A)(this).constructor;e=Reflect.construct(a,arguments,i)}else e=a.apply(this,arguments);return(0,c.A)(this,e)});function i(){return(0,r.A)(this,i),a.apply(this,arguments)}return(0,s.A)(i,[{key:"shouldComponentUpdate",value:function(){return!1}},{key:"render",value:function(){return(0,o.A)("div",{className:"username-history ui-preview"},void 0,(0,o.A)("ul",{className:"list-group"},void 0,[0,1,2].map(function(e){return(0,o.A)(De,{hiddenOnMobile:e>0},e)})))}}]),i}(m().Component);var _e=function(e){(0,l.A)(i,e);var t,n,a=(t=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}(),function(){var e,a=(0,d.A)(t);if(n){var i=(0,d.A)(this).constructor;e=Reflect.construct(a,arguments,i)}else e=a.apply(this,arguments);return(0,c.A)(this,e)});function i(){return(0,r.A)(this,i),a.apply(this,arguments)}return(0,s.A)(i,[{key:"render",value:function(){return this.props.isLoaded?this.props.changes.length?(0,o.A)(ye,{changes:this.props.changes}):(0,o.A)(me,{emptyMessage:this.props.emptyMessage}):xe||(xe=(0,o.A)(ke,{}))}}]),i}(m().Component),Ne=n(37281);var Ce=function(e){(0,l.A)(i,e);var t,n,a=(t=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}(),function(){var e,a=(0,d.A)(t);if(n){var i=(0,d.A)(this).constructor;e=Reflect.construct(a,arguments,i)}else e=a.apply(this,arguments);return(0,c.A)(this,e)});function i(e){var t;return(0,r.A)(this,i),t=a.call(this,e),(0,p.A)((0,u.A)(t),"loadMore",function(){t.setState({isBusy:!0}),t.loadChanges(t.state.page+1,t.state.search)}),(0,p.A)((0,u.A)(t),"search",function(e){t.setState({isLoaded:!1,isBusy:!0,search:e.target.value,count:0,more:0,page:1,pages:1}),t.loadChanges(1,e.target.value)}),D.A.has("PROFILE_NAME_HISTORY")?t.initWithPreloadedData(D.A.pop("PROFILE_NAME_HISTORY")):t.initWithoutPreloadedData(),t}return(0,s.A)(i,[{key:"initWithPreloadedData",value:function(e){this.state={isLoaded:!0,isBusy:!1,search:"",count:e.count,more:e.more,page:e.page,pages:e.pages},ne.A.dispatch((0,Ne.Qv)(e.results))}},{key:"initWithoutPreloadedData",value:function(){this.state={isLoaded:!1,isBusy:!1,search:"",count:0,more:0,page:1,pages:1},this.loadChanges()}},{key:"loadChanges",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;T.A.get(D.A.get("USERNAME_CHANGES_API"),{user:this.props.profile.id,search:n,page:t||1},"search-username-history").then(function(n){1===t?ne.A.dispatch((0,Ne.Qv)(n.results)):ne.A.dispatch((0,Ne.BC)(n.results)),e.setState({isLoaded:!0,isBusy:!1,count:n.count,more:n.more,page:n.page,pages:n.pages})},function(e){O.A.apiError(e)})}},{key:"componentDidMount",value:function(){k.A.set({title:pgettext("profile username history title","Username history"),parent:this.props.profile.username})}},{key:"getLabel",value:function(){if(this.state.isLoaded){if(this.state.search){var e=npgettext("profile username history","Found %(changes)s username change.","Found %(changes)s username changes.",this.state.count);return interpolate(e,{changes:this.state.count},!0)}if(this.props.profile.id===this.props.user.id){var t=npgettext("profile username history","Your username was changed %(changes)s time.","Your username was changed %(changes)s times.",this.state.count);return interpolate(t,{changes:this.state.count},!0)}var n=npgettext("profile username history","%(username)s's username was changed %(changes)s time.","%(username)s's username was changed %(changes)s times.",this.state.count);return interpolate(n,{username:this.props.profile.username,changes:this.state.count},!0)}return pgettext("profile username history","Loading...")}},{key:"getEmptyMessage",value:function(){return this.state.search?pgettext("profile username history","Search returned no username changes matching specified criteria."):this.props.user.id===this.props.profile.id?pgettext("username history empty","Your account has no history of name changes."):interpolate(pgettext("profile username history","%(username)s's username was never changed."),{username:this.props.profile.username},!0)}},{key:"getMoreButton",value:function(){return this.state.more?(0,o.A)("div",{className:"pager-more"},void 0,(0,o.A)(B.A,{className:"btn btn-default btn-outline",loading:this.state.isBusy,onClick:this.loadMore},void 0,interpolate(pgettext("profile username history","Show older (%(more)s)"),{more:this.state.more},!0))):null}},{key:"render",value:function(){return(0,o.A)("div",{className:"profile-username-history"},void 0,(0,o.A)(Q.M7,{},void 0,(0,o.A)(Q.rk,{auto:!0},void 0,(0,o.A)(Q.Tm,{auto:!0},void 0,(0,o.A)("h3",{},void 0,this.getLabel()))),(0,o.A)(Q.rk,{},void 0,(0,o.A)(Q.Tm,{},void 0,(0,o.A)(se,{value:this.state.search,onChange:this.search,placeholder:pgettext("profile username history search input","Search history...")})))),(0,o.A)(_e,{isLoaded:this.state.isLoaded,emptyMessage:this.getEmptyMessage(),changes:this.props["username-history"]}),this.getMoreButton())}}]),i}(m().Component),Ee=n(85057),we=n(95271),Fe=n(48995),Re=n(22107),Se=n(8041);var Be,Le=function(e){(0,l.A)(i,e);var t,n,a=(t=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}(),function(){var e,a=(0,d.A)(t);if(n){var i=(0,d.A)(this).constructor;e=Reflect.construct(a,arguments,i)}else e=a.apply(this,arguments);return(0,c.A)(this,e)});function i(e){var t;return(0,r.A)(this,i),t=a.call(this,e),(0,p.A)((0,u.A)(t),"action",function(){t.setState({isLoading:!0}),t.props.profile.is_followed?ne.A.dispatch((0,we.F6)({is_followed:!1,followers:t.props.profile.followers-1})):ne.A.dispatch((0,we.F6)({is_followed:!0,followers:t.props.profile.followers+1})),T.A.post(t.props.profile.api.follow).then(function(e){t.setState({isLoading:!1}),ne.A.dispatch((0,we.F6)(e))},function(e){t.setState({isLoading:!1}),O.A.apiError(e)})}),t.state={isLoading:!1},t}return(0,s.A)(i,[{key:"getClassName",value:function(){return this.props.profile.is_followed?this.props.className+" btn-default btn-following":this.props.className+" btn-default btn-follow"}},{key:"getIcon",value:function(){return this.props.profile.is_followed?"favorite":"favorite_border"}},{key:"getLabel",value:function(){return this.props.profile.is_followed?pgettext("user profile follow btn","Following"):pgettext("user profile follow btn","Follow")}},{key:"render",value:function(){return(0,o.A)(B.A,{className:this.getClassName(),disabled:this.state.isLoading,onClick:this.action},void 0,(0,o.A)("span",{className:"material-icon"},void 0,this.getIcon()),this.getLabel())}}]),i}(m().Component),Te=n(9801);var Oe,Pe,Ie=function(e){(0,l.A)(i,e);var t,n,a=(t=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}(),function(){var e,a=(0,d.A)(t);if(n){var i=(0,d.A)(this).constructor;e=Reflect.construct(a,arguments,i)}else e=a.apply(this,arguments);return(0,c.A)(this,e)});function i(){var e;(0,r.A)(this,i);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return e=a.call.apply(a,[this].concat(n)),(0,p.A)((0,u.A)(e),"onClick",function(){Te.A.open({mode:"START_PRIVATE",submit:D.A.get("PRIVATE_THREADS_API"),to:[e.props.profile]})}),e}return(0,s.A)(i,[{key:"render",value:function(){var e=this.props.user.acl.can_start_private_threads,t=this.props.user.id===this.props.profile.id;return!e||t?null:(0,o.A)("button",{className:this.props.className,onClick:this.onClick,type:"button"},void 0,Be||(Be=(0,o.A)("span",{className:"material-icon"},void 0,"comment")),pgettext("profile message btn","Message"))}}]),i}(m().Component),qe=n(27860),Ue=n(73639),je=n(33864);var Me,ze,He=function(e){(0,l.A)(i,e);var t,n,a=(t=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}(),function(){var e,a=(0,d.A)(t);if(n){var i=(0,d.A)(this).constructor;e=Reflect.construct(a,arguments,i)}else e=a.apply(this,arguments);return(0,c.A)(this,e)});function i(e){var t;return(0,r.A)(this,i),(t=a.call(this,e)).state={isLoaded:!1,isLoading:!1,error:null,is_avatar_locked:"",avatar_lock_user_message:"",avatar_lock_staff_message:""},t}return(0,s.A)(i,[{key:"componentDidMount",value:function(){var e=this;T.A.get(this.props.profile.api.moderate_avatar).then(function(t){e.setState({isLoaded:!0,is_avatar_locked:t.is_avatar_locked,avatar_lock_user_message:t.avatar_lock_user_message||"",avatar_lock_staff_message:t.avatar_lock_staff_message||""})},function(t){e.setState({isLoaded:!0,error:t.detail})})}},{key:"clean",value:function(){return!!this.isValid()||(O.A.error(this.validate().username[0]),!1)}},{key:"send",value:function(){return T.A.post(this.props.profile.api.moderate_avatar,{is_avatar_locked:this.state.is_avatar_locked,avatar_lock_user_message:this.state.avatar_lock_user_message,avatar_lock_staff_message:this.state.avatar_lock_staff_message})}},{key:"handleSuccess",value:function(e){ne.A.dispatch((0,le.xG)(this.props.profile,e.avatar_hash)),O.A.success(pgettext("profile avatar moderation","Avatar controls have been changed."))}},{key:"getFormBody",value:function(){return(0,o.A)("form",{onSubmit:this.handleSubmit},void 0,(0,o.A)("div",{className:"modal-body"},void 0,(0,o.A)(R.A,{label:pgettext("profile avatar moderation field","Lock avatar"),helpText:pgettext("profile avatar moderation field","Locking user avatar will prohibit user from changing his avatar and will reset his/her avatar to default one."),for:"id_is_avatar_locked"},void 0,(0,o.A)(Ue.A,{id:"id_is_avatar_locked",disabled:this.state.isLoading,iconOn:"lock_outline",iconOff:"lock_open",labelOn:pgettext("profile avatar moderation field","Disallow user from changing avatar"),labelOff:pgettext("profile avatar moderation field","Allow user to change avatar"),onChange:this.bindInput("is_avatar_locked"),value:this.state.is_avatar_locked})),(0,o.A)(R.A,{label:pgettext("profile avatar moderation field","User message"),helpText:pgettext("profile avatar moderation field","Optional message for user explaining why they are prohibited from changing their avatar."),for:"id_avatar_lock_user_message"},void 0,(0,o.A)("textarea",{id:"id_avatar_lock_user_message",className:"form-control",rows:"4",disabled:this.state.isLoading,onChange:this.bindInput("avatar_lock_user_message"),value:this.state.avatar_lock_user_message})),(0,o.A)(R.A,{label:pgettext("profile avatar moderation field","Staff message"),helpText:pgettext("profile avatar moderation field","Optional message for forum team members explaining why the user is prohibited form changing their avatar."),for:"id_avatar_lock_staff_message"},void 0,(0,o.A)("textarea",{id:"id_avatar_lock_staff_message",className:"form-control",rows:"4",disabled:this.state.isLoading,onChange:this.bindInput("avatar_lock_staff_message"),value:this.state.avatar_lock_staff_message}))),(0,o.A)("div",{className:"modal-footer"},void 0,(0,o.A)("button",{type:"button",className:"btn btn-default","data-dismiss":"modal"},void 0,pgettext("profile avatar moderation btn","Close")),(0,o.A)(B.A,{className:"btn-primary",loading:this.state.isLoading},void 0,pgettext("profile avatar moderation btn","Save changes"))))}},{key:"getModalBody",value:function(){return this.state.error?(0,o.A)(je.A,{icon:"remove_circle_outline",message:this.state.error}):this.state.isLoaded?this.getFormBody():Oe||(Oe=(0,o.A)(qe.A,{}))}},{key:"getClassName",value:function(){return this.state.error?"modal-dialog modal-message modal-avatar-controls":"modal-dialog modal-avatar-controls"}},{key:"render",value:function(){return(0,o.A)("div",{className:this.getClassName(),role:"document"},void 0,(0,o.A)("div",{className:"modal-content"},void 0,(0,o.A)("div",{className:"modal-header"},void 0,(0,o.A)("button",{type:"button",className:"close","data-dismiss":"modal","aria-label":pgettext("modal","Close")},void 0,Pe||(Pe=(0,o.A)("span",{"aria-hidden":"true"},void 0,"Ã—"))),(0,o.A)("h4",{className:"modal-title"},void 0,pgettext("profile avatar moderation title","Avatar controls"))),this.getModalBody()))}}]),i}(L.A),Ve=n(89077);var Ye,We,Ge,Qe=function(e){(0,l.A)(i,e);var t,n,a=(t=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}(),function(){var e,a=(0,d.A)(t);if(n){var i=(0,d.A)(this).constructor;e=Reflect.construct(a,arguments,i)}else e=a.apply(this,arguments);return(0,c.A)(this,e)});function i(e){var t;return(0,r.A)(this,i),(t=a.call(this,e)).state={isLoaded:!1,isLoading:!1,error:null,username:"",validators:{username:[Ve.KP()]}},t}return(0,s.A)(i,[{key:"componentDidMount",value:function(){var e=this;T.A.get(this.props.profile.api.moderate_username).then(function(){e.setState({isLoaded:!0})},function(t){e.setState({isLoaded:!0,error:t.detail})})}},{key:"clean",value:function(){return!!this.isValid()||(O.A.error(this.validate().username[0]),!1)}},{key:"send",value:function(){return T.A.post(this.props.profile.api.moderate_username,{username:this.state.username})}},{key:"handleSuccess",value:function(e){this.setState({username:""}),ne.A.dispatch((0,Ne.ry)(e,this.props.profile,this.props.user)),ne.A.dispatch((0,le.kZ)(this.props.profile,e.username,e.slug)),O.A.success(pgettext("profile username moderation","Username has been changed."))}},{key:"getFormBody",value:function(){return(0,o.A)("form",{onSubmit:this.handleSubmit},void 0,(0,o.A)("div",{className:"modal-body"},void 0,(0,o.A)(R.A,{label:pgettext("profile username moderation field","New username"),for:"id_username"},void 0,(0,o.A)("input",{type:"text",id:"id_username",className:"form-control",disabled:this.state.isLoading,onChange:this.bindInput("username"),value:this.state.username}))),(0,o.A)("div",{className:"modal-footer"},void 0,(0,o.A)("button",{className:"btn btn-default","data-dismiss":"modal",disabled:this.state.isLoading,type:"button"},void 0,pgettext("profile username moderation btn","Cancel")),(0,o.A)(B.A,{className:"btn-primary",loading:this.state.isLoading},void 0,pgettext("profile username moderation btn","Change username"))))}},{key:"getModalBody",value:function(){return this.state.error?(0,o.A)(je.A,{icon:"remove_circle_outline",message:this.state.error}):this.state.isLoaded?this.getFormBody():Me||(Me=(0,o.A)(qe.A,{}))}},{key:"getClassName",value:function(){return this.state.error?"modal-dialog modal-message modal-rename-user":"modal-dialog modal-rename-user"}},{key:"render",value:function(){return(0,o.A)("div",{className:this.getClassName(),role:"document"},void 0,(0,o.A)("div",{className:"modal-content"},void 0,(0,o.A)("div",{className:"modal-header"},void 0,(0,o.A)("button",{type:"button",className:"close","data-dismiss":"modal","aria-label":pgettext("modal","Close")},void 0,ze||(ze=(0,o.A)("span",{"aria-hidden":"true"},void 0,"Ã—"))),(0,o.A)("h4",{className:"modal-title"},void 0,pgettext("profile username moderation title","Change username"))),this.getModalBody()))}}]),i}(L.A);var Ke,Xe,Je,$e=function(e){(0,l.A)(i,e);var t,n,a=(t=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}(),function(){var e,a=(0,d.A)(t);if(n){var i=(0,d.A)(this).constructor;e=Reflect.construct(a,arguments,i)}else e=a.apply(this,arguments);return(0,c.A)(this,e)});function i(e){var t;return(0,r.A)(this,i),t=a.call(this,e),(0,p.A)((0,u.A)(t),"countdown",function(){window.setTimeout(function(){t.state.countdown>1?(t.setState({countdown:t.state.countdown-1}),t.countdown()):t.state.confirm||t.setState({confirm:!0})},1e3)}),t.state={isLoaded:!1,isLoading:!1,isDeleted:!1,error:null,countdown:5,confirm:!1,with_content:!1},t}return(0,s.A)(i,[{key:"componentDidMount",value:function(){var e=this;T.A.get(this.props.profile.api.delete).then(function(){e.setState({isLoaded:!0}),e.countdown()},function(t){e.setState({isLoaded:!0,error:t.detail})})}},{key:"send",value:function(){return T.A.post(this.props.profile.api.delete,{with_content:this.state.with_content})}},{key:"handleSuccess",value:function(){x.A.stop("user-profile"),this.state.with_content?this.setState({isDeleted:interpolate(pgettext("profile delete","%(username)s's account, threads, posts and other content has been deleted."),{username:this.props.profile.username},!0)}):this.setState({isDeleted:interpolate(pgettext("profile delete","%(username)s's account has been deleted and other content has been hidden."),{username:this.props.profile.username},!0)})}},{key:"getButtonLabel",value:function(){return this.state.confirm?interpolate(pgettext("profile delete btn","Delete %(username)s"),{username:this.props.profile.username},!0):interpolate(pgettext("profile delete btn","Please wait... (%(countdown)ss)"),{countdown:this.state.countdown},!0)}},{key:"getForm",value:function(){return(0,o.A)("form",{onSubmit:this.handleSubmit},void 0,(0,o.A)("div",{className:"modal-body"},void 0,(0,o.A)(R.A,{label:pgettext("profile delete","User content"),for:"id_with_content"},void 0,(0,o.A)(Ue.A,{id:"id_with_content",disabled:this.state.isLoading,labelOn:pgettext("profile delete content","Delete together with user's account"),labelOff:pgettext("profile delete content","Hide after deleting user's account"),onChange:this.bindInput("with_content"),value:this.state.with_content}))),(0,o.A)("div",{className:"modal-footer"},void 0,(0,o.A)("button",{type:"button",className:"btn btn-default","data-dismiss":"modal"},void 0,pgettext("profile delete btn","Cancel")),(0,o.A)(B.A,{className:"btn-danger",loading:this.state.isLoading,disabled:!this.state.confirm},void 0,this.getButtonLabel())))}},{key:"getDeletedBody",value:function(){return(0,o.A)("div",{className:"modal-body"},void 0,Ye||(Ye=(0,o.A)("div",{className:"message-icon"},void 0,(0,o.A)("span",{className:"material-icon"},void 0,"info_outline"))),(0,o.A)("div",{className:"message-body"},void 0,(0,o.A)("p",{className:"lead"},void 0,this.state.isDeleted),(0,o.A)("p",{},void 0,(0,o.A)("a",{href:D.A.get("USERS_LIST_URL")},void 0,pgettext("profile delete link","Return to users list")))))}},{key:"getModalBody",value:function(){return this.state.error?(0,o.A)(je.A,{icon:"remove_circle_outline",message:this.state.error}):this.state.isLoaded?this.state.isDeleted?this.getDeletedBody():this.getForm():We||(We=(0,o.A)(qe.A,{}))}},{key:"getClassName",value:function(){return this.state.error||this.state.isDeleted?"modal-dialog modal-message modal-delete-account":"modal-dialog modal-delete-account"}},{key:"render",value:function(){return(0,o.A)("div",{className:this.getClassName(),role:"document"},void 0,(0,o.A)("div",{className:"modal-content"},void 0,(0,o.A)("div",{className:"modal-header"},void 0,(0,o.A)("button",{type:"button",className:"close","data-dismiss":"modal","aria-label":pgettext("modal","Close")},void 0,Ge||(Ge=(0,o.A)("span",{"aria-hidden":"true"},void 0,"Ã—"))),(0,o.A)("h4",{className:"modal-title"},void 0,pgettext("profile delete title","Delete user account"))),this.getModalBody()))}}]),i}(L.A),Ze=n(70490);var et=function(e){return{tick:e.tick,user:e.auth,profile:e.profile}},tt=function(e){(0,l.A)(h,e);var t,n,a=(t=h,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}(),function(){var e,a=(0,d.A)(t);if(n){var i=(0,d.A)(this).constructor;e=Reflect.construct(a,arguments,i)}else e=a.apply(this,arguments);return(0,c.A)(this,e)});function h(){var e;(0,r.A)(this,h);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return e=a.call.apply(a,[this].concat(n)),(0,p.A)((0,u.A)(e),"showAvatarDialog",function(){Ze.A.show((0,i.Ng)(et)(He))}),(0,p.A)((0,u.A)(e),"showRenameDialog",function(){Ze.A.show((0,i.Ng)(et)(Qe))}),(0,p.A)((0,u.A)(e),"showDeleteDialog",function(){Ze.A.show((0,i.Ng)(et)($e))}),e}return(0,s.A)(h,[{key:"render",value:function(){var e=this.props.moderation;return(0,o.A)("ul",{className:"dropdown-menu dropdown-menu-right",role:"menu"},void 0,!!e.avatar&&(0,o.A)("li",{},void 0,(0,o.A)("button",{type:"button",className:"btn btn-link",onClick:this.showAvatarDialog},void 0,Ke||(Ke=(0,o.A)("span",{className:"material-icon"},void 0,"portrait")),pgettext("profile moderation menu","Avatar controls"))),!!e.rename&&(0,o.A)("li",{},void 0,(0,o.A)("button",{type:"button",className:"btn btn-link",onClick:this.showRenameDialog},void 0,Xe||(Xe=(0,o.A)("span",{className:"material-icon"},void 0,"credit_card")),pgettext("profile moderation menu","Change username"))),!!e.delete&&(0,o.A)("li",{},void 0,(0,o.A)("button",{type:"button",className:"btn btn-link",onClick:this.showDeleteDialog},void 0,Je||(Je=(0,o.A)("span",{className:"material-icon"},void 0,"clear")),pgettext("profile moderation menu","Delete account"))))}}]),h}(m().Component),nt=n(41467);const at=function(e){var t=e.profile;return(0,o.A)("ul",{className:"profile-data-list"},void 0,!1===t.is_active&&(0,o.A)("li",{className:"user-account-disabled"},void 0,(0,o.A)("abbr",{title:pgettext("profile data list","This user's account has been disabled by administrator.")},void 0,pgettext("profile data list","Account disabled"))),(0,o.A)("li",{className:"user-status-display"},void 0,(0,o.A)(nt.Ay,{user:t,status:t.status},void 0,(0,o.A)(nt.kW,{user:t,status:t.status}),(0,o.A)(nt.VX,{user:t,status:t.status,className:"status-label"}))),t.rank.is_tab?(0,o.A)("li",{className:"user-rank"},void 0,(0,o.A)("a",{href:t.rank.url,className:"item-title"},void 0,t.rank.name)):(0,o.A)("li",{className:"user-rank"},void 0,(0,o.A)("span",{className:"item-title"},void 0,t.rank.name)),(t.title||t.rank.title)&&(0,o.A)("li",{className:"user-title"},void 0,t.title||t.rank.title),(0,o.A)("li",{className:"user-joined-on"},void 0,(0,o.A)("abbr",{title:interpolate(pgettext("profile data list","Joined on %(joined_on)s"),{joined_on:t.joined_on.format("LL, LT")},!0)},void 0,interpolate(pgettext("profile data list","Joined %(joined_on)s"),{joined_on:t.joined_on.fromNow()},!0))),t.email&&(0,o.A)("li",{className:"user-email"},void 0,(0,o.A)("a",{href:"mailto:"+t.email,className:"item-title"},void 0,t.email)))};var it,ot,rt,st,ut,lt=function(){return(0,o.A)("button",{className:"btn btn-default btn-icon btn-outline dropdown-toggle",type:"button",title:pgettext("profile options btn","Options"),"data-toggle":"dropdown","aria-haspopup":"true","aria-expanded":"false"},void 0,ut||(ut=(0,o.A)("span",{className:"material-icon"},void 0,"settings")))};const ct=function(e){var t=e.profile,n=e.user,a=e.moderation,i=e.message,r=e.follow;return(0,o.A)(Se.ud,{},void 0,(0,o.A)(Se.zY,{styleName:t.rank.css_class?"rank-"+t.rank.css_class:"profile"},void 0,(0,o.A)(Se.d4,{styleName:t.rank.css_class?"rank-"+t.rank.css_class:"profile"},void 0,(0,o.A)("div",{className:"profile-page-header"},void 0,(0,o.A)("div",{className:"profile-page-header-avatar"},void 0,(0,o.A)(fe.Ay,{className:"user-avatar hidden-sm hidden-md hidden-lg",user:t,size:200,size2x:400}),(0,o.A)(fe.Ay,{className:"user-avatar hidden-xs hidden-md hidden-lg",user:t,size:64,size2x:128}),(0,o.A)(fe.Ay,{className:"user-avatar hidden-xs hidden-sm",user:t,size:128,size2x:256})),(0,o.A)("h1",{},void 0,t.username))),(0,o.A)(Se.Le,{className:"profile-page-header-details"},void 0,(0,o.A)(Re.Ye,{},void 0,(0,o.A)(Re.P3,{auto:!0},void 0,(0,o.A)(Re.MT,{},void 0,(0,o.A)(at,{profile:t}))),i&&(0,o.A)(Re.P3,{},void 0,(0,o.A)(Re.MT,{},void 0,(0,o.A)(Ie,{className:"btn btn-default btn-block btn-outline",profile:t,user:n})),a.available&&!r&&(0,o.A)(Re.MT,{shrink:!0},void 0,(0,o.A)("div",{className:"dropdown"},void 0,it||(it=(0,o.A)(lt,{})),(0,o.A)(tt,{profile:t,moderation:a})))),r&&(0,o.A)(Re.P3,{},void 0,(0,o.A)(Re.MT,{},void 0,(0,o.A)(Le,{className:"btn btn-block btn-outline",profile:t})),a.available&&(0,o.A)(Re.MT,{shrink:!0},void 0,(0,o.A)("div",{className:"dropdown"},void 0,ot||(ot=(0,o.A)(lt,{})),(0,o.A)(tt,{profile:t,moderation:a})))),a.available&&!r&&!i&&(0,o.A)(Re.P3,{},void 0,(0,o.A)(Re.MT,{className:"hidden-xs",shrink:!0},void 0,(0,o.A)("div",{className:"dropdown"},void 0,rt||(rt=(0,o.A)(lt,{})),(0,o.A)(tt,{profile:t,moderation:a}))),(0,o.A)(Re.MT,{className:"hidden-sm hidden-md hidden-lg"},void 0,(0,o.A)("div",{className:"dropdown"},void 0,(0,o.A)("button",{className:"btn btn-default btn-block btn-outline dropdown-toggle",type:"button","data-toggle":"dropdown","aria-haspopup":"true","aria-expanded":"false"},void 0,st||(st=(0,o.A)("span",{className:"material-icon"},void 0,"settings")),pgettext("profile options btn","Options")),(0,o.A)(tt,{profile:t,moderation:a}))))))))};var dt=n(28542),pt=n(92324);const ht=function(e){var t=e.baseUrl,n=e.page,a=e.pages;return(0,o.A)("div",{className:"nav-container"},void 0,(0,o.A)("div",{className:"dropdown hidden-sm hidden-md hidden-lg"},void 0,(0,o.A)("button",{className:"btn btn-default btn-block btn-outline dropdown-toggle",type:"button","data-toggle":"dropdown","aria-haspopup":"true","aria-expanded":"false"},void 0,(0,o.A)("span",{className:"material-icon"},void 0,n.icon),n.name),(0,o.A)("ul",{className:"dropdown-menu stick-to-bottom"},void 0,a.map(function(e){return(0,o.A)("li",{},e.component,(0,o.A)(dt.N_,{to:t+e.component+"/"},void 0,(0,o.A)("span",{className:"material-icon"},void 0,e.icon),e.name))}))),(0,o.A)("ul",{className:"nav nav-pills hidden-xs",role:"menu"},void 0,a.map(function(e){return(0,o.A)(pt.A,{path:t+e.component+"/"},e.component,(0,o.A)(dt.N_,{to:t+e.component+"/"},void 0,(0,o.A)("span",{className:"material-icon"},void 0,e.icon),e.name))})))};var mt=function(e){(0,l.A)(i,e);var t,n,a=(t=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}(),function(){var e,a=(0,d.A)(t);if(n){var i=(0,d.A)(this).constructor;e=Reflect.construct(a,arguments,i)}else e=a.apply(this,arguments);return(0,c.A)(this,e)});function i(e){var t;return(0,r.A)(this,i),t=a.call(this,e),(0,p.A)((0,u.A)(t),"update",function(e){ne.A.dispatch((0,we.Qv)(e))}),t.startPolling(e.profile.api.index),t}return(0,s.A)(i,[{key:"startPolling",value:function(e){x.A.start({poll:"user-profile",url:e,frequency:9e4,update:this.update})}},{key:"render",value:function(){var e=this,t=D.A.get("PROFILE").url,n=D.A.get("PROFILE_PAGES"),a=n.filter(function(n){var a=t+n.component+"/";return e.props.location.pathname===a})[0],i=this.props,r=i.profile,s=i.user,u=ft(r,s),l=!!s.acl.can_start_private_threads&&r.id!==s.id,c=!!r.acl.can_follow&&r.id!==s.id;return(0,o.A)("div",{className:"page page-user-profile"},void 0,(0,o.A)(ct,{profile:this.props.profile,user:this.props.user,moderation:u,message:l,follow:c}),(0,o.A)(Fe.A,{},void 0,(0,o.A)(ht,{baseUrl:t,page:a,pages:n}),this.props.children))}}]),i}(Ee.A),ft=function(e,t){var n={available:!1,rename:!1,avatar:!1,delete:!1};return t.is_anonymous||(n.rename=e.acl.can_rename,n.avatar=e.acl.can_moderate_avatar,n.delete=e.acl.can_delete,n.available=!!(n.rename||n.avatar||n.delete)),n};function vt(e){return{isAuthenticated:e.auth.user.id===e.profile.id,tick:e.tick.tick,user:e.auth.user,users:e.users,posts:e.posts,profile:e.profile,profileDetails:e["profile-details"],"username-history":e["username-history"]}}var At={posts:function(e){var t;t=e.user.id===e.profile.id?pgettext("profile posts","You have posted no messages."):interpolate(pgettext("profile posts","%(username)s posted no messages."),{username:e.profile.username},!0);var n=null;if(e.posts.isLoaded)if(e.profile.id===e.user.id){var a=npgettext("profile posts","You have posted %(posts)s message.","You have posted %(posts)s messages.",e.profile.posts);n=interpolate(a,{posts:e.profile.posts},!0)}else{var i=npgettext("profile posts","%(username)s has posted %(posts)s message.","%(username)s has posted %(posts)s messages.",e.profile.posts);n=interpolate(i,{username:e.profile.username,posts:e.profile.posts},!0)}else n=pgettext("profile posts","Loading...");return m().createElement(ie,(0,Z.A)({api:e.profile.api.posts,emptyMessage:t,header:n,title:pgettext("profile posts title","Posts")},e))},threads:function(e){var t;t=e.user.id===e.profile.id?pgettext("profile threads","You haven't started any threads."):interpolate(pgettext("profile threads","%(username)s hasn't started any threads"),{username:e.profile.username},!0);var n=null;if(e.posts.isLoaded)if(e.profile.id===e.user.id){var a=npgettext("profile threads","You have started %(threads)s thread.","You have started %(threads)s threads.",e.profile.threads);n=interpolate(a,{threads:e.profile.threads},!0)}else{var i=npgettext("profile threads","%(username)s has started %(threads)s thread.","%(username)s has started %(threads)s threads.",e.profile.threads);n=interpolate(i,{username:e.profile.username,threads:e.profile.threads},!0)}else n=pgettext("profile threads","Loading...");return m().createElement(ie,(0,Z.A)({api:e.profile.api.threads,emptyMessage:t,header:n,title:pgettext("profile threads title","Threads")},e))},followers:ce,follows:de,details:$,"username-history":Ce,"ban-details":N};function gt(){var e=[];return D.A.get("PROFILE_PAGES").forEach(function(t){e.push(Object.assign({},t,{path:D.A.get("PROFILE").url+t.component+"/",component:(0,i.Ng)(vt)(At[t.component])}))}),e}var yt=n(88095);D.A.addInitializer({name:"component:profile",initializer:function(e){e.has("PROFILE")&&e.has("PROFILE_PAGES")&&(0,yt.A)({root:D.A.get("PROFILE").url,component:(0,i.Ng)(vt)(mt),paths:gt()})},after:"reducer:profile-hydrate"})},55972:(e,t,n)=>{"use strict";var a,i=n(73620),o=n(40927),r=n.n(o),s=n(40961),u=n.n(s),l=n(67467),c=n(23029),d=n(92901),p=n(9417),h=n(15361),m=n(61801),f=n(53954),v=n(64467),A=n(61092),g=n(93420),y=n(32485),b=n.n(y),D=n(25913),x=n(64015);function k(e){var t=e.children,n=e.open,a=e.showAll,o=e.showUnread,r=e.unread;return(0,i.A)(x.h,{open:n},void 0,(0,i.A)(x.e,{},void 0,pgettext("notifications title","Notifications")),(0,i.A)(D.Qb,{},void 0,(0,i.A)(_,{active:!r,onClick:a},void 0,pgettext("notifications dropdown","All")),(0,i.A)(_,{active:r,onClick:o},void 0,pgettext("notifications dropdown","Unread"))),t,(0,i.A)(D.Xy,{},void 0,(0,i.A)("a",{className:"btn btn-default btn-block",href:misago.get("NOTIFICATIONS_URL")},void 0,pgettext("notifications","See all notifications"))))}function _(e){var t=e.active,n=e.children,a=e.onClick;return(0,i.A)("button",{className:b()("btn",{"btn-primary":t,"btn-default":!t}),type:"button",onClick:a},void 0,n)}var N=function(e){(0,h.A)(r,e);var t,n,o=(t=r,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}(),function(){var e,a=(0,f.A)(t);if(n){var i=(0,f.A)(this).constructor;e=Reflect.construct(a,arguments,i)}else e=a.apply(this,arguments);return(0,m.A)(this,e)});function r(e){var t;return(0,c.A)(this,r),t=o.call(this,e),(0,v.A)((0,p.A)(t),"render",function(){return(0,i.A)(k,{open:t.props.open,unread:t.state.unread,showAll:function(){return t.setState({unread:!1})},showUnread:function(){return t.setState({unread:!0})}},void 0,(0,i.A)(A.A,{filter:t.state.unread?"unread":"all",disabled:!t.props.open},void 0,function(e){var n=e.data,o=e.loading,r=e.error;return o?a||(a=(0,i.A)(g.BG,{})):r?(0,i.A)(g.n8,{error:r}):(0,i.A)(g.$y,{filter:t.state.unread?"unread":"all",items:n?n.results:[]})}))}),t.body=document.body,t.state={unread:!1,url:""},t}return(0,d.A)(r,[{key:"getApiUrl",value:function(){return misago.get("NOTIFICATIONS_API")+"?limit=20"+(this.state.unread?"&filter=unread":"")}},{key:"componentDidUpdate",value:function(e,t){e.open!==this.props.open&&(this.props.open?this.body.classList.add("notifications-fullscreen"):this.body.classList.remove("notifications-fullscreen"))}}]),r}(r().Component);const C=(0,l.Ng)(function(e){return{open:e.overlay.notifications}})(N);var E,w=n(52762);misago.addInitializer({name:"component:notifications-overlay",initializer:function(e){if(e.get("isAuthenticated")){var t=document.getElementById("notifications-mount");u().render((0,i.A)(l.Kq,{store:w.A.getStore()},void 0,E||(E=(0,i.A)(C,{}))),t)}},after:"store"})},56840:(e,t,n)=>{"use strict";var a=n(73971),i=n(92069),o=n(9801),r=n(29904);a.A.addInitializer({name:"posting",initializer:function(){o.A.init(i.A,r.A,document.getElementById("posting-mount"))}})},60319:(e,t,n)=>{"use strict";var a=n(73971),i=n(29904),o=n(52762);a.A.addInitializer({name:"snackbar",initializer:function(){i.A.init(o.A)},after:"store"})},61092:(e,t,n)=>{"use strict";n.d(t,{A:()=>a});const a=n(81002).A},61516:(e,t,n)=>{"use strict";var a=n(67467),i=n(73971),o=n(73620),r=n(23029),s=n(92901),u=n(15361),l=n(61801),c=n(53954),d=n(40927);var p=function(e){(0,u.A)(i,e);var t,n,a=(t=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}(),function(){var e,a=(0,c.A)(t);if(n){var i=(0,c.A)(this).constructor;e=Reflect.construct(a,arguments,i)}else e=a.apply(this,arguments);return(0,l.A)(this,e)});function i(){return(0,r.A)(this,i),a.apply(this,arguments)}return(0,s.A)(i,[{key:"refresh",value:function(){window.location.reload()}},{key:"getMessage",value:function(){return this.props.signedIn?interpolate(pgettext("auth message","You have signed in as %(username)s. Please refresh the page before continuing."),{username:this.props.signedIn.username},!0):this.props.signedOut?interpolate(pgettext("auth message","%(username)s, you have been signed out. Please refresh the page before continuing."),{username:this.props.user.username},!0):void 0}},{key:"render",value:function(){var e="auth-message";return(this.props.signedIn||this.props.signedOut)&&(e+=" show"),(0,o.A)("div",{className:e},void 0,(0,o.A)("div",{className:"container"},void 0,(0,o.A)("p",{className:"lead"},void 0,this.getMessage()),(0,o.A)("p",{},void 0,(0,o.A)("button",{className:"btn btn-default",type:"button",onClick:this.refresh},void 0,pgettext("auth message","Reload page")),(0,o.A)("span",{className:"hidden-xs hidden-sm"},void 0," "+pgettext("auth message","or press F5 key.")))))}}]),i}(n.n(d)().Component);function h(e){return{user:e.auth.user,signedIn:e.auth.signedIn,signedOut:e.auth.signedOut}}var m=n(92979);i.A.addInitializer({name:"component:auth-message",initializer:function(){(0,m.A)((0,a.Ng)(h)(p),"auth-message-mount")},after:"store"})},62077:(e,t,n)=>{"use strict";var a,i,o=n(73971),r=n(9417),s=n(64467),u=n(73620),l=n(23029),c=n(92901),d=n(15361),p=n(61801),h=n(53954),m=n(40927),f=n.n(m),v=n(40961),A=n.n(v),g=n(39227),y=n(849),b=n(92069),D=n(29904),x=n(89077),k=n(74017);function _(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,a=(0,h.A)(e);if(t){var i=(0,h.A)(this).constructor;n=Reflect.construct(a,arguments,i)}else n=a.apply(this,arguments);return(0,p.A)(this,n)}}var N=function(e){(0,d.A)(n,e);var t=_(n);function n(e){var a;return(0,l.A)(this,n),(a=t.call(this,e)).state={isLoading:!1,email:"",validators:{email:[x.Rp()]}},a}return(0,c.A)(n,[{key:"clean",value:function(){return!!this.isValid()||(D.A.error(pgettext("request password reset form","Enter a valid e-mail address.")),!1)}},{key:"send",value:function(){return b.A.post(o.A.get("SEND_PASSWORD_RESET_API"),{email:this.state.email})}},{key:"handleSuccess",value:function(e){this.props.callback(e)}},{key:"handleError",value:function(e){["inactive_user","inactive_admin"].indexOf(e.code)>-1?this.props.showInactivePage(e):403===e.status&&e.ban?(0,k.A)(e.ban):D.A.apiError(e)}},{key:"render",value:function(){return(0,u.A)("div",{className:"well well-form well-form-request-password-reset"},void 0,(0,u.A)("form",{onSubmit:this.handleSubmit},void 0,(0,u.A)("div",{className:"form-group"},void 0,(0,u.A)("div",{className:"control-input"},void 0,(0,u.A)("input",{type:"text",className:"form-control",placeholder:pgettext("request password reset form field","Your e-mail address"),disabled:this.state.isLoading,onChange:this.bindInput("email"),value:this.state.email}))),(0,u.A)(g.A,{className:"btn-primary btn-block",loading:this.state.isLoading},void 0,pgettext("request password reset form btn","Send link"))))}}]),n}(y.A),C=function(e){(0,d.A)(n,e);var t=_(n);function n(){return(0,l.A)(this,n),t.apply(this,arguments)}return(0,c.A)(n,[{key:"getMessage",value:function(){return interpolate(pgettext("request password reset form","Reset password link was sent to %(email)s"),{email:this.props.user.email},!0)}},{key:"render",value:function(){return(0,u.A)("div",{className:"well well-form well-form-request-password-reset well-done"},void 0,(0,u.A)("div",{className:"done-message"},void 0,a||(a=(0,u.A)("div",{className:"message-icon"},void 0,(0,u.A)("span",{className:"material-icon"},void 0,"check"))),(0,u.A)("div",{className:"message-body"},void 0,(0,u.A)("p",{},void 0,this.getMessage())),(0,u.A)("button",{type:"button",className:"btn btn-primary btn-block",onClick:this.props.callback},void 0,pgettext("request password reset form btn","Request another link"))))}}]),n}(f().Component),E=function(e){(0,d.A)(n,e);var t=_(n);function n(){return(0,l.A)(this,n),t.apply(this,arguments)}return(0,c.A)(n,[{key:"getActivateButton",value:function(){return"inactive_user"===this.props.activation?(0,u.A)("p",{},void 0,(0,u.A)("a",{href:o.A.get("REQUEST_ACTIVATION_URL")},void 0,pgettext("request password reset form error","Activate your account."))):null}},{key:"render",value:function(){return(0,u.A)("div",{className:"page page-message page-message-info page-forgotten-password-inactive"},void 0,(0,u.A)("div",{className:"container"},void 0,(0,u.A)("div",{className:"message-panel"},void 0,i||(i=(0,u.A)("div",{className:"message-icon"},void 0,(0,u.A)("span",{className:"material-icon"},void 0,"info_outline"))),(0,u.A)("div",{className:"message-body"},void 0,(0,u.A)("p",{className:"lead"},void 0,pgettext("request password reset form error","Your account is inactive.")),(0,u.A)("p",{},void 0,this.props.message),this.getActivateButton()))))}}]),n}(f().Component),w=function(e){(0,d.A)(n,e);var t=_(n);function n(e){var a;return(0,l.A)(this,n),a=t.call(this,e),(0,s.A)((0,r.A)(a),"complete",function(e){a.setState({complete:e})}),(0,s.A)((0,r.A)(a),"reset",function(){a.setState({complete:!1})}),a.state={complete:!1},a}return(0,c.A)(n,[{key:"showInactivePage",value:function(e){A().render((0,u.A)(E,{activation:e.code,message:e.detail}),document.getElementById("page-mount"))}},{key:"render",value:function(){return this.state.complete?(0,u.A)(C,{callback:this.reset,user:this.state.complete}):(0,u.A)(N,{callback:this.complete,showInactivePage:this.showInactivePage})}}]),n}(f().Component),F=n(92979);o.A.addInitializer({name:"component:request-password-reset",initializer:function(){document.getElementById("request-password-reset-mount")&&(0,F.A)(w,"request-password-reset-mount",!1)},after:"store"})},63426:(e,t,n)=>{"use strict";n.d(t,{Ay:()=>h,CI:()=>p,F6:()=>c,Jv:()=>d,KK:()=>l,ue:()=>i});var a=n(97414),i={signedIn:!1,signedOut:!1},o="UPDATE_AUTHENTICATED_USER",r="PATCH_USER",s="SIGN_IN",u="SIGN_OUT";function l(e){return{type:o,data:e}}function c(e){return{type:r,patch:e}}function d(e){return{type:s,user:e}}function p(){return{type:u,soft:arguments.length>0&&void 0!==arguments[0]&&arguments[0]}}function h(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:i,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;switch(t.type){case r:var n=Object.assign({},e);return n.user=Object.assign({},e.user,t.patch),n;case o:var l=Object.assign({},e);return l.user=Object.assign({},e.user,t.data),l;case s:return Object.assign({},e,{signedIn:t.user});case u:return Object.assign({},e,{isAuthenticated:!1,isAnonymous:!0,signedOut:!t.soft});case a.ot:if(e.isAuthenticated&&e.user.id===t.userId){var c=Object.assign({},e);return c.user=Object.assign({},e.user,{avatars:t.avatars}),c}return e;case a.xq:if(e.isAuthenticated&&e.user.id===t.userId){var d=Object.assign({},e);return d.user=Object.assign({},e.user,{username:t.username,slug:t.slug}),d}return e;default:return e}}},63677:(e,t,n)=>{"use strict";var a,i=n(73620),o=(n(40927),n(40961)),r=n.n(o),s=n(67467),u=n(39671),l=n(52762);misago.addInitializer({name:"component:user-nav-overlay",initializer:function(e){var t=document.getElementById("user-nav-mount");r().render((0,i.A)(s.Kq,{store:l.A.getStore()},void 0,a||(a=(0,i.A)(u.HF,{}))),t)},after:"store"})},64015:(e,t,n)=>{"use strict";n.d(t,{h:()=>y,e:()=>D});var a=n(73620),i=n(23029),o=n(92901),r=n(9417),s=n(15361),u=n(61801),l=n(53954),c=n(64467),d=n(32485),p=n.n(d),h=n(40927),m=n.n(h),f=n(67467),v=n(22926);var A="has-overlay",g=function(e){(0,s.A)(h,e);var t,n,d=(t=h,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}(),function(){var e,a=(0,l.A)(t);if(n){var i=(0,l.A)(this).constructor;e=Reflect.construct(a,arguments,i)}else e=a.apply(this,arguments);return(0,u.A)(this,e)});function h(e){var t;return(0,i.A)(this,h),t=d.call(this,e),(0,c.A)((0,r.A)(t),"closeOnNavigation",function(e){e.target.closest("a")&&t.props.dispatch((0,v.VN)())}),t.scrollOrigin=null,t}return(0,o.A)(h,[{key:"componentDidUpdate",value:function(e){e.open!==this.props.open&&(this.props.open?(this.scrollOrigin=window.pageYOffset,document.body.classList.add(A),this.props.onOpen&&this.props.onOpen()):(document.body.classList.remove(A),window.scrollTo(0,this.scrollOrigin),this.scrollOrigin=null))}},{key:"render",value:function(){return(0,a.A)("div",{className:p()("overlay",this.props.className,{"overlay-open":this.props.open}),onClick:this.closeOnNavigation},void 0,this.props.children)}}]),h}(m().Component);const y=(0,f.Ng)()(g);var b;const D=(0,f.Ng)()(function(e){var t=e.children,n=e.dispatch;return(0,a.A)("div",{className:"overlay-header"},void 0,(0,a.A)("div",{className:"overlay-header-caption"},void 0,t),(0,a.A)("button",{className:"btn btn-overlay-close",title:pgettext("modal","Close"),type:"button",onClick:function(){return n((0,v.VN)())}},void 0,b||(b=(0,a.A)("span",{className:"material-icon"},void 0,"close"))))})},64508:(e,t,n)=>{"use strict";var a=n(73620),i=n(40927),o=n.n(i),r=n(40961),s=n.n(r),u=n(67467),l=n(28542),c=n(8041);function d(){return(0,a.A)(c.hA,{header:pgettext("notifications title","Notifications"),styleName:"notifications"})}var p=n(58168),h=n(10467),m=n(54756),f=n.n(m),v=n(63426),A=n(29904),g=n(65407),y=n(61092);const b=function(e){var t=e.title,n=e.subtitle,a=[];return n&&a.push(n),t&&a.push(t),a.push(misago.get("SETTINGS").forum_name),document.title=a.join(" | "),null};var D=n(48995),x=n(93420);function k(e){var t=e.children;return(0,a.A)("ul",{className:"nav nav-pills"},void 0,t)}var _=n(32485),N=n.n(_);function C(e){var t=e.active,n=e.link,i=e.icon,o=e.children;return(0,a.A)("li",{className:N()({active:t})},void 0,(0,a.A)(l.N_,{to:n,activeClassName:""},void 0,!!i&&(0,a.A)("span",{className:"material-icon"},void 0,i),o))}var E=n(98088);function w(e){var t=e.filter,n=misago.get("NOTIFICATIONS_URL");return(0,a.A)(E.M7,{},void 0,(0,a.A)(E.rk,{auto:!0},void 0,(0,a.A)(E.Tm,{},void 0,(0,a.A)(k,{},void 0,(0,a.A)(C,{active:"all"===t,link:n},void 0,pgettext("notifications nav","All")),(0,a.A)(C,{active:"unread"===t,link:n+"unread/"},void 0,pgettext("notifications nav","Unread")),(0,a.A)(C,{active:"read"===t,link:n+"read/"},void 0,pgettext("notifications nav","Read"))))))}var F,R,S,B=n(39227);function L(e){var t=e.baseUrl,n=e.data,i=e.disabled;return(0,a.A)("div",{className:"misago-pagination"},void 0,(0,a.A)(T,{url:t,disabled:i||!n||!n.hasPrevious},void 0,pgettext("notifications pagination","Latest")),(0,a.A)(T,{url:t+"?before="+(n?n.firstCursor:""),disabled:i||!n||!n.hasPrevious},void 0,pgettext("notifications pagination","Newer")),(0,a.A)(T,{url:t+"?after="+(n?n.lastCursor:""),disabled:i||!n||!n.hasNext},void 0,pgettext("notifications pagination","Older")))}function T(e){var t=e.disabled,n=e.children,i=e.url;return t?(0,a.A)("button",{className:"btn btn-default",type:"disabled",disabled:!0},void 0,n):(0,a.A)(l.N_,{to:i,className:"btn btn-default",activeClassName:""},void 0,n)}function O(e){var t=e.baseUrl,n=e.data,i=e.disabled,o=e.bottom,r=e.markAllAsRead;return(0,a.A)(E.M7,{},void 0,(0,a.A)(E.rk,{},void 0,(0,a.A)(E.Tm,{},void 0,(0,a.A)(L,{baseUrl:t,data:n,disabled:i}))),F||(F=(0,a.A)(E.my,{})),(0,a.A)(E.rk,{className:N()({"hidden-xs":!o})},void 0,(0,a.A)(E.Tm,{},void 0,(0,a.A)(B.A,{className:"btn-default btn-block",type:"button",disabled:i||!n||!n.unreadNotifications,onClick:r},void 0,R||(R=(0,a.A)("span",{className:"material-icon"},void 0,"done_all")),pgettext("notifications","Mark all as read")))))}function P(e){return"unread"===e?pgettext("notifications title","Unread notifications"):"read"===e?pgettext("notifications title","Read notifications"):null}const I=(0,u.Ng)()(function(e){var t=e.dispatch,n=e.location,i=e.route,r=n.query,s=i.props.filter,u=function(e){var t=misago.get("NOTIFICATIONS_URL");return"all"!==e&&(t+=e+"/"),t}(s);return(0,a.A)(D.A,{},void 0,(0,a.A)(b,{title:pgettext("notifications title","Notifications"),subtitle:P(s)}),(0,a.A)(w,{filter:s}),(0,a.A)(y.A,{filter:s,query:r},void 0,function(e){var n,i=e.data,l=e.loading,c=e.error,d=e.refetch;return(0,a.A)(g.u,{url:misago.get("NOTIFICATIONS_API")+"read-all/"},void 0,function(e,m){var g,y=m.loading,b={baseUrl:u,data:i,disabled:l||y||!i||0===i.results.length,markAllAsRead:(g=(0,h.A)(f().mark(function n(){return f().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:window.confirm(pgettext("notifications","Mark all notifications as read?"))&&e({onSuccess:function(){var e=(0,h.A)(f().mark(function e(){return f().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:d(),t((0,v.KK)({unreadNotifications:null})),A.A.success(pgettext("notifications","All notifications have been marked as read."));case 3:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}(),onError:A.A.apiError});case 2:case"end":return n.stop()}},n)})),function(){return g.apply(this,arguments)})};return l||y?(0,a.A)("div",{},void 0,o().createElement(O,b),S||(S=(0,a.A)(x.BG,{})),o().createElement(O,(0,p.A)({},b,{bottom:!0}))):c?(0,a.A)("div",{},void 0,o().createElement(O,b),n||(n=(0,a.A)(x.n8,{error:c})),o().createElement(O,(0,p.A)({},b,{bottom:!0}))):i?(!i.hasPrevious&&r&&window.history.replaceState({},"",u),(0,a.A)("div",{},void 0,o().createElement(O,b),(0,a.A)(x.$y,{filter:s,items:i.results,hasNext:i.hasNext,hasPrevious:i.hasPrevious}),o().createElement(O,(0,p.A)({},b,{bottom:!0})))):null})}))});var q;n(81002);const U=function(){var e=misago.get("NOTIFICATIONS_URL");return(0,a.A)("div",{className:"page page-notifications"},void 0,q||(q=(0,a.A)(d,{})),(0,a.A)(l.Ix,{history:l.Nc,routes:[{path:e,component:I,props:{filter:"all"}},{path:e+"unread/",component:I,props:{filter:"unread"}},{path:e+"read/",component:I,props:{filter:"read"}}]}))};var j,M=n(52762);misago.addInitializer({name:"component:notifications",initializer:function(e){var t=misago.get("NOTIFICATIONS_URL");if(document.location.pathname.startsWith(t)&&!document.location.pathname.startsWith(t+"disable-email/")&&e.get("isAuthenticated")){var n=document.getElementById("page-mount");s().render((0,a.A)(u.Kq,{store:M.A.getStore()},void 0,j||(j=(0,a.A)(U,{}))),n)}},after:"store"})},65290:(e,t,n)=>{"use strict";var a=n(73971),i=n(69387);a.A.addInitializer({name:"include",initializer:function(e){i.A.init(e.get("STATIC_URL"))}})},65407:(e,t,n)=>{"use strict";n.d(t,{V:()=>f,u:()=>v});var a=n(10467),i=n(23029),o=n(92901),r=n(9417),s=n(15361),u=n(61801),l=n(53954),c=n(64467),d=n(54756),p=n.n(d),h=n(40927),m=n.n(h);var f=function(e){(0,s.A)(h,e);var t,n,d=(t=h,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}(),function(){var e,a=(0,l.A)(t);if(n){var i=(0,l.A)(this).constructor;e=Reflect.construct(a,arguments,i)}else e=a.apply(this,arguments);return(0,u.A)(this,e)});function h(e){var t;return(0,i.A)(this,h),t=d.call(this,e),(0,c.A)((0,r.A)(t),"hasCache",function(e){return t.props.cache&&t.props.cache[e]}),(0,c.A)((0,r.A)(t),"getCache",function(){var e=(0,a.A)(p().mark(function e(n){var a;return p().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(a=t.props.cache[n],t.setState({loading:!1,error:null,data:a}),!t.props.onData){e.next=5;break}return e.next=5,t.props.onData(a);case 5:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()),(0,c.A)((0,r.A)(t),"setCache",function(e,n){t.props.cache&&(t.props.cache[e]=n)}),(0,c.A)((0,r.A)(t),"request",function(e){t.setState({loading:!0}),fetch(e,{method:"GET",credentials:"include",signal:t.signal}).then(function(){var n=(0,a.A)(p().mark(function n(a){var i,o;return p().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(e!==t.props.url){n.next=18;break}if(200!=a.status){n.next=12;break}return n.next=4,a.json();case 4:if(i=n.sent,t.setState({loading:!1,error:null,data:i}),t.setCache(e,i),!t.props.onData){n.next=10;break}return n.next=10,t.props.onData(i);case 10:n.next=18;break;case 12:if(o={status:a.status},"application/json"!==a.headers.get("Content-Type")){n.next=17;break}return n.next=16,a.json();case 16:o.data=n.sent;case 17:t.setState({loading:!1,error:o});case 18:case"end":return n.stop()}},n)}));return function(e){return n.apply(this,arguments)}}(),function(n){e===t.props.url&&t.setState({loading:!1,error:{status:0,rejection:n}})})}),(0,c.A)((0,r.A)(t),"refetch",function(){t.request(t.props.url)}),(0,c.A)((0,r.A)(t),"update",function(e){t.setState(function(t){return{data:e(t.data)}})}),t.state={data:null,loading:!1,error:null},t.controller=new AbortController,t.signal=t.controller.signal,t}return(0,o.A)(h,[{key:"componentDidMount",value:function(){this.props.url&&!this.props.disabled&&this.request(this.props.url)}},{key:"componentDidUpdate",value:function(e){var t=this.props.url,n=t&&t!==e.url,a=this.props.disabled!=e.disabled;(n||a)&&(this.props.disabled?this.controller.abort():this.hasCache(t)?this.getCache(t):(this.controller.abort(),this.controller=new AbortController,this.signal=this.controller.signal,this.request(t)))}},{key:"componentWillUnmount",value:function(){this.controller.abort()}},{key:"render",value:function(){return this.props.children(Object.assign({refetch:this.refetch,update:this.update},this.state))}}]),h}(m().Component);var v=function(e){(0,s.A)(h,e);var t,n,d=(t=h,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}(),function(){var e,a=(0,l.A)(t);if(n){var i=(0,l.A)(this).constructor;e=Reflect.construct(a,arguments,i)}else e=a.apply(this,arguments);return(0,u.A)(this,e)});function h(e){var t;return(0,i.A)(this,h),t=d.call(this,e),(0,c.A)((0,r.A)(t),"mutate",function(e){t.setState({loading:!0}),fetch(t.props.url,{method:t.props.method||"POST",credentials:"include",headers:A(e),body:g(e)}).then(function(){var n=(0,a.A)(p().mark(function n(a){var i,o;return p().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(200!=a.status){n.next=10;break}return n.next=3,a.json();case 3:if(i=n.sent,t.setState({loading:!1,data:i}),!e.onSuccess){n.next=8;break}return n.next=8,e.onSuccess(i);case 8:n.next=26;break;case 10:if(204!=a.status){n.next=17;break}if(t.setState({loading:!1}),!e.onSuccess){n.next=15;break}return n.next=15,e.onSuccess();case 15:n.next=26;break;case 17:if(o={status:a.status},"application/json"!==a.headers.get("Content-Type")){n.next=22;break}return n.next=21,a.json();case 21:o.data=n.sent;case 22:if(t.setState({loading:!1,error:o}),!e.onError){n.next=26;break}return n.next=26,e.onError(o);case 26:case"end":return n.stop()}},n)}));return function(e){return n.apply(this,arguments)}}(),function(){var n=(0,a.A)(p().mark(function n(a){var i;return p().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(i={status:0,rejection:a},t.setState({loading:!1,error:i}),!e.onError){n.next=5;break}return n.next=5,e.onError(i);case 5:case"end":return n.stop()}},n)}));return function(e){return n.apply(this,arguments)}}())}),t.state={data:null,loading:!1,error:null},t}return(0,o.A)(h,[{key:"render",value:function(){return this.props.children(this.mutate,this.state)}}]),h}(m().Component);function A(e){return e.json?{"Content-Type":"application/json; charset=utf-8","X-CSRFToken":y()}:{"X-CSRFToken":y()}}function g(e){if(e.json)return JSON.stringify(e.json)}function y(){var e=window.misago_csrf;if(-1!==document.cookie.indexOf(e)){var t=new RegExp(e+"=([^;]*)"),n=document.cookie.match(t)[0];return n?n.split("=")[1]:null}return null}},67369:(e,t,n)=>{"use strict";n.d(t,{yq:()=>s,FI:()=>l,OJ:()=>c,HU:()=>u,Uf:()=>d,Bl:()=>p});var a,i=n(73620),o=n(32485),r=n.n(o);function s(e){var t=e.className,n=e.children;return(0,i.A)("ul",{className:r()("list-group",t)},void 0,n)}function u(e){var t=e.className,n=e.children;return(0,i.A)("li",{className:r()("list-group-item",t)},void 0,n)}function l(e){var t=e.className,n=e.icon,a=e.message;return(0,i.A)(u,{className:r()("list-group-empty",t)},void 0,!!n&&(0,i.A)("div",{className:"list-group-empty-icon"},void 0,(0,i.A)("span",{className:"material-icon"},void 0,n)),(0,i.A)("p",{className:"list-group-empty-message"},void 0,a))}function c(e){var t=e.className,n=e.icon,a=e.message,o=e.detail;return(0,i.A)(u,{className:r()("list-group-error",t)},void 0,!!n&&(0,i.A)("div",{className:"list-group-error-icon"},void 0,(0,i.A)("span",{className:"material-icon"},void 0,n)),(0,i.A)("p",{className:"list-group-error-message"},void 0,a),!!o&&(0,i.A)("p",{className:"list-group-error-detail"},void 0,o))}function d(e){var t=e.className,n=e.message;return(0,i.A)(u,{className:r()("list-group-loading",t)},void 0,(0,i.A)("p",{className:"list-group-loading-message"},void 0,n),a||(a=(0,i.A)("div",{className:"list-group-loading-progress"},void 0,(0,i.A)("div",{className:"list-group-loading-progress-bar"}))))}function p(e){var t=e.className,n=e.icon,a=e.message,o=e.detail;return(0,i.A)(u,{className:r()("list-group-message",t)},void 0,!!n&&(0,i.A)("div",{className:"list-group-message-icon"},void 0,(0,i.A)("span",{className:"material-icon"},void 0,n)),(0,i.A)("p",{className:"list-group-message-message"},void 0,a),!!o&&(0,i.A)("p",{className:"list-group-message-detail"},void 0,o))}n(40927)},67582:(e,t,n)=>{"use strict";var a=n(73971),i=n(97414),o=n(52762);a.A.addInitializer({name:"reducer:users",initializer:function(){o.A.addReducer("users",i.Ay,[])},before:"store"})},68333:(e,t,n)=>{"use strict";n.d(t,{A:()=>l});var a,i=n(73620),o=n(32485),r=n.n(o),s=(n(40927),n(70490)),u=n(24832);const l=function(e){var t=e.block,n=e.className,o=e.onClick,l=misago.get("SETTINGS");return l.DELEGATE_AUTH?(0,i.A)("a",{className:r()("btn btn-sign-in",n,{"btn-block":t}),href:l.LOGIN_URL,onClick:function(){o&&o()}},void 0,pgettext("cta","Sign in")):(0,i.A)("a",{className:r()("btn btn-sign-in",n,{"btn-block":t}),href:l.LOGIN_URL,onClick:function(e){e.preventDefault(),o&&o(),s.A.show(a||(a=(0,i.A)(u.A,{})))}},void 0,pgettext("cta","Sign in"))}},68335:(e,t,n)=>{"use strict";var a=n(73971),i=n(95271),o=n(52762);a.A.addInitializer({name:"reducer:profile",initializer:function(){o.A.addReducer("profile",i.Ay,{})},before:"store"})},68906:(e,t,n)=>{"use strict";var a,i,o=n(67467),r=n(73620),s=n(23029),u=n(92901),l=n(9417),c=n(15361),d=n(61801),p=n(53954),h=n(64467),m=n(40927),f=n.n(m),v=n(58168),A=n(849),g=n(82743),y=n(89053),b=n(29156),D=n(92069),x=n(70490),k=n(29904),_=n(52762);var N,C=function(e){(0,c.A)(o,e);var t,n,i=(t=o,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}(),function(){var e,a=(0,p.A)(t);if(n){var i=(0,p.A)(this).constructor;e=Reflect.construct(a,arguments,i)}else e=a.apply(this,arguments);return(0,d.A)(this,e)});function o(e){var t;return(0,s.A)(this,o),t=i.call(this,e),(0,h.A)((0,l.A)(t),"onUsernameChange",function(e){t.changeValue("username",e.target.value)}),t.state={isLoading:!1,username:""},t}return(0,u.A)(o,[{key:"clean",value:function(){return!!this.state.username.trim().length||(k.A.error(pgettext("add private thread participant","You have to enter user name.")),!1)}},{key:"send",value:function(){return D.A.patch(this.props.thread.api.index,[{op:"add",path:"participants",value:this.state.username},{op:"add",path:"acl",value:1}])}},{key:"handleSuccess",value:function(e){_.A.dispatch((0,b.iO)(e)),_.A.dispatch(y.HC(e.participants)),k.A.success(pgettext("add private thread participant","New participant has been added to thread.")),x.A.hide()}},{key:"render",value:function(){return(0,r.A)("div",{className:"modal-dialog modal-sm",role:"document"},void 0,(0,r.A)("form",{onSubmit:this.handleSubmit},void 0,(0,r.A)("div",{className:"modal-content"},void 0,a||(a=(0,r.A)(E,{})),(0,r.A)("div",{className:"modal-body"},void 0,(0,r.A)(g.A,{for:"id_username",label:pgettext("add private thread participant field","User to add")},void 0,(0,r.A)("input",{id:"id_username",className:"form-control",disabled:this.state.isLoading,onChange:this.onUsernameChange,type:"text",value:this.state.username}))),(0,r.A)("div",{className:"modal-footer"},void 0,(0,r.A)("button",{className:"btn btn-block btn-primary",disabled:this.state.isLoading},void 0,pgettext("add private thread participant btn","Add participant")),(0,r.A)("button",{className:"btn btn-block btn-default","data-dismiss":"modal",disabled:this.state.isLoading,type:"button"},void 0,pgettext("add private thread participant btn","Cancel"))))))}}]),o}(A.A);function E(e){return(0,r.A)("div",{className:"modal-header"},void 0,(0,r.A)("button",{"aria-label":pgettext("modal","Close"),className:"close","data-dismiss":"modal",type:"button"},void 0,i||(i=(0,r.A)("span",{"aria-hidden":"true"},void 0,"Ã—"))),(0,r.A)("h4",{className:"modal-title"},void 0,pgettext("add private thread participant modal title","Add participant")))}var w=function(e){(0,c.A)(i,e);var t,n,a=(t=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}(),function(){var e,a=(0,p.A)(t);if(n){var i=(0,p.A)(this).constructor;e=Reflect.construct(a,arguments,i)}else e=a.apply(this,arguments);return(0,d.A)(this,e)});function i(){var e;(0,s.A)(this,i);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return e=a.call.apply(a,[this].concat(n)),(0,h.A)((0,l.A)(e),"onClick",function(){x.A.show((0,r.A)(C,{thread:e.props.thread}))}),e}return(0,u.A)(i,[{key:"render",value:function(){return this.props.thread.acl.can_add_participants?(0,r.A)("div",{className:"col-xs-12 col-sm-3"},void 0,(0,r.A)("button",{className:"btn btn-default btn-block",onClick:this.onClick,type:"button"},void 0,N||(N=(0,r.A)("span",{className:"material-icon"},void 0,"person_add")),pgettext("add participant btn","Add participant"))):null}}]),i}(f().Component),F=n(73971);var R=function(e){(0,c.A)(i,e);var t,n,a=(t=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}(),function(){var e,a=(0,p.A)(t);if(n){var i=(0,p.A)(this).constructor;e=Reflect.construct(a,arguments,i)}else e=a.apply(this,arguments);return(0,d.A)(this,e)});function i(e){var t;return(0,s.A)(this,i),t=a.call(this,e),(0,h.A)((0,l.A)(t),"onClick",function(){var e,n,a=!1;if(t.isUser)a=window.confirm(pgettext("private thread owner change","Are you sure you want to take over this thread?"));else{var i=pgettext("private thread owner change","Are you sure you want to change thread owner to %(user)s?");a=window.confirm(interpolate(i,{user:t.props.participant.username},!0))}a&&(e=t.props.thread,n=t.props.participant,D.A.patch(e.api.index,[{op:"replace",path:"owner",value:n.id},{op:"add",path:"acl",value:1}]).then(function(e){_.A.dispatch((0,b.iO)(e)),_.A.dispatch(y.HC(e.participants));var t=pgettext("thread participants actions","%(user)s has been made new thread owner.");k.A.success(interpolate(t,{user:n.username},!0))},function(e){k.A.apiError(e)}))}),t.isUser=e.participant.id===e.user.id,t}return(0,u.A)(i,[{key:"render",value:function(){return this.props.participant.is_owner?null:this.props.thread.acl.can_change_owner?(0,r.A)("li",{},void 0,(0,r.A)("button",{className:"btn btn-link",onClick:this.onClick,type:"button"},void 0,pgettext("private thread owner change btn","Make owner"))):null}}]),i}(f().Component);var S,B,L,T=function(e){(0,c.A)(i,e);var t,n,a=(t=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}(),function(){var e,a=(0,p.A)(t);if(n){var i=(0,p.A)(this).constructor;e=Reflect.construct(a,arguments,i)}else e=a.apply(this,arguments);return(0,d.A)(this,e)});function i(e){var t;return(0,s.A)(this,i),t=a.call(this,e),(0,h.A)((0,l.A)(t),"onClick",function(){var e,n,a=!1;if(t.isUser)a=window.confirm(pgettext("private thread leave","Are you sure you want to leave this thread?"));else{var i=pgettext("private thread leave","Are you sure you want to remove %(user)s from this thread?");a=window.confirm(interpolate(i,{user:t.props.participant.username},!0))}a&&(t.isUser?(e=t.props.thread,n=t.props.participant,D.A.patch(e.api.index,[{op:"remove",path:"participants",value:n.id}]).then(function(){k.A.success(pgettext("thread participants actions","You have left this thread.")),window.setTimeout(function(){window.location=F.A.get("PRIVATE_THREADS_URL")},3e3)},function(e){k.A.apiError(e)})):function(e,t){D.A.patch(e.api.index,[{op:"remove",path:"participants",value:t.id},{op:"add",path:"acl",value:1}]).then(function(e){_.A.dispatch((0,b.iO)(e)),_.A.dispatch(y.HC(e.participants));var n=pgettext("thread participants actions","%(user)s has been removed from this thread.");k.A.success(interpolate(n,{user:t.username},!0))},function(e){k.A.apiError(e)})}(t.props.thread,t.props.participant))}),t.isUser=e.participant.id===e.user.id,t}return(0,u.A)(i,[{key:"render",value:function(){var e=this.props.user.acl.can_moderate_private_threads;return this.props.userIsOwner||this.isUser||e?(0,r.A)("li",{},void 0,(0,r.A)("button",{className:"btn btn-link",onClick:this.onClick,type:"button"},void 0,this.isUser?pgettext("private thread leave btn","Leave thread"):pgettext("private thread leave btn","Remove"))):null}}]),i}(f().Component),O=n(30330);function P(e){var t=e.participant,n="btn btn-default";return t.is_owner&&(n="btn btn-primary"),n+=" btn-user btn-block",(0,r.A)("div",{className:"col-xs-12 col-sm-3 col-md-2 participant-card"},void 0,(0,r.A)("div",{className:"dropdown"},void 0,(0,r.A)("button",{"aria-haspopup":"true","aria-expanded":"false",className:n,"data-toggle":"dropdown",type:"button"},void 0,(0,r.A)(O.Ay,{size:"34",user:t}),(0,r.A)("span",{className:"btn-text"},void 0,t.username)),(0,r.A)("ul",{className:"dropdown-menu stick-to-bottom"},void 0,(0,r.A)(I,{isOwner:t.is_owner}),S||(S=(0,r.A)("li",{className:"dropdown-header"})),(0,r.A)("li",{},void 0,(0,r.A)("a",{href:t.url},void 0,pgettext("thread participants profile link","See profile"))),B||(B=(0,r.A)("li",{role:"separator",className:"divider"})),f().createElement(R,e),f().createElement(T,e))))}function I(e){return e.isOwner?(0,r.A)("li",{className:"dropdown-header dropdown-header-owner"},void 0,L||(L=(0,r.A)("span",{className:"material-icon"},void 0,"start")),(0,r.A)("span",{className:"icon-text"},void 0,pgettext("thread participants owner status","Thread owner"))):null}function q(e){var t=e.participants,n=e.thread,a=e.user,i=e.userIsOwner;return(0,r.A)("div",{className:"participants-cards"},void 0,(0,r.A)("div",{className:"row"},void 0,t.map(function(e){return(0,r.A)(P,{participant:e,thread:n,user:a,userIsOwner:i},e.id)})))}function U(e){return e.participants.length?(0,r.A)("div",{className:"panel panel-default panel-participants"},void 0,(0,r.A)("div",{className:"panel-body"},void 0,f().createElement(q,(0,v.A)({userIsOwner:j(e.user,e.participants)},e)),(0,r.A)("div",{className:"row"},void 0,(0,r.A)(w,{thread:e.thread}),(0,r.A)("div",{className:"col-xs-12 col-sm-9"},void 0,(0,r.A)("p",{},void 0,function(e){var t=e.length,n=npgettext("thread participants stat","This thread has %(users)s participant.","This thread has %(users)s participants.",t);return interpolate(n,{users:t},!0)}(e.participants)))))):null}function j(e,t){return t[0].id===e.id}var M,z=n(95093),H=n.n(z);function V(e){return(0,r.A)("div",{className:"poll-choices-bars"},void 0,e.poll.choices.map(function(t){return(0,r.A)(Y,{choice:t,poll:e.poll},t.hash)}))}function Y(e){var t=0;return e.choice.votes&&e.poll.votes&&(t=Math.ceil(100*e.choice.votes/e.poll.votes)),(0,r.A)("dl",{className:"dl-horizontal"},void 0,(0,r.A)("dt",{},void 0,e.choice.label),(0,r.A)("dd",{},void 0,(0,r.A)("div",{className:"progress"},void 0,(0,r.A)("div",{className:"progress-bar",role:"progressbar","aria-valuenow":t,"aria-valuemin":"0","aria-valuemax":"100",style:{width:t+"%"}},void 0,(0,r.A)("span",{className:"sr-only"},void 0,G(e.votes,e.proc)))),(0,r.A)("ul",{className:"list-unstyled list-inline poll-chart"},void 0,(0,r.A)(W,{proc:t,votes:e.choice.votes}),(0,r.A)(Q,{selected:e.choice.selected}))))}function W(e){return(0,r.A)("li",{className:"poll-chart-votes"},void 0,G(e.votes,e.proc))}function G(e,t){var n=npgettext("thread poll","%(votes)s vote, %(proc)s% of total.","%(votes)s votes, %(proc)s% of total.",e);return interpolate(n,{votes:e,proc:t},!0)}function Q(e){return e.selected?(0,r.A)("li",{className:"poll-chart-selected"},void 0,M||(M=(0,r.A)("span",{className:"material-icon"},void 0,"check_box")),pgettext("thread poll","You've voted on this choice.")):null}var K,X,J,$=n(33864),Z=n(27860);var ee=function(e){(0,c.A)(i,e);var t,n,a=(t=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}(),function(){var e,a=(0,p.A)(t);if(n){var i=(0,p.A)(this).constructor;e=Reflect.construct(a,arguments,i)}else e=a.apply(this,arguments);return(0,d.A)(this,e)});function i(e){var t;return(0,s.A)(this,i),(t=a.call(this,e)).state={isLoading:!0,error:null,data:[]},t}return(0,u.A)(i,[{key:"componentDidMount",value:function(){var e=this;D.A.get(this.props.poll.api.votes).then(function(t){var n=t.map(function(e){return Object.assign({},e,{voters:e.voters.map(function(e){return Object.assign({},e,{voted_on:H()(e.voted_on)})})})});e.setState({isLoading:!1,data:n})},function(t){e.setState({isLoading:!1,error:t.detail})})}},{key:"render",value:function(){return(0,r.A)("div",{className:"modal-dialog"+(this.state.error?" modal-message":" modal-sm"),role:"document"},void 0,(0,r.A)("div",{className:"modal-content"},void 0,(0,r.A)("div",{className:"modal-header"},void 0,(0,r.A)("button",{type:"button",className:"close","data-dismiss":"modal","aria-label":pgettext("modal","Close")},void 0,K||(K=(0,r.A)("span",{"aria-hidden":"true"},void 0,"Ã—"))),(0,r.A)("h4",{className:"modal-title"},void 0,pgettext("thread poll","Poll votes"))),(0,r.A)(te,{data:this.state.data,error:this.state.error,isLoading:this.state.isLoading})))}}]),i}(f().Component);function te(e){return e.isLoading?X||(X=(0,r.A)(Z.A,{})):e.error?(0,r.A)($.A,{icon:"error_outline",message:e.error}):(0,r.A)(ne,{data:e.data})}function ne(e){return(0,r.A)("div",{className:"modal-body modal-poll-votes"},void 0,(0,r.A)("ul",{className:"list-unstyled votes-details"},void 0,e.data.map(function(e){return f().createElement(ae,(0,v.A)({key:e.hash},e))})))}function ae(e){return(0,r.A)("li",{},void 0,(0,r.A)("h4",{},void 0,e.label),(0,r.A)(ie,{votes:e.votes}),(0,r.A)(oe,{voters:e.voters}),J||(J=(0,r.A)("hr",{})))}function ie(e){var t=npgettext("thread poll","%(votes)s user has voted for this choice.","%(votes)s users have voted for this choice.",e.votes),n=interpolate(t,{votes:e.votes},!0);return(0,r.A)("p",{},void 0,n)}function oe(e){return e.voters.length?(0,r.A)("ul",{className:"list-unstyled"},void 0,e.voters.map(function(e){return f().createElement(re,(0,v.A)({key:e.username},e))})):null}function re(e){return e.url?(0,r.A)("li",{},void 0,(0,r.A)("a",{className:"item-title",href:e.url},void 0,e.username)," ",(0,r.A)(se,{voted_on:e.voted_on})):(0,r.A)("li",{},void 0,(0,r.A)("strong",{},void 0,e.username)," ",(0,r.A)(se,{voted_on:e.voted_on}))}function se(e){return(0,r.A)("abbr",{className:"text-muted",title:e.voted_on.format("LLL")},void 0,e.voted_on.fromNow())}var ue=n(51433),le=n(9801);function ce(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,a=(0,p.A)(e);if(t){var i=(0,p.A)(this).constructor;n=Reflect.construct(a,arguments,i)}else n=a.apply(this,arguments);return(0,d.A)(this,n)}}function de(e){var t=e.isPollOver,n=e.poll,a=e.showVoting,i=e.thread;if(!function(e,t,n){return n.is_public||t.can_delete||t.can_edit||t.can_see_votes||t.can_vote&&!e&&(!n.hasSelectedChoices||n.allow_revotes)}(t,n.acl,n))return null;var o=[],s=n.acl.can_vote,u=!n.hasSelectedChoices||n.allow_revotes;return s&&u&&o.push(0),(n.is_public||n.acl.can_see_votes)&&o.push(1),n.acl.can_edit&&o.push(2),n.acl.can_delete&&o.push(3),(0,r.A)("div",{className:"row poll-options"},void 0,(0,r.A)(he,{controls:o,isPollOver:t,poll:n,showVoting:a}),(0,r.A)(me,{controls:o,poll:n}),(0,r.A)(fe,{controls:o,poll:n,thread:i,onClick:e.edit}),(0,r.A)(ve,{controls:o,poll:n}))}function pe(e,t){var n="col-xs-6";return 1===e.length&&(n="col-xs-12"),3===e.length&&e[0]===t&&(n="col-xs-12"),n+" col-sm-3 col-md-2"}function he(e){var t=e.poll.acl.can_vote,n=!e.poll.hasSelectedChoices||e.poll.allow_revotes;return t&&n?(0,r.A)("div",{className:pe(e.controls,0)},void 0,(0,r.A)("button",{className:"btn btn-default btn-block btn-sm",disabled:e.poll.isBusy,onClick:e.showVoting,type:"button"},void 0,pgettext("thread poll","Vote"))):null}var me=function(e){(0,c.A)(n,e);var t=ce(n);function n(){var e;(0,s.A)(this,n);for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return e=t.call.apply(t,[this].concat(i)),(0,h.A)((0,l.A)(e),"onClick",function(){x.A.show((0,r.A)(ee,{poll:e.props.poll}))}),e}return(0,u.A)(n,[{key:"render",value:function(){return this.props.poll.is_public||this.props.poll.acl.can_see_votes?(0,r.A)("div",{className:pe(this.props.controls,1)},void 0,(0,r.A)("button",{className:"btn btn-default btn-block btn-sm",disabled:this.props.poll.isBusy,onClick:this.onClick,type:"button"},void 0,pgettext("thread poll","See votes"))):null}}]),n}(f().Component);function fe(e){return e.poll.acl.can_edit?(0,r.A)("div",{className:pe(e.controls,2)},void 0,(0,r.A)("button",{className:"btn btn-default btn-block btn-sm",disabled:e.poll.isBusy,onClick:e.onClick,type:"button"},void 0,pgettext("thread poll","Edit"))):null}var ve=function(e){(0,c.A)(n,e);var t=ce(n);function n(){var e;(0,s.A)(this,n);for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return e=t.call.apply(t,[this].concat(i)),(0,h.A)((0,l.A)(e),"onClick",function(){if(!window.confirm(pgettext("thread poll","Are you sure you want to delete this poll? This action is not reversible.")))return!1;_.A.dispatch(ue.S2()),D.A.delete(e.props.poll.api.index).then(e.handleSuccess,e.handleError)}),(0,h.A)((0,l.A)(e),"handleSuccess",function(e){k.A.success(pgettext("thread poll","Poll has been deleted")),_.A.dispatch(ue.TF()),_.A.dispatch(b.iO(e))}),(0,h.A)((0,l.A)(e),"handleError",function(e){k.A.apiError(e),_.A.dispatch(ue._r())}),e}return(0,u.A)(n,[{key:"render",value:function(){return this.props.poll.acl.can_delete?(0,r.A)("div",{className:pe(this.props.controls,3)},void 0,(0,r.A)("button",{className:"btn btn-default btn-block btn-sm",disabled:this.props.poll.isBusy,onClick:this.onClick,type:"button"},void 0,pgettext("thread poll","Delete"))):null}}]),n}(f().Component),Ae=n(20127),ge='<abbr title="%(absolute)s">%(relative)s</abbr>';function ye(e){return(0,r.A)("ul",{className:"list-unstyled list-inline poll-details"},void 0,(0,r.A)(Ne,{votes:e.poll.votes}),(0,r.A)(ke,{poll:e.poll}),(0,r.A)(Ce,{poll:e.poll}),(0,r.A)(be,{poll:e.poll}))}function be(e){var t=interpolate((0,Ae.A)(pgettext("thread poll","Started by %(poster)s %(posted_on)s.")),{poster:De(e.poll),posted_on:xe(e.poll)},!0);return(0,r.A)("li",{className:"poll-info-creation",dangerouslySetInnerHTML:{__html:t}})}function De(e){return e.url.poster?interpolate('<a href="%(url)s" class="item-title">%(user)s</a>',{url:(0,Ae.A)(e.url.poster),user:(0,Ae.A)(e.poster_name)},!0):interpolate('<span class="item-title">%(user)s</span>',{user:(0,Ae.A)(e.poster_name)},!0)}function xe(e){return interpolate(ge,{absolute:(0,Ae.A)(e.posted_on.format("LLL")),relative:(0,Ae.A)(e.posted_on.fromNow())},!0)}function ke(e){if(!e.poll.length)return null;var t=interpolate((0,Ae.A)(pgettext("thread poll","Voting ends %(ends_on)s.")),{ends_on:_e(e.poll)},!0);return(0,r.A)("li",{className:"poll-info-ends-on",dangerouslySetInnerHTML:{__html:t}})}function _e(e){return interpolate(ge,{absolute:(0,Ae.A)(e.endsOn.format("LLL")),relative:(0,Ae.A)(e.endsOn.fromNow())},!0)}function Ne(e){var t=npgettext("thread poll","%(votes)s vote.","%(votes)s votes.",e.votes),n=interpolate(t,{votes:e.votes},!0);return(0,r.A)("li",{className:"poll-info-votes"},void 0,n)}function Ce(e){return e.poll.is_public?(0,r.A)("li",{className:"poll-info-public"},void 0,pgettext("thread poll","Voting is public.")):null}function Ee(e){return(0,r.A)("div",{className:"panel panel-default panel-poll"},void 0,(0,r.A)("div",{className:"panel-body"},void 0,(0,r.A)("h2",{},void 0,e.poll.question),(0,r.A)(ye,{poll:e.poll}),(0,r.A)(V,{poll:e.poll}),(0,r.A)(de,{isPollOver:e.isPollOver,poll:e.poll,edit:e.edit,showVoting:e.showVoting,thread:e.thread})))}function we(e){return(0,r.A)("ul",{className:"list-unstyled list-inline poll-help"},void 0,(0,r.A)(Fe,{choicesLeft:e.choicesLeft}),(0,r.A)(Re,{poll:e.poll}))}function Fe(e){var t=e.choicesLeft;if(0===t)return(0,r.A)("li",{className:"poll-help-choices-left"},void 0,pgettext("thread poll","You can't select any more choices."));var n=npgettext("thread poll","You can select %(choices)s more choice.","You can select %(choices)s more choices.",t),a=interpolate(n,{choices:t},!0);return(0,r.A)("li",{className:"poll-help-choices-left"},void 0,a)}function Re(e){return e.poll.allow_revotes?(0,r.A)("li",{className:"poll-help-allow-revotes"},void 0,pgettext("thread poll","You can change your vote later.")):(0,r.A)("li",{className:"poll-help-no-revotes"},void 0,pgettext("thread poll","Votes are final."))}function Se(e){return(0,r.A)("ul",{className:"list-unstyled poll-select-choices"},void 0,e.choices.map(function(t){return(0,r.A)(Be,{choice:t,toggleChoice:e.toggleChoice},t.hash)}))}var Be=function(e){(0,c.A)(i,e);var t,n,a=(t=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}(),function(){var e,a=(0,p.A)(t);if(n){var i=(0,p.A)(this).constructor;e=Reflect.construct(a,arguments,i)}else e=a.apply(this,arguments);return(0,d.A)(this,e)});function i(){var e;(0,s.A)(this,i);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return e=a.call.apply(a,[this].concat(n)),(0,h.A)((0,l.A)(e),"onClick",function(){e.props.toggleChoice(e.props.choice.hash)}),e}return(0,u.A)(i,[{key:"render",value:function(){return(0,r.A)("li",{className:"poll-select-choice"},void 0,(0,r.A)("button",{className:this.props.choice.selected?"btn btn-selected":"btn",onClick:this.onClick,type:"button"},void 0,(0,r.A)("span",{className:"material-icon"},void 0,this.props.choice.selected?"check_box":"check_box_outline_blank"),(0,r.A)("strong",{},void 0,this.props.choice.label)))}}]),i}(f().Component);function Le(e,t){var n=[];for(var a in t){var i=t[a];i.selected&&n.push(i)}return e.allowed_choices-n.length}var Te=n(39227);var Oe=function(e){(0,c.A)(i,e);var t,n,a=(t=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}(),function(){var e,a=(0,p.A)(t);if(n){var i=(0,p.A)(this).constructor;e=Reflect.construct(a,arguments,i)}else e=a.apply(this,arguments);return(0,d.A)(this,e)});function i(e){var t;return(0,s.A)(this,i),t=a.call(this,e),(0,h.A)((0,l.A)(t),"toggleChoice",function(e){var n,a=function(e,t){for(var n in e){var a=e[n];if(a.hash===t)return a}return null}(t.state.choices,e);n=a.selected?t.deselectChoice(a,e):t.selectChoice(a,e),t.setState({choices:n,choicesLeft:Le(t.props.poll,n)})}),(0,h.A)((0,l.A)(t),"selectChoice",function(e,n){if(!Le(t.props.poll,t.state.choices))for(var a in t.state.choices.slice()){var i=t.state.choices[a];if(i.selected&&i.hash!=n){i.selected=!1;break}}return t.state.choices.map(function(e){return Object.assign({},e,{selected:e.hash==n||e.selected})})}),(0,h.A)((0,l.A)(t),"deselectChoice",function(e,n){return t.state.choices.map(function(e){return Object.assign({},e,{selected:e.hash!=n&&e.selected})})}),t.state={isLoading:!1,choices:e.poll.choices,choicesLeft:Le(e.poll,e.poll.choices)},t}return(0,u.A)(i,[{key:"clean",value:function(){return this.state.choicesLeft!==this.props.poll.allowed_choices||(k.A.error(pgettext("thread poll vote","You need to select at least one choice.")),!1)}},{key:"send",value:function(){var e=[];for(var t in this.state.choices.slice()){var n=this.state.choices[t];n.selected&&e.push(n.hash)}return D.A.post(this.props.poll.api.votes,e)}},{key:"handleSuccess",value:function(e){_.A.dispatch(ue.HC(e)),k.A.success(pgettext("thread poll vote","Your vote has been saved.")),this.props.showResults()}},{key:"handleError",value:function(e){400===e.status?k.A.error(e.detail):k.A.apiError(e)}},{key:"render",value:function(){var e=[];return this.props.poll.acl.can_vote&&e.push(0),(this.props.poll.is_public||this.props.poll.acl.can_see_votes)&&e.push(1),this.props.poll.acl.can_edit&&e.push(2),this.props.poll.acl.can_delete&&e.push(3),(0,r.A)("div",{className:"panel panel-default panel-poll"},void 0,(0,r.A)("form",{onSubmit:this.handleSubmit},void 0,(0,r.A)("div",{className:"panel-body"},void 0,(0,r.A)("h2",{},void 0,this.props.poll.question),(0,r.A)(ye,{poll:this.props.poll}),(0,r.A)(Se,{choices:this.state.choices,toggleChoice:this.toggleChoice}),(0,r.A)(we,{choicesLeft:this.state.choicesLeft,poll:this.props.poll})),(0,r.A)("div",{className:"panel-footer"},void 0,(0,r.A)("div",{className:"row"},void 0,(0,r.A)("div",{className:pe(e,0)},void 0,(0,r.A)(Te.A,{className:"btn-primary btn-block btn-sm",loading:this.state.isLoading},void 0,pgettext("thread poll vote btn","Save your vote"))),(0,r.A)("div",{className:pe(e,1)},void 0,(0,r.A)("button",{className:"btn btn-default btn-block btn-sm",disabled:this.state.isLoading,onClick:this.props.showResults,type:"button"},void 0,pgettext("thread poll vote btn","See results"))),(0,r.A)(fe,{controls:e,poll:this.props.poll,thread:this.props.thread,onClick:this.props.edit}),(0,r.A)(ve,{controls:e,poll:this.props.poll})))))}}]),i}(A.A);var Pe,Ie=function(e){(0,c.A)(i,e);var t,n,a=(t=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}(),function(){var e,a=(0,p.A)(t);if(n){var i=(0,p.A)(this).constructor;e=Reflect.construct(a,arguments,i)}else e=a.apply(this,arguments);return(0,d.A)(this,e)});function i(e){var t;(0,s.A)(this,i),t=a.call(this,e),(0,h.A)((0,l.A)(t),"showResults",function(){t.setState({showResults:!0})}),(0,h.A)((0,l.A)(t),"showVoting",function(){t.setState({showResults:!1})});var n=!0;return e.user.id&&!e.poll.hasSelectedChoices&&(n=!1),t.state={showResults:n},t}return(0,u.A)(i,[{key:"render",value:function(){if(!this.props.thread.poll)return null;var e=function(e){return!!e.length&&H()().isAfter(e.endsOn)}(this.props.poll);return e||!this.props.poll.acl.can_vote||this.state.showResults?f().createElement(Ee,(0,v.A)({isPollOver:e,showVoting:this.showVoting},this.props)):f().createElement(Oe,(0,v.A)({showResults:this.showResults},this.props))}}]),i}(f().Component),qe=n(19086);function Ue(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,a=(0,p.A)(e);if(t){var i=(0,p.A)(this).constructor;n=Reflect.construct(a,arguments,i)}else n=a.apply(this,arguments);return(0,d.A)(this,n)}}var je=function(e){(0,c.A)(n,e);var t=Ue(n);function n(){var e;(0,s.A)(this,n);for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return e=t.call.apply(t,[this].concat(i)),(0,h.A)((0,l.A)(e),"onAdd",function(){var t=e.props.choices.slice();t.push({hash:(0,qe.Ay)(12),label:""}),e.props.setChoices(t)}),(0,h.A)((0,l.A)(e),"onChange",function(t,n){var a=e.props.choices.map(function(e){return e.hash===t&&(e.label=n),e});e.props.setChoices(a)}),(0,h.A)((0,l.A)(e),"onDelete",function(t){var n=e.props.choices.filter(function(e){return e.hash!==t});e.props.setChoices(n)}),e}return(0,u.A)(n,[{key:"render",value:function(){var e=this;return(0,r.A)("div",{className:"poll-choices-control"},void 0,(0,r.A)("ul",{className:"list-group"},void 0,this.props.choices.map(function(t){return(0,r.A)(Me,{canDelete:e.props.choices.length>2,choice:t,disabled:e.props.disabled,onChange:e.onChange,onDelete:e.onDelete},t.hash)})),(0,r.A)("button",{className:"btn btn-default btn-sm",disabled:this.props.disabled,onClick:this.onAdd,type:"button"},void 0,pgettext("thread poll","Add choice")))}}]),n}(f().Component),Me=function(e){(0,c.A)(n,e);var t=Ue(n);function n(){var e;(0,s.A)(this,n);for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return e=t.call.apply(t,[this].concat(i)),(0,h.A)((0,l.A)(e),"onChange",function(t){e.props.onChange(e.props.choice.hash,t.target.value)}),(0,h.A)((0,l.A)(e),"onDelete",function(){(0===e.props.choice.label.length||window.confirm(pgettext("thread poll","Are you sure you want to remove this choice?")))&&e.props.onDelete(e.props.choice.hash)}),e}return(0,u.A)(n,[{key:"render",value:function(){return(0,r.A)("li",{className:"list-group-item"},void 0,(0,r.A)("button",{className:"btn",disabled:!this.props.canDelete||this.props.disabled,onClick:this.onDelete,title:pgettext("thread poll","Remove this choice"),type:"button"},void 0,Pe||(Pe=(0,r.A)("span",{className:"material-icon"},void 0,"close"))),(0,r.A)("input",{disabled:this.props.disabled,maxLength:"255",placeholder:pgettext("thread poll","Poll choice"),type:"text",onChange:this.onChange,value:this.props.choice.label}))}}]),n}(f().Component),ze=n(73639);var He=function(e){(0,c.A)(i,e);var t,n,a=(t=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}(),function(){var e,a=(0,p.A)(t);if(n){var i=(0,p.A)(this).constructor;e=Reflect.construct(a,arguments,i)}else e=a.apply(this,arguments);return(0,d.A)(this,e)});function i(e){var t;(0,s.A)(this,i),t=a.call(this,e),(0,h.A)((0,l.A)(t),"setChoices",function(e){t.setState(function(t){return{choices:e,errors:Object.assign({},t.errors,{choices:null})}})}),(0,h.A)((0,l.A)(t),"onCancel",function(){if(""===t.state.question&&t.state.choices&&t.state.choices.every(function(e){return""===e.label})&&0===t.state.length&&1===t.state.allowed_choices)return t.props.close();(t.props.poll?window.confirm(pgettext("thread poll","Are you sure you want to discard changes?")):window.confirm(pgettext("thread poll","Are you sure you want to discard new poll?")))&&t.props.close()});var n=e.poll.id?e.poll:{question:"",choices:[{hash:"choice-10000",label:""},{hash:"choice-20000",label:""}],length:0,allowed_choices:1,allow_revotes:0,is_public:0};return t.state={isLoading:!1,isEdit:!!n.id,question:n.question,choices:n.choices,length:n.length,allowed_choices:n.allowed_choices,allow_revotes:n.allow_revotes,is_public:n.is_public,validators:{question:[],choices:[],length:[],allowed_choices:[]},errors:{}},t}return(0,u.A)(i,[{key:"send",value:function(){var e={question:this.state.question,choices:this.state.choices,length:this.state.length,allowed_choices:this.state.allowed_choices,allow_revotes:this.state.allow_revotes,is_public:this.state.is_public};return this.state.isEdit?D.A.put(this.props.poll.api.index,e):D.A.post(this.props.thread.api.poll,e)}},{key:"handleSuccess",value:function(e){_.A.dispatch(ue.HC(e)),this.state.isEdit?k.A.success(pgettext("thread poll","Poll has been edited.")):k.A.success(pgettext("thread poll","Poll has been posted.")),this.props.close()}},{key:"handleError",value:function(e){400===e.status?(e.non_field_errors&&(e.allowed_choices=e.non_field_errors),this.setState({errors:Object.assign({},e)}),k.A.error(gettext("Form contains errors."))):k.A.apiError(e)}},{key:"render",value:function(){return(0,r.A)("div",{className:"poll-form"},void 0,(0,r.A)("form",{onSubmit:this.handleSubmit},void 0,(0,r.A)("div",{className:"panel panel-default panel-form"},void 0,(0,r.A)("div",{className:"panel-heading"},void 0,(0,r.A)("h3",{className:"panel-title"},void 0,this.state.isEdit?pgettext("thread poll","Edit poll"):pgettext("thread poll","Add poll"))),(0,r.A)("div",{className:"panel-body"},void 0,(0,r.A)("fieldset",{},void 0,(0,r.A)("legend",{},void 0,pgettext("thread poll","Question and choices")),(0,r.A)(g.A,{label:pgettext("thread poll","Poll question"),for:"id_questions",validation:this.state.errors.question},void 0,(0,r.A)("input",{className:"form-control",disabled:this.state.isLoading,id:"id_questions",onChange:this.bindInput("question"),type:"text",maxLength:"255",value:this.state.question})),(0,r.A)(g.A,{label:pgettext("thread poll","Available choices"),validation:this.state.errors.choices},void 0,(0,r.A)(je,{choices:this.state.choices,disabled:this.state.isLoading,setChoices:this.setChoices}))),(0,r.A)("fieldset",{},void 0,(0,r.A)("legend",{},void 0,pgettext("thread poll","Voting")),(0,r.A)("div",{className:"row"},void 0,(0,r.A)("div",{className:"col-xs-12 col-sm-6"},void 0,(0,r.A)(g.A,{label:pgettext("thread poll","Poll length"),helpText:pgettext("thread poll","Enter number of days for which voting in this poll should be possible or zero to run this poll indefinitely."),for:"id_length",validation:this.state.errors.length},void 0,(0,r.A)("input",{className:"form-control",disabled:this.state.isLoading,id:"id_length",onChange:this.bindInput("length"),type:"text",value:this.state.length}))),(0,r.A)("div",{className:"col-xs-12 col-sm-6"},void 0,(0,r.A)(g.A,{label:pgettext("thread poll","Allowed choices"),for:"id_allowed_choices",validation:this.state.errors.allowed_choices},void 0,(0,r.A)("input",{className:"form-control",disabled:this.state.isLoading,id:"id_allowed_choices",onChange:this.bindInput("allowed_choices"),type:"text",maxLength:"255",value:this.state.allowed_choices})))),(0,r.A)("div",{className:"row"},void 0,(0,r.A)(Ve,{bindInput:this.bindInput,disabled:this.state.isLoading,isEdit:this.state.isEdit,value:this.state.is_public}),(0,r.A)("div",{className:"col-xs-12 col-sm-6"},void 0,(0,r.A)(g.A,{label:pgettext("thread poll","Allow vote changes"),for:"id_allow_revotes"},void 0,(0,r.A)(ze.A,{id:"id_allow_revotes",disabled:this.state.isLoading,iconOn:"check",iconOff:"close",labelOn:pgettext("thread poll","Allow participants to change their vote"),labelOff:pgettext("thread poll","Don't allow participants to change their vote"),onChange:this.bindInput("allow_revotes"),value:this.state.allow_revotes})))))),(0,r.A)("div",{className:"panel-footer text-right"},void 0,(0,r.A)("button",{className:"btn btn-default",disabled:this.state.isLoading,onClick:this.onCancel,type:"button"},void 0,pgettext("thread poll","Cancel"))," ",(0,r.A)(Te.A,{className:"btn-primary",loading:this.state.isLoading},void 0,this.state.isEdit?pgettext("thread poll","Save changes"):pgettext("thread poll","Post poll"))))))}}]),i}(A.A);function Ve(e){return e.isEdit?null:(0,r.A)("div",{className:"col-xs-12 col-sm-6"},void 0,(0,r.A)(g.A,{label:pgettext("thread poll","Make voting public"),helpText:pgettext("thread poll","Making voting public will allow everyone to access detailed list of votes, showing which users voted for which choices and at which times. This option can't be changed after poll's creation. Moderators may see voting details for all polls."),for:"id_is_public"},void 0,(0,r.A)(ze.A,{id:"id_is_public",disabled:e.disabled,iconOn:"visibility",iconOff:"visibility_off",labelOn:pgettext("thread poll","Votes are public"),labelOff:pgettext("thread poll","Votes are hidden"),onChange:e.bindInput("is_public"),value:e.value})))}var Ye={changed_title:"edit",pinned_globally:"bookmark",pinned_locally:"bookmark_border",unpinned:"panorama_fish_eye",moved:"arrow_forward",merged:"call_merge",approved:"done",opened:"lock_open",closed:"lock_outline",unhid:"visibility",hid:"visibility_off",changed_owner:"grade",tookover:"grade",added_participant:"person_add",owner_left:"person_outline",participant_left:"person_outline",removed_participant:"remove_circle_outline"};const We=function(e){return(0,r.A)("span",{className:"event-icon-bg"},void 0,(0,r.A)("span",{className:"material-icon"},void 0,Ye[e.post.event_type]))};var Ge=n(93386);function Qe(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,a=(0,p.A)(e);if(t){var i=(0,p.A)(this).constructor;n=Reflect.construct(a,arguments,i)}else n=a.apply(this,arguments);return(0,d.A)(this,n)}}function Ke(e){return e.post.acl.can_hide?(0,r.A)("li",{className:"event-controls"},void 0,f().createElement(Xe,e),f().createElement(Je,e),f().createElement($e,e)):null}var Xe=function(e){(0,c.A)(n,e);var t=Qe(n);function n(){var e;(0,s.A)(this,n);for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return e=t.call.apply(t,[this].concat(i)),(0,h.A)((0,l.A)(e),"onClick",function(){_.A.dispatch(Ge.F6(e.props.post,{is_hidden:!0,hidden_on:H()(),hidden_by_name:e.props.user.username,url:Object.assign(e.props.post.url,{hidden_by:e.props.user.url})})),D.A.patch(e.props.post.api.index,[{op:"replace",path:"is-hidden",value:!0}]).then(function(t){_.A.dispatch(Ge.F6(e.props.post,t))},function(t){400===t.status?k.A.error(t.detail[0]):k.A.apiError(t),_.A.dispatch(Ge.F6(e.props.post,{is_hidden:!1}))})}),e}return(0,u.A)(n,[{key:"render",value:function(){return this.props.post.is_hidden?null:(0,r.A)("button",{type:"button",className:"btn btn-link",onClick:this.onClick},void 0,pgettext("event hide btn","Hide"))}}]),n}(f().Component),Je=function(e){(0,c.A)(n,e);var t=Qe(n);function n(){var e;(0,s.A)(this,n);for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return e=t.call.apply(t,[this].concat(i)),(0,h.A)((0,l.A)(e),"onClick",function(){_.A.dispatch(Ge.F6(e.props.post,{is_hidden:!1})),D.A.patch(e.props.post.api.index,[{op:"replace",path:"is-hidden",value:!1}]).then(function(t){_.A.dispatch(Ge.F6(e.props.post,t))},function(t){400===t.status?k.A.error(t.detail[0]):k.A.apiError(t),_.A.dispatch(Ge.F6(e.props.post,{is_hidden:!0}))})}),e}return(0,u.A)(n,[{key:"render",value:function(){return this.props.post.is_hidden?(0,r.A)("button",{type:"button",className:"btn btn-link",onClick:this.onClick},void 0,pgettext("event reveal btn","Unhide")):null}}]),n}(f().Component),$e=function(e){(0,c.A)(n,e);var t=Qe(n);function n(){var e;(0,s.A)(this,n);for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return e=t.call.apply(t,[this].concat(i)),(0,h.A)((0,l.A)(e),"onClick",function(){window.confirm(pgettext("event delete","Are you sure you wish to delete this event? This action is not reversible!"))&&e.delete()}),(0,h.A)((0,l.A)(e),"delete",function(){_.A.dispatch(Ge.F6(e.props.post,{isDeleted:!0})),D.A.delete(e.props.post.api.index).then(function(){k.A.success(pgettext("event delete","Event has been deleted."))},function(t){400===t.status?k.A.error(t.detail[0]):k.A.apiError(t),_.A.dispatch(Ge.F6(e.props.post,{isDeleted:!1}))})}),e}return(0,u.A)(n,[{key:"render",value:function(){return(0,r.A)("button",{type:"button",className:"btn btn-link",onClick:this.onClick},void 0,pgettext("event delete btn","Delete"))}}]),n}(f().Component),Ze='<span class="item-title">%(user)s</span>',et='<a href="%(url)s" class="item-title">%(user)s</a>';function tt(e){return(0,r.A)("ul",{className:"list-inline event-info"},void 0,f().createElement(nt,e),f().createElement(at,e),f().createElement(Ke,e))}function nt(e){if(e.post.is_hidden){var t;t=e.post.url.hidden_by?interpolate(et,{url:(0,Ae.A)(e.post.url.hidden_by),user:(0,Ae.A)(e.post.hidden_by_name)},!0):interpolate(Ze,{user:(0,Ae.A)(e.post.hidden_by_name)},!0);var n=interpolate('<abbr title="%(absolute)s">%(relative)s</abbr>',{absolute:(0,Ae.A)(e.post.hidden_on.format("LLL")),relative:(0,Ae.A)(e.post.hidden_on.fromNow())},!0),a=interpolate((0,Ae.A)(pgettext("event info","Hidden by %(event_by)s %(event_on)s.")),{event_by:t,event_on:n},!0);return(0,r.A)("li",{className:"event-hidden-message",dangerouslySetInnerHTML:{__html:a}})}return null}function at(e){var t;t=e.post.poster?interpolate(et,{url:(0,Ae.A)(e.post.poster.url),user:(0,Ae.A)(e.post.poster_name)},!0):interpolate(Ze,{user:(0,Ae.A)(e.post.poster_name)},!0);var n=interpolate('<a href="%(url)s" title="%(absolute)s">%(relative)s</a>',{url:(0,Ae.A)(e.post.url.index),absolute:(0,Ae.A)(e.post.posted_on.format("LLL")),relative:(0,Ae.A)(e.post.posted_on.fromNow())},!0),a=interpolate((0,Ae.A)(pgettext("event info","By %(event_by)s %(event_on)s.")),{event_by:t,event_on:n},!0);return(0,r.A)("li",{className:"event-posters",dangerouslySetInnerHTML:{__html:a}})}var it={pinned_globally:pgettext("event message","Thread has been pinned globally."),pinned_locally:pgettext("event message","Thread has been pinned in category."),unpinned:pgettext("event message","Thread has been unpinned."),approved:pgettext("event message","Thread has been approved."),opened:pgettext("event message","Thread has been opened."),closed:pgettext("event message","Thread has been closed."),unhid:pgettext("event message","Thread has been revealed."),hid:pgettext("event message","Thread has been made hidden."),tookover:pgettext("event message","Took thread over."),owner_left:pgettext("event message","Owner has left thread. This thread is now closed."),participant_left:pgettext("event message","Participant has left thread.")},ot='<a href="%(url)s" class="item-title">%(name)s</a>',rt='<span class="item-title">%(name)s</span>';function st(e){return it[e.post.event_type]?(0,r.A)("p",{className:"event-message"},void 0,it[e.post.event_type]):"changed_title"===e.post.event_type?f().createElement(ut,e):"moved"===e.post.event_type?f().createElement(lt,e):"merged"===e.post.event_type?f().createElement(ct,e):"changed_owner"===e.post.event_type?f().createElement(dt,e):"added_participant"===e.post.event_type?f().createElement(pt,e):"removed_participant"===e.post.event_type?f().createElement(ht,e):null}function ut(e){var t=(0,Ae.A)(pgettext("event message","Thread title has been changed from %(old_title)s.")),n=interpolate(rt,{name:(0,Ae.A)(e.post.event_context.old_title)},!0),a=interpolate(t,{old_title:n},!0);return(0,r.A)("p",{className:"event-message",dangerouslySetInnerHTML:{__html:a}})}function lt(e){var t=(0,Ae.A)(pgettext("event message","Thread has been moved from %(from_category)s.")),n=interpolate(ot,{url:(0,Ae.A)(e.post.event_context.from_category.url),name:(0,Ae.A)(e.post.event_context.from_category.name)},!0),a=interpolate(t,{from_category:n},!0);return(0,r.A)("p",{className:"event-message",dangerouslySetInnerHTML:{__html:a}})}function ct(e){var t=(0,Ae.A)(pgettext("event message","The %(merged_thread)s thread has been merged into this thread.")),n=interpolate(rt,{name:(0,Ae.A)(e.post.event_context.merged_thread)},!0),a=interpolate(t,{merged_thread:n},!0);return(0,r.A)("p",{className:"event-message",dangerouslySetInnerHTML:{__html:a}})}function dt(e){var t=(0,Ae.A)(pgettext("event message","Changed thread owner to %(user)s.")),n=interpolate(ot,{url:(0,Ae.A)(e.post.event_context.user.url),name:(0,Ae.A)(e.post.event_context.user.username)},!0),a=interpolate(t,{user:n},!0);return(0,r.A)("p",{className:"event-message",dangerouslySetInnerHTML:{__html:a}})}function pt(e){var t=(0,Ae.A)(pgettext("event message","Added %(user)s to thread.")),n=interpolate(ot,{url:(0,Ae.A)(e.post.event_context.user.url),name:(0,Ae.A)(e.post.event_context.user.username)},!0),a=interpolate(t,{user:n},!0);return(0,r.A)("p",{className:"event-message",dangerouslySetInnerHTML:{__html:a}})}function ht(e){var t=(0,Ae.A)(pgettext("event message","Removed %(user)s from thread.")),n=interpolate(ot,{url:(0,Ae.A)(e.post.event_context.user.url),name:(0,Ae.A)(e.post.event_context.user.username)},!0),a=interpolate(t,{user:n},!0);return(0,r.A)("p",{className:"event-message",dangerouslySetInnerHTML:{__html:a}})}function mt(e){return e.post.is_read?null:(0,r.A)("div",{className:"event-label"},void 0,(0,r.A)("span",{className:"label label-unread"},void 0,pgettext("event unread label","New event")))}var ft=function(e){(0,c.A)(i,e);var t,n,a=(t=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}(),function(){var e,a=(0,p.A)(t);if(n){var i=(0,p.A)(this).constructor;e=Reflect.construct(a,arguments,i)}else e=a.apply(this,arguments);return(0,d.A)(this,e)});function i(e){var t;return(0,s.A)(this,i),t=a.call(this,e),(0,h.A)((0,l.A)(t),"initialize",function(e){t.initialized=!0,t.observer=new IntersectionObserver(function(e){return e.forEach(t.callback)}),t.observer.observe(e)}),(0,h.A)((0,l.A)(t),"callback",function(e){!e.isIntersecting||t.props.post.is_read||t.primed||(window.setTimeout(function(){D.A.post(t.props.post.api.read)},0),t.primed=!0,t.destroy())}),t.initialized=!1,t.primed=!1,t.observer=null,t}return(0,u.A)(i,[{key:"destroy",value:function(){this.observer&&(this.observer.disconnect(),this.observer=null)}},{key:"componentWillUnmount",value:function(){this.destroy()}},{key:"render",value:function(){var e=this,t=!this.initialized&&!this.primed&&!this.props.post.is_read;return f().createElement("div",{className:this.props.className,ref:function(n){n&&t&&e.initialize(n)}},this.props.children)}}]),i}(f().Component);function vt(e){var t="event";return e.post.isDeleted?t="hide":e.post.is_hidden&&(t="event post-hidden"),(0,r.A)("li",{id:"post-"+e.post.id,className:t},void 0,(0,r.A)(mt,{post:e.post}),(0,r.A)("div",{className:"event-body"},void 0,(0,r.A)("div",{className:"event-icon"},void 0,f().createElement(We,e)),(0,r.A)(ft,{className:"event-content",post:e.post},void 0,f().createElement(st,e),f().createElement(tt,e))))}var At=n(29124),gt=n(18524);function yt(e){return(0,r.A)("div",{className:"col-xs-12 col-md-6"},void 0,f().createElement(bt,e),(0,r.A)("div",{className:"post-attachment"},void 0,(0,r.A)("a",{href:e.attachment.url.index,className:"attachment-name item-title",target:"_blank"},void 0,e.attachment.filename),f().createElement(kt,e)))}function bt(e){return e.attachment.is_image?(0,r.A)("div",{className:"post-attachment-preview"},void 0,f().createElement(xt,e)):(0,r.A)("div",{className:"post-attachment-preview"},void 0,f().createElement(Dt,e))}function Dt(e){return(0,r.A)("a",{href:e.attachment.url.index,className:"material-icon"},void 0,"insert_drive_file")}function xt(e){var t=e.attachment.url.thumb||e.attachment.url.index;return(0,r.A)("a",{className:"post-thumbnail",href:e.attachment.url.index,target:"_blank",style:{backgroundImage:'url("'+(0,Ae.A)(t)+'")'}})}function kt(e){var t;t=e.attachment.url.uploader?interpolate('<a href="%(url)s" class="item-title">%(user)s</a>',{url:(0,Ae.A)(e.attachment.url.uploader),user:(0,Ae.A)(e.attachment.uploader_name)},!0):interpolate('<span class="item-title">%(user)s</span>',{user:(0,Ae.A)(e.attachment.uploader_name)},!0);var n=interpolate('<abbr title="%(absolute)s">%(relative)s</abbr>',{absolute:(0,Ae.A)(e.attachment.uploaded_on.format("LLL")),relative:(0,Ae.A)(e.attachment.uploaded_on.fromNow())},!0),a=interpolate((0,Ae.A)(pgettext("post attachment","%(filetype)s, %(size)s, uploaded by %(uploader)s %(uploaded_on)s.")),{filetype:e.attachment.filetype,size:(0,gt.A)(e.attachment.size),uploader:t,uploaded_on:n},!0);return(0,r.A)("p",{className:"post-attachment-description",dangerouslySetInnerHTML:{__html:a}})}function _t(e){return function(e){return(!e.is_hidden||e.acl.can_see_hidden)&&e.attachments}(e.post)?(0,r.A)("div",{className:"post-attachments"},void 0,(0,At.A)(e.post.attachments,2).map(function(e){var t=e.map(function(e){return e?e.id:0}).join("_");return(0,r.A)(Nt,{row:e},t)})):null}function Nt(e){return(0,r.A)("div",{className:"row"},void 0,e.row.map(function(e){return(0,r.A)(yt,{attachment:e},e?e.id:0)}))}var Ct,Et,wt,Ft,Rt,St,Bt,Lt=n(35248);function Tt(e){return e.post.is_hidden&&!e.post.acl.can_see_hidden?f().createElement(Pt,e):e.post.content?f().createElement(Ot,e):f().createElement(It,e)}function Ot(e){var t=e.post,n="@"+(t.poster?t.poster.username:t.poster_name);return(0,r.A)(ft,{className:"post-body",post:t},void 0,(0,r.A)(Lt.A,{author:n,markup:t.content}))}function Pt(e){var t;t=e.post.hidden_by?interpolate('<a href="%(url)s" class="item-title">%(user)s</a>',{url:(0,Ae.A)(e.post.url.hidden_by),user:(0,Ae.A)(e.post.hidden_by_name)},!0):interpolate('<span class="item-title">%(user)s</span>',{user:(0,Ae.A)(e.post.hidden_by_name)},!0);var n=interpolate('<abbr class="last-title" title="%(absolute)s">%(relative)s</abbr>',{absolute:(0,Ae.A)(e.post.hidden_on.format("LLL")),relative:(0,Ae.A)(e.post.hidden_on.fromNow())},!0),a=interpolate((0,Ae.A)(pgettext("post body hidden","Hidden by %(hidden_by)s %(hidden_on)s.")),{hidden_by:t,hidden_on:n},!0);return(0,r.A)(ft,{className:"post-body post-body-hidden",post:e.post},void 0,(0,r.A)("p",{className:"lead"},void 0,pgettext("post body hidden","This post is hidden. You cannot see its contents.")),(0,r.A)("p",{className:"text-muted",dangerouslySetInnerHTML:{__html:a}}))}function It(e){return(0,r.A)(ft,{className:"post-body post-body-invalid",post:e.post},void 0,(0,r.A)("p",{className:"lead"},void 0,pgettext("post body invalid","This post's contents cannot be displayed.")),(0,r.A)("p",{className:"text-muted"},void 0,pgettext("post body invalid","This error is caused by invalid post content manipulation.")))}function qt(e){var t=e.post,n=e.thread,a=e.user;if(!zt(t)||t.id!==n.best_answer)return null;var i;return i=a.id&&n.best_answer_marked_by===a.id?interpolate(pgettext("post best answer flag","Marked as best answer by you %(marked_on)s."),{marked_on:n.best_answer_marked_on.fromNow()},!0):interpolate(pgettext("post best answer flag","Marked as best answer by %(marked_by)s %(marked_on)s."),{marked_by:n.best_answer_marked_by_name,marked_on:n.best_answer_marked_on.fromNow()},!0),(0,r.A)("div",{className:"post-status-message post-status-best-answer"},void 0,Ct||(Ct=(0,r.A)("span",{className:"material-icon"},void 0,"check_box")),(0,r.A)("p",{},void 0,i))}function Ut(e){return zt(e.post)&&e.post.is_hidden?(0,r.A)("div",{className:"post-status-message post-status-hidden"},void 0,Et||(Et=(0,r.A)("span",{className:"material-icon"},void 0,"visibility_off")),(0,r.A)("p",{},void 0,pgettext("post hidden flag","This post is hidden. Only users with permission may see its contents."))):null}function jt(e){return zt(e.post)&&e.post.is_unapproved?(0,r.A)("div",{className:"post-status-message post-status-unapproved"},void 0,wt||(wt=(0,r.A)("span",{className:"material-icon"},void 0,"remove_circle_outline")),(0,r.A)("p",{},void 0,pgettext("post unapproved flag","This post is unapproved. Only users with permission to approve posts and its author may see its contents."))):null}function Mt(e){return zt(e.post)&&e.post.is_protected?(0,r.A)("div",{className:"post-status-message post-status-protected visible-xs-block"},void 0,Ft||(Ft=(0,r.A)("span",{className:"material-icon"},void 0,"lock_outline")),(0,r.A)("p",{},void 0,pgettext("post protected flag","This post is protected. Only moderators may change it."))):null}function zt(e){return!e.is_hidden||e.acl.can_see_hidden}function Ht(e,t,n){D.A.patch(e.post.api.index,t).then(function(t){_.A.dispatch(Ge.F6(e.post,t))},function(t){400===t.status?k.A.error(t.detail[0]):k.A.apiError(t),_.A.dispatch(Ge.F6(e.post,n))})}function Vt(e){var t=e.post,n=e.user;_.A.dispatch(b.yo({best_answer:t.id,best_answer_is_protected:t.is_protected,best_answer_marked_on:H()(),best_answer_marked_by:n.id,best_answer_marked_by_name:n.username,best_answer_marked_by_slug:n.slug})),Yt(e,[{op:"replace",path:"best-answer",value:t.id},{op:"add",path:"acl",value:!0}],{best_answer:e.thread.best_answer,best_answer_is_protected:e.thread.best_answer_is_protected,best_answer_marked_on:e.thread.best_answer_marked_on,best_answer_marked_by:e.thread.best_answer_marked_by,best_answer_marked_by_name:e.thread.best_answer_marked_by_name,best_answer_marked_by_slug:e.thread.best_answer_marked_by_slug})}function Yt(e,t,n){D.A.patch(e.thread.api.index,t).then(function(e){e.best_answer_marked_on&&(e.best_answer_marked_on=H()(e.best_answer_marked_on)),_.A.dispatch(b.yo(e))},function(e){400===e.status?k.A.error(e.detail[0]):k.A.apiError(e),_.A.dispatch(b.yo(n))})}var Wt,Gt,Qt,Kt,Xt=function(e){(0,c.A)(i,e);var t,n,a=(t=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}(),function(){var e,a=(0,p.A)(t);if(n){var i=(0,p.A)(this).constructor;e=Reflect.construct(a,arguments,i)}else e=a.apply(this,arguments);return(0,d.A)(this,e)});function i(e){var t;return(0,s.A)(this,i),(t=a.call(this,e)).state={isReady:!1,error:null,likes:[]},t}return(0,u.A)(i,[{key:"componentDidMount",value:function(){var e=this;D.A.get(this.props.post.api.likes).then(function(t){e.setState({isReady:!0,likes:t.map(Jt)})},function(t){e.setState({isReady:!0,error:t.detail})})}},{key:"render",value:function(){return this.state.error?(0,r.A)($t,{className:"modal-message"},void 0,(0,r.A)($.A,{message:this.state.error})):this.state.isReady?this.state.likes.length?(0,r.A)($t,{className:"modal-sm",likes:this.state.likes},void 0,(0,r.A)(Zt,{likes:this.state.likes})):(0,r.A)($t,{className:"modal-message"},void 0,(0,r.A)($.A,{message:pgettext("post likes modal","No users have liked this post.")})):Rt||(Rt=(0,r.A)($t,{className:"modal-sm"},void 0,(0,r.A)(Z.A,{})))}}]),i}(f().Component);function Jt(e){return Object.assign({},e,{liked_on:H()(e.liked_on)})}function $t(e){var t=e.className,n=e.children,a=e.likes,i=pgettext("post likes modal title","Post Likes");if(a){var o=a.length,s=npgettext("post likes modal","%(likes)s like","%(likes)s likes",o);i=interpolate(s,{likes:o},!0)}return(0,r.A)("div",{className:"modal-dialog "+(t||""),role:"document"},void 0,(0,r.A)("div",{className:"modal-content"},void 0,(0,r.A)("div",{className:"modal-header"},void 0,(0,r.A)("button",{"aria-label":pgettext("modal","Close"),className:"close","data-dismiss":"modal",type:"button"},void 0,St||(St=(0,r.A)("span",{"aria-hidden":"true"},void 0,"Ã—"))),(0,r.A)("h4",{className:"modal-title"},void 0,i)),n))}function Zt(e){return(0,r.A)("div",{className:"modal-body modal-post-likers"},void 0,(0,r.A)("ul",{className:"media-list"},void 0,e.likes.map(function(e){return f().createElement(en,(0,v.A)({key:e.id},e))})))}function en(e){if(e.url){var t={id:e.liker_id,avatars:e.avatars};return(0,r.A)("li",{className:"media"},void 0,(0,r.A)("div",{className:"media-left"},void 0,(0,r.A)("a",{className:"user-avatar",href:e.url},void 0,(0,r.A)(O.Ay,{size:"50",user:t}))),(0,r.A)("div",{className:"media-body"},void 0,(0,r.A)("a",{className:"item-title",href:e.url},void 0,e.username)," ",(0,r.A)(tn,{likedOn:e.liked_on})))}return(0,r.A)("li",{className:"media"},void 0,Bt||(Bt=(0,r.A)("div",{className:"media-left"},void 0,(0,r.A)("span",{className:"user-avatar"},void 0,(0,r.A)(O.Ay,{size:"50"})))),(0,r.A)("div",{className:"media-body"},void 0,(0,r.A)("strong",{},void 0,e.username)," ",(0,r.A)(tn,{likedOn:e.liked_on})))}function tn(e){return(0,r.A)("span",{className:"text-muted",title:e.likedOn.format("LLL")},void 0,e.likedOn.fromNow())}function nn(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,a=(0,p.A)(e);if(t){var i=(0,p.A)(this).constructor;n=Reflect.construct(a,arguments,i)}else n=a.apply(this,arguments);return(0,d.A)(this,n)}}function an(e){return function(e){return(!e.is_hidden||e.acl.can_see_hidden)&&(e.acl.can_reply||e.acl.can_edit||e.acl.can_see_likes&&(e.last_likes||[]).length||e.acl.can_like)}(e.post)?(0,r.A)("div",{className:"post-footer"},void 0,f().createElement(on,e),f().createElement(rn,e),f().createElement(sn,e),f().createElement(un,(0,v.A)({lastLikes:e.post.last_likes,likes:e.post.likes},e)),f().createElement(ln,(0,v.A)({likes:e.post.likes},e)),f().createElement(hn,e),f().createElement(mn,e),f().createElement(fn,e)):null}var on=function(e){(0,c.A)(n,e);var t=nn(n);function n(){var e;(0,s.A)(this,n);for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return e=t.call.apply(t,[this].concat(i)),(0,h.A)((0,l.A)(e),"onClick",function(){Vt(e.props)}),e}return(0,u.A)(n,[{key:"render",value:function(){var e=this.props,t=e.post,n=e.thread;return n.acl.can_mark_best_answer&&t.acl.can_mark_as_best_answer?n.best_answer&&!n.acl.can_change_best_answer?null:(0,r.A)("button",{className:"hidden-xs btn btn-default btn-sm pull-left",disabled:this.props.post.isBusy||t.id===n.best_answer,onClick:this.onClick,type:"button"},void 0,Wt||(Wt=(0,r.A)("span",{className:"material-icon"},void 0,"check_box")),pgettext("post footer btn","Best answer")):null}}]),n}(f().Component),rn=function(e){(0,c.A)(n,e);var t=nn(n);function n(){var e;(0,s.A)(this,n);for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return e=t.call.apply(t,[this].concat(i)),(0,h.A)((0,l.A)(e),"onClick",function(){Vt(e.props)}),e}return(0,u.A)(n,[{key:"render",value:function(){var e=this.props,t=e.post,n=e.thread;return n.acl.can_mark_best_answer&&t.acl.can_mark_as_best_answer?n.best_answer&&!n.acl.can_change_best_answer?null:(0,r.A)("button",{className:"visible-xs-inline-block btn btn-default btn-sm pull-left",disabled:this.props.post.isBusy||t.id===n.best_answer,onClick:this.onClick,type:"button"},void 0,Gt||(Gt=(0,r.A)("span",{className:"material-icon"},void 0,"check_box"))):null}}]),n}(f().Component),sn=function(e){(0,c.A)(n,e);var t=nn(n);function n(){var e;(0,s.A)(this,n);for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return e=t.call.apply(t,[this].concat(i)),(0,h.A)((0,l.A)(e),"onClick",function(){var t,n,a,i;e.props.post.is_liked?function(e){_.A.dispatch(Ge.F6(e.post,{is_liked:!1,likes:e.post.likes-1,last_likes:e.post.last_likes.filter(function(t){return!t.id||t.id!==e.user.id})}));var t={is_liked:e.post.is_liked,likes:e.post.likes,last_likes:e.post.last_likes};Ht(e,[{op:"replace",path:"is-liked",value:!1}],t)}(e.props):(n=(t=e.props).post.last_likes||[],i=(a=[t.user].concat(n)).length>3?a.slice(0,-1):a,_.A.dispatch(Ge.F6(t.post,{is_liked:!0,likes:t.post.likes+1,last_likes:i})),Ht(t,[{op:"replace",path:"is-liked",value:!0}],{is_liked:t.post.is_liked,likes:t.post.likes,last_likes:t.post.last_likes}))}),e}return(0,u.A)(n,[{key:"render",value:function(){if(!this.props.post.acl.can_like)return null;var e="btn btn-default btn-sm pull-left";return this.props.post.is_liked&&(e="btn btn-success btn-sm pull-left"),(0,r.A)("button",{className:e,disabled:this.props.post.isBusy,onClick:this.onClick,type:"button"},void 0,this.props.post.is_liked?pgettext("post footer btn","Liked"):pgettext("post footer btn","Like"))}}]),n}(f().Component),un=function(e){(0,c.A)(n,e);var t=nn(n);function n(){var e;(0,s.A)(this,n);for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return e=t.call.apply(t,[this].concat(i)),(0,h.A)((0,l.A)(e),"onClick",function(){x.A.show((0,r.A)(Xt,{post:e.props.post}))}),e}return(0,u.A)(n,[{key:"render",value:function(){var e=(this.props.post.last_likes||[]).length>0;return this.props.post.acl.can_see_likes&&e?2===this.props.post.acl.can_see_likes?(0,r.A)("button",{className:"btn btn-link btn-sm pull-left hidden-xs",onClick:this.onClick,type:"button"},void 0,cn(this.props.likes,this.props.lastLikes)):(0,r.A)("p",{className:"pull-left hidden-xs"},void 0,cn(this.props.likes,this.props.lastLikes)):null}}]),n}(f().Component),ln=function(e){(0,c.A)(n,e);var t=nn(n);function n(){return(0,s.A)(this,n),t.apply(this,arguments)}return(0,u.A)(n,[{key:"render",value:function(){var e=(this.props.post.last_likes||[]).length>0;return this.props.post.acl.can_see_likes&&e?2===this.props.post.acl.can_see_likes?(0,r.A)("button",{className:"btn btn-link btn-sm likes-compact pull-left visible-xs-block",onClick:this.onClick,type:"button"},void 0,Qt||(Qt=(0,r.A)("span",{className:"material-icon"},void 0,"favorite")),this.props.likes):(0,r.A)("p",{className:"likes-compact pull-left visible-xs-block"},void 0,Kt||(Kt=(0,r.A)("span",{className:"material-icon"},void 0,"favorite")),this.props.likes):null}}]),n}(un);function cn(e,t){var n=t.slice(0,3).map(function(e){return e.username});if(1==n.length)return interpolate(pgettext("post likes","%(user)s likes this."),{user:n[0]},!0);var a=e-n.length,i=n.slice(0,-1).join(", "),o=n.slice(-1)[0],r=interpolate(pgettext("post likes","%(users)s and %(last_user)s"),{users:i,last_user:o},!0);if(0===a)return interpolate(pgettext("post likes","%(users)s like this."),{users:r},!0);var s=npgettext("post likes","%(users)s and %(likes)s other user like this.","%(users)s and %(likes)s other users like this.",a);return interpolate(s,{users:n.join(", "),likes:a},!0)}var dn,pn,hn=function(e){(0,c.A)(n,e);var t=nn(n);function n(){var e;(0,s.A)(this,n);for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return e=t.call.apply(t,[this].concat(i)),(0,h.A)((0,l.A)(e),"onClick",function(){le.A.open({mode:"REPLY",thread:e.props.thread,config:e.props.thread.api.editor,submit:e.props.thread.api.posts.index})}),e}return(0,u.A)(n,[{key:"render",value:function(){return this.props.post.acl.can_reply?(0,r.A)("button",{className:"btn btn-default btn-sm pull-right",type:"button",onClick:this.onClick},void 0,pgettext("post footer btn","Reply")):null}}]),n}(f().Component),mn=function(e){(0,c.A)(n,e);var t=nn(n);function n(){var e;(0,s.A)(this,n);for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return e=t.call.apply(t,[this].concat(i)),(0,h.A)((0,l.A)(e),"onClick",function(){le.A.open({mode:"QUOTE",thread:e.props.thread,config:e.props.thread.api.editor,submit:e.props.thread.api.posts.index,context:{reply:e.props.post.id}})}),e}return(0,u.A)(n,[{key:"render",value:function(){return this.props.post.acl.can_reply?(0,r.A)("button",{className:"btn btn-default btn-sm pull-right",type:"button",onClick:this.onClick},void 0,pgettext("post footer btn","Quote")):null}}]),n}(f().Component),fn=function(e){(0,c.A)(n,e);var t=nn(n);function n(){var e;(0,s.A)(this,n);for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return e=t.call.apply(t,[this].concat(i)),(0,h.A)((0,l.A)(e),"onClick",function(){le.A.open({mode:"EDIT",thread:e.props.thread,post:e.props.post,config:e.props.post.api.editor,submit:e.props.post.api.index})}),e}return(0,u.A)(n,[{key:"render",value:function(){return this.props.post.acl.can_edit?(0,r.A)("button",{className:"hidden-xs btn btn-default btn-sm pull-right",type:"button",onClick:this.onClick},void 0,pgettext("post footer btn","Edit")):null}}]),n}(f().Component);var vn=function(e){(0,c.A)(i,e);var t,n,a=(t=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}(),function(){var e,a=(0,p.A)(t);if(n){var i=(0,p.A)(this).constructor;e=Reflect.construct(a,arguments,i)}else e=a.apply(this,arguments);return(0,d.A)(this,e)});function i(e){var t;return(0,s.A)(this,i),t=a.call(this,e),(0,h.A)((0,l.A)(t),"onUrlChange",function(e){t.changeValue("url",e.target.value)}),t.state={isLoading:!1,url:"",validators:{url:[]},errors:{}},t}return(0,u.A)(i,[{key:"clean",value:function(){return!!this.state.url.trim().length||(k.A.error(pgettext("post move modal","You have to enter link to the other thread.")),!1)}},{key:"send",value:function(){return D.A.post(this.props.thread.api.posts.move,{new_thread:this.state.url,posts:[this.props.post.id]})}},{key:"handleSuccess",value:function(e){_.A.dispatch(Ge.F6(this.props.post,{isDeleted:!0})),x.A.hide(),k.A.success(pgettext("post move modal","Selected post was moved to the other thread."))}},{key:"handleError",value:function(e){400===e.status?k.A.error(e.detail):k.A.apiError(e)}},{key:"render",value:function(){return(0,r.A)("div",{className:"modal-dialog",role:"document"},void 0,(0,r.A)("form",{onSubmit:this.handleSubmit},void 0,(0,r.A)("div",{className:"modal-content"},void 0,dn||(dn=(0,r.A)(An,{})),(0,r.A)("div",{className:"modal-body"},void 0,(0,r.A)(g.A,{for:"id_url",label:pgettext("post move modal field","Link to thread you want to move post to")},void 0,(0,r.A)("input",{className:"form-control",disabled:this.state.isLoading,id:"id_url",onChange:this.onUrlChange,value:this.state.url}))),(0,r.A)("div",{className:"modal-footer"},void 0,(0,r.A)("button",{className:"btn btn-primary",disabled:this.state.isLoading},void 0,pgettext("post move modal btn","Move post"))))))}}]),i}(A.A);function An(e){return(0,r.A)("div",{className:"modal-header"},void 0,(0,r.A)("button",{"aria-label":pgettext("modal","Close"),className:"close","data-dismiss":"modal",type:"button"},void 0,pn||(pn=(0,r.A)("span",{"aria-hidden":"true"},void 0,"Ã—"))),(0,r.A)("h4",{className:"modal-title"},void 0,pgettext("post move modal title","Move post")))}function gn(e){return(0,r.A)("div",{className:"modal-body post-changelog-diff"},void 0,(0,r.A)("ul",{className:"list-unstyled"},void 0,e.diff.map(function(e,t){return(0,r.A)(yn,{item:e},t)})))}function yn(e){return"?"===e.item[0]?null:(0,r.A)("li",{className:(t=e.item,n="diff-item","-"===t[0]?n+=" diff-item-sub":"+"===t[0]&&(n+=" diff-item-add"),n)},void 0,e.item.substr(2));var t,n}var bn,Dn,xn,kn=function(e){(0,c.A)(i,e);var t,n,a=(t=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}(),function(){var e,a=(0,p.A)(t);if(n){var i=(0,p.A)(this).constructor;e=Reflect.construct(a,arguments,i)}else e=a.apply(this,arguments);return(0,d.A)(this,e)});function i(){var e;(0,s.A)(this,i);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return e=a.call.apply(a,[this].concat(n)),(0,h.A)((0,l.A)(e),"onClick",function(){e.props.revertEdit(e.props.edit.id)}),e}return(0,u.A)(i,[{key:"render",value:function(){return this.props.canRevert?(0,r.A)("div",{className:"modal-footer visible-xs-block"},void 0,(0,r.A)(Te.A,{className:"btn-default btn-sm btn-block",disabled:this.props.disabled,onClick:this.onClick,title:pgettext("post revert btn","Revert post to state from before this edit.")},void 0,pgettext("post revert btn","Revert"))):null}}]),i}(f().Component);var _n,Nn,Cn=function(e){(0,c.A)(i,e);var t,n,a=(t=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}(),function(){var e,a=(0,p.A)(t);if(n){var i=(0,p.A)(this).constructor;e=Reflect.construct(a,arguments,i)}else e=a.apply(this,arguments);return(0,d.A)(this,e)});function i(){var e;(0,s.A)(this,i);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return e=a.call.apply(a,[this].concat(n)),(0,h.A)((0,l.A)(e),"goLast",function(){e.props.goToEdit()}),(0,h.A)((0,l.A)(e),"goForward",function(){e.props.goToEdit(e.props.edit.next)}),(0,h.A)((0,l.A)(e),"goBack",function(){e.props.goToEdit(e.props.edit.previous)}),(0,h.A)((0,l.A)(e),"revertEdit",function(){e.props.revertEdit(e.props.edit.id)}),e}return(0,u.A)(i,[{key:"render",value:function(){return(0,r.A)("div",{className:"modal-toolbar post-changelog-toolbar"},void 0,(0,r.A)("div",{className:"row"},void 0,(0,r.A)("div",{className:"col-xs-12 col-sm-4"},void 0,(0,r.A)("div",{className:"row"},void 0,(0,r.A)("div",{className:"col-xs-4"},void 0,(0,r.A)(En,{disabled:this.props.disabled,edit:this.props.edit,onClick:this.goBack})),(0,r.A)("div",{className:"col-xs-4"},void 0,(0,r.A)(wn,{disabled:this.props.disabled,edit:this.props.edit,onClick:this.goForward})),(0,r.A)("div",{className:"col-xs-4"},void 0,(0,r.A)(Fn,{disabled:this.props.disabled,edit:this.props.edit,onClick:this.goLast})))),(0,r.A)("div",{className:"col-xs-12 col-sm-5 xs-margin-top-half post-change-label"},void 0,(0,r.A)(Sn,{edit:this.props.edit})),(0,r.A)(Rn,{canRevert:this.props.canRevert,disabled:this.props.disabled,onClick:this.revertEdit})))}}]),i}(f().Component);function En(e){return(0,r.A)(Te.A,{className:"btn-default btn-block btn-icon btn-sm",disabled:e.disabled||!e.edit.previous,onClick:e.onClick,title:pgettext("post history modal btn","See previous change")},void 0,bn||(bn=(0,r.A)("span",{className:"material-icon"},void 0,"chevron_left")))}function wn(e){return(0,r.A)(Te.A,{className:"btn-default btn-block btn-icon btn-sm",disabled:e.disabled||!e.edit.next,onClick:e.onClick,title:pgettext("post history modal btn","See next change")},void 0,Dn||(Dn=(0,r.A)("span",{className:"material-icon"},void 0,"chevron_right")))}function Fn(e){return(0,r.A)(Te.A,{className:"btn-default btn-block btn-icon btn-sm",disabled:e.disabled||!e.edit.next,onClick:e.onClick,title:pgettext("post history modal btn","See previous change")},void 0,xn||(xn=(0,r.A)("span",{className:"material-icon"},void 0,"last_page")))}function Rn(e){return e.canRevert?(0,r.A)("div",{className:"col-sm-3 hidden-xs"},void 0,(0,r.A)(Te.A,{className:"btn-default btn-sm btn-block",disabled:e.disabled,onClick:e.onClick,title:pgettext("post revert btn","Revert post to state from before this edit.")},void 0,pgettext("post revert btn","Revert"))):null}function Sn(e){var t;t=e.edit.url.editor?interpolate('<a href="%(url)s" class="item-title">%(user)s</a>',{url:(0,Ae.A)(e.edit.url.editor),user:(0,Ae.A)(e.edit.editor_name)},!0):interpolate('<span class="item-title">%(user)s</span>',{user:(0,Ae.A)(e.edit.editor_name)},!0);var n=interpolate('<abbr title="%(absolute)s">%(relative)s</abbr>',{absolute:(0,Ae.A)(e.edit.edited_on.format("LLL")),relative:(0,Ae.A)(e.edit.edited_on.fromNow())},!0),a=interpolate((0,Ae.A)(pgettext("post history modal","By %(edited_by)s %(edited_on)s.")),{edited_by:t,edited_on:n},!0);return(0,r.A)("p",{dangerouslySetInnerHTML:{__html:a}})}var Bn=function(e){(0,c.A)(i,e);var t,n,a=(t=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}(),function(){var e,a=(0,p.A)(t);if(n){var i=(0,p.A)(this).constructor;e=Reflect.construct(a,arguments,i)}else e=a.apply(this,arguments);return(0,d.A)(this,e)});function i(e){var t;return(0,s.A)(this,i),t=a.call(this,e),(0,h.A)((0,l.A)(t),"goToEdit",function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;t.setState({isBusy:!0});var n=t.props.post.api.edits;null!==e&&(n+="?edit="+e),D.A.get(n).then(function(e){var n;t.setState({isReady:!0,isBusy:!1,edit:(n=e,Object.assign({},n,{edited_on:H()(n.edited_on)}))})},function(e){t.setState({isReady:!0,isBusy:!1,error:e.detail})})}),(0,h.A)((0,l.A)(t),"revertEdit",function(e){if(!t.state.isBusy&&window.confirm(pgettext("post revert","Are you sure you with to revert this post to the state from before this edit?"))){t.setState({isBusy:!0});var n=t.props.post.api.edits+"?edit="+e;D.A.post(n).then(function(e){var t=Ge.Qv(e);_.A.dispatch(Ge.F6(e,t)),k.A.success(pgettext("post revert","Post has been reverted to previous state.")),x.A.hide()},function(e){k.A.apiError(e),t.setState({isBusy:!1})})}}),t.state={isReady:!1,isBusy:!0,canRevert:e.post.acl.can_edit,error:null,edit:null},t}return(0,u.A)(i,[{key:"componentDidMount",value:function(){this.goToEdit()}},{key:"render",value:function(){return this.state.error?(0,r.A)(Ln,{className:"modal-dialog modal-message"},void 0,(0,r.A)($.A,{message:this.state.error})):this.state.isReady?(0,r.A)(Ln,{},void 0,(0,r.A)(Cn,{canRevert:this.state.canRevert,disabled:this.state.isBusy,edit:this.state.edit,goToEdit:this.goToEdit,revertEdit:this.revertEdit}),(0,r.A)(gn,{diff:this.state.edit.diff}),(0,r.A)(kn,{canRevert:this.state.canRevert,disabled:this.state.isBusy,edit:this.state.edit,revertEdit:this.revertEdit})):_n||(_n=(0,r.A)(Ln,{},void 0,(0,r.A)(Z.A,{})))}}]),i}(f().Component);function Ln(e){return(0,r.A)("div",{className:e.className||"modal-dialog",role:"document"},void 0,(0,r.A)("div",{className:"modal-content"},void 0,(0,r.A)("div",{className:"modal-header"},void 0,(0,r.A)("button",{"aria-label":pgettext("modal","Close"),className:"close","data-dismiss":"modal",type:"button"},void 0,Nn||(Nn=(0,r.A)("span",{"aria-hidden":"true"},void 0,"Ã—"))),(0,r.A)("h4",{className:"modal-title"},void 0,pgettext("post history modal title","Post edits history"))),e.children))}var Tn,On,Pn,In,qn,Un,jn=n(51828),Mn=n(86511),zn=n(89077);function Hn(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,a=(0,p.A)(e);if(t){var i=(0,p.A)(this).constructor;n=Reflect.construct(a,arguments,i)}else n=a.apply(this,arguments);return(0,d.A)(this,n)}}function Vn(e){return f().createElement(ia,(0,v.A)({},e,{Form:oa}))}var Yn,Wn,Gn,Qn,Kn,Xn,Jn,$n,Zn,ea,ta,na,aa,ia=function(e){(0,c.A)(n,e);var t=Hn(n);function n(e){var a;return(0,s.A)(this,n),(a=t.call(this,e)).state={isLoaded:!1,isError:!1,categories:[]},a}return(0,u.A)(n,[{key:"componentDidMount",value:function(){var e=this;D.A.get(misago.get("THREAD_EDITOR_API")).then(function(t){var n=t.map(function(e){return Object.assign(e,{disabled:!1===e.post,label:e.name,value:e.id,post:e.post})});e.setState({isLoaded:!0,categories:n})},function(t){e.setState({isError:t.detail})})}},{key:"render",value:function(){return this.state.isError?(0,r.A)(sa,{message:this.state.isError}):this.state.isLoaded?f().createElement(oa,(0,v.A)({},this.props,{categories:this.state.categories})):Tn||(Tn=(0,r.A)(ra,{}))}}]),n}(f().Component),oa=function(e){(0,c.A)(n,e);var t=Hn(n);function n(e){var a;return(0,s.A)(this,n),a=t.call(this,e),(0,h.A)((0,l.A)(a),"onCategoryChange",function(e){var t=e.target.value,n={category:t};a.acl[t].can_pin_threads<n.weight&&(n.weight=0),a.acl[t].can_hide_threads||(n.is_hidden=0),a.acl[t].can_close_threads||(n.is_closed=!1),a.setState(n)}),a.state={isLoading:!1,title:"",category:null,categories:e.categories,weight:0,is_hidden:0,is_closed:!1,validators:{title:[zn.mw()]},errors:{}},a.isHiddenChoices=[{value:0,icon:"visibility",label:pgettext("thread hidden switch choice","No")},{value:1,icon:"visibility_off",label:pgettext("thread hidden switch choice","Yes")}],a.isClosedChoices=[{value:!1,icon:"lock_outline",label:pgettext("thread closed switch choice","No")},{value:!0,icon:"lock",label:pgettext("thread closed switch choice","Yes")}],a.acl={},a.props.categories.forEach(function(e){e.post&&(a.state.category||(a.state.category=e.id),a.acl[e.id]={can_pin_threads:e.post.pin,can_close_threads:e.post.close,can_hide_threads:e.post.hide})}),a}return(0,u.A)(n,[{key:"clean",value:function(){return!!this.isValid()||(k.A.error(gettext("Form contains errors.")),this.setState({errors:this.validate()}),!1)}},{key:"send",value:function(){return D.A.post(this.props.thread.api.posts.split,{title:this.state.title,category:this.state.category,weight:this.state.weight,is_hidden:this.state.is_hidden,is_closed:this.state.is_closed,posts:[this.props.post.id]})}},{key:"handleSuccess",value:function(e){_.A.dispatch(Ge.F6(this.props.post,{isDeleted:!0})),x.A.hide(),k.A.success(pgettext("post split modal","Selected post was split into new thread."))}},{key:"handleError",value:function(e){400===e.status?(this.setState({errors:Object.assign({},this.state.errors,e)}),k.A.error(gettext("Form contains errors."))):k.A.apiError(e)}},{key:"getWeightChoices",value:function(){var e=[{value:0,icon:"remove",label:pgettext("thread weight choice","Not pinned")},{value:1,icon:"bookmark_border",label:pgettext("thread weight choice","Pinned in category")}];return 2==this.acl[this.state.category].can_pin_threads&&e.push({value:2,icon:"bookmark",label:pgettext("thread weight choice","Pinned globally")}),e}},{key:"renderWeightField",value:function(){return this.acl[this.state.category].can_pin_threads?(0,r.A)(g.A,{label:pgettext("posts split modal field","Thread weight"),for:"id_weight",labelClass:"col-sm-4",controlClass:"col-sm-8"},void 0,(0,r.A)(Mn.A,{id:"id_weight",onChange:this.bindInput("weight"),value:this.state.weight,choices:this.getWeightChoices()})):null}},{key:"renderHiddenField",value:function(){return this.acl[this.state.category].can_hide_threads?(0,r.A)(g.A,{label:pgettext("posts split modal field","Hide thread"),for:"id_is_hidden",labelClass:"col-sm-4",controlClass:"col-sm-8"},void 0,(0,r.A)(Mn.A,{id:"id_is_closed",onChange:this.bindInput("is_hidden"),value:this.state.is_hidden,choices:this.isHiddenChoices})):null}},{key:"renderClosedField",value:function(){return this.acl[this.state.category].can_close_threads?(0,r.A)(g.A,{label:pgettext("posts split modal field","Close thread"),for:"id_is_closed",labelClass:"col-sm-4",controlClass:"col-sm-8"},void 0,(0,r.A)(Mn.A,{id:"id_is_closed",onChange:this.bindInput("is_closed"),value:this.state.is_closed,choices:this.isClosedChoices})):null}},{key:"render",value:function(){return(0,r.A)(ua,{className:"modal-dialog"},void 0,(0,r.A)("form",{onSubmit:this.handleSubmit},void 0,(0,r.A)("div",{className:"modal-body"},void 0,(0,r.A)(g.A,{label:pgettext("posts split modal field","Thread title"),for:"id_title",labelClass:"col-sm-4",controlClass:"col-sm-8",validation:this.state.errors.title},void 0,(0,r.A)("input",{id:"id_title",className:"form-control",type:"text",onChange:this.bindInput("title"),value:this.state.title})),On||(On=(0,r.A)("div",{className:"clearfix"})),(0,r.A)(g.A,{label:pgettext("posts split modal field","Category"),for:"id_category",labelClass:"col-sm-4",controlClass:"col-sm-8",validation:this.state.errors.category},void 0,(0,r.A)(jn.A,{id:"id_category",onChange:this.onCategoryChange,value:this.state.category,choices:this.state.categories})),Pn||(Pn=(0,r.A)("div",{className:"clearfix"})),this.renderWeightField(),this.renderHiddenField(),this.renderClosedField()),(0,r.A)("div",{className:"modal-footer"},void 0,(0,r.A)(Te.A,{className:"btn-primary",loading:this.state.isLoading},void 0,pgettext("posts split modal btn","Split post")))))}}]),n}(A.A);function ra(){return In||(In=(0,r.A)(ua,{className:"modal-dialog"},void 0,(0,r.A)(Z.A,{})))}function sa(e){return(0,r.A)(ua,{className:"modal-dialog modal-message"},void 0,qn||(qn=(0,r.A)("div",{className:"message-icon"},void 0,(0,r.A)("span",{className:"material-icon"},void 0,"info_outline"))),(0,r.A)("div",{className:"message-body"},void 0,(0,r.A)("p",{className:"lead"},void 0,pgettext("post split modal","You can't move this post at the moment.")),(0,r.A)("p",{},void 0,e.message)))}function ua(e){return(0,r.A)("div",{className:e.className,role:"document"},void 0,(0,r.A)("div",{className:"modal-content"},void 0,(0,r.A)("div",{className:"modal-header"},void 0,(0,r.A)("button",{"aria-label":pgettext("modal","Close"),className:"close","data-dismiss":"modal",type:"button"},void 0,Un||(Un=(0,r.A)("span",{"aria-hidden":"true"},void 0,"Ã—"))),(0,r.A)("h4",{className:"modal-title"},void 0,pgettext("posts split modal title","Split post into new thread"))),e.children))}function la(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,a=(0,p.A)(e);if(t){var i=(0,p.A)(this).constructor;n=Reflect.construct(a,arguments,i)}else n=a.apply(this,arguments);return(0,d.A)(this,n)}}function ca(e){return(0,r.A)("ul",{className:"dropdown-menu dropdown-menu-right stick-to-bottom"},void 0,f().createElement(pa,e),f().createElement(ha,e),f().createElement(ma,e),f().createElement(fa,e),f().createElement(va,e),f().createElement(Aa,e),f().createElement(ga,e),f().createElement(ya,e),f().createElement(ba,e),f().createElement(Da,e),f().createElement(xa,e),f().createElement(ka,e),f().createElement(_a,e))}var da,pa=function(e){(0,c.A)(n,e);var t=la(n);function n(){var e;(0,s.A)(this,n);for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return e=t.call.apply(t,[this].concat(i)),(0,h.A)((0,l.A)(e),"onClick",function(){var t=window.location.protocol+"//";t+=window.location.host,t+=e.props.post.url.index,prompt(pgettext("post permalink","Permament link to this post:"),t)}),e}return(0,u.A)(n,[{key:"render",value:function(){return(0,r.A)("li",{},void 0,(0,r.A)("button",{className:"btn btn-link",onClick:this.onClick,type:"button"},void 0,Yn||(Yn=(0,r.A)("span",{className:"material-icon"},void 0,"link")),pgettext("post options permalink btn","Permament link")))}}]),n}(f().Component),ha=function(e){(0,c.A)(n,e);var t=la(n);function n(){var e;(0,s.A)(this,n);for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return e=t.call.apply(t,[this].concat(i)),(0,h.A)((0,l.A)(e),"onClick",function(){le.A.open({mode:"EDIT",thread:e.props.thread,post:e.props.post,config:e.props.post.api.editor,submit:e.props.post.api.index})}),e}return(0,u.A)(n,[{key:"render",value:function(){return this.props.post.acl.can_edit?(0,r.A)("li",{},void 0,(0,r.A)("button",{className:"btn btn-link",onClick:this.onClick,type:"button"},void 0,Wn||(Wn=(0,r.A)("span",{className:"material-icon"},void 0,"edit")),pgettext("post options edit btn","Edit"))):null}}]),n}(f().Component),ma=function(e){(0,c.A)(n,e);var t=la(n);function n(){var e;(0,s.A)(this,n);for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return e=t.call.apply(t,[this].concat(i)),(0,h.A)((0,l.A)(e),"onClick",function(){Vt(e.props)}),e}return(0,u.A)(n,[{key:"render",value:function(){var e=this.props,t=e.post,n=e.thread;return n.acl.can_mark_best_answer&&t.acl.can_mark_as_best_answer?t.id===n.best_answer||n.best_answer&&!n.acl.can_change_best_answer?null:(0,r.A)("li",{},void 0,(0,r.A)("button",{className:"btn btn-link",onClick:this.onClick,type:"button"},void 0,Gn||(Gn=(0,r.A)("span",{className:"material-icon"},void 0,"check_box")),pgettext("post options best answer btn","Mark as best answer"))):null}}]),n}(f().Component),fa=function(e){(0,c.A)(n,e);var t=la(n);function n(){var e;(0,s.A)(this,n);for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return e=t.call.apply(t,[this].concat(i)),(0,h.A)((0,l.A)(e),"onClick",function(){!function(e){var t=e.post;_.A.dispatch(b.yo({best_answer:null,best_answer_is_protected:!1,best_answer_marked_on:null,best_answer_marked_by:null,best_answer_marked_by_name:null,best_answer_marked_by_slug:null})),Yt(e,[{op:"remove",path:"best-answer",value:t.id},{op:"add",path:"acl",value:!0}],{best_answer:e.thread.best_answer,best_answer_is_protected:e.thread.best_answer_is_protected,best_answer_marked_on:e.thread.best_answer_marked_on,best_answer_marked_by:e.thread.best_answer_marked_by,best_answer_marked_by_name:e.thread.best_answer_marked_by_name,best_answer_marked_by_slug:e.thread.best_answer_marked_by_slug})}(e.props)}),e}return(0,u.A)(n,[{key:"render",value:function(){var e=this.props,t=e.post,n=e.thread;return t.id!==n.best_answer?null:n.acl.can_unmark_best_answer?(0,r.A)("li",{},void 0,(0,r.A)("button",{className:"btn btn-link",onClick:this.onClick,type:"button"},void 0,Qn||(Qn=(0,r.A)("span",{className:"material-icon"},void 0,"check_box_outline_blank")),pgettext("post options best answer btn","Unmark best answer"))):null}}]),n}(f().Component),va=function(e){(0,c.A)(n,e);var t=la(n);function n(){var e;(0,s.A)(this,n);for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return e=t.call.apply(t,[this].concat(i)),(0,h.A)((0,l.A)(e),"onClick",function(){x.A.show((0,r.A)(Bn,{post:e.props.post}))}),e}return(0,u.A)(n,[{key:"render",value:function(){var e=this.props.post.is_hidden&&!this.props.post.acl.can_see_hidden,t=0===this.props.post.edits;if(e||t)return null;var n=npgettext("post edits","This post was edited %(edits)s time.","This post was edited %(edits)s times.",this.props.post.edits);return interpolate(n,{edits:this.props.post.edits},!0),(0,r.A)("li",{},void 0,(0,r.A)("button",{className:"btn btn-link",onClick:this.onClick,type:"button"},void 0,Kn||(Kn=(0,r.A)("span",{className:"material-icon"},void 0,"edit")),pgettext("post options edit btn","Changes history")))}}]),n}(f().Component),Aa=function(e){(0,c.A)(n,e);var t=la(n);function n(){var e;(0,s.A)(this,n);for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return e=t.call.apply(t,[this].concat(i)),(0,h.A)((0,l.A)(e),"onClick",function(){var t;t=e.props,_.A.dispatch(Ge.F6(t.post,{is_unapproved:!1})),Ht(t,[{op:"replace",path:"is-unapproved",value:!1}],{is_unapproved:t.post.is_unapproved})}),e}return(0,u.A)(n,[{key:"render",value:function(){return this.props.post.acl.can_approve&&this.props.post.is_unapproved?(0,r.A)("li",{},void 0,(0,r.A)("button",{className:"btn btn-link",onClick:this.onClick,type:"button"},void 0,Xn||(Xn=(0,r.A)("span",{className:"material-icon"},void 0,"done")),pgettext("post options approve btn","Approve"))):null}}]),n}(f().Component),ga=function(e){(0,c.A)(n,e);var t=la(n);function n(){var e;(0,s.A)(this,n);for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return e=t.call.apply(t,[this].concat(i)),(0,h.A)((0,l.A)(e),"onClick",function(){x.A.show(f().createElement(vn,e.props))}),e}return(0,u.A)(n,[{key:"render",value:function(){return this.props.post.acl.can_move?(0,r.A)("li",{},void 0,(0,r.A)("button",{className:"btn btn-link",onClick:this.onClick,type:"button"},void 0,Jn||(Jn=(0,r.A)("span",{className:"material-icon"},void 0,"arrow_forward")),pgettext("post options move btn","Move"))):null}}]),n}(f().Component),ya=function(e){(0,c.A)(n,e);var t=la(n);function n(){var e;(0,s.A)(this,n);for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return e=t.call.apply(t,[this].concat(i)),(0,h.A)((0,l.A)(e),"onClick",function(){x.A.show(f().createElement(Vn,e.props))}),e}return(0,u.A)(n,[{key:"render",value:function(){return this.props.post.acl.can_move?(0,r.A)("li",{},void 0,(0,r.A)("button",{className:"btn btn-link",onClick:this.onClick,type:"button"},void 0,$n||($n=(0,r.A)("span",{className:"material-icon"},void 0,"call_split")),pgettext("post options split btn","Split"))):null}}]),n}(f().Component),ba=function(e){(0,c.A)(n,e);var t=la(n);function n(){var e;(0,s.A)(this,n);for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return e=t.call.apply(t,[this].concat(i)),(0,h.A)((0,l.A)(e),"onClick",function(){var t;t=e.props,_.A.dispatch(Ge.F6(t.post,{is_protected:!0})),Ht(t,[{op:"replace",path:"is-protected",value:!0}],{is_protected:t.post.is_protected})}),e}return(0,u.A)(n,[{key:"render",value:function(){return this.props.post.acl.can_protect?this.props.post.is_protected?null:(0,r.A)("li",{},void 0,(0,r.A)("button",{className:"btn btn-link",onClick:this.onClick,type:"button"},void 0,Zn||(Zn=(0,r.A)("span",{className:"material-icon"},void 0,"lock_outline")),pgettext("post options protect btn","Protect"))):null}}]),n}(f().Component),Da=function(e){(0,c.A)(n,e);var t=la(n);function n(){var e;(0,s.A)(this,n);for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return e=t.call.apply(t,[this].concat(i)),(0,h.A)((0,l.A)(e),"onClick",function(){var t;t=e.props,_.A.dispatch(Ge.F6(t.post,{is_protected:!1})),Ht(t,[{op:"replace",path:"is-protected",value:!1}],{is_protected:t.post.is_protected})}),e}return(0,u.A)(n,[{key:"render",value:function(){return this.props.post.acl.can_protect&&this.props.post.is_protected?(0,r.A)("li",{},void 0,(0,r.A)("button",{className:"btn btn-link",onClick:this.onClick,type:"button"},void 0,ea||(ea=(0,r.A)("span",{className:"material-icon"},void 0,"lock_open")),pgettext("post options protect btn","Remove protection"))):null}}]),n}(f().Component),xa=function(e){(0,c.A)(n,e);var t=la(n);function n(){var e;(0,s.A)(this,n);for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return e=t.call.apply(t,[this].concat(i)),(0,h.A)((0,l.A)(e),"onClick",function(){var t;t=e.props,_.A.dispatch(Ge.F6(t.post,{is_hidden:!0,hidden_on:H()(),hidden_by_name:t.user.username,url:Object.assign(t.post.url,{hidden_by:t.user.url})})),Ht(t,[{op:"replace",path:"is-hidden",value:!0}],{is_hidden:t.post.is_hidden,hidden_on:t.post.hidden_on,hidden_by_name:t.post.hidden_by_name,url:t.post.url})}),e}return(0,u.A)(n,[{key:"render",value:function(){var e=this.props,t=e.post,n=e.thread;return t.id===n.best_answer?null:t.acl.can_hide?t.is_hidden?null:(0,r.A)("li",{},void 0,(0,r.A)("button",{className:"btn btn-link",onClick:this.onClick,type:"button"},void 0,ta||(ta=(0,r.A)("span",{className:"material-icon"},void 0,"visibility_off")),pgettext("post options hide btn","Hide"))):null}}]),n}(f().Component),ka=function(e){(0,c.A)(n,e);var t=la(n);function n(){var e;(0,s.A)(this,n);for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return e=t.call.apply(t,[this].concat(i)),(0,h.A)((0,l.A)(e),"onClick",function(){var t;t=e.props,_.A.dispatch(Ge.F6(t.post,{is_hidden:!1})),Ht(t,[{op:"replace",path:"is-hidden",value:!1}],{is_hidden:t.post.is_hidden})}),e}return(0,u.A)(n,[{key:"render",value:function(){return this.props.post.acl.can_unhide&&this.props.post.is_hidden?(0,r.A)("li",{},void 0,(0,r.A)("button",{className:"btn btn-link",onClick:this.onClick,type:"button"},void 0,na||(na=(0,r.A)("span",{className:"material-icon"},void 0,"visibility")),pgettext("post options hide btn","Unhide"))):null}}]),n}(f().Component),_a=function(e){(0,c.A)(n,e);var t=la(n);function n(){var e;(0,s.A)(this,n);for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return e=t.call.apply(t,[this].concat(i)),(0,h.A)((0,l.A)(e),"onClick",function(){var t;t=e.props,window.confirm(pgettext("post delete","Are you sure you want to delete this post? This action is not reversible!"))&&(_.A.dispatch(Ge.F6(t.post,{isDeleted:!0})),D.A.delete(t.post.api.index).then(function(){k.A.success(pgettext("post delete","Post has been deleted."))},function(e){400===e.status?k.A.error(e.detail):k.A.apiError(e),_.A.dispatch(Ge.F6(t.post,{isDeleted:!1}))}))}),e}return(0,u.A)(n,[{key:"render",value:function(){var e=this.props,t=e.post,n=e.thread;return t.id===n.best_answer?null:t.acl.can_delete?(0,r.A)("li",{},void 0,(0,r.A)("button",{className:"btn btn-link",onClick:this.onClick,type:"button"},void 0,aa||(aa=(0,r.A)("span",{className:"material-icon"},void 0,"clear")),pgettext("post options delete btn","Delete"))):null}}]),n}(f().Component);function Na(e){return(0,r.A)("div",{className:"pull-right dropdown"},void 0,da||(da=(0,r.A)("button",{"aria-expanded":"true","aria-haspopup":"true",className:"btn btn-default btn-icon dropdown-toggle","data-toggle":"dropdown",type:"button"},void 0,(0,r.A)("span",{className:"material-icon"},void 0,"expand_more"))),f().createElement(ca,e))}var Ca=n(50425);var Ea,wa=function(e){(0,c.A)(i,e);var t,n,a=(t=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}(),function(){var e,a=(0,p.A)(t);if(n){var i=(0,p.A)(this).constructor;e=Reflect.construct(a,arguments,i)}else e=a.apply(this,arguments);return(0,d.A)(this,e)});function i(){var e;(0,s.A)(this,i);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return e=a.call.apply(a,[this].concat(n)),(0,h.A)((0,l.A)(e),"onClick",function(){e.props.post.isSelected?_.A.dispatch(Ca.wm(e.props.post)):_.A.dispatch(Ca.Lt(e.props.post))}),e}return(0,u.A)(i,[{key:"render",value:function(){return this.props.thread.acl.can_merge_posts||(e=this.props.post.acl).can_approve||e.can_hide||e.can_protect||e.can_unhide||e.can_delete||e.can_move?(0,r.A)("div",{className:"pull-right"},void 0,(0,r.A)("button",{className:"btn btn-default btn-icon",onClick:this.onClick,type:"button"},void 0,(0,r.A)("span",{className:"material-icon"},void 0,this.props.post.isSelected?"check_box":"check_box_outline_blank"))):null;var e}}]),i}(f().Component),Fa=n(41467),Ra=n(7050);function Sa(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,a=(0,p.A)(e);if(t){var i=(0,p.A)(this).constructor;n=Reflect.construct(a,arguments,i)}else n=a.apply(this,arguments);return(0,d.A)(this,n)}}function Ba(e){return(0,r.A)("div",{className:"post-heading"},void 0,f().createElement(La,e),f().createElement(Ta,e),f().createElement(Oa,e),f().createElement(Pa,e),f().createElement(Ua,e),f().createElement(ja,e),f().createElement(Ma,e),f().createElement(wa,e),f().createElement(Na,e))}function La(e){return e.post.is_read?null:(0,r.A)("span",{className:"label label-unread hidden-xs"},void 0,pgettext("post unread label","New post"))}function Ta(e){return e.post.is_read?null:(0,r.A)("span",{className:"label label-unread visible-xs-inline-block"},void 0,pgettext("post unread label","New"))}function Oa(e){return(0,r.A)("a",{href:e.post.url.index,className:"btn btn-link posted-on hidden-xs"},void 0,(0,r.A)(Ra.A,{datetime:e.post.posted_on.toISOString()}))}function Pa(e){return(0,r.A)("a",{href:e.post.url.index,className:"btn btn-link posted-on visible-xs-inline-block"},void 0,e.post.posted_on.fromNow())}var Ia,qa,Ua=function(e){(0,c.A)(n,e);var t=Sa(n);function n(){var e;(0,s.A)(this,n);for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return e=t.call.apply(t,[this].concat(i)),(0,h.A)((0,l.A)(e),"onClick",function(){x.A.show((0,r.A)(Bn,{post:e.props.post}))}),e}return(0,u.A)(n,[{key:"render",value:function(){var e=this.props.post.is_hidden&&!this.props.post.acl.can_see_hidden,t=0===this.props.post.edits;if(e||t)return null;var n=npgettext("post edits stat","This post was edited %(edits)s time.","This post was edited %(edits)s times.",this.props.post.edits),a=interpolate(n,{edits:this.props.post.edits},!0),i=npgettext("post edits stat","edited %(edits)s time","edited %(edits)s times",this.props.post.edits);return(0,r.A)("button",{className:"btn btn-link btn-see-edits hidden-xs",onClick:this.onClick,title:a,type:"button"},void 0,interpolate(i,{edits:this.props.post.edits},!0))}}]),n}(f().Component),ja=function(e){(0,c.A)(n,e);var t=Sa(n);function n(){return(0,s.A)(this,n),t.apply(this,arguments)}return(0,u.A)(n,[{key:"render",value:function(){var e=this.props.post.is_hidden&&!this.props.post.acl.can_see_hidden,t=0===this.props.post.edits;if(e||t)return null;var n=npgettext("post edits stat","%(edits)s edit","%(edits)s edits",this.props.post.edits);return(0,r.A)("button",{className:"btn btn-link btn-see-edits visible-xs-inline-block",onClick:this.onClick,type:"button"},void 0,interpolate(n,{edits:this.props.post.edits},!0))}}]),n}(Ua);function Ma(e){var t=e.post.poster&&e.post.poster.id===e.user.id,n=e.post.acl.can_protect;return e.user.id&&e.post.is_protected&&(t||n)?(0,r.A)("span",{className:"label label-protected hidden-xs",title:pgettext("post protected label","This post is protected and may not be edited.")},void 0,Ea||(Ea=(0,r.A)("span",{className:"material-icon"},void 0,"lock_outline")),pgettext("post protected label","protected")):null}function za(e){var t=e.post,n=e.thread;return(0,r.A)("div",{className:"post-side post-side-anonymous"},void 0,(0,r.A)(wa,{post:t,thread:n}),(0,r.A)(Na,{post:t,thread:n}),(0,r.A)("div",{className:"media"},void 0,Ia||(Ia=(0,r.A)("div",{className:"media-left"},void 0,(0,r.A)("span",{},void 0,(0,r.A)(O.Ay,{className:"poster-avatar",size:100})))),(0,r.A)("div",{className:"media-body"},void 0,(0,r.A)("span",{className:"media-heading item-title"},void 0,t.poster_name),(0,r.A)("span",{className:"user-title user-title-anonymous"},void 0,pgettext("post removed poster username","Removed user")))))}function Ha(e){var t=e.title,n=e.rank;return n.is_tab||!!t||!!n.title}function Va(e){var t=e.poster,n=npgettext("poster stats","%(posts)s post","%(posts)s posts",t.posts),a="user-postcount";return Ha(t)&&(a+=" hidden-xs hidden-sm"),(0,r.A)("span",{className:a},void 0,interpolate(n,{posts:t.posts},!0))}function Ya(e){var t=e.poster,n="hidden-xs";return Ha(t)&&(n+=" hidden-sm"),(0,r.A)("span",{className:n},void 0,(0,r.A)(Fa.Ay,{status:t.status},void 0,(0,r.A)(Fa.VX,{status:t.status,user:t})))}function Wa(e){var t=e.rank,n=e.title||t.title;if(!n&&t.is_tab&&(n=t.name),!n)return null;var a="user-title";return t.css_class&&(a+=" user-title-"+t.css_class),t.is_tab?(0,r.A)("div",{className:a},void 0,(0,r.A)("a",{href:t.url},void 0,n)):(0,r.A)("div",{className:a},void 0,n)}function Ga(e){var t=e.post,n=e.thread,a=t.poster;return(0,r.A)("div",{className:"post-side post-side-registered"},void 0,(0,r.A)(wa,{post:t,thread:n}),(0,r.A)(Na,{post:t,thread:n}),(0,r.A)("div",{className:"media"},void 0,(0,r.A)("div",{className:"media-left"},void 0,(0,r.A)("a",{href:a.url},void 0,(0,r.A)(O.Ay,{className:"poster-avatar",size:100,user:a}))),(0,r.A)("div",{className:"media-body"},void 0,(0,r.A)("div",{className:"media-heading"},void 0,(0,r.A)("a",{className:"item-title",href:a.url},void 0,a.username),(0,r.A)(Fa.Ay,{status:a.status},void 0,(0,r.A)(Fa.kW,{status:a.status}))),(0,r.A)(Wa,{rank:a.rank,title:a.title}),(0,r.A)(Ya,{poster:a}),(0,r.A)(Va,{poster:a}))))}function Qa(e){return e.post.poster?f().createElement(Ga,e):f().createElement(za,e)}function Ka(e){var t="post";return e.post.isDeleted?t="hide":e.post.is_hidden&&!e.post.acl.can_see_hidden&&(t="post post-hidden"),e.post.poster&&e.post.poster.rank.css_class&&(t+=" post-"+e.post.poster.rank.css_class),e.post.is_read||(t+=" post-new"),(0,r.A)("li",{id:"post-"+e.post.id,className:t},void 0,(0,r.A)("div",{className:"panel panel-default panel-post"},void 0,(0,r.A)("div",{className:"panel-body"},void 0,f().createElement(Qa,e),(0,r.A)("div",{className:"panel-content"},void 0,f().createElement(Ba,e),f().createElement(qt,e),f().createElement(jt,e),f().createElement(Mt,e),f().createElement(Ut,e),f().createElement(Tt,e),f().createElement(_t,e),f().createElement(an,e)))))}const Xa=function(){return(0,r.A)("li",{className:"post"},void 0,(0,r.A)("div",{className:"panel panel-default panel-post"},void 0,(0,r.A)("div",{className:"panel-body"},void 0,(0,r.A)("div",{className:"post-side post-side-registered"},void 0,(0,r.A)("div",{className:"media"},void 0,qa||(qa=(0,r.A)("div",{className:"media-left"},void 0,(0,r.A)("span",{},void 0,(0,r.A)(O.Ay,{className:"poster-avatar",size:"100"})))),(0,r.A)("div",{className:"media-body"},void 0,(0,r.A)("span",{className:"media-heading item-title"},void 0,(0,r.A)("span",{className:"ui-preview-text",style:{width:"80px"}},void 0,"Â ")),(0,r.A)("span",{className:"user-title user-title-anonymous"},void 0,(0,r.A)("span",{className:"ui-preview-text",style:{width:"60px"}},void 0,"Â "))))),(0,r.A)("div",{className:"panel-content"},void 0,(0,r.A)("div",{className:"post-body"},void 0,(0,r.A)("article",{className:"misago-markup"},void 0,(0,r.A)("p",{className:"ui-preview-text",style:{width:"100%"}},void 0,"Â "),(0,r.A)("p",{className:"ui-preview-text",style:{width:"70%"}},void 0,"Â "),(0,r.A)("p",{className:"ui-preview-text hidden-xs hidden-sm",style:{width:"85%"}},void 0,"Â ")))))))};var Ja;function $a(e){return e.posts.isLoaded?(0,r.A)("ul",{className:"posts-list ui-ready"},void 0,e.posts.results.map(function(t){return f().createElement(Za,(0,v.A)({key:t.id,post:t},e))})):Ja||(Ja=(0,r.A)("ul",{className:"posts-list ui-preview"},void 0,(0,r.A)(Xa,{})))}function Za(e){return e.post.is_event?f().createElement(vt,e):f().createElement(Ka,e)}var ei,ti,ni,ai,ii,oi,ri,si=n(22557),ui=n(39395),li=n(34047),ci=n(48995),di=n(22107);const pi=function(e){var t=e.thread;return(0,r.A)("ul",{className:"thread-flags"},void 0,2==t.weight&&(0,r.A)("li",{className:"thread-flag-pinned-globally",title:pgettext("thread flag","Pinned globally")},void 0,ei||(ei=(0,r.A)("span",{className:"material-icon"},void 0,"bookmark"))),1==t.weight&&(0,r.A)("li",{className:"thread-flag-pinned-locally",title:pgettext("thread flag","Pinned in category")},void 0,ti||(ti=(0,r.A)("span",{className:"material-icon"},void 0,"bookmark_outline"))),t.best_answer&&(0,r.A)("li",{className:"thread-flag-answered",title:pgettext("thread flag","Answered")},void 0,ni||(ni=(0,r.A)("span",{className:"material-icon"},void 0,"check_circle"))),t.has_poll&&(0,r.A)("li",{className:"thread-flag-poll",title:pgettext("thread flag","Poll")},void 0,ai||(ai=(0,r.A)("span",{className:"material-icon"},void 0,"poll"))),(t.is_unapproved||t.has_unapproved_posts)&&(0,r.A)("li",{className:"thread-flag-unapproved",title:t.is_unapproved?pgettext("thread flag","Awaiting approval"):pgettext("thread flag","Has unapproved posts")},void 0,ii||(ii=(0,r.A)("span",{className:"material-icon"},void 0,"visibility"))),t.is_closed&&(0,r.A)("li",{className:"thread-flag-closed",title:pgettext("thread flag","Closed")},void 0,oi||(oi=(0,r.A)("span",{className:"material-icon"},void 0,"lock"))),t.is_hidden&&(0,r.A)("li",{className:"thread-flag-hidden",title:pgettext("thread flag","Hidden")},void 0,ri||(ri=(0,r.A)("span",{className:"material-icon"},void 0,"visibility_off"))))};var hi;const mi=function(e){var t=e.thread;return(0,r.A)("span",{className:"threads-replies",title:interpolate(npgettext("thread replies stat","%(replies)s reply","%(replies)s replies",t.replies),{replies:t.replies},!0)},void 0,hi||(hi=(0,r.A)("span",{className:"material-icon"},void 0,"chat_bubble_outline")),t.replies>980?Math.round(t.replies/1e3)+"K":t.replies)};var fi;const vi=function(e){var t=e.thread;return(0,r.A)("div",{className:"thread-user-card"},void 0,(0,r.A)("div",{className:"thread-user-card-media"},void 0,t.starter?(0,r.A)("a",{href:t.url.starter},void 0,(0,r.A)(O.Ay,{size:40,user:t.starter})):fi||(fi=(0,r.A)(O.Ay,{size:40}))),(0,r.A)("div",{className:"thread-user-card-body"},void 0,(0,r.A)("div",{className:"thread-user-card-header"},void 0,t.starter?(0,r.A)("a",{className:"item-title",href:t.url.starter,title:pgettext("thread starter info","Thread author")},void 0,t.starter.username):(0,r.A)("span",{className:"item-title",title:pgettext("thread starter info","Thread author")},void 0,t.starter_name)),(0,r.A)("div",{},void 0,(0,r.A)("span",{className:"text-muted",title:interpolate(pgettext("thread starter info","Started on: %(timestamp)s"),{timestamp:t.started_on.format("LLL")},!0)},void 0,t.started_on.fromNow()))))};var Ai,gi,yi=n(8041),bi=n(44549);var Di,xi=function(e){(0,c.A)(i,e);var t,n,a=(t=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}(),function(){var e,a=(0,p.A)(t);if(n){var i=(0,p.A)(this).constructor;e=Reflect.construct(a,arguments,i)}else e=a.apply(this,arguments);return(0,d.A)(this,e)});function i(e){var t;return(0,s.A)(this,i),t=a.call(this,e),(0,h.A)((0,l.A)(t),"handleSuccess",function(e){t.handleSuccessUnmounted(e),t.setState({isLoading:!0}),x.A.hide()}),(0,h.A)((0,l.A)(t),"handleSuccessUnmounted",function(e){_.A.dispatch(b._r()),_.A.dispatch(b.yo(e))}),(0,h.A)((0,l.A)(t),"handleError",function(e){_.A.dispatch(b._r()),400===e.status?k.A.error(e.detail[0]):k.A.apiError(e)}),(0,h.A)((0,l.A)(t),"onChange",function(e){t.changeValue("title",e.target.value)}),t.state={isLoading:!1,title:e.thread.title,validators:{title:(0,bi.oB)()},errors:{}},t}return(0,u.A)(i,[{key:"clean",value:function(){if(!this.state.title.trim().length)return k.A.error(pgettext("thread title form","You have to enter thread title.")),!1;var e=this.validate();return!e.title||(k.A.error(e.title[0]),!1)}},{key:"send",value:function(){return _.A.dispatch(b.S2()),D.A.patch(this.props.thread.api.index,[{op:"replace",path:"title",value:this.state.title}])}},{key:"render",value:function(){return(0,r.A)("div",{className:"modal-dialog modal-lg",role:"document"},void 0,(0,r.A)("form",{onSubmit:this.handleSubmit},void 0,(0,r.A)("div",{className:"modal-content"},void 0,Ai||(Ai=(0,r.A)(ki,{})),(0,r.A)("div",{className:"modal-body"},void 0,(0,r.A)(g.A,{for:"id_modal_title",label:pgettext("thread title form field","Thread title")},void 0,(0,r.A)("input",{className:"form-control",disabled:this.state.isLoading||this.props.thread.isBusy,id:"id_modal_title",onChange:this.onChange,value:this.state.title}))),(0,r.A)("div",{className:"modal-footer"},void 0,(0,r.A)("button",{className:"btn btn-default","data-dismiss":"modal",disabled:this.state.isLoading,type:"button"},void 0,pgettext("thread title form btn","Cancel")),(0,r.A)("button",{className:"btn btn-primary",disabled:this.state.isLoading||this.props.thread.isBusy},void 0,pgettext("thread title form btn","Change title"))))))}}]),i}(A.A);function ki(e){return(0,r.A)("div",{className:"modal-header"},void 0,(0,r.A)("button",{"aria-label":pgettext("modal","Close"),className:"close","data-dismiss":"modal",type:"button"},void 0,gi||(gi=(0,r.A)("span",{"aria-hidden":"true"},void 0,"Ã—"))),(0,r.A)("h4",{className:"modal-title"},void 0,pgettext("thread title form title","Change title")))}var _i,Ni,Ci=function(e){(0,c.A)(i,e);var t,n,a=(t=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}(),function(){var e,a=(0,p.A)(t);if(n){var i=(0,p.A)(this).constructor;e=Reflect.construct(a,arguments,i)}else e=a.apply(this,arguments);return(0,d.A)(this,e)});function i(e){var t;return(0,s.A)(this,i),t=a.call(this,e),(0,h.A)((0,l.A)(t),"handleSuccess",function(e){t.props.onSuccess(e),x.A.hide()}),(0,h.A)((0,l.A)(t),"handleError",function(e){t.props.onError(e)}),(0,h.A)((0,l.A)(t),"onBestAnswerChange",function(e){t.changeValue("bestAnswer",e.target.value)}),(0,h.A)((0,l.A)(t),"onPollChange",function(e){t.changeValue("poll",e.target.value)}),t.state={isLoading:!1,bestAnswer:"0",poll:"0"},t}return(0,u.A)(i,[{key:"clean",value:function(){return!this.props.polls||"0"!==this.state.poll||window.confirm(pgettext("merge threads conflict form","Are you sure you want to delete all polls?"))}},{key:"send",value:function(){var e=Object.assign({},this.props.data,{best_answer:this.state.bestAnswer,poll:this.state.poll});return D.A.post(this.props.api,e)}},{key:"render",value:function(){return(0,r.A)("div",{className:"modal-dialog",role:"document"},void 0,(0,r.A)("div",{className:"modal-content"},void 0,(0,r.A)("div",{className:"modal-header"},void 0,(0,r.A)("button",{"aria-label":pgettext("modal","Close"),className:"close","data-dismiss":"modal",type:"button"},void 0,Di||(Di=(0,r.A)("span",{"aria-hidden":"true"},void 0,"Ã—"))),(0,r.A)("h4",{className:"modal-title"},void 0,pgettext("merge threads conflict modal title","Merge threads"))),(0,r.A)("form",{onSubmit:this.handleSubmit},void 0,(0,r.A)("div",{className:"modal-body"},void 0,(0,r.A)(Ei,{choices:this.props.bestAnswers,onChange:this.onBestAnswerChange,value:this.state.bestAnswer}),(0,r.A)(wi,{choices:this.props.polls,onChange:this.onPollChange,value:this.state.poll})),(0,r.A)("div",{className:"modal-footer"},void 0,(0,r.A)("button",{className:"btn btn-default","data-dismiss":"modal",disabled:this.state.isLoading,type:"button"},void 0,pgettext("merge threads conflict btn","Cancel")),(0,r.A)(Te.A,{className:"btn-primary",loading:this.state.isLoading},void 0,pgettext("merge threads conflict btn","Merge threads"))))))}}]),i}(A.A);function Ei(e){var t=e.choices,n=e.onChange,a=e.value;return t?(0,r.A)(g.A,{label:pgettext("merge threads conflict best answer","Best answer"),helpText:pgettext("merge threads conflict best answer","Select the best answer for your newly merged thread. No posts will be deleted during the merge."),for:"id_best_answer"},void 0,(0,r.A)("select",{className:"form-control",id:"id_best_answer",onChange:n,value:a},void 0,t.map(function(e){return(0,r.A)("option",{value:e[0]},e[0],e[1])}))):null}function wi(e){var t=e.choices,n=e.onChange,a=e.value;return t?(0,r.A)(g.A,{label:pgettext("merge threads conflict poll","Poll"),helpText:pgettext("merge threads conflict poll","Select the poll for your newly merged thread. Rejected polls will be permanently deleted and cannot be recovered."),for:"id_poll"},void 0,(0,r.A)("select",{className:"form-control",id:"id_poll",onChange:n,value:a},void 0,t.map(function(e){return(0,r.A)("option",{value:e[0]},e[0],e[1])}))):null}var Fi,Ri,Si,Bi,Li,Ti,Oi=function(e){(0,c.A)(i,e);var t,n,a=(t=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}(),function(){var e,a=(0,p.A)(t);if(n){var i=(0,p.A)(this).constructor;e=Reflect.construct(a,arguments,i)}else e=a.apply(this,arguments);return(0,d.A)(this,e)});function i(e){var t;return(0,s.A)(this,i),t=a.call(this,e),(0,h.A)((0,l.A)(t),"handleSuccess",function(e){t.handleSuccessUnmounted(e),t.setState({isLoading:!0})}),(0,h.A)((0,l.A)(t),"handleSuccessUnmounted",function(e){k.A.success(pgettext("thread merge form","Thread has been merged with other one.")),window.location=e.url}),(0,h.A)((0,l.A)(t),"handleError",function(e){_.A.dispatch(b._r()),400===e.status?e.best_answers||e.polls?x.A.show((0,r.A)(Ci,{api:t.props.thread.api.merge,bestAnswers:e.best_answers,data:{other_thread:t.state.url},polls:e.polls,onError:t.handleError,onSuccess:t.handleSuccessUnmounted})):e.best_answer?k.A.error(e.best_answer[0]):e.poll?k.A.error(e.poll[0]):k.A.error(e.detail):k.A.apiError(e)}),(0,h.A)((0,l.A)(t),"onUrlChange",function(e){t.changeValue("url",e.target.value)}),t.state={isLoading:!1,url:"",validators:{url:[]},errors:{}},t}return(0,u.A)(i,[{key:"clean",value:function(){return!!this.state.url.trim().length||(k.A.error(pgettext("thread merge form","You have to enter link to the other thread.")),!1)}},{key:"send",value:function(){return _.A.dispatch(b.S2()),D.A.post(this.props.thread.api.merge,{other_thread:this.state.url})}},{key:"render",value:function(){return(0,r.A)("div",{className:"modal-dialog",role:"document"},void 0,(0,r.A)("form",{onSubmit:this.handleSubmit},void 0,(0,r.A)("div",{className:"modal-content"},void 0,_i||(_i=(0,r.A)(Pi,{})),(0,r.A)("div",{className:"modal-body"},void 0,(0,r.A)(g.A,{for:"id_url",label:pgettext("thread merge form field","Link to thread you want to merge with"),help_text:pgettext("thread merge form field","Merge will delete current thread and move its contents to the thread specified here.")},void 0,(0,r.A)("input",{className:"form-control",disabled:this.state.isLoading||this.props.thread.isBusy,id:"id_url",onChange:this.onUrlChange,value:this.state.url}))),(0,r.A)("div",{className:"modal-footer"},void 0,(0,r.A)("button",{className:"btn btn-default","data-dismiss":"modal",disabled:this.state.isLoading,type:"button"},void 0,pgettext("thread merge form btn","Cancel")),(0,r.A)("button",{className:"btn btn-primary",disabled:this.state.isLoading||this.props.thread.isBusy},void 0,pgettext("thread merge form btn","Merge thread"))))))}}]),i}(A.A);function Pi(e){return(0,r.A)("div",{className:"modal-header"},void 0,(0,r.A)("button",{"aria-label":pgettext("modal","Close"),className:"close","data-dismiss":"modal",type:"button"},void 0,Ni||(Ni=(0,r.A)("span",{"aria-hidden":"true"},void 0,"Ã—"))),(0,r.A)("h4",{className:"modal-title"},void 0,pgettext("thread merge form title","Merge thread")))}var Ii,qi,Ui,ji,Mi,zi,Hi,Vi,Yi,Wi,Gi,Qi,Ki=function(e){(0,c.A)(i,e);var t,n,a=(t=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}(),function(){var e,a=(0,p.A)(t);if(n){var i=(0,p.A)(this).constructor;e=Reflect.construct(a,arguments,i)}else e=a.apply(this,arguments);return(0,d.A)(this,e)});function i(e){var t;return(0,s.A)(this,i),t=a.call(this,e),(0,h.A)((0,l.A)(t),"onCategoryChange",function(e){t.changeValue("category",e.target.value)}),t.state={isReady:!1,isLoading:!1,isError:!1,category:null,categories:[]},t}return(0,u.A)(i,[{key:"componentDidMount",value:function(){var e=this;D.A.get(F.A.get("THREAD_EDITOR_API")).then(function(t){var n=null,a=t.map(function(e){return!1===e.post||n||(n=e.id),Object.assign(e,{disabled:!1===e.post,label:e.name,value:e.id})});e.setState({isReady:!0,category:n,categories:a})},function(t){e.setState({isError:t.detail})})}},{key:"send",value:function(){return _.A.dispatch(b.S2()),D.A.patch(this.props.thread.api.index,[{op:"replace",path:"category",value:this.state.category}])}},{key:"handleSuccess",value:function(){D.A.get(this.props.thread.api.posts.index,{page:this.props.posts.page}).then(function(e){_.A.dispatch(b.HC(e)),_.A.dispatch(Ca.Hh(e.post_set)),_.A.dispatch(b._r()),k.A.success(pgettext("thread move form","Thread has been moved.")),x.A.hide()},function(e){_.A.dispatch(b._r()),k.A.apiError(e)})}},{key:"handleError",value:function(e){400===e.status?k.A.error(e.detail[0]):k.A.apiError(e)}},{key:"render",value:function(){return this.state.isReady?(0,r.A)("div",{className:"modal-dialog",role:"document"},void 0,(0,r.A)("form",{onSubmit:this.handleSubmit},void 0,(0,r.A)("div",{className:"modal-content"},void 0,Fi||(Fi=(0,r.A)(Xi,{})),(0,r.A)("div",{className:"modal-body"},void 0,(0,r.A)(g.A,{for:"id_category",label:pgettext("thread move form field","New category")},void 0,(0,r.A)(jn.A,{choices:this.state.categories,disabled:this.state.isLoading||this.props.thread.isBusy,id:"id_category",onChange:this.onCategoryChange,value:this.state.category}))),(0,r.A)("div",{className:"modal-footer"},void 0,(0,r.A)("button",{className:"btn btn-default","data-dismiss":"modal",disabled:this.state.isLoading,type:"button"},void 0,pgettext("thread move form btn","Cancel")),(0,r.A)("button",{className:"btn btn-primary",disabled:this.state.isLoading||this.props.thread.isBusy},void 0,pgettext("thread move form btn","Move thread")))))):this.state.isError?(0,r.A)($i,{message:this.state.isError}):Ri||(Ri=(0,r.A)(Ji,{}))}}]),i}(A.A);function Xi(e){return(0,r.A)("div",{className:"modal-header"},void 0,(0,r.A)("button",{"aria-label":pgettext("modal","Close"),className:"close","data-dismiss":"modal",type:"button"},void 0,Si||(Si=(0,r.A)("span",{"aria-hidden":"true"},void 0,"Ã—"))),(0,r.A)("h4",{className:"modal-title"},void 0,pgettext("thread move form title","Move thread")))}function Ji(e){return Bi||(Bi=(0,r.A)("div",{className:"modal-dialog",role:"document"},void 0,(0,r.A)("div",{className:"modal-content"},void 0,(0,r.A)(Xi,{}),(0,r.A)(Z.A,{}))))}function $i(e){return(0,r.A)("div",{className:"modal-dialog modal-message",role:"document"},void 0,(0,r.A)("div",{className:"modal-content"},void 0,Li||(Li=(0,r.A)(Xi,{})),Ti||(Ti=(0,r.A)("div",{className:"message-icon"},void 0,(0,r.A)("span",{className:"material-icon"},void 0,"info_outline"))),(0,r.A)("div",{className:"message-body"},void 0,(0,r.A)("p",{className:"lead"},void 0,pgettext("thread move form","You can't move this thread at the moment.")),(0,r.A)("p",{},void 0,e.message),(0,r.A)("button",{className:"btn btn-default","data-dismiss":"modal",type:"button"},void 0,pgettext("thread move form dismiss btn","Ok")))))}var Zi=function(e){(0,c.A)(i,e);var t,n,a=(t=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}(),function(){var e,a=(0,p.A)(t);if(n){var i=(0,p.A)(this).constructor;e=Reflect.construct(a,arguments,i)}else e=a.apply(this,arguments);return(0,d.A)(this,e)});function i(){var e;(0,s.A)(this,i);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return e=a.call.apply(a,[this].concat(n)),(0,h.A)((0,l.A)(e),"callApi",function(t,n){_.A.dispatch(b.S2()),t.push({op:"add",path:"acl",value:!0}),D.A.patch(e.props.thread.api.index,t).then(function(e){_.A.dispatch(b.yo(e)),_.A.dispatch(b._r()),k.A.success(n)},function(e){_.A.dispatch(b._r()),400===e.status?k.A.error(e.detail[0]):k.A.apiError(e)})}),(0,h.A)((0,l.A)(e),"changeTitle",function(){x.A.show((0,r.A)(xi,{thread:e.props.thread}))}),(0,h.A)((0,l.A)(e),"pinGlobally",function(){e.callApi([{op:"replace",path:"weight",value:2}],pgettext("thread moderation","Thread has been pinned globally."))}),(0,h.A)((0,l.A)(e),"pinLocally",function(){e.callApi([{op:"replace",path:"weight",value:1}],pgettext("thread moderation","Thread has been pinned in category."))}),(0,h.A)((0,l.A)(e),"unpin",function(){e.callApi([{op:"replace",path:"weight",value:0}],pgettext("thread moderation","Thread has been unpinned."))}),(0,h.A)((0,l.A)(e),"approve",function(){e.callApi([{op:"replace",path:"is-unapproved",value:!1}],pgettext("thread moderation","Thread has been approved."))}),(0,h.A)((0,l.A)(e),"open",function(){e.callApi([{op:"replace",path:"is-closed",value:!1}],gettext("Thread has been opened."))}),(0,h.A)((0,l.A)(e),"close",function(){e.callApi([{op:"replace",path:"is-closed",value:!0}],pgettext("thread moderation","Thread has been closed."))}),(0,h.A)((0,l.A)(e),"unhide",function(){e.callApi([{op:"replace",path:"is-hidden",value:!1}],pgettext("thread moderation","Thread has been made visible."))}),(0,h.A)((0,l.A)(e),"hide",function(){e.callApi([{op:"replace",path:"is-hidden",value:!0}],pgettext("thread moderation","Thread has been made hidden."))}),(0,h.A)((0,l.A)(e),"move",function(){x.A.show((0,r.A)(Ki,{posts:e.props.posts,thread:e.props.thread}))}),(0,h.A)((0,l.A)(e),"merge",function(){x.A.show((0,r.A)(Oi,{thread:e.props.thread}))}),(0,h.A)((0,l.A)(e),"delete",function(){window.confirm(pgettext("thread moderation","Are you sure you want to delete this thread?"))&&(_.A.dispatch(b.S2()),D.A.delete(e.props.thread.api.index).then(function(t){k.A.success(pgettext("thread moderation","Thread has been deleted.")),window.location=e.props.thread.category.url.index},function(e){_.A.dispatch(b._r()),k.A.apiError(e)}))}),e}return(0,u.A)(i,[{key:"render",value:function(){var e=this.props.moderation;return(0,r.A)("ul",{className:"dropdown-menu dropdown-menu-right stick-to-bottom"},void 0,!!e.edit&&(0,r.A)("li",{},void 0,(0,r.A)("button",{className:"btn btn-link",onClick:this.changeTitle,type:"button"},void 0,Ii||(Ii=(0,r.A)("span",{className:"material-icon"},void 0,"edit")),pgettext("thread moderation btn","Change title"))),!!e.pinGlobally&&(0,r.A)("li",{},void 0,(0,r.A)("button",{className:"btn btn-link",onClick:this.pinGlobally,type:"button"},void 0,qi||(qi=(0,r.A)("span",{className:"material-icon"},void 0,"bookmark")),pgettext("thread moderation btn","Pin globally"))),!!e.pinLocally&&(0,r.A)("li",{},void 0,(0,r.A)("button",{className:"btn btn-link",onClick:this.pinLocally,type:"button"},void 0,Ui||(Ui=(0,r.A)("span",{className:"material-icon"},void 0,"bookmark_border")),pgettext("thread moderation btn","Pin in category"))),!!e.unpin&&(0,r.A)("li",{},void 0,(0,r.A)("button",{className:"btn btn-link",onClick:this.unpin,type:"button"},void 0,ji||(ji=(0,r.A)("span",{className:"material-icon"},void 0,"panorama_fish_eye")),pgettext("thread moderation btn","Unpin"))),!!e.move&&(0,r.A)("li",{},void 0,(0,r.A)("button",{className:"btn btn-link",onClick:this.move,type:"button"},void 0,Mi||(Mi=(0,r.A)("span",{className:"material-icon"},void 0,"arrow_forward")),pgettext("thread moderation btn","Move"))),!!e.merge&&(0,r.A)("li",{},void 0,(0,r.A)("button",{className:"btn btn-link",onClick:this.merge,type:"button"},void 0,zi||(zi=(0,r.A)("span",{className:"material-icon"},void 0,"call_merge")),pgettext("thread moderation btn","Merge"))),!!e.approve&&(0,r.A)("li",{},void 0,(0,r.A)("button",{className:"btn btn-link",onClick:this.approve,type:"button"},void 0,Hi||(Hi=(0,r.A)("span",{className:"material-icon"},void 0,"done")),pgettext("thread moderation btn","Approve"))),!!e.open&&(0,r.A)("li",{},void 0,(0,r.A)("button",{className:"btn btn-link",onClick:this.open,type:"button"},void 0,Vi||(Vi=(0,r.A)("span",{className:"material-icon"},void 0,"lock_open")),pgettext("thread moderation btn","Open"))),!!e.close&&(0,r.A)("li",{},void 0,(0,r.A)("button",{className:"btn btn-link",onClick:this.close,type:"button"},void 0,Yi||(Yi=(0,r.A)("span",{className:"material-icon"},void 0,"lock_outline")),pgettext("thread moderation btn","Close"))),!!e.unhide&&(0,r.A)("li",{},void 0,(0,r.A)("button",{className:"btn btn-link",onClick:this.unhide,type:"button"},void 0,Wi||(Wi=(0,r.A)("span",{className:"material-icon"},void 0,"visibility")),pgettext("thread moderation btn","Unhide"))),!!e.hide&&(0,r.A)("li",{},void 0,(0,r.A)("button",{className:"btn btn-link",onClick:this.hide,type:"button"},void 0,Gi||(Gi=(0,r.A)("span",{className:"material-icon"},void 0,"visibility_off")),pgettext("thread moderation btn","Hide"))),!!e.delete&&(0,r.A)("li",{},void 0,(0,r.A)("button",{className:"btn btn-link",onClick:this.delete,type:"button"},void 0,Qi||(Qi=(0,r.A)("span",{className:"material-icon"},void 0,"clear")),pgettext("thread moderation btn","Delete"))))}}]),i}(f().Component);const eo=Zi;var to;const no=function(e){var t=e.thread,n=e.posts,a=e.moderation;return(0,r.A)("div",{className:"dropdown"},void 0,(0,r.A)("button",{type:"button",className:"btn btn-default btn-outline btn-icon dropdown-toggle",title:pgettext("thread options btn","Thread options"),"data-toggle":"dropdown","aria-haspopup":"true","aria-expanded":"false",disabled:t.isBusy},void 0,to||(to=(0,r.A)("span",{className:"material-icon"},void 0,"settings"))),(0,r.A)(eo,{thread:t,posts:n,moderation:a}))};var ao,io,oo,ro=n(32485),so=n.n(ro),uo=n(65407),lo=n(25913);const co=(0,o.Ng)()(function(e){var t=e.dispatch,n=e.dropup,a=e.stickToBottom,i=e.thread;return(0,r.A)(uo.u,{url:i.api.watch},void 0,function(e,o){var s,u=o.loading;function l(n){i.notifications!==n&&(t((0,b.yo)({notifications:n})),e({json:{notifications:n},onError:function(e){k.A.apiError(e),t((0,b.yo)({notifications:i.notifications}))}}))}return(0,r.A)("div",{className:n?"dropup":"dropdown"},void 0,(0,r.A)("button",{className:"btn btn-default btn-outline btn-block","aria-expanded":"true","aria-haspopup":"true","data-toggle":"dropdown",type:"button"},void 0,(0,r.A)("span",{className:"material-icon"},void 0,2===(s=i.notifications)?"mail":1===s?"notifications_active":"notifications_none"),function(e){return e?pgettext("watch thread","Watching"):pgettext("watch thread","Watch")}(i.notifications)),(0,r.A)("ul",{className:so()("dropdown-menu dropdown-menu-right",{"stick-to-bottom":a})},void 0,(0,r.A)(lo.dX,{},void 0,pgettext("watch thread","Notify about new replies")),(0,r.A)("li",{},void 0,(0,r.A)("button",{className:"btn btn-link",disabled:u,onClick:function(){return l(2)}},void 0,ao||(ao=(0,r.A)("span",{className:"material-icon"},void 0,"mail")),pgettext("watch thread","On site and with e-mail"))),(0,r.A)("li",{},void 0,(0,r.A)("button",{className:"btn btn-link",disabled:u,onClick:function(){return l(1)}},void 0,io||(io=(0,r.A)("span",{className:"material-icon"},void 0,"notifications_active")),pgettext("watch thread","On site only"))),(0,r.A)("li",{},void 0,(0,r.A)("button",{className:"btn btn-link",disabled:u,onClick:function(){return l(0)}},void 0,oo||(oo=(0,r.A)("span",{className:"material-icon"},void 0,"notifications_none")),pgettext("watch thread","Don't notify")))))})}),po=function(e){var t=e.children,n=e.className;return(0,r.A)("ul",{className:so()("breadcrumbs",n)},void 0,t)},ho=function(e){var t=e.category,n=e.className;return(0,r.A)("li",{className:so()("breadcrumbs-item",n)},void 0,(0,r.A)("a",{href:t.url.index},void 0,(0,r.A)("span",{className:"material-icon",style:{color:t.color||"inherit"}},void 0,"label"),!!t.short_name&&(0,r.A)("span",{className:"breadcrumbs-item-name hidden-sm hidden-md hidden-lg",title:t.name},void 0,t.short_name),!!t.short_name&&(0,r.A)("span",{className:"breadcrumbs-item-name hidden-xs"},void 0,t.name),!t.short_name&&(0,r.A)("span",{className:"breadcrumbs-item-name"},void 0,t.name)))};var mo;const fo=function(e){var t=e.category,n=e.className;return(0,r.A)("li",{className:so()("breadcrumbs-item",n)},void 0,(0,r.A)("a",{href:t.url.index},void 0,mo||(mo=(0,r.A)("span",{className:"material-icon"},void 0,"chevron_right")),(0,r.A)("span",{className:"breadcrumbs-item-name"},void 0,"root_category"===t.special_role?pgettext("breadcrumb","Threads"):pgettext("breadcrumb","Private threads"))))},vo=function(e){var t=e.breadcrumbs;return(0,r.A)(po,{},void 0,t.map(function(e){return e.special_role?(0,r.A)(fo,{category:e},e.id):(0,r.A)(ho,{category:e},e.id)}))};var Ao;const go=function(e){var t=e.styleName,n=e.thread,a=e.posts,i=e.user,o=e.moderation;return(0,r.A)(yi.ud,{},void 0,(0,r.A)(yi.zY,{styleName:t},void 0,(0,r.A)(yi.d4,{styleName:t},void 0,(0,r.A)(vo,{breadcrumbs:n.path}),(0,r.A)("h1",{},void 0,n.title)),(0,r.A)(yi.Le,{className:"page-header-thread-details"},void 0,(0,r.A)(di.Ye,{},void 0,(0,r.A)(di.P3,{auto:!0},void 0,(0,r.A)(di.MT,{shrink:!0},void 0,(0,r.A)(vi,{thread:n})),Ao||(Ao=(0,r.A)(di.MT,{auto:!0})),n.replies>0&&(0,r.A)(di.MT,{shrink:!0},void 0,(0,r.A)(mi,{thread:n})),function(e){return e.is_closed||e.is_hidden||e.is_unapproved||e.weight>0||e.best_answer||e.has_poll||e.has_unapproved_posts}(n)&&(0,r.A)(di.MT,{shrink:!0},void 0,(0,r.A)(pi,{thread:n}))),i.is_authenticated&&(0,r.A)(di.P3,{},void 0,(0,r.A)(di.MT,{},void 0,(0,r.A)(co,{thread:n})),o.enabled&&(0,r.A)(di.MT,{shrink:!0},void 0,(0,r.A)(no,{thread:n,posts:a,moderation:o})))))))};var yo,bo,Do,xo,ko,_o,No,Co,Eo=n(98088),wo=n(28542);function Fo(){window.scrollTo(0,0)}var Ro=(0,wo.y)(function(e){var t=e.router,n=e.baseUrl,a=e.posts,i=e.scrollToTop;return(0,r.A)("div",{className:"thread-paginator"},void 0,a.isLoaded&&a.first?(0,r.A)(wo.N_,{className:"btn btn-default btn-outline btn-icon",to:n,title:pgettext("paginator","Go to first page"),onClick:i?Fo:null},void 0,yo||(yo=(0,r.A)("span",{className:"material-icon"},void 0,"first_page"))):(0,r.A)("button",{className:"btn btn-default btn-outline btn-icon",title:pgettext("paginator","Go to first page"),type:"button",disabled:!0},void 0,bo||(bo=(0,r.A)("span",{className:"material-icon"},void 0,"first_page"))),a.isLoaded&&a.previous?(0,r.A)(wo.N_,{className:"btn btn-default btn-outline btn-icon",to:n+(a.previous>1?a.previous+"/":""),title:pgettext("paginator","Go to previous page"),onClick:i?Fo:null},void 0,Do||(Do=(0,r.A)("span",{className:"material-icon"},void 0,"chevron_left"))):(0,r.A)("button",{className:"btn btn-default btn-outline btn-icon",title:pgettext("paginator","Go to previous page"),type:"button",disabled:!0},void 0,xo||(xo=(0,r.A)("span",{className:"material-icon"},void 0,"chevron_left"))),(0,r.A)(lo.ms,{toggle:function(e){var t,n,i=e.aria,o=e.toggle;return f().createElement("button",(0,v.A)({},i,{className:"btn btn-default btn-block btn-outline",type:"button",disabled:!a.isLoaded,onClick:o}),(t=a.page,n=a.pages,pgettext("paginator","Page %(page)s of %(pages)s").replace("%(page)s",t).replace("%(pages)s",n)))},onOpen:function(e){e.querySelector("input").focus()}},void 0,function(e){var o=e.close;return(0,r.A)("form",{className:"thread-paginator-form",onSubmit:function(e){if(a.isLoaded){var r=new FormData(e.target),s=parseInt(r.get("page"));if(s&&s!=a.page&&s>=1&&s<=a.pages){var u=s>1?n+s+"/":n;t.push({pathname:u})}}e.preventDefault(),o(),i&&Fo()}},void 0,(0,r.A)("input",{className:"form-control",name:"page",type:"number",min:1,max:a.pages,placeholder:pgettext("paginator input","Page"),disabled:!a.isLoaded}),(0,r.A)("button",{className:"btn btn-primary",type:"submit",disabled:!a.isLoaded},void 0,pgettext("paginator","Go")))}),a.isLoaded&&a.next?(0,r.A)(wo.N_,{className:"btn btn-default btn-outline btn-icon",to:n+a.next+"/",title:pgettext("paginator","Go to next page"),onClick:i?Fo:null},void 0,ko||(ko=(0,r.A)("span",{className:"material-icon"},void 0,"chevron_right"))):(0,r.A)("button",{className:"btn btn-default btn-outline btn-icon",title:pgettext("paginator","Go to next page"),type:"button",disabled:!0},void 0,_o||(_o=(0,r.A)("span",{className:"material-icon"},void 0,"chevron_right"))),a.isLoaded&&a.last?(0,r.A)(wo.N_,{className:"btn btn-default btn-outline btn-icon",to:n+a.last+"/",title:pgettext("paginator","Go to last page"),onClick:i?Fo:null},void 0,No||(No=(0,r.A)("span",{className:"material-icon"},void 0,"last_page"))):(0,r.A)("button",{className:"btn btn-default btn-outline btn-icon",title:pgettext("paginator","Go to last page"),type:"button",disabled:!0},void 0,Co||(Co=(0,r.A)("span",{className:"material-icon"},void 0,"last_page"))))});const So=Ro;var Bo,Lo,To;function Oo(e){var t=e.errors,n=e.posts;return(0,r.A)("div",{className:"modal-dialog",role:"document"},void 0,(0,r.A)("div",{className:"modal-content"},void 0,(0,r.A)("div",{className:"modal-header"},void 0,(0,r.A)("button",{"aria-label":pgettext("modal","Close"),className:"close","data-dismiss":"modal",type:"button"},void 0,Bo||(Bo=(0,r.A)("span",{"aria-hidden":"true"},void 0,"Ã—"))),(0,r.A)("h4",{className:"modal-title"},void 0,pgettext("thread posts moderation modal title","Moderation"))),(0,r.A)("div",{className:"modal-body"},void 0,(0,r.A)("p",{className:"lead"},void 0,pgettext("thread posts moderation modal","One or more posts could not be changed:")),(0,r.A)("ul",{className:"list-unstyled list-errored-items"},void 0,t.map(function(e){return(0,r.A)(Po,{errors:e.detail,post:n[e.id]},e.id)})))))}function Po(e){var t=e.errors,n=e.post,a=interpolate(pgettext("thread posts moderation modal","%(username)s on %(posted_on)s"),{posted_on:n.posted_on.format("LL, LT"),username:n.poster_name},!0);return(0,r.A)("li",{},void 0,(0,r.A)("h5",{},void 0,a,":"),t.map(function(e,t){return(0,r.A)("p",{},t,e)}))}function Io(e,t,n,a){var i=e.selection,o=e.thread;n.forEach(function(e){Ge.F6(e,e)}),_.A.dispatch(Ca.NQ());var s={ops:t,ids:i.map(function(e){return e.id})};D.A.patch(o.api.posts.index,s).then(function(e){e.forEach(function(e){_.A.dispatch(Ge.F6(e,e))})},function(e){if(400!==e.status)return a.forEach(function(e){_.A.dispatch(Ge.F6(e,e))}),k.A.apiError(e);var t=[],n=[];e.forEach(function(e){e.detail?(t.push(e),n.push(e.id)):_.A.dispatch(Ge.F6(e,e)),a.forEach(function(e){-1!==n.indexOf(e)&&_.A.dispatch(Ge.F6(e,e))})});var o={};i.forEach(function(e){o[e.id]=e}),x.A.show((0,r.A)(Oo,{errors:t,posts:o}))})}var qo,Uo,jo,Mo,zo,Ho,Vo=function(e){(0,c.A)(i,e);var t,n,a=(t=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}(),function(){var e,a=(0,p.A)(t);if(n){var i=(0,p.A)(this).constructor;e=Reflect.construct(a,arguments,i)}else e=a.apply(this,arguments);return(0,d.A)(this,e)});function i(e){var t;return(0,s.A)(this,i),t=a.call(this,e),(0,h.A)((0,l.A)(t),"onUrlChange",function(e){t.changeValue("url",e.target.value)}),t.state={isLoading:!1,url:"",validators:{url:[]},errors:{}},t}return(0,u.A)(i,[{key:"clean",value:function(){return!!this.state.url.trim().length||(k.A.error(pgettext("thread posts moderation move","You have to enter link to the other thread.")),!1)}},{key:"send",value:function(){return D.A.post(this.props.thread.api.posts.move,{new_thread:this.state.url,posts:this.props.selection.map(function(e){return e.id})})}},{key:"handleSuccess",value:function(e){this.props.selection.forEach(function(e){_.A.dispatch(Ge.F6(e,{isDeleted:!0}))}),x.A.hide(),k.A.success(pgettext("thread posts moderation move","Selected posts were moved to the other thread."))}},{key:"handleError",value:function(e){400===e.status?k.A.error(e.detail):k.A.apiError(e)}},{key:"render",value:function(){return(0,r.A)("div",{className:"modal-dialog",role:"document"},void 0,(0,r.A)("form",{onSubmit:this.handleSubmit},void 0,(0,r.A)("div",{className:"modal-content"},void 0,Lo||(Lo=(0,r.A)(Yo,{})),(0,r.A)("div",{className:"modal-body"},void 0,(0,r.A)(g.A,{for:"id_url",label:pgettext("thread posts moderation move","Link to thread you want to move posts to")},void 0,(0,r.A)("input",{className:"form-control",disabled:this.state.isLoading,id:"id_url",onChange:this.onUrlChange,value:this.state.url}))),(0,r.A)("div",{className:"modal-footer"},void 0,(0,r.A)("button",{className:"btn btn-default","data-dismiss":"modal",disabled:this.state.isLoading,type:"button"},void 0,pgettext("thread posts moderation move btn","Cancel")),(0,r.A)("button",{className:"btn btn-primary",disabled:this.state.isLoading},void 0,pgettext("thread posts moderation move btn","Move posts"))))))}}]),i}(A.A);function Yo(e){return(0,r.A)("div",{className:"modal-header"},void 0,(0,r.A)("button",{"aria-label":pgettext("modal","Close"),className:"close","data-dismiss":"modal",type:"button"},void 0,To||(To=(0,r.A)("span",{"aria-hidden":"true"},void 0,"Ã—"))),(0,r.A)("h4",{className:"modal-title"},void 0,pgettext("thread posts moderation move title","Move posts")))}function Wo(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,a=(0,p.A)(e);if(t){var i=(0,p.A)(this).constructor;n=Reflect.construct(a,arguments,i)}else n=a.apply(this,arguments);return(0,d.A)(this,n)}}function Go(e){return f().createElement(ar,(0,v.A)({},e,{Form:ir}))}var Qo,Ko,Xo,Jo,$o,Zo,er,tr,nr,ar=function(e){(0,c.A)(n,e);var t=Wo(n);function n(e){var a;return(0,s.A)(this,n),(a=t.call(this,e)).state={isLoaded:!1,isError:!1,categories:[]},a}return(0,u.A)(n,[{key:"componentDidMount",value:function(){var e=this;D.A.get(misago.get("THREAD_EDITOR_API")).then(function(t){var n=t.map(function(e){return Object.assign(e,{disabled:!1===e.post,label:e.name,value:e.id,post:e.post})});e.setState({isLoaded:!0,categories:n})},function(t){e.setState({isError:t.detail})})}},{key:"render",value:function(){return this.state.isError?(0,r.A)(rr,{message:this.state.isError}):this.state.isLoaded?f().createElement(ir,(0,v.A)({},this.props,{categories:this.state.categories})):qo||(qo=(0,r.A)(or,{}))}}]),n}(f().Component),ir=function(e){(0,c.A)(n,e);var t=Wo(n);function n(e){var a;return(0,s.A)(this,n),a=t.call(this,e),(0,h.A)((0,l.A)(a),"onCategoryChange",function(e){var t=e.target.value,n={category:t};a.acl[t].can_pin_threads<n.weight&&(n.weight=0),a.acl[t].can_hide_threads||(n.is_hidden=0),a.acl[t].can_close_threads||(n.is_closed=!1),a.setState(n)}),a.state={isLoading:!1,title:"",category:null,categories:e.categories,weight:0,is_hidden:0,is_closed:!1,validators:{title:[zn.mw()]},errors:{}},a.isHiddenChoices=[{value:0,icon:"visibility",label:pgettext("thread hidden switch choice","No")},{value:1,icon:"visibility_off",label:pgettext("thread hidden switch choice","Yes")}],a.isClosedChoices=[{value:!1,icon:"lock_outline",label:pgettext("thread closed switch choice","No")},{value:!0,icon:"lock",label:pgettext("thread closed switch choice","Yes")}],a.acl={},a.props.categories.forEach(function(e){e.post&&(a.state.category||(a.state.category=e.id),a.acl[e.id]={can_pin_threads:e.post.pin,can_close_threads:e.post.close,can_hide_threads:e.post.hide})}),a}return(0,u.A)(n,[{key:"clean",value:function(){return!!this.isValid()||(k.A.error(gettext("Form contains errors.")),this.setState({errors:this.validate()}),!1)}},{key:"send",value:function(){return D.A.post(this.props.thread.api.posts.split,{title:this.state.title,category:this.state.category,weight:this.state.weight,is_hidden:this.state.is_hidden,is_closed:this.state.is_closed,posts:this.props.selection.map(function(e){return e.id})})}},{key:"handleSuccess",value:function(e){this.props.selection.forEach(function(e){_.A.dispatch(Ge.F6(e,{isDeleted:!0}))}),x.A.hide(),k.A.success(pgettext("posts moderation split","Selected posts were split into new thread."))}},{key:"handleError",value:function(e){400===e.status?(this.setState({errors:Object.assign({},this.state.errors,e)}),k.A.error(gettext("Form contains errors."))):403===e.status&&Array.isArray(e)?x.A.show((0,r.A)(Oo,{errors:e})):k.A.apiError(e)}},{key:"getWeightChoices",value:function(){var e=[{value:0,icon:"remove",label:pgettext("thread weight choice","Not pinned")},{value:1,icon:"bookmark_border",label:pgettext("thread weight choice","Pinned in category")}];return 2==this.acl[this.state.category].can_pin_threads&&e.push({value:2,icon:"bookmark",label:pgettext("thread weight choice","Pinned globally")}),e}},{key:"renderWeightField",value:function(){return this.acl[this.state.category].can_pin_threads?(0,r.A)(g.A,{label:pgettext("posts moderation split field","Thread weight"),for:"id_weight",labelClass:"col-sm-4",controlClass:"col-sm-8"},void 0,(0,r.A)(Mn.A,{id:"id_weight",onChange:this.bindInput("weight"),value:this.state.weight,choices:this.getWeightChoices()})):null}},{key:"renderHiddenField",value:function(){return this.acl[this.state.category].can_hide_threads?(0,r.A)(g.A,{label:pgettext("posts moderation split field","Hide thread"),for:"id_is_hidden",labelClass:"col-sm-4",controlClass:"col-sm-8"},void 0,(0,r.A)(Mn.A,{id:"id_is_closed",onChange:this.bindInput("is_hidden"),value:this.state.is_hidden,choices:this.isHiddenChoices})):null}},{key:"renderClosedField",value:function(){return this.acl[this.state.category].can_close_threads?(0,r.A)(g.A,{label:pgettext("posts moderation split field","Close thread"),for:"id_is_closed",labelClass:"col-sm-4",controlClass:"col-sm-8"},void 0,(0,r.A)(Mn.A,{id:"id_is_closed",onChange:this.bindInput("is_closed"),value:this.state.is_closed,choices:this.isClosedChoices})):null}},{key:"render",value:function(){return(0,r.A)(sr,{className:"modal-dialog"},void 0,(0,r.A)("form",{onSubmit:this.handleSubmit},void 0,(0,r.A)("div",{className:"modal-body"},void 0,(0,r.A)(g.A,{label:pgettext("posts moderation split field","Thread title"),for:"id_title",labelClass:"col-sm-4",controlClass:"col-sm-8",validation:this.state.errors.title},void 0,(0,r.A)("input",{id:"id_title",className:"form-control",type:"text",onChange:this.bindInput("title"),value:this.state.title})),Uo||(Uo=(0,r.A)("div",{className:"clearfix"})),(0,r.A)(g.A,{label:pgettext("posts moderation split field","Category"),for:"id_category",labelClass:"col-sm-4",controlClass:"col-sm-8",validation:this.state.errors.category},void 0,(0,r.A)(jn.A,{id:"id_category",onChange:this.onCategoryChange,value:this.state.category,choices:this.state.categories})),jo||(jo=(0,r.A)("div",{className:"clearfix"})),this.renderWeightField(),this.renderHiddenField(),this.renderClosedField()),(0,r.A)("div",{className:"modal-footer"},void 0,(0,r.A)("button",{className:"btn btn-default","data-dismiss":"modal",disabled:this.state.isLoading,type:"button"},void 0,pgettext("posts moderation split btn","Cancel")),(0,r.A)(Te.A,{className:"btn-primary",loading:this.state.isLoading},void 0,pgettext("posts moderation split btn","Split posts")))))}}]),n}(A.A);function or(){return Mo||(Mo=(0,r.A)(sr,{className:"modal-dialog"},void 0,(0,r.A)(Z.A,{})))}function rr(e){return(0,r.A)(sr,{className:"modal-dialog modal-message"},void 0,zo||(zo=(0,r.A)("div",{className:"message-icon"},void 0,(0,r.A)("span",{className:"material-icon"},void 0,"info_outline"))),(0,r.A)("div",{className:"message-body"},void 0,(0,r.A)("p",{className:"lead"},void 0,pgettext("posts moderation split","You can't move selected posts at the moment.")),(0,r.A)("p",{},void 0,e.message),(0,r.A)("button",{className:"btn btn-default","data-dismiss":"modal",type:"button"},void 0,pgettext("posts moderation split dismiss btn","Ok"))))}function sr(e){return(0,r.A)("div",{className:e.className,role:"document"},void 0,(0,r.A)("div",{className:"modal-content"},void 0,(0,r.A)("div",{className:"modal-header"},void 0,(0,r.A)("button",{"aria-label":pgettext("modal","Close"),className:"close","data-dismiss":"modal",type:"button"},void 0,Ho||(Ho=(0,r.A)("span",{"aria-hidden":"true"},void 0,"Ã—"))),(0,r.A)("h4",{className:"modal-title"},void 0,pgettext("posts moderation split title","Split posts into new thread"))),e.children))}function ur(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,a=(0,p.A)(e);if(t){var i=(0,p.A)(this).constructor;n=Reflect.construct(a,arguments,i)}else n=a.apply(this,arguments);return(0,d.A)(this,n)}}function lr(e){return(0,r.A)("ul",{className:"dropdown-menu dropdown-menu-right stick-to-bottom"},void 0,f().createElement(dr,e),f().createElement(pr,e),f().createElement(hr,e),f().createElement(mr,e),f().createElement(fr,e),f().createElement(vr,e),f().createElement(gr,e),f().createElement(Ar,e),f().createElement(yr,e))}var cr,dr=function(e){(0,c.A)(n,e);var t=ur(n);function n(){var e;(0,s.A)(this,n);for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return e=t.call.apply(t,[this].concat(i)),(0,h.A)((0,l.A)(e),"onClick",function(){var t,n,a,i;a=(n=(t=e.props).selection).map(function(e){return{id:e.id,is_unapproved:!1}}),i=n.map(function(e){return{id:e.id,is_unapproved:e.is_unapproved}}),Io(t,[{op:"replace",path:"is-unapproved",value:!1}],a,i)}),e}return(0,u.A)(n,[{key:"render",value:function(){var e=this.props.selection.find(function(e){return e.acl.can_approve&&e.is_unapproved});return e?(0,r.A)("li",{},void 0,(0,r.A)("button",{type:"button",className:"btn btn-link",onClick:this.onClick},void 0,Qo||(Qo=(0,r.A)("span",{className:"material-icon"},void 0,"done")),pgettext("thread posts moderation","Approve"))):null}}]),n}(f().Component),pr=function(e){(0,c.A)(n,e);var t=ur(n);function n(){var e;(0,s.A)(this,n);for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return e=t.call.apply(t,[this].concat(i)),(0,h.A)((0,l.A)(e),"onClick",function(){var t;t=e.props,window.confirm(pgettext("merge posts","Are you sure you want to merge selected posts? This action is not reversible!"))&&(t.selection.slice(1).map(function(e){_.A.dispatch(Ge.F6(e,{isDeleted:!0}))}),D.A.post(t.thread.api.posts.merge,{posts:t.selection.map(function(e){return e.id})}).then(function(e){_.A.dispatch(Ge.F6(e,Ge.Qv(e)))},function(e){400===e.status?k.A.error(e.detail):k.A.apiError(e),t.selection.slice(1).map(function(e){_.A.dispatch(Ge.F6(e,{isDeleted:!1}))})}),_.A.dispatch(Ca.NQ()))}),e}return(0,u.A)(n,[{key:"render",value:function(){var e=this.props.selection.length>1&&this.props.selection.find(function(e){return e.acl.can_merge});return e?(0,r.A)("li",{},void 0,(0,r.A)("button",{type:"button",className:"btn btn-link",onClick:this.onClick},void 0,Ko||(Ko=(0,r.A)("span",{className:"material-icon"},void 0,"call_merge")),pgettext("thread posts moderation","Merge"))):null}}]),n}(f().Component),hr=function(e){(0,c.A)(n,e);var t=ur(n);function n(){var e;(0,s.A)(this,n);for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return e=t.call.apply(t,[this].concat(i)),(0,h.A)((0,l.A)(e),"onClick",function(){x.A.show(f().createElement(Vo,e.props))}),e}return(0,u.A)(n,[{key:"render",value:function(){var e=this.props.selection.find(function(e){return e.acl.can_move});return e?(0,r.A)("li",{},void 0,(0,r.A)("button",{type:"button",className:"btn btn-link",onClick:this.onClick},void 0,Xo||(Xo=(0,r.A)("span",{className:"material-icon"},void 0,"arrow_forward")),pgettext("thread posts moderation","Move"))):null}}]),n}(f().Component),mr=function(e){(0,c.A)(n,e);var t=ur(n);function n(){var e;(0,s.A)(this,n);for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return e=t.call.apply(t,[this].concat(i)),(0,h.A)((0,l.A)(e),"onClick",function(){x.A.show(f().createElement(Go,e.props))}),e}return(0,u.A)(n,[{key:"render",value:function(){var e=this.props.selection.find(function(e){return e.acl.can_move});return e?(0,r.A)("li",{},void 0,(0,r.A)("button",{type:"button",className:"btn btn-link",onClick:this.onClick},void 0,Jo||(Jo=(0,r.A)("span",{className:"material-icon"},void 0,"call_split")),pgettext("thread posts moderation","Split"))):null}}]),n}(f().Component),fr=function(e){(0,c.A)(n,e);var t=ur(n);function n(){var e;(0,s.A)(this,n);for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return e=t.call.apply(t,[this].concat(i)),(0,h.A)((0,l.A)(e),"onClick",function(){var t,n,a,i;a=(n=(t=e.props).selection).map(function(e){return{id:e.id,is_protected:!0}}),i=n.map(function(e){return{id:e.id,is_protected:e.is_protected}}),Io(t,[{op:"replace",path:"is-protected",value:!0}],a,i)}),e}return(0,u.A)(n,[{key:"render",value:function(){var e=this.props.selection.find(function(e){return!e.is_protected&&e.acl.can_protect});return e?(0,r.A)("li",{},void 0,(0,r.A)("button",{type:"button",className:"btn btn-link",onClick:this.onClick},void 0,$o||($o=(0,r.A)("span",{className:"material-icon"},void 0,"lock_outline")),pgettext("thread posts moderation","Protect"))):null}}]),n}(f().Component),vr=function(e){(0,c.A)(n,e);var t=ur(n);function n(){var e;(0,s.A)(this,n);for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return e=t.call.apply(t,[this].concat(i)),(0,h.A)((0,l.A)(e),"onClick",function(){var t,n,a,i;a=(n=(t=e.props).selection).map(function(e){return{id:e.id,is_protected:!1}}),i=n.map(function(e){return{id:e.id,is_protected:e.is_protected}}),Io(t,[{op:"replace",path:"is-protected",value:!1}],a,i)}),e}return(0,u.A)(n,[{key:"render",value:function(){var e=this.props.selection.find(function(e){return e.is_protected&&e.acl.can_protect});return e?(0,r.A)("li",{},void 0,(0,r.A)("button",{type:"button",className:"btn btn-link",onClick:this.onClick},void 0,Zo||(Zo=(0,r.A)("span",{className:"material-icon"},void 0,"lock_open")),pgettext("thread posts moderation","Unprotect"))):null}}]),n}(f().Component),Ar=function(e){(0,c.A)(n,e);var t=ur(n);function n(){var e;(0,s.A)(this,n);for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return e=t.call.apply(t,[this].concat(i)),(0,h.A)((0,l.A)(e),"onClick",function(){var t,n,a,i;a=(n=(t=e.props).selection).map(function(e){return{id:e.id,is_hidden:!0,hidden_on:H()(),hidden_by_name:t.user.username,url:Object.assign(e.url,{hidden_by:t.user.url})}}),i=n.map(function(e){return{id:e.id,is_hidden:e.is_hidden,hidden_on:e.hidden_on,hidden_by_name:e.hidden_by_name,url:e.url}}),Io(t,[{op:"replace",path:"is-hidden",value:!0}],a,i)}),e}return(0,u.A)(n,[{key:"render",value:function(){var e=this.props.selection.find(function(e){return e.acl.can_hide&&!e.is_hidden});return e?(0,r.A)("li",{},void 0,(0,r.A)("button",{type:"button",className:"btn btn-link",onClick:this.onClick},void 0,er||(er=(0,r.A)("span",{className:"material-icon"},void 0,"visibility_off")),pgettext("thread posts moderation","Hide"))):null}}]),n}(f().Component),gr=function(e){(0,c.A)(n,e);var t=ur(n);function n(){var e;(0,s.A)(this,n);for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return e=t.call.apply(t,[this].concat(i)),(0,h.A)((0,l.A)(e),"onClick",function(){var t,n,a,i;a=(n=(t=e.props).selection).map(function(e){return{id:e.id,is_hidden:!1,hidden_on:H()(),hidden_by_name:t.user.username,url:Object.assign(e.url,{hidden_by:t.user.url})}}),i=n.map(function(e){return{id:e.id,is_hidden:e.is_hidden,hidden_on:e.hidden_on,hidden_by_name:e.hidden_by_name,url:e.url}}),Io(t,[{op:"replace",path:"is-hidden",value:!1}],a,i)}),e}return(0,u.A)(n,[{key:"render",value:function(){var e=this.props.selection.find(function(e){return e.acl.can_unhide&&e.is_hidden});return e?(0,r.A)("li",{},void 0,(0,r.A)("button",{type:"button",className:"btn btn-link",onClick:this.onClick},void 0,tr||(tr=(0,r.A)("span",{className:"material-icon"},void 0,"visibility")),pgettext("thread posts moderation","Unhide"))):null}}]),n}(f().Component),yr=function(e){(0,c.A)(n,e);var t=ur(n);function n(){var e;(0,s.A)(this,n);for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return e=t.call.apply(t,[this].concat(i)),(0,h.A)((0,l.A)(e),"onClick",function(){!function(e){if(window.confirm(pgettext("delete posts","Are you sure you want to delete selected posts? This action is not reversible!"))){e.selection.map(function(e){_.A.dispatch(Ge.F6(e,{isDeleted:!0}))});var t=e.selection.map(function(e){return e.id});D.A.delete(e.thread.api.posts.index,t).then(function(){},function(t){400===t.status?k.A.error(t.detail):k.A.apiError(t),e.selection.map(function(e){_.A.dispatch(Ge.F6(e,{isDeleted:!1}))})}),_.A.dispatch(Ca.NQ())}}(e.props)}),e}return(0,u.A)(n,[{key:"render",value:function(){var e=this.props.selection.find(function(e){return e.acl.can_delete});return e?(0,r.A)("li",{},void 0,(0,r.A)("button",{type:"button",className:"btn btn-link",onClick:this.onClick},void 0,nr||(nr=(0,r.A)("span",{className:"material-icon"},void 0,"clear")),pgettext("thread posts moderation","Delete"))):null}}]),n}(f().Component);const br=function(e){var t=e.thread,n=e.user,a=e.selection,i=e.dropup;return(0,r.A)("div",{className:i?"dropup":"dropdown"},void 0,(0,r.A)("button",{type:"button",className:"btn btn-default btn-outline btn-icon dropdown-toggle",title:pgettext("post options btn","Posts options"),"data-toggle":"dropdown","aria-haspopup":"true","aria-expanded":"false",disabled:0===a.length},void 0,cr||(cr=(0,r.A)("span",{className:"material-icon"},void 0,"settings"))),(0,r.A)(lr,{thread:t,user:n,selection:a}))};var Dr;const xr=function(e){var t=e.onClick;return(0,r.A)("button",{className:"btn btn-primary btn-outline btn-block",type:"button",onClick:t},void 0,Dr||(Dr=(0,r.A)("span",{className:"material-icon"},void 0,"chat")),pgettext("thread reply btn","Reply"))};var kr;const _r=function(e){var t=e.thread,n=e.posts,a=e.user,i=e.selection,o=e.moderation,s=e.onReply;return(0,r.A)(Eo.M7,{},void 0,n.pages>1&&(0,r.A)(Eo.rk,{},void 0,(0,r.A)(Eo.Tm,{},void 0,(0,r.A)(So,{baseUrl:t.url.index,posts:n,scrollToTop:!0}))),kr||(kr=(0,r.A)(Eo.my,{})),a.is_authenticated&&(0,r.A)(Eo.rk,{},void 0,(0,r.A)(Eo.Tm,{className:"hidden-xs"},void 0,(0,r.A)(co,{thread:t,dropup:!0})),t.acl.can_reply&&(0,r.A)(Eo.Tm,{},void 0,(0,r.A)(xr,{onClick:s})),o.enabled&&(0,r.A)(Eo.Tm,{shrink:!0},void 0,(0,r.A)(br,{thread:t,user:a,selection:i,dropup:!0}))),a.is_authenticated&&(0,r.A)(Eo.rk,{className:"hidden-sm hidden-md hidden-lg"},void 0,(0,r.A)(Eo.Tm,{},void 0,(0,r.A)(co,{thread:t,dropup:!0}))))};var Nr,Cr;const Er=function(){return(0,r.A)(Eo.M7,{className:"thread-toolbar-third"},void 0,Nr||(Nr=(0,r.A)(Eo.my,{})),(0,r.A)(Eo.rk,{},void 0,(0,r.A)(Eo.Tm,{},void 0,(0,r.A)("button",{className:"btn btn-muted btn-block",type:"button",onClick:function(){return window.scrollTo(0,0)}},void 0,Cr||(Cr=(0,r.A)("span",{className:"material-icon"},void 0,"arrow_upward")),pgettext("go up","Go to top")))))};var wr;const Fr=function(e){var t=e.compact,n=e.disabled,a=e.onClick;return(0,r.A)("button",{className:so()("btn btn-default btn-outline",{"btn-block":!t,"btn-icon":t}),type:"button",title:t?pgettext("thread poll btn","Add poll"):null,disabled:n,onClick:a},void 0,wr||(wr=(0,r.A)("span",{className:"material-icon"},void 0,"poll")),!t&&pgettext("thread poll btn","Add poll"))};var Rr,Sr,Br,Lr,Tr,Or;const Pr=function(e){var t=e.user,n=e.thread,a=e.posts;return(0,r.A)("div",{className:"dropdown"},void 0,(0,r.A)("button",{className:"btn btn-default btn-outline btn-icon",title:pgettext("thread shortcuts btn","Shortcuts"),"aria-expanded":"true","aria-haspopup":"true","data-toggle":"dropdown",type:"button"},void 0,Rr||(Rr=(0,r.A)("span",{className:"material-icon"},void 0,"bookmark"))),(0,r.A)("ul",{className:"dropdown-menu"},void 0,!!a.first&&(0,r.A)("li",{},void 0,(0,r.A)(wo.N_,{className:"btn btn-link",href:n.url.index},void 0,Sr||(Sr=(0,r.A)("span",{className:"material-icon"},void 0,"place")),pgettext("thread shortcut btn","Go to first post"))),t.is_authenticated&&n.is_new&&(0,r.A)("li",{},void 0,(0,r.A)("a",{className:"btn btn-link",href:n.url.new_post},void 0,Br||(Br=(0,r.A)("span",{className:"material-icon"},void 0,"comment")),pgettext("thread shortcut btn","Go to new post"))),n.best_answer&&(0,r.A)("li",{},void 0,(0,r.A)("a",{className:"btn btn-link",href:n.url.best_answer},void 0,Lr||(Lr=(0,r.A)("span",{className:"material-icon"},void 0,"check_circle")),pgettext("thread shortcut btn","Go to best answer"))),n.has_unapproved_posts&&n.acl.can_approve&&(0,r.A)("li",{},void 0,(0,r.A)("a",{className:"btn btn-link",href:n.url.unapproved_post},void 0,Tr||(Tr=(0,r.A)("span",{className:"material-icon"},void 0,"visibility")),pgettext("thread shortcut btn","Go to unapproved post"))),(0,r.A)("li",{},void 0,(0,r.A)("a",{className:"btn btn-link",href:n.url.last_post},void 0,Or||(Or=(0,r.A)("span",{className:"material-icon"},void 0,"reply")),pgettext("thread shortcut btn","Go to last post")))))};var Ir;const qr=function(e){var t=e.thread,n=e.posts,a=e.user,i=e.pollDisabled,o=e.selection,s=e.moderation,u=e.onPoll,l=e.onReply;return(0,r.A)(Eo.M7,{},void 0,(0,r.A)(Eo.rk,{className:"hidden-xs"},void 0,(0,r.A)(Eo.Tm,{},void 0,(0,r.A)(Pr,{posts:n,thread:t,user:a})),n.pages>1&&(0,r.A)(Eo.Tm,{},void 0,(0,r.A)(So,{baseUrl:t.url.index,posts:n}))),Ir||(Ir=(0,r.A)(Eo.my,{})),t.acl.can_start_poll&&!t.poll&&(0,r.A)(Eo.rk,{className:"hidden-xs"},void 0,(0,r.A)(Eo.Tm,{},void 0,(0,r.A)(Fr,{disabled:i,onClick:u}))),t.acl.can_reply?(0,r.A)(Eo.rk,{},void 0,(0,r.A)(Eo.Tm,{className:"hidden-sm hidden-md hidden-lg",shrink:!0},void 0,(0,r.A)(Pr,{posts:n,thread:t,user:a})),(0,r.A)(Eo.Tm,{},void 0,(0,r.A)(xr,{onClick:l})),t.acl.can_start_poll&&!t.poll&&(0,r.A)(Eo.Tm,{className:"hidden-sm hidden-md hidden-lg",shrink:!0},void 0,(0,r.A)(Fr,{disabled:i,onClick:u,compact:!0})),s.enabled&&(0,r.A)(Eo.Tm,{className:"hidden-xs",shrink:!0},void 0,(0,r.A)(br,{thread:t,user:a,selection:o}))):(0,r.A)(Eo.rk,{},void 0,(0,r.A)(Eo.Tm,{className:"hidden-sm hidden-md hidden-lg",shrink:!0},void 0,(0,r.A)(Pr,{posts:n,thread:t,user:a})),t.acl.can_start_poll&&!t.poll&&(0,r.A)(Eo.Tm,{},void 0,(0,r.A)(Fr,{disabled:i,onClick:u})),s.enabled&&(0,r.A)(Eo.Tm,{shrink:!0},void 0,(0,r.A)(br,{thread:t,user:a,selection:o}))),n.pages>1&&(0,r.A)(Eo.rk,{className:"hidden-sm hidden-md hidden-lg"},void 0,(0,r.A)(Eo.Tm,{},void 0,(0,r.A)(So,{baseUrl:t.url.index,posts:n}))))};var Ur;var jr=function(e){(0,c.A)(i,e);var t,n,a=(t=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}(),function(){var e,a=(0,p.A)(t);if(n){var i=(0,p.A)(this).constructor;e=Reflect.construct(a,arguments,i)}else e=a.apply(this,arguments);return(0,d.A)(this,e)});function i(e){var t;return(0,s.A)(this,i),t=a.call(this,e),(0,h.A)((0,l.A)(t),"update",function(e){_.A.dispatch(b.HC(e)),_.A.dispatch(Ca.Hh(e.post_set)),e.participants&&_.A.dispatch(y.HC(e.participants)),e.poll&&_.A.dispatch(ue.HC(e.poll)),t.setPageTitle()}),(0,h.A)((0,l.A)(t),"openPollForm",function(){t.setState({editPoll:!0})}),(0,h.A)((0,l.A)(t),"closePollForm",function(){t.setState({editPoll:!1})}),(0,h.A)((0,l.A)(t),"openReplyForm",function(){le.A.open({mode:"REPLY",thread:t.props.thread,config:t.props.thread.api.editor,submit:t.props.thread.api.posts.index})}),t.state={editPoll:!1},t}return(0,u.A)(i,[{key:"componentDidMount",value:function(){this.shouldFetchData()&&(this.fetchData(),this.setPageTitle()),this.startPollingApi()}},{key:"componentDidUpdate",value:function(){this.shouldFetchData()&&(this.fetchData(),this.startPollingApi(),this.setPageTitle())}},{key:"componentWillUnmount",value:function(){this.stopPollingApi()}},{key:"shouldFetchData",value:function(){return!!this.props.posts.isLoaded&&1*(this.props.params.page||1)!=this.props.posts.page}},{key:"fetchData",value:function(){var e=this;_.A.dispatch(Ca.GP()),D.A.get(this.props.thread.api.posts.index,{page:this.props.params.page||1},"posts").then(function(t){e.update(t)},function(e){k.A.apiError(e)})}},{key:"startPollingApi",value:function(){si.A.start({poll:"thread-posts",url:this.props.thread.api.posts.index,data:{page:this.props.params.page||1},update:this.update,frequency:12e4,delayed:!0})}},{key:"stopPollingApi",value:function(){si.A.stop("thread-posts")}},{key:"setPageTitle",value:function(){ui.A.set({title:this.props.thread.title,parent:this.props.thread.category.name,page:1*(this.props.params.page||1)})}},{key:"render",value:function(){var e=this.props.thread.category,t="page page-thread";e.css_class&&(t+=" page-thread-"+e.css_class);var n="private_threads"===e.special_role?"private-threads":e.css_class||"category-threads",a=Mr(this.props.thread,this.props.user),i=zr(this.props.posts.results,this.props.user),o=this.props.posts.results.filter(function(e){return e.isSelected});return(0,r.A)("div",{className:t},void 0,(0,r.A)(go,{styleName:n,thread:this.props.thread,posts:this.props.posts,user:this.props.user,moderation:a}),(0,r.A)(ci.A,{},void 0,(0,r.A)(U,{participants:this.props.participants,thread:this.props.thread,user:this.props.user}),(0,r.A)(qr,{thread:this.props.thread,posts:this.props.posts,user:this.props.user,selection:o,moderation:i,pollDisabled:this.state.editPoll,onPoll:this.openPollForm,onReply:this.openReplyForm}),this.state.editPoll?(0,r.A)(He,{poll:this.props.poll,thread:this.props.thread,close:this.closePollForm}):(0,r.A)(Ie,{poll:this.props.poll,thread:this.props.thread,user:this.props.user,edit:this.openPollForm}),this.props.thread.acl.can_reply?(0,r.A)(li.$e,{posting:{mode:"REPLY",thread:this.props.thread,config:this.props.thread.api.editor,submit:this.props.thread.api.posts.index}},void 0,f().createElement($a,this.props)):f().createElement($a,this.props),(0,r.A)(_r,{thread:this.props.thread,posts:this.props.posts,user:this.props.user,selection:o,moderation:i,onReply:this.openReplyForm}),Ur||(Ur=(0,r.A)(Er,{}))))}}]),i}(f().Component),Mr=function(e,t){var n={enabled:!1,edit:!1,approve:!1,close:!1,open:!1,hide:!1,unhide:!1,move:!1,merge:!1,pinGlobally:!1,pinLocally:!1,unpin:!1,delete:!1};return t.is_authenticated?(n.edit=e.acl.can_edit,n.approve=e.acl.can_approve&&e.is_unapproved,n.close=e.acl.can_close&&!e.is_closed,n.open=e.acl.can_close&&e.is_closed,n.hide=e.acl.can_hide&&!e.is_hidden,n.unhide=e.acl.can_unhide&&e.is_hidden,n.move=e.acl.can_move,n.merge=e.acl.can_merge,n.pinGlobally=e.acl.can_pin_globally&&e.weight<2,n.pinLocally=e.acl.can_pin&&1!==e.weight,n.unpin=e.acl.can_pin&&1===e.weight||e.acl.can_pin_globally&&2===e.weight,n.delete=e.acl.can_delete,n.enabled=n.edit||n.approve||n.close||n.open||n.hide||n.unhide||n.move||n.merge||n.pinGlobally||n.pinLocally||n.unpin||n.delete,n):n},zr=function(e,t){var n={enabled:!1,approve:!1,move:!1,merge:!1,protect:!1,hide:!1,delete:!1};return t.is_authenticated?(e.forEach(function(e){e.is_event||(e.acl.can_approve&&e.is_unapproved&&(n.approve=!0),e.acl.can_move&&(n.move=!0),e.acl.can_merge&&(n.merge=!0),(e.acl.can_protect||e.acl.can_unprotect)&&(n.protect=!0),(e.acl.can_hide||e.acl.can_unhide)&&(n.hide=!0),e.acl.can_delete&&(n.delete=!0),(n.approve||n.move||n.merge||n.protect||n.hide||n.delete)&&(n.enabled=!0))}),n):n};function Hr(e){return{participants:e.participants,poll:e.poll,posts:e.posts,thread:e.thread,tick:e.tick.tick,user:e.auth.user}}var Vr=n(88095);F.A.addInitializer({name:"component:thread",initializer:function(e){var t,n;e.has("THREAD")&&e.has("POSTS")&&(0,Vr.A)({paths:(t=F.A.get("THREAD"),n=t.url.index.replace(t.slug+"-"+t.pk,":slug"),[{path:n,component:(0,o.Ng)(Hr)(jr)},{path:n+":page/",component:(0,o.Ng)(Hr)(jr)}])})},after:"store"})},69387:(e,t,n)=>{"use strict";n.d(t,{A:()=>r});var a=n(23029),i=n(92901),o=n(74692);const r=new(function(){function e(){(0,a.A)(this,e)}return(0,i.A)(e,[{key:"init",value:function(e){this._staticUrl=e,this._included=[]}},{key:"include",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];-1===this._included.indexOf(e)&&(this._included.push(e),this._include(e,t))}},{key:"_include",value:function(e,t){o.ajax({url:(t?"":this._staticUrl)+e,cache:!0,dataType:"script"})}}]),e}())},70490:(e,t,n)=>{"use strict";n.d(t,{A:()=>l});var a=n(23029),i=n(92901),o=n(40961),r=n.n(o),s=n(92979),u=n(74692);const l=new(function(){function e(){(0,a.A)(this,e)}return(0,i.A)(e,[{key:"init",value:function(e){var t=this;this._element=e,this._modal=u(e).modal({show:!1}),this._modal.on("hidden.bs.modal",function(){r().unmountComponentAtNode(t._element)})}},{key:"show",value:function(e){(0,s.A)(e,this._element.id),this._modal.modal("show")}},{key:"hide",value:function(){this._modal.modal("hide")}}]),e}())},71569:(e,t,n)=>{"use strict";n.d(t,{Ay:()=>r,Ri:()=>o,ue:()=>a});var a={tick:0},i="TICK";function o(){return{type:i}}function r(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:a;return(arguments.length>1&&void 0!==arguments[1]?arguments[1]:null).type===i?Object.assign({},e,{tick:e.tick+1}):e}},72235:(e,t,n)=>{"use strict";n.d(t,{Ay:()=>u,Ui:()=>s,td:()=>r,ue:()=>a});var a={type:"info",message:"",isVisible:!1},i="SHOW_SNACKBAR",o="HIDE_SNACKBAR";function r(e,t){return{type:i,message:e,messageType:t}}function s(){return{type:o}}function u(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:a,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return t.type===i?{type:t.messageType,message:t.message,isVisible:!0}:t.type===o?Object.assign({},e,{isVisible:!1}):e}},72396:(e,t,n)=>{"use strict";var a=n(73971),i=n(32148),o=n(52762);a.A.addInitializer({name:"reducer:search",initializer:function(){o.A.addReducer("search",i.Ay,Object.assign({},i.ue,{providers:a.A.get("SEARCH_PROVIDERS")||[],query:a.A.get("SEARCH_QUERY")||""}))},before:"store"})},73639:(e,t,n)=>{"use strict";n.d(t,{A:()=>p});var a=n(73620),i=n(23029),o=n(92901),r=n(9417),s=n(15361),u=n(61801),l=n(53954),c=n(64467),d=n(40927);var p=function(e){(0,s.A)(p,e);var t,n,d=(t=p,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}(),function(){var e,a=(0,l.A)(t);if(n){var i=(0,l.A)(this).constructor;e=Reflect.construct(a,arguments,i)}else e=a.apply(this,arguments);return(0,u.A)(this,e)});function p(){var e;(0,i.A)(this,p);for(var t=arguments.length,n=new Array(t),a=0;a<t;a++)n[a]=arguments[a];return e=d.call.apply(d,[this].concat(n)),(0,c.A)((0,r.A)(e),"toggle",function(){e.props.onChange({target:{value:!e.props.value}})}),e}return(0,o.A)(p,[{key:"getClassName",value:function(){return this.props.value?"btn btn-yes-no btn-yes-no-on":"btn btn-yes-no btn-yes-no-off"}},{key:"getIcon",value:function(){return this.props.value?this.props.iconOn||"check_box":this.props.iconOff||"check_box_outline_blank"}},{key:"getLabel",value:function(){return this.props.value?this.props.labelOn||pgettext("yesno switch choice","yes"):this.props.labelOff||pgettext("yesno switch choice","no")}},{key:"render",value:function(){return(0,a.A)("button",{type:"button",onClick:this.toggle,className:this.getClassName(),id:this.props.id||null,"aria-describedby":this.props["aria-describedby"]||null,disabled:this.props.disabled||!1},void 0,(0,a.A)("span",{className:"material-icon"},void 0,this.getIcon()),(0,a.A)("span",{className:"btn-text"},void 0,this.getLabel()))}}]),p}(n.n(d)().Component)},73971:(e,t,n)=>{"use strict";n.d(t,{A:()=>gt});var a={};n.r(a),n.d(a,{V:()=>I});var i={};n.r(i),n.d(i,{aK:()=>f,jT:()=>g,Wv:()=>D,Tj:()=>a});var o=n(23029),r=n(92901),s=n(64467),u=(n(84234),n(46159),n(95296),n(14912),n(46129),n(71356),n(19028),n(84037));const l=function(){function e(t){(0,o.A)(this,e),this.isOrdered=!1,this._items=t||[]}return(0,r.A)(e,[{key:"add",value:function(e,t,n){this._items.push({key:e,item:t,after:n&&n.after||null,before:n&&n.before||null})}},{key:"get",value:function(e,t){for(var n=0;n<this._items.length;n++)if(this._items[n].key===e)return this._items[n].item;return t}},{key:"has",value:function(e){return void 0!==this.get(e)}},{key:"values",value:function(){for(var e=[],t=0;t<this._items.length;t++)e.push(this._items[t].item);return e}},{key:"order",value:function(e){return this.isOrdered||(this._items=this._order(this._items),this.isOrdered=!0),e||void 0===e?this.values():this._items}},{key:"orderedValues",value:function(){return this.order(!0)}},{key:"_order",value:function(e){var t=[];e.forEach(function(e){t.push(e.key)});var n=[],a=[];function i(e){var t=-1;-1===a.indexOf(e.key)&&(e.after?-1!==(t=a.indexOf(e.after))&&(t+=1):e.before&&(t=a.indexOf(e.before)),-1!==t&&(n.splice(t,0,e),a.splice(t,0,e.key)))}e.forEach(function(e){e.after||e.before||(n.push(e),a.push(e.key))}),e.forEach(function(e){"_end"===e.before&&(n.push(e),a.push(e.key))});for(var o=200;o>0&&t.length!==a.length;)o-=1,e.forEach(i);return n}}]),e}();function c(e){var t=e.closest("[hx-silent]");return!t||"true"!==t.getAttribute("hx-silent")}const d=(0,r.A)(function e(){var t=this;(0,o.A)(this,e),(0,s.A)(this,"show",function(){t.requests+=1,t.update()}),(0,s.A)(this,"hide",function(){t.requests&&(t.requests-=1,t.update())}),(0,s.A)(this,"update",function(){t.timeout&&window.clearTimeout(t.timeout),t.requests?(t.element.classList.add("busy"),t.element.classList.remove("complete")):(t.element.classList.remove("busy"),t.element.classList.add("complete"),t.timeout=setTimeout(function(){t.element.classList.remove("complete")},1500))}),this.element=document.getElementById("misago-ajax-loader"),this.requests=0,this.timeout=null});var p=n(74692);const h=(0,r.A)(function e(t){var n=this;(0,o.A)(this,e),(0,s.A)(this,"registerActions",function(){n.actions.forEach(function(e){"remove-selection"===e.getAttribute("moderation-action")?e.addEventListener("click",n.onRemoveSelection):e.addEventListener("click",n.onAction)})}),(0,s.A)(this,"onAction",function(e){var t=document.querySelector(n.form),a={};new FormData(t).forEach(function(e,t){void 0===a[t]&&(a[t]=[]),a[t].push(e)});var i=e.target;a.moderation=i.getAttribute("moderation-action"),"true"===i.getAttribute("moderation-multistage")?u.A.ajax("POST",document.location.href,{target:n.modal,swap:"innerHTML",values:a}).then(function(){p(n.modal).modal("show")}):u.A.ajax("POST",document.location.href,{target:"#misago-htmx-root",swap:"outerHTML",values:a})}),(0,s.A)(this,"onRemoveSelection",function(e){document.querySelectorAll(n.selection).forEach(function(e){e.checked=!1}),n.update()}),(0,s.A)(this,"registerEvents",function(){document.body.addEventListener("click",function(e){var t=e.target;"INPUT"===t.tagName&&"checkbox"===t.type&&n.update()}),u.A.onLoad(function(){return n.update()})}),(0,s.A)(this,"update",function(){var e=document.querySelectorAll(n.selection).length;n.control.innerText=n.text.replace("%(number)s",e),n.control.disabled=!e,n.menu&&(e?n.menu.classList.add("visible"):n.menu.classList.remove("visible"))}),this.menu=t.menu?document.querySelector(t.menu):null,this.form=t.form,this.modal=t.modal,this.actions=document.querySelectorAll(t.actions),this.selection=t.selection,this.control=document.querySelector(t.button.selector),this.text=t.button.text,this.update(),this.registerEvents(),this.registerActions()});const m=new(function(){function e(){(0,o.A)(this,e),this._shadow=null}return(0,r.A)(e,[{key:"getQueryBoundingClientRect",value:function(e,t){var n=this._getShadowElement(),a=e.getBoundingClientRect();n.style.width="".concat(a.width,"px"),n.style.height="".concat(a.height,"px"),n.setAttribute("class",e.getAttribute("class")),n.innerHTML=t.prefix||"";var i=document.createElement("span");i.innerHTML=t.value,n.appendChild(i);var o=n.getBoundingClientRect(),r=i.getBoundingClientRect();return{bottom:a.bottom-r.bottom-o.bottom+e.scrollTop,height:r.height,left:a.left+r.left-o.left,right:a.right-r.right-o.right,top:a.top+r.top-o.top-e.scrollTop,width:r.width,x:a.x+r.x-o.x,y:a.y+r.y-o.y}}},{key:"_getShadowElement",value:function(){if(this._shadow)return this._shadow;var e=this._createShadowElement();return document.body.appendChild(e),this._shadow=e,e}},{key:"_createShadowElement",value:function(){var e=document.createElement("pre");return e.ariaHidden=!0,e.style.position="absolute",e.style.top=0,e.style.left="-9999px",e.style.opacity=0,e.style.zIndex=-999,e}}]),e}()),f=(0,r.A)(function e(t){var n=this;(0,o.A)(this,e),(0,s.A)(this,"getTarget",function(e){var t=m.getQueryBoundingClientRect(n.element,e);return{getBoundingClientRect:function(){return t}}}),this.element=t});var v={Delete:!0,Space:!0,MetaLeft:!0,MetaRight:!0,End:!0,Enter:!0,ArrowUp:!0,ArrowDown:!0,ArrowLeft:!0,ArrowRight:!0},A={Escape:!0,Enter:!0,ArrowUp:!0,ArrowDown:!0};const g=(0,r.A)(function e(t){var n=this;(0,o.A)(this,e),(0,s.A)(this,"onKeyDown",function(e){A[e.code]&&n.select.visible&&e.preventDefault()}),(0,s.A)(this,"onKeyUp",function(e){if(n.keyCancel[e.code]&&n.select.visible)n.select.handleKey(e.code),e.preventDefault();else if(n.keyCancel[e.code])n.select.hide();else{var t=n.getQuery(e.target);t?n.showSuggestions(t):n.select.hide()}}),(0,s.A)(this,"showSuggestions",function(e){e.value.trim()&&(n._debounce&&(window.clearTimeout(n._debounce),n._debounce=null),n._debounce=window.setTimeout(function(){n.source(e,n.errors).then(function(t){n.select&&n.onSelect?n.select.show(e,t,n.onSelect):console.warn("Autocomplete was initialized without the 'select' or 'onSelect' options.")}).then(function(){n._debounce=null})},n._debounce?n.delay.debounced:n.delay.initial))}),(0,s.A)(this,"isEventTarget",function(e){return n.select.isEventTarget(e)}),this.control=t.control,this.anchor=t.anchor,this.source=t.source,this.getQuery=t.getQuery,this.select=t.select,this.errors=t.errors||!0,this.keyCancel=t.keyOverride?Object.assign({},v,t.keyOverride):v,this.onSelect=t.onSelect,this.delay={debounced:1e3,initial:100},t.delay&&(void 0!==t.delay.debounced&&(this.delay.debounced=t.delay.debounced),void 0!==t.delay.initial&&(this.delay.initial=t.delay.initial)),this._debounce=null,this.control.addEventListener("keydown",this.onKeyDown),this.control.addEventListener("keyup",this.onKeyUp)});var y=n(45458),b=n(17663);const D=function(){function e(t){var n=this;(0,o.A)(this,e),(0,s.A)(this,"handleKey",function(e){"Enter"===e?(n.callback(n.choices[n.choice],n.query),n.hide()):"ArrowUp"===e?(n.choice>0?n.choice--:n.choice=n.maxChoice,n.updateActiveChoice()):"ArrowDown"===e?(n.choice<n.maxChoice?n.choice++:n.choice=0,n.updateActiveChoice()):"Escape"===e&&n.hide()}),(0,s.A)(this,"isEventTarget",function(e){return e.relatedTarget?!!n.element.contains(e.relatedTarget):!!e.target&&!!n.element.contains(e.target)}),(0,s.A)(this,"show",function(e,t,a){if(0===t.length)n.hide();else{n.updateChoices(e,t,a),n.element.classList.add("show");var i=n.anchor.getTarget(e);(0,b.rD)(i,n.element,{placement:n.placement,middleware:[(0,b.cY)(n.offset),(0,b.UU)(),(0,b.BN)(n.shift)]}).then(function(e){var t=e.x,a=e.y;Object.assign(n.element.style,{left:"".concat(t,"px"),top:"".concat(a,"px")})}),n.choices=t,n.choice=0,n.maxChoice=t.length-1,n.query=e,n.callback=a,n.visible=!0}}),(0,s.A)(this,"hide",function(){n.element.classList.remove("show"),n.visible=!1}),this.element=document.createElement("div"),this.element.classList.add("autocomplete-user-popup"),document.body.appendChild(this.element),this.anchor=t.anchor,this.placement=t.placement||"bottom",this.offset=t.offset||6,this.shift=t.shift||{padding:8},this.choice=0,this.choices=[],this.maxChoice=0,this.query=null,this.callback=null,this.visible=!1,document.body.addEventListener("click",function(e){n.visible&&!n.element.contains(e.target)&&n.hide()})}return(0,r.A)(e,[{key:"updateChoices",value:function(e,t,n){var a,i=this,o=t.map(function(t,a){var o=document.createElement("button");o.setAttribute("type","button"),o.classList.add("autocomplete-user-popup-choice"),0===a&&o.classList.add("active");var r=t.avatar.filter(function(e){return e.size>=24}),s=t.avatar.filter(function(e){return e.size>=48}),u=document.createElement("img");u.classList.add("autocomplete-user-popup-choice-avatar"),u.setAttribute("src",r[r.length-1].url),u.setAttribute("srcset",s[s.length-1].url),u.setAttribute("alt",""),o.appendChild(u);var l=document.createElement("span");return l.classList.add("autocomplete-user-popup-choice-username"),l.innerText=t.username,o.appendChild(l),o.addEventListener("click",function(){n(t,e),i.hide()}),o});(a=this.element).replaceChildren.apply(a,(0,y.A)(o))}},{key:"updateActiveChoice",value:function(){for(var e=0;e<this.element.children.length;e++){var t=this.element.children[e];e===this.choice?t.classList.add("active"):t.classList.remove("active")}}}]),e}();var x=n(10467),k=n(54756),_=n.n(k);function N(e){return C.apply(this,arguments)}function C(){return(C=(0,x.A)(_().mark(function e(t){var n,a;return _().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===t.getResponseHeader||"application/json"!==t.getResponseHeader("content-type")){e.next=6;break}if(!(n=JSON.parse(t.response)).error){e.next=4;break}return e.abrupt("return",n.error);case 4:e.next=12;break;case 6:if("application/json"!==t.headers.get("content-type")){e.next=12;break}return e.next=9,t.json();case 9:if(!(a=e.sent).error){e.next=12;break}return e.abrupt("return",a.error);case 12:if(404!==t.status){e.next=14;break}return e.abrupt("return",pgettext("htmx response error","Page not found"));case 14:if(403!==t.status){e.next=16;break}return e.abrupt("return",pgettext("htmx response error","Permission denied"));case 16:if(0!==t.status){e.next=18;break}return e.abrupt("return",pgettext("htmx response error","Site could not be reached"));case 18:return e.abrupt("return",pgettext("htmx response error","Unexpected error"));case 19:case"end":return e.stop()}},e)}))).apply(this,arguments)}var E=document.getElementById("misago-snackbars"),w=null;function F(){E.replaceChildren()}function R(){w&&window.clearTimeout(w),E.querySelectorAll(".snackbar").forEach(function(e){e.classList.add("in")}),w=window.setTimeout(function(){E.querySelectorAll(".snackbar").forEach(function(e){e.classList.add("out"),w=window.setTimeout(F,1e3)})},6e3)}function S(e,t){F(),w&&window.clearTimeout(w);var n=document.createElement("div");n.classList.add("snackbar"),n.classList.add("snackbar-"+e),n.innerText=t,n.role="alert",E.appendChild(n),w=window.setTimeout(R,100)}function B(e){S("info",e)}function L(e){S("danger",e)}function T(e){return O.apply(this,arguments)}function O(){return(O=(0,x.A)(_().mark(function e(t){return _().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=S,e.next=3,N(t);case 3:e.t1=e.sent,(0,e.t0)("danger",e.t1);case 5:case"end":return e.stop()}},e)}))).apply(this,arguments)}u.A.onLoad(R);var P=new((0,r.A)(function e(){var t=this;(0,o.A)(this,e),(0,s.A)(this,"get",function(e,n){var a=e.value,i=e.exclude,o=t.url+"?query="+encodeURIComponent(a);return i&&Array.isArray(i)&&i.forEach(function(e){e&&(o+="&exclude="+encodeURIComponent(e))}),t.cache[o]?Promise.resolve(t.cache[o]):fetch(o).then(function(){var e=(0,x.A)(_().mark(function e(a){var i,r;return _().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(a.ok){e.next=4;break}return n&&T(a),console.error(a),e.abrupt("return",[]);case 4:return e.next=6,a.json();case 6:return i=e.sent,r=i.results,t.cache[o]=r,e.abrupt("return",r);case 10:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),function(){return[]})}),this.cache={},this.url=window.misago_suggest_users}));function I(e,t){return P.get(e,t)}function q(e,t){e.classList.remove("animation-fade-in"),e.querySelectorAll("button, input, select, textarea").forEach(function(e){e.setAttribute("disabled","")}),e.addEventListener("animationend",function(n){"deleteElementAnimation"===n.animationName&&(e.remove(),t&&t())}),e.classList.add("animation-delete")}function U(e,t){e.querySelectorAll("button, input, select, textarea").forEach(function(e){e.setAttribute("disabled","")}),e.classList.add("animation-slide-up");var n,a=t&&t.duration||350,i=e.clientHeight,o=e.style.opacity||1;e.style.overflow="hidden",requestAnimationFrame(function r(s){void 0===n&&(n=s);var u=Math.min((s-n)/a,1),l=Math.sin((1-u)*Math.PI/2);e.style.height=Math.floor(i*l)+"px",e.style.opacity=o*l,u<1?requestAnimationFrame(r):(e.remove(),t&&t.callback&&t.callback())})}n(38791);var j={};function M(e){if(!e.getAttribute("misago-validate-active")){var t=e.getAttribute("misago-validate"),n=e.getAttribute("misago-validate-user"),a="false"!=e.getAttribute("misago-validate-strip"),i=e.querySelector("input"),o=i.closest("form").querySelector("input[type=hidden]");if(t&&i){j[t]||(j[t]={}),e.setAttribute("misago-validate-active","true");var r=null;i.addEventListener("keyup",function(s){var u=s.target.value;a&&(u=u.trim()),0!==u.trim().length?j[t][u]?z(e,i,j[t][u]):(r&&window.clearTimeout(r),r=window.setTimeout((0,x.A)(_().mark(function a(){var r,s;return _().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,V(t,o,u,n);case 2:r=a.sent,s=r.errors,j[t][u]=s,z(e,i,s);case 6:case"end":return a.stop()}},a)})),1e3)):function(e){e.classList.remove("has-error"),e.classList.remove("has-success"),H(e)}(e)})}}}function z(e,t,n){n.length?function(e,t,n){e.classList.remove("has-success"),e.classList.add("has-error"),H(e),n.forEach(function(e){var n=document.createElement("p");n.className="help-block",n.setAttribute("misago-dynamic-message","true"),n.innerText=e,t.after(n)})}(e,t,n):function(e){e.classList.remove("has-error"),e.classList.add("has-success"),H(e)}(e)}function H(e){e.querySelectorAll("[misago-dynamic-message]").forEach(function(e){return e.remove()})}function V(e,t,n,a){return Y.apply(this,arguments)}function Y(){return(Y=(0,x.A)(_().mark(function e(t,n,a,i){var o,r;return _().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return(o=new FormData).set(n.name,n.value),o.set("value",a),i&&o.set("user",i),e.next=6,fetch(t,{method:"POST",mode:"cors",credentials:"same-origin",body:o});case 6:return r=e.sent,e.next=9,r.json();case 9:return e.abrupt("return",e.sent);case 10:case"end":return e.stop()}},e)}))).apply(this,arguments)}function W(e){var t,n,a=e.detail;return!("true"===(t=a.target,n=t.closest("[hx-silent]"),n?n.getAttribute("hx-silent"):null)&&"get"===a.requestConfig.verb)}u.A.onLoad(function(e){(e||document).querySelectorAll("[misago-validate]").forEach(M)}),document.addEventListener("htmx:responseError",function(e){W(e)&&T(e.detail.xhr)}),document.addEventListener("htmx:sendError",function(e){W(e)&&L(pgettext("htmx response error","Site could not be reached"))}),document.addEventListener("htmx:timeout",function(e){W(e)&&L(pgettext("htmx response error","Site took too long to reply"))});var G={};u.A.defineExtension("loader-tpl",{onEvent:function(e,t){if("htmx:beforeRequest"===e&&t.target&&t.detail&&t.detail.target){var n=function(e){var t=function(e,t){var n=e.closest("["+t+"]");return n?n.getAttribute(t):null}(e,"tpl-loader");if(!t)return null;if(void 0===G[t]){var n=document.querySelector(t);G[t]=n||null}return G[t]}(t.target);n&&t.detail.target.replaceChildren(n.content.cloneNode(!0))}}});var Q=n(79678),K={};function X(e){var t=e.getAttribute("misago-timestamp"),n=e.getAttribute("misago-timestamp-format");K[t]||(K[t]=new Date(t)),"full"===n||e.hasAttribute("misago-timestamp-title")||(e.setAttribute("misago-timestamp-title","true"),e.setAttribute("title",Q.hs.format(K[t]))),e.textContent="short"===n?(0,Q.H7)(K[t]):"full"===n?Q.hs.format(K[t]):(0,Q.FI)(K[t])}function J(e){(e||document).querySelectorAll("[misago-timestamp]").forEach(X)}document.querySelectorAll("[misago-timestamp]").forEach(X),J(),window.setInterval(J,55e3),u.A.onLoad(J);var $=n(74692),Z=function(){function e(){var t=this;(0,o.A)(this,e),(0,s.A)(this,"_onDOMContentLoaded",function(){t.modal=document.getElementById("misago-lightbox-modal"),t.modal&&(t.pager=t.modal.querySelector("[misago-lightbox-pager]"),t.details=t.modal.querySelector("[misago-lightbox-details]"),t.zoom=t.modal.querySelector("[misago-lightbox-zoom]"),t.download=t.modal.querySelector("[misago-lightbox-download]"),t.link=t.modal.querySelector("[misago-lightbox-link]"),t.container=t.modal.querySelector("[misago-lightbox-container]"),t.caption=t.modal.querySelector("[misago-lightbox-caption]"),t.template=document.getElementById("lightbox-image-caption"),t._registerEvents())}),this.modal=null,this.pager=null,this.details=null,this.zoom=null,this.download=null,this.link=null,this.container=null,this.caption=null,this.state=null,this.template=null,document.addEventListener("DOMContentLoaded",this._onDOMContentLoaded)}return(0,r.A)(e,[{key:"_registerEvents",value:function(){var e=this;document.addEventListener("click",function(t){var n=t.target.closest("img[misago-lightbox-media]");if(n)e.onImageClick(t,n);else{var a=t.target.closest("[misago-lightbox-button]");a&&e.onMediaButtonClick(t,a)}}),this.modal.querySelector("[data-dismiss]").addEventListener("click",function(){e.onHideLightbox()}),this.modal.querySelector("[misago-lightbox-previous]").addEventListener("click",function(){e.state.index=(e.state.index||e.state.total)-1,e.state.media=e.state.items[e.state.index],e.updateLightbox()}),this.modal.querySelector("[misago-lightbox-next]").addEventListener("click",function(){e.state.index+=1,e.state.index===e.state.total&&(e.state.index=0),e.state.media=e.state.items[e.state.index],e.updateLightbox()})}},{key:"onImageClick",value:function(e,t){e.preventDefault();var n=t.closest("[misago-lightbox-root]");this.state=this.getInitialState(n,t),this.updateLightbox(),this.showLightbox()}},{key:"onMediaButtonClick",value:function(e,t){e.preventDefault();var n=t.closest("[misago-lightbox-root]"),a=t.closest("[misago-lightbox-context]").querySelector("[misago-lightbox-media]");this.state=this.getInitialState(n,a),this.updateLightbox(),this.showLightbox()}},{key:"getInitialState",value:function(e,t){var n=this.getRootMedia(e,t),a=n.map(function(e){return e.active}).indexOf(!0);return{items:n,media:n[a],index:a,total:n.length}}},{key:"getRootMedia",value:function(e,t){var n=[];return e.querySelectorAll("[misago-lightbox-media]").forEach(function(e){var a=e.closest("[misago-lightbox-context]"),i=e.closest("a");n.push({element:e,active:e===t,video:"VIDEO"===e.tagName,image:"IMG"===e.tagName,caption:a?a.querySelector("template"):null,details:a?a.getAttribute("misago-lightbox-details"):null,download:a?a.getAttribute("misago-lightbox-download"):null,link:!a&&i,url:a?a.getAttribute("misago-lightbox-url"):e.getAttribute("src")})}),n}},{key:"updateLightbox",value:function(){this.updateLightboxPager(),this.updateLightboxOptions(),this.updateLightboxNav(),this.updateLightboxContainer(),this.updateLightboxCaption()}},{key:"updateLightboxPager",value:function(){var e=this.state,t=this.pager;e.total>1?(t.textContent=t.getAttribute("misago-lightbox-pager").replace("%(total)s",e.total).replace("%(index)s",e.index+1),t.classList.remove("d-none")):(t.textContent="",t.classList.add("d-none"))}},{key:"updateLightboxOptions",value:function(){var e=this.state.media;this.updateLightboxOption(this.details,e.details),this.updateLightboxOption(this.download,e.download&&e.url),this.updateLightboxOption(this.link,e.link&&e.link.href),this.updateLightboxOption(this.zoom,e.url)}},{key:"updateLightboxOption",value:function(e,t){t?(e.setAttribute("href",t),e.classList.remove("d-none")):e.classList.add("d-none")}},{key:"updateLightboxNav",value:function(){var e=this.state;this.modal.querySelectorAll("[misago-lightbox-previous], [misago-lightbox-next]").forEach(function(t){e.total>1?t.classList.remove("d-none"):t.classList.add("d-none")})}},{key:"updateLightboxContainer",value:function(){var e=this.state,t=this.container,n=e.media;n.image?this.updateLightboxContainerWithImage(t,n):n.video&&this.updateLightboxContainerWithVideo(t,n)}},{key:"updateLightboxContainerWithImage",value:function(e,t){var n=document.createElement("img");n.setAttribute("src",t.url),n.setAttribute("alt","");var a=document.createElement("a");a.setAttribute("href",t.url),a.setAttribute("target","_blank"),a.appendChild(n),e.replaceChildren(a)}},{key:"updateLightboxContainerWithVideo",value:function(e,t){var n=document.createElement("video");n.innerHTML=t.element.innerHTML,n.setAttribute("controls","true"),n.setAttribute("preload","metadata"),e.replaceChildren(n)}},{key:"updateLightboxCaption",value:function(){var e=this.state,t=this.caption,n=e.media;if(n.caption){var a=n.caption.content.cloneNode(!0);J(a),t.replaceChildren(a)}else{var i=this.template.content.cloneNode(!0),o=i.querySelector("[lightbox-image-caption-name]"),r=i.querySelector("[lightbox-image-caption-description]");o.removeAttribute("lightbox-image-caption-name"),r.removeAttribute("lightbox-image-caption-description");var s=(n.element.getAttribute("alt")||"").trim(),u=(n.element.getAttribute("title")||"").trim(),l=n.element.getAttribute("src"),c=u&&s?u+" â€” "+s:u||s||this.cleanDisplayFilename(l);if(o.textContent=this.shortenLongString(c),o.textContent!==c&&o.setAttribute("title",c),n.link){var d=document.createElement("a"),p=n.link.getAttribute("href");d.setAttribute("href",p),d.setAttribute("target","_blank"),d.textContent=this.cleanDisplayUrl(p),r.appendChild(d)}else u||s?r.textContent=this.cleanDisplayUrl(l):r.remove();t.replaceChildren(i)}}},{key:"cleanDisplayFilename",value:function(e){var t=e.lastIndexOf("/");if(-1===t)return this.cleanDisplayUrl(e);var n=e.substring(t+1).trim();return n?this.shortenLongString(n):this.cleanDisplayUrl(e)}},{key:"cleanDisplayUrl",value:function(e){var t=e;return t.startsWith("https://")?t=t.substring(8):t.startsWith("http://")&&(t=t.substring(7)),this.shortenLongString(t)}},{key:"shortenLongString",value:function(e){return e.length<=80?e:e.substring(0,35)+"..."+e.substring(e.length-40)}},{key:"showLightbox",value:function(){document.querySelectorAll("video").forEach(function(e){return e.pause()}),$(this.modal).modal("show")}},{key:"onHideLightbox",value:function(){this.modal.querySelectorAll("video").forEach(function(e){return e.pause()})}}]),e}(),ee=/(^|(?:(?![0-9A-Za-z\xAA\xB2\xB3\xB5\xB9\xBA\xBC-\xBE\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0560-\u0588\u05D0-\u05EA\u05EF-\u05F2\u0620-\u064A\u0660-\u0669\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07C0-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u0860-\u086A\u0870-\u0887\u0889-\u088E\u08A0-\u08C9\u0904-\u0939\u093D\u0950\u0958-\u0961\u0966-\u096F\u0971-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09E6-\u09F1\u09F4-\u09F9\u09FC\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A66-\u0A6F\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0AE6-\u0AEF\u0AF9\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B66-\u0B6F\u0B71-\u0B77\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0BE6-\u0BF2\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C5D\u0C60\u0C61\u0C66-\u0C6F\u0C78-\u0C7E\u0C80\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDD\u0CDE\u0CE0\u0CE1\u0CE6-\u0CEF\u0CF1\u0CF2\u0D04-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D54-\u0D56\u0D58-\u0D61\u0D66-\u0D78\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0DE6-\u0DEF\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E50-\u0E59\u0E81\u0E82\u0E84\u0E86-\u0E8A\u0E8C-\u0EA3\u0EA5\u0EA7-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0ED0-\u0ED9\u0EDC-\u0EDF\u0F00\u0F20-\u0F33\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F-\u1049\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u1090-\u1099\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1369-\u137C\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16EE-\u16F8\u1700-\u1711\u171F-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u17E0-\u17E9\u17F0-\u17F9\u1810-\u1819\u1820-\u1878\u1880-\u1884\u1887-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1946-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u19D0-\u19DA\u1A00-\u1A16\u1A20-\u1A54\u1A80-\u1A89\u1A90-\u1A99\u1AA7\u1B05-\u1B33\u1B45-\u1B4C\u1B50-\u1B59\u1B83-\u1BA0\u1BAE-\u1BE5\u1C00-\u1C23\u1C40-\u1C49\u1C4D-\u1C7D\u1C80-\u1C88\u1C90-\u1CBA\u1CBD-\u1CBF\u1CE9-\u1CEC\u1CEE-\u1CF3\u1CF5\u1CF6\u1CFA\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2070\u2071\u2074-\u2079\u207F-\u2089\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2150-\u2189\u2460-\u249B\u24EA-\u24FF\u2776-\u2793\u2C00-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2CFD\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005-\u3007\u3021-\u3029\u3031-\u3035\u3038-\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312F\u3131-\u318E\u3192-\u3195\u31A0-\u31BF\u31F0-\u31FF\u3220-\u3229\u3248-\u324F\u3251-\u325F\u3280-\u3289\u32B1-\u32BF\u3400-\u4DBF\u4E00-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6EF\uA717-\uA71F\uA722-\uA788\uA78B-\uA7CA\uA7D0\uA7D1\uA7D3\uA7D5-\uA7D9\uA7F2-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA830-\uA835\uA840-\uA873\uA882-\uA8B3\uA8D0-\uA8D9\uA8F2-\uA8F7\uA8FB\uA8FD\uA8FE\uA900-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF-\uA9D9\uA9E0-\uA9E4\uA9E6-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA50-\uAA59\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB69\uAB70-\uABE2\uABF0-\uABF9\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF10-\uFF19\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDD07-\uDD33\uDD40-\uDD78\uDD8A\uDD8B\uDE80-\uDE9C\uDEA0-\uDED0\uDEE1-\uDEFB\uDF00-\uDF23\uDF2D-\uDF4A\uDF50-\uDF75\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF\uDFD1-\uDFD5]|\uD801[\uDC00-\uDC9D\uDCA0-\uDCA9\uDCB0-\uDCD3\uDCD8-\uDCFB\uDD00-\uDD27\uDD30-\uDD63\uDD70-\uDD7A\uDD7C-\uDD8A\uDD8C-\uDD92\uDD94\uDD95\uDD97-\uDDA1\uDDA3-\uDDB1\uDDB3-\uDDB9\uDDBB\uDDBC\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67\uDF80-\uDF85\uDF87-\uDFB0\uDFB2-\uDFBA]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC58-\uDC76\uDC79-\uDC9E\uDCA7-\uDCAF\uDCE0-\uDCF2\uDCF4\uDCF5\uDCFB-\uDD1B\uDD20-\uDD39\uDD80-\uDDB7\uDDBC-\uDDCF\uDDD2-\uDE00\uDE10-\uDE13\uDE15-\uDE17\uDE19-\uDE35\uDE40-\uDE48\uDE60-\uDE7E\uDE80-\uDE9F\uDEC0-\uDEC7\uDEC9-\uDEE4\uDEEB-\uDEEF\uDF00-\uDF35\uDF40-\uDF55\uDF58-\uDF72\uDF78-\uDF91\uDFA9-\uDFAF]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2\uDCFA-\uDD23\uDD30-\uDD39\uDE60-\uDE7E\uDE80-\uDEA9\uDEB0\uDEB1\uDF00-\uDF27\uDF30-\uDF45\uDF51-\uDF54\uDF70-\uDF81\uDFB0-\uDFCB\uDFE0-\uDFF6]|\uD804[\uDC03-\uDC37\uDC52-\uDC6F\uDC71\uDC72\uDC75\uDC83-\uDCAF\uDCD0-\uDCE8\uDCF0-\uDCF9\uDD03-\uDD26\uDD36-\uDD3F\uDD44\uDD47\uDD50-\uDD72\uDD76\uDD83-\uDDB2\uDDC1-\uDDC4\uDDD0-\uDDDA\uDDDC\uDDE1-\uDDF4\uDE00-\uDE11\uDE13-\uDE2B\uDE3F\uDE40\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEDE\uDEF0-\uDEF9\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3D\uDF50\uDF5D-\uDF61]|\uD805[\uDC00-\uDC34\uDC47-\uDC4A\uDC50-\uDC59\uDC5F-\uDC61\uDC80-\uDCAF\uDCC4\uDCC5\uDCC7\uDCD0-\uDCD9\uDD80-\uDDAE\uDDD8-\uDDDB\uDE00-\uDE2F\uDE44\uDE50-\uDE59\uDE80-\uDEAA\uDEB8\uDEC0-\uDEC9\uDF00-\uDF1A\uDF30-\uDF3B\uDF40-\uDF46]|\uD806[\uDC00-\uDC2B\uDCA0-\uDCF2\uDCFF-\uDD06\uDD09\uDD0C-\uDD13\uDD15\uDD16\uDD18-\uDD2F\uDD3F\uDD41\uDD50-\uDD59\uDDA0-\uDDA7\uDDAA-\uDDD0\uDDE1\uDDE3\uDE00\uDE0B-\uDE32\uDE3A\uDE50\uDE5C-\uDE89\uDE9D\uDEB0-\uDEF8]|\uD807[\uDC00-\uDC08\uDC0A-\uDC2E\uDC40\uDC50-\uDC6C\uDC72-\uDC8F\uDD00-\uDD06\uDD08\uDD09\uDD0B-\uDD30\uDD46\uDD50-\uDD59\uDD60-\uDD65\uDD67\uDD68\uDD6A-\uDD89\uDD98\uDDA0-\uDDA9\uDEE0-\uDEF2\uDF02\uDF04-\uDF10\uDF12-\uDF33\uDF50-\uDF59\uDFB0\uDFC0-\uDFD4]|\uD808[\uDC00-\uDF99]|\uD809[\uDC00-\uDC6E\uDC80-\uDD43]|\uD80B[\uDF90-\uDFF0]|[\uD80C\uD81C-\uD820\uD822\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872\uD874-\uD879\uD880-\uD883\uD885-\uD887][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2F\uDC41-\uDC46]|\uD811[\uDC00-\uDE46]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDE60-\uDE69\uDE70-\uDEBE\uDEC0-\uDEC9\uDED0-\uDEED\uDF00-\uDF2F\uDF40-\uDF43\uDF50-\uDF59\uDF5B-\uDF61\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDE40-\uDE96\uDF00-\uDF4A\uDF50\uDF93-\uDF9F\uDFE0\uDFE1\uDFE3]|\uD821[\uDC00-\uDFF7]|\uD823[\uDC00-\uDCD5\uDD00-\uDD08]|\uD82B[\uDFF0-\uDFF3\uDFF5-\uDFFB\uDFFD\uDFFE]|\uD82C[\uDC00-\uDD22\uDD32\uDD50-\uDD52\uDD55\uDD64-\uDD67\uDD70-\uDEFB]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99]|\uD834[\uDEC0-\uDED3\uDEE0-\uDEF3\uDF60-\uDF78]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB\uDFCE-\uDFFF]|\uD837[\uDF00-\uDF1E\uDF25-\uDF2A]|\uD838[\uDC30-\uDC6D\uDD00-\uDD2C\uDD37-\uDD3D\uDD40-\uDD49\uDD4E\uDE90-\uDEAD\uDEC0-\uDEEB\uDEF0-\uDEF9]|\uD839[\uDCD0-\uDCEB\uDCF0-\uDCF9\uDFE0-\uDFE6\uDFE8-\uDFEB\uDFED\uDFEE\uDFF0-\uDFFE]|\uD83A[\uDC00-\uDCC4\uDCC7-\uDCCF\uDD00-\uDD43\uDD4B\uDD50-\uDD59]|\uD83B[\uDC71-\uDCAB\uDCAD-\uDCAF\uDCB1-\uDCB4\uDD01-\uDD2D\uDD2F-\uDD3D\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD83C[\uDD00-\uDD0C]|\uD83E[\uDFF0-\uDFF9]|\uD869[\uDC00-\uDEDF\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF39\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0]|\uD87E[\uDC00-\uDE1D]|\uD884[\uDC00-\uDF4A\uDF50-\uDFFF]|\uD888[\uDC00-\uDFAF])[\s\S]))@[\x2D0-9_a-z\u017F\u212A]*$/gi,te=/^(?:[0-9A-Za-z\xAA\xB2\xB3\xB5\xB9\xBA\xBC-\xBE\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0560-\u0588\u05D0-\u05EA\u05EF-\u05F2\u0620-\u064A\u0660-\u0669\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07C0-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u0860-\u086A\u0870-\u0887\u0889-\u088E\u08A0-\u08C9\u0904-\u0939\u093D\u0950\u0958-\u0961\u0966-\u096F\u0971-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09E6-\u09F1\u09F4-\u09F9\u09FC\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A66-\u0A6F\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0AE6-\u0AEF\u0AF9\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B66-\u0B6F\u0B71-\u0B77\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0BE6-\u0BF2\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C5D\u0C60\u0C61\u0C66-\u0C6F\u0C78-\u0C7E\u0C80\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDD\u0CDE\u0CE0\u0CE1\u0CE6-\u0CEF\u0CF1\u0CF2\u0D04-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D54-\u0D56\u0D58-\u0D61\u0D66-\u0D78\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0DE6-\u0DEF\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E50-\u0E59\u0E81\u0E82\u0E84\u0E86-\u0E8A\u0E8C-\u0EA3\u0EA5\u0EA7-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0ED0-\u0ED9\u0EDC-\u0EDF\u0F00\u0F20-\u0F33\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F-\u1049\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u1090-\u1099\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1369-\u137C\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16EE-\u16F8\u1700-\u1711\u171F-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u17E0-\u17E9\u17F0-\u17F9\u1810-\u1819\u1820-\u1878\u1880-\u1884\u1887-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1946-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u19D0-\u19DA\u1A00-\u1A16\u1A20-\u1A54\u1A80-\u1A89\u1A90-\u1A99\u1AA7\u1B05-\u1B33\u1B45-\u1B4C\u1B50-\u1B59\u1B83-\u1BA0\u1BAE-\u1BE5\u1C00-\u1C23\u1C40-\u1C49\u1C4D-\u1C7D\u1C80-\u1C88\u1C90-\u1CBA\u1CBD-\u1CBF\u1CE9-\u1CEC\u1CEE-\u1CF3\u1CF5\u1CF6\u1CFA\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2070\u2071\u2074-\u2079\u207F-\u2089\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2150-\u2189\u2460-\u249B\u24EA-\u24FF\u2776-\u2793\u2C00-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2CFD\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005-\u3007\u3021-\u3029\u3031-\u3035\u3038-\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312F\u3131-\u318E\u3192-\u3195\u31A0-\u31BF\u31F0-\u31FF\u3220-\u3229\u3248-\u324F\u3251-\u325F\u3280-\u3289\u32B1-\u32BF\u3400-\u4DBF\u4E00-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6EF\uA717-\uA71F\uA722-\uA788\uA78B-\uA7CA\uA7D0\uA7D1\uA7D3\uA7D5-\uA7D9\uA7F2-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA830-\uA835\uA840-\uA873\uA882-\uA8B3\uA8D0-\uA8D9\uA8F2-\uA8F7\uA8FB\uA8FD\uA8FE\uA900-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF-\uA9D9\uA9E0-\uA9E4\uA9E6-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA50-\uAA59\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB69\uAB70-\uABE2\uABF0-\uABF9\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF10-\uFF19\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDD07-\uDD33\uDD40-\uDD78\uDD8A\uDD8B\uDE80-\uDE9C\uDEA0-\uDED0\uDEE1-\uDEFB\uDF00-\uDF23\uDF2D-\uDF4A\uDF50-\uDF75\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF\uDFD1-\uDFD5]|\uD801[\uDC00-\uDC9D\uDCA0-\uDCA9\uDCB0-\uDCD3\uDCD8-\uDCFB\uDD00-\uDD27\uDD30-\uDD63\uDD70-\uDD7A\uDD7C-\uDD8A\uDD8C-\uDD92\uDD94\uDD95\uDD97-\uDDA1\uDDA3-\uDDB1\uDDB3-\uDDB9\uDDBB\uDDBC\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67\uDF80-\uDF85\uDF87-\uDFB0\uDFB2-\uDFBA]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC58-\uDC76\uDC79-\uDC9E\uDCA7-\uDCAF\uDCE0-\uDCF2\uDCF4\uDCF5\uDCFB-\uDD1B\uDD20-\uDD39\uDD80-\uDDB7\uDDBC-\uDDCF\uDDD2-\uDE00\uDE10-\uDE13\uDE15-\uDE17\uDE19-\uDE35\uDE40-\uDE48\uDE60-\uDE7E\uDE80-\uDE9F\uDEC0-\uDEC7\uDEC9-\uDEE4\uDEEB-\uDEEF\uDF00-\uDF35\uDF40-\uDF55\uDF58-\uDF72\uDF78-\uDF91\uDFA9-\uDFAF]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2\uDCFA-\uDD23\uDD30-\uDD39\uDE60-\uDE7E\uDE80-\uDEA9\uDEB0\uDEB1\uDF00-\uDF27\uDF30-\uDF45\uDF51-\uDF54\uDF70-\uDF81\uDFB0-\uDFCB\uDFE0-\uDFF6]|\uD804[\uDC03-\uDC37\uDC52-\uDC6F\uDC71\uDC72\uDC75\uDC83-\uDCAF\uDCD0-\uDCE8\uDCF0-\uDCF9\uDD03-\uDD26\uDD36-\uDD3F\uDD44\uDD47\uDD50-\uDD72\uDD76\uDD83-\uDDB2\uDDC1-\uDDC4\uDDD0-\uDDDA\uDDDC\uDDE1-\uDDF4\uDE00-\uDE11\uDE13-\uDE2B\uDE3F\uDE40\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEDE\uDEF0-\uDEF9\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3D\uDF50\uDF5D-\uDF61]|\uD805[\uDC00-\uDC34\uDC47-\uDC4A\uDC50-\uDC59\uDC5F-\uDC61\uDC80-\uDCAF\uDCC4\uDCC5\uDCC7\uDCD0-\uDCD9\uDD80-\uDDAE\uDDD8-\uDDDB\uDE00-\uDE2F\uDE44\uDE50-\uDE59\uDE80-\uDEAA\uDEB8\uDEC0-\uDEC9\uDF00-\uDF1A\uDF30-\uDF3B\uDF40-\uDF46]|\uD806[\uDC00-\uDC2B\uDCA0-\uDCF2\uDCFF-\uDD06\uDD09\uDD0C-\uDD13\uDD15\uDD16\uDD18-\uDD2F\uDD3F\uDD41\uDD50-\uDD59\uDDA0-\uDDA7\uDDAA-\uDDD0\uDDE1\uDDE3\uDE00\uDE0B-\uDE32\uDE3A\uDE50\uDE5C-\uDE89\uDE9D\uDEB0-\uDEF8]|\uD807[\uDC00-\uDC08\uDC0A-\uDC2E\uDC40\uDC50-\uDC6C\uDC72-\uDC8F\uDD00-\uDD06\uDD08\uDD09\uDD0B-\uDD30\uDD46\uDD50-\uDD59\uDD60-\uDD65\uDD67\uDD68\uDD6A-\uDD89\uDD98\uDDA0-\uDDA9\uDEE0-\uDEF2\uDF02\uDF04-\uDF10\uDF12-\uDF33\uDF50-\uDF59\uDFB0\uDFC0-\uDFD4]|\uD808[\uDC00-\uDF99]|\uD809[\uDC00-\uDC6E\uDC80-\uDD43]|\uD80B[\uDF90-\uDFF0]|[\uD80C\uD81C-\uD820\uD822\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872\uD874-\uD879\uD880-\uD883\uD885-\uD887][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2F\uDC41-\uDC46]|\uD811[\uDC00-\uDE46]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDE60-\uDE69\uDE70-\uDEBE\uDEC0-\uDEC9\uDED0-\uDEED\uDF00-\uDF2F\uDF40-\uDF43\uDF50-\uDF59\uDF5B-\uDF61\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDE40-\uDE96\uDF00-\uDF4A\uDF50\uDF93-\uDF9F\uDFE0\uDFE1\uDFE3]|\uD821[\uDC00-\uDFF7]|\uD823[\uDC00-\uDCD5\uDD00-\uDD08]|\uD82B[\uDFF0-\uDFF3\uDFF5-\uDFFB\uDFFD\uDFFE]|\uD82C[\uDC00-\uDD22\uDD32\uDD50-\uDD52\uDD55\uDD64-\uDD67\uDD70-\uDEFB]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99]|\uD834[\uDEC0-\uDED3\uDEE0-\uDEF3\uDF60-\uDF78]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB\uDFCE-\uDFFF]|\uD837[\uDF00-\uDF1E\uDF25-\uDF2A]|\uD838[\uDC30-\uDC6D\uDD00-\uDD2C\uDD37-\uDD3D\uDD40-\uDD49\uDD4E\uDE90-\uDEAD\uDEC0-\uDEEB\uDEF0-\uDEF9]|\uD839[\uDCD0-\uDCEB\uDCF0-\uDCF9\uDFE0-\uDFE6\uDFE8-\uDFEB\uDFED\uDFEE\uDFF0-\uDFFE]|\uD83A[\uDC00-\uDCC4\uDCC7-\uDCCF\uDD00-\uDD43\uDD4B\uDD50-\uDD59]|\uD83B[\uDC71-\uDCAB\uDCAD-\uDCAF\uDCB1-\uDCB4\uDD01-\uDD2D\uDD2F-\uDD3D\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD83C[\uDD00-\uDD0C]|\uD83E[\uDFF0-\uDFF9]|\uD869[\uDC00-\uDEDF\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF39\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0]|\uD87E[\uDC00-\uDE1D]|\uD884[\uDC00-\uDF4A\uDF50-\uDFFF]|\uD888[\uDC00-\uDFAF])/gi;const ne=function(){function e(t){var n=this;(0,o.A)(this,e),(0,s.A)(this,"getQuery",function(e){var t=n.getSelection(e),a=t.start,i=t.end,o=t.closed,r=t.prefix,s=t.suffix;if(!o)return null;var u=r.match(ee),l=s.match(te),c=u?u[0].trim():"",d=l?l[0].trim():"";return c.length<2||d?null:{control:e,start:a-c.length,end:i,prefix:r.substring(0,a-c.length+1),value:c.substring(1)}}),(0,s.A)(this,"onSelect",function(e,t){var n=t.control,a=t.start,i=t.end,o=e.username,r=n.value,s=r.substring(0,a),u=r.substring(i);n.value=s+"@"+o+" "+u,window.setTimeout(function(){var e=n.scrollTop;n.focus(),n.scrollTop=e;var t=a+o.length+2;n.setSelectionRange(t,t)},100)}),this.autocomplete=new g({control:t,source:I,select:new D({anchor:new f(t),placement:"top"}),getQuery:this.getQuery,onSelect:this.onSelect})}return(0,r.A)(e,[{key:"getSelection",value:function(e){var t=e.value,n=e.selectionStart,a=e.selectionEnd,i=t.substring(0,n),o=t.substring(a),r=n<a?t.substring(n,a):"";return{text:t,start:n,end:a,closed:n===a,value:r,prefix:i,suffix:o}}}]),e}();var ae="csrfmiddlewaretoken";function ie(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}function oe(e,t){var n=e.content.cloneNode(!0);return n.querySelectorAll("[misago-tpl-if]").forEach(function(e){var n=e.getAttribute("misago-tpl-if");re(t,n)?e.removeAttribute("misago-tpl-if"):e.remove()}),n.querySelectorAll("[misago-tpl-ifnot]").forEach(function(e){var n=e.getAttribute("misago-tpl-ifnot");re(t,n)?e.remove():e.removeAttribute("misago-tpl-ifnot")}),n.querySelectorAll("[misago-tpl-var]").forEach(function(e){var n=e.getAttribute("misago-tpl-var");e.innerText=re(t,n)||"",e.removeAttribute("misago-tpl-var")}),n.querySelectorAll("[misago-tpl-attr]").forEach(function(e){var n=e.getAttribute("misago-tpl-attr");if(":"!==n.indexOf(":")){var a=n.substring(0,n.indexOf(":")).trim(),i=n.substring(n.indexOf(":")+1).trim(),o=i?re(t,i):void 0;a&&o&&e.setAttribute(a,o)}e.removeAttribute("misago-tpl-attr")}),n}function re(e,t){if(-1===t.indexOf("."))return e[t];var n,a=e,i=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return ie(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ie(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var a=0,i=function(){};return{s:i,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,r=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return r=e.done,e},e:function(e){s=!0,o=e},f:function(){try{r||null==n.return||n.return()}finally{if(s)throw o}}}}(t.split("."));try{for(i.s();!(n=i.n()).done;){var o=n.value;if(!o||void 0===a[o])return;a=a[o]}}catch(e){i.e(e)}finally{i.f()}return a}function se(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return ue(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ue(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var a=0,i=function(){};return{s:i,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,r=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return r=e.done,e},e:function(e){s=!0,o=e},f:function(){try{r||null==n.return||n.return()}finally{if(s)throw o}}}}function ue(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}var le=function(){function e(t,n){(0,o.A)(this,e),this.editor=t,this.element=n,this.textarea=t.getTextarea(n),this.lists={media:n.querySelector('[misago-editor-attachments="media"]'),other:n.querySelector('[misago-editor-attachments="other"]')},this.templates={error:document.getElementById("attachment-upload-error-template"),media:document.getElementById("attachment-media-template"),mediaFooter:document.getElementById("attachment-media-footer-template"),mediaFailedFooter:document.getElementById("attachment-media-failed-footer-template"),other:document.getElementById("attachment-other-template"),otherFailed:document.getElementById("attachment-other-failed-template"),otherUploaded:document.getElementById("attachment-other-uploaded-template")};var a=n.querySelector("[misago-editor-attachments]");this.field={name:n.getAttribute("misago-editor-attachments-name"),element:a},this.accept={all:this._getAcceptedExtensions(a.getAttribute("misago-editor-accept-attachments")),image:this._getAcceptedExtensions(a.getAttribute("misago-editor-accept-image")),video:this._getAcceptedExtensions(a.getAttribute("misago-editor-accept-video"))},this.uploadUrl=this._getUploadUrl(n),this.canUpload=!!this.uploadUrl&&!!this.accept.all}return(0,r.A)(e,[{key:"_getUploadUrl",value:function(e){return e.getAttribute("misago-editor-attachments-url")||null}},{key:"_getAcceptedExtensions",value:function(e){return e.split(",").map(function(e){return e.trim()})}},{key:"showPermissionDeniedError",value:function(){L(pgettext("markup editor upload","You can't upload attachments"))}},{key:"prompt",value:function(e){var t=this,n=e?e.accept:"all",a=!!e&&e.insert,i=document.createElement("input");i.setAttribute("type","file"),i.setAttribute("accept",(this.accept[n]||this.accept.all).join(",")),i.setAttribute("multiple",!0),i.classList.add("d-none"),i.addEventListener("change",function(e){var n=e.target.files;n.length&&t.uploadFiles(n,a),i.remove()}),this.element.appendChild(i),i.click()}},{key:"_getAcceptAttributeStr",value:function(e){return(this.accept[e]||this.accept.all).join(",")}},{key:"uploadFiles",value:function(e,t){for(var n=this,a=[],i=0;i<e.length;i++){var o=e[i];this._isFileTypeAccepted(o)?a.push(o):L(pgettext("markup editor upload","%(name)s: uploaded file type is not allowed.").replace("%(name)s",o.name))}if(!a)return{keys:[],files:[]};var r,s=[],u={},l=new FormData;l.append(ae,(r=document.querySelector('input[name="'+ae+'"]'))?r.value:null),a.forEach(function(e){var t=function(){for(var e="",t=0;t<16;t++)e+="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz"[Math.floor(62*Math.random())];return e}();s.push(t),l.append("keys",t),l.append("upload",e),u[t]=n._createUploadUI(e,t)}),t&&this._insertAttachmentsInTextarea(s,a);var c=new XMLHttpRequest;return this._addOnLoadedEventListener(c,s,u),this._addOnProgressEventListener(c,s,u),c.open("POST",this.uploadUrl),c.send(l),{keys:s,files:a}}},{key:"_isFileTypeAccepted",value:function(e){return this._isFileTypeInList(e,this.accept.all)}},{key:"_isFileTypeImage",value:function(e){return this._isFileTypeInList(e,this.accept.image)}},{key:"_isFileTypeVideo",value:function(e){return this._isFileTypeInList(e,this.accept.video)}},{key:"_isFileTypeInList",value:function(e,t){var n,a=e.name.toLowerCase(),i=se(t);try{for(i.s();!(n=i.n()).done;){var o=n.value;if(a.substring(a.length-o.length)===o)return!0}}catch(e){i.e(e)}finally{i.f()}return!1}},{key:"_insertAttachmentsInTextarea",value:function(e,t){for(var n=[],a=0;a<e.length;a++){var i=e[a],o=t[a];n.push("<attachment="+o.name+":"+i+">")}n&&this.editor.getSelection(this.textarea).insert(n.join("\n"),{whitespace:"\n\n"})}},{key:"_addOnLoadedEventListener",value:function(e,t,n){var a=this;e.addEventListener("loadend",function(){e.readyState===XMLHttpRequest.DONE&&(200===e.status?a._handleUploadSuccess(e,t,n):a._handleUploadError(e,t),t.forEach(function(e){return n[e]=null}))})}},{key:"_handleUploadSuccess",value:function(e,t,n){var a=this;try{var i=JSON.parse(e.response),o=i.attachments,r=i.errors;if(this._replaceTextareaPlaceholders(this.textarea,t,o),r){var s=this.element.querySelector("[misago-editor-attachments-help]");t.forEach(function(e){var t=r[e];t&&a._updateUploadUIWithError(e,s,t)})}o&&o.forEach(function(e){try{a._updateUploadUI(e,n[e.key]),a._createAttachmentIDField(e)}catch(e){console.error(e)}})}catch(e){L(pgettext("markup editor upload","Unexpected upload API response")),console.error(e)}}},{key:"_handleUploadError",value:function(e,t){var n=this;if(0===e.status)L(pgettext("markup editor upload","Site could not be reached"));else if(e.status>=400&&e.status<500)try{L(JSON.parse(e.response).error)}catch(e){L(pgettext("markup editor upload","Unexpected upload API error response")),console.error(e)}else L(pgettext("markup editor upload","Unexpected error during upload"));t.forEach(function(e){n._updateUploadUIWithError(e)})}},{key:"_addOnProgressEventListener",value:function(e,t,n){e.upload.addEventListener("progress",function(e){if(e.lengthComputable){var a,i=Math.ceil(100*e.loaded/e.total),o=se(t);try{for(o.s();!(a=o.n()).done;){var r=a.value,s=n[r].querySelector(".progress-bar");s.setAttribute("aria-valuenow",i),s.style.width=i+"%"}}catch(e){o.e(e)}finally{o.f()}}})}},{key:"_replaceTextareaPlaceholders",value:function(e,t,n){var a={};t.forEach(function(e){return a[e]=null}),n&&n.forEach(function(e){return a[e.key]=e}),this.editor.getSelection(e).replaceAttachments(function(e){var t=e.id,n=a[t];return n?"<attachment="+n.name+":"+n.id+">":null===n?"":void 0})}},{key:"_createUploadUI",value:function(e,t){var n={key:t,file:e,name:e.name,isImage:!1,isVideo:!1};return this._isFileTypeImage(e)?(n.isImage=!0,this._createMediaUploadUI(n)):this._isFileTypeVideo(e)?(n.isVideo=!0,this._createMediaUploadUI(n)):this._createOtherUploadUI(n),this.editor.getAttachmentByKey(t)}},{key:"_createMediaUploadUI",value:function(e){var t=oe(this.templates.media,e);if(e.isImage){var n=t.querySelector("[misago-tpl-image]"),a=new FileReader;a.onload=function(){n.style.backgroundImage="url('"+a.result+"')"},a.readAsDataURL(e.file)}else if(e.isVideo){var i=t.querySelector("video"),o=new FileReader;o.onload=function(){var t=document.createElement("source");t.setAttribute("src",o.result),t.setAttribute("type",e.file.type),i.append(t)},o.readAsDataURL(e.file)}this._addUIToAttachmentsList(this.lists.media,t)}},{key:"_createOtherUploadUI",value:function(e){var t=oe(this.templates.other,e);this._addUIToAttachmentsList(this.lists.other,t)}},{key:"_addUIToAttachmentsList",value:function(e,t){e.querySelector("ul").prepend(t),e.classList.remove("d-none")}},{key:"_createAttachmentIDField",value:function(e){var t=document.createElement("input");t.setAttribute("type","hidden"),t.setAttribute("name",this.field.name),t.setAttribute("value",e.id),this.field.element.appendChild(t)}},{key:"_updateUploadUI",value:function(e,t){e.filetype.is_media?this._updateMediaUploadUI(e,t):this._updateOtherUploadUI(e,t)}},{key:"_updateMediaUploadUI",value:function(e,t){var n=oe(this.templates.mediaFooter,e);n.querySelector("[misago-editor-attachment]").setAttribute("misago-editor-attachment",e.name+":"+e.id),t.querySelector("[misago-tpl-footer]").replaceWith(n)}},{key:"_updateOtherUploadUI",value:function(e,t){var n=oe(this.templates.otherUploaded,e);n.querySelector("[misago-editor-attachment]").setAttribute("misago-editor-attachment",e.name+":"+e.id),t.replaceWith(n)}},{key:"_updateUploadUIWithError",value:function(e,t,n){n&&this._createErrorMessage(e,n,t);var a=this.editor.getAttachmentByKey(e),i=a.querySelector("[misago-tpl-footer]");if(i){var o=oe(this.templates.mediaFailedFooter,{key:e});i.replaceWith(o)}else{var r=a.querySelector("[misago-tpl-upload]"),s=r.closest("li").querySelector("button");s.setAttribute("misago-editor-action","attachment-error-dismiss"),s.setAttribute("misago-editor-attachment-key",e),s.removeAttribute("disabled"),r.replaceWith(oe(this.templates.otherFailed))}}},{key:"_createErrorMessage",value:function(e,t,n){var a=oe(this.templates.error,{key:e,error:t});n.after(a)}}]),e}(),ce=n(15361),de=n(61801),pe=n(53954),he=n(74692);function me(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,a=(0,pe.A)(e);if(t){var i=(0,pe.A)(this).constructor;n=Reflect.construct(a,arguments,i)}else n=a.apply(this,arguments);return(0,de.A)(this,n)}}var fe=function(){function e(){var t=this;(0,o.A)(this,e),this.selection=null,this.element=null,this.form=null,document.addEventListener("DOMContentLoaded",function(){t.element=t.getElement(),t.element&&(t.form=t.element.querySelector("form"),t.initForm(t.form))})}return(0,r.A)(e,[{key:"getElement",value:function(){throw"Subclasses of 'MarkupEditorModal' must implement 'getElement' method"}},{key:"initForm",value:function(e){var t=this;e.addEventListener("submit",function(e){e.preventDefault();var n=new FormData(e.target);return t.submit(n,t.selection),!1})}},{key:"reset",value:function(){this.element.querySelectorAll("input").forEach(function(e){e.value=""})}},{key:"setData",value:function(e,t){}},{key:"submit",value:function(e,t){}},{key:"show",value:function(e){this.reset(),this.selection=e,this.setData(this.form,e),he(this.element).modal("show")}},{key:"hide",value:function(){he(this.element).modal("hide")}}]),e}(),ve=function(e){(0,ce.A)(n,e);var t=me(n);function n(){return(0,o.A)(this,n),t.apply(this,arguments)}return(0,r.A)(n,[{key:"getElement",value:function(){return document.getElementById("markup-editor-link-modal")}},{key:"setData",value:function(e,t){e.querySelector('[name="text"]').value=t.text().trim()}},{key:"submit",value:function(e,t){var n=ye(e.get("url").trim()),a=e.get("text").trim();n&&(a?ge(n,a)?t.replace("[url="+n+"]"+a+"[/url]"):t.replace("["+a+"]("+n+")"):t.replace("<"+n+">"),this.hide())}}]),n}(fe),Ae=function(e){(0,ce.A)(n,e);var t=me(n);function n(){return(0,o.A)(this,n),t.apply(this,arguments)}return(0,r.A)(n,[{key:"getElement",value:function(){return document.getElementById("markup-editor-image-modal")}},{key:"submit",value:function(e,t){var n=ye(e.get("url").trim()),a=e.get("text").trim();n&&(a?ge(n,a)?t.replace("[img="+n+"]"+a+"[/img]"):t.replace("!["+a+"]("+n+")"):ge(n,a)?t.replace("[img]"+n+"[/img]"):t.replace("!("+n+")"),this.hide())}}]),n}(fe);function ge(e,t){return e.indexOf("(")>=0||e.indexOf(")")>=0||t.indexOf("[")>=0||t.indexOf("]")>=0}function ye(e){return be(e,"http://")||be(e,"https://")?e:"http://"+e}function be(e,t){return e.toLowerCase().substring(0,t.length)===t}var De=function(e){(0,ce.A)(n,e);var t=me(n);function n(){return(0,o.A)(this,n),t.apply(this,arguments)}return(0,r.A)(n,[{key:"getElement",value:function(){return document.getElementById("markup-editor-quote-modal")}},{key:"setData",value:function(e,t){e.querySelector('[name="text"]').value=t.text().trim()}},{key:"submit",value:function(e,t){var n=e.get("author").trim(),a=e.get("text").trim();if(a){var i=this.getQuotePrefix(t,n);t.replace(i+a+"\n[/quote]\n\n",{start:i.length,end:11}),this.hide()}}},{key:"getQuotePrefix",value:function(e,t){var n=e.prefix().trim().length?"\n\n":"";return t?n+"[quote="+t+"]\n":n+"[quote]\n"}}]),n}(fe),xe=function(e){(0,ce.A)(n,e);var t=me(n);function n(){return(0,o.A)(this,n),t.apply(this,arguments)}return(0,r.A)(n,[{key:"getElement",value:function(){return document.getElementById("markup-editor-code-modal")}},{key:"setData",value:function(e,t){e.querySelector('[name="code"]').value=t.text().trim()}},{key:"submit",value:function(e,t){var n=e.get("info"),a=e.get("syntax"),i=e.get("code");if(i){var o=this.getCodePrefix(t),r=this.getCodeArguments(n,a),s=this.getCodeDelimiter(r,i),u=o+s+r+"\n"+i+"\n"+s+"\n\n";t.replace(u,{start:u.length}),this.hide()}}},{key:"getCodeArguments",value:function(e,t){var n=(e||"").trim(),a=(t||"").trim();return n&&a?n+", syntax: "+a:n||a||""}},{key:"getCodeDelimiter",value:function(e,t){for(var n=e.startsWith("`")?"~":"`";n.length<3||-1!==t.indexOf(n);)n+=n[0];return n}},{key:"getCodePrefix",value:function(e){return e.prefix().trim().length?"\n\n":""}}]),n}(fe),ke=n(74692),_e=function(){function e(){var t=this;(0,o.A)(this,e),(0,s.A)(this,"_onWindowResize",function(){document.querySelectorAll("[misago-editor-active]").forEach(t._resizeEditor)}),(0,s.A)(this,"_resizeEditor",function(e){for(var n=t._getResizeConstraints(e),a=e.querySelector(".markup-editor-toolbar-left"),i=e.querySelector(".markup-editor-toolbar-secondary"),o=e.querySelector("[misago-editor-more]"),r=0,s=[],u=0;u<a.children.length;u++){var l=a.children[u];"true"!==l.getAttribute("misago-editor-more")&&(s.push({index:u,priority:parseInt(l.getAttribute("misago-editor-priority")||0),display:!0}),l.clientWidth&&(r+=n.btn))}if(r>n.toolbar){var c=n.toolbar-n.btn;s.sort(function(e,t){return e.priority>t.priority?1:e.priority<t.priority?-1:0}),s.forEach(function(e){r>c?(a.children[e.index].classList.add("d-none"),i.children[e.index].classList.remove("d-none"),e.display=!1,r-=n.btn):(a.children[e.index].classList.remove("d-none"),i.children[e.index].classList.add("d-none"),e.display=!0)})}else if(r+n.btn<n.toolbar){r=0;var d=n.toolbar;s.sort(function(e,t){return e.priority>t.priority?-1:e.priority<t.priority?1:0}),s.forEach(function(e){r+n.btn<d?(a.children[e.index].classList.remove("d-none"),i.children[e.index].classList.add("d-none"),e.display=!0,r+=n.btn):(a.children[e.index].classList.add("d-none"),i.children[e.index].classList.remove("d-none"),e.display=!1)})}0===s.filter(function(e){return!e.display}).length?(o.classList.add("d-none"),i.classList.remove("show")):o.classList.remove("d-none")}),(0,s.A)(this,"_getResizeConstraints",function(e){var t=e.querySelector(".markup-editor-toolbar-left"),n=0;t.querySelectorAll("button").forEach(function(e){var t=e.clientWidth,a=window.getComputedStyle(e);t+=parseInt(parseFloat(a.borderLeftWidth)),t+=parseInt(parseFloat(a.borderRightWidth)),t+=parseInt(parseFloat(a.marginLeft)),(t+=parseInt(parseFloat(a.marginRight)))>n&&(n=t)});var a=t.parentElement.clientWidth-n;return{btn:n,toolbar:a}}),(0,s.A)(this,"setAction",function(e,n){t.actions[e]=n}),(0,s.A)(this,"activate",function(e){if("true"!==e.getAttribute("misago-editor-active")){t._setEditorActive(e),t._setEditorFocus(e),t._setEditorActions(e),t._setEditorPasteUpload(e),t._setEditorDropUpload(e),t._resizeEditor(e);var n=t.getTextarea(e);t.mentions[n.id]=new ne(n)}}),(0,s.A)(this,"_setEditorPasteUpload",function(e){e.addEventListener("paste",function(n){if(n.clipboardData.files.length){var a=new le(t,e);if(a.canUpload){n.preventDefault();var i=n.target.closest("textarea");a.uploadFiles(n.clipboardData.files,i)}else a.showPermissionDeniedError()}})}),(0,s.A)(this,"_setEditorDropUpload",function(e){var n="markup-editor-drag-drop",a=[e.querySelector("textarea")],i=e.querySelector("[misago-editor-attachments]");i&&a.push(i),a.forEach(function(a){a.addEventListener("drop",function(i){var o=new le(t,e);if(i.dataTransfer.files.length)if(i.preventDefault(),o.canUpload){if(i.dataTransfer.files){var r=i.target.closest("textarea");o.uploadFiles(i.dataTransfer.files,r)}}else o.showPermissionDeniedError();a.classList.remove(n)}),a.addEventListener("dragenter",function(e){e.preventDefault()}),a.addEventListener("dragleave",function(){a.classList.remove(n)}),a.addEventListener("dragover",function(e){a.classList.add(n),e.preventDefault()})})}),this.actions={},this.codeModal=new xe,this.linkModal=new ve,this.imageModal=new Ae,this.quoteModal=new De,this.mentions={},this.resizeDebounce=null,window.addEventListener("resize",function(e){t.resizeDebounce&&window.clearTimeout(t.resizeDebounce),t.resizeDebounce=window.setTimeout(t._onWindowResize,200)})}return(0,r.A)(e,[{key:"_setEditorActive",value:function(e){e.setAttribute("misago-editor-active","true")}},{key:"_setEditorFocus",value:function(e){var t=["focusin","click"],n="markup-editor-focused";t.forEach(function(t){e.addEventListener(t,function(){e.classList.add(n)})}),t.forEach(function(t){document.addEventListener(t,function(t){e.contains(t.target)||e.classList.remove(n)})})}},{key:"_setEditorActions",value:function(e){var t=this,n=this.getTextarea(e);e.addEventListener("click",function(e){var a=e.target.closest("[misago-editor-action]");if(!a)return null;var i=a.getAttribute("misago-editor-action");if(!i)return null;e.preventDefault();var o=t.actions[i];o?o({textarea:n,target:a,editor:t,selection:new Ne(n)}):console.warn("Undefined editor action: "+i)}),e.querySelector("[misago-editor-more]").addEventListener("click",function(){var t=e.querySelector(".markup-editor-toolbar-secondary");t.classList.contains("show")?t.classList.remove("show"):t.classList.add("show")})}},{key:"getTextarea",value:function(e){return e.querySelector("textarea")}},{key:"getSelection",value:function(e){return new Ne(e)}},{key:"showFilePrompt",value:function(e,t){var n=new le(this,e.closest("[misago-editor-active]"));n.canUpload?n.prompt(t):n.showPermissionDeniedError()}},{key:"showCodeModal",value:function(e){this.codeModal.show(e)}},{key:"showLinkModal",value:function(e){this.linkModal.show(e)}},{key:"showImageModal",value:function(e){this.imageModal.show(e)}},{key:"showQuoteModal",value:function(e){this.quoteModal.show(e)}},{key:"getAttachmentByKey",value:function(e){return document.querySelector('[misago-editor-upload-key="'+e+'"]')}},{key:"removeAttachmentElement",value:function(e){var t=e.closest("ul");q(e,function(){t.querySelector("li")||t.closest(".markup-editor-attachments-list").classList.add("d-none")})}}]),e}(),Ne=function(){function e(t){(0,o.A)(this,e),this.textarea=t,this._range=this._getRange()}return(0,r.A)(e,[{key:"get",value:function(){return this._range}},{key:"prefix",value:function(){return this._range.prefix}},{key:"suffix",value:function(){return this._range.suffix}},{key:"zero",value:function(){return 0===this._range.length}},{key:"empty",value:function(){return 0===this._range.text.trim().length}},{key:"text",value:function(){return this._range.text}},{key:"wrap",value:function(e,t){var n=this._range.prefix;n+=e+this._range.text+t,n+=this._range.suffix,this.textarea.value=n,this._range.start+=e.length,this._range.end+=e.length,this._range.length=this._range.end-this._range.start,this.refocus()}},{key:"replace",value:function(e,t){var n=this._range.prefix+e+this._range.suffix;this.textarea.value=n,t&&t.start&&(this._range.start+=t.start),this._range.end=this._range.start+e.length,t&&(t.start&&(this._range.end-=t.start),t.end&&(this._range.end-=t.end)),this._range.length=this._range.end-this._range.start,this.refocus()}},{key:"insert",value:function(e,t){var n=t&&t.whitespace||"",a=n?this._range.prefix.trimEnd():this._range.prefix,i=n?this._range.suffix.trim():this._range.suffix,o=1,r=a;a.length&&n&&(r+=n,o+=1),r+=e+n+i,this.textarea.value=r;var s=a.length+e.length+n.length*o;this._range.end=this._range.start=s,this._range.length=0,this.refocus()}},{key:"replaceAttachments",value:function(e){this.textarea.value=this.textarea.value.replace(/<attachment=(.+?)>/gi,function(t,n){if(1!==n.match(/:/g).length)return t;for(var a=n.trim();'"'===a.substring(0,1);)a=a.substring(1);for(;'"'===a.substring(a.length-1);)a=a.substring(0,a.length-1);var i=a.substring(0,a.indexOf(":")).trim(),o=a.substring(a.indexOf(":")+1).trim();if(o){var r=e({match:t,name:i,id:o});if("string"==typeof r||r instanceof String)return r}return t})}},{key:"refocus",value:function(){var e=this;window.setTimeout(function(){var t=e.textarea.scrollTop;e.textarea.focus(),e.textarea.scrollTop=t;var n=e._range.start;e.textarea.setSelectionRange(n,n+e._range.length)},250)}},{key:"_getRange",value:function(){if(document.selection){this.textarea.focus();var e=document.selection.createRange(),t=e.text.length;return e.moveStart("character",-this.textarea.value.length),this._createRange(this.textarea,e.text.length-t,e.text.length)}if(this.textarea.selectionStart||"0"==this.textarea.selectionStart)return this._createRange(this.textarea,this.textarea.selectionStart,this.textarea.selectionEnd)}},{key:"_createRange",value:function(e,t,n){return{start:t,end:n,length:n-t,text:e.value.substring(t,n),prefix:e.value.substring(0,t),suffix:e.value.substring(n)}}}]),e}(),Ce=new _e;const Ee=Ce;Ce.setAction("strong",function(e){var t=e.selection;t.empty()?t.replace("**"+pgettext("example markup","Strong text")+"**",{start:2,end:2}):t.wrap("**","**")}),Ce.setAction("emphasis",function(e){var t=e.selection;t.empty()?t.replace("_"+pgettext("example markup","Text with emphasis")+"_",{start:1,end:1}):t.wrap("_","_")}),Ce.setAction("strikethrough",function(e){var t=e.selection;t.empty()?t.replace("~~"+pgettext("example markup","Text with strikethrough")+"~~",{start:2,end:2}):t.wrap("~~","~~")}),Ce.setAction("horizontal-ruler",function(e){e.selection.insert("- - -",{whitespace:"\n\n"})}),Ce.setAction("link",function(e){var t=e.editor,n=e.selection;t.showLinkModal(n)}),Ce.setAction("image",function(e){var t=e.editor,n=e.selection;t.showImageModal(n)}),Ce.setAction("quote",function(e){var t=e.editor,n=e.selection;t.showQuoteModal(n)}),Ce.setAction("spoiler",function(e){var t=e.selection,n=t.prefix().trim().length?"\n\n[spoiler]\n":"[spoiler]\n",a="\n[/spoiler]\n\n";t.empty()?t.replace(n+pgettext("example markup","Spoiler text")+a,{start:n.length,end:13}):t.wrap(n,a)}),Ce.setAction("code",function(e){var t=e.editor,n=e.selection;t.showCodeModal(n)}),Ce.setAction("attachment",function(e){var t=e.target,n=e.selection,a=t.getAttribute("misago-editor-attachment");a&&n.insert("<attachment="+a+">",{whitespace:"\n\n"})}),Ce.setAction("image-upload",function(e){var t=e.editor,n=e.target;t.showFilePrompt(n,{accept:"image",insert:!0})}),Ce.setAction("attachment-upload",function(e){var t=e.editor,n=e.target;t.showFilePrompt(n)}),Ce.setAction("attachment-delete",function(e){var t=e.editor,n=e.target,a=e.selection,i=n.getAttribute("misago-editor-attachment"),o=n.closest("[misago-editor-deleted-attachments-name]").getAttribute("misago-editor-deleted-attachments-name");a.replaceAttachments(function(e){return e.id===i&&""});var r=n.closest("li");t.removeAttachmentElement(r);var s=document.createElement("input");s.setAttribute("type","hidden"),s.setAttribute("name",o),s.setAttribute("value",i),n.closest("[misago-editor-attachments]").appendChild(s)}),Ce.setAction("attachment-error-dismiss",function(e){var t=e.editor,n=e.target,a=e.selection,i=n.getAttribute("misago-editor-attachment-key");a.replaceAttachments(function(e){return e.id===i&&""});var o=document.querySelector('[misago-editor-attachment-error="'+i+'"]');o&&q(o);var r=t.getAttachmentByKey(i);r&&t.removeAttachmentElement(r)}),Ce.setAction("formatting-help",function(e){var t=e.target,n=document.getElementById("markup-editor-formatting-help"),a=t.closest("a");u.A.ajax("GET",a.href,{target:n,swap:"innerHTML"}).then(function(){ke(n).modal("show")})});const we=Ee;var Fe=n(74692);function Re(e){e.setAttribute("m-poll-choices-control","true");var t=Number(e.getAttribute("max-choices")||0);e.addEventListener("keyup",function(n){var a=n.target.closest("input"),i=e.querySelectorAll("[m-poll-new-choice]").length;if(a&&a.value.trim()&&(!t||i<t)){var o=n.target.closest("li");if(!o.nextElementSibling){var r=o.cloneNode(!0),s=r.querySelector("input");s.value="",s.name=a.name,o.after(r)}}})}u.A.onLoad(function(){document.querySelectorAll("[misago-page-form]").forEach(function(e){var t;""===e.getAttribute("misago-page-form")&&((t=e).setAttribute("misago-page-form","true"),t.addEventListener("submit",function(e){var n=t.getAttribute("misago-page"),a=e.target.querySelector("input"),i=a.value;if(i>=a.min&&i<=a.max&&i!=n){var o=t.getAttribute("misago-page-url");i>1&&(o+=i+"/"),window.history.pushState({},"",o),document.getElementById("misago-page-scroll-target").scrollIntoView(),u.A.ajax("GET",o,{target:"#misago-htmx-root",swap:"outerHTML"})}return t.closest(".dropdown").querySelector("[data-toggle]")&&Fe().dropdown("toggle"),e.preventDefault(),!1}))})});const Se=Re;u.A.onLoad(function(){document.querySelectorAll("[m-poll-choices-control]").forEach(function(e){e.getAttribute("m-poll-choices-control")||Re(e)})});var Be=function(){function e(t){(0,o.A)(this,e),this.tether=t,this.shadow=this.createShadow(),this.padding=null}return(0,r.A)(e,[{key:"createShadow",value:function(){var e=document.createElement("div");return e.ariaHidden=!0,e.style.position="absolute",e.style.top=0,e.style.left="-9999px",e.style.opacity=0,e.style.zIndex=-999,document.body.appendChild(e),e}},{key:"getPosition",value:function(e,t){var n,a=e.element;this.shadow.setAttribute("class",a.getAttribute("class"));var i=t.cloneRange();i.setStart(a.childNodes[0],0);var o=i.getBoundingClientRect();if(this.shadow.style.width="".concat(o.width,"px"),null===this.padding){var r=window.getComputedStyle(a).getPropertyValue("padding-top");this.padding=parseFloat(r.substring(0,r.length-2))}(n=this.shadow).replaceChildren.apply(n,(0,y.A)(i.cloneContents().childNodes));var s=this.findTether(this.shadow.childNodes);if(!s)return this.shadow.replaceChildren(),null;var u=this.shadow.getBoundingClientRect(),l=s.getBoundingClientRect(),c=l.x-u.x+l.width,d={top:o.bottom,bottom:o.bottom+1,left:o.x+c,right:o.x+c+1,height:1,width:1,x:o.x+c.x,y:o.bottom};return this.shadow.replaceChildren(),{getBoundingClientRect:function(){return d}}}},{key:"findTether",value:function(e){for(var t=null,n=this.tether.rules,a=0;a<e.length;a++)for(var i=e[a],o=0;o<n.length;o++)t=(0,n[o].func)(this,i)||t;return t}}]),e}();const Le=Be;var Te=function(){function e(t,n,a){(0,o.A)(this,e),this.extractor=t,this.renderer=n,this.postprocess=a}return(0,r.A)(e,[{key:"getQuote",value:function(e){var t=this.extractNodes(e.childNodes);return 0===(t=this.postprocessNodes(e,t)).length?"":this.renderNodes(t).trim()}},{key:"extractNodes",value:function(e,t){for(var n={nodes:e,node:null,result:[],stack:t||[],pos:0,posMax:e.length-1},a=this.extractor.rules;n.pos<=n.posMax;){var i=!1,o=e[n.pos];n.node=o;for(var r=0;r<a.length;r++)if((0,a[r].func)(this,n)){i=!0;break}n.pos+=i?0:1}return n.result}},{key:"postprocessNodes",value:function(e,t){for(var n=t,a=this.postprocess.rules,i=0;i<a.length;i++)n=a[i].func(this,e,n);return n}},{key:"renderNodes",value:function(e){for(var t={nodes:e,node:null,text:"",pos:0,posMax:e.length-1},n=this.renderer.rules;t.pos<=t.posMax;){var a=!1,i=e[t.pos];t.node=i;for(var o=0;o<n.length;o++)if((0,n[o].func)(this,t)){a=!0;break}t.pos+=a?0:1}return t.text}}]),e}();const Oe=Te,Pe=function(){function e(t){(0,o.A)(this,e),this.rules=t||[]}return(0,r.A)(e,[{key:"push",value:function(e,t){this.rules.push({name:e,func:t})}},{key:"replace",value:function(e,t){this.rules=this.rules.map(function(n){return n.name===e?{name:e,func:t}:n})}},{key:"before",value:function(e,t,n){var a=[];this.rules.forEach(function(i){a.push({name:t,func:n}),i.name===e&&a.push(i)}),this.rules=a}},{key:"after",value:function(e,t,n){var a=[];this.rules.forEach(function(i){i.name===e&&a.push(i),a.push({name:t,func:n})}),this.rules=a}}]),e}();function Ie(e){return function(e){for(var t=Ue(function(e){for(var t=[],n=Ue(e),a=0;a<n.length;a++){var i=n[a];(t.length||i.trim())&&t.push(i.trimEnd())}return t.join("\n").trimEnd()}(e)),n=-1,a=0;a<t.length;a++)if(t[a].trim()){var i=t[a].length-t[a].trimStart().length;(-1===n||i<n)&&(n=i)}if(n)for(var o=0;o<t.length;o++)t[o]=t[o].substring(n);return t.join("\n")}(qe(e))}function qe(e){for(var t="",n=0;n<e.childNodes.length;n++){var a=e.childNodes[n];a.nodeType===Node.TEXT_NODE?t+=a.textContent:"SPAN"===a.nodeName&&(t+=qe(a))}return t}function Ue(e){return e.split(/\r?\n/)}var je={H1:!0,H2:!0,H3:!0,H4:!0,H5:!0,H6:!0};function Me(e){var t=e.getAttribute("misago-rich-text-col");if(!t)return{index:null,alignment:"c"};var n=t.split(":");return{index:parseInt(n[0]||"0"),alignment:n[1]||"c"}}const ze=[{name:"attachment",func:function(e,t){var n=t.result,a=t.node;if("DIV"!==a.nodeName&&"SPAN"!==a.nodeName)return!1;var i=a.getAttribute("misago-rich-text-attachment");return!!i&&!!a.childNodes.length&&(n.push({type:"attachment",args:i}),t.pos+=1,!0)}},{name:"youtube",func:function(e,t){var n=t.result,a=t.node;if("DIV"!==a.nodeName)return!1;var i=a.getAttribute("misago-rich-text-youtube");return!!i&&(n.push({type:"youtube",url:i}),t.pos+=1,!0)}},{name:"header",func:function(e,t){var n=t.result,a=t.node,i=t.stack;if(!je[a.nodeName])return!1;var o=e.extractNodes(a.childNodes,i.concat(["header"]));if(!o.length)return t.pos+=1,!0;var r=parseInt(a.nodeName.substring(1));return n.push({type:"header",level:r,children:o}),t.pos+=1,!0}},{name:"quote",func:function(e,t){var n=t.result,a=t.node,i=t.stack;if("ASIDE"!==a.nodeName)return!1;var o=a.querySelector("blockquote[misago-rich-text-quote]");if(!o)return!1;var r=o.getAttribute("misago-rich-text-quote"),s=e.extractNodes(o.childNodes,i.concat(["quote"]));return s.length?(n.push({type:"quote",info:r,children:s}),t.pos+=1,!0):(t.pos+=1,!0)}},{name:"spoiler",func:function(e,t){var n=t.result,a=t.node,i=t.stack;if("DETAILS"!==a.nodeName)return!1;var o=a.querySelector("div[misago-rich-text-spoiler]");if(!o)return!1;var r=o.getAttribute("misago-rich-text-spoiler"),s=e.extractNodes(o.childNodes,i.concat(["quote"]));return s.length?(n.push({type:"spoiler",info:r,children:s}),t.pos+=1,!0):(t.pos+=1,!0)}},{name:"code",func:function(e,t){var n=t.result,a=t.node;if(t.stack,"DIV"!==a.nodeName&&"PRE"!==a.nodeName)return!1;var i=a.querySelector("code[misago-rich-text-code]");if(!i)return!1;var o=i.getAttribute("misago-rich-text-code"),r=Ie(i);return n.push({type:"code",info:o,content:r}),t.pos+=1,!0}},{name:"paragraph",func:function(e,t){var n=t.result,a=t.node,i=t.stack;if("P"!==a.nodeName)return!1;var o=e.extractNodes(a.childNodes,i.concat(["paragraph"]));return o.length?(n.push({type:"paragraph",children:o}),t.pos+=1,!0):(t.pos+=1,!0)}},{name:"table",func:function(e,t){var n=t.result,a=t.node,i=t.stack;if("DIV"!==a.nodeName||"table-container"!==a.getAttribute("misago-rich-text"))return!1;var o=Array.from(a.childNodes).filter(function(e){return"TABLE"===e.nodeName});if(1!==o.length)return!1;var r=o[0],s=e.extractNodes(r.childNodes,i.concat(["table"]));return s.length?(n.push({type:"table",children:s}),t.pos+=1,!0):(t.pos+=1,!0)}},{name:"table_head",func:function(e,t){var n=t.result,a=t.node,i=t.stack;if("THEAD"!==a.nodeName)return!1;var o=e.extractNodes(a.childNodes,i.concat(["table_head"]));return o.length?(n.push({type:"table_head",children:o}),t.pos+=1,!0):(t.pos+=1,!0)}},{name:"table_body",func:function(e,t){var n=t.result,a=t.node,i=t.stack;if("TBODY"!==a.nodeName)return!1;var o=e.extractNodes(a.childNodes,i.concat(["table_body"]));return o.length?(n.push({type:"table_body",children:o}),t.pos+=1,!0):(t.pos+=1,!0)}},{name:"table_row",func:function(e,t){var n=t.result,a=t.node,i=t.stack;if("TR"!==a.nodeName)return!1;var o=e.extractNodes(a.childNodes,i.concat(["table_row"]));return o.length?(n.push({type:"table_row",id:a.id,children:o}),t.pos+=1,!0):(t.pos+=1,!0)}},{name:"table_th",func:function(e,t){var n=t.result,a=t.node,i=t.stack;if("TH"!==a.nodeName)return!1;var o=e.extractNodes(a.childNodes,i.concat(["table_th"]));if(!o.length)return t.pos+=1,!0;var r=Me(a),s=r.index,u=r.alignment;return n.push({type:"table_th",index:s,alignment:u,children:o}),t.pos+=1,!0}},{name:"table_td",func:function(e,t){var n=t.result,a=t.node,i=t.stack;if("TD"!==a.nodeName)return!1;var o=e.extractNodes(a.childNodes,i.concat(["table_td"]));if(!o.length)return t.pos+=1,!0;var r=Me(a),s=r.index,u=r.alignment;return n.push({type:"table_td",index:s,alignment:u,children:o}),t.pos+=1,!0}},{name:"list",func:function(e,t){var n=t.result,a=t.node,i=t.stack;if("OL"!==a.nodeName&&"UL"!==a.nodeName)return!1;var o="OL"===a.nodeName,r=e.extractNodes(a.childNodes,i.concat(["list"]));return r.length?(n.push({type:"list",ordered:o,children:r}),t.pos+=1,!0):(t.pos+=1,!0)}},{name:"list_item",func:function(e,t){var n=t.result,a=t.node,i=t.stack;if("LI"!==a.nodeName)return!1;var o=e.extractNodes(a.childNodes,i.concat(["list_item"]));return o.length?(n.push({type:"list_item",children:o}),t.pos+=1,!0):(t.pos+=1,!0)}},{name:"hr",func:function(e,t){var n=t.result,a=t.node;return t.stack,"HR"===a.nodeName&&(n.push({type:"hr"}),t.pos+=1,!0)}},{name:"image",func:function(e,t){var n=t.result,a=t.node;if("IMG"!==a.nodeName)return!1;var i=(a.getAttribute("src")||"").trim(),o=(a.getAttribute("alt")||"").trim()||null,r=(a.getAttribute("title")||"").trim()||null;return!!i&&(n.push({type:"image",url:i,alt:o,title:r}),t.pos+=1,!0)}},{name:"mention",func:function(e,t){var n=t.result,a=t.node;return!("A"!==a.nodeName&&"SPAN"!==a.nodeName||!a.getAttribute("misago-rich-text-mention")||(n.push({type:"text",content:a.textContent}),t.pos+=1,0))}},{name:"link",func:function(e,t){var n=t.result,a=t.node,i=t.stack;return"A"===a.nodeName&&(n.push({type:"link",href:a.getAttribute("href"),auto:"autolink"===a.getAttribute("misago-rich-text"),children:e.extractNodes(a.childNodes,i.concat(["link"]))}),t.pos+=1,!0)}},{name:"strong_text",func:function(e,t){var n=t.result,a=t.node,i=t.stack;return"STRONG"===a.nodeName&&(n.push({type:"strong",children:e.extractNodes(a.childNodes,i.concat(["strong_text"]))}),t.pos+=1,!0)}},{name:"emphasis_text",func:function(e,t){var n=t.result,a=t.node,i=t.stack;return"EM"===a.nodeName&&(n.push({type:"emphasis",children:e.extractNodes(a.childNodes,i.concat(["emphasis_text"]))}),t.pos+=1,!0)}},{name:"bold_text",func:function(e,t){var n=t.result,a=t.node,i=t.stack;return"B"===a.nodeName&&(n.push({type:"bold",children:e.extractNodes(a.childNodes,i.concat(["bold_text"]))}),t.pos+=1,!0)}},{name:"italic_text",func:function(e,t){var n=t.result,a=t.node,i=t.stack;return"I"===a.nodeName&&(n.push({type:"italic",children:e.extractNodes(a.childNodes,i.concat(["italic_text"]))}),t.pos+=1,!0)}},{name:"underline_text",func:function(e,t){var n=t.result,a=t.node,i=t.stack;return"U"===a.nodeName&&(n.push({type:"underline",children:e.extractNodes(a.childNodes,i.concat(["underline_text"]))}),t.pos+=1,!0)}},{name:"strikethrough_text",func:function(e,t){var n=t.result,a=t.node,i=t.stack;return"DEL"===a.nodeName&&(n.push({type:"strikethrough",children:e.extractNodes(a.childNodes,i.concat(["strikethrough_text"]))}),t.pos+=1,!0)}},{name:"inline_code",func:function(e,t){var n=t.result,a=t.node;return t.stack,"CODE"===a.nodeName&&(n.push({type:"inline_code",content:a.textContent}),t.pos+=1,!0)}},{name:"softbreak",func:function(e,t){var n=t.result,a=t.node;return t.stack,"BR"===a.nodeName&&(n.push({type:"softbreak"}),t.pos+=1,!0)}},{name:"text",func:function(e,t){var n=t.result,a=t.node;return t.stack,a.nodeType===Node.TEXT_NODE&&("\n"===a.textContent?(t.pos+=1,!0):(n.push({type:"text",content:a.textContent}),t.pos+=1,!0))}}];function He(e){return 1!==e.length||("quote"!==e[0].type||!e[0].info)&&("spoiler"!==e[0].type||He(e[0].children))}const Ve=[{name:"attachment",func:function(e,t,n){var a=t.ancestor.closest("[misago-rich-text-attachment]");return a?[{type:"attachment",args:a.getAttribute("misago-rich-text-attachment")}]:n}},{name:"youtube",func:function(e,t,n){var a=t.ancestor.closest("[misago-rich-text-youtube]");if(!a)return n;var i=a.getAttribute("misago-rich-text-youtube");return i?[{type:"youtube",url:i}]:n}},{name:"code",func:function(e,t,n){var a=t.ancestor.closest("[misago-rich-text-code]");return a?[{type:"code",info:a.getAttribute("misago-rich-text-code"),content:Ie(t)}]:n}},{name:"table",func:function(e,t,n){return n.map(function(t){return"table"===t.type?function(e,t){var n=function(e,t){if("table_head"===t.children[0].type)return t;return t.children=[{type:"table_head",children:[{type:"table_row",children:[]}]},t.children[0]],t}(0,t);return function(e,t){var n=document.getElementById(t.children[1].children[0].id).closest("table"),a=t.children[0],i=t.children[1],o={};return a.children.forEach(function(e){e.children.forEach(function(e){o[e.index]=!0})}),i.children.forEach(function(e){e.children.forEach(function(e){o[e.index]=!0})}),a.children[0].children=e.extractNodes(Array.from(n.querySelector("thead tr").childNodes).filter(function(e){return"TH"===e.nodeName}).filter(function(e,t){return o[t]})),i.children.forEach(function(t){t.children=e.extractNodes(Array.from(document.getElementById(t.id).childNodes).filter(function(e){return"TD"===e.nodeName}).filter(function(e,t){return o[t]}))}),t}(e,n)}(e,t):t})}},{name:"table_head",func:function(e,t,n){if(!n||"table_head"!==n[0].type)return n;var a=t.ancestor.closest("table"),i={};return n.forEach(function(e){e.children.forEach(function(e){e.children.forEach(function(e){i[e.index]=!0})})}),[{type:"table",children:[{type:"table_head",children:[{type:"table_row",children:e.extractNodes(Array.from(a.querySelector("thead tr").childNodes).filter(function(e){return"TH"===e.nodeName}).filter(function(e,t){return i[t]}))}]},{type:"table_body",children:n[1].children.map(function(t){return t.children=e.extractNodes(Array.from(document.getElementById(t.id).childNodes).filter(function(e){return"TD"===e.nodeName}).filter(function(e,t){return i[t]})),t})}]}]}},{name:"table_row",func:function(e,t,n){if(!n||"table_row"!==n[0].type)return n;var a=t.ancestor.closest("table"),i={};return n.forEach(function(e){e.children.forEach(function(e){i[e.index]=!0})}),[{type:"table",children:[{type:"table_head",children:[{type:"table_row",children:e.extractNodes(Array.from(a.querySelector("thead tr").childNodes).filter(function(e){return"TH"===e.nodeName}).filter(function(e,t){return i[t]}))}]},{type:"table_body",children:n.map(function(t){return t.children=e.extractNodes(Array.from(document.getElementById(t.id).childNodes).filter(function(e){return"TD"===e.nodeName}).filter(function(e,t){return i[t]})),t})}]}]}},{name:"table_th",func:function(e,t,n){if(!n||"table_th"!==n[0].type)return n;var a={};return n.forEach(function(e){a[e.index]=!0}),[{type:"table",children:[{type:"table_head",children:[{type:"table_row",children:e.extractNodes(Array.from(t.ancestor.closest("tr").childNodes).filter(function(e){return"TH"===e.nodeName}).filter(function(e,t){return a[t]}))}]}]}]}},{name:"table_td",func:function(e,t,n){if(!n||"table_td"!==n[0].type)return n;var a=t.ancestor.closest("table"),i=Array.from(a.querySelector("thead tr").childNodes).filter(function(e){return"TH"===e.nodeName}),o={type:"table_head",children:[{type:"table_row",children:[]}]};n.forEach(function(t){o.children[0].children.push(e.extractNodes([i[t.index]])[0])});var r={};n.forEach(function(e){r[e.index]=!0});var s={type:"table_body",children:[{type:"table_row",children:e.extractNodes(Array.from(t.ancestor.closest("tr").childNodes).filter(function(e){return"TD"===e.nodeName}).filter(function(e,t){return r[t]}))}]};return[{type:"table",children:[o,s]}]}},{name:"table_content",func:function(e,t,n){var a=t.ancestor.closest("td");if(!a)return n;var i=t.ancestor.closest("table"),o=Array.from(i.querySelector("thead tr").childNodes).filter(function(e){return"TH"===e.nodeName}),r=Object.assign(e.extractNodes([a])[0],{children:n});return[{type:"table",children:[{type:"table_head",children:[{type:"table_row",children:e.extractNodes([o[r.index]])}]},{type:"table_body",children:[{type:"table_row",children:[r]}]}]}]}},{name:"list",func:function(e,t,n){return"OL"===t.ancestor.nodeName||"UL"===t.ancestor.nodeName?[{type:"list",ordered:"OL"===t.ancestor.nodeName,children:n}]:n}},{name:"blocks",func:function(e,t,n){for(var a=!1,i=!1,o=n,r=t.ancestor;!r.hasAttribute("misago-quote-root");){if(r.hasAttribute("misago-rich-text-spoiler")?(a=!0,o=[{type:"spoiler",info:r.getAttribute("misago-rich-text-spoiler"),children:o}]):r.hasAttribute("misago-rich-text-quote")&&(i=!0,o=[{type:"quote",info:r.getAttribute("misago-rich-text-quote"),children:o}]),a&&i)return o;r=r.parentNode}return o}},{name:"quote_wrapper",func:function(e,t,n){return!!n&&(He(n)?[{type:"quote",info:t.info,children:n}]:n)}}];function Ye(e){return Ke(Qe(Ge(e)))}function We(e){return Ke(Ge(e).replaceAll("(","\\(").replaceAll(")","\\)"))}function Ge(e){return e.replaceAll("\\","\\\\")}function Qe(e){return e.replaceAll("[","\\[").replaceAll("]","\\]")}function Ke(e){return e.replaceAll('"','\\"').replaceAll("'","\\'")}function Xe(e,t){return Ge(e.renderNodes(t.children).trim()).replaceAll("|","\\|")}const Je=[{name:"attachment",func:function(e,t){var n=t.node;return"attachment"===n.type&&(t.text&&("attachment"===t.nodes[t.pos-1].type?t.text+="\n":t.text+="\n\n"),t.text+="<attachment="+n.args+">",t.pos+=1,!0)}},{name:"youtube",func:function(e,t){var n=t.node;return"youtube"===n.type&&(t.text&&(t.text+="\n\n"),t.text+=n.url,t.pos+=1,!0)}},{name:"header",func:function(e,t){var n=t.node;if("header"!==n.type)return!1;var a=e.renderNodes(n.children).trim();if(!a)return!1;t.text&&(t.text+="\n\n");var i="#".repeat(n.level);return t.text+=i+" "+a,t.pos+=1,!0}},{name:"quote",func:function(e,t){var n=t.node;if("quote"!==n.type)return!1;var a=e.renderNodes(n.children).trim();if(!a)return!1;t.text&&(t.text+="\n\n");var i=n.info;return t.text+="[quote"+(i?"="+Ye(i):"")+"]\n",t.text+=a,t.text+="\n[/quote]",t.pos+=1,!0}},{name:"code",func:function(e,t){var n=t.node;if("code"!==n.type)return!1;var a=n.info,i=n.content;return!!n.content&&(t.text&&(t.text+="\n\n"),t.text+="[code"+(a?"="+Ye(a):"")+"]\n",t.text+=i,t.text+="\n[/code]",t.pos+=1,!0)}},{name:"spoiler",func:function(e,t){var n=t.node;if("spoiler"!==n.type)return!1;var a=e.renderNodes(n.children).trim();if(!a)return!1;t.text&&(t.text+="\n\n");var i=n.info;return t.text+="[spoiler"+(i?"="+Ye(i):"")+"]\n",t.text+=a,t.text+="\n[/spoiler]",t.pos+=1,!0}},{name:"paragraph",func:function(e,t){var n=t.node;if("paragraph"!==n.type)return!1;var a=e.renderNodes(n.children).trim();return!!a&&(t.text&&(t.text+="\n\n"),t.text+=a,t.pos+=1,!0)}},{name:"table",func:function(e,t){var n=t.node;if("table"!==n.type)return!1;t.text&&(t.text+="\n\n");var a=[],i=[],o=[];n.children.forEach(function(t){if("table_head"===t.type){var n=t.children[0].children.map(function(t){var n=Xe(e,t);return a.push(t.alignment),i.push(Math.max(n.length,3)),n});o.push(n)}else"table_body"===t.type&&t.children.forEach(function(t){var n=t.children.map(function(t,n){var a=Xe(e,t);return i[n]=Math.max(a.length,i[n]||0,3),a});o.push(n)})});var r=[];return o.forEach(function(e,t){var n=e.map(function(e,t){return e+" ".repeat(i[t]-e.length)});if(r.push("| "+n.join(" | ")+" | "),0===t){var o=e.map(function(e,t){return"l"===a[t]?"-".repeat(i[t]):"r"===a[t]?"-".repeat(i[t]-1)+":":"c"===a[t]?":"+"-".repeat(i[t]-2)+":":void 0});r.push("| "+o.join(" | ")+" | ")}}),t.text+=r.join("\n"),t.pos+=1,!0}},{name:"list",func:function(e,t){var n=t.node;if("list"!==n.type)return!1;t.text&&(t.text+="\n\n");var a=n.children.map(function(t,a){var i=n.ordered?a+1+". ":"* ";return e.renderNodes(t.children).trim().split(/\r?\n|\r|\n/g).map(function(e,t){return 0===t?i+e.trim():" ".repeat(i.length)+e.trim()}).join("\n")});return t.text+=a.join("\n"),t.pos+=1,!0}},{name:"hr",func:function(e,t){return"hr"===t.node.type&&(t.text&&(t.text+="\n\n"),t.text+="- - -",t.pos+=1,!0)}},{name:"image",func:function(e,t){var n=t.node;if("image"!==n.type)return!1;var a=n.url,i=n.alt,o=n.title;return i||o?(t.text+="!",i&&(t.text+="["+Ke(Qe(Ge(i)))+"]"),t.text+="("+We(a),o&&(t.text+=' "'+(We(o)+'"')),t.text+=")"):t.text+="[img]"+function(e){return Qe(Ge(e))}(a)+"[/img]",t.pos+=1,!0}},{name:"link",func:function(e,t){var n=t.node;if("link"!==n.type)return!1;var a=n.auto,i=n.children,o=n.href,r=e.renderNodes(i);return t.text+=a?"<"+Ge(o).replaceAll("<","\\<").replaceAll(">","\\>")+">":"[url="+Ye(o)+"]"+r+"[/url]",t.pos+=1,!0}},{name:"strong_text",func:function(e,t){var n=t.node;if("strong"!==n.type)return!1;var a=e.renderNodes(n.children);if(!a)return!1;var i=-1===a.indexOf("_")?"__":"**";return t.text+=i+a+i,t.pos+=1,!0}},{name:"emphasis_text",func:function(e,t){var n=t.node;if("emphasis"!==n.type)return!1;var a=e.renderNodes(n.children);if(!a)return!1;var i=-1===a.indexOf("_")?"_":"**";return t.text+=i+a+i,t.pos+=1,!0}},{name:"bold_text",func:function(e,t){var n=t.node;if("bold"!==n.type)return!1;var a=e.renderNodes(n.children);return!!a&&(t.text+="[b]"+a+"[/b]",t.pos+=1,!0)}},{name:"italic_text",func:function(e,t){var n=t.node;if("italic"!==n.type)return!1;var a=e.renderNodes(n.children);return!!a&&(t.text+="[i]"+a+"[/i]",t.pos+=1,!0)}},{name:"underline_text",func:function(e,t){var n=t.node;if("underline"!==n.type)return!1;var a=e.renderNodes(n.children);return!!a&&(t.text+="[u]"+a+"[/u]",t.pos+=1,!0)}},{name:"strikethrough_text",func:function(e,t){var n=t.node;if("strikethrough"!==n.type)return!1;var a=e.renderNodes(n.children);return!!a&&(t.text+="[s]"+a+"[/s]",t.pos+=1,!0)}},{name:"inline_code",func:function(e,t){var n=t.node;if("inline_code"!==n.type)return!1;var a=n.content;return!!a&&(t.text+="`"+Ge(a).replaceAll("`","\\`").replaceAll("`","\\`")+"`",t.pos+=1,!0)}},{name:"softbreak",func:function(e,t){return"softbreak"===t.node.type&&(t.text+="\n",t.pos+=1,!0)}},{name:"text",func:function(e,t){var n=t.node;return"text"===n.type&&(t.text+=n.content.replaceAll("\n",""),t.pos+=1,!0)}}];var $e={H1:!0,H2:!0,H3:!0,H4:!0,H5:!0,H6:!0},Ze={TABLE:!0,THEAD:!0,TBODY:!0,TR:!0,TH:!0,TD:!0},et={OL:!0,UL:!0,LI:!0};const tt=[{name:"attachment",func:function(e,t){return"DIV"!==t.nodeName&&"SPAN"!==t.nodeName?null:t.hasAttribute("misago-rich-text-attachment")?t:null}},{name:"youtube",func:function(e,t){return"DIV"!==t.nodeName?null:t.hasAttribute("misago-rich-text-youtube")?t:null}},{name:"header",func:function(e,t){return $e[t.nodeName]?e.findTether(t.childNodes):null}},{name:"quote",func:function(e,t){if("ASIDE"!==t.nodeName)return null;var n=t.querySelector("blockquote[misago-rich-text-quote]");return n?e.findTether(n.childNodes):null}},{name:"spoiler",func:function(e,t){if("DETAILS"!==t.nodeName)return null;var n=t.querySelector("div[misago-rich-text-spoiler]");return n?e.findTether(n.childNodes):null}},{name:"code",func:function(e,t){if("DIV"!==t.nodeName&&"PRE"!==t.nodeName)return null;var n=t.querySelector("code[misago-rich-text-code]");if(!n)return null;var a=n.childNodes[n.childNodes.length-1];return"SPAN"===a.nodeName?e.findTether(a.childNodes):e.findTether(n.childNodes)}},{name:"paragraph",func:function(e,t){return"P"!==t.nodeName?null:e.findTether(t.childNodes)}},{name:"table",func:function(e,t){return"DIV"===t.nodeName&&"table-container"===t.getAttribute("misago-rich-text")||t.nodeName&&Ze[t.nodeName]?e.findTether(t.childNodes):null}},{name:"list",func:function(e,t){return t.nodeName&&et[t.nodeName]?e.findTether(t.childNodes):null}},{name:"hr",func:function(e,t){return"HR"!==t.nodeName?null:t}},{name:"image",func:function(e,t){return"IMG"!==t.nodeName?null:t}},{name:"link",func:function(e,t){return"A"!==t.nodeName?null:e.findTether(t.childNodes)}},{name:"strong_text",func:function(e,t){return"STRONG"!==t.nodeName?null:e.findTether(t.childNodes)}},{name:"emphasis_text",func:function(e,t){return"EM"!==t.nodeName?null:e.findTether(t.childNodes)}},{name:"bold_text",func:function(e,t){return"B"!==t.nodeName?null:e.findTether(t.childNodes)}},{name:"italic_text",func:function(e,t){return"I"!==t.nodeName?null:e.findTether(t.childNodes)}},{name:"underline_text",func:function(e,t){return"U"!==t.nodeName?null:e.findTether(t.childNodes)}},{name:"strikethrough_text",func:function(e,t){return"DEL"!==t.nodeName?null:e.findTether(t.childNodes)}},{name:"inline_code",func:function(e,t){return"CODE"!==t.nodeName?null:e.findTether(t.childNodes)}},{name:"text",func:function(e,t){if(t.nodeType!==Node.TEXT_NODE)return null;var n=t.textContent.trimEnd();if(!n)return null;var a=document.createRange();return a.selectNode(t),a.setStart(t,n.length),a.setEnd(t,n.length),a}}],nt=new(function(){function e(){var t=this;(0,o.A)(this,e),(0,s.A)(this,"activate",function(e){(e.reply||e.quote)&&void 0!==window.getSelection&&(document.addEventListener("mousedown",t.onSelectStart),document.addEventListener("mouseup",t.onSelectEnd),document.addEventListener("selectionchange",t.onSelectChange),t.options=e,t.toolbar=t.createToolbar(),t.cursor=new Le(t.tether))}),(0,s.A)(this,"onSelectStart",function(){t.selecting=!0}),(0,s.A)(this,"onSelectEnd",function(){t.selecting=!1,t.updateSelection()}),(0,s.A)(this,"onSelectChange",function(){t.selecting||(t.debounce&&window.clearTimeout(t.debounce),t.debounce=window.setTimeout(t.updateSelection,300))}),(0,s.A)(this,"updateSelection",function(){t.selecting||(t.updateState()?t.showToolbar():t.hideToolbar())}),(0,s.A)(this,"reply",function(){var e=document.getElementById("misago-htmx-quick-reply");if(e&&t.quote){var n=e.querySelector(".markup-editor-textarea");n&&(n.value.trim()?n.value+=t.quote:n.value=t.quote.trimStart(),B(pgettext("quote toolbar","Quote added to reply")))}t.clearState()}),(0,s.A)(this,"copyQuote",(0,x.A)(_().mark(function e(){return _().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.quote){e.next=10;break}return e.prev=1,e.next=4,navigator.clipboard.writeText(t.quote);case 4:B(pgettext("quote toolbar","Quote copied to clipboard")),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(1),console.error(e.t0.message);case 10:t.clearState();case 11:case"end":return e.stop()}},e,null,[[1,7]])}))),this.extractor=new Pe(ze),this.postprocess=new Pe(Ve),this.renderer=new Pe(Je),this.tether=new Pe(tt),this.selecting=!1,this.debounce=null,this.options=null,this.toolbar=null,this.cursor=null,this.range=null,this.root=null,this.quote=null}return(0,r.A)(e,[{key:"updateState",value:function(){this.range=null,this.root=null;var e=window.getSelection();if(!e||e.isCollapsed||"Range"!==e.type||0===e.rangeCount)return!1;var t=this.getRange(e),n=this.getRangeRoot(t);return!!n&&(this.range=t,this.root=n,this.quote=this.getSelectionQuote(n),this.range&&this.root&&this.quote)}},{key:"clearState",value:function(){var e=this;this.selecting=!0,this.range=null,this.root=null,this.quote=null,this.hideToolbar(),window.setTimeout(function(){e.selecting=!1},300)}},{key:"getRange",value:function(e){if(1===e.rangeCount)return e.getRangeAt(0);var t=e.getRangeAt(0),n=e.getRangeAt(e.rangeCount-1),a=new Range;return a.setStart(t.startContainer,t.startOffset),a.setEnd(n.endContainer,n.endOffset),a}},{key:"getRangeRoot",value:function(e){var t=this.getCommonAncestor(e);if(!t)return null;var n=t.closest("[misago-quote-root]");return n?{element:n,info:n.getAttribute("misago-quote-root"),ancestor:t,childNodes:e.cloneContents().childNodes}:null}},{key:"getCommonAncestor",value:function(e){var t=e.commonAncestorContainer;return t?t.nodeType===Node.TEXT_NODE?t.parentNode:t:null}},{key:"getSelectionQuote",value:function(e){var t=new Oe(this.extractor,this.renderer,this.postprocess);return t.getQuote(e)?"\n\n"+t.getQuote(e)+"\n\n":""}},{key:"createToolbar",value:function(){var e=document.createElement("div");if(e.className="quote-toolbar",this.options.reply){var t=this.createToolbarButton(pgettext("quote toolbar","Reply"),"reply",this.reply);e.appendChild(t)}if(this.options.quote){var n=this.createToolbarButton(pgettext("quote toolbar","Copy quote"),"content_copy",this.copyQuote);e.appendChild(n)}return document.body.appendChild(e),e}},{key:"createToolbarButton",value:function(e,t,n){var a=document.createElement("button");a.className="quote-toolbar-btn";var i=document.createElement("span");i.className="material-icon",i.innerText=t,a.appendChild(i);var o=document.createElement("span");return o.className="quote-toolbar-btn-text",o.innerText=e,a.appendChild(o),a.addEventListener("click",n),a}},{key:"showToolbar",value:function(){var e=this,t=this.cursor.getPosition(this.root,this.range);t&&(this.toolbar.classList.add("show"),(0,b.rD)(t,this.toolbar,{placement:"bottom",middleware:[(0,b.cY)(4),(0,b.UU)(),(0,b.BN)({padding:8})]}).then(function(t){var n=t.x,a=t.y;Object.assign(e.toolbar.style,{left:"".concat(n,"px"),top:"".concat(a,"px")})}))}},{key:"hideToolbar",value:function(){this.toolbar.classList.remove("show")}}]),e}());function at(e){return it.apply(this,arguments)}function it(){return(it=(0,x.A)(_().mark(function e(t){var n,a;return _().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(n=t.target.closest("[misago-rich-text-code]"))){e.next=8;break}if(t.preventDefault(),!(a=n.querySelector("code").textContent).trim()){e.next=8;break}return e.next=7,navigator.clipboard.writeText(a);case 7:B(pgettext("code copied","Code copied"));case 8:case"end":return e.stop()}},e)}))).apply(this,arguments)}function ot(e){e&&document.querySelectorAll(".tab-group").forEach(function(t){!function(e,t){var n=null,a=null;t.querySelectorAll(".tab-group-nav a").forEach(function(t){t.getAttribute("href")===e&&(a=t),t.classList.contains("active")&&(n=t)});var i=t.querySelector(".tab-group-tab.visible"),o=function(e,t){for(var n=t.querySelectorAll("[misago-tab-group-tab]"),a=0;a<n.length;a++){var i=n[a];if(i.getAttribute("misago-tab-group-tab")===e)return i}return null}(e.substring(1),t);if(a&&o&&a!=n&&o!==i){a.classList.add("active"),o.classList.add("visible"),n&&n.classList.remove("active"),i&&i.classList.remove("visible");var r=new CustomEvent("misago:updated-tab",{bubbles:!0,target:t,oldTab:i,newTab:o});t.dispatchEvent(r)}}(e,t)})}u.A.onLoad(function(){document.querySelectorAll("[misago-rich-text-code] button").forEach(function(e){e.addEventListener("click",at)})}),window.addEventListener("hashchange",function(){ot(window.location.hash)}),u.A.onLoad(function(){ot(window.location.hash)});var rt="m-user-multiple-choice",st="[".concat(rt,"]"),ut="[".concat("m-user-multiple-choice-input","]"),lt="focused",ct=["focusin","click"],dt={Delete:!1,Space:!1,ArrowLeft:!1,ArrowRight:!1},pt=new((0,r.A)(function e(){var t=this;(0,o.A)(this,e),(0,s.A)(this,"activate",function(e){if("true"!==e.getAttribute(rt)){e.setAttribute(rt,"true"),t.element=e,t.maxChoices=Number(e.getAttribute("maxchoices")||1),t.input=document.querySelector(ut),t.template=document.getElementById("m-user-multiple-choice-template"),t.updateInputDisabled(),t.autocomplete=new g({control:t.input,keyOverride:dt,source:I,select:new D({anchor:new f(t.input),placement:"bottom-start"}),getQuery:function(t){var n=t.value.trim().replace(/\s+/,"");if(n.length){var a=[];return e.querySelectorAll("[m-user-id]").forEach(function(e){a.push(e.getAttribute("m-user-id"))}),{exclude:a,value:n}}return null},onSelect:function(e){var n=t.template.content.cloneNode(!0);n.querySelector("li").setAttribute("m-user-id",e.id),n.querySelector("input").value=e.slug,n.querySelector('slot[name="username"]').replaceWith(e.username);var a=e.avatar.filter(function(e){return e.size>=32}).reverse(),i=n.querySelector("img");a.length?i.setAttribute("src",a[0].url):i.remove(),t.input.value="",t.input.parentElement.before(n),t.updateInputDisabled(),t.input.disabled||t.input.focus(),t.focus()}}),ct.forEach(function(n){e.addEventListener(n,t.focus)}),ct.forEach(function(n){document.addEventListener(n,function(n){e.contains(n.target)||t.autocomplete.isEventTarget(n)||t.blur()})}),t.element.addEventListener("click",function(e){var n=e.target.closest("button");n&&t.deleteItem(n.closest("li")),t.focus()});var n=!1;t.input.addEventListener("keydown",function(e){if("Backspace"===e.key&&!n&&(n=!0,""===e.target.value.trim())){var a=e.target.closest("li").previousElementSibling;a&&t.deleteItem(a)}}),t.input.addEventListener("keyup",function(e){"Backspace"===e.key&&(n=!1)})}}),(0,s.A)(this,"focus",function(){t.element.classList.add(lt)}),(0,s.A)(this,"blur",function(){t.element.classList.remove(lt)}),(0,s.A)(this,"deleteItem",function(e){e.remove(),t.updateInputDisabled()}),(0,s.A)(this,"updateInputDisabled",function(){t.input.disabled=t.element.querySelectorAll("li").length-1>=t.maxChoices}),this.autocomplete=null,this.element=null,this.input=null,this.template=null}));u.A.onLoad(function(){var e=document.querySelector(st);e&&pt.activate(e)});const ht=pt;n(18764);var mt=n(74692),ft=new d,vt=new Z;u.A.config.historyEnabled=!1,u.A.config.historyCacheSize=0;var At=new(function(){function e(){(0,o.A)(this,e),(0,s.A)(this,"hideMarkAsReadModal",function(){mt("#mark-as-read").modal("hide")}),(0,s.A)(this,"mention",function(e){return new i.Mention(e)}),this._initializers=[],this._context={},this.htmx=u.A,this.loader=ft,this.editor=we,this.lightbox=vt,this.quote=nt,this.deleteElement=q,this.slideUpElement=U,this.activatePollChoicesControl=Se,this.tabGroups=ot,this.userMultipleChoice=ht}return(0,r.A)(e,[{key:"addInitializer",value:function(e){this._initializers.push({key:e.name,item:e.initializer,after:e.after,before:e.before})}},{key:"init",value:function(e){var t=this;this._context=e,new l(this._initializers).orderedValues().forEach(function(e){e(t)})}},{key:"has",value:function(e){return!!this._context[e]}},{key:"get",value:function(e,t){return this.has(e)?this._context[e]:t||void 0}},{key:"pop",value:function(e){if(this.has(e)){var t=this._context[e];return this._context[e]=null,t}}},{key:"snackbar",value:function(e,t){S(e,t)}},{key:"snackbarInfo",value:function(e){B(e)}},{key:"snackbarSuccess",value:function(e){!function(e){S("success",e)}(e)}},{key:"snackbarWarning",value:function(e){!function(e){S("warning",e)}(e)}},{key:"snackbarError",value:function(e){L(e)}},{key:"snackbarHttpResponseError",value:function(e){T(e)}},{key:"bulkModeration",value:function(e){return new h(e)}}]),e}());window.misago=At;const gt=At;document.addEventListener("htmx:beforeRequest",function(e){c(e.target)&&ft.show()}),document.addEventListener("htmx:afterRequest",function(e){c(e.target)&&ft.hide()}),document.addEventListener("htmx:load",function(){document.querySelectorAll("[misago-editor-active='false']").forEach(Ee.activate)}),document.addEventListener("misago:afterModeration",function(){mt("#threads-moderation-modal").modal("hide")}),document.addEventListener("misago:afterUpdateMembers",function(){mt("#add-members-modal").modal("hide")}),document.addEventListener("submit",function(e){var t=e.target.closest("form[misago-confirm]");t&&!window.confirm(t.getAttribute("misago-confirm"))&&e.preventDefault()})},74017:(e,t,n)=>{"use strict";n.d(t,{A:()=>D});var a,i=n(73620),o=n(95093),r=n.n(o),s=n(40927),u=n.n(s),l=n(40961),c=n.n(l),d=n(67467),p=n(23029),h=n(92901),m=n(15361),f=n(61801),v=n(53954);var A=function(e){(0,m.A)(s,e);var t,n,o=(t=s,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}(),function(){var e,a=(0,v.A)(t);if(n){var i=(0,v.A)(this).constructor;e=Reflect.construct(a,arguments,i)}else e=a.apply(this,arguments);return(0,f.A)(this,e)});function s(){return(0,p.A)(this,s),o.apply(this,arguments)}return(0,h.A)(s,[{key:"getReasonMessage",value:function(){return this.props.message.html?(0,i.A)("div",{className:"lead",dangerouslySetInnerHTML:{__html:this.props.message.html}}):(0,i.A)("p",{className:"lead"},void 0,this.props.message.plain)}},{key:"getExpirationMessage",value:function(){if(this.props.expires){if(this.props.expires.isAfter(r()())){var e=interpolate(pgettext("banned page","This ban expires on %(expires_on)s."),{expires_on:this.props.expires.format("LL, LT")},!0),t=interpolate(pgettext("banned page","This ban expires %(expires_on)s."),{expires_on:this.props.expires.fromNow()},!0);return(0,i.A)("abbr",{title:e},void 0,t)}return pgettext("banned page","This ban has expired.")}return pgettext("banned page","This ban is permanent.")}},{key:"render",value:function(){return(0,i.A)("div",{className:"page page-error page-error-banned"},void 0,(0,i.A)("div",{className:"container"},void 0,(0,i.A)("div",{className:"message-panel"},void 0,a||(a=(0,i.A)("div",{className:"message-icon"},void 0,(0,i.A)("span",{className:"material-icon"},void 0,"highlight_off"))),(0,i.A)("div",{className:"message-body"},void 0,this.getReasonMessage(),(0,i.A)("p",{className:"message-footnote"},void 0,this.getExpirationMessage())))))}}]),s}(u().Component),g=n(73971),y=n(52762),b=(0,d.Ng)(function(e){return e.tick})(A);function D(e,t){if(c().render((0,i.A)(d.Kq,{store:y.A.getStore()},void 0,(0,i.A)(b,{message:e.message,expires:e.expires_on?r()(e.expires_on):null})),document.getElementById("page-mount")),void 0===t||t){var n=g.A.get("SETTINGS").forum_name;document.title=pgettext("banned error title","You are banned")+" | "+n,window.history.pushState({},"",g.A.get("BANNED_URL"))}}},74676:(e,t,n)=>{"use strict";var a=n(73971),i=n(82620),o=n(52762);a.A.addInitializer({name:"reducer:profile-details",initializer:function(){var e=null;a.A.has("PROFILE_DETAILS")&&(e=a.A.get("PROFILE_DETAILS")),o.A.addReducer("profile-details",i.Ay,e||{})},before:"store"})},75617:(e,t,n)=>{"use strict";var a=n(73971),i=n(51433),o=n(52762);a.A.addInitializer({name:"reducer:poll",initializer:function(){var e;e=a.A.has("THREAD")&&a.A.get("THREAD").poll?(0,i.Qv)(a.A.get("THREAD").poll):{},o.A.addReducer("poll",i.Ay,e)},before:"store"})},76671:(e,t,n)=>{"use strict";n.d(t,{A:()=>c});var a=n(73620),i=n(23029),o=n(92901),r=n(15361),s=n(61801),u=n(53954),l=n(40927);var c=function(e){(0,r.A)(c,e);var t,n,l=(t=c,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}(),function(){var e,a=(0,u.A)(t);if(n){var i=(0,u.A)(this).constructor;e=Reflect.construct(a,arguments,i)}else e=a.apply(this,arguments);return(0,s.A)(this,e)});function c(){return(0,i.A)(this,c),l.apply(this,arguments)}return(0,o.A)(c,[{key:"getHelpText",value:function(){return this.props.helpText?(0,a.A)("p",{className:"help-block"},void 0,this.props.helpText):null}},{key:"render",value:function(){return(0,a.A)("div",{className:"panel-body panel-message-body"},void 0,(0,a.A)("div",{className:"message-icon"},void 0,(0,a.A)("span",{className:"material-icon"},void 0,this.props.icon||"info_outline")),(0,a.A)("div",{className:"message-body"},void 0,(0,a.A)("p",{className:"lead"},void 0,this.props.message),this.getHelpText()))}}]),c}(n.n(l)().Component)},79678:(e,t,n)=>{"use strict";n.d(t,{FI:()=>D,H7:()=>k,hs:()=>m});var a=window.misago_locale||"en-us",i=pgettext("time ago","moment ago"),o=pgettext("time ago","now"),r=pgettext("day at time","%(day)s at %(time)s"),s=pgettext("day at time","Today at %(time)s"),u=pgettext("day at time","Tomorrow at %(time)s"),l=pgettext("day at time","Yesterday at %(time)s"),c=pgettext("short minutes","%(time)sm"),d=pgettext("short hours","%(time)sh"),p=pgettext("short days","%(time)sd"),h=new Intl.RelativeTimeFormat(a,{numeric:"always",style:"long"}),m=new Intl.DateTimeFormat(a,{dateStyle:"full",timeStyle:"medium"}),f=new Intl.DateTimeFormat(a,{month:"long",day:"numeric"}),v=new Intl.DateTimeFormat(a,{year:"numeric",month:"long",day:"numeric"}),A=(new Intl.DateTimeFormat(a,{year:"2-digit",month:"short",day:"numeric"}),new Intl.DateTimeFormat(a,{weekday:"long"})),g=new Intl.DateTimeFormat(a,{timeStyle:"short"}),y=new Intl.DateTimeFormat(a,{month:"short",day:"numeric"}),b=new Intl.DateTimeFormat(a,{month:"short",year:"numeric"});function D(e){var t=new Date,n=Math.round((e-t)/1e3),a=Math.abs(n),o=n<1?-1:1;if(a<90)return i;if(a<2820){var c=Math.round(a/60)*o;return h.format(c,"minute")}if(a<10800){var d=Math.round(a/3600)*o;return h.format(d,"hour")}return x(t,e)?n>0?s.replace("%(time)s",g.format(e)):g.format(e):function(e){var t=new Date;return t.setDate(t.getDate()-1),x(t,e)}(e)?l.replace("%(time)s",g.format(e)):function(e){var t=new Date;return t.setDate(t.getDate()+1),x(t,e)}(e)?u.replace("%(time)s",g.format(e)):n<0&&a<518400?function(e,t){return r.replace("%(day)s",e).replace("%(time)s",g.format(t))}(A.format(e),e):t.getFullYear()==e.getFullYear()?f.format(e):v.format(e)}function x(e,t){return e.getFullYear()==t.getFullYear()&&e.getMonth()==t.getMonth()&&e.getDate()==t.getDate()}function k(e){var t=new Date,n=Math.abs(Math.round((e-t)/1e3));if(n<60)return o;if(n<3300){var a=Math.round(n/60);return c.replace("%(time)s",a)}if(n<86400){var i=Math.round(n/3600);return d.replace("%(time)s",i)}if(n<604800){var r=Math.round(n/86400);return p.replace("%(time)s",r)}return e.getFullYear()===t.getFullYear()?y.format(e):b.format(e)}},79932:(e,t,n)=>{"use strict";var a=n(73971),i=n(29156),o=n(52762);a.A.addInitializer({name:"reducer:thread",initializer:function(){var e;e=a.A.has("THREAD")?(0,i.Qv)(a.A.get("THREAD")):{isBusy:!1},o.A.addReducer("thread",i.Ay,e)},before:"store"})},80879:(e,t,n)=>{"use strict";var a=n(73971),i=n(74017);a.A.addInitializer({name:"component:banmed-page",initializer:function(e){e.has("BAN_MESSAGE")&&(0,i.A)(e.get("BAN_MESSAGE"),!1)},after:"store"})},81002:(e,t,n)=>{"use strict";n.d(t,{A:()=>u});var a=n(73620),i=(n(40927),n(67467)),o=n(63426),r=n(65407);function s(e,t){var n=misago.get("NOTIFICATIONS_API")+"?limit=30";return n+="&filter="+e,t&&(t.after&&(n+="&after="+t.after),t.before&&(n+="&before="+t.before)),n}const u=(0,i.Ng)(function(e){var t=e.auth;return t.user?{unreadNotifications:t.user.unreadNotifications}:{unreadNotifications:null}})(function(e){var t=e.children,n=e.filter,i=e.query,u=e.dispatch,l=e.unreadNotifications,c=e.disabled;return(0,a.A)(r.V,{url:s(n,i),disabled:c,onData:function(e){e.unreadNotifications!=l&&u((0,o.KK)({unreadNotifications:e.unreadNotifications}))}},void 0,function(e){var n=e.data,a=e.loading,i=e.error,o=e.refetch;return t({data:n,loading:a,error:i,refetch:o})})})},81994:(e,t,n)=>{"use strict";n.d(t,{A:()=>_});var a=n(73620),i=n(40927),o=n.n(i),r=n(35248);function s(e){return e.post.content?o().createElement(u,e):o().createElement(l,e)}function u(e){return(0,a.A)("div",{className:"post-body"},void 0,(0,a.A)(r.A,{markup:e.post.headline||e.post.content}))}function l(e){return(0,a.A)("div",{className:"post-body post-body-invalid"},void 0,(0,a.A)("p",{className:"lead"},void 0,pgettext("post body invalid","This post's contents cannot be displayed.")),(0,a.A)("p",{className:"text-muted"},void 0,pgettext("post body invalid","This error is caused by invalid post content manipulation.")))}function c(e){var t=e.post,n=t.category,i=t.thread,o=interpolate(pgettext("posts feed item header","posted %(posted_on)s"),{posted_on:t.posted_on.format("LL, LT")},!0);return(0,a.A)("div",{className:"post-heading"},void 0,(0,a.A)("a",{className:"btn btn-link item-title",href:i.url},void 0,i.title),(0,a.A)("a",{className:"btn btn-link post-category",href:n.url.index},void 0,n.name),(0,a.A)("a",{href:t.url.index,className:"btn btn-link posted-on",title:o},void 0,t.posted_on.fromNow()))}var d,p,h=n(30330);function m(e){var t=e.post;return(0,a.A)("a",{className:"btn btn-default btn-icon pull-right",href:t.url.index},void 0,(0,a.A)("span",{className:"btn-text-left hidden-xs"},void 0,pgettext("go to post link","See post")),d||(d=(0,a.A)("span",{className:"material-icon"},void 0,"chevron_right")))}function f(e){var t=e.post;return(0,a.A)("div",{className:"post-side post-side-anonymous"},void 0,(0,a.A)(m,{post:t}),(0,a.A)("div",{className:"media"},void 0,p||(p=(0,a.A)("div",{className:"media-left"},void 0,(0,a.A)("span",{},void 0,(0,a.A)(h.Ay,{className:"poster-avatar",size:50})))),(0,a.A)("div",{className:"media-body"},void 0,(0,a.A)("div",{className:"media-heading"},void 0,(0,a.A)("span",{className:"item-title"},void 0,t.poster_name)),(0,a.A)("span",{className:"user-title user-title-anonymous"},void 0,pgettext("post removed poster username","Removed user")))))}function v(e){var t=e.rank,n=e.title||t.title||t.name,i="user-title";return t.css_class&&(i+=" user-title-"+t.css_class),t.is_tab?(0,a.A)("a",{className:i,href:t.url},void 0,n):(0,a.A)("span",{className:i},void 0,n)}function A(e){var t=e.post,n=e.poster;return(0,a.A)("div",{className:"post-side post-side-registered"},void 0,(0,a.A)(m,{post:t}),(0,a.A)("div",{className:"media"},void 0,(0,a.A)("div",{className:"media-left"},void 0,(0,a.A)("a",{href:n.url},void 0,(0,a.A)(h.Ay,{className:"poster-avatar",size:50,user:n}))),(0,a.A)("div",{className:"media-body"},void 0,(0,a.A)("div",{className:"media-heading"},void 0,(0,a.A)("a",{className:"item-title",href:n.url},void 0,n.username)),(0,a.A)(v,{title:n.title,rank:n.rank}))))}function g(e){var t=e.post,n=e.poster;return n&&n.id?(0,a.A)(A,{post:t,poster:n}):(0,a.A)(f,{post:t})}function y(e){var t=e.post,n=e.poster||t.poster,i="post";return n&&n.rank.css_class&&(i+=" post-"+n.rank.css_class),(0,a.A)("li",{className:i,id:"post-"+t.id},void 0,(0,a.A)("div",{className:"panel panel-default panel-post"},void 0,(0,a.A)("div",{className:"panel-body"},void 0,(0,a.A)("div",{className:"panel-content"},void 0,(0,a.A)(g,{post:t,poster:n}),(0,a.A)(c,{post:t}),(0,a.A)(s,{post:t})))))}var b,D,x=n(33097);function k(){return(0,a.A)("ul",{className:"posts-list post-feed ui-preview"},void 0,(0,a.A)("li",{className:"post"},void 0,(0,a.A)("div",{className:"panel panel-default panel-post"},void 0,(0,a.A)("div",{className:"panel-body"},void 0,(0,a.A)("div",{className:"panel-content"},void 0,(0,a.A)("div",{className:"post-side post-side-anonymous"},void 0,(0,a.A)("div",{className:"media"},void 0,b||(b=(0,a.A)("div",{className:"media-left"},void 0,(0,a.A)("span",{},void 0,(0,a.A)(h.Ay,{className:"poster-avatar",size:50})))),(0,a.A)("div",{className:"media-body"},void 0,(0,a.A)("div",{className:"media-heading"},void 0,(0,a.A)("span",{className:"item-title"},void 0,(0,a.A)("span",{className:"ui-preview-text",style:{width:x.W(30,200)+"px"}},void 0,"Â "))),(0,a.A)("span",{className:"user-title user-title-anonymous"},void 0,(0,a.A)("span",{className:"ui-preview-text",style:{width:x.W(30,200)+"px"}},void 0,"Â "))))),(0,a.A)("div",{className:"post-heading"},void 0,(0,a.A)("span",{className:"ui-preview-text",style:{width:x.W(30,200)+"px"}},void 0,"Â ")),(0,a.A)("div",{className:"post-body"},void 0,(0,a.A)("article",{className:"misago-markup"},void 0,(0,a.A)("p",{},void 0,(0,a.A)("span",{className:"ui-preview-text",style:{width:x.W(30,200)+"px"}},void 0,"Â "),"Â ",(0,a.A)("span",{className:"ui-preview-text",style:{width:x.W(30,200)+"px"}},void 0,"Â "),"Â ",(0,a.A)("span",{className:"ui-preview-text",style:{width:x.W(30,200)+"px"}},void 0,"Â ")))))))))}function _(e){var t=e.isReady,n=e.posts,i=e.poster;return t?(0,a.A)("ul",{className:"posts-list post-feed ui-ready"},void 0,n.map(function(e){return(0,a.A)(y,{post:e,poster:i},e.id)})):D||(D=(0,a.A)(k,{}))}},82620:(e,t,n)=>{"use strict";n.d(t,{Ay:()=>o,Hh:()=>i});var a="LOAD_DETAILS";function i(e){return{type:a,newState:e}}function o(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return t.type===a?t.newState:e}},82743:(e,t,n)=>{"use strict";n.d(t,{A:()=>c});var a=n(73620),i=n(23029),o=n(92901),r=n(15361),s=n(61801),u=n(53954),l=n(40927);var c=function(e){(0,r.A)(c,e);var t,n,l=(t=c,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}(),function(){var e,a=(0,u.A)(t);if(n){var i=(0,u.A)(this).constructor;e=Reflect.construct(a,arguments,i)}else e=a.apply(this,arguments);return(0,s.A)(this,e)});function c(){return(0,i.A)(this,c),l.apply(this,arguments)}return(0,o.A)(c,[{key:"isValidated",value:function(){return void 0!==this.props.validation}},{key:"getClassName",value:function(){var e="form-group";return this.isValidated()&&(e+=" has-feedback",null===this.props.validation?e+=" has-success":e+=" has-error"),e}},{key:"getFeedback",value:function(){var e=this;return this.props.validation?(0,a.A)("div",{className:"help-block errors"},void 0,this.props.validation.map(function(t,n){return(0,a.A)("p",{},e.props.for+"FeedbackItem"+n,t)})):null}},{key:"getFeedbackDescription",value:function(){return this.isValidated()?(0,a.A)("span",{id:this.props.for+"_status",className:"sr-only"},void 0,this.props.validation?pgettext("field validation status","(error)"):pgettext("field validation status","(success)")):null}},{key:"getHelpText",value:function(){return this.props.helpText?(0,a.A)("p",{className:"help-block"},void 0,this.props.helpText):null}},{key:"render",value:function(){return(0,a.A)("div",{className:this.getClassName()},void 0,(0,a.A)("label",{className:"control-label "+(this.props.labelClass||""),htmlFor:this.props.for||""},void 0,this.props.label+":"),(0,a.A)("div",{className:this.props.controlClass||""},void 0,this.props.children,this.getFeedbackDescription(),this.getFeedback(),this.getHelpText(),this.props.extra||null))}}]),c}(n.n(l)().Component)},82853:(e,t,n)=>{"use strict";n.d(t,{A:()=>s});var a=n(73620),i=(n(40927),n(73971)),o=n(20127),r=function(e){var t=e.agreement,n=e.checked,i=e.errors,r=e.url,s=e.value,u=e.onChange;if(!r)return null;var l=interpolate('<a href="%(url)s" target="_blank">%(agreement)s</a>',{agreement:(0,o.A)(t),url:(0,o.A)(r)},!0),c=interpolate(pgettext("register form agreement prompt","I have read and accept %(agreement)s."),{agreement:l},!0);return(0,a.A)("div",{className:"checkbox legal-footnote"},void 0,(0,a.A)("label",{},void 0,(0,a.A)("input",{checked:n,type:"checkbox",value:s,onChange:u}),(0,a.A)("span",{dangerouslySetInnerHTML:{__html:c}})),i&&i.map(function(e,t){return(0,a.A)("div",{className:"help-block errors"},t,e)}))};const s=function(e){var t=e.errors,n=e.privacyPolicy,o=e.termsOfService,s=e.onPrivacyPolicyChange,u=e.onTermsOfServiceChange,l=i.A.get("TERMS_OF_SERVICE_ID"),c=i.A.get("TERMS_OF_SERVICE_URL"),d=i.A.get("PRIVACY_POLICY_ID"),p=i.A.get("PRIVACY_POLICY_URL");return l||d?(0,a.A)("div",{},void 0,(0,a.A)(r,{agreement:pgettext("register form agreement prompt","the terms of service"),checked:null!==o,errors:t.termsOfService,url:c,value:l,onChange:u}),(0,a.A)(r,{agreement:pgettext("register form agreement prompt","the privacy policy"),checked:null!==n,errors:t.privacyPolicy,url:p,value:d,onChange:s})):null}},83484:(e,t,n)=>{"use strict";var a=n(73971),i=n(39395);a.A.addInitializer({name:"page-title",initializer:function(e){i.A.init(e.get("SETTINGS").forum_index_title,e.get("SETTINGS").forum_name)}})},84979:(e,t,n)=>{"use strict";var a=n(73620),i=n(40927),o=n.n(i),r=n(73971),s=n(23029),u=n(92901),l=n(9417),c=n(15361),d=n(61801),p=n(53954),h=n(64467),m=n(92069);var f=function(e){(0,c.A)(o,e);var t,n,i=(t=o,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}(),function(){var e,a=(0,p.A)(t);if(n){var i=(0,p.A)(this).constructor;e=Reflect.construct(a,arguments,i)}else e=a.apply(this,arguments);return(0,d.A)(this,e)});function o(e){var t;return(0,s.A)(this,o),t=i.call(this,e),(0,h.A)((0,l.A)(t),"handleDecline",function(){t.state.submiting||window.confirm(pgettext("accept agreement prompt","Declining will result in immediate deactivation and deletion of your account. This action is not reversible."))&&(t.setState({submiting:!0}),m.A.post(t.props.api,{accept:!1}).then(function(){window.location.reload(!0)}))}),(0,h.A)((0,l.A)(t),"handleAccept",function(){t.state.submiting||(t.setState({submiting:!0}),m.A.post(t.props.api,{accept:!0}).then(function(){window.location.reload(!0)}))}),t.state={submiting:!1},t}return(0,u.A)(o,[{key:"render",value:function(){return(0,a.A)("div",{},void 0,(0,a.A)("button",{className:"btn btn-default",disabled:this.state.submiting,type:"buton",onClick:this.handleDecline},void 0,pgettext("accept agreement choice","Decline")),(0,a.A)("button",{className:"btn btn-primary",disabled:this.state.submiting,type:"buton",onClick:this.handleAccept},void 0,pgettext("accept agreement choice","Accept and continue")))}}]),o}(o().Component),v=n(92979);r.A.addInitializer({name:"component:accept-agreement",initializer:function(e){document.getElementById("required-agreement-mount")&&(0,v.A)((0,a.A)(f,{api:e.get("REQUIRED_AGREEMENT_API")}),"required-agreement-mount",!1)},after:"store"})},85057:(e,t,n)=>{"use strict";n.d(t,{A:()=>d});var a=n(23029),i=n(92901),o=n(9417),r=n(15361),s=n(61801),u=n(53954),l=n(64467),c=n(40927);var d=function(e){(0,r.A)(d,e);var t,n,c=(t=d,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}(),function(){var e,a=(0,u.A)(t);if(n){var i=(0,u.A)(this).constructor;e=Reflect.construct(a,arguments,i)}else e=a.apply(this,arguments);return(0,s.A)(this,e)});function d(e){var t;return(0,a.A)(this,d),t=c.call(this,e),(0,l.A)((0,o.A)(t),"toggleNav",function(){t.setState({dropdown:!t.state.dropdown})}),(0,l.A)((0,o.A)(t),"hideNav",function(){t.setState({dropdown:!1})}),t.state={dropdown:!1},t}return(0,i.A)(d,[{key:"getCompactNavClassName",value:function(){return this.state.dropdown?"compact-nav open":"compact-nav"}}]),d}(n.n(c)().Component)},86511:(e,t,n)=>{"use strict";n.d(t,{A:()=>p});var a=n(73620),i=n(23029),o=n(92901),r=n(9417),s=n(15361),u=n(61801),l=n(53954),c=n(64467),d=n(40927);var p=function(e){(0,s.A)(p,e);var t,n,d=(t=p,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}(),function(){var e,a=(0,l.A)(t);if(n){var i=(0,l.A)(this).constructor;e=Reflect.construct(a,arguments,i)}else e=a.apply(this,arguments);return(0,u.A)(this,e)});function p(){var e;(0,i.A)(this,p);for(var t=arguments.length,n=new Array(t),a=0;a<t;a++)n[a]=arguments[a];return e=d.call.apply(d,[this].concat(n)),(0,c.A)((0,r.A)(e),"change",function(t){return function(){e.props.onChange({target:{value:t}})}}),e}return(0,o.A)(p,[{key:"getChoice",value:function(){var e=this,t=null;return this.props.choices.map(function(n){n.value===e.props.value&&(t=n)}),t}},{key:"getIcon",value:function(){return this.getChoice().icon}},{key:"getLabel",value:function(){return this.getChoice().label}},{key:"render",value:function(){var e=this;return(0,a.A)("div",{className:"btn-group btn-select-group"},void 0,(0,a.A)("button",{type:"button",className:"btn btn-select dropdown-toggle",id:this.props.id||null,"data-toggle":"dropdown","aria-haspopup":"true","aria-expanded":"false","aria-describedby":this.props["aria-describedby"]||null,disabled:this.props.disabled||!1},void 0,(0,a.A)(h,{icon:this.getIcon()}),this.getLabel()),(0,a.A)("ul",{className:"dropdown-menu"},void 0,this.props.choices.map(function(t,n){return(0,a.A)("li",{},n,(0,a.A)("button",{type:"button",className:"btn-link",onClick:e.change(t.value)},void 0,(0,a.A)(h,{icon:t.icon}),t.label))})))}}]),p}(n.n(d)().Component);function h(e){var t=e.icon;return t?(0,a.A)("span",{className:"material-icon"},void 0,t):null}},86552:(e,t,n)=>{"use strict";function a(e,t){var n=[];return e.concat(t).filter(function(e){return-1===n.indexOf(e.id)&&(n.push(e.id),!0)})}n.d(t,{A:()=>a})},88095:(e,t,n)=>{"use strict";n.d(t,{A:()=>c});var a=n(73620),i=(n(40927),n(40961)),o=n.n(i),r=n(67467),s=n(28542),u=n(52762),l=document.getElementById("page-mount");function c(e){var t={component:e.component||null,childRoutes:[]};e.root?t.childRoutes=[{path:e.root,onEnter:function(t,n){n(null,e.paths[0].path)}}].concat(e.paths):t.childRoutes=e.paths,o().render((0,a.A)(r.Kq,{store:u.A.getStore()},void 0,(0,a.A)(s.Ix,{routes:t,history:s.Nc})),l)}},88771:(e,t,n)=>{"use strict";var a=n(73971),i=n(70490);a.A.addInitializer({name:"modal",initializer:function(){var e=document.getElementById("modal-mount");e&&i.A.init(e)},before:"store"})},89053:(e,t,n)=>{"use strict";n.d(t,{Ay:()=>o,HC:()=>i});var a="REPLACE_PARTICIPANTS";function i(e){return{type:a,state:e}}function o(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return t.type===a?t.state:e}},89077:(e,t,n)=>{"use strict";n.d(t,{Bp:()=>c,FC:()=>h,KP:()=>m,Oi:()=>f,Rp:()=>l,Ru:()=>d,Yc:()=>u,jC:()=>p,mw:()=>r,xi:()=>s});var a=/^(([^<>()[\]\.,;:\s@\"]+(\.[^<>()[\]\.,;:\s@\"]+)*)|(\".+\"))@(([^<>()[\]\.,;:\s@\"]+\.)+[^<>()[\]\.,;:\s@\"]{2,})$/i,i=new RegExp("^[0-9a-z_]+$","i"),o=new RegExp("[0-9a-z]","i");function r(e){return function(t){if(!1===t||null===t||0===String(t).trim().length)return e||gettext("This field is required.")}}function s(e){var t=pgettext("agreement validator","You have to accept the terms of service.");return r(e||t)}function u(e){var t=pgettext("agreement validator","You have to accept the privacy policy.");return r(e||t)}function l(e){return function(t){if(!a.test(t))return e||pgettext("email validator","Enter a valid e-mail address.")}}function c(e,t){return function(n){var a="",i=n.trim().length;if(i<e)return a=t?t(e,i):npgettext("value length validator","Ensure this value has at least %(limit_value)s character (it has %(show_value)s).","Ensure this value has at least %(limit_value)s characters (it has %(show_value)s).",e),interpolate(a,{limit_value:e,show_value:i},!0)}}function d(e,t){return function(n){var a="",i=n.trim().length;if(i>e)return a=t?t(e,i):npgettext("value length validator","Ensure this value has at most %(limit_value)s character (it has %(show_value)s).","Ensure this value has at most %(limit_value)s characters (it has %(show_value)s).",e),interpolate(a,{limit_value:e,show_value:i},!0)}}function p(e){return c(e,function(e){return npgettext("username length validator","Username must be at least %(limit_value)s character long.","Username must be at least %(limit_value)s characters long.",e)})}function h(e){return d(e,function(e){return npgettext("username length validator","Username cannot be longer than %(limit_value)s character.","Username cannot be longer than %(limit_value)s characters.",e)})}function m(){return function(e){var t=e.trim();return i.test(t)?o.test(t)?void 0:pgettext("username validator","Username must contain Latin alphabet letters or digits."):pgettext("username validator","Username can only contain Latin alphabet letters, digits, and an underscore sign.")}}function f(e){return function(t){var n=t.length;if(n<e){var a=npgettext("password length validator","Valid password must be at least %(limit_value)s character long.","Valid password must be at least %(limit_value)s characters long.",e);return interpolate(a,{limit_value:e,show_value:n},!0)}}}},91043:(e,t,n)=>{"use strict";n.d(t,{Cn:()=>f,BE:()=>g});var a,i,o,r=n(73620),s=n(32485),u=n.n(s),l=(n(40927),n(67467)),c=n(25913),d=n(41484),p=n(68333),h=(0,l.Ng)(function(e){return{isAnonymous:!e.auth.user.id}})(function(e){var t=e.isAnonymous,n=e.close,s=e.dropdown,l=e.overlay,h=misago.get("MISAGO_PATH"),m=misago.get("SETTINGS"),f=misago.get("main_menu"),v=misago.get("extraMenuItems"),A=misago.get("extraFooterItems"),g=misago.get("categories_menu"),y=misago.get("usersLists"),b=m.enable_oauth2_client,D=[];f.forEach(function(e){D.push({title:e.label,url:e.url})}),D.push({title:pgettext("site nav","Search"),url:h+"search/"});var x=[],k=misago.get("TERMS_OF_SERVICE_TITLE"),_=misago.get("TERMS_OF_SERVICE_URL");k&&_&&x.push({title:k,url:_});var N=misago.get("PRIVACY_POLICY_TITLE"),C=misago.get("PRIVACY_POLICY_URL");return N&&C&&x.push({title:N,url:C}),(0,r.A)("ul",{className:u()("site-nav-menu",{"dropdown-menu-list":s,"overlay-menu-list":l})},void 0,t&&(0,r.A)(c.hO,{className:"site-nav-sign-in-message"},void 0,pgettext("cta","You are not signed in")),t&&(0,r.A)(c.Qb,{className:"site-nav-sign-in-options"},void 0,(0,r.A)(p.A,{onClick:n}),!b&&(0,r.A)(d.A,{onClick:n})),(0,r.A)(c.dX,{},void 0,m.forum_name),D.map(function(e){return(0,r.A)(c._2,{},e.url,(0,r.A)("a",{href:e.url},void 0,e.title))}),v.map(function(e,t){return(0,r.A)(c._2,{className:e.className},t,(0,r.A)("a",{href:e.url,target:e.targetBlank?"_blank":null,rel:e.rel},void 0,e.title))}),!!y.length&&(a||(a=(0,r.A)(c.rx,{className:"site-nav-users-divider"}))),!!y.length&&(0,r.A)(c.dX,{className:"site-nav-users"},void 0,pgettext("site nav section","Users")),y.map(function(e){return(0,r.A)(c._2,{},e.url,(0,r.A)("a",{href:e.url},void 0,e.name))}),i||(i=(0,r.A)(c.rx,{className:"site-nav-categories-divider"})),(0,r.A)(c.dX,{className:"site-nav-categories"},void 0,pgettext("site nav section","Categories")),g.map(function(e){return e.is_vanilla?(0,r.A)(c._2,{className:"site-nav-category-header"},e.id,(0,r.A)("a",{href:e.url},void 0,e.name)):(0,r.A)(c._2,{className:u()("site-nav-category",{"site-nav-category-last":e.last})},e.id,(0,r.A)("a",{href:e.url},void 0,(0,r.A)("span",{},void 0,e.name),(0,r.A)("span",{className:u()("threads-list-item-category threads-list-category-label",{"threads-list-category-label-color":!!e.color}),style:{"--label-color":e.color}},void 0,e.short_name||e.name)))}),(!!x.length||!!A.length)&&(o||(o=(0,r.A)(c.rx,{className:"site-nav-footer-divider"}))),(!!x.length||!!A.length)&&(0,r.A)(c.dX,{className:"site-nav-footer"},void 0,pgettext("site nav section","Footer")),A.map(function(e,t){return(0,r.A)(c._2,{className:e.className},t,(0,r.A)("a",{href:e.url,target:e.targetBlank?"_blank":null,rel:e.rel},void 0,e.title))}),x.map(function(e){return(0,r.A)(c._2,{},e.url,(0,r.A)("a",{href:e.url},void 0,e.title))}))});const m=h;function f(e){var t=e.close;return(0,r.A)(m,{close:t,dropdown:!0})}var v=n(22926),A=n(64015);const g=(0,l.Ng)(function(e){return{isOpen:e.overlay.siteNav}})(function(e){var t=e.dispatch,n=e.isOpen;return(0,r.A)(A.h,{open:n},void 0,(0,r.A)(A.e,{},void 0,pgettext("site nav title","Menu")),(0,r.A)(m,{close:function(){return t((0,v.VN)())},overlay:!0}))})},91864:(e,t,n)=>{"use strict";var a=n(73971),i=n(63426),o=n(92069),r=(n(29904),n(52762));a.A.addInitializer({name:"auth-sync",initializer:function(e){e.get("isAuthenticated")&&window.setInterval(function(){o.A.get(e.get("AUTH_API")).then(function(e){r.A.dispatch((0,i.F6)(e))})},45e3)},after:"auth"})},92069:(e,t,n)=>{"use strict";n.d(t,{A:()=>r});var a=n(23029),i=n(92901),o=n(74692);const r=new(function(){function e(){(0,a.A)(this,e),this._cookieName=null,this._csrfToken=null,this._locks={}}return(0,i.A)(e,[{key:"init",value:function(e){this._cookieName=e}},{key:"getCsrfToken",value:function(){if(-1!==document.cookie.indexOf(this._cookieName)){var e=new RegExp(this._cookieName+"=([^;]*)"),t=document.cookie.match(e)[0];return t?t.split("=")[1]:null}return null}},{key:"request",value:function(e,t,n){var a=this;return new Promise(function(i,r){var s={url:t,method:e,headers:{"X-CSRFToken":a.getCsrfToken()},data:n?JSON.stringify(n):null,contentType:"application/json; charset=utf-8",dataType:"json",success:function(e){i(e)},error:function(e){var t=e.responseJSON||{};t.status=e.status,0===t.status&&(t.detail=pgettext("ajax client error","Could not connect to the site.")),404===t.status&&(t.detail&&"NOT FOUND"!==t.detail||(t.detail=pgettext("ajax client error","Action link is invalid."))),500!==t.status||t.detail||(t.detail=pgettext("ajax client error","Unknown error has occurred.")),t.statusText=e.statusText,r(t)}};o.ajax(s)})}},{key:"get",value:function(e,t,n){if(t&&(e+="?"+o.param(t)),n){var a=this;return this._locks[n]&&(this._locks[n].url=e),this._locks[n]&&this._locks[n].waiter?{then:function(){}}:this._locks[n]&&this._locks[n].wait?(this._locks[n].waiter=!0,new Promise(function(t,i){var o=function e(o){a._locks[n].wait?window.setTimeout(function(){e(o)},300):a._locks[n].url!==o?e(a._locks[n].url):(a._locks[n].waiter=!1,a.request("GET",a._locks[n].url).then(function(i){a._locks[n].url===o?t(i):(a._locks[n].waiter=!0,e(a._locks[n].url))},function(t){a._locks[n].url===o?i(t):(a._locks[n].waiter=!0,e(a._locks[n].url))}))};window.setTimeout(function(){o(e)},300)})):(this._locks[n]={url:e,wait:!0,waiter:!1},new Promise(function(t,i){a.request("GET",e).then(function(i){a._locks[n].wait=!1,a._locks[n].url===e&&t(i)},function(t){a._locks[n].wait=!1,a._locks[n].url===e&&i(t)})}))}return this.request("GET",e)}},{key:"post",value:function(e,t){return this.request("POST",e,t)}},{key:"patch",value:function(e,t){return this.request("PATCH",e,t)}},{key:"put",value:function(e,t){return this.request("PUT",e,t)}},{key:"delete",value:function(e,t){return this.request("DELETE",e,t)}},{key:"upload",value:function(e,t,n){var a=this;return new Promise(function(i,r){var s={url:e,method:"POST",headers:{"X-CSRFToken":a.getCsrfToken()},data:t,contentType:!1,processData:!1,xhr:function(){var e=new window.XMLHttpRequest;return e.upload.addEventListener("progress",function(e){e.lengthComputable&&n(Math.round(e.loaded/e.total*100))},!1),e},success:function(e){i(e)},error:function(e){var t=e.responseJSON||{};t.status=e.status,0===t.status&&(t.detail=pgettext("api error","Could not connect to the site.")),413!==t.status||t.detail||(t.detail=pgettext("api error","Upload was rejected by the site as too large.")),404===t.status&&(t.detail&&"NOT FOUND"!==t.detail||(t.detail=pgettext("api error","Action link is invalid."))),500!==t.status||t.detail||(t.detail=pgettext("api error","Unknown error has occurred.")),t.statusText=e.statusText,r(t)}};o.ajax(s)})}}]),e}())},92324:(e,t,n)=>{"use strict";n.d(t,{A:()=>c});var a=n(73620),i=n(23029),o=n(92901),r=n(15361),s=n(61801),u=n(53954),l=n(40927);var c=function(e){(0,r.A)(c,e);var t,n,l=(t=c,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}(),function(){var e,a=(0,u.A)(t);if(n){var i=(0,u.A)(this).constructor;e=Reflect.construct(a,arguments,i)}else e=a.apply(this,arguments);return(0,s.A)(this,e)});function c(){return(0,i.A)(this,c),l.apply(this,arguments)}return(0,o.A)(c,[{key:"isActive",value:function(){return this.props.isControlled?this.props.isActive:!!this.props.path&&0===document.location.pathname.indexOf(this.props.path)}},{key:"getClassName",value:function(){return this.isActive()?(this.props.className||"")+" "+(this.props.activeClassName||"active"):this.props.className||""}},{key:"render",value:function(){return(0,a.A)("li",{className:this.getClassName()},void 0,this.props.children)}}]),c}(n.n(l)().Component)},92979:(e,t,n)=>{"use strict";n.d(t,{A:()=>u});var a=n(73620),i=(n(40927),n(40961)),o=n.n(i),r=n(67467),s=n(52762);function u(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],i=document.getElementById(t),u=e.props?e:(0,a.A)(e,{});i&&(n?o().render((0,a.A)(r.Kq,{store:s.A.getStore()},void 0,u),i):o().render(u,i))}},93386:(e,t,n)=>{"use strict";n.d(t,{Ay:()=>c,F6:()=>l,QB:()=>r,Qv:()=>s});var a=n(95093),i=n.n(a),o=n(97414),r="PATCH_POST";function s(e){return Object.assign({},e,{posted_on:i()(e.posted_on),updated_on:i()(e.updated_on),hidden_on:i()(e.hidden_on),attachments:e.attachments?e.attachments.map(u):null,poster:e.poster?(0,o.d1)(e.poster):null,isSelected:!1,isBusy:!1,isDeleted:!1})}function u(e){return Object.assign({},e,{uploaded_on:i()(e.uploaded_on)})}function l(e,t){return{type:r,post:e,patch:t}}function c(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return t.type===r&&e.id==t.post.id?Object.assign({},e,t.patch):e}},93420:(e,t,n)=>{"use strict";n.d(t,{$y:()=>b,n8:()=>D,BG:()=>x});var a=n(73620),i=(n(40927),n(67369));function o(e){var t=e.filter;return(0,a.A)(i.FI,{icon:"unread"===t?"sentiment_very_satisfied":"notifications_none",message:r(t)})}function r(e){return"read"===e?pgettext("notifications list","You don't have any read notifications."):"unread"===e?pgettext("notifications list","You don't have any unread notifications."):pgettext("notifications list","You don't have any notifications.")}var s=n(32485),u=n.n(s);function l(e){var t=e.className,n=e.children;return(0,a.A)("div",{className:u()("notifications-list",t)},void 0,(0,a.A)(i.yq,{},void 0,n))}var c,d,p,h=n(30330);function m(e){var t=e.notification;return t.actor?(0,a.A)("a",{href:t.actor.url,className:"notifications-list-item-actor",title:t.actor.username},void 0,(0,a.A)(h.Ay,{size:30,user:t.actor})):(0,a.A)("span",{className:"threads-list-item-last-poster",title:t.actor_name||null},void 0,c||(c=(0,a.A)(h.Ay,{size:30})))}function f(e){var t=e.notification;return(0,a.A)("a",{href:t.url,className:u()("notification-message",{"notification-message-read":t.isRead,"notification-message-unread":!t.isRead}),dangerouslySetInnerHTML:{__html:t.message}})}function v(e){return e.notification.isRead?(0,a.A)("div",{className:"notifications-list-item-read-status",title:pgettext("notification status","Read notification")},void 0,d||(d=(0,a.A)("span",{className:"notification-read-icon"}))):(0,a.A)("div",{className:"notifications-list-item-read-status",title:pgettext("notification status","Unread notification")},void 0,p||(p=(0,a.A)("span",{className:"notification-unread-icon"})))}var A=n(7050);function g(e){var t=e.notification;return(0,a.A)("div",{className:"notifications-list-item-timestamp"},void 0,(0,a.A)(A.A,{datetime:t.createdAt}))}function y(e){var t=e.notification;return(0,a.A)(i.HU,{className:u()("notifications-list-item",{"notifications-list-item-read":t.isRead,"notifications-list-item-unread":!t.isRead})},t.id,(0,a.A)("div",{className:"notifications-list-item-left-col"},void 0,(0,a.A)("div",{className:"notifications-list-item-col-actor"},void 0,(0,a.A)(m,{notification:t})),(0,a.A)("div",{className:"notifications-list-item-col-read-icon"},void 0,(0,a.A)(v,{notification:t}))),(0,a.A)("div",{className:"notifications-list-item-right-col"},void 0,(0,a.A)("div",{className:"notifications-list-item-col-message"},void 0,(0,a.A)(f,{notification:t})),(0,a.A)("div",{className:"notifications-list-item-col-timestamp"},void 0,(0,a.A)(g,{notification:t}))))}function b(e){var t=e.filter,n=e.items;return(0,a.A)(l,{className:n.length>0?"notifications-list-ready":"notifications-list-pending"},void 0,0===n.length&&(0,a.A)(o,{filter:t}),n.map(function(e){return(0,a.A)(y,{notification:e},e.id)}))}function D(e){var t,n=0===(t=e.error).status?gettext("Check your internet connection and try refreshing the site."):t.data&&t.data.detail?t.data.detail:void 0;return(0,a.A)(l,{className:"notifications-list-pending"},void 0,(0,a.A)(i.OJ,{icon:"notifications_off",message:pgettext("notifications list","Notifications could not be loaded."),detail:n}))}function x(){return(0,a.A)(l,{className:"notifications-list-pending"},void 0,(0,a.A)(i.Uf,{message:pgettext("notifications list","Loading notifications...")}))}},95271:(e,t,n)=>{"use strict";n.d(t,{Ay:()=>c,F6:()=>l,Qv:()=>u});var a=n(95093),i=n.n(a),o=n(97414),r="HYDRATE_PROFILE",s="PATCH_PROFILE";function u(e){return{type:r,profile:e}}function l(e){return{type:s,patch:e}}function c(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;switch(t.type){case r:return Object.assign({},t.profile,{joined_on:i()(t.profile.joined_on),status:(0,o.W1)(t.profile.status)});case s:return Object.assign({},e,t.patch);case o.ot:return e.id===t.userId?Object.assign({},e,{avatars:t.avatars}):e;case o.xq:return e.id===t.userId?Object.assign({},e,{username:t.username,slug:t.slug}):e;default:return e}}},97414:(e,t,n)=>{"use strict";n.d(t,{Ay:()=>v,BC:()=>c,Qv:()=>d,W1:()=>p,d1:()=>h,kZ:()=>f,ot:()=>u,xG:()=>m,xq:()=>l});var a=n(95093),i=n.n(a),o=n(86552),r="APPEND_USERS",s="HYDRATE_USERS",u="UPDATE_AVATAR",l="UPDATE_USERNAME";function c(e){return{type:r,items:e}}function d(e){return{type:s,items:e}}function p(e){return e?Object.assign({},e,{last_click:e.last_click?i()(e.last_click):null,banned_until:e.banned_until?i()(e.banned_until):null}):null}function h(e){return Object.assign({},e,{joined_on:i()(e.joined_on),status:p(e.status)})}function m(e,t){return{type:u,userId:e.id,avatars:t}}function f(e,t,n){return{type:l,userId:e.id,username:t,slug:n}}function v(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;switch(t.type){case r:return(0,o.A)(e,t.items.map(h));case s:return t.items.map(h);case u:return e.map(function(e){return(e=Object.assign({},e)).id===t.userId&&(e.avatars=t.avatars),e});default:return e}}},98088:(e,t,n)=>{"use strict";n.d(t,{M7:()=>r,Tm:()=>s,rk:()=>u,my:()=>l});var a=n(73620),i=n(32485),o=n.n(i);n(40927);const r=function(e){var t=e.children,n=e.className;return(0,a.A)("nav",{className:o()("toolbar",n)},void 0,t)},s=function(e){var t=e.children,n=e.className,i=e.shrink;return(0,a.A)("div",{className:o()("toolbar-item",n,{"toolbar-item-shrink":i})},void 0,t)},u=function(e){var t=e.auto,n=e.children,i=e.className;return(0,a.A)("div",{className:o()("toolbar-section",{"toolbar-section-auto":t},i)},void 0,n)},l=function(e){var t=e.className;return(0,a.A)("div",{className:o()("toolbar-spacer",t)})}},98270:(e,t,n)=>{"use strict";var a=n(40927),i=n.n(a),o=n(73620),r=n(23029),s=n(92901),u=n(9417),l=n(15361),c=n(61801),d=n(53954),p=n(64467),h=n(73971),m=n(82853),f=n(39227),v=n(849),A=n(82743),g=n(92069),y=n(29904),b=n(89077),D=n(48995),x=n(8041);const k=function(e){var t=e.backendName,n=pgettext("social auth title","Sign in with %(backend)s"),a=interpolate(n,{backend:t},!0);return(0,o.A)(x.ud,{},void 0,(0,o.A)(x.zY,{styleName:"social-auth"},void 0,(0,o.A)(x.d4,{styleName:"social-auth"},void 0,(0,o.A)("h1",{},void 0,a))))};function _(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,a)}return n}function N(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?_(Object(n),!0).forEach(function(t){(0,p.A)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):_(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var C=function(e){(0,l.A)(i,e);var t,n,a=(t=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}(),function(){var e,a=(0,d.A)(t);if(n){var i=(0,d.A)(this).constructor;e=Reflect.construct(a,arguments,i)}else e=a.apply(this,arguments);return(0,c.A)(this,e)});function i(e){var t;(0,r.A)(this,i),t=a.call(this,e),(0,p.A)((0,u.A)(t),"handlePrivacyPolicyChange",function(e){var n=e.target.value;t.handleToggleAgreement("privacyPolicy",n)}),(0,p.A)((0,u.A)(t),"handleTermsOfServiceChange",function(e){var n=e.target.value;t.handleToggleAgreement("termsOfService",n)}),(0,p.A)((0,u.A)(t),"handleToggleAgreement",function(e,n){t.setState(function(a,i){if(null===a[e]){var o=N(N({},a.errors),{},(0,p.A)({},e,null));return(0,p.A)({errors:o},e,n)}var r=t.state.validators[e][0],s=N(N({},a.errors),{},(0,p.A)({},e,[r(null)]));return(0,p.A)({errors:s},e,null)})});var n={email:[b.Rp()],username:[b.KP()]};return h.A.get("TERMS_OF_SERVICE_ID")&&(n.termsOfService=[b.xi()]),h.A.get("PRIVACY_POLICY_ID")&&(n.privacyPolicy=[b.Yc()]),t.state={email:e.email||"",emailProtected:!!e.email,username:e.username||"",termsOfService:null,privacyPolicy:null,validators:n,errors:{},isLoading:!1},t}return(0,s.A)(i,[{key:"clean",value:function(){if(this.validate(),-1!==[this.state.email.trim().length,this.state.username.trim().length].indexOf(0))return y.A.error(pgettext("social auth form","Fill out all fields.")),!1;var e=this.state.validators;return h.A.get("TERMS_OF_SERVICE_ID")&&null===this.state.termsOfService?(y.A.error(e.termsOfService[0](null)),!1):!h.A.get("PRIVACY_POLICY_ID")||null!==this.state.privacyPolicy||(y.A.error(e.privacyPolicy[0](null)),!1)}},{key:"send",value:function(){return g.A.post(this.props.url,{email:this.state.email,username:this.state.username,terms_of_service:this.state.termsOfService,privacy_policy:this.state.privacyPolicy})}},{key:"handleSuccess",value:function(e){(0,this.props.onRegistrationComplete)(e)}},{key:"handleError",value:function(e){if(200===e.status)(0,this.props.onRegistrationComplete)({activation:"active",step:"done",username:this.state.username});else if(400===e.status){var t={errors:e};e.email&&(t.emailProtected=!1),this.setState(t)}else y.A.apiError(e)}},{key:"render",value:function(){var e=this.props.backend_name,t=this.state,n=t.email,a=t.emailProtected,i=t.username,r=t.isLoading,s=null;if(a){var u=pgettext("social auth form","Your e-mail address has been verified by %(backend)s.");s=interpolate(u,{backend:e},!0)}return(0,o.A)("div",{className:"page page-social-auth page-social-auth-register"},void 0,(0,o.A)(k,{backendName:e}),(0,o.A)(D.A,{},void 0,(0,o.A)("div",{className:"row"},void 0,(0,o.A)("div",{className:"col-md-6 col-md-offset-3"},void 0,(0,o.A)("form",{onSubmit:this.handleSubmit},void 0,(0,o.A)("div",{className:"panel panel-default panel-form"},void 0,(0,o.A)("div",{className:"panel-heading"},void 0,(0,o.A)("h3",{className:"panel-title"},void 0,pgettext("social auth form title","Complete your account"))),(0,o.A)("div",{className:"panel-body"},void 0,(0,o.A)(A.A,{for:"id_username",label:pgettext("social auth form field","Username"),validation:this.state.errors.username},void 0,(0,o.A)("input",{type:"text",id:"id_username",className:"form-control",disabled:r,onChange:this.bindInput("username"),value:i})),(0,o.A)(A.A,{for:"id_email",label:pgettext("social auth form field","E-mail address"),helpText:s,validation:a?null:this.state.errors.email},void 0,(0,o.A)("input",{type:"email",id:"id_email",className:"form-control",disabled:r||a,onChange:this.bindInput("email"),value:n})),(0,o.A)(m.A,{errors:this.state.errors,privacyPolicy:this.state.privacyPolicy,termsOfService:this.state.termsOfService,onPrivacyPolicyChange:this.handlePrivacyPolicyChange,onTermsOfServiceChange:this.handleTermsOfServiceChange})),(0,o.A)("div",{className:"panel-footer"},void 0,(0,o.A)(f.A,{className:"btn-primary",loading:this.state.isLoading},void 0,pgettext("social auth form btn","Sign in")))))))))}}]),i}(v.A);const E=function(e){var t,n,a=e.activation,i=e.backend_name,r=e.username;return n="user"===a?pgettext("account activation required","%(username)s, your account has been created but you need to activate it before you will be able to sign in."):"admin"===a?pgettext("account activation required","%(username)s, your account has been created but the site administrator will have to activate it before you will be able to sign in."):pgettext("social auth complete","%(username)s, your account has been created and you have been signed in to it."),t="active"===a?"check":"info_outline",(0,o.A)("div",{className:"page page-social-auth page-social-auth-register"},void 0,(0,o.A)(k,{backendName:i}),(0,o.A)(D.A,{},void 0,(0,o.A)("div",{className:"row"},void 0,(0,o.A)("div",{className:"col-md-6 col-md-offset-3"},void 0,(0,o.A)("div",{className:"panel panel-default panel-form"},void 0,(0,o.A)("div",{className:"panel-heading"},void 0,(0,o.A)("h3",{className:"panel-title"},void 0,pgettext("social auth complete title","Registration completed!"))),(0,o.A)("div",{className:"panel-body panel-message-body"},void 0,(0,o.A)("div",{className:"message-icon"},void 0,(0,o.A)("span",{className:"material-icon"},void 0,t)),(0,o.A)("div",{className:"message-body"},void 0,(0,o.A)("p",{className:"lead"},void 0,interpolate(n,{username:r},!0)),(0,o.A)("p",{className:"help-block"},void 0,(0,o.A)("a",{className:"btn btn-default",href:h.A.get("MISAGO_PATH")},void 0,pgettext("social auth complete link","Return to forum index"))))))))))};var w=function(e){(0,l.A)(i,e);var t,n,a=(t=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}(),function(){var e,a=(0,d.A)(t);if(n){var i=(0,d.A)(this).constructor;e=Reflect.construct(a,arguments,i)}else e=a.apply(this,arguments);return(0,c.A)(this,e)});function i(e){var t;return(0,r.A)(this,i),t=a.call(this,e),(0,p.A)((0,u.A)(t),"handleRegistrationComplete",function(e){var n=e.activation,a=e.email,i=e.step,o=e.username;t.setState({activation:n,email:a,step:i,username:o})}),t.state={step:e.step,activation:e.activation||"",email:e.email||"",username:e.username||""},t}return(0,s.A)(i,[{key:"render",value:function(){var e=this.props,t=e.backend_name,n=e.url,a=this.state,i=a.activation,r=a.email,s=a.step,u=a.username;return"register"===s?(0,o.A)(C,{backend_name:t,email:r,url:n,username:u,onRegistrationComplete:this.handleRegistrationComplete}):(0,o.A)(E,{activation:i,backend_name:t,email:r,url:n,username:u})}}]),i}(i().Component),F=n(92979);h.A.addInitializer({name:"component:social-auth",initializer:function(e){if("misago:social-complete"===e.get("CURRENT_LINK")){var t=e.get("SOCIAL_AUTH_FORM");(0,F.A)(i().createElement(w,t),"page-mount")}},after:"store"})}},i={};function o(e){var t=i[e];if(void 0!==t)return t.exports;var n=i[e]={id:e,loaded:!1,exports:{}};return a[e].call(n.exports,n,n.exports,o),n.loaded=!0,n.exports}o.m=a,e=[],o.O=(t,n,a,i)=>{if(!n){var r=1/0;for(c=0;c<e.length;c++){for(var[n,a,i]=e[c],s=!0,u=0;u<n.length;u++)(!1&i||r>=i)&&Object.keys(o.O).every(e=>o.O[e](n[u]))?n.splice(u--,1):(s=!1,i<r&&(r=i));if(s){e.splice(c--,1);var l=a();void 0!==l&&(t=l)}}return t}i=i||0;for(var c=e.length;c>0&&e[c-1][2]>i;c--)e[c]=e[c-1];e[c]=[n,a,i]},o.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return o.d(t,{a:t}),t},o.d=(e,t)=>{for(var n in t)o.o(t,n)&&!o.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},o.f={},o.e=e=>Promise.all(Object.keys(o.f).reduce((t,n)=>(o.f[n](e,t),t),[])),o.u=e=>"hljs.js",o.miniCssF=e=>{},o.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),o.hmd=e=>((e=Object.create(e)).children||(e.children=[]),Object.defineProperty(e,"exports",{enumerable:!0,set:()=>{throw new Error("ES Modules may not assign module.exports or exports.*, Use ESM export syntax, instead: "+e.id)}}),e),o.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),t={},n="misago:",o.l=(e,a,i,r)=>{if(t[e])t[e].push(a);else{var s,u;if(void 0!==i)for(var l=document.getElementsByTagName("script"),c=0;c<l.length;c++){var d=l[c];if(d.getAttribute("src")==e||d.getAttribute("data-webpack")==n+i){s=d;break}}s||(u=!0,(s=document.createElement("script")).charset="utf-8",s.timeout=120,o.nc&&s.setAttribute("nonce",o.nc),s.setAttribute("data-webpack",n+i),s.src=e),t[e]=[a];var p=(n,a)=>{s.onerror=s.onload=null,clearTimeout(h);var i=t[e];if(delete t[e],s.parentNode&&s.parentNode.removeChild(s),i&&i.forEach(e=>e(a)),n)return n(a)},h=setTimeout(p.bind(null,void 0,{type:"timeout",target:s}),12e4);s.onerror=p.bind(null,s.onerror),s.onload=p.bind(null,s.onload),u&&document.head.appendChild(s)}},o.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.nmd=e=>(e.paths=[],e.children||(e.children=[]),e),(()=>{var e;o.g.importScripts&&(e=o.g.location+"");var t=o.g.document;if(!e&&t&&(t.currentScript&&"SCRIPT"===t.currentScript.tagName.toUpperCase()&&(e=t.currentScript.src),!e)){var n=t.getElementsByTagName("script");if(n.length)for(var a=n.length-1;a>-1&&(!e||!/^http(s?):/.test(e));)e=n[a--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/^blob:/,"").replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),o.p=e})(),(()=>{var e={123:0};o.f.j=(t,n)=>{var a=o.o(e,t)?e[t]:void 0;if(0!==a)if(a)n.push(a[2]);else{var i=new Promise((n,i)=>a=e[t]=[n,i]);n.push(a[2]=i);var r=o.p+o.u(t),s=new Error;o.l(r,n=>{if(o.o(e,t)&&(0!==(a=e[t])&&(e[t]=void 0),a)){var i=n&&("load"===n.type?"missing":n.type),r=n&&n.target&&n.target.src;s.message="Loading chunk "+t+" failed.\n("+i+": "+r+")",s.name="ChunkLoadError",s.type=i,s.request=r,a[1](s)}},"chunk-"+t,t)}},o.O.j=t=>0===e[t];var t=(t,n)=>{var a,i,[r,s,u]=n,l=0;if(r.some(t=>0!==e[t])){for(a in s)o.o(s,a)&&(o.m[a]=s[a]);if(u)var c=u(o)}for(t&&t(n);l<r.length;l++)i=r[l],o.o(e,i)&&e[i]&&e[i][0](),e[i]=0;return o.O(c)},n=self.webpackChunkmisago=self.webpackChunkmisago||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})(),o.O(void 0,[121],()=>o(73971)),o.O(void 0,[121],()=>o(54422)),o.O(void 0,[121],()=>o(91864)),o.O(void 0,[121],()=>o(8142)),o.O(void 0,[121],()=>o(19876)),o.O(void 0,[121],()=>o(84979)),o.O(void 0,[121],()=>o(61516)),o.O(void 0,[121],()=>o(80879)),o.O(void 0,[121],()=>o(1697)),o.O(void 0,[121],()=>o(55972)),o.O(void 0,[121],()=>o(64508)),o.O(void 0,[121],()=>o(55667)),o.O(void 0,[121],()=>o(20475)),o.O(void 0,[121],()=>o(62077)),o.O(void 0,[121],()=>o(745)),o.O(void 0,[121],()=>o(35594)),o.O(void 0,[121],()=>o(10771)),o.O(void 0,[121],()=>o(44613)),o.O(void 0,[121],()=>o(17726)),o.O(void 0,[121],()=>o(98270)),o.O(void 0,[121],()=>o(68906)),o.O(void 0,[121],()=>o(63677)),o.O(void 0,[121],()=>o(26413)),o.O(void 0,[121],()=>o(65290)),o.O(void 0,[121],()=>o(52433)),o.O(void 0,[121],()=>o(8238)),o.O(void 0,[121],()=>o(88771)),o.O(void 0,[121],()=>o(51379)),o.O(void 0,[121],()=>o(83484)),o.O(void 0,[121],()=>o(6344)),o.O(void 0,[121],()=>o(56840)),o.O(void 0,[121],()=>o(19194)),o.O(void 0,[121],()=>o(26678)),o.O(void 0,[121],()=>o(30530)),o.O(void 0,[121],()=>o(75617)),o.O(void 0,[121],()=>o(50241)),o.O(void 0,[121],()=>o(74676)),o.O(void 0,[121],()=>o(40669)),o.O(void 0,[121],()=>o(68335)),o.O(void 0,[121],()=>o(72396)),o.O(void 0,[121],()=>o(39303)),o.O(void 0,[121],()=>o(10035)),o.O(void 0,[121],()=>o(79932)),o.O(void 0,[121],()=>o(10500)),o.O(void 0,[121],()=>o(13497)),o.O(void 0,[121],()=>o(55385)),o.O(void 0,[121],()=>o(67582)),o.O(void 0,[121],()=>o(60319)),o.O(void 0,[121],()=>o(25155)),o.O(void 0,[121],()=>o(51596));var r=o.O(void 0,[121],()=>o(25583));r=o.O(r)})();
//# sourceMappingURL=misago.js.map