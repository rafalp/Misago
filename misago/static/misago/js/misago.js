(()=>{var e,t,n,a={60642:(e,t,n)=>{"use strict";n.d(t,{b:()=>m,D:()=>f});var a=n(15861),i=n(15671),o=n(43144),s=n(97326),r=n(79340),l=n(6215),c=n(61120),u=n(4942),d=n(64687),p=n.n(d),h=n(57588),v=n.n(h);var m=function(e){(0,r.Z)(h,e);var t,n,d=(t=h,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,a=(0,c.Z)(t);if(n){var i=(0,c.Z)(this).constructor;e=Reflect.construct(a,arguments,i)}else e=a.apply(this,arguments);return(0,l.Z)(this,e)});function h(e){var t;return(0,i.Z)(this,h),t=d.call(this,e),(0,u.Z)((0,s.Z)(t),"hasCache",(function(e){return t.props.cache&&t.props.cache[e]})),(0,u.Z)((0,s.Z)(t),"getCache",function(){var e=(0,a.Z)(p().mark((function e(n){var a;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=t.props.cache[n],t.setState({loading:!1,error:null,data:a}),!t.props.onData){e.next=5;break}return e.next=5,t.props.onData(a);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),(0,u.Z)((0,s.Z)(t),"setCache",(function(e,n){t.props.cache&&(t.props.cache[e]=n)})),(0,u.Z)((0,s.Z)(t),"request",(function(e){t.setState({loading:!0}),fetch(e,{method:"GET",credentials:"include",signal:t.signal}).then(function(){var n=(0,a.Z)(p().mark((function n(a){var i,o;return p().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(e!==t.props.url){n.next=18;break}if(200!=a.status){n.next=12;break}return n.next=4,a.json();case 4:if(i=n.sent,t.setState({loading:!1,error:null,data:i}),t.setCache(e,i),!t.props.onData){n.next=10;break}return n.next=10,t.props.onData(i);case 10:n.next=18;break;case 12:if(o={status:a.status},"application/json"!==a.headers.get("Content-Type")){n.next=17;break}return n.next=16,a.json();case 16:o.data=n.sent;case 17:t.setState({loading:!1,error:o});case 18:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}(),(function(n){e===t.props.url&&t.setState({loading:!1,error:{status:0,rejection:n}})}))})),(0,u.Z)((0,s.Z)(t),"refetch",(function(){t.request(t.props.url)})),(0,u.Z)((0,s.Z)(t),"update",(function(e){t.setState((function(t){return{data:e(t.data)}}))})),t.state={data:null,loading:!1,error:null},t.controller=new AbortController,t.signal=t.controller.signal,t}return(0,o.Z)(h,[{key:"componentDidMount",value:function(){this.props.url&&!this.props.disabled&&this.request(this.props.url)}},{key:"componentDidUpdate",value:function(e){var t=this.props.url,n=t&&t!==e.url,a=this.props.disabled!=e.disabled;(n||a)&&(this.props.disabled?this.controller.abort():this.hasCache(t)?this.getCache(t):(this.controller.abort(),this.controller=new AbortController,this.signal=this.controller.signal,this.request(t)))}},{key:"componentWillUnmount",value:function(){this.controller.abort()}},{key:"render",value:function(){return this.props.children(Object.assign({refetch:this.refetch,update:this.update},this.state))}}]),h}(v().Component);var f=function(e){(0,r.Z)(h,e);var t,n,d=(t=h,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,a=(0,c.Z)(t);if(n){var i=(0,c.Z)(this).constructor;e=Reflect.construct(a,arguments,i)}else e=a.apply(this,arguments);return(0,l.Z)(this,e)});function h(e){var t;return(0,i.Z)(this,h),t=d.call(this,e),(0,u.Z)((0,s.Z)(t),"mutate",(function(e){t.setState({loading:!0}),fetch(t.props.url,{method:t.props.method||"POST",credentials:"include",headers:Z(e),body:g(e)}).then(function(){var n=(0,a.Z)(p().mark((function n(a){var i,o;return p().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(200!=a.status){n.next=10;break}return n.next=3,a.json();case 3:if(i=n.sent,t.setState({loading:!1,data:i}),!e.onSuccess){n.next=8;break}return n.next=8,e.onSuccess(i);case 8:n.next=26;break;case 10:if(204!=a.status){n.next=17;break}if(t.setState({loading:!1}),!e.onSuccess){n.next=15;break}return n.next=15,e.onSuccess();case 15:n.next=26;break;case 17:if(o={status:a.status},"application/json"!==a.headers.get("Content-Type")){n.next=22;break}return n.next=21,a.json();case 21:o.data=n.sent;case 22:if(t.setState({loading:!1,error:o}),!e.onError){n.next=26;break}return n.next=26,e.onError(o);case 26:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}(),function(){var n=(0,a.Z)(p().mark((function n(a){var i;return p().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(i={status:0,rejection:a},t.setState({loading:!1,error:i}),!e.onError){n.next=5;break}return n.next=5,e.onError(i);case 5:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}())})),t.state={data:null,loading:!1,error:null},t}return(0,o.Z)(h,[{key:"render",value:function(){return this.props.children(this.mutate,this.state)}}]),h}(v().Component);function Z(e){return e.json?{"Content-Type":"application/json; charset=utf-8","X-CSRFToken":b()}:{"X-CSRFToken":b()}}function g(e){if(e.json)return JSON.stringify(e.json)}function b(){var e=window.misago_csrf;if(-1!==document.cookie.indexOf(e)){var t=new RegExp(e+"=([^;]*)"),n=document.cookie.match(t)[0];return n?n.split("=")[1]:null}return null}},49021:(e,t,n)=>{"use strict";n.d(t,{Lt:()=>v,YV:()=>Z,kE:()=>g,Aw:()=>b,Xi:()=>y,KE:()=>_,iC:()=>k});var a=n(15671),i=n(43144),o=n(97326),s=n(79340),r=n(6215),l=n(61120),c=n(4942),u=n(94184),d=n.n(u),p=n(57588),h=n.n(p);var v=function(e){(0,s.Z)(p,e);var t,n,u=(t=p,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,a=(0,l.Z)(t);if(n){var i=(0,l.Z)(this).constructor;e=Reflect.construct(a,arguments,i)}else e=a.apply(this,arguments);return(0,r.Z)(this,e)});function p(e){var t;return(0,a.Z)(this,p),t=u.call(this,e),(0,c.Z)((0,o.Z)(t),"handleClick",(function(e){t.state.isOpen&&(!t.root.contains(e.target)||t.menu.contains(e.target)&&e.target.closest("a"))&&t.setState({isOpen:!1})})),(0,c.Z)((0,o.Z)(t),"toggle",(function(){t.setState((function(e){return{isOpen:!e.isOpen}}))})),(0,c.Z)((0,o.Z)(t),"close",(function(){t.setState({isOpen:!1})})),t.state={isOpen:!1},t.root=null,t.dropdown=null,t}return(0,i.Z)(p,[{key:"componentDidMount",value:function(){window.addEventListener("click",this.handleClick)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("click",this.handleClick)}},{key:"componentDidUpdate",value:function(e,t){t.isOpen!==this.state.isOpen&&(this.state.isOpen&&this.props.onOpen&&this.props.onOpen(this.root),!this.state.isOpen&&this.props.onClose&&this.props.onClose(this.root))}},{key:"render",value:function(){var e=this,t=this.state.isOpen;return h().createElement("div",{id:this.props.id,className:d()("dropdown",{open:t},this.props.className),ref:function(t){t&&!e.element&&(e.root=t)}},this.props.toggle({isOpen:t,toggle:this.toggle,aria:m(t)}),h().createElement("div",{className:d()("dropdown-menu",{"dropdown-menu-right":this.props.menuAlignRight},this.props.menuClassName),ref:function(t){t&&!e.menu&&(e.menu=t)},role:"menu"},this.props.children({isOpen:t,close:this.close})))}}]),p}(h().Component);function m(e){return{"aria-haspopup":"true","aria-expanded":e?"true":"false"}}var f=n(22928);function Z(e){var t=e.className;return(0,f.Z)("li",{className:d()("divider",t)})}function g(e){var t=e.children;return e.listItem?(0,f.Z)("li",{className:"dropdown-footer"},void 0,t):(0,f.Z)("div",{className:"dropdown-footer"},void 0,t)}function b(e){var t=e.className,n=e.children;return(0,f.Z)("div",{className:d()("dropdown-header",t)},void 0,n)}function y(e){var t=e.className,n=e.children;return(0,f.Z)("li",{className:d()("dropdown-menu-item",t)},void 0,n)}function _(e){var t=e.className,n=e.children;return(0,f.Z)("div",{className:d()("dropdown-pills",t)},void 0,n)}function k(e){var t=e.className,n=e.children;return(0,f.Z)("li",{className:d()("dropdown-subheader",t)},void 0,n)}},98936:(e,t,n)=>{"use strict";n.d(t,{gq:()=>s,Z6:()=>r,kw:()=>l});var a=n(22928),i=n(94184),o=n.n(i);n(57588);const s=function(e){var t=e.children,n=e.className;return(0,a.Z)("div",{className:o()("flex-row",n)},void 0,t)},r=function(e){var t=e.children,n=e.className,i=e.shrink;return(0,a.Z)("div",{className:o()("flex-row-col",n,{"flex-row-col-shrink":i})},void 0,t)},l=function(e){var t=e.auto,n=e.children,i=e.className;return(0,a.Z)("div",{className:o()("flex-row-section",{"flex-row-section-auto":t},i)},void 0,n)}},66398:(e,t,n)=>{"use strict";n.d(t,{NX:()=>r,PB:()=>c,Zn:()=>u,WI:()=>l,WE:()=>d,j0:()=>p});var a,i=n(22928),o=n(94184),s=n.n(o);function r(e){var t=e.className,n=e.children;return(0,i.Z)("ul",{className:s()("list-group",t)},void 0,n)}function l(e){var t=e.className,n=e.children;return(0,i.Z)("li",{className:s()("list-group-item",t)},void 0,n)}function c(e){var t=e.className,n=e.icon,a=e.message;return(0,i.Z)(l,{className:s()("list-group-empty",t)},void 0,!!n&&(0,i.Z)("div",{className:"list-group-empty-icon"},void 0,(0,i.Z)("span",{className:"material-icon"},void 0,n)),(0,i.Z)("p",{className:"list-group-empty-message"},void 0,a))}function u(e){var t=e.className,n=e.icon,a=e.message,o=e.detail;return(0,i.Z)(l,{className:s()("list-group-error",t)},void 0,!!n&&(0,i.Z)("div",{className:"list-group-error-icon"},void 0,(0,i.Z)("span",{className:"material-icon"},void 0,n)),(0,i.Z)("p",{className:"list-group-error-message"},void 0,a),!!o&&(0,i.Z)("p",{className:"list-group-error-detail"},void 0,o))}function d(e){var t=e.className,n=e.message;return(0,i.Z)(l,{className:s()("list-group-loading",t)},void 0,(0,i.Z)("p",{className:"list-group-loading-message"},void 0,n),a||(a=(0,i.Z)("div",{className:"list-group-loading-progress"},void 0,(0,i.Z)("div",{className:"list-group-loading-progress-bar"}))))}function p(e){var t=e.className,n=e.icon,a=e.message,o=e.detail;return(0,i.Z)(l,{className:s()("list-group-message",t)},void 0,!!n&&(0,i.Z)("div",{className:"list-group-message-icon"},void 0,(0,i.Z)("span",{className:"material-icon"},void 0,n)),(0,i.Z)("p",{className:"list-group-message-message"},void 0,a),!!o&&(0,i.Z)("p",{className:"list-group-message-detail"},void 0,o))}n(57588)},4517:(e,t,n)=>{"use strict";n.d(t,{Z:()=>l});var a=n(22928),i=(n(57588),n(37424)),o=n(35486),s=n(60642);function r(e,t){var n=misago.get("NOTIFICATIONS_API")+"?limit=30";return n+="&filter="+e,t&&(t.after&&(n+="&after="+t.after),t.before&&(n+="&before="+t.before)),n}const l=(0,i.$j)((function(e){var t=e.auth;return t.user?{unreadNotifications:t.user.unreadNotifications}:{unreadNotifications:null}}))((function(e){var t=e.children,n=e.filter,i=e.query,l=e.dispatch,c=e.unreadNotifications,u=e.disabled;return(0,a.Z)(s.b,{url:r(n,i),disabled:u,onData:function(e){e.unreadNotifications!=c&&l((0,o.yH)({unreadNotifications:e.unreadNotifications}))}},void 0,(function(e){var n=e.data,a=e.loading,i=e.error,o=e.refetch;return t({data:n,loading:a,error:i,refetch:o})}))}))},63026:(e,t,n)=>{"use strict";n.d(t,{Z:()=>a});const a=n(4517).Z},66462:(e,t,n)=>{"use strict";n.d(t,{uE:()=>y,lb:()=>_,Pu:()=>k});var a=n(22928),i=(n(57588),n(66398));function o(e){var t=e.filter;return(0,a.Z)(i.PB,{icon:"unread"===t?"sentiment_very_satisfied":"notifications_none",message:s(t)})}function s(e){return"read"===e?pgettext("notifications list","You don't have any read notifications."):"unread"===e?pgettext("notifications list","You don't have any unread notifications."):pgettext("notifications list","You don't have any notifications.")}var r=n(94184),l=n.n(r);function c(e){var t=e.className,n=e.children;return(0,a.Z)("div",{className:l()("notifications-list",t)},void 0,(0,a.Z)(i.NX,{},void 0,n))}var u,d,p,h=n(19605);function v(e){var t=e.notification;return t.actor?(0,a.Z)("a",{href:t.actor.url,className:"notifications-list-item-actor",title:t.actor.username},void 0,(0,a.Z)(h.ZP,{size:30,user:t.actor})):(0,a.Z)("span",{className:"threads-list-item-last-poster",title:t.actor_name||null},void 0,u||(u=(0,a.Z)(h.ZP,{size:30})))}function m(e){var t=e.notification;return(0,a.Z)("a",{href:t.url,className:l()("notification-message",{"notification-message-read":t.isRead,"notification-message-unread":!t.isRead}),dangerouslySetInnerHTML:{__html:t.message}})}function f(e){return e.notification.isRead?(0,a.Z)("div",{className:"notifications-list-item-read-status",title:pgettext("notification status","Read notification")},void 0,d||(d=(0,a.Z)("span",{className:"notification-read-icon"}))):(0,a.Z)("div",{className:"notifications-list-item-read-status",title:pgettext("notification status","Unread notification")},void 0,p||(p=(0,a.Z)("span",{className:"notification-unread-icon"})))}var Z=n(16069);function g(e){var t=e.notification;return(0,a.Z)("div",{className:"notifications-list-item-timestamp"},void 0,(0,a.Z)(Z.Z,{datetime:t.createdAt}))}function b(e){var t=e.notification;return(0,a.Z)(i.WI,{className:l()("notifications-list-item",{"notifications-list-item-read":t.isRead,"notifications-list-item-unread":!t.isRead})},t.id,(0,a.Z)("div",{className:"notifications-list-item-left-col"},void 0,(0,a.Z)("div",{className:"notifications-list-item-col-actor"},void 0,(0,a.Z)(v,{notification:t})),(0,a.Z)("div",{className:"notifications-list-item-col-read-icon"},void 0,(0,a.Z)(f,{notification:t}))),(0,a.Z)("div",{className:"notifications-list-item-right-col"},void 0,(0,a.Z)("div",{className:"notifications-list-item-col-message"},void 0,(0,a.Z)(m,{notification:t})),(0,a.Z)("div",{className:"notifications-list-item-col-timestamp"},void 0,(0,a.Z)(g,{notification:t}))))}function y(e){var t=e.filter,n=e.items;return(0,a.Z)(c,{className:n.length>0?"notifications-list-ready":"notifications-list-pending"},void 0,0===n.length&&(0,a.Z)(o,{filter:t}),n.map((function(e){return(0,a.Z)(b,{notification:e},e.id)})))}function _(e){var t,n=0===(t=e.error).status?gettext("Check your internet connection and try refreshing the site."):t.data&&t.data.detail?t.data.detail:void 0;return(0,a.Z)(c,{className:"notifications-list-pending"},void 0,(0,a.Z)(i.Zn,{icon:"notifications_off",message:pgettext("notifications list","Notifications could not be loaded."),detail:n}))}function k(){return(0,a.Z)(c,{className:"notifications-list-pending"},void 0,(0,a.Z)(i.WE,{message:pgettext("notifications list","Loading notifications...")}))}},64836:(e,t,n)=>{"use strict";n.d(t,{a:()=>b,i:()=>_});var a=n(22928),i=n(15671),o=n(43144),s=n(97326),r=n(79340),l=n(6215),c=n(61120),u=n(4942),d=n(94184),p=n.n(d),h=n(57588),v=n.n(h),m=n(37424),f=n(993);var Z="has-overlay",g=function(e){(0,r.Z)(h,e);var t,n,d=(t=h,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,a=(0,c.Z)(t);if(n){var i=(0,c.Z)(this).constructor;e=Reflect.construct(a,arguments,i)}else e=a.apply(this,arguments);return(0,l.Z)(this,e)});function h(e){var t;return(0,i.Z)(this,h),t=d.call(this,e),(0,u.Z)((0,s.Z)(t),"closeOnNavigation",(function(e){e.target.closest("a")&&t.props.dispatch((0,f.xv)())})),t.scrollOrigin=null,t}return(0,o.Z)(h,[{key:"componentDidUpdate",value:function(e){e.open!==this.props.open&&(this.props.open?(this.scrollOrigin=window.pageYOffset,document.body.classList.add(Z),this.props.onOpen&&this.props.onOpen()):(document.body.classList.remove(Z),window.scrollTo(0,this.scrollOrigin),this.scrollOrigin=null))}},{key:"render",value:function(){return(0,a.Z)("div",{className:p()("overlay",this.props.className,{"overlay-open":this.props.open}),onClick:this.closeOnNavigation},void 0,this.props.children)}}]),h}(v().Component);const b=(0,m.$j)()(g);var y;const _=(0,m.$j)()((function(e){var t=e.children,n=e.dispatch;return(0,a.Z)("div",{className:"overlay-header"},void 0,(0,a.Z)("div",{className:"overlay-header-caption"},void 0,t),(0,a.Z)("button",{className:"btn btn-overlay-close",title:pgettext("modal","Close"),type:"button",onClick:function(){return n((0,f.xv)())}},void 0,y||(y=(0,a.Z)("span",{className:"material-icon"},void 0,"close"))))}))},59131:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i});var a=n(22928);n(57588);const i=function(e){var t=e.children;return(0,a.Z)("div",{className:"container page-container"},void 0,t)}},99755:(e,t,n)=>{"use strict";n.d(t,{mr:()=>r,gC:()=>l,sP:()=>c,eA:()=>u,Iv:()=>d});var a,i=n(22928),o=n(94184),s=n.n(o);n(57588);const r=function(e){var t=e.children,n=e.className,o=e.styleName;return(0,i.Z)("div",{className:s()("page-header",n,o&&"page-header-"+o)},void 0,(0,i.Z)("div",{className:"page-header-bg-image"},void 0,(0,i.Z)("div",{className:"page-header-bg-overlay"},void 0,a||(a=(0,i.Z)("div",{className:"page-header-image"})),t)))},l=function(e){var t=e.children,n=e.className,a=e.styleName;return(0,i.Z)("div",{className:s()("page-header-banner",n,a&&"page-header-banner-"+a)},void 0,(0,i.Z)("div",{className:"page-header-banner-bg-image"},void 0,(0,i.Z)("div",{className:"page-header-banner-bg-overlay"},void 0,t)))},c=function(e){var t=e.children;return(0,i.Z)("div",{className:"container page-header-container"},void 0,t)},u=function(e){var t=e.children,n=e.className;return(0,i.Z)("div",{className:s()("page-header-details",n)},void 0,t)},d=function(e){var t=e.styleName,n=e.header,a=e.message;return(0,i.Z)(c,{},void 0,(0,i.Z)(r,{styleName:t},void 0,(0,i.Z)(l,{styleName:t},void 0,(0,i.Z)("h1",{},void 0,n)),a&&(0,i.Z)(u,{styleName:t},void 0,a)))}},40689:(e,t,n)=>{"use strict";n.d(t,{Z:()=>H});var a=n(22928),i=n(15671),o=n(43144),s=n(97326),r=n(79340),l=n(6215),c=n(61120),u=n(4942),d=n(94184),p=n.n(d),h=n(57588),v=n.n(h),m=n(78657),f=n(93825),Z=n(59801),g=n(53904),b=n(37848),y=n(87462),_=n(82211),k=n(43345),N=n(96359),x=n(59940);var w,C,R,E=["progress-bar-danger","progress-bar-warning","progress-bar-warning","progress-bar-primary","progress-bar-success"],S=[pgettext("password strength indicator","Entered password is very weak."),pgettext("password strength indicator","Entered password is weak."),pgettext("password strength indicator","Entered password is average."),pgettext("password strength indicator","Entered password is strong."),pgettext("password strength indicator","Entered password is very strong.")],O=function(e){(0,r.Z)(u,e);var t,n,s=(t=u,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,a=(0,c.Z)(t);if(n){var i=(0,c.Z)(this).constructor;e=Reflect.construct(a,arguments,i)}else e=a.apply(this,arguments);return(0,l.Z)(this,e)});function u(e){var t;return(0,i.Z)(this,u),(t=s.call(this,e))._score=0,t._password=null,t._inputs=[],t.state={loaded:!1},t}return(0,o.Z)(u,[{key:"componentDidMount",value:function(){var e=this;x.Z.load().then((function(){e.setState({loaded:!0})}))}},{key:"getScore",value:function(e,t){var n=this,a=!1;return e!==this._password&&(a=!0),t.length!==this._inputs.length?a=!0:t.map((function(e,t){e.trim()!==n._inputs[t]&&(a=!0)})),a&&(this._score=x.Z.scorePassword(e,t),this._password=e,this._inputs=t.map((function(e){return e.trim()}))),this._score}},{key:"render",value:function(){if(!this.state.loaded)return null;var e=this.getScore(this.props.password,this.props.inputs);return(0,a.Z)("div",{className:"help-block password-strength"},void 0,(0,a.Z)("div",{className:"progress"},void 0,(0,a.Z)("div",{className:"progress-bar "+E[e],style:{width:20+20*e+"%"},role:"progress-bar","aria-valuenow":e,"aria-valuemin":"0","aria-valuemax":"4"},void 0,(0,a.Z)("span",{className:"sr-only"},void 0,S[e]))),(0,a.Z)("p",{className:"text-small"},void 0,S[e]))}}]),u}(v().Component),L=n(26106),P=n(47235),T=n(15579),A=n(98274),I=n(93051),B=n(55210);function j(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function D(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?j(Object(n),!0).forEach((function(t){(0,u.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):j(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function z(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=(0,c.Z)(e);if(t){var i=(0,c.Z)(this).constructor;n=Reflect.construct(a,arguments,i)}else n=a.apply(this,arguments);return(0,l.Z)(this,n)}}var U,q=function(e){(0,r.Z)(n,e);var t=z(n);function n(e){var a;(0,i.Z)(this,n),a=t.call(this,e),(0,u.Z)((0,s.Z)(a),"handlePrivacyPolicyChange",(function(e){var t=e.target.value;a.handleToggleAgreement("privacyPolicy",t)})),(0,u.Z)((0,s.Z)(a),"handleTermsOfServiceChange",(function(e){var t=e.target.value;a.handleToggleAgreement("termsOfService",t)})),(0,u.Z)((0,s.Z)(a),"handleToggleAgreement",(function(e,t){a.setState((function(n,i){if(null===n[e]){var o=D(D({},n.errors),{},(0,u.Z)({},e,null));return(0,u.Z)({errors:o},e,t)}var s=a.state.validators[e][0],r=D(D({},n.errors),{},(0,u.Z)({},e,[s(null)]));return(0,u.Z)({errors:r},e,null)}))}));var o=a.props.criteria,r=o.username,l=o.password,c=0;l.forEach((function(e){"MinimumLengthValidator"===e.name&&(c=e.min_length)}));var d={username:[B.lG(),B.HR(r.min_length),B.gS(r.max_length)],email:[B.Do()],password:[B.Vb(c)],captcha:f.ZP.validator()};return T.Z.get("TERMS_OF_SERVICE_ID")&&(d.termsOfService=[B.fT()]),T.Z.get("PRIVACY_POLICY_ID")&&(d.privacyPolicy=[B.jA()]),a.state={isLoading:!1,username:"",email:"",password:"",captcha:"",termsOfService:null,privacyPolicy:null,validators:d,errors:{}},a}return(0,o.Z)(n,[{key:"clean",value:function(){return!!this.isValid()||(g.Z.error(gettext("Form contains errors.")),this.setState({errors:this.validate()}),!1)}},{key:"send",value:function(){return m.Z.post(T.Z.get("USERS_API"),{username:this.state.username,email:this.state.email,password:this.state.password,captcha:this.state.captcha,terms_of_service:this.state.termsOfService,privacy_policy:this.state.privacyPolicy})}},{key:"handleSuccess",value:function(e){this.props.callback(e)}},{key:"handleError",value:function(e){400===e.status?(this.setState({errors:Object.assign({},this.state.errors,e)}),e.__all__&&e.__all__.length>0?g.Z.error(e.__all__[0]):g.Z.error(gettext("Form contains errors."))):403===e.status&&e.ban?((0,I.Z)(e.ban),Z.Z.hide()):g.Z.apiError(e)}},{key:"render",value:function(){return(0,a.Z)("div",{className:"modal-dialog modal-register",role:"document"},void 0,(0,a.Z)("div",{className:"modal-content"},void 0,(0,a.Z)("div",{className:"modal-header"},void 0,(0,a.Z)("button",{type:"button",className:"close","data-dismiss":"modal","aria-label":pgettext("modal","Close")},void 0,w||(w=(0,a.Z)("span",{"aria-hidden":"true"},void 0,"×"))),(0,a.Z)("h4",{className:"modal-title"},void 0,pgettext("register modal title","Register"))),(0,a.Z)("form",{onSubmit:this.handleSubmit},void 0,(0,a.Z)("input",{type:"type",style:{display:"none"}}),(0,a.Z)("input",{type:"password",style:{display:"none"}}),(0,a.Z)("div",{className:"modal-body"},void 0,(0,a.Z)(P.Z,{buttonClassName:"col-xs-12 col-sm-6",buttonLabel:pgettext("register modal field","Join with %(site)s"),formLabel:pgettext("register modal field","Or create forum account:")}),(0,a.Z)(N.Z,{label:pgettext("register modal field","Username"),for:"id_username",validation:this.state.errors.username},void 0,(0,a.Z)("input",{type:"text",id:"id_username",className:"form-control","aria-describedby":"id_username_status",disabled:this.state.isLoading,onChange:this.bindInput("username"),value:this.state.username})),(0,a.Z)(N.Z,{label:pgettext("register modal field","E-mail"),for:"id_email",validation:this.state.errors.email},void 0,(0,a.Z)("input",{type:"text",id:"id_email",className:"form-control","aria-describedby":"id_email_status",disabled:this.state.isLoading,onChange:this.bindInput("email"),value:this.state.email})),(0,a.Z)(N.Z,{label:pgettext("register modal field","Password"),for:"id_password",validation:this.state.errors.password,extra:(0,a.Z)(O,{password:this.state.password,inputs:[this.state.username,this.state.email]})},void 0,(0,a.Z)("input",{type:"password",id:"id_password",className:"form-control","aria-describedby":"id_password_status",disabled:this.state.isLoading,onChange:this.bindInput("password"),value:this.state.password})),f.ZP.component({form:this}),(0,a.Z)(L.Z,{errors:this.state.errors,privacyPolicy:this.state.privacyPolicy,termsOfService:this.state.termsOfService,onPrivacyPolicyChange:this.handlePrivacyPolicyChange,onTermsOfServiceChange:this.handleTermsOfServiceChange})),(0,a.Z)("div",{className:"modal-footer"},void 0,(0,a.Z)("button",{className:"btn btn-default","data-dismiss":"modal",disabled:this.state.isLoading,type:"button"},void 0,pgettext("register modal btn","Cancel")),(0,a.Z)(_.Z,{className:"btn-primary",loading:this.state.isLoading},void 0,pgettext("register modal btn","Register account"))))))}}]),n}(k.Z),M=function(e){(0,r.Z)(n,e);var t=z(n);function n(){return(0,i.Z)(this,n),t.apply(this,arguments)}return(0,o.Z)(n,[{key:"getLead",value:function(){return"user"===this.props.activation?pgettext("account activation required","%(username)s, your account has been created but you need to activate it before you will be able to sign in."):"admin"===this.props.activation?pgettext("account activation required","%(username)s, your account has been created but the site administrator will have to activate it before you will be able to sign in."):void 0}},{key:"getSubscript",value:function(){return"user"===this.props.activation?pgettext("account activation required","We have sent an e-mail to %(email)s with link that you have to click to activate your account."):"admin"===this.props.activation?pgettext("account activation required","We will send an e-mail to %(email)s when this takes place."):void 0}},{key:"render",value:function(){return(0,a.Z)("div",{className:"modal-dialog modal-message modal-register",role:"document"},void 0,(0,a.Z)("div",{className:"modal-content"},void 0,(0,a.Z)("div",{className:"modal-header"},void 0,(0,a.Z)("button",{type:"button",className:"close","data-dismiss":"modal","aria-label":pgettext("modal","Close")},void 0,C||(C=(0,a.Z)("span",{"aria-hidden":"true"},void 0,"×"))),(0,a.Z)("h4",{className:"modal-title"},void 0,pgettext("register modal title","Registration complete"))),(0,a.Z)("div",{className:"modal-body"},void 0,R||(R=(0,a.Z)("div",{className:"message-icon"},void 0,(0,a.Z)("span",{className:"material-icon"},void 0,"info_outline"))),(0,a.Z)("div",{className:"message-body"},void 0,(0,a.Z)("p",{className:"lead"},void 0,interpolate(this.getLead(),{username:this.props.username},!0)),(0,a.Z)("p",{},void 0,interpolate(this.getSubscript(),{email:this.props.email},!0)),(0,a.Z)("button",{className:"btn btn-default","data-dismiss":"modal",type:"button"},void 0,pgettext("register modal dismiss","Ok"))))))}}]),n}(v().Component),F=function(e){(0,r.Z)(n,e);var t=z(n);function n(e){var a;return(0,i.Z)(this,n),a=t.call(this,e),(0,u.Z)((0,s.Z)(a),"completeRegistration",(function(e){"active"===e.activation?(Z.Z.hide(),A.Z.signIn(e)):a.setState({complete:e})})),a.state={complete:!1},a}return(0,o.Z)(n,[{key:"render",value:function(){return this.state.complete?(0,a.Z)(M,{activation:this.state.complete.activation,email:this.state.complete.email,username:this.state.complete.username}):v().createElement(q,(0,y.Z)({callback:this.completeRegistration},this.props))}}]),n}(v().Component);const H=function(e){(0,r.Z)(h,e);var t,n,d=(t=h,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,a=(0,c.Z)(t);if(n){var i=(0,c.Z)(this).constructor;e=Reflect.construct(a,arguments,i)}else e=a.apply(this,arguments);return(0,l.Z)(this,e)});function h(e){var t;return(0,i.Z)(this,h),t=d.call(this,e),(0,u.Z)((0,s.Z)(t),"showRegisterForm",(function(){t.props.onClick&&t.props.onClick(),"closed"===misago.get("SETTINGS").account_activation?g.Z.info(pgettext("register form","Registration form is currently disabled by the site administrator.")):t.state.isLoaded?Z.Z.show((0,a.Z)(F,{criteria:t.state.criteria})):(t.setState({isLoading:!0}),Promise.all([f.ZP.load(),m.Z.get(misago.get("AUTH_CRITERIA_API"))]).then((function(e){t.setState({isLoading:!1,isLoaded:!0,criteria:e[1]}),Z.Z.show((0,a.Z)(F,{criteria:e[1]}))}),(function(){t.setState({isLoading:!1}),g.Z.error(pgettext("register form","Registration form is currently unavailable due to an error."))})))})),t.state={isLoading:!1,isLoaded:!1,criteria:null},t}return(0,o.Z)(h,[{key:"render",value:function(){return(0,a.Z)("button",{className:p()("btn btn-register",this.props.className,{"btn-block":this.props.block,"btn-loading":this.state.isLoading}),disabled:this.state.isLoading,onClick:this.showRegisterForm,type:"button"},void 0,pgettext("cta","Register"),this.state.isLoading?U||(U=(0,a.Z)(b.Z,{})):null)}}]),h}(v().Component)},26106:(e,t,n)=>{"use strict";n.d(t,{Z:()=>r});var a=n(22928),i=(n(57588),n(15579)),o=n(89627),s=function(e){var t=e.agreement,n=e.checked,i=e.errors,s=e.url,r=e.value,l=e.onChange;if(!s)return null;var c=interpolate('<a href="%(url)s" target="_blank">%(agreement)s</a>',{agreement:(0,o.Z)(t),url:(0,o.Z)(s)},!0),u=interpolate(pgettext("register form agreement prompt","I have read and accept %(agreement)s."),{agreement:c},!0);return(0,a.Z)("div",{className:"checkbox legal-footnote"},void 0,(0,a.Z)("label",{},void 0,(0,a.Z)("input",{checked:n,type:"checkbox",value:r,onChange:l}),(0,a.Z)("span",{dangerouslySetInnerHTML:{__html:u}})),i&&i.map((function(e,t){return(0,a.Z)("div",{className:"help-block errors"},t,e)})))};const r=function(e){var t=e.errors,n=e.privacyPolicy,o=e.termsOfService,r=e.onPrivacyPolicyChange,l=e.onTermsOfServiceChange,c=i.Z.get("TERMS_OF_SERVICE_ID"),u=i.Z.get("TERMS_OF_SERVICE_URL"),d=i.Z.get("PRIVACY_POLICY_ID"),p=i.Z.get("PRIVACY_POLICY_URL");return c||d?(0,a.Z)("div",{},void 0,(0,a.Z)(s,{agreement:pgettext("register form agreement prompt","the terms of service"),checked:null!==o,errors:t.termsOfService,url:u,value:c,onChange:l}),(0,a.Z)(s,{agreement:pgettext("register form agreement prompt","the privacy policy"),checked:null!==n,errors:t.privacyPolicy,url:p,value:d,onChange:r})):null}},62989:(e,t,n)=>{"use strict";n.d(t,{E:()=>T,F:()=>B});var a=n(22928),i=n(57588),o=n.n(i),s=n(15671),r=n(43144),l=n(79340),c=n(6215),u=n(61120),d=n(60642),p=n(66398);function h(e){var t=e.children;return(0,a.Z)(p.NX,{className:"search-results-list"},void 0,t)}function v(){return(0,a.Z)(h,{},void 0,(0,a.Z)(p.j0,{message:pgettext("search cta","Enter search query (at least 3 characters).")}))}var m=n(16069);function f(e){var t=e.post;return(0,a.Z)(p.WI,{className:"search-result"},void 0,(0,a.Z)("a",{href:t.url.index},void 0,(0,a.Z)("div",{className:"search-result-card"},void 0,(0,a.Z)("div",{className:"search-result-name"},void 0,t.thread.title),(0,a.Z)("div",{className:"search-result-summary",dangerouslySetInnerHTML:{__html:t.headline||t.content}}),(0,a.Z)("ul",{className:"search-result-details"},void 0,(0,a.Z)("li",{},void 0,(0,a.Z)("b",{},void 0,t.category.name)),(0,a.Z)("li",{},void 0,t.poster?t.poster.username:t.poster_name),(0,a.Z)("li",{},void 0,(0,a.Z)(m.Z,{datetime:t.posted_on}))))))}var Z,g,b,y=n(19605);function _(e){var t=e.user,n=t.title||t.rank.title;return(0,a.Z)(p.WI,{className:"search-result"},void 0,(0,a.Z)("a",{href:t.url},void 0,(0,a.Z)(y.ZP,{user:t,size:32}),(0,a.Z)("div",{className:"search-result-card"},void 0,(0,a.Z)("div",{className:"search-result-name"},void 0,t.username),(0,a.Z)("ul",{className:"search-result-details"},void 0,!!n&&(0,a.Z)("li",{},void 0,(0,a.Z)("b",{},void 0,n)),(0,a.Z)("li",{},void 0,t.rank.name),(0,a.Z)("li",{},void 0,(0,a.Z)(m.Z,{datetime:t.joined_on}))))))}function k(e){var t=e.query,n=e.results,i=n[0],o=n[1],s=i.results.count;return(0,a.Z)(h,{},void 0,o.results.results.map((function(e){return(0,a.Z)(_,{user:e},e.id)})),i.results.results.map((function(e){return(0,a.Z)(f,{post:e},e.id)})),s>0&&(0,a.Z)(p.WI,{},void 0,(0,a.Z)("a",{href:i.url+"?q="+encodeURIComponent(t),className:"btn btn-default btn-block"},void 0,npgettext("search results list","See all %(count)s result.","See all %(count)s results.",i.results.count).replace("%(count)s",i.results.count))))}function N(){return(0,a.Z)(h,{},void 0,(0,a.Z)(p.PB,{message:pgettext("search results","The search returned no results.")}))}function x(e){var t=e.error;return(0,a.Z)(h,{},void 0,(0,a.Z)(p.Zn,{message:pgettext("search results","The search could not be completed."),detail:w(t)}))}function w(e){return 0===e.status?gettext("Check your internet connection and try refreshing the site."):e.data&&e.data.detail?e.data.detail:void 0}function C(){return(0,a.Z)(h,{},void 0,(0,a.Z)(p.WE,{message:pgettext("search results","Searching...")}))}var R={},E=function(e){(0,l.Z)(o,e);var t,n,i=(t=o,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,a=(0,u.Z)(t);if(n){var i=(0,u.Z)(this).constructor;e=Reflect.construct(a,arguments,i)}else e=a.apply(this,arguments);return(0,c.Z)(this,e)});function o(e){var t;return(0,s.Z)(this,o),(t=i.call(this,e)).state={query:t.props.query.trim()},t.debounce=null,t}return(0,r.Z)(o,[{key:"componentDidUpdate",value:function(){var e=this,t=this.props.query.trim();this.state.query!=t&&(this.debounce&&window.clearTimeout(this.debounce),this.debounce=window.setTimeout((function(){e.setState({query:t})}),750))}},{key:"componentWillUnmount",value:function(){this.debounce&&window.clearTimeout(this.debounce)}},{key:"render",value:function(){var e,t=this;return(0,a.Z)(d.b,{url:(e=this.state.query,misago.get("SEARCH_API")+"?q="+encodeURIComponent(e)),cache:R,disabled:this.state.query.length<3},void 0,(function(e){var n=e.data,i=e.loading,o=e.error;return t.state.query.length<3?Z||(Z=(0,a.Z)(v,{})):i?g||(g=(0,a.Z)(C,{})):o?(0,a.Z)(x,{error:o}):function(e){if(null===e)return!0;var t=0;return e.forEach((function(e){t+=e.results.count})),0===t}(n)?b||(b=(0,a.Z)(N,{})):null!==n?(0,a.Z)(k,{query:t.state.query,results:n}):null}))}}]),o}(o().Component);function S(e){var t=e.query,n=e.setQuery;return(0,a.Z)("div",{className:"search-input"},void 0,(0,a.Z)("input",{className:"form-control form-control-search",type:"text",placeholder:pgettext("cta","Search"),value:t,onChange:function(e){return n(e.target.value)}}))}var O=n(97326),L=n(4942);var P=function(e){(0,l.Z)(i,e);var t,n,a=(t=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,a=(0,u.Z)(t);if(n){var i=(0,u.Z)(this).constructor;e=Reflect.construct(a,arguments,i)}else e=a.apply(this,arguments);return(0,c.Z)(this,e)});function i(e){var t;return(0,s.Z)(this,i),t=a.call(this,e),(0,L.Z)((0,O.Z)(t),"setQuery",(function(e){t.setState({query:e})})),t.state={query:""},t}return(0,r.Z)(i,[{key:"render",value:function(){return this.props.children({query:this.state.query,setQuery:this.setQuery})}}]),i}(o().Component);function T(){return(0,a.Z)(P,{},void 0,(function(e){var t=e.query,n=e.setQuery;return(0,a.Z)("div",{className:"search-dropdown-body"},void 0,(0,a.Z)(S,{query:t,setQuery:n}),(0,a.Z)(E,{query:t}))}))}var A=n(37424),I=n(64836);const B=(0,A.$j)((function(e){return{open:e.overlay.search}}))((function(e){var t=e.open;return(0,a.Z)(I.a,{open:t,onOpen:function(){window.setTimeout((function(){document.querySelector("#search-mount .form-control-search").focus()}),0)}},void 0,(0,a.Z)(I.i,{},void 0,pgettext("cta","Search")),(0,a.Z)(P,{},void 0,(function(e){var t=e.query,n=e.setQuery;return(0,a.Z)("div",{className:"search-overlay-body"},void 0,(0,a.Z)(S,{query:t,setQuery:n}),(0,a.Z)("div",{className:"search-results-container"},void 0,(0,a.Z)(E,{query:t})))})))}))},80261:(e,t,n)=>{"use strict";n.d(t,{Z:()=>c});var a,i=n(22928),o=n(94184),s=n.n(o),r=(n(57588),n(59801)),l=n(14467);const c=function(e){var t=e.block,n=e.className,o=e.onClick,c=misago.get("SETTINGS");return c.DELEGATE_AUTH?(0,i.Z)("a",{className:s()("btn btn-sign-in",n,{"btn-block":t}),href:c.LOGIN_URL,onClick:function(){o&&o()}},void 0,pgettext("cta","Sign in")):(0,i.Z)("a",{className:s()("btn btn-sign-in",n,{"btn-block":t}),href:c.LOGIN_URL,onClick:function(e){e.preventDefault(),o&&o(),r.Z.show(a||(a=(0,i.Z)(l.Z,{})))}},void 0,pgettext("cta","Sign in"))}},6333:(e,t,n)=>{"use strict";n.d(t,{bS:()=>m,Or:()=>g});var a,i,o,s=n(22928),r=n(94184),l=n.n(r),c=(n(57588),n(37424)),u=n(49021),d=n(40689),p=n(80261),h=(0,c.$j)((function(e){return{isAnonymous:!e.auth.user.id}}))((function(e){var t=e.isAnonymous,n=e.close,r=e.dropdown,c=e.overlay,h=misago.get("MISAGO_PATH"),v=misago.get("SETTINGS"),m=misago.get("main_menu"),f=misago.get("extraMenuItems"),Z=misago.get("extraFooterItems"),g=misago.get("categories_menu"),b=misago.get("usersLists"),y=v.enable_oauth2_client,_=[];m.forEach((function(e){_.push({title:e.label,url:e.url})})),_.push({title:pgettext("site nav","Search"),url:h+"search/"});var k=[],N=misago.get("TERMS_OF_SERVICE_TITLE"),x=misago.get("TERMS_OF_SERVICE_URL");N&&x&&k.push({title:N,url:x});var w=misago.get("PRIVACY_POLICY_TITLE"),C=misago.get("PRIVACY_POLICY_URL");return w&&C&&k.push({title:w,url:C}),(0,s.Z)("ul",{className:l()("site-nav-menu",{"dropdown-menu-list":r,"overlay-menu-list":c})},void 0,t&&(0,s.Z)(u.Aw,{className:"site-nav-sign-in-message"},void 0,pgettext("cta","You are not signed in")),t&&(0,s.Z)(u.KE,{className:"site-nav-sign-in-options"},void 0,(0,s.Z)(p.Z,{onClick:n}),!y&&(0,s.Z)(d.Z,{onClick:n})),(0,s.Z)(u.iC,{},void 0,v.forum_name),_.map((function(e){return(0,s.Z)(u.Xi,{},e.url,(0,s.Z)("a",{href:e.url},void 0,e.title))})),f.map((function(e,t){return(0,s.Z)(u.Xi,{className:e.className},t,(0,s.Z)("a",{href:e.url,target:e.targetBlank?"_blank":null,rel:e.rel},void 0,e.title))})),!!b.length&&(a||(a=(0,s.Z)(u.YV,{className:"site-nav-users-divider"}))),!!b.length&&(0,s.Z)(u.iC,{className:"site-nav-users"},void 0,pgettext("site nav section","Users")),b.map((function(e){return(0,s.Z)(u.Xi,{},e.url,(0,s.Z)("a",{href:e.url},void 0,e.name))})),i||(i=(0,s.Z)(u.YV,{className:"site-nav-categories-divider"})),(0,s.Z)(u.iC,{className:"site-nav-categories"},void 0,pgettext("site nav section","Categories")),g.map((function(e){return e.is_vanilla?(0,s.Z)(u.Xi,{className:"site-nav-category-header"},e.id,(0,s.Z)("a",{href:e.url},void 0,e.name)):(0,s.Z)(u.Xi,{className:l()("site-nav-category",{"site-nav-category-last":e.last})},e.id,(0,s.Z)("a",{href:e.url},void 0,(0,s.Z)("span",{},void 0,e.name),(0,s.Z)("span",{className:l()("threads-list-item-category threads-list-category-label",{"threads-list-category-label-color":!!e.color}),style:{"--label-color":e.color}},void 0,e.short_name||e.name)))})),(!!k.length||!!Z.length)&&(o||(o=(0,s.Z)(u.YV,{className:"site-nav-footer-divider"}))),(!!k.length||!!Z.length)&&(0,s.Z)(u.iC,{className:"site-nav-footer"},void 0,pgettext("site nav section","Footer")),Z.map((function(e,t){return(0,s.Z)(u.Xi,{className:e.className},t,(0,s.Z)("a",{href:e.url,target:e.targetBlank?"_blank":null,rel:e.rel},void 0,e.title))})),k.map((function(e){return(0,s.Z)(u.Xi,{},e.url,(0,s.Z)("a",{href:e.url},void 0,e.title))})))}));const v=h;function m(e){var t=e.close;return(0,s.Z)(v,{close:t,dropdown:!0})}var f=n(993),Z=n(64836);const g=(0,c.$j)((function(e){return{isOpen:e.overlay.siteNav}}))((function(e){var t=e.dispatch,n=e.isOpen;return(0,s.Z)(Z.a,{open:n},void 0,(0,s.Z)(Z.i,{},void 0,pgettext("site nav title","Menu")),(0,s.Z)(v,{close:function(){return t((0,f.xv)())},overlay:!0}))}))},47235:(e,t,n)=>{"use strict";n.d(t,{Z:()=>r});var a,i=n(22928),o=(n(57588),n(15579)),s=function(e){var t=e.className,n=e.text;return n?(0,i.Z)("h5",{className:t||""},void 0,n):null};const r=function(e){var t=e.buttonClassName,n=e.buttonLabel,r=e.formLabel,l=e.header,c=e.labelClassName,u=o.Z.get("SOCIAL_AUTH");return 0===u.length?null:(0,i.Z)("div",{className:"form-group form-social-auth"},void 0,(0,i.Z)(s,{className:c,text:l}),(0,i.Z)("div",{className:"row"},void 0,u.map((function(e){var a=e.pk,o=e.name,s=e.button_text,r=e.button_color,l=e.url,c="btn btn-block btn-default btn-social-"+a,u=r?{color:r}:null,d=s||interpolate(n,{site:o},!0);return(0,i.Z)("div",{className:t||"col-xs-12"},a,(0,i.Z)("a",{className:c,style:u,href:l},void 0,d))}))),a||(a=(0,i.Z)("hr",{})),(0,i.Z)(s,{className:c,text:r}))}},16069:(e,t,n)=>{"use strict";n.d(t,{Z:()=>m});var a=n(22928),i=n(15671),o=n(43144),s=n(97326),r=n(79340),l=n(6215),c=n(61120),u=n(4942),d=n(57588),p=n.n(d),h=n(75557);function v(e){return{tick:e.tick+1}}const m=function(e){(0,r.Z)(p,e);var t,n,d=(t=p,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,a=(0,c.Z)(t);if(n){var i=(0,c.Z)(this).constructor;e=Reflect.construct(a,arguments,i)}else e=a.apply(this,arguments);return(0,l.Z)(this,e)});function p(e){var t;return(0,i.Z)(this,p),t=d.call(this,e),(0,u.Z)((0,s.Z)(t),"scheduleNextUpdate",(function(){var e=new Date,n=Math.ceil(Math.abs(Math.round((t.date-e)/1e3)));n<3600?t.timeout=window.setTimeout((function(){t.setState(v),t.scheduleNextUpdate()}),5e4):n<86400&&(t.timeout=window.setTimeout((function(){t.setState(v)}),24e5))})),t.state={tick:0},t.date=new Date(e.datetime),t.timeout=null,t}return(0,o.Z)(p,[{key:"componentDidMount",value:function(){this.scheduleNextUpdate()}},{key:"componentWillUnmount",value:function(){this.timeout&&window.clearTimeout(this.timeout)}},{key:"render",value:function(){var e=this.props.narrow?(0,h.xn)(this.date):(0,h.SW)(this.date);return(0,a.Z)("attr",{title:this.props.title?this.props.title.replace("%(timestamp)s",h.ry.format(this.date)):h.ry.format(this.date)},void 0,e)}}]),p}(p().Component)},92490:(e,t,n)=>{"use strict";n.d(t,{o8:()=>s,Eg:()=>r,Z2:()=>l,tw:()=>c});var a=n(22928),i=n(94184),o=n.n(i);n(57588);const s=function(e){var t=e.children,n=e.className;return(0,a.Z)("nav",{className:o()("toolbar",n)},void 0,t)},r=function(e){var t=e.children,n=e.className,i=e.shrink;return(0,a.Z)("div",{className:o()("toolbar-item",n,{"toolbar-item-shrink":i})},void 0,t)},l=function(e){var t=e.auto,n=e.children,i=e.className;return(0,a.Z)("div",{className:o()("toolbar-section",{"toolbar-section-auto":t},i)},void 0,n)},c=function(e){var t=e.className;return(0,a.Z)("div",{className:o()("toolbar-spacer",t)})}},28166:(e,t,n)=>{"use strict";n.d(t,{o4:()=>ie,Qm:()=>re});var a,i=n(42982),o=n(22928),s=n(15671),r=n(43144),l=n(97326),c=n(79340),u=n(6215),d=n(61120),p=n(4942),h=n(94184),v=n.n(h),m=n(57588),f=n.n(m),Z=n(37424),g=n(59801),b=n(19605),y=n(82211),_=n(37848),k=n(78657),N=n(53904);var x,w=function(e){(0,c.Z)(h,e);var t,n,i=(t=h,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,a=(0,d.Z)(t);if(n){var i=(0,d.Z)(this).constructor;e=Reflect.construct(a,arguments,i)}else e=a.apply(this,arguments);return(0,u.Z)(this,e)});function h(e){var t;return(0,s.Z)(this,h),t=i.call(this,e),(0,p.Z)((0,l.Z)(t),"setGravatar",(function(){t.callApi("gravatar")})),(0,p.Z)((0,l.Z)(t),"setGenerated",(function(){t.callApi("generated")})),t.state={isLoading:!1},t}return(0,r.Z)(h,[{key:"callApi",value:function(e){var t=this;if(this.state.isLoading)return!1;this.setState({isLoading:!0}),k.Z.post(this.props.user.api.avatar,{avatar:e}).then((function(e){t.setState({isLoading:!1}),N.Z.success(e.detail),t.props.onComplete(e)}),(function(e){400===e.status?(N.Z.error(e.detail),t.setState({isLoading:!1})):t.props.showError(e)}))}},{key:"getGravatarButton",value:function(){return this.props.options.gravatar?(0,o.Z)(y.Z,{onClick:this.setGravatar,disabled:this.state.isLoading,className:"btn-default btn-block btn-avatar-gravatar"},void 0,pgettext("avatar modal btn","Download my Gravatar")):null}},{key:"getCropButton",value:function(){return this.props.options.crop_src?(0,o.Z)(y.Z,{className:"btn-default btn-block btn-avatar-crop",disabled:this.state.isLoading,onClick:this.props.showCrop},void 0,pgettext("avatar modal btn","Re-crop uploaded image")):null}},{key:"getUploadButton",value:function(){return this.props.options.upload?(0,o.Z)(y.Z,{className:"btn-default btn-block btn-avatar-upload",disabled:this.state.isLoading,onClick:this.props.showUpload},void 0,pgettext("avatar modal btn","Upload new image")):null}},{key:"getGalleryButton",value:function(){return this.props.options.galleries?(0,o.Z)(y.Z,{className:"btn-default btn-block btn-avatar-gallery",disabled:this.state.isLoading,onClick:this.props.showGallery},void 0,pgettext("avatar modal btn","Pick avatar from gallery")):null}},{key:"getAvatarPreview",value:function(){var e={id:this.props.user.id,avatars:this.props.options.avatars};return this.state.isLoading?(0,o.Z)("div",{className:"avatar-preview preview-loading"},void 0,(0,o.Z)(b.ZP,{size:"200",user:e}),a||(a=(0,o.Z)(_.Z,{}))):(0,o.Z)("div",{className:"avatar-preview"},void 0,(0,o.Z)(b.ZP,{size:"200",user:e}))}},{key:"render",value:function(){return(0,o.Z)("div",{className:"modal-body modal-avatar-index"},void 0,(0,o.Z)("div",{className:"row"},void 0,(0,o.Z)("div",{className:"col-md-5"},void 0,this.getAvatarPreview()),(0,o.Z)("div",{className:"col-md-7"},void 0,this.getGravatarButton(),(0,o.Z)(y.Z,{onClick:this.setGenerated,disabled:this.state.isLoading,className:"btn-default btn-block btn-avatar-generate"},void 0,pgettext("avatar modal btn","Generate my individual avatar")),this.getCropButton(),this.getUploadButton(),this.getGalleryButton())))}}]),h}(f().Component),C=n(19755);var R,E=function(e){(0,c.Z)(i,e);var t,n,a=(t=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,a=(0,d.Z)(t);if(n){var i=(0,d.Z)(this).constructor;e=Reflect.construct(a,arguments,i)}else e=a.apply(this,arguments);return(0,u.Z)(this,e)});function i(e){var t;return(0,s.Z)(this,i),t=a.call(this,e),(0,p.Z)((0,l.Z)(t),"cropAvatar",(function(){if(t.state.isLoading)return!1;t.setState({isLoading:!0});var e=t.props.upload?"crop_tmp":"crop_src",n=C(".crop-form"),a=n.cropit("exportZoom"),i=n.cropit("offset");k.Z.post(t.props.user.api.avatar,{avatar:e,crop:{offset:{x:i.x*a,y:i.y*a},zoom:n.cropit("zoom")*a}}).then((function(e){t.props.onComplete(e),N.Z.success(e.detail)}),(function(e){400===e.status?(N.Z.error(e.detail),t.setState({isLoading:!1})):t.props.showError(e)}))})),t.state={isLoading:!1,deviceRatio:1},t}return(0,r.Z)(i,[{key:"getAvatarSize",value:function(){return this.props.upload?this.props.options.crop_tmp.size:this.props.options.crop_src.size}},{key:"getImagePath",value:function(){return this.props.upload?this.props.dataUrl:this.props.options.crop_src.url}},{key:"componentDidMount",value:function(){for(var e=this,t=C(".crop-form"),n=this.getAvatarSize(),a=t.width();a<n;)n/=2;var i=this.getAvatarSize()/n;t.width(n),t.cropit({width:n,height:n,exportZoom:i,imageState:{src:this.getImagePath()},onImageLoaded:function(){if(e.props.upload){var n=t.cropit("zoom"),a=t.cropit("imageSize");if(a.width>a.height){var i=(a.width*n-e.getAvatarSize())/-2;t.cropit("offset",{x:i,y:0})}else if(a.width<a.height){var o=(a.height*n-e.getAvatarSize())/-2;t.cropit("offset",{x:0,y:o})}else t.cropit("offset",{x:0,y:0})}else{var s=e.props.options.crop_src.crop;s&&(t.cropit("zoom",s.zoom),t.cropit("offset",{x:s.x,y:s.y}))}}})}},{key:"componentWillUnmount",value:function(){C(".crop-form").cropit("disable")}},{key:"render",value:function(){return(0,o.Z)("div",{},void 0,x||(x=(0,o.Z)("div",{className:"modal-body modal-avatar-crop"},void 0,(0,o.Z)("div",{className:"crop-form"},void 0,(0,o.Z)("div",{className:"cropit-preview"}),(0,o.Z)("input",{type:"range",className:"cropit-image-zoom-input"})))),(0,o.Z)("div",{className:"modal-footer"},void 0,(0,o.Z)("div",{className:"col-md-6 col-md-offset-3"},void 0,(0,o.Z)(y.Z,{onClick:this.cropAvatar,loading:this.state.isLoading,className:"btn-primary btn-block"},void 0,this.props.upload?pgettext("avatar crop modal btn","Set avatar"):pgettext("avatar crop modal btn","Crop image")),(0,o.Z)(y.Z,{onClick:this.props.showIndex,disabled:this.state.isLoading,className:"btn-default btn-block"},void 0,pgettext("avatar crop modal btn","Cancel")))))}}]),i}(f().Component),S=n(48772);var O,L=function(e){(0,c.Z)(i,e);var t,n,a=(t=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,a=(0,d.Z)(t);if(n){var i=(0,d.Z)(this).constructor;e=Reflect.construct(a,arguments,i)}else e=a.apply(this,arguments);return(0,u.Z)(this,e)});function i(e){var t;return(0,s.Z)(this,i),t=a.call(this,e),(0,p.Z)((0,l.Z)(t),"pickFile",(function(){document.getElementById("avatar-hidden-upload").click()})),(0,p.Z)((0,l.Z)(t),"uploadFile",(function(){var e=document.getElementById("avatar-hidden-upload").files[0];if(e){var n=t.validateFile(e);if(n)N.Z.error(n);else{t.setState({image:e,preview:URL.createObjectURL(e),progress:0});var a=new FormData;a.append("avatar","upload"),a.append("image",e),k.Z.upload(t.props.user.api.avatar,a,(function(e){t.setState({progress:e})})).then((function(e){t.setState({options:e,uploaded:e.detail}),N.Z.info(pgettext("avatar upload modal","Your image has been uploaded and you may now crop it."))}),(function(e){400===e.status||413===e.status?(N.Z.error(e.detail),t.setState({isLoading:!1,image:null,progress:0})):t.props.showError(e)}))}}})),t.state={image:null,preview:null,progress:0,uploaded:null,dataUrl:null},t}return(0,r.Z)(i,[{key:"validateFile",value:function(e){if(e.size>this.props.options.upload.limit)return interpolate(pgettext("avatar upload modal","Selected file is too big. (%(filesize)s)"),{filesize:(0,S.Z)(e.size)},!0);var t=pgettext("avatar upload modal","Selected file type is not supported.");if(-1===this.props.options.upload.allowed_mime_types.indexOf(e.type))return t;var n=!1,a=e.name.toLowerCase();return this.props.options.upload.allowed_extensions.map((function(e){a.substr(-1*e.length)===e&&(n=!0)})),!n&&t}},{key:"getUploadRequirements",value:function(e){var t=e.allowed_extensions.map((function(e){return e.substr(1)}));return interpolate(pgettext("avatar upload modal","%(files)s files smaller than %(limit)s"),{files:t.join(", "),limit:(0,S.Z)(e.limit)},!0)}},{key:"getUploadButton",value:function(){return(0,o.Z)("div",{className:"modal-body modal-avatar-upload"},void 0,(0,o.Z)(y.Z,{className:"btn-pick-file",onClick:this.pickFile},void 0,R||(R=(0,o.Z)("div",{className:"material-icon"},void 0,"input")),pgettext("avatar upload modal field","Select file")),(0,o.Z)("p",{className:"text-muted"},void 0,this.getUploadRequirements(this.props.options.upload)))}},{key:"getUploadProgressLabel",value:function(){return interpolate(pgettext("avatar upload modal field","%(progress)s % complete"),{progress:this.state.progress},!0)}},{key:"getUploadProgress",value:function(){return(0,o.Z)("div",{className:"modal-body modal-avatar-upload"},void 0,(0,o.Z)("div",{className:"upload-progress"},void 0,(0,o.Z)("img",{src:this.state.preview}),(0,o.Z)("div",{className:"progress"},void 0,(0,o.Z)("div",{className:"progress-bar",role:"progressbar","aria-valuenow":"{this.state.progress}","aria-valuemin":"0","aria-valuemax":"100",style:{width:this.state.progress+"%"}},void 0,(0,o.Z)("span",{className:"sr-only"},void 0,this.getUploadProgressLabel())))))}},{key:"renderUpload",value:function(){return(0,o.Z)("div",{},void 0,(0,o.Z)("input",{type:"file",id:"avatar-hidden-upload",className:"hidden-file-upload",onChange:this.uploadFile}),this.state.image?this.getUploadProgress():this.getUploadButton(),(0,o.Z)("div",{className:"modal-footer"},void 0,(0,o.Z)("div",{className:"col-md-6 col-md-offset-3"},void 0,(0,o.Z)(y.Z,{onClick:this.props.showIndex,disabled:!!this.state.image,className:"btn-default btn-block"},void 0,pgettext("avatar upload modal btn","Cancel")))))}},{key:"renderCrop",value:function(){return(0,o.Z)(E,{options:this.state.options,user:this.props.user,upload:this.state.uploaded,dataUrl:this.state.preview,onComplete:this.props.onComplete,showError:this.props.showError,showIndex:this.props.showIndex})}},{key:"render",value:function(){return this.state.uploaded?this.renderCrop():this.renderUpload()}}]),i}(f().Component),P=n(87462),T=(n(15579),n(69130));function A(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=(0,d.Z)(e);if(t){var i=(0,d.Z)(this).constructor;n=Reflect.construct(a,arguments,i)}else n=a.apply(this,arguments);return(0,u.Z)(this,n)}}var I,B,j,D=function(e){(0,c.Z)(n,e);var t=A(n);function n(){var e;(0,s.Z)(this,n);for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return e=t.call.apply(t,[this].concat(i)),(0,p.Z)((0,l.Z)(e),"select",(function(){e.props.select(e.props.id)})),e}return(0,r.Z)(n,[{key:"getClassName",value:function(){return this.props.selection===this.props.id?this.props.disabled?"btn btn-avatar btn-disabled avatar-selected":"btn btn-avatar avatar-selected":this.props.disabled?"btn btn-avatar btn-disabled":"btn btn-avatar"}},{key:"render",value:function(){return(0,o.Z)("button",{type:"button",className:this.getClassName(),disabled:this.props.disabled,onClick:this.select},void 0,(0,o.Z)("img",{src:this.props.url}))}}]),n}(f().Component),z=function(e){(0,c.Z)(n,e);var t=A(n);function n(){return(0,s.Z)(this,n),t.apply(this,arguments)}return(0,r.Z)(n,[{key:"render",value:function(){var e=this;return(0,o.Z)("div",{className:"avatars-gallery"},void 0,(0,o.Z)("h3",{},void 0,this.props.name),(0,o.Z)("div",{className:"avatars-gallery-images"},void 0,(0,T.Z)(this.props.images,4,null).map((function(t,n){return(0,o.Z)("div",{className:"row"},n,t.map((function(t,n){return(0,o.Z)("div",{className:"col-xs-3"},n,t?f().createElement(D,(0,P.Z)({disabled:e.props.disabled,select:e.props.select,selection:e.props.selection},t)):O||(O=(0,o.Z)("div",{className:"blank-avatar"})))})))}))))}}]),n}(f().Component),U=function(e){(0,c.Z)(n,e);var t=A(n);function n(e){var a;return(0,s.Z)(this,n),a=t.call(this,e),(0,p.Z)((0,l.Z)(a),"select",(function(e){a.setState({selection:e})})),(0,p.Z)((0,l.Z)(a),"save",(function(){if(a.state.isLoading)return!1;a.setState({isLoading:!0}),k.Z.post(a.props.user.api.avatar,{avatar:"galleries",image:a.state.selection}).then((function(e){a.setState({isLoading:!1}),N.Z.success(e.detail),a.props.onComplete(e),a.props.showIndex()}),(function(e){400===e.status?(N.Z.error(e.detail),a.setState({isLoading:!1})):a.props.showError(e)}))})),a.state={selection:null,isLoading:!1},a}return(0,r.Z)(n,[{key:"render",value:function(){var e=this;return(0,o.Z)("div",{},void 0,(0,o.Z)("div",{className:"modal-body modal-avatar-gallery"},void 0,this.props.options.galleries.map((function(t,n){return(0,o.Z)(z,{name:t.name,images:t.images,selection:e.state.selection,disabled:e.state.isLoading,select:e.select},n)}))),(0,o.Z)("div",{className:"modal-footer"},void 0,(0,o.Z)("div",{className:"row"},void 0,(0,o.Z)("div",{className:"col-md-6 col-md-offset-3"},void 0,(0,o.Z)(y.Z,{onClick:this.save,loading:this.state.isLoading,disabled:!this.state.selection,className:"btn-primary btn-block"},void 0,this.state.selection?pgettext("avatar gallery modal btn","Save choice"):pgettext("avatar gallery modal btn","Select avatar")),(0,o.Z)(y.Z,{onClick:this.props.showIndex,disabled:this.state.isLoading,className:"btn-default btn-block"},void 0,pgettext("avatar gallery modal btn","Cancel"))))))}}]),n}(f().Component),q=n(3784),M=n(6935),F=n(90287);function H(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=(0,d.Z)(e);if(t){var i=(0,d.Z)(this).constructor;n=Reflect.construct(a,arguments,i)}else n=a.apply(this,arguments);return(0,u.Z)(this,n)}}var V=function(e){(0,c.Z)(n,e);var t=H(n);function n(){return(0,s.Z)(this,n),t.apply(this,arguments)}return(0,r.Z)(n,[{key:"getErrorReason",value:function(){return this.props.reason?(0,o.Z)("p",{dangerouslySetInnerHTML:{__html:this.props.reason}}):null}},{key:"render",value:function(){return(0,o.Z)("div",{className:"modal-body"},void 0,I||(I=(0,o.Z)("div",{className:"message-icon"},void 0,(0,o.Z)("span",{className:"material-icon"},void 0,"remove_circle_outline"))),(0,o.Z)("div",{className:"message-body"},void 0,(0,o.Z)("p",{className:"lead"},void 0,this.props.message),this.getErrorReason(),(0,o.Z)("button",{className:"btn btn-default","data-dismiss":"modal",type:"button"},void 0,pgettext("avatar modal dismiss","Ok"))))}}]),n}(f().Component),Y=function(e){(0,c.Z)(n,e);var t=H(n);function n(){var e;(0,s.Z)(this,n);for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return e=t.call.apply(t,[this].concat(i)),(0,p.Z)((0,l.Z)(e),"showError",(function(t){e.setState({error:t})})),(0,p.Z)((0,l.Z)(e),"showIndex",(function(){e.setState({component:w})})),(0,p.Z)((0,l.Z)(e),"showUpload",(function(){e.setState({component:L})})),(0,p.Z)((0,l.Z)(e),"showCrop",(function(){e.setState({component:E})})),(0,p.Z)((0,l.Z)(e),"showGallery",(function(){e.setState({component:U})})),(0,p.Z)((0,l.Z)(e),"completeFlow",(function(t){F.Z.dispatch((0,M.n1)(e.props.user,t.avatars)),e.setState({component:w,options:t})})),e}return(0,r.Z)(n,[{key:"componentDidMount",value:function(){var e=this;k.Z.get(this.props.user.api.avatar).then((function(t){e.setState({component:w,options:t,error:null})}),(function(t){e.showError(t)}))}},{key:"getBody",value:function(){return this.state?this.state.error?(0,o.Z)(V,{message:this.state.error.detail,reason:this.state.error.reason}):(0,o.Z)(this.state.component,{options:this.state.options,user:this.props.user,onComplete:this.completeFlow,showError:this.showError,showIndex:this.showIndex,showCrop:this.showCrop,showUpload:this.showUpload,showGallery:this.showGallery}):B||(B=(0,o.Z)(q.Z,{}))}},{key:"getClassName",value:function(){return this.state&&this.state.error?"modal-dialog modal-message modal-change-avatar":"modal-dialog modal-change-avatar"}},{key:"render",value:function(){return(0,o.Z)("div",{className:this.getClassName(),role:"document"},void 0,(0,o.Z)("div",{className:"modal-content"},void 0,(0,o.Z)("div",{className:"modal-header"},void 0,(0,o.Z)("button",{type:"button",className:"close","data-dismiss":"modal","aria-label":pgettext("modal","Close")},void 0,j||(j=(0,o.Z)("span",{"aria-hidden":"true"},void 0,"×"))),(0,o.Z)("h4",{className:"modal-title"},void 0,pgettext("avatar modal title","Change your avatar"))),this.getBody()))}}]),n}(f().Component);function G(e){return{user:e.auth.user}}var $,W,Q,K,X,J,ee=n(49021);function te(){document.getElementById("hidden-logout-form").submit()}var ne=function(e){(0,c.Z)(i,e);var t,n,a=(t=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,a=(0,d.Z)(t);if(n){var i=(0,d.Z)(this).constructor;e=Reflect.construct(a,arguments,i)}else e=a.apply(this,arguments);return(0,u.Z)(this,e)});function i(e){var t;return(0,s.Z)(this,i),t=a.call(this,e),(0,p.Z)((0,l.Z)(t),"changeAvatar",(function(){t.props.close(),g.Z.show((0,Z.$j)(G)(Y))})),(0,p.Z)((0,l.Z)(t),"revealOptions",(function(){t.setState({options:t.props.options,optionsMore:!1})})),e.dropdown?t.state={options:e.options.slice(0,2),optionsMore:e.options.length>2}:t.state={options:e.options,optionsMore:!1},t}return(0,r.Z)(i,[{key:"render",value:function(){var e=this.props,t=e.user,n=e.close,a=e.dropdown,i=e.overlay;if(!t)return null;var s=misago.get("ADMIN_URL");return(0,o.Z)("ul",{className:v()("user-nav-menu",{"dropdown-menu-list":a,"overlay-menu-list":i})},void 0,(0,o.Z)("li",{className:"dropdown-menu-item"},void 0,(0,o.Z)("a",{href:t.url,className:"user-nav-profile"},void 0,(0,o.Z)("strong",{},void 0,t.username),(0,o.Z)("small",{},void 0,pgettext("user nav","Go to your profile")))),$||($=(0,o.Z)(ee.YV,{})),(0,o.Z)(ee.Xi,{},void 0,(0,o.Z)("a",{href:misago.get("NOTIFICATIONS_URL")},void 0,(0,o.Z)("span",{className:"material-icon"},void 0,t.unreadNotifications?"notifications_active":"notifications_none"),pgettext("user nav","Notifications"),!!t.unreadNotifications&&(0,o.Z)("span",{className:"badge"},void 0,t.unreadNotifications))),!!t.showPrivateThreads&&(0,o.Z)(ee.Xi,{},void 0,(0,o.Z)("a",{href:misago.get("PRIVATE_THREADS_URL")},void 0,W||(W=(0,o.Z)("span",{className:"material-icon"},void 0,"inbox")),pgettext("user nav","Private threads"),!!t.unreadPrivateThreads&&(0,o.Z)("span",{className:"badge"},void 0,t.unreadPrivateThreads))),!!s&&(0,o.Z)(ee.Xi,{},void 0,(0,o.Z)("a",{href:s,target:"_blank"},void 0,Q||(Q=(0,o.Z)("span",{className:"material-icon"},void 0,"security")),pgettext("user nav","Admin control panel"))),K||(K=(0,o.Z)(ee.YV,{})),(0,o.Z)(ee.iC,{className:"user-nav-options"},void 0,pgettext("user nav section","Account settings")),(0,o.Z)(ee.Xi,{},void 0,(0,o.Z)("button",{className:"btn-link",onClick:this.changeAvatar,type:"button"},void 0,X||(X=(0,o.Z)("span",{className:"material-icon"},void 0,"portrait")),pgettext("user nav","Change avatar"))),this.state.options.map((function(e){return(0,o.Z)(ee.Xi,{},e.icon,(0,o.Z)("a",{href:e.url},void 0,(0,o.Z)("span",{className:"material-icon"},void 0,e.icon),e.name))})),(0,o.Z)(ee.Xi,{},void 0,(0,o.Z)("button",{className:v()("btn-link",{"d-none":!this.state.optionsMore}),onClick:this.revealOptions,type:"button"},void 0,J||(J=(0,o.Z)("span",{className:"material-icon"},void 0,"more_vertical")),pgettext("user nav","See more"))),!!a&&(0,o.Z)(ee.kE,{listItem:!0},void 0,(0,o.Z)("button",{className:"btn btn-default btn-block",onClick:function(){te(),n()},type:"button"},void 0,pgettext("user nav","Log out"))))}}]),i}(f().Component);const ae=(0,Z.$j)((function(e){var t=e.auth.user;return t.id?{user:{username:t.username,unreadNotifications:t.unreadNotifications,unreadPrivateThreads:t.unread_private_threads,showPrivateThreads:t.acl.can_use_private_threads,url:t.url},options:(0,i.Z)(misago.get("userOptions"))}:{user:null}}))(ne);function ie(e){var t=e.close;return(0,o.Z)(ae,{close:t,dropdown:!0})}var oe=n(993),se=n(64836);const re=(0,Z.$j)((function(e){return{isOpen:e.overlay.userNav}}))((function(e){var t=e.dispatch,n=e.isOpen;return(0,o.Z)(se.a,{open:n},void 0,(0,o.Z)(se.i,{},void 0,pgettext("user nav title","Your options")),(0,o.Z)(ae,{close:function(){return t((0,oe.xv)())},overlay:!0}),(0,o.Z)(ee.kE,{},void 0,(0,o.Z)("button",{className:"btn btn-default btn-block",onClick:function(){te(),t((0,oe.xv)())},type:"button"},void 0,pgettext("user nav","Log out"))))}))},19605:(e,t,n)=>{"use strict";n.d(t,{ZP:()=>o});var a=n(22928),i=(n(57588),n(15579));function o(e){var t=e.size||100,n=e.size2x||2*t;return(0,a.Z)("img",{alt:"",className:e.className||"user-avatar",src:s(e.user,t),srcSet:s(e.user,n),width:e.height||t,height:e.height||t})}function s(e,t){return e&&e.id?function(e,t){var n=e[0];return e.forEach((function(e){e.size>=t&&(n=e)})),n}(e.avatars,t).url:i.Z.get("BLANK_AVATAR_URL")}},82211:(e,t,n)=>{"use strict";n.d(t,{Z:()=>h});var a,i=n(22928),o=n(15671),s=n(43144),r=n(79340),l=n(6215),c=n(61120),u=n(57588),d=n.n(u),p=n(37848);var h=function(e){(0,r.Z)(d,e);var t,n,u=(t=d,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,a=(0,c.Z)(t);if(n){var i=(0,c.Z)(this).constructor;e=Reflect.construct(a,arguments,i)}else e=a.apply(this,arguments);return(0,l.Z)(this,e)});function d(){return(0,o.Z)(this,d),u.apply(this,arguments)}return(0,s.Z)(d,[{key:"render",value:function(){var e="btn "+this.props.className,t=this.props.disabled;return this.props.loading&&(e+=" btn-loading",t=!0),(0,i.Z)("button",{className:e,disabled:t,onClick:this.props.onClick,type:this.props.onClick?"button":"submit"},void 0,this.props.children,this.props.loading?a||(a=(0,i.Z)(p.Z,{})):null)}}]),d}(d().Component);h.defaultProps={className:"btn-default",type:"submit",loading:!1,disabled:!1,onClick:null}},57026:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i});var a=n(22928);function i(e){return(0,a.Z)("select",{className:e.className||"form-control",disabled:e.disabled||!1,id:e.id||null,onChange:e.onChange,value:e.value},void 0,e.choices.map((function(e){return(0,a.Z)("option",{disabled:e.disabled||!1,value:e.value},e.value,"- - ".repeat(e.level)+e.label)})))}n(57588)},96359:(e,t,n)=>{"use strict";n.d(t,{Z:()=>u});var a=n(22928),i=n(15671),o=n(43144),s=n(79340),r=n(6215),l=n(61120),c=n(57588);var u=function(e){(0,s.Z)(u,e);var t,n,c=(t=u,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,a=(0,l.Z)(t);if(n){var i=(0,l.Z)(this).constructor;e=Reflect.construct(a,arguments,i)}else e=a.apply(this,arguments);return(0,r.Z)(this,e)});function u(){return(0,i.Z)(this,u),c.apply(this,arguments)}return(0,o.Z)(u,[{key:"isValidated",value:function(){return void 0!==this.props.validation}},{key:"getClassName",value:function(){var e="form-group";return this.isValidated()&&(e+=" has-feedback",null===this.props.validation?e+=" has-success":e+=" has-error"),e}},{key:"getFeedback",value:function(){var e=this;return this.props.validation?(0,a.Z)("div",{className:"help-block errors"},void 0,this.props.validation.map((function(t,n){return(0,a.Z)("p",{},e.props.for+"FeedbackItem"+n,t)}))):null}},{key:"getFeedbackDescription",value:function(){return this.isValidated()?(0,a.Z)("span",{id:this.props.for+"_status",className:"sr-only"},void 0,this.props.validation?pgettext("field validation status","(error)"):pgettext("field validation status","(success)")):null}},{key:"getHelpText",value:function(){return this.props.helpText?(0,a.Z)("p",{className:"help-block"},void 0,this.props.helpText):null}},{key:"render",value:function(){return(0,a.Z)("div",{className:this.getClassName()},void 0,(0,a.Z)("label",{className:"control-label "+(this.props.labelClass||""),htmlFor:this.props.for||""},void 0,this.props.label+":"),(0,a.Z)("div",{className:this.props.controlClass||""},void 0,this.props.children,this.getFeedbackDescription(),this.getFeedback(),this.getHelpText(),this.props.extra||null))}}]),u}(n.n(c)().Component)},43345:(e,t,n)=>{"use strict";n.d(t,{Z:()=>m});var a=n(15671),i=n(43144),o=n(97326),s=n(79340),r=n(6215),l=n(61120),c=n(4942),u=n(57588),d=n.n(u),p=n(55210),h=n(53904);var v=(0,p.C1)(),m=function(e){(0,s.Z)(d,e);var t,n,u=(t=d,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,a=(0,l.Z)(t);if(n){var i=(0,l.Z)(this).constructor;e=Reflect.construct(a,arguments,i)}else e=a.apply(this,arguments);return(0,r.Z)(this,e)});function d(){var e;(0,a.Z)(this,d);for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return e=u.call.apply(u,[this].concat(n)),(0,c.Z)((0,o.Z)(e),"bindInput",(function(t){return function(n){e.changeValue(t,n.target.value)}})),(0,c.Z)((0,o.Z)(e),"changeValue",(function(t,n){var a=(0,c.Z)({},t,n),i=e.state.errors||{};i[t]=e.validateField(t,a[t]),a.errors=i,e.setState(a)})),(0,c.Z)((0,o.Z)(e),"handleSubmit",(function(t){if(t&&t.preventDefault(),!e.state.isLoading&&e.clean()){e.setState({isLoading:!0});var n=e.send();n?n.then((function(t){e.setState({isLoading:!1}),e.handleSuccess(t)}),(function(t){e.setState({isLoading:!1}),e.handleError(t)})):e.setState({isLoading:!1})}})),e}return(0,i.Z)(d,[{key:"validate",value:function(){var e={};if(!this.state.validators)return e;var t={required:this.state.validators.required||this.state.validators,optional:this.state.validators.optional||{}},n=[];for(var a in t.required)t.required.hasOwnProperty(a)&&t.required[a]&&n.push(a);for(var i in t.optional)t.optional.hasOwnProperty(i)&&t.optional[i]&&n.push(i);for(var o in n){var s=n[o],r=this.validateField(s,this.state[s]);null===r?e[s]=null:r&&(e[s]=r)}return e}},{key:"isValid",value:function(){var e=this.validate();for(var t in e)if(e.hasOwnProperty(t)&&null!==e[t])return!1;return!0}},{key:"validateField",value:function(e,t){var n=[];if(!this.state.validators)return n;var a={required:(this.state.validators.required||this.state.validators)[e],optional:(this.state.validators.optional||{})[e]},i=v(t)||!1;if(a.required){if(i)n=[i];else for(var o in a.required){var s=a.required[o](t);s&&n.push(s)}return n.length?n:null}if(!1===i&&a.optional){for(var r in a.optional){var l=a.optional[r](t);l&&n.push(l)}return n.length?n:null}return!1}},{key:"clean",value:function(){return!0}},{key:"send",value:function(){return null}},{key:"handleSuccess",value:function(e){}},{key:"handleError",value:function(e){h.Z.apiError(e)}}]),d}(d().Component)},94417:(e,t,n)=>{"use strict";n.d(t,{Z:()=>u});var a=n(22928),i=n(15671),o=n(43144),s=n(79340),r=n(6215),l=n(61120),c=n(57588);var u=function(e){(0,s.Z)(u,e);var t,n,c=(t=u,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,a=(0,l.Z)(t);if(n){var i=(0,l.Z)(this).constructor;e=Reflect.construct(a,arguments,i)}else e=a.apply(this,arguments);return(0,r.Z)(this,e)});function u(){return(0,i.Z)(this,u),c.apply(this,arguments)}return(0,o.Z)(u,[{key:"isActive",value:function(){return this.props.isControlled?this.props.isActive:!!this.props.path&&0===document.location.pathname.indexOf(this.props.path)}},{key:"getClassName",value:function(){return this.isActive()?(this.props.className||"")+" "+(this.props.activeClassName||"active"):this.props.className||""}},{key:"render",value:function(){return(0,a.Z)("li",{className:this.getClassName()},void 0,this.props.children)}}]),u}(n.n(c)().Component)},37848:(e,t,n)=>{"use strict";n.d(t,{Z:()=>o});var a,i=n(22928);function o(e){return(0,i.Z)("div",{className:e.className||"loader"},void 0,a||(a=(0,i.Z)("div",{className:"loader-spinning-wheel"})))}n(57588)},69092:(e,t,n)=>{"use strict";n.d(t,{Z:()=>g});var a=n(15671),i=n(43144),o=n(79340),s=n(6215),r=n(61120),l=n(94184),c=n.n(l),u=n(57588),d=n.n(u),p=n(4942),h=n(19755),v=new RegExp("^.*(?:(?:youtu.be/|v/|vi/|u/w/|embed/)|(?:(?:watch)??v(?:i)?=|&v(?:i)?=))([^#&?]*).*");const m=new(function(){function e(){var t=this;(0,a.Z)(this,e),(0,p.Z)(this,"render",(function(e){e&&(t.highlightCode(e),t.embedYoutubePlayers(e))})),this._youtube={}}return(0,i.Z)(e,[{key:"highlightCode",value:function(e){n.e(417).then(n.bind(n,15739)).then((function(t){for(var n=t.default,a=e.querySelectorAll("pre>code"),i=0;i<a.length;i++)n.highlightElement(a[i])}))}},{key:"embedYoutubePlayers",value:function(e){for(var t=e.querySelectorAll("p>a"),n=0;n<t.length;n++){var a=t[n],i=1===a.parentNode.childNodes.length;this._youtube[a.href]||(this._youtube[a.href]=f(a.href));var o=this._youtube[a.href];i&&o&&!1!==o.data&&this.swapYoutubePlayer(a,o)}}},{key:"swapYoutubePlayer",value:function(e,t){var n="https://www.youtube.com/embed/";n+=t.video,n+="?feature=oembed",t.start&&(n+="&start="+t.start);var a=h('<iframe class="embed-responsive-item" frameborder="0" src="'+n+'" allow="encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>');h(e).replaceWith(a),a.wrap('<div class="embed-responsive embed-responsive-16by9"></div>')}}]),e}());function f(e){var t=function(e){var t=e;return"https://"===e.substr(0,8)?t=t.substr(8):"http://"===e.substr(0,7)&&(t=t.substr(7)),"www."===t.substr(0,4)&&(t=t.substr(4)),t}(e),n=function(e){if(-1===e.indexOf("youtu"))return null;var t=e.match(v);return t?t[1]:null}(t);if(!n)return null;var a=0;if(t.indexOf("?")>0){var i=t.substr(t.indexOf("?")+1).split("&").filter((function(e){return"t="===e.substr(0,2)}))[0];if(i){var o=i.substr(2).split("m");"s"===o[0].substr(-1)?a+=parseInt(o[0].substr(0,o[0].length-1)):(a+=60*parseInt(o[0]),o[1]&&"s"===o[1].substr(-1)&&(a+=parseInt(o[1].substr(0,o[1].length-1))))}}return{start:a,video:n}}var Z=n(19755);var g=function(e){(0,o.Z)(u,e);var t,n,l=(t=u,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,a=(0,r.Z)(t);if(n){var i=(0,r.Z)(this).constructor;e=Reflect.construct(a,arguments,i)}else e=a.apply(this,arguments);return(0,s.Z)(this,e)});function u(){return(0,a.Z)(this,u),l.apply(this,arguments)}return(0,i.Z)(u,[{key:"componentDidMount",value:function(){m.render(this.documentNode),Z(this.documentNode).find(".spoiler-reveal").click(b)}},{key:"componentDidUpdate",value:function(e,t){m.render(this.documentNode),Z(this.documentNode).find(".spoiler-reveal").click(b)}},{key:"shouldComponentUpdate",value:function(e,t){return e.markup!==this.props.markup}},{key:"render",value:function(){var e=this;return d().createElement("article",{className:c()("misago-markup",this.props.className),dangerouslySetInnerHTML:{__html:this.props.markup},"data-author":this.props.author||void 0,ref:function(t){e.documentNode=t}})}}]),u}(d().Component);function b(e){var t=e.target;Z(t).parent().parent().addClass("revealed")}},3784:(e,t,n)=>{"use strict";n.d(t,{Z:()=>h});var a,i=n(22928),o=n(15671),s=n(43144),r=n(79340),l=n(6215),c=n(61120),u=n(57588),d=n.n(u),p=n(37848);var h=function(e){(0,r.Z)(d,e);var t,n,u=(t=d,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,a=(0,c.Z)(t);if(n){var i=(0,c.Z)(this).constructor;e=Reflect.construct(a,arguments,i)}else e=a.apply(this,arguments);return(0,l.Z)(this,e)});function d(){return(0,o.Z)(this,d),u.apply(this,arguments)}return(0,s.Z)(d,[{key:"render",value:function(){return a||(a=(0,i.Z)("div",{className:"modal-body modal-loader"},void 0,(0,i.Z)(p.Z,{})))}}]),d}(d().Component)},30337:(e,t,n)=>{"use strict";n.d(t,{Z:()=>c});var a=n(22928),i=n(15671),o=n(43144),s=n(79340),r=n(6215),l=n(61120);n(57588);var c=function(e){(0,s.Z)(u,e);var t,n,c=(t=u,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,a=(0,l.Z)(t);if(n){var i=(0,l.Z)(this).constructor;e=Reflect.construct(a,arguments,i)}else e=a.apply(this,arguments);return(0,r.Z)(this,e)});function u(){return(0,i.Z)(this,u),c.apply(this,arguments)}return(0,o.Z)(u,[{key:"getHelpText",value:function(){return this.props.helpText?(0,a.Z)("p",{className:"help-block"},void 0,this.props.helpText):null}},{key:"render",value:function(){return(0,a.Z)("div",{className:"modal-body"},void 0,(0,a.Z)("div",{className:"message-icon"},void 0,(0,a.Z)("span",{className:"material-icon"},void 0,this.props.icon||"info_outline")),(0,a.Z)("div",{className:"message-body"},void 0,(0,a.Z)("p",{className:"lead"},void 0,this.props.message),this.getHelpText(),(0,a.Z)("button",{className:"btn btn-default","data-dismiss":"modal",type:"button"},void 0,pgettext("modal message dismiss btn","Ok"))))}}]),u}(n(33556).Z)},33556:(e,t,n)=>{"use strict";n.d(t,{Z:()=>u});var a=n(22928),i=n(15671),o=n(43144),s=n(79340),r=n(6215),l=n(61120),c=n(57588);var u=function(e){(0,s.Z)(u,e);var t,n,c=(t=u,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,a=(0,l.Z)(t);if(n){var i=(0,l.Z)(this).constructor;e=Reflect.construct(a,arguments,i)}else e=a.apply(this,arguments);return(0,r.Z)(this,e)});function u(){return(0,i.Z)(this,u),c.apply(this,arguments)}return(0,o.Z)(u,[{key:"getHelpText",value:function(){return this.props.helpText?(0,a.Z)("p",{className:"help-block"},void 0,this.props.helpText):null}},{key:"render",value:function(){return(0,a.Z)("div",{className:"panel-body panel-message-body"},void 0,(0,a.Z)("div",{className:"message-icon"},void 0,(0,a.Z)("span",{className:"material-icon"},void 0,this.props.icon||"info_outline")),(0,a.Z)("div",{className:"message-body"},void 0,(0,a.Z)("p",{className:"lead"},void 0,this.props.message),this.getHelpText()))}}]),u}(n.n(c)().Component)},11005:(e,t,n)=>{"use strict";n.d(t,{Z:()=>x});var a=n(22928),i=n(57588),o=n.n(i),s=n(69092);function r(e){return e.post.content?o().createElement(l,e):o().createElement(c,e)}function l(e){return(0,a.Z)("div",{className:"post-body"},void 0,(0,a.Z)(s.Z,{markup:e.post.headline||e.post.content}))}function c(e){return(0,a.Z)("div",{className:"post-body post-body-invalid"},void 0,(0,a.Z)("p",{className:"lead"},void 0,pgettext("post body invalid","This post's contents cannot be displayed.")),(0,a.Z)("p",{className:"text-muted"},void 0,pgettext("post body invalid","This error is caused by invalid post content manipulation.")))}function u(e){var t=e.post,n=t.category,i=t.thread,o=interpolate(pgettext("posts feed item header","posted %(posted_on)s"),{posted_on:t.posted_on.format("LL, LT")},!0);return(0,a.Z)("div",{className:"post-heading"},void 0,(0,a.Z)("a",{className:"btn btn-link item-title",href:i.url},void 0,i.title),(0,a.Z)("a",{className:"btn btn-link post-category",href:n.url.index},void 0,n.name),(0,a.Z)("a",{href:t.url.index,className:"btn btn-link posted-on",title:o},void 0,t.posted_on.fromNow()))}var d,p,h=n(19605);function v(e){var t=e.post;return(0,a.Z)("a",{className:"btn btn-default btn-icon pull-right",href:t.url.index},void 0,(0,a.Z)("span",{className:"btn-text-left hidden-xs"},void 0,pgettext("go to post link","See post")),d||(d=(0,a.Z)("span",{className:"material-icon"},void 0,"chevron_right")))}function m(e){var t=e.post;return(0,a.Z)("div",{className:"post-side post-side-anonymous"},void 0,(0,a.Z)(v,{post:t}),(0,a.Z)("div",{className:"media"},void 0,p||(p=(0,a.Z)("div",{className:"media-left"},void 0,(0,a.Z)("span",{},void 0,(0,a.Z)(h.ZP,{className:"poster-avatar",size:50})))),(0,a.Z)("div",{className:"media-body"},void 0,(0,a.Z)("div",{className:"media-heading"},void 0,(0,a.Z)("span",{className:"item-title"},void 0,t.poster_name)),(0,a.Z)("span",{className:"user-title user-title-anonymous"},void 0,pgettext("post removed poster username","Removed user")))))}function f(e){var t=e.rank,n=e.title||t.title||t.name,i="user-title";return t.css_class&&(i+=" user-title-"+t.css_class),t.is_tab?(0,a.Z)("a",{className:i,href:t.url},void 0,n):(0,a.Z)("span",{className:i},void 0,n)}function Z(e){var t=e.post,n=e.poster;return(0,a.Z)("div",{className:"post-side post-side-registered"},void 0,(0,a.Z)(v,{post:t}),(0,a.Z)("div",{className:"media"},void 0,(0,a.Z)("div",{className:"media-left"},void 0,(0,a.Z)("a",{href:n.url},void 0,(0,a.Z)(h.ZP,{className:"poster-avatar",size:50,user:n}))),(0,a.Z)("div",{className:"media-body"},void 0,(0,a.Z)("div",{className:"media-heading"},void 0,(0,a.Z)("a",{className:"item-title",href:n.url},void 0,n.username)),(0,a.Z)(f,{title:n.title,rank:n.rank}))))}function g(e){var t=e.post,n=e.poster;return n&&n.id?(0,a.Z)(Z,{post:t,poster:n}):(0,a.Z)(m,{post:t})}function b(e){var t=e.post,n=e.poster||t.poster,i="post";return n&&n.rank.css_class&&(i+=" post-"+n.rank.css_class),(0,a.Z)("li",{className:i,id:"post-"+t.id},void 0,(0,a.Z)("div",{className:"panel panel-default panel-post"},void 0,(0,a.Z)("div",{className:"panel-body"},void 0,(0,a.Z)("div",{className:"panel-content"},void 0,(0,a.Z)(g,{post:t,poster:n}),(0,a.Z)(u,{post:t}),(0,a.Z)(r,{post:t})))))}var y,_,k=n(44039);function N(){return(0,a.Z)("ul",{className:"posts-list post-feed ui-preview"},void 0,(0,a.Z)("li",{className:"post"},void 0,(0,a.Z)("div",{className:"panel panel-default panel-post"},void 0,(0,a.Z)("div",{className:"panel-body"},void 0,(0,a.Z)("div",{className:"panel-content"},void 0,(0,a.Z)("div",{className:"post-side post-side-anonymous"},void 0,(0,a.Z)("div",{className:"media"},void 0,y||(y=(0,a.Z)("div",{className:"media-left"},void 0,(0,a.Z)("span",{},void 0,(0,a.Z)(h.ZP,{className:"poster-avatar",size:50})))),(0,a.Z)("div",{className:"media-body"},void 0,(0,a.Z)("div",{className:"media-heading"},void 0,(0,a.Z)("span",{className:"item-title"},void 0,(0,a.Z)("span",{className:"ui-preview-text",style:{width:k.e(30,200)+"px"}},void 0," "))),(0,a.Z)("span",{className:"user-title user-title-anonymous"},void 0,(0,a.Z)("span",{className:"ui-preview-text",style:{width:k.e(30,200)+"px"}},void 0," "))))),(0,a.Z)("div",{className:"post-heading"},void 0,(0,a.Z)("span",{className:"ui-preview-text",style:{width:k.e(30,200)+"px"}},void 0," ")),(0,a.Z)("div",{className:"post-body"},void 0,(0,a.Z)("article",{className:"misago-markup"},void 0,(0,a.Z)("p",{},void 0,(0,a.Z)("span",{className:"ui-preview-text",style:{width:k.e(30,200)+"px"}},void 0," ")," ",(0,a.Z)("span",{className:"ui-preview-text",style:{width:k.e(30,200)+"px"}},void 0," ")," ",(0,a.Z)("span",{className:"ui-preview-text",style:{width:k.e(30,200)+"px"}},void 0," ")))))))))}function x(e){var t=e.isReady,n=e.posts,i=e.poster;return t?(0,a.Z)("ul",{className:"posts-list post-feed ui-ready"},void 0,n.map((function(e){return(0,a.Z)(b,{post:e,poster:i},e.id)}))):_||(_=(0,a.Z)(N,{}))}},9771:(e,t,n)=>{"use strict";n.d(t,{mv:()=>m,ZP:()=>cn,MO:()=>A,Fi:()=>N});var a,i=n(57588),o=n.n(i),s=n(22928),r=n(43144),l=n(15671),c=n(97326),u=n(79340),d=n(6215),p=n(61120),h=n(4942),v=n(64646);var m=function(e){(0,u.Z)(m,e);var t,n,i=(t=m,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,a=(0,p.Z)(t);if(n){var i=(0,p.Z)(this).constructor;e=Reflect.construct(a,arguments,i)}else e=a.apply(this,arguments);return(0,d.Z)(this,e)});function m(e){var t;return(0,l.Z)(this,m),t=i.call(this,e),(0,h.Z)((0,c.Z)(t),"selected",(function(){if(t.element){var e=Z(t.element)||null,n=e?e.getBoundingClientRect():null;t.setState({range:e,rect:n})}})),(0,h.Z)((0,c.Z)(t),"reply",(function(){if(v.Z.isOpen()){var e=A();e&&!e.disabled&&(e.quote(N(t.state.range)),t.setState({range:null,rect:null}),f())}else{var n=N(t.state.range);v.Z.open(Object.assign({},t.props.posting,{default:n})),t.setState({range:null,rect:null}),window.setTimeout(f,1e3)}})),(0,h.Z)((0,c.Z)(t),"render",(function(){return(0,s.Z)("div",{},void 0,o().createElement("div",{ref:function(e){e&&(t.element=e)},onMouseUp:t.selected,onTouchEnd:t.selected},t.props.children),!!t.state.rect&&(0,s.Z)("div",{className:"quote-control",style:{position:"absolute",left:t.state.rect.left+window.scrollX,top:t.state.rect.bottom+window.scrollY}},void 0,a||(a=(0,s.Z)("div",{className:"quote-control-arrow"})),(0,s.Z)("div",{className:"quote-control-inner"},void 0,(0,s.Z)("button",{className:"btn quote-control-btn",type:"button",onClick:t.reply},void 0,pgettext("post reply","Quote")))))})),t.state={range:null,rect:null},t.element=null,t}return(0,r.Z)(m)}(o().Component);function f(){var e=document.querySelector("#posting-mount textarea");e.focus(),e.selectionStart=e.selectionEnd=e.value.length}var Z=function(e){if(void 0!==window.getSelection){var t=window.getSelection();if(t&&"Range"===t.type&&1===t.rangeCount){var n=t.getRangeAt(0);if(g(n,e)&&b(n)&&y(n.cloneContents()))return n}}},g=function(e,t){var n=e.commonAncestorContainer;if(n===t)return!0;for(var a=n.parentNode;a;){if(a===t)return!0;a=a.parentNode}return!1},b=function(e){var t=e.commonAncestorContainer;if("ARTICLE"===t.nodeName)return!0;if(t.dataset&&"1"===t.dataset.noquote)return!1;for(var n=t.parentNode;n;){if(n.dataset&&"1"===n.dataset.noquote)return!1;if("ARTICLE"===n.nodeName)return!0;n=n.parentNode}return!1},y=function e(t){for(var n=0;n<t.childNodes.length;n++){var a=t.childNodes[n];if(a.nodeType===Node.TEXT_NODE&&a.textContent&&a.textContent.trim().length>0)return!0;if("IMG"===a.nodeName)return!0;if(e(a))return!0}return!1},_=n(42982),k=n(70885);const N=function(e){var t=x(e),n=L(e.cloneContents().childNodes,[]),a=t?'[quote="'.concat(t,'"]\n'):"[quote]\n",i="\n[/quote]\n\n",o=R(e);return o?(a+=o.syntax?"[code=".concat(o.syntax,"]\n"):"[code]\n",i="\n[/code]"+i):S(e)?(n=n.trim(),a+="`",i="`"+i):n=n.trim(),a+n+i};var x=function(e){var t=e.commonAncestorContainer;if(w(t))return C(t);for(var n=t.parentNode;n;){if(w(n))return C(n);n=n.parentNode}return""},w=function(e){return e.nodeType===Node.ELEMENT_NODE&&("ARTICLE"===e.nodeName||"BLOCKQUOTE"===e.nodeName&&e.dataset&&"quote"===e.dataset.block)},C=function(e){return e.dataset&&e.dataset.author||null},R=function(e){var t=e.commonAncestorContainer;if(E(t))return O(t);for(var n=t.parentNode;n;){if(E(n))return O(n);n=n.parentNode}return null},E=function(e){return"PRE"===e.nodeName},S=function(e){var t=e.commonAncestorContainer;if("CODE"===t.nodeName)return!0;for(var n=t.parentNode;n;){if(w(n))return!1;if("CODE"===n.nodeName)return!0;n=n.parentNode}return!1},O=function(e){return e.dataset?{syntax:e.dataset.syntax||null}:{syntax:null}},L=function(e,t){for(var n="",a=0;a<e.length;a++){var i=e[a];n+=T(i,t)}return n},P={H1:["\n\n# ",""],H2:["\n\n## ",""],H3:["\n\n### ",""],H4:["\n\n#### ",""],H5:["\n\n##### ",""],H6:["\n\n###### ",""],STRONG:["**","**"],EM:["*","*"],DEL:["~~","~~"],B:["[b]","[/b]"],U:["[u]","[/u]"],I:["[i]","[/i]"],SUB:["[sub]","[/sub]"],SUP:["[sup]","[/sup]"]},T=function(e,t){var n=e.dataset||{};if(e.nodeType===Node.TEXT_NODE)return e.textContent||"";if(e.nodeType===Node.ELEMENT_NODE){if(n.quote)return n.quote||"";if("1"===n.noquote)return""}if(e.nodeType===Node.ELEMENT_NODE&&n.quote&&n.quote.trim())return"";if("HR"===e.nodeName)return"\n\n- - -";if(P[e.nodeName]){var a=(0,k.Z)(P[e.nodeName],2),i=a[0],o=a[1];return i+L(e.childNodes,[].concat((0,_.Z)(t),[e.nodeName]))+o}if("A"===e.nodeName){var s=e.href,r=L(e.childNodes,[].concat((0,_.Z)(t),[e.nodeName]));return r?"[".concat(r,"](").concat(s,")"):"!(".concat(s,")")}if("IMG"===e.nodeName){var l=e.src,c=e.alt;return c?"![".concat(c,"](").concat(l,")"):"!(".concat(l,")")}if("DIV"===e.nodeName||"ASIDE"===e.nodeName){var u=n.block&&n.block.toUpperCase();if(u&&P[u]){var d=(0,k.Z)(P[u],2),p=d[0],h=d[1];return p+L(e.childNodes,[].concat((0,_.Z)(t),[u]))+h}return L(e.childNodes,t)}if("BLOCKQUOTE"===e.nodeName){if("spoiler"===n.block){var v=L(e.childNodes,[].concat((0,_.Z)(t),["SPOILER"])).trim();if(!v)return"";var m="\n[spoiler]\n";return(m+=v)+"\n[/spoiler]"}var f=L(e.childNodes,[].concat((0,_.Z)(t),["QUOTE"])).trim();if(!f)return"";var Z=C(e),g=Z?"\n[quote=".concat(Z,"]\n"):"\n\n[quote]\n";return(g+=f)+"\n[/quote]"}if("PRE"===e.nodeName){var b=n.syntax||null,y=e.querySelector("code"),N=y&&y.innerText||"";return N.trim()?"\n[code"+(b?"="+b:"")+"]"+N+"[/code]":""}if("CODE"===e.nodeName)return"`"+e.innerText+"`";if("P"===e.nodeName)return"\n"+L(e.childNodes,[].concat((0,_.Z)(t),[e.nodeName]));if("UL"===e.nodeName||"OL"===e.nodeName)return(0===t.filter((function(e){return"OL"===e||"UL"===e})).length?"\n":"")+L(e.childNodes,[].concat((0,_.Z)(t),[e.nodeName]));if("LI"===e.nodeName){for(var x="",w=t.filter((function(e){return"OL"===e||"UL"===e})).length,R=1;R<w;R++)x+="    ";x+="OL"===t[t.length-1]?n.index?n.index+". ":"1. ":"- ";var E=L(e.childNodes,[].concat((0,_.Z)(t),[e.nodeName]));return E.trim()?"\n"+x+E:""}return"SPAN"===e.nodeName?L(e.childNodes,t):""};function A(){return window.misagoReply}function I(e,t){window.misagoReply={disabled:e,quote:t}}function B(){window.misagoReply=null}var j=n(57026),D=n(43345),z=n(30381),U=n.n(z);function q(e){return e.filter((function(e){return e.id&&!e.isRemoved})).map((function(e){return e.id}))}var M,F=n(12891),H=n(78657),V=n(53904),Y=n(94184),G=n.n(Y),$=n(15579),W=n(69092),Q=n(59801),K=n(48772);function X(e){var t=e.attachment;return(0,s.Z)("div",{className:"modal-dialog modal-lg",role:"document"},void 0,(0,s.Z)("div",{className:"modal-content"},void 0,(0,s.Z)("div",{className:"modal-header"},void 0,(0,s.Z)("button",{"aria-label":pgettext("modal","Close"),className:"close","data-dismiss":"modal",type:"button"},void 0,M||(M=(0,s.Z)("span",{"aria-hidden":"true"},void 0,"×"))),(0,s.Z)("h4",{className:"modal-title"},void 0,pgettext("markup editor","Attachment details"))),(0,s.Z)("div",{className:"modal-body"},void 0,!!t.is_image&&(0,s.Z)("div",{className:"markup-editor-attachment-modal-preview"},void 0,(0,s.Z)("a",{href:t.url.index+"?shva=1",target:"_blank"},void 0,(0,s.Z)("img",{src:t.url.index+"?shva=1",alt:""}))),(0,s.Z)("div",{className:"markup-editor-attachment-modal-filename"},void 0,t.filename),(0,s.Z)("div",{className:"row markup-editor-attachment-modal-details"},void 0,(0,s.Z)("div",{className:"col-xs-12 col-md-3"},void 0,(0,s.Z)("strong",{},void 0,t.filetype+", "+(0,K.Z)(t.size)),(0,s.Z)("div",{className:"text-muted"},void 0,(0,s.Z)("small",{},void 0,pgettext("markup editor","Type and size")))),(0,s.Z)("div",{className:"col-xs-12 col-md-4"},void 0,(0,s.Z)("strong",{},void 0,(0,s.Z)("abbr",{title:t.uploaded_on.format("LLL")},void 0,t.uploaded_on.fromNow())),(0,s.Z)("div",{className:"text-muted"},void 0,(0,s.Z)("small",{},void 0,pgettext("markup editor","Uploaded at")))),(0,s.Z)("div",{className:"col-xs-12 col-md-3"},void 0,t.url.uploader?(0,s.Z)("a",{href:t.url.uploader,target:"_blank",className:"item-title"},void 0,t.uploader_name):(0,s.Z)("span",{className:"item-title"},void 0,t.uploader_name),(0,s.Z)("div",{className:"text-muted"},void 0,(0,s.Z)("small",{},void 0,pgettext("markup editor","Uploader")))))),(0,s.Z)("div",{className:"modal-footer"},void 0,(0,s.Z)("button",{className:"btn btn-default","data-dismiss":"modal",type:"button"},void 0,pgettext("modal","Close")))))}var J,ee,te,ne,ae=function(e,t,n,a,i){var o=e.text||i||"",s=e.prefix;s+=n+o+a,t(s+=e.suffix),window.setTimeout((function(){re(e.textarea);var t=e.start+n.length;e.textarea.setSelectionRange(t,t+o.length)}),250)},ie=function(e,t,n){var a=e.prefix;a+=n,t(a+=e.suffix),window.setTimeout((function(){re(e.textarea);var t=e.end+n.length;e.textarea.setSelectionRange(t,t)}),250)},oe=function(e){if(document.selection){e.focus();var t=document.selection.createRange(),n=t.text.length;return t.moveStart("character",-e.value.length),se(e,t.text.length-n,t.text.length)}if(e.selectionStart||"0"==e.selectionStart)return se(e,e.selectionStart,e.selectionEnd)},se=function(e,t,n){return{textarea:e,start:t,end:n,text:e.value.substring(t,n),prefix:e.value.substring(0,t),suffix:e.value.substring(n)}};function re(e){var t=e.scrollTop;e.focus(),e.scrollTop=t}const le=function(e){var t,n=e.attachment,a=e.disabled,i=e.element,o=e.setState,r=e.update;return(0,s.Z)("div",{className:"markup-editor-attachments-item"},void 0,(0,s.Z)("div",{className:"markup-editor-attachment"},void 0,(0,s.Z)("div",{className:"markup-editor-attachment-details"},void 0,n.id?(0,s.Z)("a",{className:"item-title",href:n.url.index+"?shva=1",target:"_blank",onClick:function(e){e.preventDefault(),Q.Z.show(t||(t=(0,s.Z)(X,{attachment:n})))}},void 0,n.filename):(0,s.Z)("strong",{className:"item-title"},void 0,n.filename),(0,s.Z)("div",{className:"text-muted"},void 0,(0,s.Z)("ul",{className:"list-unstyled list-inline"},void 0,!n.id&&(0,s.Z)("li",{},void 0,n.progress+"%"),!!n.filetype&&(0,s.Z)("li",{},void 0,n.filetype),n.size>0&&(0,s.Z)("li",{},void 0,(0,K.Z)(n.size))))),!!n.id&&(0,s.Z)("div",{className:"markup-editor-attachment-buttons"},void 0,(0,s.Z)("button",{className:"btn btn-markup-editor-attachment btn-icon",title:pgettext("markup editor","Insert into message"),type:"button",disabled:a,onClick:function(){var e=function(e){var t="[";return e.is_image?(t+="!["+e.filename+"]",t+="("+(e.url.thumb||e.url.index)+"?shva=1)"):t+=e.filename,t+"]("+e.url.index+"?shva=1)"}(n),t=oe(i);ie(t,r,e)}},void 0,J||(J=(0,s.Z)("span",{className:"material-icon"},void 0,"flip_to_front"))),(0,s.Z)("button",{className:"btn btn-markup-editor-attachment btn-icon",title:pgettext("markup editor","Remove attachment"),type:"button",disabled:a,onClick:function(){o((function(e){var t=e.attachments;if(window.confirm(pgettext("markup editor","Remove this attachment?")))return{attachments:t.filter((function(e){return e.id!==n.id}))}}))}},void 0,ee||(ee=(0,s.Z)("span",{className:"material-icon"},void 0,"close")))),!n.id&&!!n.key&&(0,s.Z)("div",{className:"markup-editor-attachment-buttons"},void 0,n.error&&(0,s.Z)("button",{className:"btn btn-markup-editor-attachment btn-icon",title:pgettext("markup editor","See error"),type:"button",onClick:function(){V.Z.error(interpolate(pgettext("markup editor","%(filename)s: %(error)s"),{filename:n.filename,error:n.error},!0))}},void 0,te||(te=(0,s.Z)("span",{className:"material-icon"},void 0,"warning"))),(0,s.Z)("button",{className:"btn btn-markup-editor-attachment btn-icon",title:pgettext("markup editor","Remove attachment"),type:"button",disabled:a,onClick:function(){o((function(e){return{attachments:e.attachments.filter((function(e){return e.key!==n.key}))}}))}},void 0,ne||(ne=(0,s.Z)("span",{className:"material-icon"},void 0,"close"))))))},ce=function(e){var t=e.attachments,n=e.disabled,a=e.element,i=e.setState,o=e.update;return(0,s.Z)("div",{className:"markup-editor-attachments"},void 0,(0,s.Z)("div",{className:"markup-editor-attachments-container"},void 0,t.map((function(e){return(0,s.Z)(le,{attachment:e,disabled:n,element:a,setState:i,update:o},e.key||e.id)}))))};var ue,de=n(82211);const pe=function(e){var t=e.canProtect,n=e.disabled,a=e.empty,i=e.preview,o=e.isProtected,r=e.submitText,l=e.showPreview,c=e.closePreview,u=e.enableProtection,d=e.disableProtection;return(0,s.Z)("div",{className:"markup-editor-footer"},void 0,!!t&&(0,s.Z)(de.Z,{className:"btn-default btn-icon hidden-sm hidden-md hidden-lg",title:o?pgettext("markup editor","Protected"):pgettext("markup editor","Protect"),type:"button",disabled:n,onClick:function(){o?d():u()}},void 0,(0,s.Z)("span",{className:"material-icon"},void 0,o?"lock":"lock_open")),!!t&&(0,s.Z)("div",{},void 0,(0,s.Z)(de.Z,{className:"btn-default hidden-xs",type:"button",disabled:n,onClick:function(){o?d():u()}},void 0,(0,s.Z)("span",{className:"material-icon"},void 0,o?"lock":"lock_open"),o?pgettext("markup editor","Protected"):pgettext("markup editor","Protect"))),ue||(ue=(0,s.Z)("div",{className:"markup-editor-spacer"})),i?(0,s.Z)(de.Z,{className:"btn-default btn-auto",type:"button",onClick:c},void 0,pgettext("markup editor","Edit")):(0,s.Z)(de.Z,{className:"btn-default btn-auto",disabled:n||a,type:"button",onClick:l},void 0,pgettext("markup editor","Preview")),(0,s.Z)(de.Z,{className:"btn-primary btn-auto",disabled:n||a},void 0,r||pgettext("markup editor","Post")))};var he,ve=n(96359);var me=function(e){(0,u.Z)(i,e);var t,n,a=(t=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,a=(0,p.Z)(t);if(n){var i=(0,p.Z)(this).constructor;e=Reflect.construct(a,arguments,i)}else e=a.apply(this,arguments);return(0,d.Z)(this,e)});function i(e){var t;return(0,l.Z)(this,i),t=a.call(this,e),(0,h.Z)((0,c.Z)(t),"handleSubmit",(function(e){e.preventDefault();var n=t.props,a=n.selection,i=n.update,o=t.state.syntax.trim(),s=t.state.text.trim();if(0===s.length)return t.setState({error:gettext("This field is required.")}),!1;var r=a.prefix.trim().length?"\n\n":"";return ie(Object.assign({},a,{text:s}),i,r+"```"+o+"\n"+s+"\n```\n\n"),Q.Z.hide(),!1})),t.state={error:null,syntax:"",text:e.selection.text},t}return(0,r.Z)(i,[{key:"render",value:function(){var e=this;return(0,s.Z)("div",{className:"modal-dialog modal-lg",role:"document"},void 0,(0,s.Z)("div",{className:"modal-content"},void 0,(0,s.Z)("div",{className:"modal-header"},void 0,(0,s.Z)("button",{"aria-label":pgettext("modal","Close"),className:"close","data-dismiss":"modal",type:"button"},void 0,he||(he=(0,s.Z)("span",{"aria-hidden":"true"},void 0,"×"))),(0,s.Z)("h4",{className:"modal-title"},void 0,pgettext("markup editor","Code"))),(0,s.Z)("form",{onSubmit:this.handleSubmit},void 0,(0,s.Z)("div",{className:"modal-body"},void 0,(0,s.Z)(ve.Z,{for:"markup_code_syntax",label:pgettext("markup editor","Syntax highlighting")},void 0,(0,s.Z)("select",{id:"markup_code_syntax",className:"form-control",value:this.state.syntax,onChange:function(t){return e.setState({syntax:t.target.value})}},void 0,(0,s.Z)("option",{value:""},void 0,pgettext("markup editor","No syntax highlighting")),fe.map((function(e){var t=e.value,n=e.name;return(0,s.Z)("option",{value:t},t,n)})))),(0,s.Z)(ve.Z,{for:"markup_code_text",label:pgettext("markup editor","Code to insert"),validation:this.state.error?[this.state.error]:void 0},void 0,(0,s.Z)("textarea",{id:"markup_code_text",className:"form-control",rows:"8",value:this.state.text,onChange:function(t){return e.setState({text:t.target.value})}}))),(0,s.Z)("div",{className:"modal-footer"},void 0,(0,s.Z)("button",{className:"btn btn-default","data-dismiss":"modal",type:"button"},void 0,pgettext("markup editor","Cancel")),(0,s.Z)("button",{className:"btn btn-primary"},void 0,pgettext("markup editor","Insert code"))))))}}]),i}(o().Component),fe=[{value:"bash",name:"Bash"},{value:"c",name:"C"},{value:"c#",name:"C#"},{value:"c++",name:"C++"},{value:"css",name:"CSS"},{value:"diff",name:"Diff"},{value:"go",name:"Go"},{value:"graphql",name:"GraphQL"},{value:"html,",name:"HTML"},{value:"xml",name:"XML"},{value:"json",name:"JSON"},{value:"java",name:"Java"},{value:"javascript",name:"JavaScript"},{value:"kotlin",name:"Kotlin"},{value:"less",name:"Less"},{value:"lua",name:"Lua"},{value:"makefile",name:"Makefile"},{value:"markdown",name:"Markdown"},{value:"objective-C",name:"Objective-C"},{value:"php",name:"PHP"},{value:"perl",name:"Perl"},{value:"plain",name:"Plain"},{value:"text",name:"text"},{value:"python",name:"Python"},{value:"repl",name:"REPL"},{value:"r",name:"R"},{value:"ruby",name:"Ruby"},{value:"rust",name:"Rust"},{value:"scss",name:"SCSS"},{value:"sql",name:"SQL"},{value:"shell",name:"Shell Session"},{value:"swift",name:"Swift"},{value:"toml",name:"TOML"},{value:"ini",name:"INI"},{value:"typescript",name:"TypeScript"},{value:"visualbasic",name:"Visual Basic .NET"},{value:"webassembly",name:"WebAssembly"},{value:"yaml",name:"YAML"}];const Ze=me;var ge,be,ye,_e,ke,Ne,xe,we,Ce,Re,Ee,Se,Oe,Le,Pe,Te,Ae,Ie,Be,je,De,ze,Ue,qe,Me,Fe,He,Ve,Ye,Ge,$e,We,Qe,Ke,Xe,Je,et,tt,nt,at,it,ot,st,rt,lt;function ct(){return(0,s.Z)("div",{className:"modal-dialog modal-lg",role:"document"},void 0,(0,s.Z)("div",{className:"modal-content"},void 0,(0,s.Z)("div",{className:"modal-header"},void 0,(0,s.Z)("button",{"aria-label":pgettext("modal","Close"),className:"close","data-dismiss":"modal",type:"button"},void 0,ge||(ge=(0,s.Z)("span",{"aria-hidden":"true"},void 0,"×"))),(0,s.Z)("h4",{className:"modal-title"},void 0,pgettext("markup help","Formatting help"))),(0,s.Z)("div",{className:"modal-body formatting-help"},void 0,(0,s.Z)("h4",{},void 0,pgettext("markup help","Emphasis text")),(0,s.Z)(ut,{markup:pgettext("markup help","_This text will have emphasis_"),result:(0,s.Z)("p",{},void 0,(0,s.Z)("em",{},void 0,pgettext("markup help","This text will have emphasis")))}),be||(be=(0,s.Z)("hr",{})),(0,s.Z)("h4",{},void 0,pgettext("markup help","Bold text")),(0,s.Z)(ut,{markup:pgettext("markup help","**This text will be bold**"),result:(0,s.Z)("p",{},void 0,(0,s.Z)("strong",{},void 0,pgettext("markup help","This text will be bold")))}),ye||(ye=(0,s.Z)("hr",{})),(0,s.Z)("h4",{},void 0,pgettext("markup help","Removed text")),(0,s.Z)(ut,{markup:pgettext("markup help","~~This text will be removed~~"),result:(0,s.Z)("p",{},void 0,(0,s.Z)("del",{},void 0,pgettext("markup help","This text will be removed")))}),_e||(_e=(0,s.Z)("hr",{})),(0,s.Z)("h4",{},void 0,pgettext("markup help","Bold text (BBCode)")),(0,s.Z)(ut,{markup:pgettext("markup help","[b]This text will be bold[/b]"),result:(0,s.Z)("p",{},void 0,(0,s.Z)("b",{},void 0,pgettext("markup help","This text will be bold")))}),ke||(ke=(0,s.Z)("hr",{})),(0,s.Z)("h4",{},void 0,pgettext("markup help","Underlined text (BBCode)")),(0,s.Z)(ut,{markup:pgettext("markup help","[u]This text will be underlined[/u]"),result:(0,s.Z)("p",{},void 0,(0,s.Z)("u",{},void 0,pgettext("markup help","This text will be underlined")))}),Ne||(Ne=(0,s.Z)("hr",{})),(0,s.Z)("h4",{},void 0,pgettext("markup help","Italics text (BBCode)")),(0,s.Z)(ut,{markup:pgettext("markup help","[i]This text will be in italics[/i]"),result:(0,s.Z)("p",{},void 0,(0,s.Z)("i",{},void 0,pgettext("markup help","This text will be in italics")))}),xe||(xe=(0,s.Z)("hr",{})),(0,s.Z)("h4",{},void 0,pgettext("markup help","Link")),we||(we=(0,s.Z)(ut,{markup:"<http://example.com>",result:(0,s.Z)("p",{},void 0,(0,s.Z)("a",{href:"#"},void 0,"example.com"))})),Ce||(Ce=(0,s.Z)("hr",{})),(0,s.Z)("h4",{},void 0,pgettext("markup help","Link with text")),(0,s.Z)(ut,{markup:"["+pgettext("markup help","Link text")+"](http://example.com)",result:(0,s.Z)("p",{},void 0,(0,s.Z)("a",{href:"#"},void 0,pgettext("markup help","Link text")))}),Re||(Re=(0,s.Z)("hr",{})),(0,s.Z)("h4",{},void 0,pgettext("markup help","Link (BBCode)")),Ee||(Ee=(0,s.Z)(ut,{markup:"[url]http://example.com[/url]",result:(0,s.Z)("p",{},void 0,(0,s.Z)("a",{href:"#"},void 0,"example.com"))})),Se||(Se=(0,s.Z)("hr",{})),(0,s.Z)("h4",{},void 0,pgettext("markup help","Link with text (BBCode)")),(0,s.Z)(ut,{markup:"[url=http://example.com]"+pgettext("markup help","Link text")+"[/url]",result:(0,s.Z)("p",{},void 0,(0,s.Z)("a",{href:"#"},void 0,pgettext("markup help","Link text")))}),Oe||(Oe=(0,s.Z)("hr",{})),(0,s.Z)("h4",{},void 0,pgettext("markup help","Image")),Le||(Le=(0,s.Z)(ut,{markup:"!(http://dummyimage.com/38/38)",result:(0,s.Z)("p",{},void 0,(0,s.Z)("img",{alt:"",src:"http://dummyimage.com/38/38"}))})),Pe||(Pe=(0,s.Z)("hr",{})),(0,s.Z)("h4",{},void 0,pgettext("markup help","Image with alternate text")),(0,s.Z)(ut,{markup:"!["+pgettext("markup help","Image text")+"](http://dummyimage.com/38/38)",result:(0,s.Z)("p",{},void 0,(0,s.Z)("img",{alt:pgettext("markup help","Image text"),src:"http://dummyimage.com/38/38"}))}),Te||(Te=(0,s.Z)("hr",{})),(0,s.Z)("h4",{},void 0,pgettext("markup help","Image (BBCode)")),Ae||(Ae=(0,s.Z)(ut,{markup:"[img]http://dummyimage.com/38/38[/img]",result:(0,s.Z)("p",{},void 0,(0,s.Z)("img",{alt:"",src:"http://dummyimage.com/38/38"}))})),Ie||(Ie=(0,s.Z)("hr",{})),(0,s.Z)("h4",{},void 0,pgettext("markup help","Mention user by their name")),Be||(Be=(0,s.Z)(ut,{markup:"@username",result:(0,s.Z)("p",{},void 0,(0,s.Z)("a",{href:"#"},void 0,"@username"))})),je||(je=(0,s.Z)("hr",{})),(0,s.Z)("h4",{},void 0,pgettext("markup help","Heading 1")),(0,s.Z)(ut,{markup:pgettext("markup help","# First level heading"),result:(0,s.Z)("h1",{},void 0,pgettext("markup help","First level heading"))}),De||(De=(0,s.Z)("hr",{})),(0,s.Z)("h4",{},void 0,pgettext("markup help","Heading 2")),(0,s.Z)(ut,{markup:pgettext("markup help","## Second level heading"),result:(0,s.Z)("h2",{},void 0,pgettext("markup help","Second level heading"))}),ze||(ze=(0,s.Z)("hr",{})),(0,s.Z)("h4",{},void 0,pgettext("markup help","Heading 3")),(0,s.Z)(ut,{markup:pgettext("markup help","### Third level heading"),result:(0,s.Z)("h3",{},void 0,pgettext("markup help","Third level heading"))}),Ue||(Ue=(0,s.Z)("hr",{})),(0,s.Z)("h4",{},void 0,pgettext("markup help","Heading 4")),(0,s.Z)(ut,{markup:pgettext("markup help","#### Fourth level heading"),result:(0,s.Z)("h4",{},void 0,pgettext("markup help","Fourth level heading"))}),qe||(qe=(0,s.Z)("hr",{})),(0,s.Z)("h4",{},void 0,pgettext("markup help","Heading 5")),(0,s.Z)(ut,{markup:pgettext("markup help","##### Fifth level heading"),result:(0,s.Z)("h5",{},void 0,pgettext("markup help","Fifth level heading"))}),Me||(Me=(0,s.Z)("hr",{})),(0,s.Z)("h4",{},void 0,pgettext("markup help","Unordered list")),Fe||(Fe=(0,s.Z)(ut,{markup:"- Lorem ipsum\n- Dolor met\n- Vulputate lectus",result:(0,s.Z)("ul",{},void 0,(0,s.Z)("li",{},void 0,"Lorem ipsum"),(0,s.Z)("li",{},void 0,"Dolor met"),(0,s.Z)("li",{},void 0,"Vulputate lectus"))})),He||(He=(0,s.Z)("hr",{})),(0,s.Z)("h4",{},void 0,pgettext("markup help","Ordered list")),Ve||(Ve=(0,s.Z)(ut,{markup:"1. Lorem ipsum\n2. Dolor met\n3. Vulputate lectus",result:(0,s.Z)("ol",{},void 0,(0,s.Z)("li",{},void 0,"Lorem ipsum"),(0,s.Z)("li",{},void 0,"Dolor met"),(0,s.Z)("li",{},void 0,"Vulputate lectus"))})),Ye||(Ye=(0,s.Z)("hr",{})),(0,s.Z)("h4",{},void 0,pgettext("markup help","Quote text")),(0,s.Z)(ut,{markup:"> "+pgettext("markup help","Quoted text"),result:(0,s.Z)("blockquote",{},void 0,(0,s.Z)("p",{},void 0,pgettext("markup help","Quoted text")))}),Ge||(Ge=(0,s.Z)("hr",{})),(0,s.Z)("h4",{},void 0,pgettext("markup help","Quote text (BBCode)")),(0,s.Z)(ut,{markup:"[quote]\n"+pgettext("markup help","Quoted text")+"\n[/quote]",result:(0,s.Z)("aside",{className:"quote-block"},void 0,(0,s.Z)("div",{className:"quote-heading"},void 0,gettext("Quoted message:")),(0,s.Z)("blockquote",{className:"quote-body"},void 0,(0,s.Z)("p",{},void 0,pgettext("markup help","Quoted text"))))}),$e||($e=(0,s.Z)("hr",{})),(0,s.Z)("h4",{},void 0,pgettext("markup help","Quote text with author (BBCode)")),(0,s.Z)(ut,{markup:'[quote="'+pgettext("markup help","Quote author")+'"]\n'+pgettext("markup help","Quoted text")+"\n[/quote]",result:(0,s.Z)("aside",{className:"quote-block"},void 0,(0,s.Z)("div",{className:"quote-heading"},void 0,pgettext("markup help","Quote author has written:")),(0,s.Z)("blockquote",{className:"quote-body"},void 0,(0,s.Z)("p",{},void 0,pgettext("markup help","Quoted text"))))}),We||(We=(0,s.Z)("hr",{})),(0,s.Z)("h4",{},void 0,pgettext("markup help","Spoiler")),(0,s.Z)(ut,{markup:"[spoiler]\n"+pgettext("markup help","Secret text")+"\n[/spoiler]",result:(0,s.Z)(pt,{},void 0,pgettext("markup help","Secret text"))}),Qe||(Qe=(0,s.Z)("hr",{})),(0,s.Z)("h4",{},void 0,pgettext("markup help","Inline code")),(0,s.Z)(ut,{markup:pgettext("markup help","`Inline code`"),result:(0,s.Z)("p",{},void 0,(0,s.Z)("code",{},void 0,pgettext("markup help","Inline code")))}),Ke||(Ke=(0,s.Z)("hr",{})),(0,s.Z)("h4",{},void 0,pgettext("markup help","Code block")),Xe||(Xe=(0,s.Z)(ut,{markup:'```\nalert("Hello world!");\n```',result:(0,s.Z)("pre",{},void 0,(0,s.Z)("code",{className:"hljs"},void 0,'alert("Hello world!");'))})),Je||(Je=(0,s.Z)("hr",{})),(0,s.Z)("h4",{},void 0,pgettext("markup help","Code block with syntax highlighting")),et||(et=(0,s.Z)(ut,{markup:'```python\nprint("Hello world!");\n```',result:(0,s.Z)("pre",{},void 0,(0,s.Z)("code",{className:"hljs language-python"},void 0,(0,s.Z)("span",{className:"hljs-built_in"},void 0,"print"),'("Hello world!");'))})),tt||(tt=(0,s.Z)("hr",{})),(0,s.Z)("h4",{},void 0,pgettext("markup help","Code block (BBCode)")),nt||(nt=(0,s.Z)(ut,{markup:'[code]\nalert("Hello world!");\n[/code]',result:(0,s.Z)("pre",{},void 0,(0,s.Z)("code",{className:"hljs"},void 0,'alert("Hello world!");'))})),at||(at=(0,s.Z)("hr",{})),(0,s.Z)("h4",{},void 0,pgettext("markup help","Code block with syntax highlighting (BBCode)")),it||(it=(0,s.Z)(ut,{markup:'[code="python"]\nprint("Hello world!");\n[/code]',result:(0,s.Z)("pre",{},void 0,(0,s.Z)("code",{className:"hljs language-python"},void 0,(0,s.Z)("span",{className:"hljs-built_in"},void 0,"print"),'("Hello world!");'))})),ot||(ot=(0,s.Z)("hr",{})),(0,s.Z)("h4",{},void 0,pgettext("markup help","Horizontal rule")),st||(st=(0,s.Z)(ut,{markup:"Lorem ipsum\n- - -\nDolor met",result:(0,s.Z)("div",{},void 0,(0,s.Z)("p",{},void 0,"Lorem ipsum"),(0,s.Z)("hr",{}),(0,s.Z)("p",{},void 0,"Dolor met"))})),rt||(rt=(0,s.Z)("hr",{})),(0,s.Z)("h4",{},void 0,pgettext("markup help","Horizontal rule (BBCode)")),lt||(lt=(0,s.Z)(ut,{markup:"Lorem ipsum\n[hr]\nDolor met",result:(0,s.Z)("div",{},void 0,(0,s.Z)("p",{},void 0,"Lorem ipsum"),(0,s.Z)("hr",{}),(0,s.Z)("p",{},void 0,"Dolor met"))}))),(0,s.Z)("div",{className:"modal-footer"},void 0,(0,s.Z)("button",{className:"btn btn-default","data-dismiss":"modal",type:"button"},void 0,pgettext("modal","Close")))))}function ut(e){var t=e.markup,n=e.result;return(0,s.Z)("div",{className:"formatting-help-item"},void 0,(0,s.Z)("div",{className:"formatting-help-item-markup"},void 0,(0,s.Z)("pre",{},void 0,(0,s.Z)("code",{},void 0,t))),(0,s.Z)("div",{className:"formatting-help-item-preview"},void 0,(0,s.Z)("article",{className:"misago-markup"},void 0,n)))}var dt,pt=function(e){(0,u.Z)(i,e);var t,n,a=(t=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,a=(0,p.Z)(t);if(n){var i=(0,p.Z)(this).constructor;e=Reflect.construct(a,arguments,i)}else e=a.apply(this,arguments);return(0,d.Z)(this,e)});function i(e){var t;return(0,l.Z)(this,i),(t=a.call(this,e)).state={reveal:!1},t}return(0,r.Z)(i,[{key:"render",value:function(){var e=this;return(0,s.Z)("aside",{className:this.state.reveal?"spoiler-block revealed":"spoiler-block"},void 0,(0,s.Z)("blockquote",{className:"spoiler-body"},void 0,(0,s.Z)("p",{},void 0,this.props.children)),!this.state.reveal&&(0,s.Z)("div",{className:"spoiler-overlay"},void 0,(0,s.Z)("button",{className:"spoiler-reveal",type:"button",onClick:function(){e.setState({reveal:!0})}},void 0,gettext("Reveal spoiler"))))}}]),i}(o().Component),ht=new RegExp("^(((ftps?)|(https?))://)","i");function vt(e){return ht.test(e.trim())}const mt=function(e){(0,u.Z)(i,e);var t,n,a=(t=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,a=(0,p.Z)(t);if(n){var i=(0,p.Z)(this).constructor;e=Reflect.construct(a,arguments,i)}else e=a.apply(this,arguments);return(0,d.Z)(this,e)});function i(e){var t;(0,l.Z)(this,i),t=a.call(this,e),(0,h.Z)((0,c.Z)(t),"handleSubmit",(function(e){e.preventDefault();var n=t.props,a=n.selection,i=n.update,o=t.state.text.trim(),s=t.state.url.trim();return 0===s.length?(t.setState({error:gettext("This field is required.")}),!1):(o.length>0?ie(a,i,"!["+o+"]("+s+")"):ie(a,i,"!("+s+")"),Q.Z.hide(),!1)}));var n=e.selection.text.trim(),o=vt(n);return t.state={error:null,text:o?"":n,url:o?n:""},t}return(0,r.Z)(i,[{key:"render",value:function(){var e=this;return(0,s.Z)("div",{className:"modal-dialog",role:"document"},void 0,(0,s.Z)("div",{className:"modal-content"},void 0,(0,s.Z)("div",{className:"modal-header"},void 0,(0,s.Z)("button",{"aria-label":pgettext("modal","Close"),className:"close","data-dismiss":"modal",type:"button"},void 0,dt||(dt=(0,s.Z)("span",{"aria-hidden":"true"},void 0,"×"))),(0,s.Z)("h4",{className:"modal-title"},void 0,pgettext("markup editor","Image"))),(0,s.Z)("form",{onSubmit:this.handleSubmit},void 0,(0,s.Z)("div",{className:"modal-body"},void 0,(0,s.Z)(ve.Z,{for:"markup_image_text",label:pgettext("markup editor","Image description"),helpText:pgettext("markup editor","Optional but recommended . Will be displayed instead of image when it fails to load.")},void 0,(0,s.Z)("input",{id:"markup_image_text",className:"form-control",type:"text",value:this.state.text,onChange:function(t){return e.setState({text:t.target.value})}})),(0,s.Z)(ve.Z,{for:"markup_image_url",label:pgettext("markup editor","Image URL"),validation:this.state.error?[this.state.error]:void 0},void 0,(0,s.Z)("input",{id:"markup_image_url",className:"form-control",type:"text",value:this.state.url,placeholder:"http://domain.com/image.png",onChange:function(t){return e.setState({url:t.target.value})}}))),(0,s.Z)("div",{className:"modal-footer"},void 0,(0,s.Z)("button",{className:"btn btn-default","data-dismiss":"modal",type:"button"},void 0,pgettext("markup editor","Cancel")),(0,s.Z)("button",{className:"btn btn-primary"},void 0,pgettext("markup editor","Insert image"))))))}}]),i}(o().Component);var ft;const Zt=function(e){(0,u.Z)(i,e);var t,n,a=(t=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,a=(0,p.Z)(t);if(n){var i=(0,p.Z)(this).constructor;e=Reflect.construct(a,arguments,i)}else e=a.apply(this,arguments);return(0,d.Z)(this,e)});function i(e){var t;(0,l.Z)(this,i),t=a.call(this,e),(0,h.Z)((0,c.Z)(t),"handleSubmit",(function(e){e.preventDefault();var n=t.props,a=n.selection,i=n.update,o=t.state.text.trim(),s=t.state.url.trim();return 0===s.length?(t.setState({error:gettext("This field is required.")}),!1):(o.length>0?ie(a,i,"["+o+"]("+s+")"):ie(a,i,"<"+s+">"),Q.Z.hide(),!1)}));var n=e.selection.text.trim(),o=vt(n);return t.state={error:null,text:o?"":n,url:o?n:""},t}return(0,r.Z)(i,[{key:"render",value:function(){var e=this;return(0,s.Z)("div",{className:"modal-dialog",role:"document"},void 0,(0,s.Z)("div",{className:"modal-content"},void 0,(0,s.Z)("div",{className:"modal-header"},void 0,(0,s.Z)("button",{"aria-label":pgettext("modal","Close"),className:"close","data-dismiss":"modal",type:"button"},void 0,ft||(ft=(0,s.Z)("span",{"aria-hidden":"true"},void 0,"×"))),(0,s.Z)("h4",{className:"modal-title"},void 0,pgettext("markup editor","Link"))),(0,s.Z)("form",{onSubmit:this.handleSubmit},void 0,(0,s.Z)("div",{className:"modal-body"},void 0,(0,s.Z)(ve.Z,{for:"markup_link_url",label:pgettext("markup editor","Link text"),helpText:pgettext("markup editor","Optional. Will be displayed instead of link's address.")},void 0,(0,s.Z)("input",{id:"markup_link_text",className:"form-control",type:"text",value:this.state.text,onChange:function(t){return e.setState({text:t.target.value})}})),(0,s.Z)(ve.Z,{for:"markup_link_url",label:pgettext("markup editor","Link address"),validation:this.state.error?[this.state.error]:void 0},void 0,(0,s.Z)("input",{id:"markup_link_url",className:"form-control",type:"text",value:this.state.url,onChange:function(t){return e.setState({url:t.target.value})}}))),(0,s.Z)("div",{className:"modal-footer"},void 0,(0,s.Z)("button",{className:"btn btn-default","data-dismiss":"modal",type:"button"},void 0,pgettext("markup editor","Cancel")),(0,s.Z)("button",{className:"btn btn-primary"},void 0,pgettext("markup editor","Insert link"))))))}}]),i}(o().Component);var gt;const bt=function(e){(0,u.Z)(i,e);var t,n,a=(t=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,a=(0,p.Z)(t);if(n){var i=(0,p.Z)(this).constructor;e=Reflect.construct(a,arguments,i)}else e=a.apply(this,arguments);return(0,d.Z)(this,e)});function i(e){var t;return(0,l.Z)(this,i),t=a.call(this,e),(0,h.Z)((0,c.Z)(t),"handleSubmit",(function(e){e.preventDefault();var n=t.props,a=n.selection,i=n.update,o=t.state.author.trim(),s=t.state.text.trim();if(0===s.length)return t.setState({error:gettext("This field is required.")}),!1;var r=a.prefix.trim().length?"\n\n":"";return ie(a,i,o?r+'[quote="'+o+'"]\n'+s+"\n[/quote]\n\n":r+"[quote]\n"+s+"\n[/quote]\n\n"),Q.Z.hide(),!1})),t.state={error:null,author:"",text:e.selection.text},t}return(0,r.Z)(i,[{key:"render",value:function(){var e=this;return(0,s.Z)("div",{className:"modal-dialog modal-lg",role:"document"},void 0,(0,s.Z)("div",{className:"modal-content"},void 0,(0,s.Z)("div",{className:"modal-header"},void 0,(0,s.Z)("button",{"aria-label":pgettext("modal","Close"),className:"close","data-dismiss":"modal",type:"button"},void 0,gt||(gt=(0,s.Z)("span",{"aria-hidden":"true"},void 0,"×"))),(0,s.Z)("h4",{className:"modal-title"},void 0,pgettext("markup editor","Quote"))),(0,s.Z)("form",{onSubmit:this.handleSubmit},void 0,(0,s.Z)("div",{className:"modal-body"},void 0,(0,s.Z)(ve.Z,{for:"markup_quote_author",label:pgettext("markup editor","Quote's author or source"),helpText:pgettext("markup editor",'Optional. If it\'s username, put "@" before it ("@JohnDoe").')},void 0,(0,s.Z)("input",{id:"markup_quote_author",className:"form-control",type:"text",value:this.state.author,onChange:function(t){return e.setState({author:t.target.value})}})),(0,s.Z)(ve.Z,{for:"markup_quote_text",label:pgettext("markup editor","Quoted text"),validation:this.state.error?[this.state.error]:void 0},void 0,(0,s.Z)("textarea",{id:"markup_quote_text",className:"form-control",rows:"8",value:this.state.text,onChange:function(t){return e.setState({text:t.target.value})}}))),(0,s.Z)("div",{className:"modal-footer"},void 0,(0,s.Z)("button",{className:"btn btn-default","data-dismiss":"modal",type:"button"},void 0,pgettext("markup editor","Cancel")),(0,s.Z)("button",{className:"btn btn-primary"},void 0,pgettext("markup editor","Insert quote"))))))}}]),i}(o().Component),yt=function(e){var t=e.disabled,n=e.icon,a=e.title,i=e.onClick;return(0,s.Z)("button",{className:"btn btn-markup-editor",title:a,type:"button",disabled:t,onClick:i},void 0,(0,s.Z)("span",{className:"material-icon"},void 0,n))};var _t=n(54031);const kt=function(e,t){var n=1024*$.Z.get("user").acl.max_attachment_size;if(e.size>n)V.Z.error(interpolate(pgettext("markup editor","File %(filename)s is bigger than %(limit)s."),{filename:e.name,limit:(0,K.Z)(n)},!0));else{var a={id:null,key:(0,_t.ZP)(32),error:null,uploaded_on:null,progress:0,filename:e.name,filetype:null,is_image:!1,size:e.size,url:null,uploader_name:null};t((function(e){var t=e.attachments;return{attachments:[a].concat(t)}}));var i=function(){t((function(e){return{attachments:e.attachments.concat()}}))},o=new FormData;o.append("upload",e),H.Z.upload($.Z.get("ATTACHMENTS_API"),o,(function(e){a.progress=e,i()})).then((function(e){Object.assign(a,e,{uploaded_on:U()(e.uploaded_on)}),i()}),(function(e){400===e.status||413===e.status?(a.error=e.detail,V.Z.error(e.detail),i()):V.Z.apiError(e)}))}};var Nt,xt;const wt=function(e){var t=e.disabled,n=e.element,a=e.update,i=e.updateAttachments,o=[{name:pgettext("markup editor","Strong"),icon:"format_bold",onClick:function(){ae(oe(n),a,"**","**",pgettext("example markup","Strong text"))}},{name:pgettext("markup editor","Emphasis"),icon:"format_italic",onClick:function(){ae(oe(n),a,"*","*",pgettext("example markup","Text with emphasis"))}},{name:pgettext("markup editor","Strikethrough"),icon:"format_strikethrough",onClick:function(){ae(oe(n),a,"~~","~~",pgettext("example markup","Text with strikethrough"))}},{name:pgettext("markup editor","Horizontal ruler"),icon:"remove",onClick:function(){ie(oe(n),a,"\n\n- - -\n\n")}},{name:pgettext("markup editor","Link"),icon:"insert_link",onClick:function(){var e=oe(n);Q.Z.show((0,s.Z)(Zt,{selection:e,element:n,update:a}))}},{name:pgettext("markup editor","Image"),icon:"insert_photo",onClick:function(){var e=oe(n);Q.Z.show((0,s.Z)(mt,{selection:e,element:n,update:a}))}},{name:pgettext("markup editor","Quote"),icon:"format_quote",onClick:function(){var e=oe(n);Q.Z.show((0,s.Z)(bt,{selection:e,element:n,update:a}))}},{name:pgettext("markup editor","Spoiler"),icon:"visibility_off",onClick:function(){!function(e,t){var n=oe(e),a=n.prefix.trim().length?"\n\n":"";ae(n,t,a+"[spoiler]\n","\n[/spoiler]\n\n",pgettext("markup editor","Spoiler text"))}(n,a)}},{name:pgettext("markup editor","Code"),icon:"code",onClick:function(){var e=oe(n);Q.Z.show((0,s.Z)(Ze,{selection:e,element:n,update:a}))}}];return $.Z.get("user").acl.max_attachment_size&&o.push({name:pgettext("markup editor","Upload file"),icon:"file_upload",onClick:function(){return e=i,(t=document.createElement("input")).type="file",t.multiple="multiple",t.addEventListener("change",(function(){for(var n=0;n<t.files.length;n++)kt(t.files[n],e)})),void t.click();var e,t}}),(0,s.Z)("div",{className:"markup-editor-toolbar"},void 0,(0,s.Z)("div",{className:"markup-editor-toolbar-left"},void 0,o.map((function(e){var a=e.name,i=e.icon,o=e.onClick;return(0,s.Z)(yt,{title:a,icon:i,disabled:t||!n,onClick:o},i)}))),(0,s.Z)("div",{className:"markup-editor-toolbar-right"},void 0,(0,s.Z)("div",{className:"markup-editor-controls-dropdown"},void 0,(0,s.Z)("button",{type:"button",className:"btn btn-markup-editor dropdown-toggle","data-toggle":"dropdown","aria-haspopup":"true","aria-expanded":"false",disabled:t||!n},void 0,Nt||(Nt=(0,s.Z)("span",{className:"material-icon"},void 0,"more_vert"))),(0,s.Z)("ul",{className:"dropdown-menu dropdown-menu-right stick-to-bottom"},void 0,o.map((function(e){var a=e.name,i=e.icon,o=e.onClick;return(0,s.Z)("li",{},i,(0,s.Z)("button",{type:"button",className:"btn-link",disabled:t||!n,onClick:o},void 0,(0,s.Z)("span",{className:"material-icon"},void 0,i),a))})))),(0,s.Z)(yt,{title:pgettext("markup editor","Open formatting help"),icon:"help_outline",onClick:function(){Q.Z.show(xt||(xt=(0,s.Z)(ct,{})))}})))};var Ct=n(19755);const Rt=function(e){(0,u.Z)(i,e);var t,n,a=(t=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,a=(0,p.Z)(t);if(n){var i=(0,p.Z)(this).constructor;e=Reflect.construct(a,arguments,i)}else e=a.apply(this,arguments);return(0,d.Z)(this,e)});function i(e){var t;return(0,l.Z)(this,i),t=a.call(this,e),(0,h.Z)((0,c.Z)(t),"showPreview",(function(){t.state.loading||(t.setState({loading:!0,preview:!0,element:null}),H.Z.post($.Z.get("PARSE_MARKUP_API"),{post:t.props.value}).then((function(e){t.setState({loading:!1,parsed:e.parsed})}),(function(e){400===e.status?V.Z.error(e.detail):V.Z.apiError(e),t.setState({loading:!1,preview:!1})})))})),(0,h.Z)((0,c.Z)(t),"closePreview",(function(){t.setState({loading:!1,preview:!1})})),(0,h.Z)((0,c.Z)(t),"onDrop",(function(e){if(e.preventDefault(),e.stopPropagation(),e.dataTransfer.files){var n=t.props.onAttachmentsChange;if($.Z.get("user").acl.max_attachment_size)for(var a=0;a<e.dataTransfer.files.length;a++){var i=e.dataTransfer.files[a];kt(i,n)}}})),(0,h.Z)((0,c.Z)(t),"onPaste",(function(e){for(var n=t.props.onAttachmentsChange,a=[],i=0;i<e.clipboardData.items.length;i++){var o=e.clipboardData.items[i];"file"===o.kind&&a.push(o.getAsFile())}if(a.length&&(e.preventDefault(),e.stopPropagation(),$.Z.get("user").acl.max_attachment_size))for(var s=0;s<a.length;s++)kt(a[s],n)})),(0,h.Z)((0,c.Z)(t),"render",(function(){return(0,s.Z)("div",{className:G()("markup-editor",{"markup-editor-focused":t.state.focused&&!t.state.preview})},void 0,(0,s.Z)(wt,{disabled:t.props.disabled||t.state.preview,element:t.state.element,update:function(e){return t.props.onChange({target:{value:e}})},updateAttachments:t.props.onAttachmentsChange}),t.state.preview?(0,s.Z)("div",{className:"markup-editor-preview"},void 0,t.state.loading?(0,s.Z)("div",{className:"markup-editor-preview-loading"},void 0,(0,s.Z)("div",{className:"ui-preview"},void 0,(0,s.Z)("span",{className:"ui-preview-text",style:{width:"240px"}}))):(0,s.Z)(W.Z,{className:"markup-editor-preview-contents",markup:t.state.parsed})):o().createElement("textarea",{className:"markup-editor-textarea form-control",placeholder:t.props.placeholder,value:t.props.value,disabled:t.props.disabled||t.state.loading,rows:6,ref:function(e){e&&t.state.element!==e&&(t.setState({element:e}),function(e,t){Ct(t).atwho({at:"@",displayTpl:'<li><img src="${avatar}" alt="">${username}</li>',insertTpl:"@${username}",searchKey:"username",callbacks:{remoteFilter:function(e,t){Ct.getJSON($.Z.get("MENTION_API"),{q:e},t)}}}),Ct(t).on("inserted.atwho",(function(t,n,a,i){var o=i.query,s=a.target.innerText.trim(),r=t.target.value.substr(0,o.headPos),l=t.target.value.substr(o.endPos);t.target.value=r+s+l,e.onChange(t);var c=o.headPos+s.length;t.target.setSelectionRange(c,c),t.target.focus()}))}(t.props,e))},onChange:t.props.onChange,onDrop:t.onDrop,onFocus:function(){return t.setState({focused:!0})},onPaste:t.onPaste,onBlur:function(){return t.setState({focused:!1})}}),t.props.attachments.length>0&&(0,s.Z)(ce,{attachments:t.props.attachments,disabled:t.props.disabled||t.state.preview,element:t.state.element,setState:t.props.onAttachmentsChange,update:function(e){return t.props.onChange({target:{value:e}})}}),(0,s.Z)(pe,{preview:t.state.preview,canProtect:t.props.canProtect,isProtected:t.props.isProtected,disabled:t.props.disabled,empty:t.props.value.trim().length<$.Z.get("SETTINGS").post_length_min||t.state.loading,enableProtection:t.props.enableProtection,disableProtection:t.props.disableProtection,showPreview:t.showPreview,closePreview:t.closePreview,submitText:t.props.submitText}))})),t.state={element:null,focused:!1,loading:!1,preview:!1,parsed:null},t}return(0,r.Z)(i)}(o().Component);var Et=n(92490);var St="posting-active",Ot="posting-default",Lt="posting-minimized",Pt="posting-fullscreen";const Tt=function(e){(0,u.Z)(i,e);var t,n,a=(t=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,a=(0,p.Z)(t);if(n){var i=(0,p.Z)(this).constructor;e=Reflect.construct(a,arguments,i)}else e=a.apply(this,arguments);return(0,d.Z)(this,e)});function i(){return(0,l.Z)(this,i),a.apply(this,arguments)}return(0,r.Z)(i,[{key:"componentDidMount",value:function(){document.body.classList.add(St,Ot)}},{key:"componentWillUnmount",value:function(){document.body.classList.remove(St,Ot,Lt,Pt)}},{key:"componentWillReceiveProps",value:function(e){var t=e.fullscreen;e.minimized?(document.body.classList.remove(Ot,Pt),document.body.classList.add(Lt)):t?(document.body.classList.remove(Ot,Lt),document.body.classList.add(Pt)):(document.body.classList.remove(Pt,Lt),document.body.classList.add(Ot))}},{key:"render",value:function(){var e=this.props,t=e.children,n=e.fullscreen,a=e.minimized;return(0,s.Z)("div",{className:G()("posting-dialog",{"posting-dialog-minimized":a,"posting-dialog-fullscreen":n&&!a})},void 0,(0,s.Z)("div",{className:"posting-dialog-container"},void 0,t))}}]),i}(o().Component),At=function(e){var t=e.children;return(0,s.Z)("div",{className:"posting-dialog-body"},void 0,t)};var It;const Bt=function(e){var t=e.close,n=e.message;return(0,s.Z)("div",{className:"posting-dialog-error"},void 0,It||(It=(0,s.Z)("div",{className:"posting-dialog-error-icon"},void 0,(0,s.Z)("span",{className:"material-icon"},void 0,"error_outlined"))),(0,s.Z)("div",{className:"posting-dialog-error-detail"},void 0,(0,s.Z)("p",{},void 0,n),(0,s.Z)("button",{type:"button",className:"btn btn-default",onClick:t},void 0,pgettext("modal","Close"))))};var jt,Dt,zt,Ut,qt;const Mt=function(e){var t=e.children,n=e.close,a=e.fullscreen,i=e.minimize,o=e.minimized,r=e.fullscreenEnter,l=e.fullscreenExit,c=e.open;return(0,s.Z)("div",{className:"posting-dialog-header"},void 0,(0,s.Z)("div",{className:"posting-dialog-caption"},void 0,t),o?(0,s.Z)("button",{className:"btn btn-posting-dialog",title:pgettext("dialog","Open"),type:"button",onClick:c},void 0,jt||(jt=(0,s.Z)("span",{className:"material-icon"},void 0,"expand_less"))):(0,s.Z)("button",{className:"btn btn-posting-dialog",title:pgettext("dialog","Minimize"),type:"button",onClick:i},void 0,Dt||(Dt=(0,s.Z)("span",{className:"material-icon"},void 0,"expand_more"))),a?(0,s.Z)("button",{className:"btn btn-posting-dialog hidden-xs",title:pgettext("dialog","Exit the fullscreen mode"),type:"button",onClick:l},void 0,zt||(zt=(0,s.Z)("span",{className:"material-icon"},void 0,"fullscreen_exit"))):(0,s.Z)("button",{className:"btn btn-posting-dialog hidden-xs",title:pgettext("dialog","Enter the fullscreen mode"),type:"button",onClick:r},void 0,Ut||(Ut=(0,s.Z)("span",{className:"material-icon"},void 0,"fullscreen"))),(0,s.Z)("button",{className:"btn btn-posting-dialog",title:pgettext("dialog","Cancel"),type:"button",onClick:n},void 0,qt||(qt=(0,s.Z)("span",{className:"material-icon"},void 0,"close"))))};var Ft,Ht,Vt,Yt,Gt,$t,Wt,Qt,Kt;function Xt(e){var t=e.isClosed,n=e.isHidden,a=e.isPinned,i=e.disabled,o=e.options,r=e.close,l=e.open,c=e.hide,u=e.unhide,d=e.pinGlobally,p=e.pinLocally,h=e.unpin,v=function(e,t,n){var a=[];return 2===n&&a.push("bookmark"),1===n&&a.push("bookmark_outline"),e&&a.push("lock"),t&&a.push("visibility_off"),a}(t,n,a);return(0,s.Z)("div",{className:"dropdown"},void 0,(0,s.Z)("button",{className:"btn btn-default btn-outline btn-icon",title:pgettext("post thread","Options"),"aria-expanded":"true","aria-haspopup":"true","data-toggle":"dropdown",type:"button",disabled:i},void 0,v.length>0?(0,s.Z)("span",{className:"btn-icons-family"},void 0,v.map((function(e){return(0,s.Z)("span",{className:"material-icon"},e,e)}))):Ft||(Ft=(0,s.Z)("span",{className:"material-icon"},void 0,"more_horiz"))),(0,s.Z)("ul",{className:"dropdown-menu dropdown-menu-right stick-to-bottom"},void 0,2===o.pin&&2!==a&&(0,s.Z)("li",{},void 0,(0,s.Z)("button",{className:"btn btn-link",onClick:d,type:"button",disabled:i},void 0,Ht||(Ht=(0,s.Z)("span",{className:"material-icon"},void 0,"bookmark")),pgettext("post thread","Pinned globally"))),o.pin>=a&&1!==a&&(0,s.Z)("li",{},void 0,(0,s.Z)("button",{className:"btn btn-link",onClick:p,type:"button",disabled:i},void 0,Vt||(Vt=(0,s.Z)("span",{className:"material-icon"},void 0,"bookmark_outline")),pgettext("post thread","Pinned in category"))),o.pin>=a&&0!==a&&(0,s.Z)("li",{},void 0,(0,s.Z)("button",{className:"btn btn-link",onClick:h,type:"button",disabled:i},void 0,Yt||(Yt=(0,s.Z)("span",{className:"material-icon"},void 0,"radio_button_unchecked")),pgettext("post thread","Not pinned"))),o.close&&!!t&&(0,s.Z)("li",{},void 0,(0,s.Z)("button",{className:"btn btn-link",onClick:l,type:"button",disabled:i},void 0,Gt||(Gt=(0,s.Z)("span",{className:"material-icon"},void 0,"lock_outline")),pgettext("post thread","Open"))),o.close&&!t&&(0,s.Z)("li",{},void 0,(0,s.Z)("button",{className:"btn btn-link",onClick:r,type:"button",disabled:i},void 0,$t||($t=(0,s.Z)("span",{className:"material-icon"},void 0,"lock")),pgettext("post thread","Closed"))),o.hide&&!!n&&(0,s.Z)("li",{},void 0,(0,s.Z)("button",{className:"btn btn-link",onClick:u,type:"button",disabled:i},void 0,Wt||(Wt=(0,s.Z)("span",{className:"material-icon"},void 0,"visibility")),pgettext("post thread","Visible"))),o.hide&&!n&&(0,s.Z)("li",{},void 0,(0,s.Z)("button",{className:"btn btn-link",onClick:c,type:"button",disabled:i},void 0,Qt||(Qt=(0,s.Z)("span",{className:"material-icon"},void 0,"visibility_off")),pgettext("post thread","Hidden")))))}var Jt=function(e){(0,u.Z)(i,e);var t,n,a=(t=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,a=(0,p.Z)(t);if(n){var i=(0,p.Z)(this).constructor;e=Reflect.construct(a,arguments,i)}else e=a.apply(this,arguments);return(0,d.Z)(this,e)});function i(e){var t;return(0,l.Z)(this,i),t=a.call(this,e),(0,h.Z)((0,c.Z)(t),"loadSuccess",(function(e){var n=null,a=null,i=e.map((function(e){return!1===e.post||n&&e.id!=t.state.category||(n=e.id,a=e.post),Object.assign(e,{disabled:!1===e.post,label:e.name,value:e.id})}));t.setState({isReady:!0,options:a,categories:i,category:n})})),(0,h.Z)((0,c.Z)(t),"loadError",(function(e){t.setState({error:e.detail})})),(0,h.Z)((0,c.Z)(t),"onCancel",(function(){if(0===t.state.post.length&&0===t.state.title.length&&0===t.state.attachments.length)return t.minimize(),v.Z.close();window.confirm(pgettext("post thread","Are you sure you want to discard thread?"))&&(t.minimize(),v.Z.close())})),(0,h.Z)((0,c.Z)(t),"onTitleChange",(function(e){t.changeValue("title",e.target.value)})),(0,h.Z)((0,c.Z)(t),"onCategoryChange",(function(e){var n=t.state.categories.find((function(t){return e.target.value==t.value})),a=t.state.pin;n.post.pin&&n.post.pin<a&&(a=n.post.pin),t.setState({category:n.id,categoryOptions:n.post,pin:a})})),(0,h.Z)((0,c.Z)(t),"onPostChange",(function(e){t.changeValue("post",e.target.value)})),(0,h.Z)((0,c.Z)(t),"onAttachmentsChange",(function(e){t.setState(e)})),(0,h.Z)((0,c.Z)(t),"onClose",(function(){t.changeValue("close",!0)})),(0,h.Z)((0,c.Z)(t),"onOpen",(function(){t.changeValue("close",!1)})),(0,h.Z)((0,c.Z)(t),"onPinGlobally",(function(){t.changeValue("pin",2)})),(0,h.Z)((0,c.Z)(t),"onPinLocally",(function(){t.changeValue("pin",1)})),(0,h.Z)((0,c.Z)(t),"onUnpin",(function(){t.changeValue("pin",0)})),(0,h.Z)((0,c.Z)(t),"onHide",(function(){t.changeValue("hide",!0)})),(0,h.Z)((0,c.Z)(t),"onUnhide",(function(){t.changeValue("hide",!1)})),(0,h.Z)((0,c.Z)(t),"close",(function(){t.minimize(),v.Z.close()})),(0,h.Z)((0,c.Z)(t),"minimize",(function(){t.setState({fullscreen:!1,minimized:!0})})),(0,h.Z)((0,c.Z)(t),"open",(function(){t.setState({minimized:!1}),t.state.fullscreen})),(0,h.Z)((0,c.Z)(t),"fullscreenEnter",(function(){t.setState({fullscreen:!0,minimized:!1})})),(0,h.Z)((0,c.Z)(t),"fullscreenExit",(function(){t.setState({fullscreen:!1,minimized:!1})})),t.state={isReady:!1,isLoading:!1,error:null,minimized:!1,fullscreen:!1,options:null,title:"",category:e.category||null,categories:[],post:"",attachments:[],close:!1,hide:!1,pin:0,validators:{title:(0,F.jn)(),post:(0,F.Jh)()},errors:{}},t}return(0,r.Z)(i,[{key:"componentDidMount",value:function(){H.Z.get(this.props.config).then(this.loadSuccess,this.loadError)}},{key:"clean",value:function(){if(!this.state.title.trim().length)return V.Z.error(pgettext("posting form","You have to enter thread title.")),!1;if(!this.state.post.trim().length)return V.Z.error(pgettext("posting form","You have to enter a message.")),!1;var e=this.validate();return e.title?(V.Z.error(e.title[0]),!1):!e.post||(V.Z.error(e.post[0]),!1)}},{key:"send",value:function(){return H.Z.post(this.props.submit,{title:this.state.title,category:this.state.category,post:this.state.post,attachments:q(this.state.attachments),close:this.state.close,hide:this.state.hide,pin:this.state.pin})}},{key:"handleSuccess",value:function(e){this.setState({isLoading:!0}),this.close(),V.Z.success(pgettext("post thread","Your thread has been posted.")),window.location=e.url}},{key:"handleError",value:function(e){if(400===e.status){var t=[].concat(e.non_field_errors||[],e.category||[],e.title||[],e.post||[],e.attachments||[]);V.Z.error(t[0])}else V.Z.apiError(e)}},{key:"render",value:function(){var e={minimized:this.state.minimized,minimize:this.minimize,open:this.open,fullscreen:this.state.fullscreen,fullscreenEnter:this.fullscreenEnter,fullscreenExit:this.fullscreenExit,close:this.onCancel};if(this.state.error)return o().createElement(en,e,(0,s.Z)(Bt,{message:this.state.error,close:this.close}));if(!this.state.isReady)return o().createElement(en,e,(0,s.Z)("div",{className:"posting-loading ui-preview"},void 0,Kt||(Kt=(0,s.Z)(Et.o8,{className:"posting-dialog-toolbar"},void 0,(0,s.Z)(Et.Z2,{className:"posting-dialog-thread-title",auto:!0},void 0,(0,s.Z)(Et.Eg,{auto:!0},void 0,(0,s.Z)("input",{className:"form-control",disabled:!0,type:"text"}))),(0,s.Z)(Et.Z2,{className:"posting-dialog-category-select",auto:!0},void 0,(0,s.Z)(Et.Eg,{},void 0,(0,s.Z)("input",{className:"form-control",disabled:!0,type:"text"}))))),(0,s.Z)(Rt,{attachments:[],value:"",submitText:pgettext("post thread submit","Start thread"),disabled:!0,onAttachmentsChange:function(){},onChange:function(){}})));var t=!!(this.state.options.close||this.state.options.hide||this.state.options.pin);return o().createElement(en,e,(0,s.Z)("form",{className:"posting-dialog-form",onSubmit:this.handleSubmit},void 0,(0,s.Z)(Et.o8,{className:"posting-dialog-toolbar"},void 0,(0,s.Z)(Et.Z2,{className:"posting-dialog-thread-title",auto:!0},void 0,(0,s.Z)(Et.Eg,{auto:!0},void 0,(0,s.Z)("input",{className:"form-control",disabled:this.state.isLoading,onChange:this.onTitleChange,placeholder:pgettext("post thread","Thread title"),type:"text",value:this.state.title}))),(0,s.Z)(Et.Z2,{className:"posting-dialog-category-select",auto:!0},void 0,(0,s.Z)(Et.Eg,{},void 0,(0,s.Z)(j.Z,{choices:this.state.categories,disabled:this.state.isLoading,onChange:this.onCategoryChange,value:this.state.category})),t&&(0,s.Z)(Et.Eg,{shrink:!0},void 0,(0,s.Z)(Xt,{isClosed:this.state.close,isHidden:this.state.hide,isPinned:this.state.pin,disabled:this.state.isLoading,options:this.state.options,close:this.onClose,open:this.onOpen,hide:this.onHide,unhide:this.onUnhide,pinGlobally:this.onPinGlobally,pinLocally:this.onPinLocally,unpin:this.onUnpin})))),(0,s.Z)(Rt,{attachments:this.state.attachments,value:this.state.post,submitText:pgettext("post thread submit","Start thread"),disabled:this.state.isLoading,onAttachmentsChange:this.onAttachmentsChange,onChange:this.onPostChange})))}}]),i}(D.Z),en=function(e){var t=e.children,n=e.close,a=e.minimized,i=e.minimize,o=e.open,r=e.fullscreen,l=e.fullscreenEnter,c=e.fullscreenExit;return(0,s.Z)(Tt,{fullscreen:r,minimized:a},void 0,(0,s.Z)(Mt,{fullscreen:r,fullscreenEnter:l,fullscreenExit:c,minimized:a,minimize:i,open:o,close:n},void 0,pgettext("post thread","Start new thread")),(0,s.Z)(At,{},void 0,t))};function tn(e){var t=e.split(",").map((function(e){return e.trim().toLowerCase()})).filter((function(e){return e.length>0}));return t.filter((function(e,n){return t.indexOf(e)==n}))}var nn=function(e){(0,u.Z)(i,e);var t,n,a=(t=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,a=(0,p.Z)(t);if(n){var i=(0,p.Z)(this).constructor;e=Reflect.construct(a,arguments,i)}else e=a.apply(this,arguments);return(0,d.Z)(this,e)});function i(e){var t;(0,l.Z)(this,i),t=a.call(this,e),(0,h.Z)((0,c.Z)(t),"onCancel",(function(){if(0===t.state.post.length&&0===t.state.title.length&&0===t.state.to.length&&0===t.state.attachments.length)return t.close();window.confirm(pgettext("post thread","Are you sure you want to discard private thread?"))&&t.close()})),(0,h.Z)((0,c.Z)(t),"onToChange",(function(e){t.changeValue("to",e.target.value)})),(0,h.Z)((0,c.Z)(t),"onTitleChange",(function(e){t.changeValue("title",e.target.value)})),(0,h.Z)((0,c.Z)(t),"onPostChange",(function(e){t.changeValue("post",e.target.value)})),(0,h.Z)((0,c.Z)(t),"onAttachmentsChange",(function(e){t.setState(e)})),(0,h.Z)((0,c.Z)(t),"close",(function(){t.minimize(),v.Z.close()})),(0,h.Z)((0,c.Z)(t),"minimize",(function(){t.setState({fullscreen:!1,minimized:!0})})),(0,h.Z)((0,c.Z)(t),"open",(function(){t.setState({minimized:!1}),t.state.fullscreen})),(0,h.Z)((0,c.Z)(t),"fullscreenEnter",(function(){t.setState({fullscreen:!0,minimized:!1})})),(0,h.Z)((0,c.Z)(t),"fullscreenExit",(function(){t.setState({fullscreen:!1,minimized:!1})}));var n=(e.to||[]).map((function(e){return e.username})).join(", ");return t.state={isLoading:!1,error:null,minimized:!1,fullscreen:!1,to:n,title:"",post:"",attachments:[],validators:{title:(0,F.jn)(),post:(0,F.Jh)()},errors:{}},t}return(0,r.Z)(i,[{key:"clean",value:function(){if(!tn(this.state.to).length)return V.Z.error(pgettext("posting form","You have to enter at least one recipient.")),!1;if(!this.state.title.trim().length)return V.Z.error(pgettext("posting form","You have to enter thread title.")),!1;if(!this.state.post.trim().length)return V.Z.error(pgettext("posting form","You have to enter a message.")),!1;var e=this.validate();return e.title?(V.Z.error(e.title[0]),!1):!e.post||(V.Z.error(e.post[0]),!1)}},{key:"send",value:function(){return H.Z.post(this.props.submit,{to:tn(this.state.to),title:this.state.title,post:this.state.post,attachments:q(this.state.attachments)})}},{key:"handleSuccess",value:function(e){this.setState({isLoading:!0}),this.close(),V.Z.success(pgettext("post thread","Your thread has been posted.")),window.location=e.url}},{key:"handleError",value:function(e){if(400===e.status){var t=[].concat(e.non_field_errors||[],e.to||[],e.title||[],e.post||[],e.attachments||[]);V.Z.error(t[0])}else V.Z.apiError(e)}},{key:"render",value:function(){var e={minimized:this.state.minimized,minimize:this.minimize,open:this.open,fullscreen:this.state.fullscreen,fullscreenEnter:this.fullscreenEnter,fullscreenExit:this.fullscreenExit,close:this.onCancel};return o().createElement(an,e,(0,s.Z)("form",{className:"posting-dialog-form",onSubmit:this.handleSubmit},void 0,(0,s.Z)(Et.o8,{className:"posting-dialog-toolbar"},void 0,(0,s.Z)(Et.Z2,{className:"posting-dialog-thread-recipients",auto:!0},void 0,(0,s.Z)(Et.Eg,{auto:!0},void 0,(0,s.Z)("input",{className:"form-control",disabled:this.state.isLoading,onChange:this.onToChange,placeholder:pgettext("post thread","Recipients, eg.: Danny, Lisa, Alice"),type:"text",value:this.state.to}))),(0,s.Z)(Et.Z2,{className:"posting-dialog-thread-title",auto:!0},void 0,(0,s.Z)(Et.Eg,{auto:!0},void 0,(0,s.Z)("input",{className:"form-control",disabled:this.state.isLoading,onChange:this.onTitleChange,placeholder:pgettext("post thread","Thread title"),type:"text",value:this.state.title})))),(0,s.Z)(Rt,{attachments:this.state.attachments,value:this.state.post,submitText:pgettext("post thread submit","Start thread"),disabled:this.state.isLoading,onAttachmentsChange:this.onAttachmentsChange,onChange:this.onPostChange})))}}]),i}(D.Z),an=function(e){var t=e.children,n=e.close,a=e.minimized,i=e.minimize,o=e.open,r=e.fullscreen,l=e.fullscreenEnter,c=e.fullscreenExit;return(0,s.Z)(Tt,{fullscreen:r,minimized:a},void 0,(0,s.Z)(Mt,{fullscreen:r,fullscreenEnter:l,fullscreenExit:c,minimized:a,minimize:i,open:o,close:n},void 0,pgettext("post thread","Start private thread")),(0,s.Z)(At,{},void 0,t))};var on=function(e){(0,u.Z)(i,e);var t,n,a=(t=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,a=(0,p.Z)(t);if(n){var i=(0,p.Z)(this).constructor;e=Reflect.construct(a,arguments,i)}else e=a.apply(this,arguments);return(0,d.Z)(this,e)});function i(e){var t;return(0,l.Z)(this,i),t=a.call(this,e),(0,h.Z)((0,c.Z)(t),"loadSuccess",(function(e){t.setState({isReady:!0,post:e.post?'[quote="@'+e.poster+'"]\n'+e.post+"\n[/quote]":t.state.post}),t.quoteText=e.post?'[quote="@'+e.poster+'"]\n'+e.post+"\n[/quote]":t.state.post})),(0,h.Z)((0,c.Z)(t),"loadError",(function(e){t.setState({error:e.detail})})),(0,h.Z)((0,c.Z)(t),"appendData",(function(e){var n=e.post?'[quote="@'+e.poster+'"]\n'+e.post+"\n[/quote]\n\n":"";t.setState((function(e,t){return e.post.length>0?{post:e.post.trim()+"\n\n"+n}:{post:n}})),t.open()})),(0,h.Z)((0,c.Z)(t),"onCancel",(function(){if(t.state.post===t.quoteText&&0===t.state.attachments.length)return t.close();window.confirm(pgettext("post reply","Are you sure you want to discard your reply?"))&&t.close()})),(0,h.Z)((0,c.Z)(t),"onPostChange",(function(e){t.changeValue("post",e.target.value)})),(0,h.Z)((0,c.Z)(t),"onAttachmentsChange",(function(e){t.setState(e)})),(0,h.Z)((0,c.Z)(t),"onQuote",(function(e){t.setState((function(t){var n=t.post;return n.length>0?{post:n.trim()+"\n\n"+e}:{post:e}})),t.open()})),(0,h.Z)((0,c.Z)(t),"close",(function(){t.minimize(),v.Z.close()})),(0,h.Z)((0,c.Z)(t),"minimize",(function(){t.setState({fullscreen:!1,minimized:!0})})),(0,h.Z)((0,c.Z)(t),"open",(function(){t.setState({minimized:!1}),t.state.fullscreen})),(0,h.Z)((0,c.Z)(t),"fullscreenEnter",(function(){t.setState({fullscreen:!0,minimized:!1})})),(0,h.Z)((0,c.Z)(t),"fullscreenExit",(function(){t.setState({fullscreen:!1,minimized:!1})})),t.state={isReady:!1,isLoading:!1,error:null,minimized:!1,fullscreen:!1,post:t.props.default||"",attachments:[],validators:{post:(0,F.Jh)()},errors:{}},t.quoteText="",t}return(0,r.Z)(i,[{key:"componentDidMount",value:function(){H.Z.get(this.props.config,this.props.context||null).then(this.loadSuccess,this.loadError),I(!1,this.onQuote)}},{key:"componentWillUnmount",value:function(){B()}},{key:"componentWillReceiveProps",value:function(e){var t=this.props.context,n=e.context;t&&n&&!n.reply||H.Z.get(e.config,e.context||null).then(this.appendData,V.Z.apiError)}},{key:"clean",value:function(){if(!this.state.post.trim().length)return V.Z.error(pgettext("posting form","You have to enter a message.")),!1;var e=this.validate();return!e.post||(V.Z.error(e.post[0]),!1)}},{key:"send",value:function(){return I(!0,this.onQuote),H.Z.post(this.props.submit,{post:this.state.post,attachments:q(this.state.attachments)})}},{key:"handleSuccess",value:function(e){this.setState({isLoading:!0}),this.close(),I(!1,this.onQuote),V.Z.success(pgettext("post reply","Your reply has been posted.")),window.location=e.url.index}},{key:"handleError",value:function(e){if(400===e.status){var t=[].concat(e.non_field_errors||[],e.post||[],e.attachments||[]);V.Z.error(t[0])}else V.Z.apiError(e);I(!1,this.onQuote)}},{key:"render",value:function(){var e={thread:this.props.thread,minimized:this.state.minimized,minimize:this.minimize,open:this.open,fullscreen:this.state.fullscreen,fullscreenEnter:this.fullscreenEnter,fullscreenExit:this.fullscreenExit,close:this.onCancel};return this.state.error?o().createElement(sn,e,(0,s.Z)(Bt,{message:this.state.error,close:this.close})):this.state.isReady?o().createElement(sn,e,(0,s.Z)("form",{className:"posting-dialog-form",method:"POST",onSubmit:this.handleSubmit},void 0,(0,s.Z)(Rt,{attachments:this.state.attachments,value:this.state.post,submitText:pgettext("post reply submit","Post reply"),disabled:this.state.isLoading,onAttachmentsChange:this.onAttachmentsChange,onChange:this.onPostChange}))):o().createElement(sn,e,(0,s.Z)("div",{className:"posting-loading ui-preview"},void 0,(0,s.Z)(Rt,{attachments:[],value:"",submitText:pgettext("post reply submit","Post reply"),disabled:!0,onAttachmentsChange:function(){},onChange:function(){}})))}}]),i}(D.Z),sn=function(e){var t=e.children,n=e.close,a=e.minimized,i=e.minimize,o=e.open,r=e.fullscreen,l=e.fullscreenEnter,c=e.fullscreenExit,u=e.thread;return(0,s.Z)(Tt,{fullscreen:r,minimized:a},void 0,(0,s.Z)(Mt,{fullscreen:r,fullscreenEnter:l,fullscreenExit:c,minimized:a,minimize:i,open:o,close:n},void 0,interpolate(pgettext("post reply","Reply to: %(thread)s"),{thread:u.title},!0)),(0,s.Z)(At,{},void 0,t))};var rn=function(e){(0,u.Z)(i,e);var t,n,a=(t=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,a=(0,p.Z)(t);if(n){var i=(0,p.Z)(this).constructor;e=Reflect.construct(a,arguments,i)}else e=a.apply(this,arguments);return(0,d.Z)(this,e)});function i(e){var t;return(0,l.Z)(this,i),t=a.call(this,e),(0,h.Z)((0,c.Z)(t),"loadSuccess",(function(e){var n;t.originalPost=e.post,t.setState({isReady:!0,post:e.post,attachments:(n=e.attachments,n.map((function(e){return Object.assign({},e,{uploaded_on:U()(e.uploaded_on)})}))),protect:e.is_protected,canProtect:e.can_protect})})),(0,h.Z)((0,c.Z)(t),"loadError",(function(e){t.setState({error:e.detail})})),(0,h.Z)((0,c.Z)(t),"appendData",(function(e){var n=e.post?'[quote="@'+e.poster+'"]\n'+e.post+"\n[/quote]\n\n":"";t.setState((function(e,t){return e.post.length>0?{post:e.post.trim()+"\n\n"+n}:{post:n}})),t.open()})),(0,h.Z)((0,c.Z)(t),"onCancel",(function(){var e=t.state.originalPost===t.state.post,n=0===t.state.attachments.length;if(e&&n)return t.close();window.confirm(pgettext("edit reply","Are you sure you want to discard changes?"))&&t.close()})),(0,h.Z)((0,c.Z)(t),"onProtect",(function(){t.setState({protect:!0})})),(0,h.Z)((0,c.Z)(t),"onUnprotect",(function(){t.setState({protect:!1})})),(0,h.Z)((0,c.Z)(t),"onPostChange",(function(e){t.changeValue("post",e.target.value)})),(0,h.Z)((0,c.Z)(t),"onAttachmentsChange",(function(e){t.setState(e)})),(0,h.Z)((0,c.Z)(t),"onQuote",(function(e){t.setState((function(t){var n=t.post;return n.length>0?{post:n.trim()+"\n\n"+e}:{post:e}})),t.open()})),(0,h.Z)((0,c.Z)(t),"close",(function(){t.minimize(),v.Z.close()})),(0,h.Z)((0,c.Z)(t),"minimize",(function(){t.setState({fullscreen:!1,minimized:!0})})),(0,h.Z)((0,c.Z)(t),"open",(function(){t.setState({minimized:!1}),t.state.fullscreen})),(0,h.Z)((0,c.Z)(t),"fullscreenEnter",(function(){t.setState({fullscreen:!0,minimized:!1})})),(0,h.Z)((0,c.Z)(t),"fullscreenExit",(function(){t.setState({fullscreen:!1,minimized:!1})})),t.state={isReady:!1,isLoading:!1,error:!1,minimized:!1,fullscreen:!1,post:"",attachments:[],protect:!1,canProtect:!1,validators:{post:(0,F.Jh)()},errors:{}},t.originalPost="",t}return(0,r.Z)(i,[{key:"componentDidMount",value:function(){H.Z.get(this.props.config).then(this.loadSuccess,this.loadError),I(!1,this.onQuote)}},{key:"componentWillUnmount",value:function(){B()}},{key:"componentWillReceiveProps",value:function(e){var t=this.props.context,n=e.context;t&&n&&t.reply===n.reply||H.Z.get(e.config,e.context||null).then(this.appendData,V.Z.apiError)}},{key:"clean",value:function(){if(!this.state.post.trim().length)return V.Z.error(pgettext("posting form","You have to enter a message.")),!1;var e=this.validate();return!e.post||(V.Z.error(e.post[0]),!1)}},{key:"send",value:function(){return I(!0,this.onQuote),H.Z.put(this.props.submit,{post:this.state.post,attachments:q(this.state.attachments),protect:this.state.protect})}},{key:"handleSuccess",value:function(e){this.setState({isLoading:!0}),this.close(),I(!1,this.onQuote),V.Z.success(pgettext("edit reply","Reply has been edited.")),window.location=e.url.index}},{key:"handleError",value:function(e){if(400===e.status){var t=[].concat(e.non_field_errors||[],e.category||[],e.title||[],e.post||[],e.attachments||[]);V.Z.error(t[0])}else V.Z.apiError(e);I(!1,this.onQuote)}},{key:"render",value:function(){var e=this,t={post:this.props.post,minimized:this.state.minimized,minimize:this.minimize,open:this.open,fullscreen:this.state.fullscreen,fullscreenEnter:this.fullscreenEnter,fullscreenExit:this.fullscreenExit,close:this.onCancel};return this.state.error?o().createElement(ln,t,(0,s.Z)(Bt,{message:this.state.error,close:this.close})):this.state.isReady?o().createElement(ln,t,(0,s.Z)("form",{className:"posting-dialog-form",method:"POST",onSubmit:this.handleSubmit},void 0,(0,s.Z)(Rt,{attachments:this.state.attachments,canProtect:this.state.canProtect,isProtected:this.state.protect,enableProtection:function(){return e.setState({protect:!0})},disableProtection:function(){return e.setState({protect:!1})},value:this.state.post,submitText:pgettext("edit reply submit","Edit reply"),disabled:this.state.isLoading,onAttachmentsChange:this.onAttachmentsChange,onChange:this.onPostChange}))):o().createElement(ln,t,(0,s.Z)("div",{className:"posting-loading ui-preview"},void 0,(0,s.Z)(Rt,{attachments:[],value:"",submitText:pgettext("edit reply submit","Edit reply"),disabled:!0,onAttachmentsChange:function(){},onChange:function(){}})))}}]),i}(D.Z),ln=function(e){var t=e.children,n=e.close,a=e.minimized,i=e.minimize,o=e.open,r=e.fullscreen,l=e.fullscreenEnter,c=e.fullscreenExit,u=e.post;return(0,s.Z)(Tt,{fullscreen:r,minimized:a},void 0,(0,s.Z)(Mt,{fullscreen:r,fullscreenEnter:l,fullscreenExit:c,minimized:a,minimize:i,open:o,close:n},void 0,interpolate(pgettext("edit reply","Edit reply by %(poster)s from %(date)s"),{poster:u.poster?u.poster.username:u.poster_name,date:u.posted_on.fromNow()},!0)),(0,s.Z)(At,{},void 0,t))};function cn(e){switch(e.mode){case"START":return o().createElement(Jt,e);case"START_PRIVATE":return o().createElement(nn,e);case"REPLY":return o().createElement(on,e);case"EDIT":return o().createElement(rn,e);default:return null}}},12891:(e,t,n)=>{"use strict";n.d(t,{Jh:()=>s,jn:()=>o});var a=n(55210),i=n(15579);function o(){return[(0,a.Ei)(i.Z.get("SETTINGS").thread_title_length_min,(function(e,t){var n=npgettext("thread title length validator","Thread title should be at least %(limit_value)s character long (it has %(show_value)s).","Thread title should be at least %(limit_value)s characters long (it has %(show_value)s).",e);return interpolate(n,{limit_value:e,show_value:t},!0)})),(0,a.BS)(i.Z.get("SETTINGS").thread_title_length_max,(function(e,t){var n=npgettext("thread title length validator","Thread title cannot be longer than %(limit_value)s character (it has %(show_value)s).","Thread title cannot be longer than %(limit_value)s characters (it has %(show_value)s).",e);return interpolate(n,{limit_value:e,show_value:t},!0)}))]}function s(){return i.Z.get("SETTINGS").post_length_max?[r(),(0,a.BS)(i.Z.get("SETTINGS").post_length_max||1e6,(function(e,t){var n=npgettext("post length validator","Posted message cannot be longer than %(limit_value)s character (it has %(show_value)s).","Posted message cannot be longer than %(limit_value)s characters (it has %(show_value)s).",e);return interpolate(n,{limit_value:e,show_value:t},!0)}))]:[r()]}function r(){return(0,a.Ei)(i.Z.get("SETTINGS").post_length_min,(function(e,t){var n=npgettext("post length validator","Posted message should be at least %(limit_value)s character long (it has %(show_value)s).","Posted message should be at least %(limit_value)s characters long (it has %(show_value)s).",e);return interpolate(n,{limit_value:e,show_value:t},!0)}))}},60471:(e,t,n)=>{"use strict";n.d(t,{Z:()=>p});var a=n(22928),i=n(15671),o=n(43144),s=n(97326),r=n(79340),l=n(6215),c=n(61120),u=n(4942),d=n(57588);var p=function(e){(0,r.Z)(p,e);var t,n,d=(t=p,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,a=(0,c.Z)(t);if(n){var i=(0,c.Z)(this).constructor;e=Reflect.construct(a,arguments,i)}else e=a.apply(this,arguments);return(0,l.Z)(this,e)});function p(){var e;(0,i.Z)(this,p);for(var t=arguments.length,n=new Array(t),a=0;a<t;a++)n[a]=arguments[a];return e=d.call.apply(d,[this].concat(n)),(0,u.Z)((0,s.Z)(e),"change",(function(t){return function(){e.props.onChange({target:{value:t}})}})),e}return(0,o.Z)(p,[{key:"getChoice",value:function(){var e=this,t=null;return this.props.choices.map((function(n){n.value===e.props.value&&(t=n)})),t}},{key:"getIcon",value:function(){return this.getChoice().icon}},{key:"getLabel",value:function(){return this.getChoice().label}},{key:"render",value:function(){var e=this;return(0,a.Z)("div",{className:"btn-group btn-select-group"},void 0,(0,a.Z)("button",{type:"button",className:"btn btn-select dropdown-toggle",id:this.props.id||null,"data-toggle":"dropdown","aria-haspopup":"true","aria-expanded":"false","aria-describedby":this.props["aria-describedby"]||null,disabled:this.props.disabled||!1},void 0,(0,a.Z)(h,{icon:this.getIcon()}),this.getLabel()),(0,a.Z)("ul",{className:"dropdown-menu"},void 0,this.props.choices.map((function(t,n){return(0,a.Z)("li",{},n,(0,a.Z)("button",{type:"button",className:"btn-link",onClick:e.change(t.value)},void 0,(0,a.Z)(h,{icon:t.icon}),t.label))}))))}}]),p}(n.n(d)().Component);function h(e){var t=e.icon;return t?(0,a.Z)("span",{className:"material-icon"},void 0,t):null}},14467:(e,t,n)=>{"use strict";n.d(t,{Z:()=>b});var a,i=n(22928),o=n(15671),s=n(43144),r=n(79340),l=n(6215),c=n(61120),u=(n(57588),n(15579)),d=n(82211),p=n(43345),h=n(47235),v=n(78657),m=n(59801),f=n(53904),Z=n(93051),g=n(19755);var b=function(e){(0,r.Z)(b,e);var t,n,p=(t=b,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,a=(0,c.Z)(t);if(n){var i=(0,c.Z)(this).constructor;e=Reflect.construct(a,arguments,i)}else e=a.apply(this,arguments);return(0,l.Z)(this,e)});function b(e){var t;return(0,o.Z)(this,b),(t=p.call(this,e)).state={isLoading:!1,showActivation:!1,username:"",password:"",validators:{username:[],password:[]}},t}return(0,s.Z)(b,[{key:"clean",value:function(){return!!this.isValid()||(f.Z.error(pgettext("sign in modal","Fill out both fields.")),!1)}},{key:"send",value:function(){return v.Z.post(u.Z.get("AUTH_API"),{username:this.state.username,password:this.state.password})}},{key:"handleSuccess",value:function(){var e=g("#hidden-login-form");e.append('<input type="text" name="username" />'),e.append('<input type="password" name="password" />'),e.find('input[type="hidden"]').val(v.Z.getCsrfToken()),e.find('input[name="next"]').val(window.location.pathname),e.find('input[name="username"]').val(this.state.username),e.find('input[name="password"]').val(this.state.password),e.submit(),this.setState({isLoading:!0})}},{key:"handleError",value:function(e){400===e.status?"inactive_admin"===e.code?f.Z.info(e.detail):"inactive_user"===e.code?(f.Z.info(e.detail),this.setState({showActivation:!0})):"banned"===e.code?((0,Z.Z)(e.detail),m.Z.hide()):f.Z.error(e.detail):403===e.status&&e.ban?((0,Z.Z)(e.ban),m.Z.hide()):f.Z.apiError(e)}},{key:"getActivationButton",value:function(){return this.state.showActivation?(0,i.Z)("a",{className:"btn btn-success btn-block",href:u.Z.get("REQUEST_ACTIVATION_URL")},void 0,pgettext("sign in modal btn","Activate account")):null}},{key:"render",value:function(){return(0,i.Z)("div",{className:"modal-dialog modal-sm modal-sign-in",role:"document"},void 0,(0,i.Z)("div",{className:"modal-content"},void 0,(0,i.Z)("div",{className:"modal-header"},void 0,(0,i.Z)("button",{"aria-label":pgettext("modal","Close"),className:"close","data-dismiss":"modal",type:"button"},void 0,a||(a=(0,i.Z)("span",{"aria-hidden":"true"},void 0,"×"))),(0,i.Z)("h4",{className:"modal-title"},void 0,pgettext("sign in modal title","Sign in"))),(0,i.Z)("form",{onSubmit:this.handleSubmit},void 0,(0,i.Z)("div",{className:"modal-body"},void 0,(0,i.Z)(h.Z,{buttonLabel:pgettext("sign in modal","Sign in with %(site)s"),formLabel:pgettext("sign in modal","Or use your forum account:"),labelClassName:"text-center"}),(0,i.Z)("div",{className:"form-group"},void 0,(0,i.Z)("div",{className:"control-input"},void 0,(0,i.Z)("input",{className:"form-control input-lg",disabled:this.state.isLoading,id:"id_username",onChange:this.bindInput("username"),placeholder:pgettext("sign in modal field","Username or e-mail"),type:"text",value:this.state.username}))),(0,i.Z)("div",{className:"form-group"},void 0,(0,i.Z)("div",{className:"control-input"},void 0,(0,i.Z)("input",{className:"form-control input-lg",disabled:this.state.isLoading,id:"id_password",onChange:this.bindInput("password"),placeholder:pgettext("sign in modal field","Password"),type:"password",value:this.state.password})))),(0,i.Z)("div",{className:"modal-footer"},void 0,this.getActivationButton(),(0,i.Z)(d.Z,{className:"btn-primary btn-block",loading:this.state.isLoading},void 0,pgettext("sign in modal btn","Sign in")),(0,i.Z)("a",{className:"btn btn-default btn-block",href:u.Z.get("FORGOTTEN_PASSWORD_URL")},void 0,pgettext("sign in modal btn","Forgot password?"))))))}}]),b}(p.Z)},24678:(e,t,n)=>{"use strict";n.d(t,{Jj:()=>h,ZP:()=>p,pg:()=>v});var a=n(22928),i=n(15671),o=n(43144),s=n(79340),r=n(6215),l=n(61120),c=n(57588),u=n.n(c);function d(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=(0,l.Z)(e);if(t){var i=(0,l.Z)(this).constructor;n=Reflect.construct(a,arguments,i)}else n=a.apply(this,arguments);return(0,r.Z)(this,n)}}var p=function(e){(0,s.Z)(n,e);var t=d(n);function n(){return(0,i.Z)(this,n),t.apply(this,arguments)}return(0,o.Z)(n,[{key:"getClass",value:function(){return e=this.props.status,t="",e.is_banned?t="banned":e.is_hidden?t="offline":e.is_online_hidden?t="online":e.is_offline_hidden?t="offline":e.is_online?t="online":e.is_offline&&(t="offline"),"user-status user-"+t;var e,t}},{key:"render",value:function(){return(0,a.Z)("span",{className:this.getClass()},void 0,this.props.children)}}]),n}(u().Component),h=function(e){(0,s.Z)(n,e);var t=d(n);function n(){return(0,i.Z)(this,n),t.apply(this,arguments)}return(0,o.Z)(n,[{key:"getIcon",value:function(){return this.props.status.is_banned?"remove_circle_outline":this.props.status.is_hidden?"help_outline":this.props.status.is_online_hidden?"label":this.props.status.is_offline_hidden?"label_outline":this.props.status.is_online?"lens":this.props.status.is_offline?"panorama_fish_eye":void 0}},{key:"render",value:function(){return(0,a.Z)("span",{className:"material-icon status-icon"},void 0,this.getIcon())}}]),n}(u().Component),v=function(e){(0,s.Z)(n,e);var t=d(n);function n(){return(0,i.Z)(this,n),t.apply(this,arguments)}return(0,o.Z)(n,[{key:"getHelp",value:function(){return e=this.props.user,(t=this.props.status).is_banned?t.banned_until?interpolate(pgettext("user status","%(username)s is banned until %(ban_expires)s"),{username:e.username,ban_expires:t.banned_until.format("LL, LT")},!0):interpolate(pgettext("user status","%(username)s is banned"),{username:e.username},!0):t.is_hidden?interpolate(pgettext("user status","%(username)s is hiding presence"),{username:e.username},!0):t.is_online_hidden?interpolate(pgettext("user status","%(username)s is online (hidden)"),{username:e.username},!0):t.is_offline_hidden?interpolate(pgettext("user status","%(username)s was last seen %(last_click)s (hidden)"),{username:e.username,last_click:t.last_click.fromNow()},!0):t.is_online?interpolate(pgettext("user status","%(username)s is online"),{username:e.username},!0):t.is_offline?interpolate(pgettext("user status","%(username)s was last seen %(last_click)s"),{username:e.username,last_click:t.last_click.fromNow()},!0):void 0;var e,t}},{key:"getLabel",value:function(){return this.props.status.is_banned?pgettext("user status","Banned"):this.props.status.is_hidden?pgettext("user status","Hidden"):this.props.status.is_online_hidden?pgettext("user status","Online (hidden)"):this.props.status.is_offline_hidden?pgettext("user status","Offline (hidden)"):this.props.status.is_online?pgettext("user status","Online"):this.props.status.is_offline?pgettext("user status","Offline"):void 0}},{key:"render",value:function(){return(0,a.Z)("span",{className:this.props.className||"status-label",title:this.getHelp()},void 0,this.getLabel())}}]),n}(u().Component)},40429:(e,t,n)=>{"use strict";n.d(t,{Z:()=>O});var a,i=n(22928),o=n(57588),s=n.n(o),r=n(19605),l=n(24678);function c(e){var t=e.showStatus,n=e.user;return(0,i.Z)("ul",{className:"list-unstyled"},void 0,(0,i.Z)(u,{showStatus:t,user:n}),(0,i.Z)(d,{user:n}),a||(a=(0,i.Z)("li",{className:"user-stat-divider"})),(0,i.Z)(p,{user:n}),(0,i.Z)(h,{user:n}),(0,i.Z)(v,{user:n}))}function u(e){var t=e.showStatus,n=e.user;return t?(0,i.Z)("li",{className:"user-stat-status"},void 0,(0,i.Z)(l.ZP,{status:n.status},void 0,(0,i.Z)(l.pg,{status:n.status,user:n}))):null}function d(e){var t=e.user.joined_on,n=interpolate(pgettext("users list item","Joined on %(joined_on)s"),{joined_on:t.format("LL, LT")},!0),a=interpolate(pgettext("users list item","Joined %(joined_on)s"),{joined_on:t.fromNow()},!0);return(0,i.Z)("li",{className:"user-stat-join-date"},void 0,(0,i.Z)("abbr",{title:n},void 0,a))}function p(e){var t=e.user,n=m("user-stat-posts",t.posts),a=npgettext("users list item","%(posts)s post","%(posts)s posts",t.posts);return(0,i.Z)("li",{className:n},void 0,interpolate(a,{posts:t.posts},!0))}function h(e){var t=e.user,n=m("user-stat-threads",t.threads),a=npgettext("users list item","%(threads)s thread","%(threads)s threads",t.threads);return(0,i.Z)("li",{className:n},void 0,interpolate(a,{threads:t.threads},!0))}function v(e){var t=e.user,n=m("user-stat-followers",t.followers),a=npgettext("users list item","%(followers)s follower","%(followers)s followers",t.followers);return(0,i.Z)("li",{className:n},void 0,interpolate(a,{followers:t.followers},!0))}function m(e,t){return 0===t?e+" user-stat-empty":e}function f(e){var t=e.rank,n=e.title||t.title||t.name,a="user-title";return t.css_class&&(a+=" user-title-"+t.css_class),t.is_tab?(0,i.Z)("a",{className:a,href:t.url},void 0,n):(0,i.Z)("span",{className:a},void 0,n)}function Z(e){var t=e.showStatus,n=e.user,a=n.rank,o="panel user-card";return a.css_class&&(o+=" user-card-"+a.css_class),(0,i.Z)("div",{className:o},void 0,(0,i.Z)("div",{className:"panel-body"},void 0,(0,i.Z)("div",{className:"row"},void 0,(0,i.Z)("div",{className:"col-xs-3 user-card-left"},void 0,(0,i.Z)("div",{className:"user-card-small-avatar"},void 0,(0,i.Z)("a",{href:n.url},void 0,(0,i.Z)(r.ZP,{size:"50",size2x:"80",user:n})))),(0,i.Z)("div",{className:"col-xs-9 col-sm-12 user-card-body"},void 0,(0,i.Z)("div",{className:"user-card-avatar"},void 0,(0,i.Z)("a",{href:n.url},void 0,(0,i.Z)(r.ZP,{size:"150",size2x:"200",user:n}))),(0,i.Z)("div",{className:"user-card-username"},void 0,(0,i.Z)("a",{href:n.url},void 0,n.username)),(0,i.Z)("div",{className:"user-card-title"},void 0,(0,i.Z)(f,{rank:a,title:n.title})),(0,i.Z)("div",{className:"user-card-stats"},void 0,(0,i.Z)(c,{showStatus:t,user:n}))))))}var g,b,y,_=n(15671),k=n(43144),N=n(79340),x=n(6215),w=n(61120),C=n(44039);var R,E=function(e){(0,N.Z)(o,e);var t,n,a=(t=o,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,a=(0,w.Z)(t);if(n){var i=(0,w.Z)(this).constructor;e=Reflect.construct(a,arguments,i)}else e=a.apply(this,arguments);return(0,x.Z)(this,e)});function o(){return(0,_.Z)(this,o),a.apply(this,arguments)}return(0,k.Z)(o,[{key:"shouldComponentUpdate",value:function(){return!1}},{key:"render",value:function(){return(0,i.Z)("div",{className:"panel user-card user-card-preview"},void 0,(0,i.Z)("div",{className:"panel-body"},void 0,(0,i.Z)("div",{className:"row"},void 0,g||(g=(0,i.Z)("div",{className:"col-xs-3 user-card-left"},void 0,(0,i.Z)("div",{className:"user-card-small-avatar"},void 0,(0,i.Z)("span",{},void 0,(0,i.Z)(r.ZP,{size:"50",size2x:"80"}))))),(0,i.Z)("div",{className:"col-xs-9 col-sm-12 user-card-body"},void 0,b||(b=(0,i.Z)("div",{className:"user-card-avatar"},void 0,(0,i.Z)("span",{},void 0,(0,i.Z)(r.ZP,{size:"150",size2x:"200"})))),(0,i.Z)("div",{className:"user-card-username"},void 0,(0,i.Z)("span",{className:"ui-preview-text",style:{width:C.e(60,150)+"px"}},void 0," ")),(0,i.Z)("div",{className:"user-card-title"},void 0,(0,i.Z)("span",{className:"ui-preview-text",style:{width:C.e(60,150)+"px"}},void 0," ")),(0,i.Z)("div",{className:"user-card-stats"},void 0,(0,i.Z)("ul",{className:"list-unstyled"},void 0,(0,i.Z)("li",{},void 0,(0,i.Z)("span",{className:"ui-preview-text",style:{width:C.e(30,70)+"px"}},void 0," ")),(0,i.Z)("li",{},void 0,(0,i.Z)("span",{className:"ui-preview-text",style:{width:C.e(30,70)+"px"}},void 0," ")),y||(y=(0,i.Z)("li",{className:"user-stat-divider"})),(0,i.Z)("li",{},void 0,(0,i.Z)("span",{className:"ui-preview-text",style:{width:C.e(30,70)+"px"}},void 0," ")),(0,i.Z)("li",{},void 0,(0,i.Z)("span",{className:"ui-preview-text",style:{width:C.e(30,70)+"px"}},void 0," "))))))))}}]),o}(s().Component);function S(e){var t=e.colClassName,n=e.cols,a=Array.apply(null,{length:n}).map(Number.call,Number);return(0,i.Z)("div",{className:"users-cards-list ui-preview"},void 0,(0,i.Z)("div",{className:"row"},void 0,a.map((function(e){var n=t;return 0!==e&&(n+=" hidden-xs"),3===e&&(n+=" hidden-sm"),(0,i.Z)("div",{className:n},e,R||(R=(0,i.Z)(E,{})))}))))}function O(e){var t=e.cols,n=e.isReady,a=e.showStatus,o=e.users,s="col-xs-12 col-sm-4";return 4===t&&(s+=" col-md-3"),n?(0,i.Z)("div",{className:"users-cards-list ui-ready"},void 0,(0,i.Z)("div",{className:"row"},void 0,o.map((function(e){return(0,i.Z)("div",{className:s},e.id,(0,i.Z)(Z,{showStatus:a,user:e}))})))):(0,i.Z)(S,{colClassName:s,cols:t})}},82125:(e,t,n)=>{"use strict";n.d(t,{Z:()=>d});var a=n(15671),i=n(43144),o=n(97326),s=n(79340),r=n(6215),l=n(61120),c=n(4942),u=n(57588);var d=function(e){(0,s.Z)(d,e);var t,n,u=(t=d,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,a=(0,l.Z)(t);if(n){var i=(0,l.Z)(this).constructor;e=Reflect.construct(a,arguments,i)}else e=a.apply(this,arguments);return(0,r.Z)(this,e)});function d(e){var t;return(0,a.Z)(this,d),t=u.call(this,e),(0,c.Z)((0,o.Z)(t),"toggleNav",(function(){t.setState({dropdown:!t.state.dropdown})})),(0,c.Z)((0,o.Z)(t),"hideNav",(function(){t.setState({dropdown:!1})})),t.state={dropdown:!1},t}return(0,i.Z)(d,[{key:"getCompactNavClassName",value:function(){return this.state.dropdown?"compact-nav open":"compact-nav"}}]),d}(n.n(u)().Component)},7227:(e,t,n)=>{"use strict";n.d(t,{Z:()=>p});var a=n(22928),i=n(15671),o=n(43144),s=n(97326),r=n(79340),l=n(6215),c=n(61120),u=n(4942),d=n(57588);var p=function(e){(0,r.Z)(p,e);var t,n,d=(t=p,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,a=(0,c.Z)(t);if(n){var i=(0,c.Z)(this).constructor;e=Reflect.construct(a,arguments,i)}else e=a.apply(this,arguments);return(0,l.Z)(this,e)});function p(){var e;(0,i.Z)(this,p);for(var t=arguments.length,n=new Array(t),a=0;a<t;a++)n[a]=arguments[a];return e=d.call.apply(d,[this].concat(n)),(0,u.Z)((0,s.Z)(e),"toggle",(function(){e.props.onChange({target:{value:!e.props.value}})})),e}return(0,o.Z)(p,[{key:"getClassName",value:function(){return this.props.value?"btn btn-yes-no btn-yes-no-on":"btn btn-yes-no btn-yes-no-off"}},{key:"getIcon",value:function(){return this.props.value?this.props.iconOn||"check_box":this.props.iconOff||"check_box_outline_blank"}},{key:"getLabel",value:function(){return this.props.value?this.props.labelOn||pgettext("yesno switch choice","yes"):this.props.labelOff||pgettext("yesno switch choice","no")}},{key:"render",value:function(){return(0,a.Z)("button",{type:"button",onClick:this.toggle,className:this.getClassName(),id:this.props.id||null,"aria-describedby":this.props["aria-describedby"]||null,disabled:this.props.disabled||!1},void 0,(0,a.Z)("span",{className:"material-icon"},void 0,this.getIcon()),(0,a.Z)("span",{className:"btn-text"},void 0,this.getLabel()))}}]),p}(n.n(d)().Component)},75557:(e,t,n)=>{"use strict";n.d(t,{SW:()=>_,ry:()=>v,xn:()=>N});var a=window.misago_locale||"en-us",i=pgettext("time ago","moment ago"),o=pgettext("time ago","now"),s=pgettext("day at time","%(day)s at %(time)s"),r=pgettext("day at time","Today at %(time)s"),l=pgettext("day at time","Tomorrow at %(time)s"),c=pgettext("day at time","Yesterday at %(time)s"),u=pgettext("short minutes","%(time)sm"),d=pgettext("short hours","%(time)sh"),p=pgettext("short days","%(time)sd"),h=new Intl.RelativeTimeFormat(a,{numeric:"always",style:"long"}),v=new Intl.DateTimeFormat(a,{dateStyle:"full",timeStyle:"medium"}),m=new Intl.DateTimeFormat(a,{month:"long",day:"numeric"}),f=new Intl.DateTimeFormat(a,{year:"numeric",month:"long",day:"numeric"}),Z=(new Intl.DateTimeFormat(a,{year:"2-digit",month:"short",day:"numeric"}),new Intl.DateTimeFormat(a,{weekday:"long"})),g=new Intl.DateTimeFormat(a,{timeStyle:"short"}),b=new Intl.DateTimeFormat(a,{month:"short",day:"numeric"}),y=new Intl.DateTimeFormat(a,{month:"short",year:"numeric"});function _(e){var t=new Date,n=Math.round((e-t)/1e3),a=Math.abs(n),o=n<1?-1:1;if(a<90)return i;if(a<2820){var u=Math.round(a/60)*o;return h.format(u,"minute")}if(a<10800){var d=Math.round(a/3600)*o;return h.format(d,"hour")}return k(t,e)?n>0?r.replace("%(time)s",g.format(e)):g.format(e):function(e){var t=new Date;return t.setDate(t.getDate()-1),k(t,e)}(e)?c.replace("%(time)s",g.format(e)):function(e){var t=new Date;return t.setDate(t.getDate()+1),k(t,e)}(e)?l.replace("%(time)s",g.format(e)):n<0&&a<518400?function(e,t){return s.replace("%(day)s",e).replace("%(time)s",g.format(t))}(Z.format(e),e):t.getFullYear()==e.getFullYear()?m.format(e):f.format(e)}function k(e,t){return e.getFullYear()==t.getFullYear()&&e.getMonth()==t.getMonth()&&e.getDate()==t.getDate()}function N(e){var t=new Date,n=Math.abs(Math.round((e-t)/1e3));if(n<60)return o;if(n<3300){var a=Math.round(n/60);return u.replace("%(time)s",a)}if(n<86400){var i=Math.round(n/3600);return d.replace("%(time)s",i)}if(n<604800){var s=Math.round(n/86400);return p.replace("%(time)s",s)}return e.getFullYear()===t.getFullYear()?b.format(e):y.format(e)}},15579:(e,t,n)=>{"use strict";n.d(t,{Z:()=>j});var a=n(15671),i=n(43144),o=(n(58294),n(95377),n(68852),n(39737),n(14316),n(43204),n(7023),n(94028)),s=n.n(o);const r=function(){function e(t){(0,a.Z)(this,e),this.isOrdered=!1,this._items=t||[]}return(0,i.Z)(e,[{key:"add",value:function(e,t,n){this._items.push({key:e,item:t,after:n&&n.after||null,before:n&&n.before||null})}},{key:"get",value:function(e,t){for(var n=0;n<this._items.length;n++)if(this._items[n].key===e)return this._items[n].item;return t}},{key:"has",value:function(e){return void 0!==this.get(e)}},{key:"values",value:function(){for(var e=[],t=0;t<this._items.length;t++)e.push(this._items[t].item);return e}},{key:"order",value:function(e){return this.isOrdered||(this._items=this._order(this._items),this.isOrdered=!0),e||void 0===e?this.values():this._items}},{key:"orderedValues",value:function(){return this.order(!0)}},{key:"_order",value:function(e){var t=[];e.forEach((function(e){t.push(e.key)}));var n=[],a=[];function i(e){var t=-1;-1===a.indexOf(e.key)&&(e.after?-1!==(t=a.indexOf(e.after))&&(t+=1):e.before&&(t=a.indexOf(e.before)),-1!==t&&(n.splice(t,0,e),a.splice(t,0,e.key)))}e.forEach((function(e){e.after||e.before||(n.push(e),a.push(e.key))})),e.forEach((function(e){"_end"===e.before&&(n.push(e),a.push(e.key))}));for(var o=200;o>0&&t.length!==a.length;)o-=1,e.forEach(i);return n}}]),e}();var l=n(4942);function c(e){var t=e.closest("[hx-silent]");return!t||"true"!==t.getAttribute("hx-silent")}const u=(0,i.Z)((function e(){var t=this;(0,a.Z)(this,e),(0,l.Z)(this,"show",(function(){t.requests+=1,t.update()})),(0,l.Z)(this,"hide",(function(){t.requests&&(t.requests-=1,t.update())})),(0,l.Z)(this,"update",(function(){t.timeout&&window.clearTimeout(t.timeout),t.requests?(t.element.classList.add("busy"),t.element.classList.remove("complete")):(t.element.classList.remove("busy"),t.element.classList.add("complete"),t.timeout=setTimeout((function(){t.element.classList.remove("complete")}),1500))})),this.element=document.getElementById("misago-ajax-loader"),this.requests=0,this.timeout=null}));var d=n(19755);const p=(0,i.Z)((function e(t){var n=this;(0,a.Z)(this,e),(0,l.Z)(this,"registerActions",(function(){n.actions.forEach((function(e){"remove-selection"===e.getAttribute("moderation-action")?e.addEventListener("click",n.onRemoveSelection):e.addEventListener("click",n.onAction)}))})),(0,l.Z)(this,"onAction",(function(e){var t=document.querySelector(n.form),a={};new FormData(t).forEach((function(e,t){void 0===a[t]&&(a[t]=[]),a[t].push(e)}));var i=e.target;a.moderation=i.getAttribute("moderation-action"),"true"===i.getAttribute("moderation-multistage")?s().ajax("POST",document.location.href,{target:n.modal,swap:"innerHTML",values:a}).then((function(){d(n.modal).modal("show")})):s().ajax("POST",document.location.href,{target:"#misago-htmx-root",swap:"outerHTML",values:a})})),(0,l.Z)(this,"onRemoveSelection",(function(e){document.querySelectorAll(n.selection).forEach((function(e){e.checked=!1})),n.update()})),(0,l.Z)(this,"registerEvents",(function(){document.body.addEventListener("click",(function(e){var t=e.target;"INPUT"===t.tagName&&"checkbox"===t.type&&n.update()})),s().onLoad((function(){return n.update()}))})),(0,l.Z)(this,"update",(function(){var e=document.querySelectorAll(n.selection).length;n.control.innerText=n.text.replace("%(number)s",e),n.control.disabled=!e,n.menu&&(e?n.menu.classList.add("visible"):n.menu.classList.remove("visible"))})),this.menu=t.menu?document.querySelector(t.menu):null,this.form=t.form,this.modal=t.modal,this.actions=document.querySelectorAll(t.actions),this.selection=t.selection,this.control=document.querySelector(t.button.selector),this.text=t.button.text,this.update(),this.registerEvents(),this.registerActions()}));var h=n(15861),v=n(64687),m=n.n(v),f={};function Z(e){if(!e.getAttribute("misago-validate-active")){var t=e.getAttribute("misago-validate"),n=e.getAttribute("misago-validate-user"),a="false"!=e.getAttribute("misago-validate-strip"),i=e.querySelector("input"),o=i.closest("form").querySelector("input[type=hidden]");if(t&&i){f[t]||(f[t]={}),e.setAttribute("misago-validate-active","true");var s=null;i.addEventListener("keyup",(function(r){var l=r.target.value;a&&(l=l.trim()),0!==l.trim().length?f[t][l]?g(e,i,f[t][l]):(s&&window.clearTimeout(s),s=window.setTimeout((0,h.Z)(m().mark((function a(){var s,r;return m().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,y(t,o,l,n);case 2:s=a.sent,r=s.errors,f[t][l]=r,g(e,i,r);case 6:case"end":return a.stop()}}),a)}))),1e3)):function(e){e.classList.remove("has-error"),e.classList.remove("has-success"),b(e)}(e)}))}}}function g(e,t,n){n.length?function(e,t,n){e.classList.remove("has-success"),e.classList.add("has-error"),b(e),n.forEach((function(e){var n=document.createElement("p");n.className="help-block",n.setAttribute("misago-dynamic-message","true"),n.innerText=e,t.after(n)}))}(e,t,n):function(e){e.classList.remove("has-error"),e.classList.add("has-success"),b(e)}(e)}function b(e){e.querySelectorAll("[misago-dynamic-message]").forEach((function(e){return e.remove()}))}function y(e,t,n,a){return _.apply(this,arguments)}function _(){return(_=(0,h.Z)(m().mark((function e(t,n,a,i){var o,s;return m().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(o=new FormData).set(n.name,n.value),o.set("value",a),i&&o.set("user",i),e.next=6,fetch(t,{method:"POST",mode:"cors",credentials:"same-origin",body:o});case 6:return s=e.sent,e.next=9,s.json();case 9:return e.abrupt("return",e.sent);case 10:case"end":return e.stop()}}),e)})))).apply(this,arguments)}s().onLoad((function(e){(e||document).querySelectorAll("[misago-validate]").forEach(Z)}));var k=document.getElementById("misago-snackbars"),N=null;function x(){k.replaceChildren()}function w(){N&&window.clearTimeout(N),k.querySelectorAll(".snackbar").forEach((function(e){e.classList.add("in")})),N=window.setTimeout((function(){k.querySelectorAll(".snackbar").forEach((function(e){e.classList.add("out"),N=window.setTimeout(x,1e3)}))}),6e3)}function C(e,t){x(),N&&window.clearTimeout(N);var n=document.createElement("div");n.classList.add("snackbar"),n.classList.add("snackbar-"+e),n.innerText=t,n.role="alert",k.appendChild(n),N=window.setTimeout(w,100)}function R(e){C("danger",e)}function E(e){var t,n,a=e.detail;return!("true"===(t=a.target,n=t.closest("[hx-silent]"),n?n.getAttribute("hx-silent"):null)&&"get"===a.requestConfig.verb)}s().onLoad(w),document.addEventListener("htmx:responseError",(function(e){E(e)&&R(function(e){if("application/json"===e.getResponseHeader("content-type")){var t=JSON.parse(e.response);if(t.error)return t.error}return 404===e.status?pgettext("htmx response error","Page not found"):403===e.status?pgettext("htmx response error","Permission denied"):pgettext("htmx response error","Unexpected error")}(e.detail.xhr))})),document.addEventListener("htmx:sendError",(function(e){E(e)&&R(pgettext("htmx response error","Site could not be reached."))})),document.addEventListener("htmx:timeout",(function(e){E(e)&&R(pgettext("htmx response error","Site took too long to reply"))}));var S=n(75557),O={};function L(e){var t=e.getAttribute("misago-timestamp");O[t]||(O[t]=new Date(t)),e.hasAttribute("misago-timestamp-title")||(e.setAttribute("misago-timestamp-title","true"),e.setAttribute("title",S.ry.format(O[t])));var n=e.getAttribute("misago-timestamp-format");e.textContent="short"==n?(0,S.xn)(O[t]):(0,S.SW)(O[t])}function P(e){(e||document).querySelectorAll("[misago-timestamp]").forEach(L)}document.querySelectorAll("[misago-timestamp]").forEach(L),P(),window.setInterval(P,55e3),s().onLoad(P);var T=n(19755);s().onLoad((function(){document.querySelectorAll("[misago-page-form]").forEach((function(e){var t;""===e.getAttribute("misago-page-form")&&((t=e).setAttribute("misago-page-form","true"),t.addEventListener("submit",(function(e){var n=t.getAttribute("misago-page"),a=e.target.querySelector("input"),i=a.value;if(i>=a.min&&i<=a.max&&i!=n){var o=t.getAttribute("misago-page-url");i>1&&(o+=i+"/"),window.history.pushState({},"",o),document.getElementById("misago-page-scroll-target").scrollIntoView(),s().ajax("GET",o,{target:"#misago-htmx-root",swap:"outerHTML"})}return t.closest(".dropdown").querySelector("[data-toggle]")&&T().dropdown("toggle"),e.preventDefault(),!1})))}))}));var A=n(19755),I=new u,B=new(function(){function e(){(0,a.Z)(this,e),this._initializers=[],this._context={},this.loader=I}return(0,i.Z)(e,[{key:"addInitializer",value:function(e){this._initializers.push({key:e.name,item:e.initializer,after:e.after,before:e.before})}},{key:"init",value:function(e){var t=this;this._context=e,new r(this._initializers).orderedValues().forEach((function(e){e(t)}))}},{key:"has",value:function(e){return!!this._context[e]}},{key:"get",value:function(e,t){return this.has(e)?this._context[e]:t||void 0}},{key:"pop",value:function(e){if(this.has(e)){var t=this._context[e];return this._context[e]=null,t}}},{key:"snackbar",value:function(e,t){C(e,t)}},{key:"snackbarInfo",value:function(e){!function(e){C("info",e)}(e)}},{key:"snackbarSuccess",value:function(e){!function(e){C("success",e)}(e)}},{key:"snackbarWarning",value:function(e){!function(e){C("warning",e)}(e)}},{key:"snackbarError",value:function(e){R(e)}},{key:"bulkModeration",value:function(e){return new p(e)}}]),e}());window.misago=B;const j=B;document.addEventListener("htmx:beforeRequest",(function(e){c(e.target)&&I.show()})),document.addEventListener("htmx:afterRequest",(function(e){c(e.target)&&I.hide()})),document.addEventListener("misago:afterModeration",(function(){A("#threads-moderation-modal").modal("hide")}))},58339:(e,t,n)=>{"use strict";var a=n(15579),i=n(78657);a.Z.addInitializer({name:"ajax",initializer:function(){i.Z.init(a.Z.get("CSRF_COOKIE_NAME"))}})},64109:(e,t,n)=>{"use strict";var a=n(15579),i=n(35486),o=n(78657),s=n(53904),r=n(90287);a.Z.addInitializer({name:"auth-sync",initializer:function(e){e.get("isAuthenticated")&&window.setInterval((function(){o.Z.get(e.get("AUTH_API")).then((function(e){r.Z.dispatch((0,i.r$)(e))}),(function(e){s.Z.apiError(e)}))}),45e3)},after:"auth"})},46226:(e,t,n)=>{"use strict";var a=n(15579),i=n(98274),o=n(59801),s=n(90287),r=n(62833);a.Z.addInitializer({name:"auth",initializer:function(){i.Z.init(s.Z,r.Z,o.Z)},after:"store"})},93240:(e,t,n)=>{"use strict";var a=n(15579),i=n(78657),o=n(93825),s=n(96142),r=n(53904);a.Z.addInitializer({name:"captcha",initializer:function(e){o.ZP.init(e,i.Z,s.Z,r.Z)}})},75147:(e,t,n)=>{"use strict";var a=n(22928),i=n(57588),o=n.n(i),s=n(15579),r=n(15671),l=n(43144),c=n(97326),u=n(79340),d=n(6215),p=n(61120),h=n(4942),v=n(78657);var m=function(e){(0,u.Z)(o,e);var t,n,i=(t=o,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,a=(0,p.Z)(t);if(n){var i=(0,p.Z)(this).constructor;e=Reflect.construct(a,arguments,i)}else e=a.apply(this,arguments);return(0,d.Z)(this,e)});function o(e){var t;return(0,r.Z)(this,o),t=i.call(this,e),(0,h.Z)((0,c.Z)(t),"handleDecline",(function(){t.state.submiting||window.confirm(pgettext("accept agreement prompt","Declining will result in immediate deactivation and deletion of your account. This action is not reversible."))&&(t.setState({submiting:!0}),v.Z.post(t.props.api,{accept:!1}).then((function(){window.location.reload(!0)})))})),(0,h.Z)((0,c.Z)(t),"handleAccept",(function(){t.state.submiting||(t.setState({submiting:!0}),v.Z.post(t.props.api,{accept:!0}).then((function(){window.location.reload(!0)})))})),t.state={submiting:!1},t}return(0,l.Z)(o,[{key:"render",value:function(){return(0,a.Z)("div",{},void 0,(0,a.Z)("button",{className:"btn btn-default",disabled:this.state.submiting,type:"buton",onClick:this.handleDecline},void 0,pgettext("accept agreement choice","Decline")),(0,a.Z)("button",{className:"btn btn-primary",disabled:this.state.submiting,type:"buton",onClick:this.handleAccept},void 0,pgettext("accept agreement choice","Accept and continue")))}}]),o}(o().Component),f=n(4869);s.Z.addInitializer({name:"component:accept-agreement",initializer:function(e){document.getElementById("required-agreement-mount")&&(0,f.Z)((0,a.Z)(m,{api:e.get("REQUIRED_AGREEMENT_API")}),"required-agreement-mount",!1)},after:"store"})},4894:(e,t,n)=>{"use strict";var a=n(37424),i=n(15579),o=n(22928),s=n(15671),r=n(43144),l=n(79340),c=n(6215),u=n(61120),d=n(57588);var p=function(e){(0,l.Z)(i,e);var t,n,a=(t=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,a=(0,u.Z)(t);if(n){var i=(0,u.Z)(this).constructor;e=Reflect.construct(a,arguments,i)}else e=a.apply(this,arguments);return(0,c.Z)(this,e)});function i(){return(0,s.Z)(this,i),a.apply(this,arguments)}return(0,r.Z)(i,[{key:"refresh",value:function(){window.location.reload()}},{key:"getMessage",value:function(){return this.props.signedIn?interpolate(pgettext("auth message","You have signed in as %(username)s. Please refresh the page before continuing."),{username:this.props.signedIn.username},!0):this.props.signedOut?interpolate(pgettext("auth message","%(username)s, you have been signed out. Please refresh the page before continuing."),{username:this.props.user.username},!0):void 0}},{key:"render",value:function(){var e="auth-message";return(this.props.signedIn||this.props.signedOut)&&(e+=" show"),(0,o.Z)("div",{className:e},void 0,(0,o.Z)("div",{className:"container"},void 0,(0,o.Z)("p",{className:"lead"},void 0,this.getMessage()),(0,o.Z)("p",{},void 0,(0,o.Z)("button",{className:"btn btn-default",type:"button",onClick:this.refresh},void 0,pgettext("auth message","Reload page")),(0,o.Z)("span",{className:"hidden-xs hidden-sm"},void 0," "+pgettext("auth message","or press F5 key.")))))}}]),i}(n.n(d)().Component);function h(e){return{user:e.auth.user,signedIn:e.auth.signedIn,signedOut:e.auth.signedOut}}var v=n(4869);i.Z.addInitializer({name:"component:auth-message",initializer:function(){(0,v.Z)((0,a.$j)(h)(p),"auth-message-mount")},after:"store"})},29223:(e,t,n)=>{"use strict";var a=n(15579),i=n(93051);a.Z.addInitializer({name:"component:banmed-page",initializer:function(e){e.has("BAN_MESSAGE")&&(0,i.Z)(e.get("BAN_MESSAGE"),!1)},after:"store"})},73806:(e,t,n)=>{"use strict";var a,i=n(22928),o=n(57588),s=n.n(o),r=n(73935),l=n.n(r),c=n(37424),u=n(993),d=n(40689),p=n(80261),h=n(15671),v=n(43144),m=n(79340),f=n(6215),Z=n(61120),g=n(59801),b=n(14467);const y=function(e){(0,m.Z)(s,e);var t,n,o=(t=s,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,a=(0,Z.Z)(t);if(n){var i=(0,Z.Z)(this).constructor;e=Reflect.construct(a,arguments,i)}else e=a.apply(this,arguments);return(0,f.Z)(this,e)});function s(){return(0,h.Z)(this,s),o.apply(this,arguments)}return(0,v.Z)(s,[{key:"componentDidMount",value:function(){"?modal=login"===window.document.location.search&&window.setTimeout((function(){return g.Z.show(a||(a=(0,i.Z)(b.Z,{})))}),300)}},{key:"render",value:function(){return null}}]),s}(s().Component);function _(e){var t=e.logo,n=e.logoXs,a=e.text,o=e.url;return t?(0,i.Z)("div",{className:"navbar-branding"},void 0,(0,i.Z)("a",{href:o,className:"navbar-branding-logo"},void 0,(0,i.Z)("img",{src:t,alt:a}))):(0,i.Z)("div",{className:"navbar-branding"},void 0,!!n&&(0,i.Z)("a",{href:o,className:"navbar-branding-logo-xs"},void 0,(0,i.Z)("img",{src:n,alt:a})),!!a&&(0,i.Z)("a",{href:o,className:"navbar-branding-text"},void 0,a))}function k(e){var t=e.items;return(0,i.Z)("ul",{className:"navbar-extra-menu",role:"nav"},void 0,t.map((function(e,t){return(0,i.Z)("li",{className:e.className},t,(0,i.Z)("a",{href:e.url,target:e.targetBlank?"_blank":null,rel:e.rel},void 0,e.title))})))}var N,x=n(49021),w=n(97326),C=n(4942),R=n(63026),E=n(66462),S=n(94184),O=n.n(S);function L(e){var t=e.children,n=e.showAll,a=e.showUnread,o=e.unread;return(0,i.Z)("div",{className:"notifications-dropdown-body"},void 0,(0,i.Z)(x.Aw,{},void 0,pgettext("notifications title","Notifications")),(0,i.Z)(x.KE,{},void 0,(0,i.Z)(P,{active:!o,onClick:n},void 0,pgettext("notifications dropdown","All")),(0,i.Z)(P,{active:o,onClick:a},void 0,pgettext("notifications dropdown","Unread"))),t,(0,i.Z)(x.kE,{},void 0,(0,i.Z)("a",{className:"btn btn-default btn-block",href:misago.get("NOTIFICATIONS_URL")},void 0,pgettext("notifications","See all notifications"))))}function P(e){var t=e.active,n=e.children,a=e.onClick;return(0,i.Z)("button",{className:O()("btn",{"btn-primary":t,"btn-default":!t}),type:"button",onClick:a},void 0,n)}const T=function(e){(0,m.Z)(o,e);var t,n,a=(t=o,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,a=(0,Z.Z)(t);if(n){var i=(0,Z.Z)(this).constructor;e=Reflect.construct(a,arguments,i)}else e=a.apply(this,arguments);return(0,f.Z)(this,e)});function o(e){var t;return(0,h.Z)(this,o),t=a.call(this,e),(0,C.Z)((0,w.Z)(t),"render",(function(){return(0,i.Z)(L,{unread:t.state.unread,showAll:function(){return t.setState({unread:!1})},showUnread:function(){return t.setState({unread:!0})}},void 0,(0,i.Z)(R.Z,{filter:t.state.unread?"unread":"all",disabled:!t.props.active},void 0,(function(e){var n=e.data,a=e.loading,o=e.error;return a?N||(N=(0,i.Z)(E.Pu,{})):o?(0,i.Z)(E.lb,{error:o}):(0,i.Z)(E.uE,{filter:t.state.unread?"unread":"all",items:n?n.results:[]})})))})),t.state={unread:!1,url:""},t}return(0,v.Z)(o,[{key:"getApiUrl",value:function(){return misago.get("NOTIFICATIONS_API")+"?limit=20"+(this.state.unread?"&filter=unread":"")}}]),o}(s().Component);function A(e){var t=e.id,n=e.className,a=e.badge,o=e.url,s=e.active,r=e.onClick,l=a?pgettext("navbar","You have unread notifications!"):pgettext("navbar","Open notifications");return(0,i.Z)("a",{id:t,className:O()("btn btn-navbar-icon",n,{active:s}),href:o,title:l,onClick:r},void 0,!!a&&(0,i.Z)("span",{className:"navbar-item-badge"},void 0,a),(0,i.Z)("span",{className:"material-icon"},void 0,a?"notifications_active":"notifications_none"))}function I(e){var t=e.id,n=e.className,a=e.badge,o=e.url;return(0,i.Z)(x.Lt,{id:t,toggle:function(e){var t=e.isOpen,s=e.toggle;return(0,i.Z)(A,{className:n,active:t,badge:a,url:o,onClick:function(e){e.preventDefault(),s()}})},menuClassName:"notifications-dropdown",menuAlignRight:!0},void 0,(function(e){var t=e.isOpen;return(0,i.Z)(T,{active:t})}))}var B;function j(e){var t=e.id,n=e.className,a=e.badge,o=e.url,s=e.active,r=e.onClick,l=a?pgettext("navbar","You have unread private threads!"):pgettext("navbar","Open private threads");return(0,i.Z)("a",{id:t,className:O()("btn btn-navbar-icon",n,{active:s}),href:o,title:l,onClick:r},void 0,!!a&&(0,i.Z)("span",{className:"navbar-item-badge"},void 0,a),B||(B=(0,i.Z)("span",{className:"material-icon"},void 0,"inbox")))}var D,z,U,q=n(62989);function M(e){var t=e.id,n=e.className,a=e.url,o=e.active,s=e.onClick;return(0,i.Z)("a",{id:t,className:O()("btn btn-navbar-icon",n,{active:o}),href:a,title:pgettext("navbar","Open search"),onClick:s},void 0,D||(D=(0,i.Z)("span",{className:"material-icon"},void 0,"search")))}function F(e){var t=e.id,n=e.className,a=e.url;return(0,i.Z)(x.Lt,{id:t,toggle:function(e){var t=e.isOpen,o=e.toggle;return(0,i.Z)(M,{className:n,active:t,url:a,onClick:function(e){e.preventDefault(),o(),window.setTimeout((function(){document.querySelector(".search-dropdown .form-control-search").focus()}),0)}})},menuClassName:"search-dropdown",menuAlignRight:!0},void 0,(function(){return z||(z=(0,i.Z)(q.E,{}))}))}function H(e){var t=e.id,n=e.className,a=e.active,o=e.onClick;return(0,i.Z)("button",{id:t,className:O()("btn btn-navbar-icon",n,{active:a}),title:pgettext("navbar","Open menu"),type:"button",onClick:o},void 0,U||(U=(0,i.Z)("span",{className:"material-icon"},void 0,"menu")))}var V=n(6333);function Y(e){var t=e.id,n=e.className;return(0,i.Z)(x.Lt,{id:t,toggle:function(e){var t=e.isOpen,a=e.toggle;return(0,i.Z)(H,{className:n,active:t,onClick:a})},menuClassName:"site-nav-dropdown",menuAlignRight:!0},void 0,(function(e){e.isOpen;var t=e.close;return(0,i.Z)(V.bS,{close:t})}))}var G=n(19605);function $(e){var t=e.id,n=e.className,a=e.user,o=e.active,s=e.onClick;return(0,i.Z)("a",{id:t,className:O()("btn-navbar-image",n,{active:o}),href:a.url,title:pgettext("navbar","Open your options"),onClick:s},void 0,(0,i.Z)(G.ZP,{user:a,size:34}))}var W,Q,K,X,J=n(28166);function ee(e){var t=e.id,n=e.className,a=e.user;return(0,i.Z)(x.Lt,{id:t,toggle:function(e){var t=e.isOpen,o=e.toggle;return(0,i.Z)($,{className:n,active:t,user:a,onClick:function(e){e.preventDefault(),o()}})},menuClassName:"user-nav-dropdown",menuAlignRight:!0},void 0,(function(e){e.isOpen;var t=e.close;return(0,i.Z)(J.o4,{close:t})}))}const te=(0,c.$j)((function(e){var t=misago.get("SETTINGS"),n=e.auth.user;return{branding:{logo:t.logo,logoXs:t.logo_small,text:t.logo_text,url:misago.get("MISAGO_PATH")},extraMenuItems:misago.get("extraMenuItems"),user:n.id?{id:n.id,username:n.username,email:n.email,avatars:n.avatars,unreadNotifications:n.unreadNotifications,unreadPrivateThreads:n.unread_private_threads,url:n.url}:null,searchUrl:misago.get("SEARCH_URL"),notificationsUrl:misago.get("NOTIFICATIONS_URL"),privateThreadsUrl:misago.get("PRIVATE_THREADS_URL"),authDelegated:t.enable_oauth2_client,showSearch:!!n.acl.can_search,showPrivateThreads:!!n&&!!n.acl.can_use_private_threads}}))((function(e){var t=e.dispatch,n=e.branding,a=e.extraMenuItems,o=e.authDelegated,r=e.user,l=e.searchUrl,c=e.notificationsUrl,h=e.privateThreadsUrl,v=e.showSearch,m=e.showPrivateThreads;return(0,i.Z)("div",{className:"container navbar-container"},void 0,s().createElement(_,n),(0,i.Z)("div",{className:"navbar-right"},void 0,a.length>0&&(0,i.Z)(k,{items:a}),!!v&&(0,i.Z)(F,{id:"navbar-search-dropdown",url:l}),!!v&&(0,i.Z)(M,{id:"navbar-search-overlay",url:l,onClick:function(e){t(u.UL()),e.preventDefault()}}),W||(W=(0,i.Z)(Y,{id:"navbar-site-nav-dropdown"})),(0,i.Z)(H,{id:"navbar-site-nav-overlay",onClick:function(){t(u.AU())}}),!!m&&(0,i.Z)(j,{id:"navbar-private-threads",badge:r.unreadPrivateThreads,url:h}),!!r&&(0,i.Z)(I,{id:"navbar-notifications-dropdown",badge:r.unreadNotifications,url:c}),!!r&&(0,i.Z)(A,{id:"navbar-notifications-overlay",badge:r.unreadNotifications,url:c,onClick:function(e){t(u.hN()),e.preventDefault()}}),!!r&&(0,i.Z)(ee,{id:"navbar-user-nav-dropdown",user:r}),!!r&&(0,i.Z)($,{id:"navbar-user-nav-overlay",user:r,onClick:function(e){t(u.T5()),e.preventDefault()}}),!r&&(Q||(Q=(0,i.Z)(p.Z,{className:"btn-navbar-sign-in"}))),!r&&!o&&(K||(K=(0,i.Z)(d.Z,{className:"btn-navbar-register"}))),!r&&!o&&(X||(X=(0,i.Z)(y,{})))))}));var ne,ae=n(90287);misago.addInitializer({name:"component:navbar",initializer:function(e){var t=document.getElementById("misago-navbar");l().render((0,i.Z)(c.zt,{store:ae.Z.getStore()},void 0,ne||(ne=(0,i.Z)(te,{}))),t)},after:"store"})},27015:(e,t,n)=>{"use strict";var a,i=n(22928),o=n(57588),s=n.n(o),r=n(73935),l=n.n(r),c=n(37424),u=n(15671),d=n(43144),p=n(97326),h=n(79340),v=n(6215),m=n(61120),f=n(4942),Z=n(63026),g=n(66462),b=n(94184),y=n.n(b),_=n(49021),k=n(64836);function N(e){var t=e.children,n=e.open,a=e.showAll,o=e.showUnread,s=e.unread;return(0,i.Z)(k.a,{open:n},void 0,(0,i.Z)(k.i,{},void 0,pgettext("notifications title","Notifications")),(0,i.Z)(_.KE,{},void 0,(0,i.Z)(x,{active:!s,onClick:a},void 0,pgettext("notifications dropdown","All")),(0,i.Z)(x,{active:s,onClick:o},void 0,pgettext("notifications dropdown","Unread"))),t,(0,i.Z)(_.kE,{},void 0,(0,i.Z)("a",{className:"btn btn-default btn-block",href:misago.get("NOTIFICATIONS_URL")},void 0,pgettext("notifications","See all notifications"))))}function x(e){var t=e.active,n=e.children,a=e.onClick;return(0,i.Z)("button",{className:y()("btn",{"btn-primary":t,"btn-default":!t}),type:"button",onClick:a},void 0,n)}var w=function(e){(0,h.Z)(s,e);var t,n,o=(t=s,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,a=(0,m.Z)(t);if(n){var i=(0,m.Z)(this).constructor;e=Reflect.construct(a,arguments,i)}else e=a.apply(this,arguments);return(0,v.Z)(this,e)});function s(e){var t;return(0,u.Z)(this,s),t=o.call(this,e),(0,f.Z)((0,p.Z)(t),"render",(function(){return(0,i.Z)(N,{open:t.props.open,unread:t.state.unread,showAll:function(){return t.setState({unread:!1})},showUnread:function(){return t.setState({unread:!0})}},void 0,(0,i.Z)(Z.Z,{filter:t.state.unread?"unread":"all",disabled:!t.props.open},void 0,(function(e){var n=e.data,o=e.loading,s=e.error;return o?a||(a=(0,i.Z)(g.Pu,{})):s?(0,i.Z)(g.lb,{error:s}):(0,i.Z)(g.uE,{filter:t.state.unread?"unread":"all",items:n?n.results:[]})})))})),t.body=document.body,t.state={unread:!1,url:""},t}return(0,d.Z)(s,[{key:"getApiUrl",value:function(){return misago.get("NOTIFICATIONS_API")+"?limit=20"+(this.state.unread?"&filter=unread":"")}},{key:"componentDidUpdate",value:function(e,t){e.open!==this.props.open&&(this.props.open?this.body.classList.add("notifications-fullscreen"):this.body.classList.remove("notifications-fullscreen"))}}]),s}(s().Component);const C=(0,c.$j)((function(e){return{open:e.overlay.notifications}}))(w);var R,E=n(90287);misago.addInitializer({name:"component:notifications-overlay",initializer:function(e){if(e.get("isAuthenticated")){var t=document.getElementById("notifications-mount");l().render((0,i.Z)(c.zt,{store:E.Z.getStore()},void 0,R||(R=(0,i.Z)(C,{}))),t)}},after:"store"})},88097:(e,t,n)=>{"use strict";var a=n(22928),i=n(57588),o=n.n(i),s=n(73935),r=n.n(s),l=n(37424),c=n(69987),u=n(99755);function d(){return(0,a.Z)(u.Iv,{header:pgettext("notifications title","Notifications"),styleName:"notifications"})}var p=n(87462),h=n(15861),v=n(64687),m=n.n(v),f=n(35486),Z=n(53904),g=n(60642),b=n(63026);const y=function(e){var t=e.title,n=e.subtitle,a=[];return n&&a.push(n),t&&a.push(t),a.push(misago.get("SETTINGS").forum_name),document.title=a.join(" | "),null};var _=n(59131),k=n(66462);function N(e){var t=e.children;return(0,a.Z)("ul",{className:"nav nav-pills"},void 0,t)}var x=n(94184),w=n.n(x);function C(e){var t=e.active,n=e.link,i=e.icon,o=e.children;return(0,a.Z)("li",{className:w()({active:t})},void 0,(0,a.Z)(c.rU,{to:n,activeClassName:""},void 0,!!i&&(0,a.Z)("span",{className:"material-icon"},void 0,i),o))}var R=n(92490);function E(e){var t=e.filter,n=misago.get("NOTIFICATIONS_URL");return(0,a.Z)(R.o8,{},void 0,(0,a.Z)(R.Z2,{auto:!0},void 0,(0,a.Z)(R.Eg,{},void 0,(0,a.Z)(N,{},void 0,(0,a.Z)(C,{active:"all"===t,link:n},void 0,pgettext("notifications nav","All")),(0,a.Z)(C,{active:"unread"===t,link:n+"unread/"},void 0,pgettext("notifications nav","Unread")),(0,a.Z)(C,{active:"read"===t,link:n+"read/"},void 0,pgettext("notifications nav","Read"))))))}var S,O,L,P=n(82211);function T(e){var t=e.baseUrl,n=e.data,i=e.disabled;return(0,a.Z)("div",{className:"misago-pagination"},void 0,(0,a.Z)(A,{url:t,disabled:i||!n||!n.hasPrevious},void 0,pgettext("notifications pagination","Latest")),(0,a.Z)(A,{url:t+"?before="+(n?n.firstCursor:""),disabled:i||!n||!n.hasPrevious},void 0,pgettext("notifications pagination","Newer")),(0,a.Z)(A,{url:t+"?after="+(n?n.lastCursor:""),disabled:i||!n||!n.hasNext},void 0,pgettext("notifications pagination","Older")))}function A(e){var t=e.disabled,n=e.children,i=e.url;return t?(0,a.Z)("button",{className:"btn btn-default",type:"disabled",disabled:!0},void 0,n):(0,a.Z)(c.rU,{to:i,className:"btn btn-default",activeClassName:""},void 0,n)}function I(e){var t=e.baseUrl,n=e.data,i=e.disabled,o=e.bottom,s=e.markAllAsRead;return(0,a.Z)(R.o8,{},void 0,(0,a.Z)(R.Z2,{},void 0,(0,a.Z)(R.Eg,{},void 0,(0,a.Z)(T,{baseUrl:t,data:n,disabled:i}))),S||(S=(0,a.Z)(R.tw,{})),(0,a.Z)(R.Z2,{className:w()({"hidden-xs":!o})},void 0,(0,a.Z)(R.Eg,{},void 0,(0,a.Z)(P.Z,{className:"btn-default btn-block",type:"button",disabled:i||!n||!n.unreadNotifications,onClick:s},void 0,O||(O=(0,a.Z)("span",{className:"material-icon"},void 0,"done_all")),pgettext("notifications","Mark all as read")))))}function B(e){return"unread"===e?pgettext("notifications title","Unread notifications"):"read"===e?pgettext("notifications title","Read notifications"):null}const j=(0,l.$j)()((function(e){var t=e.dispatch,n=e.location,i=e.route,s=n.query,r=i.props.filter,l=function(e){var t=misago.get("NOTIFICATIONS_URL");return"all"!==e&&(t+=e+"/"),t}(r);return(0,a.Z)(_.Z,{},void 0,(0,a.Z)(y,{title:pgettext("notifications title","Notifications"),subtitle:B(r)}),(0,a.Z)(E,{filter:r}),(0,a.Z)(b.Z,{filter:r,query:s},void 0,(function(e){var n,i=e.data,c=e.loading,u=e.error,d=e.refetch;return(0,a.Z)(g.D,{url:misago.get("NOTIFICATIONS_API")+"read-all/"},void 0,(function(e,v){var g,b=v.loading,y={baseUrl:l,data:i,disabled:c||b||!i||0===i.results.length,markAllAsRead:(g=(0,h.Z)(m().mark((function n(){return m().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:window.confirm(pgettext("notifications","Mark all notifications as read?"))&&e({onSuccess:function(){var e=(0,h.Z)(m().mark((function e(){return m().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:d(),t((0,f.yH)({unreadNotifications:null})),Z.Z.success(pgettext("notifications","All notifications have been marked as read."));case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),onError:Z.Z.apiError});case 2:case"end":return n.stop()}}),n)}))),function(){return g.apply(this,arguments)})};return c||b?(0,a.Z)("div",{},void 0,o().createElement(I,y),L||(L=(0,a.Z)(k.Pu,{})),o().createElement(I,(0,p.Z)({},y,{bottom:!0}))):u?(0,a.Z)("div",{},void 0,o().createElement(I,y),n||(n=(0,a.Z)(k.lb,{error:u})),o().createElement(I,(0,p.Z)({},y,{bottom:!0}))):i?(!i.hasPrevious&&s&&window.history.replaceState({},"",l),(0,a.Z)("div",{},void 0,o().createElement(I,y),(0,a.Z)(k.uE,{filter:r,items:i.results,hasNext:i.hasNext,hasPrevious:i.hasPrevious}),o().createElement(I,(0,p.Z)({},y,{bottom:!0})))):null}))})))}));var D;n(4517);const z=function(){var e=misago.get("NOTIFICATIONS_URL");return(0,a.Z)("div",{className:"page page-notifications"},void 0,D||(D=(0,a.Z)(d,{})),(0,a.Z)(c.F0,{history:c.mW,routes:[{path:e,component:j,props:{filter:"all"}},{path:e+"unread/",component:j,props:{filter:"unread"}},{path:e+"read/",component:j,props:{filter:"read"}}]}))};var U,q=n(90287);misago.addInitializer({name:"component:notifications",initializer:function(e){var t=misago.get("NOTIFICATIONS_URL");if(document.location.pathname.startsWith(t)&&!document.location.pathname.startsWith(t+"disable-email/")&&e.get("isAuthenticated")){var n=document.getElementById("page-mount");r().render((0,a.Z)(l.zt,{store:q.Z.getStore()},void 0,U||(U=(0,a.Z)(z,{}))),n)}},after:"store"})},46016:(e,t,n)=>{"use strict";var a,i=n(37424),o=n(22928),s=n(15671),r=n(43144),l=n(97326),c=n(79340),u=n(6215),d=n(61120),p=n(4942),h=n(57588),v=n.n(h),m=n(30381),f=n.n(m),Z=n(37848);var g,b=function(e){(0,c.Z)(l,e);var t,n,i=(t=l,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,a=(0,d.Z)(t);if(n){var i=(0,d.Z)(this).constructor;e=Reflect.construct(a,arguments,i)}else e=a.apply(this,arguments);return(0,u.Z)(this,e)});function l(){return(0,s.Z)(this,l),i.apply(this,arguments)}return(0,r.Z)(l,[{key:"render",value:function(){return a||(a=(0,o.Z)("div",{className:"panel-body panel-body-loading"},void 0,(0,o.Z)(Z.Z,{className:"loader loader-spaced"})))}}]),l}(v().Component),y=n(33556),_=n(15579),k=n(55547),N=n(53328);var x,w=function(e){(0,c.Z)(i,e);var t,n,a=(t=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,a=(0,d.Z)(t);if(n){var i=(0,d.Z)(this).constructor;e=Reflect.construct(a,arguments,i)}else e=a.apply(this,arguments);return(0,u.Z)(this,e)});function i(e){var t;return(0,s.Z)(this,i),t=a.call(this,e),(0,p.Z)((0,l.Z)(t),"update",(function(e){e.expires_on&&(e.expires_on=f()(e.expires_on)),t.setState({isLoaded:!0,error:null,ban:e})})),(0,p.Z)((0,l.Z)(t),"error",(function(e){t.setState({isLoaded:!0,error:e.detail,ban:null})})),_.Z.has("PROFILE_BAN")?t.initWithPreloadedData(_.Z.pop("PROFILE_BAN")):t.initWithoutPreloadedData(),t.startPolling(e.profile.api.ban),t}return(0,r.Z)(i,[{key:"initWithPreloadedData",value:function(e){e.expires_on&&(e.expires_on=f()(e.expires_on)),this.state={isLoaded:!0,ban:e}}},{key:"initWithoutPreloadedData",value:function(){this.state={isLoaded:!1}}},{key:"startPolling",value:function(e){k.Z.start({poll:"ban-details",url:e,frequency:9e4,update:this.update,error:this.error})}},{key:"componentDidMount",value:function(){N.Z.set({title:pgettext("profile ban details title","Ban details"),parent:this.props.profile.username})}},{key:"componentWillUnmount",value:function(){k.Z.stop("ban-details")}},{key:"getUserMessage",value:function(){return this.state.ban.user_message?(0,o.Z)("div",{className:"panel-body ban-message ban-user-message"},void 0,(0,o.Z)("h4",{},void 0,pgettext("profile ban details","User-shown ban message")),(0,o.Z)("div",{className:"lead",dangerouslySetInnerHTML:{__html:this.state.ban.user_message.html}})):null}},{key:"getStaffMessage",value:function(){return this.state.ban.staff_message?(0,o.Z)("div",{className:"panel-body ban-message ban-staff-message"},void 0,(0,o.Z)("h4",{},void 0,pgettext("profile ban details","Team-shown ban message")),(0,o.Z)("div",{className:"lead",dangerouslySetInnerHTML:{__html:this.state.ban.staff_message.html}})):null}},{key:"getExpirationMessage",value:function(){if(this.state.ban.expires_on){if(this.state.ban.expires_on.isAfter(f()())){var e=interpolate(pgettext("profile ban details","This ban expires on %(expires_on)s."),{expires_on:this.state.ban.expires_on.format("LL, LT")},!0),t=interpolate(pgettext("profile ban details","This ban expires %(expires_on)s."),{expires_on:this.state.ban.expires_on.fromNow()},!0);return(0,o.Z)("abbr",{title:e},void 0,t)}return pgettext("profile ban details","This ban has expired.")}return interpolate(pgettext("profile ban details","%(username)s's ban is permanent."),{username:this.props.profile.username},!0)}},{key:"getPanelBody",value:function(){return this.state.ban?Object.keys(this.state.ban).length?(0,o.Z)("div",{},void 0,this.getUserMessage(),this.getStaffMessage(),(0,o.Z)("div",{className:"panel-body ban-expires"},void 0,(0,o.Z)("h4",{},void 0,pgettext("profile ban details","Ban expiration")),(0,o.Z)("p",{className:"lead"},void 0,this.getExpirationMessage()))):(0,o.Z)("div",{},void 0,(0,o.Z)(y.Z,{message:pgettext("profile ban details","No ban is active at the moment.")})):this.state.error?(0,o.Z)("div",{},void 0,(0,o.Z)(y.Z,{icon:"error_outline",message:this.state.error})):g||(g=(0,o.Z)("div",{},void 0,(0,o.Z)(b,{})))}},{key:"render",value:function(){return(0,o.Z)("div",{className:"profile-ban-details"},void 0,(0,o.Z)("div",{className:"panel panel-default"},void 0,(0,o.Z)("div",{className:"panel-heading"},void 0,(0,o.Z)("h3",{className:"panel-title"},void 0,pgettext("profile ban details title","Ban details"))),this.getPanelBody()))}}]),i}(v().Component);function C(e){return e.display?(0,o.Z)(y.Z,{helpText:pgettext("user profile details","No profile details are editable at this time."),message:pgettext("user profile details","This option is currently unavailable.")}):null}function R(e){return e.display?x||(x=(0,o.Z)("div",{className:"panel-body"},void 0,(0,o.Z)(Z.Z,{}))):null}var E=n(60471);var S=function(e){(0,c.Z)(i,e);var t,n,a=(t=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,a=(0,d.Z)(t);if(n){var i=(0,d.Z)(this).constructor;e=Reflect.construct(a,arguments,i)}else e=a.apply(this,arguments);return(0,u.Z)(this,e)});function i(){var e;(0,s.Z)(this,i);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return e=a.call.apply(a,[this].concat(n)),(0,p.Z)((0,l.Z)(e),"onChange",(function(t){var n=e.props,a=n.field;(0,n.onChange)(a.fieldname,t.target.value)})),e}return(0,r.Z)(i,[{key:"render",value:function(){var e=this.props,t=e.disabled,n=e.field,a=e.value,i=n.input;return"select"===i.type?(0,o.Z)(E.Z,{choices:i.choices,disabled:t,id:"id_"+n.fieldname,onChange:this.onChange,value:a}):"textarea"===i.type?(0,o.Z)("textarea",{className:"form-control",disabled:t,id:"id_"+n.fieldname,onChange:this.onChange,rows:"4",type:"text",value:a}):"text"===i.type?(0,o.Z)("input",{className:"form-control",disabled:t,id:"id_"+n.fieldname,onChange:this.onChange,type:"text",value:a}):null}}]),i}(v().Component),O=n(96359);function L(e){var t=e.disabled,n=e.errors,a=e.fields,i=e.name,s=e.onChange,r=e.value;return(0,o.Z)("fieldset",{},void 0,(0,o.Z)("legend",{},void 0,i),a.map((function(e){return(0,o.Z)(O.Z,{for:"id_"+e.fieldname,helpText:e.help_text,label:e.label,validation:n[e.fieldname]},e.fieldname,(0,o.Z)(S,{disabled:t,field:e,onChange:s,value:r[e.fieldname]}))})))}var P=n(82211),T=n(43345),A=n(78657),I=n(53904);var B=function(e){(0,c.Z)(i,e);var t,n,a=(t=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,a=(0,d.Z)(t);if(n){var i=(0,d.Z)(this).constructor;e=Reflect.construct(a,arguments,i)}else e=a.apply(this,arguments);return(0,u.Z)(this,e)});function i(e){var t;(0,s.Z)(this,i),t=a.call(this,e),(0,p.Z)((0,l.Z)(t),"onChange",(function(e,n){t.setState((0,p.Z)({},e,n))})),t.state={isLoading:!1,errors:{}};for(var n=e.groups.length,o=0;o<n;o++)for(var r=e.groups[o],c=r.fields.length,u=0;u<c;u++){var d=r.fields[u].fieldname,h=r.fields[u].initial;t.state[d]=h}return t}return(0,r.Z)(i,[{key:"send",value:function(){var e=Object.assign({},this.state,{errors:null,isLoading:null});return A.Z.post(this.props.api,e)}},{key:"handleSuccess",value:function(e){this.props.onSuccess(e)}},{key:"handleError",value:function(e){400===e.status?(I.Z.error(gettext("Form contains errors.")),this.setState({errors:e})):I.Z.apiError(e)}},{key:"render",value:function(){var e=this;return(0,o.Z)("form",{onSubmit:this.handleSubmit},void 0,(0,o.Z)("div",{className:"panel-body"},void 0,this.props.groups.map((function(t,n){return(0,o.Z)(L,{disabled:e.state.isLoading,errors:e.state.errors,fields:t.fields,name:t.name,onChange:e.onChange,value:e.state},n)}))),(0,o.Z)("div",{className:"panel-footer text-right"},void 0,(0,o.Z)(j,{disabled:this.state.isLoading,onCancel:this.props.onCancel})," ",(0,o.Z)(P.Z,{className:"btn-primary",loading:this.state.isLoading},void 0,pgettext("user profile details form btn","Save changes"))))}}]),i}(T.Z);function j(e){var t=e.onCancel,n=e.disabled;return t?(0,o.Z)("button",{className:"btn btn-default",disabled:n,onClick:t,type:"button"},void 0,pgettext("user profile details form btn","Cancel")):null}var D,z=function(e){(0,c.Z)(i,e);var t,n,a=(t=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,a=(0,d.Z)(t);if(n){var i=(0,d.Z)(this).constructor;e=Reflect.construct(a,arguments,i)}else e=a.apply(this,arguments);return(0,u.Z)(this,e)});function i(e){var t;return(0,s.Z)(this,i),(t=a.call(this,e)).state={loading:!0,groups:null},t}return(0,r.Z)(i,[{key:"componentDidMount",value:function(){var e=this;A.Z.get(this.props.api).then((function(t){e.setState({loading:!1,groups:t})}),(function(t){I.Z.apiError(t),e.props.cancel&&e.props.cancel()}))}},{key:"render",value:function(){var e=this.state,t=e.groups,n=e.loading;return(0,o.Z)("div",{className:"panel panel-default panel-form"},void 0,(0,o.Z)("div",{className:"panel-heading"},void 0,(0,o.Z)("h3",{className:"panel-title"},void 0,pgettext("user profile details form title","Edit details"))),(0,o.Z)(R,{display:n}),(0,o.Z)(C,{display:!n&&!t.length}),(0,o.Z)(U,{api:this.props.api,display:!n&&t.length,groups:t,onCancel:this.props.onCancel,onSuccess:this.props.onSuccess}))}}]),i}(v().Component);function U(e){var t=e.api,n=e.display,a=e.groups,i=e.onCancel,s=e.onSuccess;return n?(0,o.Z)(B,{api:t,groups:a,onCancel:i,onSuccess:s}):null}function q(e){var t=e.api,n=e.display,a=e.onCancel,i=e.onSuccess;return n?(0,o.Z)(z,{api:t,onCancel:a,onSuccess:i}):null}function M(e){var t,n=e.isAuthenticated,a=e.profile;return t=n?pgettext("profile details empty","You are not sharing any details with others."):interpolate(pgettext("profile details empty","%(username)s is not sharing any details with others."),{username:a.username},!0),(0,o.Z)("div",{className:"panel panel-default"},void 0,(0,o.Z)("div",{className:"panel-body text-center lead"},void 0,t))}function F(e){var t=e.html,n=e.text,a=e.url;return t?(0,o.Z)("div",{className:"form-control-static col-md-9",dangerouslySetInnerHTML:{__html:t}}):(0,o.Z)("div",{className:"form-control-static col-md-9"},void 0,(0,o.Z)(H,{text:n,url:a}))}function H(e){var t=e.text,n=e.url;return n?(0,o.Z)("p",{},void 0,(0,o.Z)("a",{href:n,target:"_blank",rel:"nofollow"},void 0,t||n)):t?(0,o.Z)("p",{},void 0,t):null}function V(e){return(0,o.Z)("div",{className:"form-group"},void 0,(0,o.Z)("strong",{className:"control-label col-md-3"},void 0,e.name,":"),v().createElement(F,e))}function Y(e){var t=e.fields,n=e.name;return(0,o.Z)("div",{className:"panel panel-default panel-profile-details-group"},void 0,(0,o.Z)("div",{className:"panel-heading"},void 0,(0,o.Z)("h3",{className:"panel-title"},void 0,n)),(0,o.Z)("div",{className:"panel-body"},void 0,(0,o.Z)("div",{className:"form-horizontal"},void 0,t.map((function(e){var t=e.fieldname,n=e.html,a=e.name,i=e.text,s=e.url;return(0,o.Z)(V,{name:a,html:n,text:i,url:s},t)})))))}function G(e){var t=e.display,n=e.groups,a=e.isAuthenticated,i=e.loading,s=e.profile;return t?i?D||(D=(0,o.Z)(Z.Z,{})):n.length?(0,o.Z)("div",{},void 0,n.map((function(e,t){return(0,o.Z)(Y,{fields:e.fields,name:e.name},t)}))):(0,o.Z)(M,{isAuthenticated:a,profile:s}):null}var $=n(92490);const W=function(e){var t=e.onEdit,n=e.showEditButton;return(0,o.Z)($.o8,{},void 0,(0,o.Z)($.Z2,{auto:!0},void 0,(0,o.Z)($.Eg,{auto:!0},void 0,(0,o.Z)("h3",{},void 0,pgettext("profile details title","Details")))),n&&(0,o.Z)($.Z2,{},void 0,(0,o.Z)($.Eg,{},void 0,(0,o.Z)("button",{className:"btn btn-default btn-outline btn-block",onClick:t,type:"button"},void 0,pgettext("profile details edit btn","Edit")))))};var Q=n(58598);var K=function(e){(0,c.Z)(i,e);var t,n,a=(t=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,a=(0,d.Z)(t);if(n){var i=(0,d.Z)(this).constructor;e=Reflect.construct(a,arguments,i)}else e=a.apply(this,arguments);return(0,u.Z)(this,e)});function i(){return(0,s.Z)(this,i),a.apply(this,arguments)}return(0,r.Z)(i,[{key:"componentDidMount",value:function(){var e=this.props,t=e.data,n=e.dispatch,a=e.user;t&&t.id===a.id||A.Z.get(this.props.user.api.details).then((function(e){n((0,Q.zD)(e))}),(function(e){I.Z.apiError(e)}))}},{key:"render",value:function(){return this.props.children}}]),i}(v().Component);var X=function(e){(0,c.Z)(i,e);var t,n,a=(t=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,a=(0,d.Z)(t);if(n){var i=(0,d.Z)(this).constructor;e=Reflect.construct(a,arguments,i)}else e=a.apply(this,arguments);return(0,u.Z)(this,e)});function i(e){var t;return(0,s.Z)(this,i),t=a.call(this,e),(0,p.Z)((0,l.Z)(t),"onCancel",(function(){t.setState({editing:!1})})),(0,p.Z)((0,l.Z)(t),"onEdit",(function(){t.setState({editing:!0})})),(0,p.Z)((0,l.Z)(t),"onSuccess",(function(e){var n,a=t.props,i=a.dispatch,o=a.isAuthenticated,s=a.profile;n=o?pgettext("profile details form","Your details have been changed."):interpolate(pgettext("profile details form","%(username)s's details have been changed."),{username:s.username},!0),I.Z.info(n),i((0,Q.zD)(e)),t.setState({editing:!1})})),t.state={editing:!1},t}return(0,r.Z)(i,[{key:"componentDidMount",value:function(){N.Z.set({title:pgettext("profile details title","Details"),parent:this.props.profile.username})}},{key:"render",value:function(){var e=this.props,t=e.dispatch,n=e.isAuthenticated,a=e.profile,i=e.profileDetails,s=i.id!==a.id;return(0,o.Z)(K,{data:i,dispatch:t,user:a},void 0,(0,o.Z)("div",{className:"profile-details"},void 0,(0,o.Z)(W,{onEdit:this.onEdit,showEditButton:!!i.edit&&!this.state.editing}),(0,o.Z)(G,{display:!this.state.editing,groups:i.groups,isAuthenticated:n,loading:s,profile:a}),(0,o.Z)(q,{api:a.api.edit_details,dispatch:t,display:this.state.editing,onCancel:this.onCancel,onSuccess:this.onSuccess})))}}]),i}(v().Component),J=n(87462),ee=n(11005),te=n(21981),ne=n(90287);var ae,ie=function(e){(0,c.Z)(i,e);var t,n,a=(t=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,a=(0,d.Z)(t);if(n){var i=(0,d.Z)(this).constructor;e=Reflect.construct(a,arguments,i)}else e=a.apply(this,arguments);return(0,u.Z)(this,e)});function i(e){var t;return(0,s.Z)(this,i),t=a.call(this,e),(0,p.Z)((0,l.Z)(t),"loadMore",(function(){t.setState({isLoading:!0}),t.loadItems(t.props.posts.next)})),t.state={isLoading:!1},t}return(0,r.Z)(i,[{key:"loadItems",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;A.Z.get(this.props.api,{start:t||0}).then((function(n){0===t?ne.Z.dispatch(te.zD(n)):ne.Z.dispatch(te.R3(n)),e.setState({isLoading:!1})}),(function(t){e.setState({isLoading:!1}),I.Z.apiError(t)}))}},{key:"componentDidMount",value:function(){N.Z.set({title:this.props.title,parent:this.props.profile.username}),this.loadItems()}},{key:"render",value:function(){return(0,o.Z)("div",{className:"profile-feed"},void 0,(0,o.Z)($.o8,{},void 0,(0,o.Z)($.Z2,{auto:!0},void 0,(0,o.Z)($.Eg,{auto:!0},void 0,(0,o.Z)("h3",{},void 0,this.props.header)))),v().createElement(oe,(0,J.Z)({isLoading:this.state.isLoading,loadMore:this.loadMore},this.props)))}}]),i}(v().Component);function oe(e){return e.posts.isLoaded&&!e.posts.results.length?(0,o.Z)("p",{className:"lead"},void 0,e.emptyMessage):(0,o.Z)("div",{},void 0,(0,o.Z)(ee.Z,{isReady:e.posts.isLoaded,posts:e.posts.results,poster:e.profile}),(0,o.Z)(se,{isLoading:e.isLoading,loadMore:e.loadMore,next:e.posts.next}))}function se(e){return e.next?(0,o.Z)("div",{className:"pager-more"},void 0,(0,o.Z)(P.Z,{className:"btn btn-default btn-outline",loading:e.isLoading,onClick:e.loadMore},void 0,pgettext("profile load more btn","Show older activity"))):null}var re=function(e){(0,c.Z)(i,e);var t,n,a=(t=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,a=(0,d.Z)(t);if(n){var i=(0,d.Z)(this).constructor;e=Reflect.construct(a,arguments,i)}else e=a.apply(this,arguments);return(0,u.Z)(this,e)});function i(){return(0,s.Z)(this,i),a.apply(this,arguments)}return(0,r.Z)(i,[{key:"getClassName",value:function(){return this.props.className?"form-search "+this.props.className:"form-search"}},{key:"render",value:function(){return(0,o.Z)("div",{className:this.getClassName()},void 0,(0,o.Z)("input",{type:"text",className:"form-control",value:this.props.value,onChange:this.props.onChange,placeholder:this.props.placeholder||pgettext("quick search placeholder","Search...")}),ae||(ae=(0,o.Z)("span",{className:"material-icon"},void 0,"search")))}}]),i}(v().Component),le=n(40429),ce=n(6935);var ue=function(e){(0,c.Z)(i,e);var t,n,a=(t=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,a=(0,d.Z)(t);if(n){var i=(0,d.Z)(this).constructor;e=Reflect.construct(a,arguments,i)}else e=a.apply(this,arguments);return(0,u.Z)(this,e)});function i(e){var t;return(0,s.Z)(this,i),t=a.call(this,e),(0,p.Z)((0,l.Z)(t),"loadMore",(function(){t.setState({isBusy:!0}),t.loadUsers(t.state.page+1,t.state.search)})),(0,p.Z)((0,l.Z)(t),"search",(function(e){t.setState({isLoaded:!1,isBusy:!0,search:e.target.value,count:0,more:0,page:1,pages:1}),t.loadUsers(1,e.target.value)})),t.setSpecialProps(),_.Z.has(t.PRELOADED_DATA_KEY)?t.initWithPreloadedData(_.Z.pop(t.PRELOADED_DATA_KEY)):t.initWithoutPreloadedData(),t}return(0,r.Z)(i,[{key:"setSpecialProps",value:function(){this.PRELOADED_DATA_KEY="PROFILE_FOLLOWERS",this.TITLE=pgettext("profile followers title","Followers"),this.API_FILTER="followers"}},{key:"initWithPreloadedData",value:function(e){this.state={isLoaded:!0,isBusy:!1,search:"",count:e.count,more:e.more,page:e.page,pages:e.pages},ne.Z.dispatch((0,ce.ZB)(e.results))}},{key:"initWithoutPreloadedData",value:function(){this.state={isLoaded:!1,isBusy:!1,search:"",count:0,more:0,page:1,pages:1},this.loadUsers()}},{key:"loadUsers",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,a=this.props.profile.api[this.API_FILTER];A.Z.get(a,{search:n,page:t||1},"user-"+this.API_FILTER).then((function(n){1===t?ne.Z.dispatch((0,ce.ZB)(n.results)):ne.Z.dispatch((0,ce.R3)(n.results)),e.setState({isLoaded:!0,isBusy:!1,count:n.count,more:n.more,page:n.page,pages:n.pages})}),(function(e){I.Z.apiError(e)}))}},{key:"componentDidMount",value:function(){N.Z.set({title:this.TITLE,parent:this.props.profile.username})}},{key:"getLabel",value:function(){if(this.state.isLoaded){if(this.state.search){var e=npgettext("profile followers","Found %(users)s user.","Found %(users)s users.",this.state.count);return interpolate(e,{users:this.state.count},!0)}if(this.props.profile.id===this.props.user.id){var t=npgettext("profile followers","You have %(users)s follower.","You have %(users)s followers.",this.state.count);return interpolate(t,{users:this.state.count},!0)}var n=npgettext("profile followers","%(username)s has %(users)s follower.","%(username)s has %(users)s followers.",this.state.count);return interpolate(n,{username:this.props.profile.username,users:this.state.count},!0)}return pgettext("Loading...")}},{key:"getEmptyMessage",value:function(){return this.state.search?pgettext("profile followers","Search returned no users matching specified criteria."):this.props.user.id===this.props.profile.id?pgettext("profile followers","You have no followers."):interpolate(pgettext("profile followers","%(username)s has no followers."),{username:this.props.profile.username},!0)}},{key:"getMoreButton",value:function(){return this.state.more?(0,o.Z)("div",{className:"pager-more"},void 0,(0,o.Z)(P.Z,{className:"btn btn-default btn-outline",loading:this.state.isBusy,onClick:this.loadMore},void 0,interpolate(pgettext("profile followers","Show more (%(more)s)"),{more:this.state.more},!0))):null}},{key:"getListBody",value:function(){return this.state.isLoaded&&0===this.state.count?(0,o.Z)("p",{className:"lead"},void 0,this.getEmptyMessage()):(0,o.Z)("div",{},void 0,(0,o.Z)(le.Z,{cols:3,isReady:this.state.isLoaded,users:this.props.users}),this.getMoreButton())}},{key:"getClassName",value:function(){return"profile-"+this.API_FILTER}},{key:"render",value:function(){return(0,o.Z)("div",{className:this.getClassName()},void 0,(0,o.Z)($.o8,{},void 0,(0,o.Z)($.Z2,{auto:!0},void 0,(0,o.Z)($.Eg,{auto:!0},void 0,(0,o.Z)("h3",{},void 0,this.getLabel()))),(0,o.Z)($.Z2,{},void 0,(0,o.Z)($.Eg,{},void 0,(0,o.Z)(re,{value:this.state.search,onChange:this.search,placeholder:pgettext("profile followers search","Search users...")})))),this.getListBody())}}]),i}(v().Component);var de=function(e){(0,c.Z)(i,e);var t,n,a=(t=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,a=(0,d.Z)(t);if(n){var i=(0,d.Z)(this).constructor;e=Reflect.construct(a,arguments,i)}else e=a.apply(this,arguments);return(0,u.Z)(this,e)});function i(){return(0,s.Z)(this,i),a.apply(this,arguments)}return(0,r.Z)(i,[{key:"setSpecialProps",value:function(){this.PRELOADED_DATA_KEY="PROFILE_FOLLOWS",this.TITLE=pgettext("profile follows title","Follows"),this.API_FILTER="follows"}},{key:"getLabel",value:function(){if(this.state.isLoaded){if(this.state.search){var e=npgettext("profile follows","Found %(users)s user.","Found %(users)s users.",this.state.count);return interpolate(e,{users:this.state.count},!0)}if(this.props.profile.id===this.props.user.id){var t=npgettext("profile follows","You are following %(users)s user.","You are following %(users)s users.",this.state.count);return interpolate(t,{users:this.state.count},!0)}var n=npgettext("profile follows","%(username)s is following %(users)s user.","%(username)s is following %(users)s users.",this.state.count);return interpolate(n,{username:this.props.profile.username,users:this.state.count},!0)}return pgettext("profile follows","Loading...")}},{key:"getEmptyMessage",value:function(){return this.state.search?pgettext("profile follows","Search returned no users matching specified criteria."):this.props.user.id===this.props.profile.id?pgettext("profile follows","You are not following any users."):interpolate(pgettext("profile follows","%(username)s is not following any users."),{username:this.props.profile.username},!0)}}]),i}(ue);var pe,he,ve=function(e){(0,c.Z)(i,e);var t,n,a=(t=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,a=(0,d.Z)(t);if(n){var i=(0,d.Z)(this).constructor;e=Reflect.construct(a,arguments,i)}else e=a.apply(this,arguments);return(0,u.Z)(this,e)});function i(){return(0,s.Z)(this,i),a.apply(this,arguments)}return(0,r.Z)(i,[{key:"getEmptyMessage",value:function(){return this.props.emptyMessage?this.props.emptyMessage:pgettext("username history empty","Your account has no history of name changes.")}},{key:"render",value:function(){return(0,o.Z)("div",{className:"username-history ui-ready"},void 0,(0,o.Z)("ul",{className:"list-group"},void 0,(0,o.Z)("li",{className:"list-group-item empty-message"},void 0,this.getEmptyMessage())))}}]),i}(v().Component),me=n(19605);var fe=function(e){(0,c.Z)(i,e);var t,n,a=(t=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,a=(0,d.Z)(t);if(n){var i=(0,d.Z)(this).constructor;e=Reflect.construct(a,arguments,i)}else e=a.apply(this,arguments);return(0,u.Z)(this,e)});function i(){return(0,s.Z)(this,i),a.apply(this,arguments)}return(0,r.Z)(i,[{key:"renderUserAvatar",value:function(){return this.props.change.changed_by?(0,o.Z)("a",{href:this.props.change.changed_by.url,className:"user-avatar-wrapper"},void 0,(0,o.Z)(me.ZP,{user:this.props.change.changed_by,size:"100"})):pe||(pe=(0,o.Z)("span",{className:"user-avatar-wrapper"},void 0,(0,o.Z)(me.ZP,{size:"100"})))}},{key:"renderUsername",value:function(){return this.props.change.changed_by?(0,o.Z)("a",{href:this.props.change.changed_by.url,className:"item-title"},void 0,this.props.change.changed_by.username):(0,o.Z)("span",{className:"item-title"},void 0,this.props.change.changed_by_username)}},{key:"render",value:function(){return(0,o.Z)("li",{className:"list-group-item"},this.props.change.id,(0,o.Z)("div",{className:"change-avatar"},void 0,this.renderUserAvatar()),(0,o.Z)("div",{className:"change-author"},void 0,this.renderUsername()),(0,o.Z)("div",{className:"change"},void 0,(0,o.Z)("span",{className:"old-username"},void 0,this.props.change.old_username),he||(he=(0,o.Z)("span",{className:"material-icon"},void 0,"arrow_forward")),(0,o.Z)("span",{className:"new-username"},void 0,this.props.change.new_username)),(0,o.Z)("div",{className:"change-date"},void 0,(0,o.Z)("abbr",{title:this.props.change.changed_on.format("LLL")},void 0,this.props.change.changed_on.fromNow())))}}]),i}(v().Component);var Ze,ge,be=function(e){(0,c.Z)(i,e);var t,n,a=(t=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,a=(0,d.Z)(t);if(n){var i=(0,d.Z)(this).constructor;e=Reflect.construct(a,arguments,i)}else e=a.apply(this,arguments);return(0,u.Z)(this,e)});function i(){return(0,s.Z)(this,i),a.apply(this,arguments)}return(0,r.Z)(i,[{key:"render",value:function(){return(0,o.Z)("div",{className:"username-history ui-ready"},void 0,(0,o.Z)("ul",{className:"list-group"},void 0,this.props.changes.map((function(e){return(0,o.Z)(fe,{change:e},e.id)}))))}}]),i}(v().Component),ye=n(44039);var _e=function(e){(0,c.Z)(i,e);var t,n,a=(t=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,a=(0,d.Z)(t);if(n){var i=(0,d.Z)(this).constructor;e=Reflect.construct(a,arguments,i)}else e=a.apply(this,arguments);return(0,u.Z)(this,e)});function i(){return(0,s.Z)(this,i),a.apply(this,arguments)}return(0,r.Z)(i,[{key:"shouldComponentUpdate",value:function(){return!1}},{key:"getClassName",value:function(){return this.props.hiddenOnMobile?"list-group-item hidden-xs hidden-sm":"list-group-item"}},{key:"render",value:function(){return(0,o.Z)("li",{className:this.getClassName()},void 0,Ze||(Ze=(0,o.Z)("div",{className:"change-avatar"},void 0,(0,o.Z)("span",{className:"user-avatar"},void 0,(0,o.Z)(me.ZP,{size:"100"})))),(0,o.Z)("div",{className:"change-author"},void 0,(0,o.Z)("span",{className:"ui-preview-text",style:{width:ye.e(30,100)+"px"}},void 0," ")),(0,o.Z)("div",{className:"change"},void 0,(0,o.Z)("span",{className:"ui-preview-text",style:{width:ye.e(30,70)+"px"}},void 0," "),ge||(ge=(0,o.Z)("span",{className:"material-icon"},void 0,"arrow_forward")),(0,o.Z)("span",{className:"ui-preview-text",style:{width:ye.e(30,70)+"px"}},void 0," ")),(0,o.Z)("div",{className:"change-date"},void 0,(0,o.Z)("span",{className:"ui-preview-text",style:{width:ye.e(80,140)+"px"}},void 0," ")))}}]),i}(v().Component);var ke,Ne=function(e){(0,c.Z)(i,e);var t,n,a=(t=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,a=(0,d.Z)(t);if(n){var i=(0,d.Z)(this).constructor;e=Reflect.construct(a,arguments,i)}else e=a.apply(this,arguments);return(0,u.Z)(this,e)});function i(){return(0,s.Z)(this,i),a.apply(this,arguments)}return(0,r.Z)(i,[{key:"shouldComponentUpdate",value:function(){return!1}},{key:"render",value:function(){return(0,o.Z)("div",{className:"username-history ui-preview"},void 0,(0,o.Z)("ul",{className:"list-group"},void 0,[0,1,2].map((function(e){return(0,o.Z)(_e,{hiddenOnMobile:e>0},e)}))))}}]),i}(v().Component);var xe=function(e){(0,c.Z)(i,e);var t,n,a=(t=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,a=(0,d.Z)(t);if(n){var i=(0,d.Z)(this).constructor;e=Reflect.construct(a,arguments,i)}else e=a.apply(this,arguments);return(0,u.Z)(this,e)});function i(){return(0,s.Z)(this,i),a.apply(this,arguments)}return(0,r.Z)(i,[{key:"render",value:function(){return this.props.isLoaded?this.props.changes.length?(0,o.Z)(be,{changes:this.props.changes}):(0,o.Z)(ve,{emptyMessage:this.props.emptyMessage}):ke||(ke=(0,o.Z)(Ne,{}))}}]),i}(v().Component),we=n(48927);var Ce=function(e){(0,c.Z)(i,e);var t,n,a=(t=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,a=(0,d.Z)(t);if(n){var i=(0,d.Z)(this).constructor;e=Reflect.construct(a,arguments,i)}else e=a.apply(this,arguments);return(0,u.Z)(this,e)});function i(e){var t;return(0,s.Z)(this,i),t=a.call(this,e),(0,p.Z)((0,l.Z)(t),"loadMore",(function(){t.setState({isBusy:!0}),t.loadChanges(t.state.page+1,t.state.search)})),(0,p.Z)((0,l.Z)(t),"search",(function(e){t.setState({isLoaded:!1,isBusy:!0,search:e.target.value,count:0,more:0,page:1,pages:1}),t.loadChanges(1,e.target.value)})),_.Z.has("PROFILE_NAME_HISTORY")?t.initWithPreloadedData(_.Z.pop("PROFILE_NAME_HISTORY")):t.initWithoutPreloadedData(),t}return(0,r.Z)(i,[{key:"initWithPreloadedData",value:function(e){this.state={isLoaded:!0,isBusy:!1,search:"",count:e.count,more:e.more,page:e.page,pages:e.pages},ne.Z.dispatch((0,we.ZB)(e.results))}},{key:"initWithoutPreloadedData",value:function(){this.state={isLoaded:!1,isBusy:!1,search:"",count:0,more:0,page:1,pages:1},this.loadChanges()}},{key:"loadChanges",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;A.Z.get(_.Z.get("USERNAME_CHANGES_API"),{user:this.props.profile.id,search:n,page:t||1},"search-username-history").then((function(n){1===t?ne.Z.dispatch((0,we.ZB)(n.results)):ne.Z.dispatch((0,we.R3)(n.results)),e.setState({isLoaded:!0,isBusy:!1,count:n.count,more:n.more,page:n.page,pages:n.pages})}),(function(e){I.Z.apiError(e)}))}},{key:"componentDidMount",value:function(){N.Z.set({title:pgettext("profile username history title","Username history"),parent:this.props.profile.username})}},{key:"getLabel",value:function(){if(this.state.isLoaded){if(this.state.search){var e=npgettext("profile username history","Found %(changes)s username change.","Found %(changes)s username changes.",this.state.count);return interpolate(e,{changes:this.state.count},!0)}if(this.props.profile.id===this.props.user.id){var t=npgettext("profile username history","Your username was changed %(changes)s time.","Your username was changed %(changes)s times.",this.state.count);return interpolate(t,{changes:this.state.count},!0)}var n=npgettext("profile username history","%(username)s's username was changed %(changes)s time.","%(username)s's username was changed %(changes)s times.",this.state.count);return interpolate(n,{username:this.props.profile.username,changes:this.state.count},!0)}return pgettext("profile username history","Loading...")}},{key:"getEmptyMessage",value:function(){return this.state.search?pgettext("profile username history","Search returned no username changes matching specified criteria."):this.props.user.id===this.props.profile.id?pgettext("username history empty","Your account has no history of name changes."):interpolate(pgettext("profile username history","%(username)s's username was never changed."),{username:this.props.profile.username},!0)}},{key:"getMoreButton",value:function(){return this.state.more?(0,o.Z)("div",{className:"pager-more"},void 0,(0,o.Z)(P.Z,{className:"btn btn-default btn-outline",loading:this.state.isBusy,onClick:this.loadMore},void 0,interpolate(pgettext("profile username history","Show older (%(more)s)"),{more:this.state.more},!0))):null}},{key:"render",value:function(){return(0,o.Z)("div",{className:"profile-username-history"},void 0,(0,o.Z)($.o8,{},void 0,(0,o.Z)($.Z2,{auto:!0},void 0,(0,o.Z)($.Eg,{auto:!0},void 0,(0,o.Z)("h3",{},void 0,this.getLabel()))),(0,o.Z)($.Z2,{},void 0,(0,o.Z)($.Eg,{},void 0,(0,o.Z)(re,{value:this.state.search,onChange:this.search,placeholder:pgettext("profile username history search input","Search history...")})))),(0,o.Z)(xe,{isLoaded:this.state.isLoaded,emptyMessage:this.getEmptyMessage(),changes:this.props["username-history"]}),this.getMoreButton())}}]),i}(v().Component),Re=n(82125),Ee=n(27519),Se=n(59131),Oe=n(98936),Le=n(99755);var Pe,Te=function(e){(0,c.Z)(i,e);var t,n,a=(t=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,a=(0,d.Z)(t);if(n){var i=(0,d.Z)(this).constructor;e=Reflect.construct(a,arguments,i)}else e=a.apply(this,arguments);return(0,u.Z)(this,e)});function i(e){var t;return(0,s.Z)(this,i),t=a.call(this,e),(0,p.Z)((0,l.Z)(t),"action",(function(){t.setState({isLoading:!0}),t.props.profile.is_followed?ne.Z.dispatch((0,Ee.r$)({is_followed:!1,followers:t.props.profile.followers-1})):ne.Z.dispatch((0,Ee.r$)({is_followed:!0,followers:t.props.profile.followers+1})),A.Z.post(t.props.profile.api.follow).then((function(e){t.setState({isLoading:!1}),ne.Z.dispatch((0,Ee.r$)(e))}),(function(e){t.setState({isLoading:!1}),I.Z.apiError(e)}))})),t.state={isLoading:!1},t}return(0,r.Z)(i,[{key:"getClassName",value:function(){return this.props.profile.is_followed?this.props.className+" btn-default btn-following":this.props.className+" btn-default btn-follow"}},{key:"getIcon",value:function(){return this.props.profile.is_followed?"favorite":"favorite_border"}},{key:"getLabel",value:function(){return this.props.profile.is_followed?pgettext("user profile follow btn","Following"):pgettext("user profile follow btn","Follow")}},{key:"render",value:function(){return(0,o.Z)(P.Z,{className:this.getClassName(),disabled:this.state.isLoading,onClick:this.action},void 0,(0,o.Z)("span",{className:"material-icon"},void 0,this.getIcon()),this.getLabel())}}]),i}(v().Component),Ae=n(64646);var Ie,Be,je=function(e){(0,c.Z)(i,e);var t,n,a=(t=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,a=(0,d.Z)(t);if(n){var i=(0,d.Z)(this).constructor;e=Reflect.construct(a,arguments,i)}else e=a.apply(this,arguments);return(0,u.Z)(this,e)});function i(){var e;(0,s.Z)(this,i);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return e=a.call.apply(a,[this].concat(n)),(0,p.Z)((0,l.Z)(e),"onClick",(function(){Ae.Z.open({mode:"START_PRIVATE",submit:_.Z.get("PRIVATE_THREADS_API"),to:[e.props.profile]})})),e}return(0,r.Z)(i,[{key:"render",value:function(){var e=this.props.user.acl.can_start_private_threads,t=this.props.user.id===this.props.profile.id;return!e||t?null:(0,o.Z)("button",{className:this.props.className,onClick:this.onClick,type:"button"},void 0,Pe||(Pe=(0,o.Z)("span",{className:"material-icon"},void 0,"comment")),pgettext("profile message btn","Message"))}}]),i}(v().Component),De=n(3784),ze=n(7227),Ue=n(30337);var qe,Me,Fe=function(e){(0,c.Z)(i,e);var t,n,a=(t=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,a=(0,d.Z)(t);if(n){var i=(0,d.Z)(this).constructor;e=Reflect.construct(a,arguments,i)}else e=a.apply(this,arguments);return(0,u.Z)(this,e)});function i(e){var t;return(0,s.Z)(this,i),(t=a.call(this,e)).state={isLoaded:!1,isLoading:!1,error:null,is_avatar_locked:"",avatar_lock_user_message:"",avatar_lock_staff_message:""},t}return(0,r.Z)(i,[{key:"componentDidMount",value:function(){var e=this;A.Z.get(this.props.profile.api.moderate_avatar).then((function(t){e.setState({isLoaded:!0,is_avatar_locked:t.is_avatar_locked,avatar_lock_user_message:t.avatar_lock_user_message||"",avatar_lock_staff_message:t.avatar_lock_staff_message||""})}),(function(t){e.setState({isLoaded:!0,error:t.detail})}))}},{key:"clean",value:function(){return!!this.isValid()||(I.Z.error(this.validate().username[0]),!1)}},{key:"send",value:function(){return A.Z.post(this.props.profile.api.moderate_avatar,{is_avatar_locked:this.state.is_avatar_locked,avatar_lock_user_message:this.state.avatar_lock_user_message,avatar_lock_staff_message:this.state.avatar_lock_staff_message})}},{key:"handleSuccess",value:function(e){ne.Z.dispatch((0,ce.n1)(this.props.profile,e.avatar_hash)),I.Z.success(pgettext("profile avatar moderation","Avatar controls have been changed."))}},{key:"getFormBody",value:function(){return(0,o.Z)("form",{onSubmit:this.handleSubmit},void 0,(0,o.Z)("div",{className:"modal-body"},void 0,(0,o.Z)(O.Z,{label:pgettext("profile avatar moderation field","Lock avatar"),helpText:pgettext("profile avatar moderation field","Locking user avatar will prohibit user from changing his avatar and will reset his/her avatar to default one."),for:"id_is_avatar_locked"},void 0,(0,o.Z)(ze.Z,{id:"id_is_avatar_locked",disabled:this.state.isLoading,iconOn:"lock_outline",iconOff:"lock_open",labelOn:pgettext("profile avatar moderation field","Disallow user from changing avatar"),labelOff:pgettext("profile avatar moderation field","Allow user to change avatar"),onChange:this.bindInput("is_avatar_locked"),value:this.state.is_avatar_locked})),(0,o.Z)(O.Z,{label:pgettext("profile avatar moderation field","User message"),helpText:pgettext("profile avatar moderation field","Optional message for user explaining why they are prohibited from changing their avatar."),for:"id_avatar_lock_user_message"},void 0,(0,o.Z)("textarea",{id:"id_avatar_lock_user_message",className:"form-control",rows:"4",disabled:this.state.isLoading,onChange:this.bindInput("avatar_lock_user_message"),value:this.state.avatar_lock_user_message})),(0,o.Z)(O.Z,{label:pgettext("profile avatar moderation field","Staff message"),helpText:pgettext("profile avatar moderation field","Optional message for forum team members explaining why the user is prohibited form changing their avatar."),for:"id_avatar_lock_staff_message"},void 0,(0,o.Z)("textarea",{id:"id_avatar_lock_staff_message",className:"form-control",rows:"4",disabled:this.state.isLoading,onChange:this.bindInput("avatar_lock_staff_message"),value:this.state.avatar_lock_staff_message}))),(0,o.Z)("div",{className:"modal-footer"},void 0,(0,o.Z)("button",{type:"button",className:"btn btn-default","data-dismiss":"modal"},void 0,pgettext("profile avatar moderation btn","Close")),(0,o.Z)(P.Z,{className:"btn-primary",loading:this.state.isLoading},void 0,pgettext("profile avatar moderation btn","Save changes"))))}},{key:"getModalBody",value:function(){return this.state.error?(0,o.Z)(Ue.Z,{icon:"remove_circle_outline",message:this.state.error}):this.state.isLoaded?this.getFormBody():Ie||(Ie=(0,o.Z)(De.Z,{}))}},{key:"getClassName",value:function(){return this.state.error?"modal-dialog modal-message modal-avatar-controls":"modal-dialog modal-avatar-controls"}},{key:"render",value:function(){return(0,o.Z)("div",{className:this.getClassName(),role:"document"},void 0,(0,o.Z)("div",{className:"modal-content"},void 0,(0,o.Z)("div",{className:"modal-header"},void 0,(0,o.Z)("button",{type:"button",className:"close","data-dismiss":"modal","aria-label":pgettext("modal","Close")},void 0,Be||(Be=(0,o.Z)("span",{"aria-hidden":"true"},void 0,"×"))),(0,o.Z)("h4",{className:"modal-title"},void 0,pgettext("profile avatar moderation title","Avatar controls"))),this.getModalBody()))}}]),i}(T.Z),He=n(55210);var Ve,Ye,Ge,$e=function(e){(0,c.Z)(i,e);var t,n,a=(t=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,a=(0,d.Z)(t);if(n){var i=(0,d.Z)(this).constructor;e=Reflect.construct(a,arguments,i)}else e=a.apply(this,arguments);return(0,u.Z)(this,e)});function i(e){var t;return(0,s.Z)(this,i),(t=a.call(this,e)).state={isLoaded:!1,isLoading:!1,error:null,username:"",validators:{username:[He.lG()]}},t}return(0,r.Z)(i,[{key:"componentDidMount",value:function(){var e=this;A.Z.get(this.props.profile.api.moderate_username).then((function(){e.setState({isLoaded:!0})}),(function(t){e.setState({isLoaded:!0,error:t.detail})}))}},{key:"clean",value:function(){return!!this.isValid()||(I.Z.error(this.validate().username[0]),!1)}},{key:"send",value:function(){return A.Z.post(this.props.profile.api.moderate_username,{username:this.state.username})}},{key:"handleSuccess",value:function(e){this.setState({username:""}),ne.Z.dispatch((0,we.KP)(e,this.props.profile,this.props.user)),ne.Z.dispatch((0,ce._S)(this.props.profile,e.username,e.slug)),I.Z.success(pgettext("profile username moderation","Username has been changed."))}},{key:"getFormBody",value:function(){return(0,o.Z)("form",{onSubmit:this.handleSubmit},void 0,(0,o.Z)("div",{className:"modal-body"},void 0,(0,o.Z)(O.Z,{label:pgettext("profile username moderation field","New username"),for:"id_username"},void 0,(0,o.Z)("input",{type:"text",id:"id_username",className:"form-control",disabled:this.state.isLoading,onChange:this.bindInput("username"),value:this.state.username}))),(0,o.Z)("div",{className:"modal-footer"},void 0,(0,o.Z)("button",{className:"btn btn-default","data-dismiss":"modal",disabled:this.state.isLoading,type:"button"},void 0,pgettext("profile username moderation btn","Cancel")),(0,o.Z)(P.Z,{className:"btn-primary",loading:this.state.isLoading},void 0,pgettext("profile username moderation btn","Change username"))))}},{key:"getModalBody",value:function(){return this.state.error?(0,o.Z)(Ue.Z,{icon:"remove_circle_outline",message:this.state.error}):this.state.isLoaded?this.getFormBody():qe||(qe=(0,o.Z)(De.Z,{}))}},{key:"getClassName",value:function(){return this.state.error?"modal-dialog modal-message modal-rename-user":"modal-dialog modal-rename-user"}},{key:"render",value:function(){return(0,o.Z)("div",{className:this.getClassName(),role:"document"},void 0,(0,o.Z)("div",{className:"modal-content"},void 0,(0,o.Z)("div",{className:"modal-header"},void 0,(0,o.Z)("button",{type:"button",className:"close","data-dismiss":"modal","aria-label":pgettext("modal","Close")},void 0,Me||(Me=(0,o.Z)("span",{"aria-hidden":"true"},void 0,"×"))),(0,o.Z)("h4",{className:"modal-title"},void 0,pgettext("profile username moderation title","Change username"))),this.getModalBody()))}}]),i}(T.Z);var We,Qe,Ke,Xe=function(e){(0,c.Z)(i,e);var t,n,a=(t=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,a=(0,d.Z)(t);if(n){var i=(0,d.Z)(this).constructor;e=Reflect.construct(a,arguments,i)}else e=a.apply(this,arguments);return(0,u.Z)(this,e)});function i(e){var t;return(0,s.Z)(this,i),t=a.call(this,e),(0,p.Z)((0,l.Z)(t),"countdown",(function(){window.setTimeout((function(){t.state.countdown>1?(t.setState({countdown:t.state.countdown-1}),t.countdown()):t.state.confirm||t.setState({confirm:!0})}),1e3)})),t.state={isLoaded:!1,isLoading:!1,isDeleted:!1,error:null,countdown:5,confirm:!1,with_content:!1},t}return(0,r.Z)(i,[{key:"componentDidMount",value:function(){var e=this;A.Z.get(this.props.profile.api.delete).then((function(){e.setState({isLoaded:!0}),e.countdown()}),(function(t){e.setState({isLoaded:!0,error:t.detail})}))}},{key:"send",value:function(){return A.Z.post(this.props.profile.api.delete,{with_content:this.state.with_content})}},{key:"handleSuccess",value:function(){k.Z.stop("user-profile"),this.state.with_content?this.setState({isDeleted:interpolate(pgettext("profile delete","%(username)s's account, threads, posts and other content has been deleted."),{username:this.props.profile.username},!0)}):this.setState({isDeleted:interpolate(pgettext("profile delete","%(username)s's account has been deleted and other content has been hidden."),{username:this.props.profile.username},!0)})}},{key:"getButtonLabel",value:function(){return this.state.confirm?interpolate(pgettext("profile delete btn","Delete %(username)s"),{username:this.props.profile.username},!0):interpolate(pgettext("profile delete btn","Please wait... (%(countdown)ss)"),{countdown:this.state.countdown},!0)}},{key:"getForm",value:function(){return(0,o.Z)("form",{onSubmit:this.handleSubmit},void 0,(0,o.Z)("div",{className:"modal-body"},void 0,(0,o.Z)(O.Z,{label:pgettext("profile delete","User content"),for:"id_with_content"},void 0,(0,o.Z)(ze.Z,{id:"id_with_content",disabled:this.state.isLoading,labelOn:pgettext("profile delete content","Delete together with user's account"),labelOff:pgettext("profile delete content","Hide after deleting user's account"),onChange:this.bindInput("with_content"),value:this.state.with_content}))),(0,o.Z)("div",{className:"modal-footer"},void 0,(0,o.Z)("button",{type:"button",className:"btn btn-default","data-dismiss":"modal"},void 0,pgettext("profile delete btn","Cancel")),(0,o.Z)(P.Z,{className:"btn-danger",loading:this.state.isLoading,disabled:!this.state.confirm},void 0,this.getButtonLabel())))}},{key:"getDeletedBody",value:function(){return(0,o.Z)("div",{className:"modal-body"},void 0,Ve||(Ve=(0,o.Z)("div",{className:"message-icon"},void 0,(0,o.Z)("span",{className:"material-icon"},void 0,"info_outline"))),(0,o.Z)("div",{className:"message-body"},void 0,(0,o.Z)("p",{className:"lead"},void 0,this.state.isDeleted),(0,o.Z)("p",{},void 0,(0,o.Z)("a",{href:_.Z.get("USERS_LIST_URL")},void 0,pgettext("profile delete link","Return to users list")))))}},{key:"getModalBody",value:function(){return this.state.error?(0,o.Z)(Ue.Z,{icon:"remove_circle_outline",message:this.state.error}):this.state.isLoaded?this.state.isDeleted?this.getDeletedBody():this.getForm():Ye||(Ye=(0,o.Z)(De.Z,{}))}},{key:"getClassName",value:function(){return this.state.error||this.state.isDeleted?"modal-dialog modal-message modal-delete-account":"modal-dialog modal-delete-account"}},{key:"render",value:function(){return(0,o.Z)("div",{className:this.getClassName(),role:"document"},void 0,(0,o.Z)("div",{className:"modal-content"},void 0,(0,o.Z)("div",{className:"modal-header"},void 0,(0,o.Z)("button",{type:"button",className:"close","data-dismiss":"modal","aria-label":pgettext("modal","Close")},void 0,Ge||(Ge=(0,o.Z)("span",{"aria-hidden":"true"},void 0,"×"))),(0,o.Z)("h4",{className:"modal-title"},void 0,pgettext("profile delete title","Delete user account"))),this.getModalBody()))}}]),i}(T.Z),Je=n(59801);var et=function(e){return{tick:e.tick,user:e.auth,profile:e.profile}},tt=function(e){(0,c.Z)(h,e);var t,n,a=(t=h,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,a=(0,d.Z)(t);if(n){var i=(0,d.Z)(this).constructor;e=Reflect.construct(a,arguments,i)}else e=a.apply(this,arguments);return(0,u.Z)(this,e)});function h(){var e;(0,s.Z)(this,h);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return e=a.call.apply(a,[this].concat(n)),(0,p.Z)((0,l.Z)(e),"showAvatarDialog",(function(){Je.Z.show((0,i.$j)(et)(Fe))})),(0,p.Z)((0,l.Z)(e),"showRenameDialog",(function(){Je.Z.show((0,i.$j)(et)($e))})),(0,p.Z)((0,l.Z)(e),"showDeleteDialog",(function(){Je.Z.show((0,i.$j)(et)(Xe))})),e}return(0,r.Z)(h,[{key:"render",value:function(){var e=this.props.moderation;return(0,o.Z)("ul",{className:"dropdown-menu dropdown-menu-right",role:"menu"},void 0,!!e.avatar&&(0,o.Z)("li",{},void 0,(0,o.Z)("button",{type:"button",className:"btn btn-link",onClick:this.showAvatarDialog},void 0,We||(We=(0,o.Z)("span",{className:"material-icon"},void 0,"portrait")),pgettext("profile moderation menu","Avatar controls"))),!!e.rename&&(0,o.Z)("li",{},void 0,(0,o.Z)("button",{type:"button",className:"btn btn-link",onClick:this.showRenameDialog},void 0,Qe||(Qe=(0,o.Z)("span",{className:"material-icon"},void 0,"credit_card")),pgettext("profile moderation menu","Change username"))),!!e.delete&&(0,o.Z)("li",{},void 0,(0,o.Z)("button",{type:"button",className:"btn btn-link",onClick:this.showDeleteDialog},void 0,Ke||(Ke=(0,o.Z)("span",{className:"material-icon"},void 0,"clear")),pgettext("profile moderation menu","Delete account"))))}}]),h}(v().Component),nt=n(24678);const at=function(e){var t=e.profile;return(0,o.Z)("ul",{className:"profile-data-list"},void 0,!1===t.is_active&&(0,o.Z)("li",{className:"user-account-disabled"},void 0,(0,o.Z)("abbr",{title:pgettext("profile data list","This user's account has been disabled by administrator.")},void 0,pgettext("profile data list","Account disabled"))),(0,o.Z)("li",{className:"user-status-display"},void 0,(0,o.Z)(nt.ZP,{user:t,status:t.status},void 0,(0,o.Z)(nt.Jj,{user:t,status:t.status}),(0,o.Z)(nt.pg,{user:t,status:t.status,className:"status-label"}))),t.rank.is_tab?(0,o.Z)("li",{className:"user-rank"},void 0,(0,o.Z)("a",{href:t.rank.url,className:"item-title"},void 0,t.rank.name)):(0,o.Z)("li",{className:"user-rank"},void 0,(0,o.Z)("span",{className:"item-title"},void 0,t.rank.name)),(t.title||t.rank.title)&&(0,o.Z)("li",{className:"user-title"},void 0,t.title||t.rank.title),(0,o.Z)("li",{className:"user-joined-on"},void 0,(0,o.Z)("abbr",{title:interpolate(pgettext("profile data list","Joined on %(joined_on)s"),{joined_on:t.joined_on.format("LL, LT")},!0)},void 0,interpolate(pgettext("profile data list","Joined %(joined_on)s"),{joined_on:t.joined_on.fromNow()},!0))),t.email&&(0,o.Z)("li",{className:"user-email"},void 0,(0,o.Z)("a",{href:"mailto:"+t.email,className:"item-title"},void 0,t.email)))};var it,ot,st,rt,lt,ct=function(){return(0,o.Z)("button",{className:"btn btn-default btn-icon btn-outline dropdown-toggle",type:"button",title:pgettext("profile options btn","Options"),"data-toggle":"dropdown","aria-haspopup":"true","aria-expanded":"false"},void 0,lt||(lt=(0,o.Z)("span",{className:"material-icon"},void 0,"settings")))};const ut=function(e){var t=e.profile,n=e.user,a=e.moderation,i=e.message,s=e.follow;return(0,o.Z)(Le.sP,{},void 0,(0,o.Z)(Le.mr,{styleName:t.rank.css_class?"rank-"+t.rank.css_class:"profile"},void 0,(0,o.Z)(Le.gC,{styleName:t.rank.css_class?"rank-"+t.rank.css_class:"profile"},void 0,(0,o.Z)("div",{className:"profile-page-header"},void 0,(0,o.Z)("div",{className:"profile-page-header-avatar"},void 0,(0,o.Z)(me.ZP,{className:"user-avatar hidden-sm hidden-md hidden-lg",user:t,size:200,size2x:400}),(0,o.Z)(me.ZP,{className:"user-avatar hidden-xs hidden-md hidden-lg",user:t,size:64,size2x:128}),(0,o.Z)(me.ZP,{className:"user-avatar hidden-xs hidden-sm",user:t,size:128,size2x:256})),(0,o.Z)("h1",{},void 0,t.username))),(0,o.Z)(Le.eA,{className:"profile-page-header-details"},void 0,(0,o.Z)(Oe.gq,{},void 0,(0,o.Z)(Oe.kw,{auto:!0},void 0,(0,o.Z)(Oe.Z6,{},void 0,(0,o.Z)(at,{profile:t}))),i&&(0,o.Z)(Oe.kw,{},void 0,(0,o.Z)(Oe.Z6,{},void 0,(0,o.Z)(je,{className:"btn btn-default btn-block btn-outline",profile:t,user:n})),a.available&&!s&&(0,o.Z)(Oe.Z6,{shrink:!0},void 0,(0,o.Z)("div",{className:"dropdown"},void 0,it||(it=(0,o.Z)(ct,{})),(0,o.Z)(tt,{profile:t,moderation:a})))),s&&(0,o.Z)(Oe.kw,{},void 0,(0,o.Z)(Oe.Z6,{},void 0,(0,o.Z)(Te,{className:"btn btn-block btn-outline",profile:t})),a.available&&(0,o.Z)(Oe.Z6,{shrink:!0},void 0,(0,o.Z)("div",{className:"dropdown"},void 0,ot||(ot=(0,o.Z)(ct,{})),(0,o.Z)(tt,{profile:t,moderation:a})))),a.available&&!s&&!i&&(0,o.Z)(Oe.kw,{},void 0,(0,o.Z)(Oe.Z6,{className:"hidden-xs",shrink:!0},void 0,(0,o.Z)("div",{className:"dropdown"},void 0,st||(st=(0,o.Z)(ct,{})),(0,o.Z)(tt,{profile:t,moderation:a}))),(0,o.Z)(Oe.Z6,{className:"hidden-sm hidden-md hidden-lg"},void 0,(0,o.Z)("div",{className:"dropdown"},void 0,(0,o.Z)("button",{className:"btn btn-default btn-block btn-outline dropdown-toggle",type:"button","data-toggle":"dropdown","aria-haspopup":"true","aria-expanded":"false"},void 0,rt||(rt=(0,o.Z)("span",{className:"material-icon"},void 0,"settings")),pgettext("profile options btn","Options")),(0,o.Z)(tt,{profile:t,moderation:a}))))))))};var dt=n(69987),pt=n(94417);const ht=function(e){var t=e.baseUrl,n=e.page,a=e.pages;return(0,o.Z)("div",{className:"nav-container"},void 0,(0,o.Z)("div",{className:"dropdown hidden-sm hidden-md hidden-lg"},void 0,(0,o.Z)("button",{className:"btn btn-default btn-block btn-outline dropdown-toggle",type:"button","data-toggle":"dropdown","aria-haspopup":"true","aria-expanded":"false"},void 0,(0,o.Z)("span",{className:"material-icon"},void 0,n.icon),n.name),(0,o.Z)("ul",{className:"dropdown-menu stick-to-bottom"},void 0,a.map((function(e){return(0,o.Z)("li",{},e.component,(0,o.Z)(dt.rU,{to:t+e.component+"/"},void 0,(0,o.Z)("span",{className:"material-icon"},void 0,e.icon),e.name))})))),(0,o.Z)("ul",{className:"nav nav-pills hidden-xs",role:"menu"},void 0,a.map((function(e){return(0,o.Z)(pt.Z,{path:t+e.component+"/"},e.component,(0,o.Z)(dt.rU,{to:t+e.component+"/"},void 0,(0,o.Z)("span",{className:"material-icon"},void 0,e.icon),e.name))}))))};var vt=function(e){(0,c.Z)(i,e);var t,n,a=(t=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,a=(0,d.Z)(t);if(n){var i=(0,d.Z)(this).constructor;e=Reflect.construct(a,arguments,i)}else e=a.apply(this,arguments);return(0,u.Z)(this,e)});function i(e){var t;return(0,s.Z)(this,i),t=a.call(this,e),(0,p.Z)((0,l.Z)(t),"update",(function(e){ne.Z.dispatch((0,Ee.ZB)(e))})),t.startPolling(e.profile.api.index),t}return(0,r.Z)(i,[{key:"startPolling",value:function(e){k.Z.start({poll:"user-profile",url:e,frequency:9e4,update:this.update})}},{key:"render",value:function(){var e=this,t=_.Z.get("PROFILE").url,n=_.Z.get("PROFILE_PAGES"),a=n.filter((function(n){var a=t+n.component+"/";return e.props.location.pathname===a}))[0],i=this.props,s=i.profile,r=i.user,l=mt(s,r),c=!!r.acl.can_start_private_threads&&s.id!==r.id,u=!!s.acl.can_follow&&s.id!==r.id;return(0,o.Z)("div",{className:"page page-user-profile"},void 0,(0,o.Z)(ut,{profile:this.props.profile,user:this.props.user,moderation:l,message:c,follow:u}),(0,o.Z)(Se.Z,{},void 0,(0,o.Z)(ht,{baseUrl:t,page:a,pages:n}),this.props.children))}}]),i}(Re.Z),mt=function(e,t){var n={available:!1,rename:!1,avatar:!1,delete:!1};return t.is_anonymous||(n.rename=e.acl.can_rename,n.avatar=e.acl.can_moderate_avatar,n.delete=e.acl.can_delete,n.available=!!(n.rename||n.avatar||n.delete)),n};function ft(e){return{isAuthenticated:e.auth.user.id===e.profile.id,tick:e.tick.tick,user:e.auth.user,users:e.users,posts:e.posts,profile:e.profile,profileDetails:e["profile-details"],"username-history":e["username-history"]}}var Zt={posts:function(e){var t;t=e.user.id===e.profile.id?pgettext("profile posts","You have posted no messages."):interpolate(pgettext("profile posts","%(username)s posted no messages."),{username:e.profile.username},!0);var n=null;if(e.posts.isLoaded)if(e.profile.id===e.user.id){var a=npgettext("profile posts","You have posted %(posts)s message.","You have posted %(posts)s messages.",e.profile.posts);n=interpolate(a,{posts:e.profile.posts},!0)}else{var i=npgettext("profile posts","%(username)s has posted %(posts)s message.","%(username)s has posted %(posts)s messages.",e.profile.posts);n=interpolate(i,{username:e.profile.username,posts:e.profile.posts},!0)}else n=pgettext("profile posts","Loading...");return v().createElement(ie,(0,J.Z)({api:e.profile.api.posts,emptyMessage:t,header:n,title:pgettext("profile posts title","Posts")},e))},threads:function(e){var t;t=e.user.id===e.profile.id?pgettext("profile threads","You haven't started any threads."):interpolate(pgettext("profile threads","%(username)s hasn't started any threads"),{username:e.profile.username},!0);var n=null;if(e.posts.isLoaded)if(e.profile.id===e.user.id){var a=npgettext("profile threads","You have started %(threads)s thread.","You have started %(threads)s threads.",e.profile.threads);n=interpolate(a,{threads:e.profile.threads},!0)}else{var i=npgettext("profile threads","%(username)s has started %(threads)s thread.","%(username)s has started %(threads)s threads.",e.profile.threads);n=interpolate(i,{username:e.profile.username,threads:e.profile.threads},!0)}else n=pgettext("profile threads","Loading...");return v().createElement(ie,(0,J.Z)({api:e.profile.api.threads,emptyMessage:t,header:n,title:pgettext("profile threads title","Threads")},e))},followers:ue,follows:de,details:X,"username-history":Ce,"ban-details":w};function gt(){var e=[];return _.Z.get("PROFILE_PAGES").forEach((function(t){e.push(Object.assign({},t,{path:_.Z.get("PROFILE").url+t.component+"/",component:(0,i.$j)(ft)(Zt[t.component])}))})),e}var bt=n(39633);_.Z.addInitializer({name:"component:profile",initializer:function(e){e.has("PROFILE")&&e.has("PROFILE_PAGES")&&(0,bt.Z)({root:_.Z.get("PROFILE").url,component:(0,i.$j)(ft)(vt),paths:gt()})},after:"reducer:profile-hydrate"})},32488:(e,t,n)=>{"use strict";var a,i=n(15579),o=n(97326),s=n(4942),r=n(22928),l=n(15671),c=n(43144),u=n(79340),d=n(6215),p=n(61120),h=n(57588),v=n.n(h),m=n(82211),f=n(43345),Z=n(78657),g=n(53904),b=n(55210),y=n(93051);function _(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=(0,p.Z)(e);if(t){var i=(0,p.Z)(this).constructor;n=Reflect.construct(a,arguments,i)}else n=a.apply(this,arguments);return(0,d.Z)(this,n)}}var k=function(e){(0,u.Z)(n,e);var t=_(n);function n(e){var a;return(0,l.Z)(this,n),(a=t.call(this,e)).state={isLoading:!1,email:"",validators:{email:[b.Do()]}},a}return(0,c.Z)(n,[{key:"clean",value:function(){return!!this.isValid()||(g.Z.error(pgettext("request activation link form","Enter a valid e-mail address.")),!1)}},{key:"send",value:function(){return Z.Z.post(i.Z.get("SEND_ACTIVATION_API"),{email:this.state.email})}},{key:"handleSuccess",value:function(e){this.props.callback(e)}},{key:"handleError",value:function(e){["already_active","inactive_admin"].indexOf(e.code)>-1?g.Z.info(e.detail):403===e.status&&e.ban?(0,y.Z)(e.ban):g.Z.apiError(e)}},{key:"render",value:function(){return(0,r.Z)("div",{className:"well well-form well-form-request-activation-link"},void 0,(0,r.Z)("form",{onSubmit:this.handleSubmit},void 0,(0,r.Z)("div",{className:"form-group"},void 0,(0,r.Z)("div",{className:"control-input"},void 0,(0,r.Z)("input",{type:"text",className:"form-control",placeholder:pgettext("request activation link form field","Your e-mail address"),disabled:this.state.isLoading,onChange:this.bindInput("email"),value:this.state.email}))),(0,r.Z)(m.Z,{className:"btn-primary btn-block",loading:this.state.isLoading},void 0,pgettext("request activation link form btn","Send link"))))}}]),n}(f.Z),N=function(e){(0,u.Z)(n,e);var t=_(n);function n(){return(0,l.Z)(this,n),t.apply(this,arguments)}return(0,c.Z)(n,[{key:"getMessage",value:function(){return interpolate(pgettext("request activation link form","Activation link was sent to %(email)s"),{email:this.props.user.email},!0)}},{key:"render",value:function(){return(0,r.Z)("div",{className:"well well-form well-form-request-activation-link well-done"},void 0,(0,r.Z)("div",{className:"done-message"},void 0,a||(a=(0,r.Z)("div",{className:"message-icon"},void 0,(0,r.Z)("span",{className:"material-icon"},void 0,"check"))),(0,r.Z)("div",{className:"message-body"},void 0,(0,r.Z)("p",{},void 0,this.getMessage())),(0,r.Z)("button",{className:"btn btn-primary btn-block",type:"button",onClick:this.props.callback},void 0,pgettext("request activation link form btn","Request another link"))))}}]),n}(v().Component),x=function(e){(0,u.Z)(n,e);var t=_(n);function n(e){var a;return(0,l.Z)(this,n),a=t.call(this,e),(0,s.Z)((0,o.Z)(a),"complete",(function(e){a.setState({complete:e})})),(0,s.Z)((0,o.Z)(a),"reset",(function(){a.setState({complete:!1})})),a.state={complete:!1},a}return(0,c.Z)(n,[{key:"render",value:function(){return this.state.complete?(0,r.Z)(N,{user:this.state.complete,callback:this.reset}):(0,r.Z)(k,{callback:this.complete})}}]),n}(v().Component),w=n(4869);i.Z.addInitializer({name:"component:request-activation-link",initializer:function(){document.getElementById("request-activation-link-mount")&&(0,w.Z)(x,"request-activation-link-mount",!1)},after:"store"})},11768:(e,t,n)=>{"use strict";var a,i,o=n(15579),s=n(97326),r=n(4942),l=n(22928),c=n(15671),u=n(43144),d=n(79340),p=n(6215),h=n(61120),v=n(57588),m=n.n(v),f=n(73935),Z=n.n(f),g=n(82211),b=n(43345),y=n(78657),_=n(53904),k=n(55210),N=n(93051);function x(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=(0,h.Z)(e);if(t){var i=(0,h.Z)(this).constructor;n=Reflect.construct(a,arguments,i)}else n=a.apply(this,arguments);return(0,p.Z)(this,n)}}var w=function(e){(0,d.Z)(n,e);var t=x(n);function n(e){var a;return(0,c.Z)(this,n),(a=t.call(this,e)).state={isLoading:!1,email:"",validators:{email:[k.Do()]}},a}return(0,u.Z)(n,[{key:"clean",value:function(){return!!this.isValid()||(_.Z.error(pgettext("request password reset form","Enter a valid e-mail address.")),!1)}},{key:"send",value:function(){return y.Z.post(o.Z.get("SEND_PASSWORD_RESET_API"),{email:this.state.email})}},{key:"handleSuccess",value:function(e){this.props.callback(e)}},{key:"handleError",value:function(e){["inactive_user","inactive_admin"].indexOf(e.code)>-1?this.props.showInactivePage(e):403===e.status&&e.ban?(0,N.Z)(e.ban):_.Z.apiError(e)}},{key:"render",value:function(){return(0,l.Z)("div",{className:"well well-form well-form-request-password-reset"},void 0,(0,l.Z)("form",{onSubmit:this.handleSubmit},void 0,(0,l.Z)("div",{className:"form-group"},void 0,(0,l.Z)("div",{className:"control-input"},void 0,(0,l.Z)("input",{type:"text",className:"form-control",placeholder:pgettext("request password reset form field","Your e-mail address"),disabled:this.state.isLoading,onChange:this.bindInput("email"),value:this.state.email}))),(0,l.Z)(g.Z,{className:"btn-primary btn-block",loading:this.state.isLoading},void 0,pgettext("request password reset form btn","Send link"))))}}]),n}(b.Z),C=function(e){(0,d.Z)(n,e);var t=x(n);function n(){return(0,c.Z)(this,n),t.apply(this,arguments)}return(0,u.Z)(n,[{key:"getMessage",value:function(){return interpolate(pgettext("request password reset form","Reset password link was sent to %(email)s"),{email:this.props.user.email},!0)}},{key:"render",value:function(){return(0,l.Z)("div",{className:"well well-form well-form-request-password-reset well-done"},void 0,(0,l.Z)("div",{className:"done-message"},void 0,a||(a=(0,l.Z)("div",{className:"message-icon"},void 0,(0,l.Z)("span",{className:"material-icon"},void 0,"check"))),(0,l.Z)("div",{className:"message-body"},void 0,(0,l.Z)("p",{},void 0,this.getMessage())),(0,l.Z)("button",{type:"button",className:"btn btn-primary btn-block",onClick:this.props.callback},void 0,pgettext("request password reset form btn","Request another link"))))}}]),n}(m().Component),R=function(e){(0,d.Z)(n,e);var t=x(n);function n(){return(0,c.Z)(this,n),t.apply(this,arguments)}return(0,u.Z)(n,[{key:"getActivateButton",value:function(){return"inactive_user"===this.props.activation?(0,l.Z)("p",{},void 0,(0,l.Z)("a",{href:o.Z.get("REQUEST_ACTIVATION_URL")},void 0,pgettext("request password reset form error","Activate your account."))):null}},{key:"render",value:function(){return(0,l.Z)("div",{className:"page page-message page-message-info page-forgotten-password-inactive"},void 0,(0,l.Z)("div",{className:"container"},void 0,(0,l.Z)("div",{className:"message-panel"},void 0,i||(i=(0,l.Z)("div",{className:"message-icon"},void 0,(0,l.Z)("span",{className:"material-icon"},void 0,"info_outline"))),(0,l.Z)("div",{className:"message-body"},void 0,(0,l.Z)("p",{className:"lead"},void 0,pgettext("request password reset form error","Your account is inactive.")),(0,l.Z)("p",{},void 0,this.props.message),this.getActivateButton()))))}}]),n}(m().Component),E=function(e){(0,d.Z)(n,e);var t=x(n);function n(e){var a;return(0,c.Z)(this,n),a=t.call(this,e),(0,r.Z)((0,s.Z)(a),"complete",(function(e){a.setState({complete:e})})),(0,r.Z)((0,s.Z)(a),"reset",(function(){a.setState({complete:!1})})),a.state={complete:!1},a}return(0,u.Z)(n,[{key:"showInactivePage",value:function(e){Z().render((0,l.Z)(R,{activation:e.code,message:e.detail}),document.getElementById("page-mount"))}},{key:"render",value:function(){return this.state.complete?(0,l.Z)(C,{callback:this.reset,user:this.state.complete}):(0,l.Z)(w,{callback:this.complete,showInactivePage:this.showInactivePage})}}]),n}(m().Component),S=n(4869);o.Z.addInitializer({name:"component:request-password-reset",initializer:function(){document.getElementById("request-password-reset-mount")&&(0,S.Z)(E,"request-password-reset-mount",!1)},after:"store"})},61323:(e,t,n)=>{"use strict";var a,i=n(15579),o=n(97326),s=n(4942),r=n(22928),l=n(15671),c=n(43144),u=n(79340),d=n(6215),p=n(61120),h=n(57588),v=n.n(h),m=n(73935),f=n.n(m),Z=n(82211),g=n(43345),b=n(14467),y=n(78657),_=n(98274),k=n(59801),N=n(53904),x=n(93051),w=n(19755);function C(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=(0,p.Z)(e);if(t){var i=(0,p.Z)(this).constructor;n=Reflect.construct(a,arguments,i)}else n=a.apply(this,arguments);return(0,d.Z)(this,n)}}var R=function(e){(0,u.Z)(n,e);var t=C(n);function n(e){var a;return(0,l.Z)(this,n),(a=t.call(this,e)).state={isLoading:!1,password:""},a}return(0,c.Z)(n,[{key:"clean",value:function(){return!!this.state.password.trim().length||(N.Z.error(pgettext("password reset form","Enter new password.")),!1)}},{key:"send",value:function(){return y.Z.post(i.Z.get("CHANGE_PASSWORD_API"),{password:this.state.password})}},{key:"handleSuccess",value:function(e){this.props.callback(e)}},{key:"handleError",value:function(e){403===e.status&&e.ban?(0,x.Z)(e.ban):N.Z.apiError(e)}},{key:"render",value:function(){return(0,r.Z)("div",{className:"well well-form well-form-reset-password"},void 0,(0,r.Z)("form",{onSubmit:this.handleSubmit},void 0,(0,r.Z)("div",{className:"form-group"},void 0,(0,r.Z)("div",{className:"control-input"},void 0,(0,r.Z)("input",{type:"password",className:"form-control",placeholder:pgettext("password reset form field","Enter new password"),disabled:this.state.isLoading,onChange:this.bindInput("password"),value:this.state.password}))),(0,r.Z)(Z.Z,{className:"btn-primary btn-block",loading:this.state.isLoading},void 0,pgettext("password reset form btn","Change password"))))}}]),n}(g.Z),E=function(e){(0,u.Z)(n,e);var t=C(n);function n(){return(0,l.Z)(this,n),t.apply(this,arguments)}return(0,c.Z)(n,[{key:"getMessage",value:function(){return interpolate(pgettext("password reset form","%(username)s, your password has been changed."),{username:this.props.user.username},!0)}},{key:"showSignIn",value:function(){k.Z.show(b.Z)}},{key:"render",value:function(){return(0,r.Z)("div",{className:"page page-message page-message-success page-forgotten-password-changed"},void 0,(0,r.Z)("div",{className:"container"},void 0,(0,r.Z)("div",{className:"message-panel"},void 0,a||(a=(0,r.Z)("div",{className:"message-icon"},void 0,(0,r.Z)("span",{className:"material-icon"},void 0,"check"))),(0,r.Z)("div",{className:"message-body"},void 0,(0,r.Z)("p",{className:"lead"},void 0,this.getMessage()),(0,r.Z)("p",{},void 0,pgettext("password reset form","Sign in using new password to continue.")),(0,r.Z)("p",{},void 0,(0,r.Z)("button",{type:"button",className:"btn btn-primary",onClick:this.showSignIn},void 0,pgettext("password reset form btn","Sign in")))))))}}]),n}(v().Component),S=function(e){(0,u.Z)(n,e);var t=C(n);function n(){var e;(0,l.Z)(this,n);for(var a=arguments.length,i=new Array(a),c=0;c<a;c++)i[c]=arguments[c];return e=t.call.apply(t,[this].concat(i)),(0,s.Z)((0,o.Z)(e),"complete",(function(e){_.Z.softSignOut(),w('#hidden-login-form input[name="next"]').remove(),f().render((0,r.Z)(E,{user:e}),document.getElementById("page-mount"))})),e}return(0,c.Z)(n,[{key:"render",value:function(){return(0,r.Z)(R,{callback:this.complete})}}]),n}(v().Component),O=n(4869);i.Z.addInitializer({name:"component:reset-password-form",initializer:function(){document.getElementById("reset-password-form-mount")&&(0,O.Z)(S,"reset-password-form-mount",!1)},after:"store"})},64752:(e,t,n)=>{"use strict";var a,i=n(22928),o=(n(57588),n(73935)),s=n.n(o),r=n(37424),l=n(62989),c=n(90287);misago.addInitializer({name:"component:search-overlay",initializer:function(e){var t=document.getElementById("search-mount");s().render((0,i.Z)(r.zt,{store:c.Z.getStore()},void 0,a||(a=(0,i.Z)(l.F,{}))),t)},after:"store"})},40949:(e,t,n)=>{"use strict";var a,i=n(37424),o=n(22928),s=n(87462),r=n(57588),l=n.n(r),c=n(59131),u=n(15671),d=n(43144),p=n(97326),h=n(79340),v=n(6215),m=n(61120),f=n(4942),Z=n(15579),g=n(43345),b=n(21981),y=n(16427),_=n(6935),k=n(78657),N=n(53904),x=n(90287),w=n(98936),C=n(99755);var R=function(e){(0,h.Z)(s,e);var t,n,i=(t=s,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,a=(0,m.Z)(t);if(n){var i=(0,m.Z)(this).constructor;e=Reflect.construct(a,arguments,i)}else e=a.apply(this,arguments);return(0,v.Z)(this,e)});function s(e){var t;return(0,u.Z)(this,s),t=i.call(this,e),(0,f.Z)((0,p.Z)(t),"onQueryChange",(function(e){t.changeValue("query",e.target.value)})),t.state={isLoading:!1,query:e.search.query},t}return(0,d.Z)(s,[{key:"componentDidMount",value:function(){this.state.query.length&&this.handleSubmit()}},{key:"clean",value:function(){return!!this.state.query.trim().length||(N.Z.error(pgettext("search form","You have to enter search query.")),!1)}},{key:"send",value:function(){x.Z.dispatch((0,y.Vx)({isLoading:!0}));var e=this.state.query.trim(),t=window.location.href,n=t.indexOf("?q=");return n>0&&(t=t.substring(0,n+3)),window.history.pushState({},"",t+encodeURIComponent(e)),k.Z.get(Z.Z.get("SEARCH_API"),{q:e})}},{key:"handleSuccess",value:function(e){x.Z.dispatch((0,y.Vx)({query:this.state.query.trim(),isLoading:!1,providers:e})),e.forEach((function(e){"users"===e.id?x.Z.dispatch((0,_.ZB)(e.results.results)):"threads"===e.id&&x.Z.dispatch((0,b.zD)(e.results))}))}},{key:"handleError",value:function(e){N.Z.apiError(e),x.Z.dispatch((0,y.Vx)({isLoading:!1}))}},{key:"render",value:function(){return(0,o.Z)("form",{onSubmit:this.handleSubmit},void 0,(0,o.Z)(C.sP,{},void 0,(0,o.Z)(C.mr,{styleName:"site-search"},void 0,(0,o.Z)(C.gC,{styleName:"site-search"},void 0,(0,o.Z)("h1",{},void 0,pgettext("search form title","Search"))),(0,o.Z)(C.eA,{className:"page-header-search-form"},void 0,(0,o.Z)(w.gq,{},void 0,(0,o.Z)(w.kw,{auto:!0},void 0,(0,o.Z)(w.Z6,{},void 0,(0,o.Z)("input",{className:"form-control",disabled:this.state.isLoading,type:"text",value:this.state.query,placeholder:pgettext("search form input","Search"),onChange:this.onQueryChange})),(0,o.Z)(w.Z6,{shrink:!0},void 0,(0,o.Z)("button",{className:"btn btn-secondary btn-icon btn-outline",title:pgettext("search form btn","Search"),disabled:this.state.isLoading},void 0,a||(a=(0,o.Z)("span",{className:"material-icon"},void 0,"search"))))))))))}}]),s}(g.Z),E=n(69987);function S(e){return(0,o.Z)("div",{className:"list-group nav-side"},void 0,e.providers.map((function(e){return(0,o.Z)(E.rU,{activeClassName:"active",className:"list-group-item",to:e.url},e.id,(0,o.Z)("span",{className:"material-icon"},void 0,e.icon),e.name,(0,o.Z)(O,{results:e.results}))})))}function O(e){if(!e.results)return null;var t=e.results.count;return t>1e6?t=Math.ceil(t/1e6)+"KK":t>1e3&&(t=Math.ceil(t/1e3)+"K"),(0,o.Z)("span",{className:"badge"},void 0,t)}function L(e){return(0,o.Z)("div",{className:"page page-search"},void 0,(0,o.Z)(R,{provider:e.provider,search:e.search}),(0,o.Z)(c.Z,{},void 0,(0,o.Z)("div",{className:"row"},void 0,(0,o.Z)("div",{className:"col-md-3"},void 0,(0,o.Z)(S,{providers:e.search.providers})),(0,o.Z)("div",{className:"col-md-9"},void 0,e.children,(0,o.Z)(P,{provider:e.provider,search:e.search})))))}function P(e){var t=null;if(e.search.providers.forEach((function(n){n.id===e.provider.id&&(t=n.time)})),null===t)return null;var n=pgettext("search time","Search took %(time)s s");return(0,o.Z)("footer",{className:"search-footer"},void 0,(0,o.Z)("p",{},void 0,interpolate(n,{time:t},!0)))}var T=n(11005),A=n(82211);function I(e){return(0,o.Z)("div",{},void 0,(0,o.Z)(T.Z,{isReady:!0,posts:e.results}),l().createElement(B,e))}n(69092);var B=function(e){(0,h.Z)(i,e);var t,n,a=(t=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,a=(0,m.Z)(t);if(n){var i=(0,m.Z)(this).constructor;e=Reflect.construct(a,arguments,i)}else e=a.apply(this,arguments);return(0,v.Z)(this,e)});function i(){var e;(0,u.Z)(this,i);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return e=a.call.apply(a,[this].concat(n)),(0,f.Z)((0,p.Z)(e),"onClick",(function(){x.Z.dispatch((0,b.Vx)({isBusy:!0})),k.Z.get(e.props.provider.api,{q:e.props.query,page:e.props.next}).then((function(e){e.forEach((function(e){"threads"===e.id&&(x.Z.dispatch((0,b.R3)(e.results)),x.Z.dispatch((0,y.P0)(e)))})),x.Z.dispatch((0,b.Vx)({isBusy:!1}))}),(function(e){N.Z.apiError(e),x.Z.dispatch((0,b.Vx)({isBusy:!1}))}))})),e}return(0,d.Z)(i,[{key:"render",value:function(){return this.props.more?(0,o.Z)("div",{className:"pager-more"},void 0,(0,o.Z)(A.Z,{className:"btn btn-default btn-outline",loading:this.props.isBusy,onClick:this.onClick},void 0,pgettext("search threads btn","Show more"))):null}}]),i}(l().Component);function j(e){var t=e.children,n=e.loading,a=e.posts,i=e.query;return a&&a.count?t:i.length?(0,o.Z)("p",{className:"lead"},void 0,n?pgettext("search threads","Loading results..."):pgettext("search threads","No threads matching search query have been found.")):(0,o.Z)("p",{className:"lead"},void 0,pgettext("search threads","Enter at least two characters to search threads."))}var D=n(40429);function z(e){var t=e.children,n=e.loading,a=e.query;return e.users.length?t:a.length?(0,o.Z)("p",{className:"lead"},void 0,n?pgettext("search users","Loading results..."):pgettext("search users","No users matching search query have been found.")):(0,o.Z)("p",{className:"lead"},void 0,pgettext("search users","Enter at least two characters to search users."))}var U={threads:function(e){return(0,o.Z)(L,{provider:e.route.provider,search:e.search},void 0,(0,o.Z)(j,{loading:e.search.isLoading,query:e.search.query,posts:e.posts},void 0,l().createElement(I,(0,s.Z)({provider:e.route.provider,query:e.search.query},e.posts))))},users:function(e){return(0,o.Z)(L,{provider:e.route.provider,search:e.search},void 0,(0,o.Z)(z,{loading:e.search.isLoading,query:e.search.query,users:e.users},void 0,(0,o.Z)(D.Z,{cols:3,isReady:!e.search.isLoading,users:e.users})))}};function q(e){return{posts:e.posts,search:e.search,tick:e.tick.tick,user:e.auth.user,users:e.users}}var M=n(39633);Z.Z.addInitializer({name:"component:search",initializer:function(e){var t;"misago:search"===e.get("CURRENT_LINK")&&(0,M.Z)({paths:(t=Z.Z.get("SEARCH_PROVIDERS"),t.map((function(e){return{path:e.url,component:(0,i.$j)(q)(U[e.id]),provider:e}})))})},after:"store"})},78679:(e,t,n)=>{"use strict";var a,i=n(22928),o=(n(57588),n(73935)),s=n.n(o),r=n(37424),l=n(6333),c=n(90287);misago.addInitializer({name:"component:site-nav-overlay",initializer:function(e){var t=document.getElementById("site-nav-mount");s().render((0,i.Z)(r.zt,{store:c.Z.getStore()},void 0,a||(a=(0,i.Z)(l.Or,{}))),t)},after:"store"})},61814:(e,t,n)=>{"use strict";var a=n(37424),i=n(15579),o=n(22928),s=n(15671),r=n(43144),l=n(79340),c=n(6215),u=n(61120),d=n(57588);var p={info:"alert-info",success:"alert-success",warning:"alert-warning",error:"alert-danger"},h=function(e){(0,l.Z)(i,e);var t,n,a=(t=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,a=(0,u.Z)(t);if(n){var i=(0,u.Z)(this).constructor;e=Reflect.construct(a,arguments,i)}else e=a.apply(this,arguments);return(0,c.Z)(this,e)});function i(){return(0,s.Z)(this,i),a.apply(this,arguments)}return(0,r.Z)(i,[{key:"getSnackbarClass",value:function(){var e="alerts-snackbar";return this.props.isVisible?e+=" in":e+=" out",e}},{key:"render",value:function(){return(0,o.Z)("div",{className:this.getSnackbarClass()},void 0,(0,o.Z)("p",{className:"alert "+p[this.props.type]},void 0,this.props.message))}}]),i}(n.n(d)().Component);function v(e){return e.snackbar}var m=n(4869);i.Z.addInitializer({name:"component:snackbar",initializer:function(){(0,m.Z)((0,a.$j)(v)(h),"snackbar-mount")},after:"snackbar"})},95920:(e,t,n)=>{"use strict";var a=n(57588),i=n.n(a),o=n(22928),s=n(15671),r=n(43144),l=n(97326),c=n(79340),u=n(6215),d=n(61120),p=n(4942),h=n(15579),v=n(26106),m=n(82211),f=n(43345),Z=n(96359),g=n(78657),b=n(53904),y=n(55210),_=n(59131),k=n(99755);const N=function(e){var t=e.backendName,n=pgettext("social auth title","Sign in with %(backend)s"),a=interpolate(n,{backend:t},!0);return(0,o.Z)(k.sP,{},void 0,(0,o.Z)(k.mr,{styleName:"social-auth"},void 0,(0,o.Z)(k.gC,{styleName:"social-auth"},void 0,(0,o.Z)("h1",{},void 0,a))))};function x(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function w(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?x(Object(n),!0).forEach((function(t){(0,p.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):x(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var C=function(e){(0,c.Z)(i,e);var t,n,a=(t=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,a=(0,d.Z)(t);if(n){var i=(0,d.Z)(this).constructor;e=Reflect.construct(a,arguments,i)}else e=a.apply(this,arguments);return(0,u.Z)(this,e)});function i(e){var t;(0,s.Z)(this,i),t=a.call(this,e),(0,p.Z)((0,l.Z)(t),"handlePrivacyPolicyChange",(function(e){var n=e.target.value;t.handleToggleAgreement("privacyPolicy",n)})),(0,p.Z)((0,l.Z)(t),"handleTermsOfServiceChange",(function(e){var n=e.target.value;t.handleToggleAgreement("termsOfService",n)})),(0,p.Z)((0,l.Z)(t),"handleToggleAgreement",(function(e,n){t.setState((function(a,i){if(null===a[e]){var o=w(w({},a.errors),{},(0,p.Z)({},e,null));return(0,p.Z)({errors:o},e,n)}var s=t.state.validators[e][0],r=w(w({},a.errors),{},(0,p.Z)({},e,[s(null)]));return(0,p.Z)({errors:r},e,null)}))}));var n={email:[y.Do()],username:[y.lG()]};return h.Z.get("TERMS_OF_SERVICE_ID")&&(n.termsOfService=[y.fT()]),h.Z.get("PRIVACY_POLICY_ID")&&(n.privacyPolicy=[y.jA()]),t.state={email:e.email||"",emailProtected:!!e.email,username:e.username||"",termsOfService:null,privacyPolicy:null,validators:n,errors:{},isLoading:!1},t}return(0,r.Z)(i,[{key:"clean",value:function(){if(this.validate(),-1!==[this.state.email.trim().length,this.state.username.trim().length].indexOf(0))return b.Z.error(pgettext("social auth form","Fill out all fields.")),!1;var e=this.state.validators;return h.Z.get("TERMS_OF_SERVICE_ID")&&null===this.state.termsOfService?(b.Z.error(e.termsOfService[0](null)),!1):!h.Z.get("PRIVACY_POLICY_ID")||null!==this.state.privacyPolicy||(b.Z.error(e.privacyPolicy[0](null)),!1)}},{key:"send",value:function(){return g.Z.post(this.props.url,{email:this.state.email,username:this.state.username,terms_of_service:this.state.termsOfService,privacy_policy:this.state.privacyPolicy})}},{key:"handleSuccess",value:function(e){(0,this.props.onRegistrationComplete)(e)}},{key:"handleError",value:function(e){if(200===e.status)(0,this.props.onRegistrationComplete)({activation:"active",step:"done",username:this.state.username});else if(400===e.status){var t={errors:e};e.email&&(t.emailProtected=!1),this.setState(t)}else b.Z.apiError(e)}},{key:"render",value:function(){var e=this.props.backend_name,t=this.state,n=t.email,a=t.emailProtected,i=t.username,s=t.isLoading,r=null;if(a){var l=pgettext("social auth form","Your e-mail address has been verified by %(backend)s.");r=interpolate(l,{backend:e},!0)}return(0,o.Z)("div",{className:"page page-social-auth page-social-auth-register"},void 0,(0,o.Z)(N,{backendName:e}),(0,o.Z)(_.Z,{},void 0,(0,o.Z)("div",{className:"row"},void 0,(0,o.Z)("div",{className:"col-md-6 col-md-offset-3"},void 0,(0,o.Z)("form",{onSubmit:this.handleSubmit},void 0,(0,o.Z)("div",{className:"panel panel-default panel-form"},void 0,(0,o.Z)("div",{className:"panel-heading"},void 0,(0,o.Z)("h3",{className:"panel-title"},void 0,pgettext("social auth form title","Complete your account"))),(0,o.Z)("div",{className:"panel-body"},void 0,(0,o.Z)(Z.Z,{for:"id_username",label:pgettext("social auth form field","Username"),validation:this.state.errors.username},void 0,(0,o.Z)("input",{type:"text",id:"id_username",className:"form-control",disabled:s,onChange:this.bindInput("username"),value:i})),(0,o.Z)(Z.Z,{for:"id_email",label:pgettext("social auth form field","E-mail address"),helpText:r,validation:a?null:this.state.errors.email},void 0,(0,o.Z)("input",{type:"email",id:"id_email",className:"form-control",disabled:s||a,onChange:this.bindInput("email"),value:n})),(0,o.Z)(v.Z,{errors:this.state.errors,privacyPolicy:this.state.privacyPolicy,termsOfService:this.state.termsOfService,onPrivacyPolicyChange:this.handlePrivacyPolicyChange,onTermsOfServiceChange:this.handleTermsOfServiceChange})),(0,o.Z)("div",{className:"panel-footer"},void 0,(0,o.Z)(m.Z,{className:"btn-primary",loading:this.state.isLoading},void 0,pgettext("social auth form btn","Sign in")))))))))}}]),i}(f.Z);const R=function(e){var t,n,a=e.activation,i=e.backend_name,s=e.username;return n="user"===a?pgettext("account activation required","%(username)s, your account has been created but you need to activate it before you will be able to sign in."):"admin"===a?pgettext("account activation required","%(username)s, your account has been created but the site administrator will have to activate it before you will be able to sign in."):pgettext("social auth complete","%(username)s, your account has been created and you have been signed in to it."),t="active"===a?"check":"info_outline",(0,o.Z)("div",{className:"page page-social-auth page-social-auth-register"},void 0,(0,o.Z)(N,{backendName:i}),(0,o.Z)(_.Z,{},void 0,(0,o.Z)("div",{className:"row"},void 0,(0,o.Z)("div",{className:"col-md-6 col-md-offset-3"},void 0,(0,o.Z)("div",{className:"panel panel-default panel-form"},void 0,(0,o.Z)("div",{className:"panel-heading"},void 0,(0,o.Z)("h3",{className:"panel-title"},void 0,pgettext("social auth complete title","Registration completed!"))),(0,o.Z)("div",{className:"panel-body panel-message-body"},void 0,(0,o.Z)("div",{className:"message-icon"},void 0,(0,o.Z)("span",{className:"material-icon"},void 0,t)),(0,o.Z)("div",{className:"message-body"},void 0,(0,o.Z)("p",{className:"lead"},void 0,interpolate(n,{username:s},!0)),(0,o.Z)("p",{className:"help-block"},void 0,(0,o.Z)("a",{className:"btn btn-default",href:h.Z.get("MISAGO_PATH")},void 0,pgettext("social auth complete link","Return to forum index"))))))))))};var E=function(e){(0,c.Z)(i,e);var t,n,a=(t=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,a=(0,d.Z)(t);if(n){var i=(0,d.Z)(this).constructor;e=Reflect.construct(a,arguments,i)}else e=a.apply(this,arguments);return(0,u.Z)(this,e)});function i(e){var t;return(0,s.Z)(this,i),t=a.call(this,e),(0,p.Z)((0,l.Z)(t),"handleRegistrationComplete",(function(e){var n=e.activation,a=e.email,i=e.step,o=e.username;t.setState({activation:n,email:a,step:i,username:o})})),t.state={step:e.step,activation:e.activation||"",email:e.email||"",username:e.username||""},t}return(0,r.Z)(i,[{key:"render",value:function(){var e=this.props,t=e.backend_name,n=e.url,a=this.state,i=a.activation,s=a.email,r=a.step,l=a.username;return"register"===r?(0,o.Z)(C,{backend_name:t,email:s,url:n,username:l,onRegistrationComplete:this.handleRegistrationComplete}):(0,o.Z)(R,{activation:i,backend_name:t,email:s,url:n,username:l})}}]),i}(i().Component),S=n(4869);h.Z.addInitializer({name:"component:social-auth",initializer:function(e){if("misago:social-complete"===e.get("CURRENT_LINK")){var t=e.get("SOCIAL_AUTH_FORM");(0,S.Z)(i().createElement(E,t),"page-mount")}},after:"store"})},44095:(e,t,n)=>{"use strict";var a,i,o=n(37424),s=n(22928),r=n(15671),l=n(43144),c=n(97326),u=n(79340),d=n(6215),p=n(61120),h=n(4942),v=n(57588),m=n.n(v),f=n(87462),Z=n(43345),g=n(96359),b=n(8154),y=n(7738),_=n(78657),k=n(59801),N=n(53904),x=n(90287);var w,C=function(e){(0,u.Z)(o,e);var t,n,i=(t=o,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,a=(0,p.Z)(t);if(n){var i=(0,p.Z)(this).constructor;e=Reflect.construct(a,arguments,i)}else e=a.apply(this,arguments);return(0,d.Z)(this,e)});function o(e){var t;return(0,r.Z)(this,o),t=i.call(this,e),(0,h.Z)((0,c.Z)(t),"onUsernameChange",(function(e){t.changeValue("username",e.target.value)})),t.state={isLoading:!1,username:""},t}return(0,l.Z)(o,[{key:"clean",value:function(){return!!this.state.username.trim().length||(N.Z.error(pgettext("add private thread participant","You have to enter user name.")),!1)}},{key:"send",value:function(){return _.Z.patch(this.props.thread.api.index,[{op:"add",path:"participants",value:this.state.username},{op:"add",path:"acl",value:1}])}},{key:"handleSuccess",value:function(e){x.Z.dispatch((0,y.y8)(e)),x.Z.dispatch(b.gx(e.participants)),N.Z.success(pgettext("add private thread participant","New participant has been added to thread.")),k.Z.hide()}},{key:"render",value:function(){return(0,s.Z)("div",{className:"modal-dialog modal-sm",role:"document"},void 0,(0,s.Z)("form",{onSubmit:this.handleSubmit},void 0,(0,s.Z)("div",{className:"modal-content"},void 0,a||(a=(0,s.Z)(R,{})),(0,s.Z)("div",{className:"modal-body"},void 0,(0,s.Z)(g.Z,{for:"id_username",label:pgettext("add private thread participant field","User to add")},void 0,(0,s.Z)("input",{id:"id_username",className:"form-control",disabled:this.state.isLoading,onChange:this.onUsernameChange,type:"text",value:this.state.username}))),(0,s.Z)("div",{className:"modal-footer"},void 0,(0,s.Z)("button",{className:"btn btn-block btn-primary",disabled:this.state.isLoading},void 0,pgettext("add private thread participant btn","Add participant")),(0,s.Z)("button",{className:"btn btn-block btn-default","data-dismiss":"modal",disabled:this.state.isLoading,type:"button"},void 0,pgettext("add private thread participant btn","Cancel"))))))}}]),o}(Z.Z);function R(e){return(0,s.Z)("div",{className:"modal-header"},void 0,(0,s.Z)("button",{"aria-label":pgettext("modal","Close"),className:"close","data-dismiss":"modal",type:"button"},void 0,i||(i=(0,s.Z)("span",{"aria-hidden":"true"},void 0,"×"))),(0,s.Z)("h4",{className:"modal-title"},void 0,pgettext("add private thread participant modal title","Add participant")))}var E=function(e){(0,u.Z)(i,e);var t,n,a=(t=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,a=(0,p.Z)(t);if(n){var i=(0,p.Z)(this).constructor;e=Reflect.construct(a,arguments,i)}else e=a.apply(this,arguments);return(0,d.Z)(this,e)});function i(){var e;(0,r.Z)(this,i);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return e=a.call.apply(a,[this].concat(n)),(0,h.Z)((0,c.Z)(e),"onClick",(function(){k.Z.show((0,s.Z)(C,{thread:e.props.thread}))})),e}return(0,l.Z)(i,[{key:"render",value:function(){return this.props.thread.acl.can_add_participants?(0,s.Z)("div",{className:"col-xs-12 col-sm-3"},void 0,(0,s.Z)("button",{className:"btn btn-default btn-block",onClick:this.onClick,type:"button"},void 0,w||(w=(0,s.Z)("span",{className:"material-icon"},void 0,"person_add")),pgettext("add participant btn","Add participant"))):null}}]),i}(m().Component),S=n(15579);var O=function(e){(0,u.Z)(i,e);var t,n,a=(t=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,a=(0,p.Z)(t);if(n){var i=(0,p.Z)(this).constructor;e=Reflect.construct(a,arguments,i)}else e=a.apply(this,arguments);return(0,d.Z)(this,e)});function i(e){var t;return(0,r.Z)(this,i),t=a.call(this,e),(0,h.Z)((0,c.Z)(t),"onClick",(function(){var e,n,a=!1;if(t.isUser)a=window.confirm(pgettext("private thread owner change","Are you sure you want to take over this thread?"));else{var i=pgettext("private thread owner change","Are you sure you want to change thread owner to %(user)s?");a=window.confirm(interpolate(i,{user:t.props.participant.username},!0))}a&&(e=t.props.thread,n=t.props.participant,_.Z.patch(e.api.index,[{op:"replace",path:"owner",value:n.id},{op:"add",path:"acl",value:1}]).then((function(e){x.Z.dispatch((0,y.y8)(e)),x.Z.dispatch(b.gx(e.participants));var t=pgettext("thread participants actions","%(user)s has been made new thread owner.");N.Z.success(interpolate(t,{user:n.username},!0))}),(function(e){N.Z.apiError(e)})))})),t.isUser=e.participant.id===e.user.id,t}return(0,l.Z)(i,[{key:"render",value:function(){return this.props.participant.is_owner?null:this.props.thread.acl.can_change_owner?(0,s.Z)("li",{},void 0,(0,s.Z)("button",{className:"btn btn-link",onClick:this.onClick,type:"button"},void 0,pgettext("private thread owner change btn","Make owner"))):null}}]),i}(m().Component);var L,P,T,A=function(e){(0,u.Z)(i,e);var t,n,a=(t=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,a=(0,p.Z)(t);if(n){var i=(0,p.Z)(this).constructor;e=Reflect.construct(a,arguments,i)}else e=a.apply(this,arguments);return(0,d.Z)(this,e)});function i(e){var t;return(0,r.Z)(this,i),t=a.call(this,e),(0,h.Z)((0,c.Z)(t),"onClick",(function(){var e,n,a=!1;if(t.isUser)a=window.confirm(pgettext("private thread leave","Are you sure you want to leave this thread?"));else{var i=pgettext("private thread leave","Are you sure you want to remove %(user)s from this thread?");a=window.confirm(interpolate(i,{user:t.props.participant.username},!0))}a&&(t.isUser?(e=t.props.thread,n=t.props.participant,_.Z.patch(e.api.index,[{op:"remove",path:"participants",value:n.id}]).then((function(){N.Z.success(pgettext("thread participants actions","You have left this thread.")),window.setTimeout((function(){window.location=S.Z.get("PRIVATE_THREADS_URL")}),3e3)}),(function(e){N.Z.apiError(e)}))):function(e,t){_.Z.patch(e.api.index,[{op:"remove",path:"participants",value:t.id},{op:"add",path:"acl",value:1}]).then((function(e){x.Z.dispatch((0,y.y8)(e)),x.Z.dispatch(b.gx(e.participants));var n=pgettext("thread participants actions","%(user)s has been removed from this thread.");N.Z.success(interpolate(n,{user:t.username},!0))}),(function(e){N.Z.apiError(e)}))}(t.props.thread,t.props.participant))})),t.isUser=e.participant.id===e.user.id,t}return(0,l.Z)(i,[{key:"render",value:function(){var e=this.props.user.acl.can_moderate_private_threads;return this.props.userIsOwner||this.isUser||e?(0,s.Z)("li",{},void 0,(0,s.Z)("button",{className:"btn btn-link",onClick:this.onClick,type:"button"},void 0,this.isUser?pgettext("private thread leave btn","Leave thread"):pgettext("private thread leave btn","Remove"))):null}}]),i}(m().Component),I=n(19605);function B(e){var t=e.participant,n="btn btn-default";return t.is_owner&&(n="btn btn-primary"),n+=" btn-user btn-block",(0,s.Z)("div",{className:"col-xs-12 col-sm-3 col-md-2 participant-card"},void 0,(0,s.Z)("div",{className:"dropdown"},void 0,(0,s.Z)("button",{"aria-haspopup":"true","aria-expanded":"false",className:n,"data-toggle":"dropdown",type:"button"},void 0,(0,s.Z)(I.ZP,{size:"34",user:t}),(0,s.Z)("span",{className:"btn-text"},void 0,t.username)),(0,s.Z)("ul",{className:"dropdown-menu stick-to-bottom"},void 0,(0,s.Z)(j,{isOwner:t.is_owner}),L||(L=(0,s.Z)("li",{className:"dropdown-header"})),(0,s.Z)("li",{},void 0,(0,s.Z)("a",{href:t.url},void 0,pgettext("thread participants profile link","See profile"))),P||(P=(0,s.Z)("li",{role:"separator",className:"divider"})),m().createElement(O,e),m().createElement(A,e))))}function j(e){return e.isOwner?(0,s.Z)("li",{className:"dropdown-header dropdown-header-owner"},void 0,T||(T=(0,s.Z)("span",{className:"material-icon"},void 0,"start")),(0,s.Z)("span",{className:"icon-text"},void 0,pgettext("thread participants owner status","Thread owner"))):null}function D(e){var t=e.participants,n=e.thread,a=e.user,i=e.userIsOwner;return(0,s.Z)("div",{className:"participants-cards"},void 0,(0,s.Z)("div",{className:"row"},void 0,t.map((function(e){return(0,s.Z)(B,{participant:e,thread:n,user:a,userIsOwner:i},e.id)}))))}function z(e){return e.participants.length?(0,s.Z)("div",{className:"panel panel-default panel-participants"},void 0,(0,s.Z)("div",{className:"panel-body"},void 0,m().createElement(D,(0,f.Z)({userIsOwner:U(e.user,e.participants)},e)),(0,s.Z)("div",{className:"row"},void 0,(0,s.Z)(E,{thread:e.thread}),(0,s.Z)("div",{className:"col-xs-12 col-sm-9"},void 0,(0,s.Z)("p",{},void 0,function(e){var t=e.length,n=npgettext("thread participants stat","This thread has %(users)s participant.","This thread has %(users)s participants.",t);return interpolate(n,{users:t},!0)}(e.participants)))))):null}function U(e,t){return t[0].id===e.id}var q,M=n(30381),F=n.n(M);function H(e){return(0,s.Z)("div",{className:"poll-choices-bars"},void 0,e.poll.choices.map((function(t){return(0,s.Z)(V,{choice:t,poll:e.poll},t.hash)})))}function V(e){var t=0;return e.choice.votes&&e.poll.votes&&(t=Math.ceil(100*e.choice.votes/e.poll.votes)),(0,s.Z)("dl",{className:"dl-horizontal"},void 0,(0,s.Z)("dt",{},void 0,e.choice.label),(0,s.Z)("dd",{},void 0,(0,s.Z)("div",{className:"progress"},void 0,(0,s.Z)("div",{className:"progress-bar",role:"progressbar","aria-valuenow":t,"aria-valuemin":"0","aria-valuemax":"100",style:{width:t+"%"}},void 0,(0,s.Z)("span",{className:"sr-only"},void 0,G(e.votes,e.proc)))),(0,s.Z)("ul",{className:"list-unstyled list-inline poll-chart"},void 0,(0,s.Z)(Y,{proc:t,votes:e.choice.votes}),(0,s.Z)($,{selected:e.choice.selected}))))}function Y(e){return(0,s.Z)("li",{className:"poll-chart-votes"},void 0,G(e.votes,e.proc))}function G(e,t){var n=npgettext("thread poll","%(votes)s vote, %(proc)s% of total.","%(votes)s votes, %(proc)s% of total.",e);return interpolate(n,{votes:e,proc:t},!0)}function $(e){return e.selected?(0,s.Z)("li",{className:"poll-chart-selected"},void 0,q||(q=(0,s.Z)("span",{className:"material-icon"},void 0,"check_box")),pgettext("thread poll","You've voted on this choice.")):null}var W,Q,K,X=n(30337),J=n(3784);var ee=function(e){(0,u.Z)(i,e);var t,n,a=(t=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,a=(0,p.Z)(t);if(n){var i=(0,p.Z)(this).constructor;e=Reflect.construct(a,arguments,i)}else e=a.apply(this,arguments);return(0,d.Z)(this,e)});function i(e){var t;return(0,r.Z)(this,i),(t=a.call(this,e)).state={isLoading:!0,error:null,data:[]},t}return(0,l.Z)(i,[{key:"componentDidMount",value:function(){var e=this;_.Z.get(this.props.poll.api.votes).then((function(t){var n=t.map((function(e){return Object.assign({},e,{voters:e.voters.map((function(e){return Object.assign({},e,{voted_on:F()(e.voted_on)})}))})}));e.setState({isLoading:!1,data:n})}),(function(t){e.setState({isLoading:!1,error:t.detail})}))}},{key:"render",value:function(){return(0,s.Z)("div",{className:"modal-dialog"+(this.state.error?" modal-message":" modal-sm"),role:"document"},void 0,(0,s.Z)("div",{className:"modal-content"},void 0,(0,s.Z)("div",{className:"modal-header"},void 0,(0,s.Z)("button",{type:"button",className:"close","data-dismiss":"modal","aria-label":pgettext("modal","Close")},void 0,W||(W=(0,s.Z)("span",{"aria-hidden":"true"},void 0,"×"))),(0,s.Z)("h4",{className:"modal-title"},void 0,pgettext("thread poll","Poll votes"))),(0,s.Z)(te,{data:this.state.data,error:this.state.error,isLoading:this.state.isLoading})))}}]),i}(m().Component);function te(e){return e.isLoading?Q||(Q=(0,s.Z)(J.Z,{})):e.error?(0,s.Z)(X.Z,{icon:"error_outline",message:e.error}):(0,s.Z)(ne,{data:e.data})}function ne(e){return(0,s.Z)("div",{className:"modal-body modal-poll-votes"},void 0,(0,s.Z)("ul",{className:"list-unstyled votes-details"},void 0,e.data.map((function(e){return m().createElement(ae,(0,f.Z)({key:e.hash},e))}))))}function ae(e){return(0,s.Z)("li",{},void 0,(0,s.Z)("h4",{},void 0,e.label),(0,s.Z)(ie,{votes:e.votes}),(0,s.Z)(oe,{voters:e.voters}),K||(K=(0,s.Z)("hr",{})))}function ie(e){var t=npgettext("thread poll","%(votes)s user has voted for this choice.","%(votes)s users have voted for this choice.",e.votes),n=interpolate(t,{votes:e.votes},!0);return(0,s.Z)("p",{},void 0,n)}function oe(e){return e.voters.length?(0,s.Z)("ul",{className:"list-unstyled"},void 0,e.voters.map((function(e){return m().createElement(se,(0,f.Z)({key:e.username},e))}))):null}function se(e){return e.url?(0,s.Z)("li",{},void 0,(0,s.Z)("a",{className:"item-title",href:e.url},void 0,e.username)," ",(0,s.Z)(re,{voted_on:e.voted_on})):(0,s.Z)("li",{},void 0,(0,s.Z)("strong",{},void 0,e.username)," ",(0,s.Z)(re,{voted_on:e.voted_on}))}function re(e){return(0,s.Z)("abbr",{className:"text-muted",title:e.voted_on.format("LLL")},void 0,e.voted_on.fromNow())}var le=n(59752),ce=n(64646);function ue(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=(0,p.Z)(e);if(t){var i=(0,p.Z)(this).constructor;n=Reflect.construct(a,arguments,i)}else n=a.apply(this,arguments);return(0,d.Z)(this,n)}}function de(e){var t=e.isPollOver,n=e.poll,a=e.showVoting,i=e.thread;if(!function(e,t,n){return n.is_public||t.can_delete||t.can_edit||t.can_see_votes||t.can_vote&&!e&&(!n.hasSelectedChoices||n.allow_revotes)}(t,n.acl,n))return null;var o=[],r=n.acl.can_vote,l=!n.hasSelectedChoices||n.allow_revotes;return r&&l&&o.push(0),(n.is_public||n.acl.can_see_votes)&&o.push(1),n.acl.can_edit&&o.push(2),n.acl.can_delete&&o.push(3),(0,s.Z)("div",{className:"row poll-options"},void 0,(0,s.Z)(he,{controls:o,isPollOver:t,poll:n,showVoting:a}),(0,s.Z)(ve,{controls:o,poll:n}),(0,s.Z)(me,{controls:o,poll:n,thread:i,onClick:e.edit}),(0,s.Z)(fe,{controls:o,poll:n}))}function pe(e,t){var n="col-xs-6";return 1===e.length&&(n="col-xs-12"),3===e.length&&e[0]===t&&(n="col-xs-12"),n+" col-sm-3 col-md-2"}function he(e){var t=e.poll.acl.can_vote,n=!e.poll.hasSelectedChoices||e.poll.allow_revotes;return t&&n?(0,s.Z)("div",{className:pe(e.controls,0)},void 0,(0,s.Z)("button",{className:"btn btn-default btn-block btn-sm",disabled:e.poll.isBusy,onClick:e.showVoting,type:"button"},void 0,pgettext("thread poll","Vote"))):null}var ve=function(e){(0,u.Z)(n,e);var t=ue(n);function n(){var e;(0,r.Z)(this,n);for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return e=t.call.apply(t,[this].concat(i)),(0,h.Z)((0,c.Z)(e),"onClick",(function(){k.Z.show((0,s.Z)(ee,{poll:e.props.poll}))})),e}return(0,l.Z)(n,[{key:"render",value:function(){return this.props.poll.is_public||this.props.poll.acl.can_see_votes?(0,s.Z)("div",{className:pe(this.props.controls,1)},void 0,(0,s.Z)("button",{className:"btn btn-default btn-block btn-sm",disabled:this.props.poll.isBusy,onClick:this.onClick,type:"button"},void 0,pgettext("thread poll","See votes"))):null}}]),n}(m().Component);function me(e){return e.poll.acl.can_edit?(0,s.Z)("div",{className:pe(e.controls,2)},void 0,(0,s.Z)("button",{className:"btn btn-default btn-block btn-sm",disabled:e.poll.isBusy,onClick:e.onClick,type:"button"},void 0,pgettext("thread poll","Edit"))):null}var fe=function(e){(0,u.Z)(n,e);var t=ue(n);function n(){var e;(0,r.Z)(this,n);for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return e=t.call.apply(t,[this].concat(i)),(0,h.Z)((0,c.Z)(e),"onClick",(function(){if(!window.confirm(pgettext("thread poll","Are you sure you want to delete this poll? This action is not reversible.")))return!1;x.Z.dispatch(le.n6()),_.Z.delete(e.props.poll.api.index).then(e.handleSuccess,e.handleError)})),(0,h.Z)((0,c.Z)(e),"handleSuccess",(function(e){N.Z.success(pgettext("thread poll","Poll has been deleted")),x.Z.dispatch(le.Od()),x.Z.dispatch(y.y8(e))})),(0,h.Z)((0,c.Z)(e),"handleError",(function(e){N.Z.apiError(e),x.Z.dispatch(le.Ar())})),e}return(0,l.Z)(n,[{key:"render",value:function(){return this.props.poll.acl.can_delete?(0,s.Z)("div",{className:pe(this.props.controls,3)},void 0,(0,s.Z)("button",{className:"btn btn-default btn-block btn-sm",disabled:this.props.poll.isBusy,onClick:this.onClick,type:"button"},void 0,pgettext("thread poll","Delete"))):null}}]),n}(m().Component),Ze=n(89627),ge='<abbr title="%(absolute)s">%(relative)s</abbr>';function be(e){return(0,s.Z)("ul",{className:"list-unstyled list-inline poll-details"},void 0,(0,s.Z)(we,{votes:e.poll.votes}),(0,s.Z)(Ne,{poll:e.poll}),(0,s.Z)(Ce,{poll:e.poll}),(0,s.Z)(ye,{poll:e.poll}))}function ye(e){var t=interpolate((0,Ze.Z)(pgettext("thread poll","Started by %(poster)s %(posted_on)s.")),{poster:_e(e.poll),posted_on:ke(e.poll)},!0);return(0,s.Z)("li",{className:"poll-info-creation",dangerouslySetInnerHTML:{__html:t}})}function _e(e){return e.url.poster?interpolate('<a href="%(url)s" class="item-title">%(user)s</a>',{url:(0,Ze.Z)(e.url.poster),user:(0,Ze.Z)(e.poster_name)},!0):interpolate('<span class="item-title">%(user)s</span>',{user:(0,Ze.Z)(e.poster_name)},!0)}function ke(e){return interpolate(ge,{absolute:(0,Ze.Z)(e.posted_on.format("LLL")),relative:(0,Ze.Z)(e.posted_on.fromNow())},!0)}function Ne(e){if(!e.poll.length)return null;var t=interpolate((0,Ze.Z)(pgettext("thread poll","Voting ends %(ends_on)s.")),{ends_on:xe(e.poll)},!0);return(0,s.Z)("li",{className:"poll-info-ends-on",dangerouslySetInnerHTML:{__html:t}})}function xe(e){return interpolate(ge,{absolute:(0,Ze.Z)(e.endsOn.format("LLL")),relative:(0,Ze.Z)(e.endsOn.fromNow())},!0)}function we(e){var t=npgettext("thread poll","%(votes)s vote.","%(votes)s votes.",e.votes),n=interpolate(t,{votes:e.votes},!0);return(0,s.Z)("li",{className:"poll-info-votes"},void 0,n)}function Ce(e){return e.poll.is_public?(0,s.Z)("li",{className:"poll-info-public"},void 0,pgettext("thread poll","Voting is public.")):null}function Re(e){return(0,s.Z)("div",{className:"panel panel-default panel-poll"},void 0,(0,s.Z)("div",{className:"panel-body"},void 0,(0,s.Z)("h2",{},void 0,e.poll.question),(0,s.Z)(be,{poll:e.poll}),(0,s.Z)(H,{poll:e.poll}),(0,s.Z)(de,{isPollOver:e.isPollOver,poll:e.poll,edit:e.edit,showVoting:e.showVoting,thread:e.thread})))}function Ee(e){return(0,s.Z)("ul",{className:"list-unstyled list-inline poll-help"},void 0,(0,s.Z)(Se,{choicesLeft:e.choicesLeft}),(0,s.Z)(Oe,{poll:e.poll}))}function Se(e){var t=e.choicesLeft;if(0===t)return(0,s.Z)("li",{className:"poll-help-choices-left"},void 0,pgettext("thread poll","You can't select any more choices."));var n=npgettext("thread poll","You can select %(choices)s more choice.","You can select %(choices)s more choices.",t),a=interpolate(n,{choices:t},!0);return(0,s.Z)("li",{className:"poll-help-choices-left"},void 0,a)}function Oe(e){return e.poll.allow_revotes?(0,s.Z)("li",{className:"poll-help-allow-revotes"},void 0,pgettext("thread poll","You can change your vote later.")):(0,s.Z)("li",{className:"poll-help-no-revotes"},void 0,pgettext("thread poll","Votes are final."))}function Le(e){return(0,s.Z)("ul",{className:"list-unstyled poll-select-choices"},void 0,e.choices.map((function(t){return(0,s.Z)(Pe,{choice:t,toggleChoice:e.toggleChoice},t.hash)})))}var Pe=function(e){(0,u.Z)(i,e);var t,n,a=(t=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,a=(0,p.Z)(t);if(n){var i=(0,p.Z)(this).constructor;e=Reflect.construct(a,arguments,i)}else e=a.apply(this,arguments);return(0,d.Z)(this,e)});function i(){var e;(0,r.Z)(this,i);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return e=a.call.apply(a,[this].concat(n)),(0,h.Z)((0,c.Z)(e),"onClick",(function(){e.props.toggleChoice(e.props.choice.hash)})),e}return(0,l.Z)(i,[{key:"render",value:function(){return(0,s.Z)("li",{className:"poll-select-choice"},void 0,(0,s.Z)("button",{className:this.props.choice.selected?"btn btn-selected":"btn",onClick:this.onClick,type:"button"},void 0,(0,s.Z)("span",{className:"material-icon"},void 0,this.props.choice.selected?"check_box":"check_box_outline_blank"),(0,s.Z)("strong",{},void 0,this.props.choice.label)))}}]),i}(m().Component);function Te(e,t){var n=[];for(var a in t){var i=t[a];i.selected&&n.push(i)}return e.allowed_choices-n.length}var Ae=n(82211);var Ie=function(e){(0,u.Z)(i,e);var t,n,a=(t=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,a=(0,p.Z)(t);if(n){var i=(0,p.Z)(this).constructor;e=Reflect.construct(a,arguments,i)}else e=a.apply(this,arguments);return(0,d.Z)(this,e)});function i(e){var t;return(0,r.Z)(this,i),t=a.call(this,e),(0,h.Z)((0,c.Z)(t),"toggleChoice",(function(e){var n,a=function(e,t){for(var n in e){var a=e[n];if(a.hash===t)return a}return null}(t.state.choices,e);n=a.selected?t.deselectChoice(a,e):t.selectChoice(a,e),t.setState({choices:n,choicesLeft:Te(t.props.poll,n)})})),(0,h.Z)((0,c.Z)(t),"selectChoice",(function(e,n){if(!Te(t.props.poll,t.state.choices))for(var a in t.state.choices.slice()){var i=t.state.choices[a];if(i.selected&&i.hash!=n){i.selected=!1;break}}return t.state.choices.map((function(e){return Object.assign({},e,{selected:e.hash==n||e.selected})}))})),(0,h.Z)((0,c.Z)(t),"deselectChoice",(function(e,n){return t.state.choices.map((function(e){return Object.assign({},e,{selected:e.hash!=n&&e.selected})}))})),t.state={isLoading:!1,choices:e.poll.choices,choicesLeft:Te(e.poll,e.poll.choices)},t}return(0,l.Z)(i,[{key:"clean",value:function(){return this.state.choicesLeft!==this.props.poll.allowed_choices||(N.Z.error(pgettext("thread poll vote","You need to select at least one choice.")),!1)}},{key:"send",value:function(){var e=[];for(var t in this.state.choices.slice()){var n=this.state.choices[t];n.selected&&e.push(n.hash)}return _.Z.post(this.props.poll.api.votes,e)}},{key:"handleSuccess",value:function(e){x.Z.dispatch(le.gx(e)),N.Z.success(pgettext("thread poll vote","Your vote has been saved.")),this.props.showResults()}},{key:"handleError",value:function(e){400===e.status?N.Z.error(e.detail):N.Z.apiError(e)}},{key:"render",value:function(){var e=[];return this.props.poll.acl.can_vote&&e.push(0),(this.props.poll.is_public||this.props.poll.acl.can_see_votes)&&e.push(1),this.props.poll.acl.can_edit&&e.push(2),this.props.poll.acl.can_delete&&e.push(3),(0,s.Z)("div",{className:"panel panel-default panel-poll"},void 0,(0,s.Z)("form",{onSubmit:this.handleSubmit},void 0,(0,s.Z)("div",{className:"panel-body"},void 0,(0,s.Z)("h2",{},void 0,this.props.poll.question),(0,s.Z)(be,{poll:this.props.poll}),(0,s.Z)(Le,{choices:this.state.choices,toggleChoice:this.toggleChoice}),(0,s.Z)(Ee,{choicesLeft:this.state.choicesLeft,poll:this.props.poll})),(0,s.Z)("div",{className:"panel-footer"},void 0,(0,s.Z)("div",{className:"row"},void 0,(0,s.Z)("div",{className:pe(e,0)},void 0,(0,s.Z)(Ae.Z,{className:"btn-primary btn-block btn-sm",loading:this.state.isLoading},void 0,pgettext("thread poll vote btn","Save your vote"))),(0,s.Z)("div",{className:pe(e,1)},void 0,(0,s.Z)("button",{className:"btn btn-default btn-block btn-sm",disabled:this.state.isLoading,onClick:this.props.showResults,type:"button"},void 0,pgettext("thread poll vote btn","See results"))),(0,s.Z)(me,{controls:e,poll:this.props.poll,thread:this.props.thread,onClick:this.props.edit}),(0,s.Z)(fe,{controls:e,poll:this.props.poll})))))}}]),i}(Z.Z);var Be,je=function(e){(0,u.Z)(i,e);var t,n,a=(t=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,a=(0,p.Z)(t);if(n){var i=(0,p.Z)(this).constructor;e=Reflect.construct(a,arguments,i)}else e=a.apply(this,arguments);return(0,d.Z)(this,e)});function i(e){var t;(0,r.Z)(this,i),t=a.call(this,e),(0,h.Z)((0,c.Z)(t),"showResults",(function(){t.setState({showResults:!0})})),(0,h.Z)((0,c.Z)(t),"showVoting",(function(){t.setState({showResults:!1})}));var n=!0;return e.user.id&&!e.poll.hasSelectedChoices&&(n=!1),t.state={showResults:n},t}return(0,l.Z)(i,[{key:"render",value:function(){if(!this.props.thread.poll)return null;var e=function(e){return!!e.length&&F()().isAfter(e.endsOn)}(this.props.poll);return e||!this.props.poll.acl.can_vote||this.state.showResults?m().createElement(Re,(0,f.Z)({isPollOver:e,showVoting:this.showVoting},this.props)):m().createElement(Ie,(0,f.Z)({showResults:this.showResults},this.props))}}]),i}(m().Component),De=n(54031);function ze(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=(0,p.Z)(e);if(t){var i=(0,p.Z)(this).constructor;n=Reflect.construct(a,arguments,i)}else n=a.apply(this,arguments);return(0,d.Z)(this,n)}}var Ue=function(e){(0,u.Z)(n,e);var t=ze(n);function n(){var e;(0,r.Z)(this,n);for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return e=t.call.apply(t,[this].concat(i)),(0,h.Z)((0,c.Z)(e),"onAdd",(function(){var t=e.props.choices.slice();t.push({hash:(0,De.ZP)(12),label:""}),e.props.setChoices(t)})),(0,h.Z)((0,c.Z)(e),"onChange",(function(t,n){var a=e.props.choices.map((function(e){return e.hash===t&&(e.label=n),e}));e.props.setChoices(a)})),(0,h.Z)((0,c.Z)(e),"onDelete",(function(t){var n=e.props.choices.filter((function(e){return e.hash!==t}));e.props.setChoices(n)})),e}return(0,l.Z)(n,[{key:"render",value:function(){var e=this;return(0,s.Z)("div",{className:"poll-choices-control"},void 0,(0,s.Z)("ul",{className:"list-group"},void 0,this.props.choices.map((function(t){return(0,s.Z)(qe,{canDelete:e.props.choices.length>2,choice:t,disabled:e.props.disabled,onChange:e.onChange,onDelete:e.onDelete},t.hash)}))),(0,s.Z)("button",{className:"btn btn-default btn-sm",disabled:this.props.disabled,onClick:this.onAdd,type:"button"},void 0,pgettext("thread poll","Add choice")))}}]),n}(m().Component),qe=function(e){(0,u.Z)(n,e);var t=ze(n);function n(){var e;(0,r.Z)(this,n);for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return e=t.call.apply(t,[this].concat(i)),(0,h.Z)((0,c.Z)(e),"onChange",(function(t){e.props.onChange(e.props.choice.hash,t.target.value)})),(0,h.Z)((0,c.Z)(e),"onDelete",(function(){(0===e.props.choice.label.length||window.confirm(pgettext("thread poll","Are you sure you want to remove this choice?")))&&e.props.onDelete(e.props.choice.hash)})),e}return(0,l.Z)(n,[{key:"render",value:function(){return(0,s.Z)("li",{className:"list-group-item"},void 0,(0,s.Z)("button",{className:"btn",disabled:!this.props.canDelete||this.props.disabled,onClick:this.onDelete,title:pgettext("thread poll","Remove this choice"),type:"button"},void 0,Be||(Be=(0,s.Z)("span",{className:"material-icon"},void 0,"close"))),(0,s.Z)("input",{disabled:this.props.disabled,maxLength:"255",placeholder:pgettext("thread poll","Poll choice"),type:"text",onChange:this.onChange,value:this.props.choice.label}))}}]),n}(m().Component),Me=n(7227);var Fe=function(e){(0,u.Z)(i,e);var t,n,a=(t=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,a=(0,p.Z)(t);if(n){var i=(0,p.Z)(this).constructor;e=Reflect.construct(a,arguments,i)}else e=a.apply(this,arguments);return(0,d.Z)(this,e)});function i(e){var t;(0,r.Z)(this,i),t=a.call(this,e),(0,h.Z)((0,c.Z)(t),"setChoices",(function(e){t.setState((function(t){return{choices:e,errors:Object.assign({},t.errors,{choices:null})}}))})),(0,h.Z)((0,c.Z)(t),"onCancel",(function(){if(""===t.state.question&&t.state.choices&&t.state.choices.every((function(e){return""===e.label}))&&0===t.state.length&&1===t.state.allowed_choices)return t.props.close();(t.props.poll?window.confirm(pgettext("thread poll","Are you sure you want to discard changes?")):window.confirm(pgettext("thread poll","Are you sure you want to discard new poll?")))&&t.props.close()}));var n=e.poll.id?e.poll:{question:"",choices:[{hash:"choice-10000",label:""},{hash:"choice-20000",label:""}],length:0,allowed_choices:1,allow_revotes:0,is_public:0};return t.state={isLoading:!1,isEdit:!!n.id,question:n.question,choices:n.choices,length:n.length,allowed_choices:n.allowed_choices,allow_revotes:n.allow_revotes,is_public:n.is_public,validators:{question:[],choices:[],length:[],allowed_choices:[]},errors:{}},t}return(0,l.Z)(i,[{key:"send",value:function(){var e={question:this.state.question,choices:this.state.choices,length:this.state.length,allowed_choices:this.state.allowed_choices,allow_revotes:this.state.allow_revotes,is_public:this.state.is_public};return this.state.isEdit?_.Z.put(this.props.poll.api.index,e):_.Z.post(this.props.thread.api.poll,e)}},{key:"handleSuccess",value:function(e){x.Z.dispatch(le.gx(e)),this.state.isEdit?N.Z.success(pgettext("thread poll","Poll has been edited.")):N.Z.success(pgettext("thread poll","Poll has been posted.")),this.props.close()}},{key:"handleError",value:function(e){400===e.status?(e.non_field_errors&&(e.allowed_choices=e.non_field_errors),this.setState({errors:Object.assign({},e)}),N.Z.error(gettext("Form contains errors."))):N.Z.apiError(e)}},{key:"render",value:function(){return(0,s.Z)("div",{className:"poll-form"},void 0,(0,s.Z)("form",{onSubmit:this.handleSubmit},void 0,(0,s.Z)("div",{className:"panel panel-default panel-form"},void 0,(0,s.Z)("div",{className:"panel-heading"},void 0,(0,s.Z)("h3",{className:"panel-title"},void 0,this.state.isEdit?pgettext("thread poll","Edit poll"):pgettext("thread poll","Add poll"))),(0,s.Z)("div",{className:"panel-body"},void 0,(0,s.Z)("fieldset",{},void 0,(0,s.Z)("legend",{},void 0,pgettext("thread poll","Question and choices")),(0,s.Z)(g.Z,{label:pgettext("thread poll","Poll question"),for:"id_questions",validation:this.state.errors.question},void 0,(0,s.Z)("input",{className:"form-control",disabled:this.state.isLoading,id:"id_questions",onChange:this.bindInput("question"),type:"text",maxLength:"255",value:this.state.question})),(0,s.Z)(g.Z,{label:pgettext("thread poll","Available choices"),validation:this.state.errors.choices},void 0,(0,s.Z)(Ue,{choices:this.state.choices,disabled:this.state.isLoading,setChoices:this.setChoices}))),(0,s.Z)("fieldset",{},void 0,(0,s.Z)("legend",{},void 0,pgettext("thread poll","Voting")),(0,s.Z)("div",{className:"row"},void 0,(0,s.Z)("div",{className:"col-xs-12 col-sm-6"},void 0,(0,s.Z)(g.Z,{label:pgettext("thread poll","Poll length"),helpText:pgettext("thread poll","Enter number of days for which voting in this poll should be possible or zero to run this poll indefinitely."),for:"id_length",validation:this.state.errors.length},void 0,(0,s.Z)("input",{className:"form-control",disabled:this.state.isLoading,id:"id_length",onChange:this.bindInput("length"),type:"text",value:this.state.length}))),(0,s.Z)("div",{className:"col-xs-12 col-sm-6"},void 0,(0,s.Z)(g.Z,{label:pgettext("thread poll","Allowed choices"),for:"id_allowed_choices",validation:this.state.errors.allowed_choices},void 0,(0,s.Z)("input",{className:"form-control",disabled:this.state.isLoading,id:"id_allowed_choices",onChange:this.bindInput("allowed_choices"),type:"text",maxLength:"255",value:this.state.allowed_choices})))),(0,s.Z)("div",{className:"row"},void 0,(0,s.Z)(He,{bindInput:this.bindInput,disabled:this.state.isLoading,isEdit:this.state.isEdit,value:this.state.is_public}),(0,s.Z)("div",{className:"col-xs-12 col-sm-6"},void 0,(0,s.Z)(g.Z,{label:pgettext("thread poll","Allow vote changes"),for:"id_allow_revotes"},void 0,(0,s.Z)(Me.Z,{id:"id_allow_revotes",disabled:this.state.isLoading,iconOn:"check",iconOff:"close",labelOn:pgettext("thread poll","Allow participants to change their vote"),labelOff:pgettext("thread poll","Don't allow participants to change their vote"),onChange:this.bindInput("allow_revotes"),value:this.state.allow_revotes})))))),(0,s.Z)("div",{className:"panel-footer text-right"},void 0,(0,s.Z)("button",{className:"btn btn-default",disabled:this.state.isLoading,onClick:this.onCancel,type:"button"},void 0,pgettext("thread poll","Cancel"))," ",(0,s.Z)(Ae.Z,{className:"btn-primary",loading:this.state.isLoading},void 0,this.state.isEdit?pgettext("thread poll","Save changes"):pgettext("thread poll","Post poll"))))))}}]),i}(Z.Z);function He(e){return e.isEdit?null:(0,s.Z)("div",{className:"col-xs-12 col-sm-6"},void 0,(0,s.Z)(g.Z,{label:pgettext("thread poll","Make voting public"),helpText:pgettext("thread poll","Making voting public will allow everyone to access detailed list of votes, showing which users voted for which choices and at which times. This option can't be changed after poll's creation. Moderators may see voting details for all polls."),for:"id_is_public"},void 0,(0,s.Z)(Me.Z,{id:"id_is_public",disabled:e.disabled,iconOn:"visibility",iconOff:"visibility_off",labelOn:pgettext("thread poll","Votes are public"),labelOff:pgettext("thread poll","Votes are hidden"),onChange:e.bindInput("is_public"),value:e.value})))}var Ve={changed_title:"edit",pinned_globally:"bookmark",pinned_locally:"bookmark_border",unpinned:"panorama_fish_eye",moved:"arrow_forward",merged:"call_merge",approved:"done",opened:"lock_open",closed:"lock_outline",unhid:"visibility",hid:"visibility_off",changed_owner:"grade",tookover:"grade",added_participant:"person_add",owner_left:"person_outline",participant_left:"person_outline",removed_participant:"remove_circle_outline"};const Ye=function(e){return(0,s.Z)("span",{className:"event-icon-bg"},void 0,(0,s.Z)("span",{className:"material-icon"},void 0,Ve[e.post.event_type]))};var Ge=n(92747);function $e(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=(0,p.Z)(e);if(t){var i=(0,p.Z)(this).constructor;n=Reflect.construct(a,arguments,i)}else n=a.apply(this,arguments);return(0,d.Z)(this,n)}}function We(e){return e.post.acl.can_hide?(0,s.Z)("li",{className:"event-controls"},void 0,m().createElement(Qe,e),m().createElement(Ke,e),m().createElement(Xe,e)):null}var Qe=function(e){(0,u.Z)(n,e);var t=$e(n);function n(){var e;(0,r.Z)(this,n);for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return e=t.call.apply(t,[this].concat(i)),(0,h.Z)((0,c.Z)(e),"onClick",(function(){x.Z.dispatch(Ge.r$(e.props.post,{is_hidden:!0,hidden_on:F()(),hidden_by_name:e.props.user.username,url:Object.assign(e.props.post.url,{hidden_by:e.props.user.url})})),_.Z.patch(e.props.post.api.index,[{op:"replace",path:"is-hidden",value:!0}]).then((function(t){x.Z.dispatch(Ge.r$(e.props.post,t))}),(function(t){400===t.status?N.Z.error(t.detail[0]):N.Z.apiError(t),x.Z.dispatch(Ge.r$(e.props.post,{is_hidden:!1}))}))})),e}return(0,l.Z)(n,[{key:"render",value:function(){return this.props.post.is_hidden?null:(0,s.Z)("button",{type:"button",className:"btn btn-link",onClick:this.onClick},void 0,pgettext("event hide btn","Hide"))}}]),n}(m().Component),Ke=function(e){(0,u.Z)(n,e);var t=$e(n);function n(){var e;(0,r.Z)(this,n);for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return e=t.call.apply(t,[this].concat(i)),(0,h.Z)((0,c.Z)(e),"onClick",(function(){x.Z.dispatch(Ge.r$(e.props.post,{is_hidden:!1})),_.Z.patch(e.props.post.api.index,[{op:"replace",path:"is-hidden",value:!1}]).then((function(t){x.Z.dispatch(Ge.r$(e.props.post,t))}),(function(t){400===t.status?N.Z.error(t.detail[0]):N.Z.apiError(t),x.Z.dispatch(Ge.r$(e.props.post,{is_hidden:!0}))}))})),e}return(0,l.Z)(n,[{key:"render",value:function(){return this.props.post.is_hidden?(0,s.Z)("button",{type:"button",className:"btn btn-link",onClick:this.onClick},void 0,pgettext("event reveal btn","Unhide")):null}}]),n}(m().Component),Xe=function(e){(0,u.Z)(n,e);var t=$e(n);function n(){var e;(0,r.Z)(this,n);for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return e=t.call.apply(t,[this].concat(i)),(0,h.Z)((0,c.Z)(e),"onClick",(function(){window.confirm(pgettext("event delete","Are you sure you wish to delete this event? This action is not reversible!"))&&e.delete()})),(0,h.Z)((0,c.Z)(e),"delete",(function(){x.Z.dispatch(Ge.r$(e.props.post,{isDeleted:!0})),_.Z.delete(e.props.post.api.index).then((function(){N.Z.success(pgettext("event delete","Event has been deleted."))}),(function(t){400===t.status?N.Z.error(t.detail[0]):N.Z.apiError(t),x.Z.dispatch(Ge.r$(e.props.post,{isDeleted:!1}))}))})),e}return(0,l.Z)(n,[{key:"render",value:function(){return(0,s.Z)("button",{type:"button",className:"btn btn-link",onClick:this.onClick},void 0,pgettext("event delete btn","Delete"))}}]),n}(m().Component),Je='<span class="item-title">%(user)s</span>',et='<a href="%(url)s" class="item-title">%(user)s</a>';function tt(e){return(0,s.Z)("ul",{className:"list-inline event-info"},void 0,m().createElement(nt,e),m().createElement(at,e),m().createElement(We,e))}function nt(e){if(e.post.is_hidden){var t;t=e.post.url.hidden_by?interpolate(et,{url:(0,Ze.Z)(e.post.url.hidden_by),user:(0,Ze.Z)(e.post.hidden_by_name)},!0):interpolate(Je,{user:(0,Ze.Z)(e.post.hidden_by_name)},!0);var n=interpolate('<abbr title="%(absolute)s">%(relative)s</abbr>',{absolute:(0,Ze.Z)(e.post.hidden_on.format("LLL")),relative:(0,Ze.Z)(e.post.hidden_on.fromNow())},!0),a=interpolate((0,Ze.Z)(pgettext("event info","Hidden by %(event_by)s %(event_on)s.")),{event_by:t,event_on:n},!0);return(0,s.Z)("li",{className:"event-hidden-message",dangerouslySetInnerHTML:{__html:a}})}return null}function at(e){var t;t=e.post.poster?interpolate(et,{url:(0,Ze.Z)(e.post.poster.url),user:(0,Ze.Z)(e.post.poster_name)},!0):interpolate(Je,{user:(0,Ze.Z)(e.post.poster_name)},!0);var n=interpolate('<a href="%(url)s" title="%(absolute)s">%(relative)s</a>',{url:(0,Ze.Z)(e.post.url.index),absolute:(0,Ze.Z)(e.post.posted_on.format("LLL")),relative:(0,Ze.Z)(e.post.posted_on.fromNow())},!0),a=interpolate((0,Ze.Z)(pgettext("event info","By %(event_by)s %(event_on)s.")),{event_by:t,event_on:n},!0);return(0,s.Z)("li",{className:"event-posters",dangerouslySetInnerHTML:{__html:a}})}var it={pinned_globally:pgettext("event message","Thread has been pinned globally."),pinned_locally:pgettext("event message","Thread has been pinned in category."),unpinned:pgettext("event message","Thread has been unpinned."),approved:pgettext("event message","Thread has been approved."),opened:pgettext("event message","Thread has been opened."),closed:pgettext("event message","Thread has been closed."),unhid:pgettext("event message","Thread has been revealed."),hid:pgettext("event message","Thread has been made hidden."),tookover:pgettext("event message","Took thread over."),owner_left:pgettext("event message","Owner has left thread. This thread is now closed."),participant_left:pgettext("event message","Participant has left thread.")},ot='<a href="%(url)s" class="item-title">%(name)s</a>',st='<span class="item-title">%(name)s</span>';function rt(e){return it[e.post.event_type]?(0,s.Z)("p",{className:"event-message"},void 0,it[e.post.event_type]):"changed_title"===e.post.event_type?m().createElement(lt,e):"moved"===e.post.event_type?m().createElement(ct,e):"merged"===e.post.event_type?m().createElement(ut,e):"changed_owner"===e.post.event_type?m().createElement(dt,e):"added_participant"===e.post.event_type?m().createElement(pt,e):"removed_participant"===e.post.event_type?m().createElement(ht,e):null}function lt(e){var t=(0,Ze.Z)(pgettext("event message","Thread title has been changed from %(old_title)s.")),n=interpolate(st,{name:(0,Ze.Z)(e.post.event_context.old_title)},!0),a=interpolate(t,{old_title:n},!0);return(0,s.Z)("p",{className:"event-message",dangerouslySetInnerHTML:{__html:a}})}function ct(e){var t=(0,Ze.Z)(pgettext("event message","Thread has been moved from %(from_category)s.")),n=interpolate(ot,{url:(0,Ze.Z)(e.post.event_context.from_category.url),name:(0,Ze.Z)(e.post.event_context.from_category.name)},!0),a=interpolate(t,{from_category:n},!0);return(0,s.Z)("p",{className:"event-message",dangerouslySetInnerHTML:{__html:a}})}function ut(e){var t=(0,Ze.Z)(pgettext("event message","The %(merged_thread)s thread has been merged into this thread.")),n=interpolate(st,{name:(0,Ze.Z)(e.post.event_context.merged_thread)},!0),a=interpolate(t,{merged_thread:n},!0);return(0,s.Z)("p",{className:"event-message",dangerouslySetInnerHTML:{__html:a}})}function dt(e){var t=(0,Ze.Z)(pgettext("event message","Changed thread owner to %(user)s.")),n=interpolate(ot,{url:(0,Ze.Z)(e.post.event_context.user.url),name:(0,Ze.Z)(e.post.event_context.user.username)},!0),a=interpolate(t,{user:n},!0);return(0,s.Z)("p",{className:"event-message",dangerouslySetInnerHTML:{__html:a}})}function pt(e){var t=(0,Ze.Z)(pgettext("event message","Added %(user)s to thread.")),n=interpolate(ot,{url:(0,Ze.Z)(e.post.event_context.user.url),name:(0,Ze.Z)(e.post.event_context.user.username)},!0),a=interpolate(t,{user:n},!0);return(0,s.Z)("p",{className:"event-message",dangerouslySetInnerHTML:{__html:a}})}function ht(e){var t=(0,Ze.Z)(pgettext("event message","Removed %(user)s from thread.")),n=interpolate(ot,{url:(0,Ze.Z)(e.post.event_context.user.url),name:(0,Ze.Z)(e.post.event_context.user.username)},!0),a=interpolate(t,{user:n},!0);return(0,s.Z)("p",{className:"event-message",dangerouslySetInnerHTML:{__html:a}})}function vt(e){return e.post.is_read?null:(0,s.Z)("div",{className:"event-label"},void 0,(0,s.Z)("span",{className:"label label-unread"},void 0,pgettext("event unread label","New event")))}var mt=function(e){(0,u.Z)(i,e);var t,n,a=(t=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,a=(0,p.Z)(t);if(n){var i=(0,p.Z)(this).constructor;e=Reflect.construct(a,arguments,i)}else e=a.apply(this,arguments);return(0,d.Z)(this,e)});function i(e){var t;return(0,r.Z)(this,i),t=a.call(this,e),(0,h.Z)((0,c.Z)(t),"initialize",(function(e){t.initialized=!0,t.observer=new IntersectionObserver((function(e){return e.forEach(t.callback)})),t.observer.observe(e)})),(0,h.Z)((0,c.Z)(t),"callback",(function(e){!e.isIntersecting||t.props.post.is_read||t.primed||(window.setTimeout((function(){_.Z.post(t.props.post.api.read)}),0),t.primed=!0,t.destroy())})),t.initialized=!1,t.primed=!1,t.observer=null,t}return(0,l.Z)(i,[{key:"destroy",value:function(){this.observer&&(this.observer.disconnect(),this.observer=null)}},{key:"componentWillUnmount",value:function(){this.destroy()}},{key:"render",value:function(){var e=this,t=!this.initialized&&!this.primed&&!this.props.post.is_read;return m().createElement("div",{className:this.props.className,ref:function(n){n&&t&&e.initialize(n)}},this.props.children)}}]),i}(m().Component);function ft(e){var t="event";return e.post.isDeleted?t="hide":e.post.is_hidden&&(t="event post-hidden"),(0,s.Z)("li",{id:"post-"+e.post.id,className:t},void 0,(0,s.Z)(vt,{post:e.post}),(0,s.Z)("div",{className:"event-body"},void 0,(0,s.Z)("div",{className:"event-icon"},void 0,m().createElement(Ye,e)),(0,s.Z)(mt,{className:"event-content",post:e.post},void 0,m().createElement(rt,e),m().createElement(tt,e))))}var Zt=n(69130),gt=n(48772);function bt(e){return(0,s.Z)("div",{className:"col-xs-12 col-md-6"},void 0,m().createElement(yt,e),(0,s.Z)("div",{className:"post-attachment"},void 0,(0,s.Z)("a",{href:e.attachment.url.index,className:"attachment-name item-title",target:"_blank"},void 0,e.attachment.filename),m().createElement(Nt,e)))}function yt(e){return e.attachment.is_image?(0,s.Z)("div",{className:"post-attachment-preview"},void 0,m().createElement(kt,e)):(0,s.Z)("div",{className:"post-attachment-preview"},void 0,m().createElement(_t,e))}function _t(e){return(0,s.Z)("a",{href:e.attachment.url.index,className:"material-icon"},void 0,"insert_drive_file")}function kt(e){var t=e.attachment.url.thumb||e.attachment.url.index;return(0,s.Z)("a",{className:"post-thumbnail",href:e.attachment.url.index,target:"_blank",style:{backgroundImage:'url("'+(0,Ze.Z)(t)+'")'}})}function Nt(e){var t;t=e.attachment.url.uploader?interpolate('<a href="%(url)s" class="item-title">%(user)s</a>',{url:(0,Ze.Z)(e.attachment.url.uploader),user:(0,Ze.Z)(e.attachment.uploader_name)},!0):interpolate('<span class="item-title">%(user)s</span>',{user:(0,Ze.Z)(e.attachment.uploader_name)},!0);var n=interpolate('<abbr title="%(absolute)s">%(relative)s</abbr>',{absolute:(0,Ze.Z)(e.attachment.uploaded_on.format("LLL")),relative:(0,Ze.Z)(e.attachment.uploaded_on.fromNow())},!0),a=interpolate((0,Ze.Z)(pgettext("post attachment","%(filetype)s, %(size)s, uploaded by %(uploader)s %(uploaded_on)s.")),{filetype:e.attachment.filetype,size:(0,gt.Z)(e.attachment.size),uploader:t,uploaded_on:n},!0);return(0,s.Z)("p",{className:"post-attachment-description",dangerouslySetInnerHTML:{__html:a}})}function xt(e){return function(e){return(!e.is_hidden||e.acl.can_see_hidden)&&e.attachments}(e.post)?(0,s.Z)("div",{className:"post-attachments"},void 0,(0,Zt.Z)(e.post.attachments,2).map((function(e){var t=e.map((function(e){return e?e.id:0})).join("_");return(0,s.Z)(wt,{row:e},t)}))):null}function wt(e){return(0,s.Z)("div",{className:"row"},void 0,e.row.map((function(e){return(0,s.Z)(bt,{attachment:e},e?e.id:0)})))}var Ct,Rt,Et,St,Ot,Lt,Pt,Tt=n(69092);function At(e){return e.post.is_hidden&&!e.post.acl.can_see_hidden?m().createElement(Bt,e):e.post.content?m().createElement(It,e):m().createElement(jt,e)}function It(e){var t=e.post,n="@"+(t.poster?t.poster.username:t.poster_name);return(0,s.Z)(mt,{className:"post-body",post:t},void 0,(0,s.Z)(Tt.Z,{author:n,markup:t.content}))}function Bt(e){var t;t=e.post.hidden_by?interpolate('<a href="%(url)s" class="item-title">%(user)s</a>',{url:(0,Ze.Z)(e.post.url.hidden_by),user:(0,Ze.Z)(e.post.hidden_by_name)},!0):interpolate('<span class="item-title">%(user)s</span>',{user:(0,Ze.Z)(e.post.hidden_by_name)},!0);var n=interpolate('<abbr class="last-title" title="%(absolute)s">%(relative)s</abbr>',{absolute:(0,Ze.Z)(e.post.hidden_on.format("LLL")),relative:(0,Ze.Z)(e.post.hidden_on.fromNow())},!0),a=interpolate((0,Ze.Z)(pgettext("post body hidden","Hidden by %(hidden_by)s %(hidden_on)s.")),{hidden_by:t,hidden_on:n},!0);return(0,s.Z)(mt,{className:"post-body post-body-hidden",post:e.post},void 0,(0,s.Z)("p",{className:"lead"},void 0,pgettext("post body hidden","This post is hidden. You cannot see its contents.")),(0,s.Z)("p",{className:"text-muted",dangerouslySetInnerHTML:{__html:a}}))}function jt(e){return(0,s.Z)(mt,{className:"post-body post-body-invalid",post:e.post},void 0,(0,s.Z)("p",{className:"lead"},void 0,pgettext("post body invalid","This post's contents cannot be displayed.")),(0,s.Z)("p",{className:"text-muted"},void 0,pgettext("post body invalid","This error is caused by invalid post content manipulation.")))}function Dt(e){var t=e.post,n=e.thread,a=e.user;if(!Mt(t)||t.id!==n.best_answer)return null;var i;return i=a.id&&n.best_answer_marked_by===a.id?interpolate(pgettext("post best answer flag","Marked as best answer by you %(marked_on)s."),{marked_on:n.best_answer_marked_on.fromNow()},!0):interpolate(pgettext("post best answer flag","Marked as best answer by %(marked_by)s %(marked_on)s."),{marked_by:n.best_answer_marked_by_name,marked_on:n.best_answer_marked_on.fromNow()},!0),(0,s.Z)("div",{className:"post-status-message post-status-best-answer"},void 0,Ct||(Ct=(0,s.Z)("span",{className:"material-icon"},void 0,"check_box")),(0,s.Z)("p",{},void 0,i))}function zt(e){return Mt(e.post)&&e.post.is_hidden?(0,s.Z)("div",{className:"post-status-message post-status-hidden"},void 0,Rt||(Rt=(0,s.Z)("span",{className:"material-icon"},void 0,"visibility_off")),(0,s.Z)("p",{},void 0,pgettext("post hidden flag","This post is hidden. Only users with permission may see its contents."))):null}function Ut(e){return Mt(e.post)&&e.post.is_unapproved?(0,s.Z)("div",{className:"post-status-message post-status-unapproved"},void 0,Et||(Et=(0,s.Z)("span",{className:"material-icon"},void 0,"remove_circle_outline")),(0,s.Z)("p",{},void 0,pgettext("post unapproved flag","This post is unapproved. Only users with permission to approve posts and its author may see its contents."))):null}function qt(e){return Mt(e.post)&&e.post.is_protected?(0,s.Z)("div",{className:"post-status-message post-status-protected visible-xs-block"},void 0,St||(St=(0,s.Z)("span",{className:"material-icon"},void 0,"lock_outline")),(0,s.Z)("p",{},void 0,pgettext("post protected flag","This post is protected. Only moderators may change it."))):null}function Mt(e){return!e.is_hidden||e.acl.can_see_hidden}function Ft(e){x.Z.dispatch(Ge.r$(e.post,{is_unapproved:!1})),Qt(e,[{op:"replace",path:"is-unapproved",value:!1}],{is_unapproved:e.post.is_unapproved})}function Ht(e){x.Z.dispatch(Ge.r$(e.post,{is_protected:!0})),Qt(e,[{op:"replace",path:"is-protected",value:!0}],{is_protected:e.post.is_protected})}function Vt(e){x.Z.dispatch(Ge.r$(e.post,{is_protected:!1})),Qt(e,[{op:"replace",path:"is-protected",value:!1}],{is_protected:e.post.is_protected})}function Yt(e){x.Z.dispatch(Ge.r$(e.post,{is_hidden:!0,hidden_on:F()(),hidden_by_name:e.user.username,url:Object.assign(e.post.url,{hidden_by:e.user.url})})),Qt(e,[{op:"replace",path:"is-hidden",value:!0}],{is_hidden:e.post.is_hidden,hidden_on:e.post.hidden_on,hidden_by_name:e.post.hidden_by_name,url:e.post.url})}function Gt(e){x.Z.dispatch(Ge.r$(e.post,{is_hidden:!1})),Qt(e,[{op:"replace",path:"is-hidden",value:!1}],{is_hidden:e.post.is_hidden})}function $t(e){var t=e.post.last_likes||[],n=[e.user].concat(t),a=n.length>3?n.slice(0,-1):n;x.Z.dispatch(Ge.r$(e.post,{is_liked:!0,likes:e.post.likes+1,last_likes:a})),Qt(e,[{op:"replace",path:"is-liked",value:!0}],{is_liked:e.post.is_liked,likes:e.post.likes,last_likes:e.post.last_likes})}function Wt(e){x.Z.dispatch(Ge.r$(e.post,{is_liked:!1,likes:e.post.likes-1,last_likes:e.post.last_likes.filter((function(t){return!t.id||t.id!==e.user.id}))}));var t={is_liked:e.post.is_liked,likes:e.post.likes,last_likes:e.post.last_likes};Qt(e,[{op:"replace",path:"is-liked",value:!1}],t)}function Qt(e,t,n){_.Z.patch(e.post.api.index,t).then((function(t){x.Z.dispatch(Ge.r$(e.post,t))}),(function(t){400===t.status?N.Z.error(t.detail[0]):N.Z.apiError(t),x.Z.dispatch(Ge.r$(e.post,n))}))}function Kt(e){window.confirm(pgettext("post delete","Are you sure you want to delete this post? This action is not reversible!"))&&(x.Z.dispatch(Ge.r$(e.post,{isDeleted:!0})),_.Z.delete(e.post.api.index).then((function(){N.Z.success(pgettext("post delete","Post has been deleted."))}),(function(t){400===t.status?N.Z.error(t.detail):N.Z.apiError(t),x.Z.dispatch(Ge.r$(e.post,{isDeleted:!1}))})))}function Xt(e){var t=e.post,n=e.user;x.Z.dispatch(y.Vx({best_answer:t.id,best_answer_is_protected:t.is_protected,best_answer_marked_on:F()(),best_answer_marked_by:n.id,best_answer_marked_by_name:n.username,best_answer_marked_by_slug:n.slug})),en(e,[{op:"replace",path:"best-answer",value:t.id},{op:"add",path:"acl",value:!0}],{best_answer:e.thread.best_answer,best_answer_is_protected:e.thread.best_answer_is_protected,best_answer_marked_on:e.thread.best_answer_marked_on,best_answer_marked_by:e.thread.best_answer_marked_by,best_answer_marked_by_name:e.thread.best_answer_marked_by_name,best_answer_marked_by_slug:e.thread.best_answer_marked_by_slug})}function Jt(e){var t=e.post;x.Z.dispatch(y.Vx({best_answer:null,best_answer_is_protected:!1,best_answer_marked_on:null,best_answer_marked_by:null,best_answer_marked_by_name:null,best_answer_marked_by_slug:null})),en(e,[{op:"remove",path:"best-answer",value:t.id},{op:"add",path:"acl",value:!0}],{best_answer:e.thread.best_answer,best_answer_is_protected:e.thread.best_answer_is_protected,best_answer_marked_on:e.thread.best_answer_marked_on,best_answer_marked_by:e.thread.best_answer_marked_by,best_answer_marked_by_name:e.thread.best_answer_marked_by_name,best_answer_marked_by_slug:e.thread.best_answer_marked_by_slug})}function en(e,t,n){_.Z.patch(e.thread.api.index,t).then((function(e){e.best_answer_marked_on&&(e.best_answer_marked_on=F()(e.best_answer_marked_on)),x.Z.dispatch(y.Vx(e))}),(function(e){400===e.status?N.Z.error(e.detail[0]):N.Z.apiError(e),x.Z.dispatch(y.Vx(n))}))}var tn,nn,an,on,sn=function(e){(0,u.Z)(i,e);var t,n,a=(t=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,a=(0,p.Z)(t);if(n){var i=(0,p.Z)(this).constructor;e=Reflect.construct(a,arguments,i)}else e=a.apply(this,arguments);return(0,d.Z)(this,e)});function i(e){var t;return(0,r.Z)(this,i),(t=a.call(this,e)).state={isReady:!1,error:null,likes:[]},t}return(0,l.Z)(i,[{key:"componentDidMount",value:function(){var e=this;_.Z.get(this.props.post.api.likes).then((function(t){e.setState({isReady:!0,likes:t.map(rn)})}),(function(t){e.setState({isReady:!0,error:t.detail})}))}},{key:"render",value:function(){return this.state.error?(0,s.Z)(ln,{className:"modal-message"},void 0,(0,s.Z)(X.Z,{message:this.state.error})):this.state.isReady?this.state.likes.length?(0,s.Z)(ln,{className:"modal-sm",likes:this.state.likes},void 0,(0,s.Z)(cn,{likes:this.state.likes})):(0,s.Z)(ln,{className:"modal-message"},void 0,(0,s.Z)(X.Z,{message:pgettext("post likes modal","No users have liked this post.")})):Ot||(Ot=(0,s.Z)(ln,{className:"modal-sm"},void 0,(0,s.Z)(J.Z,{})))}}]),i}(m().Component);function rn(e){return Object.assign({},e,{liked_on:F()(e.liked_on)})}function ln(e){var t=e.className,n=e.children,a=e.likes,i=pgettext("post likes modal title","Post Likes");if(a){var o=a.length,r=npgettext("post likes modal","%(likes)s like","%(likes)s likes",o);i=interpolate(r,{likes:o},!0)}return(0,s.Z)("div",{className:"modal-dialog "+(t||""),role:"document"},void 0,(0,s.Z)("div",{className:"modal-content"},void 0,(0,s.Z)("div",{className:"modal-header"},void 0,(0,s.Z)("button",{"aria-label":pgettext("modal","Close"),className:"close","data-dismiss":"modal",type:"button"},void 0,Lt||(Lt=(0,s.Z)("span",{"aria-hidden":"true"},void 0,"×"))),(0,s.Z)("h4",{className:"modal-title"},void 0,i)),n))}function cn(e){return(0,s.Z)("div",{className:"modal-body modal-post-likers"},void 0,(0,s.Z)("ul",{className:"media-list"},void 0,e.likes.map((function(e){return m().createElement(un,(0,f.Z)({key:e.id},e))}))))}function un(e){if(e.url){var t={id:e.liker_id,avatars:e.avatars};return(0,s.Z)("li",{className:"media"},void 0,(0,s.Z)("div",{className:"media-left"},void 0,(0,s.Z)("a",{className:"user-avatar",href:e.url},void 0,(0,s.Z)(I.ZP,{size:"50",user:t}))),(0,s.Z)("div",{className:"media-body"},void 0,(0,s.Z)("a",{className:"item-title",href:e.url},void 0,e.username)," ",(0,s.Z)(dn,{likedOn:e.liked_on})))}return(0,s.Z)("li",{className:"media"},void 0,Pt||(Pt=(0,s.Z)("div",{className:"media-left"},void 0,(0,s.Z)("span",{className:"user-avatar"},void 0,(0,s.Z)(I.ZP,{size:"50"})))),(0,s.Z)("div",{className:"media-body"},void 0,(0,s.Z)("strong",{},void 0,e.username)," ",(0,s.Z)(dn,{likedOn:e.liked_on})))}function dn(e){return(0,s.Z)("span",{className:"text-muted",title:e.likedOn.format("LLL")},void 0,e.likedOn.fromNow())}function pn(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=(0,p.Z)(e);if(t){var i=(0,p.Z)(this).constructor;n=Reflect.construct(a,arguments,i)}else n=a.apply(this,arguments);return(0,d.Z)(this,n)}}function hn(e){return function(e){return(!e.is_hidden||e.acl.can_see_hidden)&&(e.acl.can_reply||e.acl.can_edit||e.acl.can_see_likes&&(e.last_likes||[]).length||e.acl.can_like)}(e.post)?(0,s.Z)("div",{className:"post-footer"},void 0,m().createElement(vn,e),m().createElement(mn,e),m().createElement(fn,e),m().createElement(Zn,(0,f.Z)({lastLikes:e.post.last_likes,likes:e.post.likes},e)),m().createElement(gn,(0,f.Z)({likes:e.post.likes},e)),m().createElement(kn,e),m().createElement(Nn,e),m().createElement(xn,e)):null}var vn=function(e){(0,u.Z)(n,e);var t=pn(n);function n(){var e;(0,r.Z)(this,n);for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return e=t.call.apply(t,[this].concat(i)),(0,h.Z)((0,c.Z)(e),"onClick",(function(){Xt(e.props)})),e}return(0,l.Z)(n,[{key:"render",value:function(){var e=this.props,t=e.post,n=e.thread;return n.acl.can_mark_best_answer&&t.acl.can_mark_as_best_answer?n.best_answer&&!n.acl.can_change_best_answer?null:(0,s.Z)("button",{className:"hidden-xs btn btn-default btn-sm pull-left",disabled:this.props.post.isBusy||t.id===n.best_answer,onClick:this.onClick,type:"button"},void 0,tn||(tn=(0,s.Z)("span",{className:"material-icon"},void 0,"check_box")),pgettext("post footer btn","Best answer")):null}}]),n}(m().Component),mn=function(e){(0,u.Z)(n,e);var t=pn(n);function n(){var e;(0,r.Z)(this,n);for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return e=t.call.apply(t,[this].concat(i)),(0,h.Z)((0,c.Z)(e),"onClick",(function(){Xt(e.props)})),e}return(0,l.Z)(n,[{key:"render",value:function(){var e=this.props,t=e.post,n=e.thread;return n.acl.can_mark_best_answer&&t.acl.can_mark_as_best_answer?n.best_answer&&!n.acl.can_change_best_answer?null:(0,s.Z)("button",{className:"visible-xs-inline-block btn btn-default btn-sm pull-left",disabled:this.props.post.isBusy||t.id===n.best_answer,onClick:this.onClick,type:"button"},void 0,nn||(nn=(0,s.Z)("span",{className:"material-icon"},void 0,"check_box"))):null}}]),n}(m().Component),fn=function(e){(0,u.Z)(n,e);var t=pn(n);function n(){var e;(0,r.Z)(this,n);for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return e=t.call.apply(t,[this].concat(i)),(0,h.Z)((0,c.Z)(e),"onClick",(function(){e.props.post.is_liked?Wt(e.props):$t(e.props)})),e}return(0,l.Z)(n,[{key:"render",value:function(){if(!this.props.post.acl.can_like)return null;var e="btn btn-default btn-sm pull-left";return this.props.post.is_liked&&(e="btn btn-success btn-sm pull-left"),(0,s.Z)("button",{className:e,disabled:this.props.post.isBusy,onClick:this.onClick,type:"button"},void 0,this.props.post.is_liked?pgettext("post footer btn","Liked"):pgettext("post footer btn","Like"))}}]),n}(m().Component),Zn=function(e){(0,u.Z)(n,e);var t=pn(n);function n(){var e;(0,r.Z)(this,n);for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return e=t.call.apply(t,[this].concat(i)),(0,h.Z)((0,c.Z)(e),"onClick",(function(){k.Z.show((0,s.Z)(sn,{post:e.props.post}))})),e}return(0,l.Z)(n,[{key:"render",value:function(){var e=(this.props.post.last_likes||[]).length>0;return this.props.post.acl.can_see_likes&&e?2===this.props.post.acl.can_see_likes?(0,s.Z)("button",{className:"btn btn-link btn-sm pull-left hidden-xs",onClick:this.onClick,type:"button"},void 0,bn(this.props.likes,this.props.lastLikes)):(0,s.Z)("p",{className:"pull-left hidden-xs"},void 0,bn(this.props.likes,this.props.lastLikes)):null}}]),n}(m().Component),gn=function(e){(0,u.Z)(n,e);var t=pn(n);function n(){return(0,r.Z)(this,n),t.apply(this,arguments)}return(0,l.Z)(n,[{key:"render",value:function(){var e=(this.props.post.last_likes||[]).length>0;return this.props.post.acl.can_see_likes&&e?2===this.props.post.acl.can_see_likes?(0,s.Z)("button",{className:"btn btn-link btn-sm likes-compact pull-left visible-xs-block",onClick:this.onClick,type:"button"},void 0,an||(an=(0,s.Z)("span",{className:"material-icon"},void 0,"favorite")),this.props.likes):(0,s.Z)("p",{className:"likes-compact pull-left visible-xs-block"},void 0,on||(on=(0,s.Z)("span",{className:"material-icon"},void 0,"favorite")),this.props.likes):null}}]),n}(Zn);function bn(e,t){var n=t.slice(0,3).map((function(e){return e.username}));if(1==n.length)return interpolate(pgettext("post likes","%(user)s likes this."),{user:n[0]},!0);var a=e-n.length,i=n.slice(0,-1).join(", "),o=n.slice(-1)[0],s=interpolate(pgettext("post likes","%(users)s and %(last_user)s"),{users:i,last_user:o},!0);if(0===a)return interpolate(pgettext("post likes","%(users)s like this."),{users:s},!0);var r=npgettext("post likes","%(users)s and %(likes)s other user like this.","%(users)s and %(likes)s other users like this.",a);return interpolate(r,{users:n.join(", "),likes:a},!0)}var yn,_n,kn=function(e){(0,u.Z)(n,e);var t=pn(n);function n(){var e;(0,r.Z)(this,n);for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return e=t.call.apply(t,[this].concat(i)),(0,h.Z)((0,c.Z)(e),"onClick",(function(){ce.Z.open({mode:"REPLY",thread:e.props.thread,config:e.props.thread.api.editor,submit:e.props.thread.api.posts.index})})),e}return(0,l.Z)(n,[{key:"render",value:function(){return this.props.post.acl.can_reply?(0,s.Z)("button",{className:"btn btn-default btn-sm pull-right",type:"button",onClick:this.onClick},void 0,pgettext("post footer btn","Reply")):null}}]),n}(m().Component),Nn=function(e){(0,u.Z)(n,e);var t=pn(n);function n(){var e;(0,r.Z)(this,n);for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return e=t.call.apply(t,[this].concat(i)),(0,h.Z)((0,c.Z)(e),"onClick",(function(){ce.Z.open({mode:"QUOTE",thread:e.props.thread,config:e.props.thread.api.editor,submit:e.props.thread.api.posts.index,context:{reply:e.props.post.id}})})),e}return(0,l.Z)(n,[{key:"render",value:function(){return this.props.post.acl.can_reply?(0,s.Z)("button",{className:"btn btn-default btn-sm pull-right",type:"button",onClick:this.onClick},void 0,pgettext("post footer btn","Quote")):null}}]),n}(m().Component),xn=function(e){(0,u.Z)(n,e);var t=pn(n);function n(){var e;(0,r.Z)(this,n);for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return e=t.call.apply(t,[this].concat(i)),(0,h.Z)((0,c.Z)(e),"onClick",(function(){ce.Z.open({mode:"EDIT",thread:e.props.thread,post:e.props.post,config:e.props.post.api.editor,submit:e.props.post.api.index})})),e}return(0,l.Z)(n,[{key:"render",value:function(){return this.props.post.acl.can_edit?(0,s.Z)("button",{className:"hidden-xs btn btn-default btn-sm pull-right",type:"button",onClick:this.onClick},void 0,pgettext("post footer btn","Edit")):null}}]),n}(m().Component);var wn=function(e){(0,u.Z)(i,e);var t,n,a=(t=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,a=(0,p.Z)(t);if(n){var i=(0,p.Z)(this).constructor;e=Reflect.construct(a,arguments,i)}else e=a.apply(this,arguments);return(0,d.Z)(this,e)});function i(e){var t;return(0,r.Z)(this,i),t=a.call(this,e),(0,h.Z)((0,c.Z)(t),"onUrlChange",(function(e){t.changeValue("url",e.target.value)})),t.state={isLoading:!1,url:"",validators:{url:[]},errors:{}},t}return(0,l.Z)(i,[{key:"clean",value:function(){return!!this.state.url.trim().length||(N.Z.error(pgettext("post move modal","You have to enter link to the other thread.")),!1)}},{key:"send",value:function(){return _.Z.post(this.props.thread.api.posts.move,{new_thread:this.state.url,posts:[this.props.post.id]})}},{key:"handleSuccess",value:function(e){x.Z.dispatch(Ge.r$(this.props.post,{isDeleted:!0})),k.Z.hide(),N.Z.success(pgettext("post move modal","Selected post was moved to the other thread."))}},{key:"handleError",value:function(e){400===e.status?N.Z.error(e.detail):N.Z.apiError(e)}},{key:"render",value:function(){return(0,s.Z)("div",{className:"modal-dialog",role:"document"},void 0,(0,s.Z)("form",{onSubmit:this.handleSubmit},void 0,(0,s.Z)("div",{className:"modal-content"},void 0,yn||(yn=(0,s.Z)(Cn,{})),(0,s.Z)("div",{className:"modal-body"},void 0,(0,s.Z)(g.Z,{for:"id_url",label:pgettext("post move modal field","Link to thread you want to move post to")},void 0,(0,s.Z)("input",{className:"form-control",disabled:this.state.isLoading,id:"id_url",onChange:this.onUrlChange,value:this.state.url}))),(0,s.Z)("div",{className:"modal-footer"},void 0,(0,s.Z)("button",{className:"btn btn-primary",disabled:this.state.isLoading},void 0,pgettext("post move modal btn","Move post"))))))}}]),i}(Z.Z);function Cn(e){return(0,s.Z)("div",{className:"modal-header"},void 0,(0,s.Z)("button",{"aria-label":pgettext("modal","Close"),className:"close","data-dismiss":"modal",type:"button"},void 0,_n||(_n=(0,s.Z)("span",{"aria-hidden":"true"},void 0,"×"))),(0,s.Z)("h4",{className:"modal-title"},void 0,pgettext("post move modal title","Move post")))}function Rn(e){return(0,s.Z)("div",{className:"modal-body post-changelog-diff"},void 0,(0,s.Z)("ul",{className:"list-unstyled"},void 0,e.diff.map((function(e,t){return(0,s.Z)(En,{item:e},t)}))))}function En(e){return"?"===e.item[0]?null:(0,s.Z)("li",{className:(t=e.item,n="diff-item","-"===t[0]?n+=" diff-item-sub":"+"===t[0]&&(n+=" diff-item-add"),n)},void 0,e.item.substr(2));var t,n}var Sn,On,Ln,Pn=function(e){(0,u.Z)(i,e);var t,n,a=(t=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,a=(0,p.Z)(t);if(n){var i=(0,p.Z)(this).constructor;e=Reflect.construct(a,arguments,i)}else e=a.apply(this,arguments);return(0,d.Z)(this,e)});function i(){var e;(0,r.Z)(this,i);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return e=a.call.apply(a,[this].concat(n)),(0,h.Z)((0,c.Z)(e),"onClick",(function(){e.props.revertEdit(e.props.edit.id)})),e}return(0,l.Z)(i,[{key:"render",value:function(){return this.props.canRevert?(0,s.Z)("div",{className:"modal-footer visible-xs-block"},void 0,(0,s.Z)(Ae.Z,{className:"btn-default btn-sm btn-block",disabled:this.props.disabled,onClick:this.onClick,title:pgettext("post revert btn","Revert post to state from before this edit.")},void 0,pgettext("post revert btn","Revert"))):null}}]),i}(m().Component);var Tn,An,In=function(e){(0,u.Z)(i,e);var t,n,a=(t=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,a=(0,p.Z)(t);if(n){var i=(0,p.Z)(this).constructor;e=Reflect.construct(a,arguments,i)}else e=a.apply(this,arguments);return(0,d.Z)(this,e)});function i(){var e;(0,r.Z)(this,i);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return e=a.call.apply(a,[this].concat(n)),(0,h.Z)((0,c.Z)(e),"goLast",(function(){e.props.goToEdit()})),(0,h.Z)((0,c.Z)(e),"goForward",(function(){e.props.goToEdit(e.props.edit.next)})),(0,h.Z)((0,c.Z)(e),"goBack",(function(){e.props.goToEdit(e.props.edit.previous)})),(0,h.Z)((0,c.Z)(e),"revertEdit",(function(){e.props.revertEdit(e.props.edit.id)})),e}return(0,l.Z)(i,[{key:"render",value:function(){return(0,s.Z)("div",{className:"modal-toolbar post-changelog-toolbar"},void 0,(0,s.Z)("div",{className:"row"},void 0,(0,s.Z)("div",{className:"col-xs-12 col-sm-4"},void 0,(0,s.Z)("div",{className:"row"},void 0,(0,s.Z)("div",{className:"col-xs-4"},void 0,(0,s.Z)(Bn,{disabled:this.props.disabled,edit:this.props.edit,onClick:this.goBack})),(0,s.Z)("div",{className:"col-xs-4"},void 0,(0,s.Z)(jn,{disabled:this.props.disabled,edit:this.props.edit,onClick:this.goForward})),(0,s.Z)("div",{className:"col-xs-4"},void 0,(0,s.Z)(Dn,{disabled:this.props.disabled,edit:this.props.edit,onClick:this.goLast})))),(0,s.Z)("div",{className:"col-xs-12 col-sm-5 xs-margin-top-half post-change-label"},void 0,(0,s.Z)(Un,{edit:this.props.edit})),(0,s.Z)(zn,{canRevert:this.props.canRevert,disabled:this.props.disabled,onClick:this.revertEdit})))}}]),i}(m().Component);function Bn(e){return(0,s.Z)(Ae.Z,{className:"btn-default btn-block btn-icon btn-sm",disabled:e.disabled||!e.edit.previous,onClick:e.onClick,title:pgettext("post history modal btn","See previous change")},void 0,Sn||(Sn=(0,s.Z)("span",{className:"material-icon"},void 0,"chevron_left")))}function jn(e){return(0,s.Z)(Ae.Z,{className:"btn-default btn-block btn-icon btn-sm",disabled:e.disabled||!e.edit.next,onClick:e.onClick,title:pgettext("post history modal btn","See next change")},void 0,On||(On=(0,s.Z)("span",{className:"material-icon"},void 0,"chevron_right")))}function Dn(e){return(0,s.Z)(Ae.Z,{className:"btn-default btn-block btn-icon btn-sm",disabled:e.disabled||!e.edit.next,onClick:e.onClick,title:pgettext("post history modal btn","See previous change")},void 0,Ln||(Ln=(0,s.Z)("span",{className:"material-icon"},void 0,"last_page")))}function zn(e){return e.canRevert?(0,s.Z)("div",{className:"col-sm-3 hidden-xs"},void 0,(0,s.Z)(Ae.Z,{className:"btn-default btn-sm btn-block",disabled:e.disabled,onClick:e.onClick,title:pgettext("post revert btn","Revert post to state from before this edit.")},void 0,pgettext("post revert btn","Revert"))):null}function Un(e){var t;t=e.edit.url.editor?interpolate('<a href="%(url)s" class="item-title">%(user)s</a>',{url:(0,Ze.Z)(e.edit.url.editor),user:(0,Ze.Z)(e.edit.editor_name)},!0):interpolate('<span class="item-title">%(user)s</span>',{user:(0,Ze.Z)(e.edit.editor_name)},!0);var n=interpolate('<abbr title="%(absolute)s">%(relative)s</abbr>',{absolute:(0,Ze.Z)(e.edit.edited_on.format("LLL")),relative:(0,Ze.Z)(e.edit.edited_on.fromNow())},!0),a=interpolate((0,Ze.Z)(pgettext("post history modal","By %(edited_by)s %(edited_on)s.")),{edited_by:t,edited_on:n},!0);return(0,s.Z)("p",{dangerouslySetInnerHTML:{__html:a}})}function qn(e){return Object.assign({},e,{edited_on:F()(e.edited_on)})}var Mn=function(e){(0,u.Z)(i,e);var t,n,a=(t=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,a=(0,p.Z)(t);if(n){var i=(0,p.Z)(this).constructor;e=Reflect.construct(a,arguments,i)}else e=a.apply(this,arguments);return(0,d.Z)(this,e)});function i(e){var t;return(0,r.Z)(this,i),t=a.call(this,e),(0,h.Z)((0,c.Z)(t),"goToEdit",(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;t.setState({isBusy:!0});var n=t.props.post.api.edits;null!==e&&(n+="?edit="+e),_.Z.get(n).then((function(e){t.setState({isReady:!0,isBusy:!1,edit:qn(e)})}),(function(e){t.setState({isReady:!0,isBusy:!1,error:e.detail})}))})),(0,h.Z)((0,c.Z)(t),"revertEdit",(function(e){if(!t.state.isBusy&&window.confirm(pgettext("post revert","Are you sure you with to revert this post to the state from before this edit?"))){t.setState({isBusy:!0});var n=t.props.post.api.edits+"?edit="+e;_.Z.post(n).then((function(e){var t=Ge.ZB(e);x.Z.dispatch(Ge.r$(e,t)),N.Z.success(pgettext("post revert","Post has been reverted to previous state.")),k.Z.hide()}),(function(e){N.Z.apiError(e),t.setState({isBusy:!1})}))}})),t.state={isReady:!1,isBusy:!0,canRevert:e.post.acl.can_edit,error:null,edit:null},t}return(0,l.Z)(i,[{key:"componentDidMount",value:function(){this.goToEdit()}},{key:"render",value:function(){return this.state.error?(0,s.Z)(Fn,{className:"modal-dialog modal-message"},void 0,(0,s.Z)(X.Z,{message:this.state.error})):this.state.isReady?(0,s.Z)(Fn,{},void 0,(0,s.Z)(In,{canRevert:this.state.canRevert,disabled:this.state.isBusy,edit:this.state.edit,goToEdit:this.goToEdit,revertEdit:this.revertEdit}),(0,s.Z)(Rn,{diff:this.state.edit.diff}),(0,s.Z)(Pn,{canRevert:this.state.canRevert,disabled:this.state.isBusy,edit:this.state.edit,revertEdit:this.revertEdit})):Tn||(Tn=(0,s.Z)(Fn,{},void 0,(0,s.Z)(J.Z,{})))}}]),i}(m().Component);function Fn(e){return(0,s.Z)("div",{className:e.className||"modal-dialog",role:"document"},void 0,(0,s.Z)("div",{className:"modal-content"},void 0,(0,s.Z)("div",{className:"modal-header"},void 0,(0,s.Z)("button",{"aria-label":pgettext("modal","Close"),className:"close","data-dismiss":"modal",type:"button"},void 0,An||(An=(0,s.Z)("span",{"aria-hidden":"true"},void 0,"×"))),(0,s.Z)("h4",{className:"modal-title"},void 0,pgettext("post history modal title","Post edits history"))),e.children))}var Hn,Vn,Yn,Gn,$n,Wn,Qn=n(57026),Kn=n(60471),Xn=n(55210);function Jn(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=(0,p.Z)(e);if(t){var i=(0,p.Z)(this).constructor;n=Reflect.construct(a,arguments,i)}else n=a.apply(this,arguments);return(0,d.Z)(this,n)}}function ea(e){return m().createElement(va,(0,f.Z)({},e,{Form:ma}))}var ta,na,aa,ia,oa,sa,ra,la,ca,ua,da,pa,ha,va=function(e){(0,u.Z)(n,e);var t=Jn(n);function n(e){var a;return(0,r.Z)(this,n),(a=t.call(this,e)).state={isLoaded:!1,isError:!1,categories:[]},a}return(0,l.Z)(n,[{key:"componentDidMount",value:function(){var e=this;_.Z.get(misago.get("THREAD_EDITOR_API")).then((function(t){var n=t.map((function(e){return Object.assign(e,{disabled:!1===e.post,label:e.name,value:e.id,post:e.post})}));e.setState({isLoaded:!0,categories:n})}),(function(t){e.setState({isError:t.detail})}))}},{key:"render",value:function(){return this.state.isError?(0,s.Z)(Za,{message:this.state.isError}):this.state.isLoaded?m().createElement(ma,(0,f.Z)({},this.props,{categories:this.state.categories})):Hn||(Hn=(0,s.Z)(fa,{}))}}]),n}(m().Component),ma=function(e){(0,u.Z)(n,e);var t=Jn(n);function n(e){var a;return(0,r.Z)(this,n),a=t.call(this,e),(0,h.Z)((0,c.Z)(a),"onCategoryChange",(function(e){var t=e.target.value,n={category:t};a.acl[t].can_pin_threads<n.weight&&(n.weight=0),a.acl[t].can_hide_threads||(n.is_hidden=0),a.acl[t].can_close_threads||(n.is_closed=!1),a.setState(n)})),a.state={isLoading:!1,title:"",category:null,categories:e.categories,weight:0,is_hidden:0,is_closed:!1,validators:{title:[Xn.C1()]},errors:{}},a.isHiddenChoices=[{value:0,icon:"visibility",label:pgettext("thread hidden switch choice","No")},{value:1,icon:"visibility_off",label:pgettext("thread hidden switch choice","Yes")}],a.isClosedChoices=[{value:!1,icon:"lock_outline",label:pgettext("thread closed switch choice","No")},{value:!0,icon:"lock",label:pgettext("thread closed switch choice","Yes")}],a.acl={},a.props.categories.forEach((function(e){e.post&&(a.state.category||(a.state.category=e.id),a.acl[e.id]={can_pin_threads:e.post.pin,can_close_threads:e.post.close,can_hide_threads:e.post.hide})})),a}return(0,l.Z)(n,[{key:"clean",value:function(){return!!this.isValid()||(N.Z.error(gettext("Form contains errors.")),this.setState({errors:this.validate()}),!1)}},{key:"send",value:function(){return _.Z.post(this.props.thread.api.posts.split,{title:this.state.title,category:this.state.category,weight:this.state.weight,is_hidden:this.state.is_hidden,is_closed:this.state.is_closed,posts:[this.props.post.id]})}},{key:"handleSuccess",value:function(e){x.Z.dispatch(Ge.r$(this.props.post,{isDeleted:!0})),k.Z.hide(),N.Z.success(pgettext("post split modal","Selected post was split into new thread."))}},{key:"handleError",value:function(e){400===e.status?(this.setState({errors:Object.assign({},this.state.errors,e)}),N.Z.error(gettext("Form contains errors."))):N.Z.apiError(e)}},{key:"getWeightChoices",value:function(){var e=[{value:0,icon:"remove",label:pgettext("thread weight choice","Not pinned")},{value:1,icon:"bookmark_border",label:pgettext("thread weight choice","Pinned in category")}];return 2==this.acl[this.state.category].can_pin_threads&&e.push({value:2,icon:"bookmark",label:pgettext("thread weight choice","Pinned globally")}),e}},{key:"renderWeightField",value:function(){return this.acl[this.state.category].can_pin_threads?(0,s.Z)(g.Z,{label:pgettext("posts split modal field","Thread weight"),for:"id_weight",labelClass:"col-sm-4",controlClass:"col-sm-8"},void 0,(0,s.Z)(Kn.Z,{id:"id_weight",onChange:this.bindInput("weight"),value:this.state.weight,choices:this.getWeightChoices()})):null}},{key:"renderHiddenField",value:function(){return this.acl[this.state.category].can_hide_threads?(0,s.Z)(g.Z,{label:pgettext("posts split modal field","Hide thread"),for:"id_is_hidden",labelClass:"col-sm-4",controlClass:"col-sm-8"},void 0,(0,s.Z)(Kn.Z,{id:"id_is_closed",onChange:this.bindInput("is_hidden"),value:this.state.is_hidden,choices:this.isHiddenChoices})):null}},{key:"renderClosedField",value:function(){return this.acl[this.state.category].can_close_threads?(0,s.Z)(g.Z,{label:pgettext("posts split modal field","Close thread"),for:"id_is_closed",labelClass:"col-sm-4",controlClass:"col-sm-8"},void 0,(0,s.Z)(Kn.Z,{id:"id_is_closed",onChange:this.bindInput("is_closed"),value:this.state.is_closed,choices:this.isClosedChoices})):null}},{key:"render",value:function(){return(0,s.Z)(ga,{className:"modal-dialog"},void 0,(0,s.Z)("form",{onSubmit:this.handleSubmit},void 0,(0,s.Z)("div",{className:"modal-body"},void 0,(0,s.Z)(g.Z,{label:pgettext("posts split modal field","Thread title"),for:"id_title",labelClass:"col-sm-4",controlClass:"col-sm-8",validation:this.state.errors.title},void 0,(0,s.Z)("input",{id:"id_title",className:"form-control",type:"text",onChange:this.bindInput("title"),value:this.state.title})),Vn||(Vn=(0,s.Z)("div",{className:"clearfix"})),(0,s.Z)(g.Z,{label:pgettext("posts split modal field","Category"),for:"id_category",labelClass:"col-sm-4",controlClass:"col-sm-8",validation:this.state.errors.category},void 0,(0,s.Z)(Qn.Z,{id:"id_category",onChange:this.onCategoryChange,value:this.state.category,choices:this.state.categories})),Yn||(Yn=(0,s.Z)("div",{className:"clearfix"})),this.renderWeightField(),this.renderHiddenField(),this.renderClosedField()),(0,s.Z)("div",{className:"modal-footer"},void 0,(0,s.Z)(Ae.Z,{className:"btn-primary",loading:this.state.isLoading},void 0,pgettext("posts split modal btn","Split post")))))}}]),n}(Z.Z);function fa(){return Gn||(Gn=(0,s.Z)(ga,{className:"modal-dialog"},void 0,(0,s.Z)(J.Z,{})))}function Za(e){return(0,s.Z)(ga,{className:"modal-dialog modal-message"},void 0,$n||($n=(0,s.Z)("div",{className:"message-icon"},void 0,(0,s.Z)("span",{className:"material-icon"},void 0,"info_outline"))),(0,s.Z)("div",{className:"message-body"},void 0,(0,s.Z)("p",{className:"lead"},void 0,pgettext("post split modal","You can't move this post at the moment.")),(0,s.Z)("p",{},void 0,e.message)))}function ga(e){return(0,s.Z)("div",{className:e.className,role:"document"},void 0,(0,s.Z)("div",{className:"modal-content"},void 0,(0,s.Z)("div",{className:"modal-header"},void 0,(0,s.Z)("button",{"aria-label":pgettext("modal","Close"),className:"close","data-dismiss":"modal",type:"button"},void 0,Wn||(Wn=(0,s.Z)("span",{"aria-hidden":"true"},void 0,"×"))),(0,s.Z)("h4",{className:"modal-title"},void 0,pgettext("posts split modal title","Split post into new thread"))),e.children))}function ba(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=(0,p.Z)(e);if(t){var i=(0,p.Z)(this).constructor;n=Reflect.construct(a,arguments,i)}else n=a.apply(this,arguments);return(0,d.Z)(this,n)}}function ya(e){return(0,s.Z)("ul",{className:"dropdown-menu dropdown-menu-right stick-to-bottom"},void 0,m().createElement(ka,e),m().createElement(Na,e),m().createElement(xa,e),m().createElement(wa,e),m().createElement(Ca,e),m().createElement(Ra,e),m().createElement(Ea,e),m().createElement(Sa,e),m().createElement(Oa,e),m().createElement(La,e),m().createElement(Pa,e),m().createElement(Ta,e),m().createElement(Aa,e))}var _a,ka=function(e){(0,u.Z)(n,e);var t=ba(n);function n(){var e;(0,r.Z)(this,n);for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return e=t.call.apply(t,[this].concat(i)),(0,h.Z)((0,c.Z)(e),"onClick",(function(){var t=window.location.protocol+"//";t+=window.location.host,t+=e.props.post.url.index,prompt(pgettext("post permalink","Permament link to this post:"),t)})),e}return(0,l.Z)(n,[{key:"render",value:function(){return(0,s.Z)("li",{},void 0,(0,s.Z)("button",{className:"btn btn-link",onClick:this.onClick,type:"button"},void 0,ta||(ta=(0,s.Z)("span",{className:"material-icon"},void 0,"link")),pgettext("post options permalink btn","Permament link")))}}]),n}(m().Component),Na=function(e){(0,u.Z)(n,e);var t=ba(n);function n(){var e;(0,r.Z)(this,n);for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return e=t.call.apply(t,[this].concat(i)),(0,h.Z)((0,c.Z)(e),"onClick",(function(){ce.Z.open({mode:"EDIT",thread:e.props.thread,post:e.props.post,config:e.props.post.api.editor,submit:e.props.post.api.index})})),e}return(0,l.Z)(n,[{key:"render",value:function(){return this.props.post.acl.can_edit?(0,s.Z)("li",{},void 0,(0,s.Z)("button",{className:"btn btn-link",onClick:this.onClick,type:"button"},void 0,na||(na=(0,s.Z)("span",{className:"material-icon"},void 0,"edit")),pgettext("post options edit btn","Edit"))):null}}]),n}(m().Component),xa=function(e){(0,u.Z)(n,e);var t=ba(n);function n(){var e;(0,r.Z)(this,n);for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return e=t.call.apply(t,[this].concat(i)),(0,h.Z)((0,c.Z)(e),"onClick",(function(){Xt(e.props)})),e}return(0,l.Z)(n,[{key:"render",value:function(){var e=this.props,t=e.post,n=e.thread;return n.acl.can_mark_best_answer&&t.acl.can_mark_as_best_answer?t.id===n.best_answer||n.best_answer&&!n.acl.can_change_best_answer?null:(0,s.Z)("li",{},void 0,(0,s.Z)("button",{className:"btn btn-link",onClick:this.onClick,type:"button"},void 0,aa||(aa=(0,s.Z)("span",{className:"material-icon"},void 0,"check_box")),pgettext("post options best answer btn","Mark as best answer"))):null}}]),n}(m().Component),wa=function(e){(0,u.Z)(n,e);var t=ba(n);function n(){var e;(0,r.Z)(this,n);for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return e=t.call.apply(t,[this].concat(i)),(0,h.Z)((0,c.Z)(e),"onClick",(function(){Jt(e.props)})),e}return(0,l.Z)(n,[{key:"render",value:function(){var e=this.props,t=e.post,n=e.thread;return t.id!==n.best_answer?null:n.acl.can_unmark_best_answer?(0,s.Z)("li",{},void 0,(0,s.Z)("button",{className:"btn btn-link",onClick:this.onClick,type:"button"},void 0,ia||(ia=(0,s.Z)("span",{className:"material-icon"},void 0,"check_box_outline_blank")),pgettext("post options best answer btn","Unmark best answer"))):null}}]),n}(m().Component),Ca=function(e){(0,u.Z)(n,e);var t=ba(n);function n(){var e;(0,r.Z)(this,n);for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return e=t.call.apply(t,[this].concat(i)),(0,h.Z)((0,c.Z)(e),"onClick",(function(){k.Z.show((0,s.Z)(Mn,{post:e.props.post}))})),e}return(0,l.Z)(n,[{key:"render",value:function(){var e=this.props.post.is_hidden&&!this.props.post.acl.can_see_hidden,t=0===this.props.post.edits;if(e||t)return null;var n=npgettext("post edits","This post was edited %(edits)s time.","This post was edited %(edits)s times.",this.props.post.edits);return interpolate(n,{edits:this.props.post.edits},!0),(0,s.Z)("li",{},void 0,(0,s.Z)("button",{className:"btn btn-link",onClick:this.onClick,type:"button"},void 0,oa||(oa=(0,s.Z)("span",{className:"material-icon"},void 0,"edit")),pgettext("post options edit btn","Changes history")))}}]),n}(m().Component),Ra=function(e){(0,u.Z)(n,e);var t=ba(n);function n(){var e;(0,r.Z)(this,n);for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return e=t.call.apply(t,[this].concat(i)),(0,h.Z)((0,c.Z)(e),"onClick",(function(){Ft(e.props)})),e}return(0,l.Z)(n,[{key:"render",value:function(){return this.props.post.acl.can_approve&&this.props.post.is_unapproved?(0,s.Z)("li",{},void 0,(0,s.Z)("button",{className:"btn btn-link",onClick:this.onClick,type:"button"},void 0,sa||(sa=(0,s.Z)("span",{className:"material-icon"},void 0,"done")),pgettext("post options approve btn","Approve"))):null}}]),n}(m().Component),Ea=function(e){(0,u.Z)(n,e);var t=ba(n);function n(){var e;(0,r.Z)(this,n);for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return e=t.call.apply(t,[this].concat(i)),(0,h.Z)((0,c.Z)(e),"onClick",(function(){k.Z.show(m().createElement(wn,e.props))})),e}return(0,l.Z)(n,[{key:"render",value:function(){return this.props.post.acl.can_move?(0,s.Z)("li",{},void 0,(0,s.Z)("button",{className:"btn btn-link",onClick:this.onClick,type:"button"},void 0,ra||(ra=(0,s.Z)("span",{className:"material-icon"},void 0,"arrow_forward")),pgettext("post options move btn","Move"))):null}}]),n}(m().Component),Sa=function(e){(0,u.Z)(n,e);var t=ba(n);function n(){var e;(0,r.Z)(this,n);for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return e=t.call.apply(t,[this].concat(i)),(0,h.Z)((0,c.Z)(e),"onClick",(function(){k.Z.show(m().createElement(ea,e.props))})),e}return(0,l.Z)(n,[{key:"render",value:function(){return this.props.post.acl.can_move?(0,s.Z)("li",{},void 0,(0,s.Z)("button",{className:"btn btn-link",onClick:this.onClick,type:"button"},void 0,la||(la=(0,s.Z)("span",{className:"material-icon"},void 0,"call_split")),pgettext("post options split btn","Split"))):null}}]),n}(m().Component),Oa=function(e){(0,u.Z)(n,e);var t=ba(n);function n(){var e;(0,r.Z)(this,n);for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return e=t.call.apply(t,[this].concat(i)),(0,h.Z)((0,c.Z)(e),"onClick",(function(){Ht(e.props)})),e}return(0,l.Z)(n,[{key:"render",value:function(){return this.props.post.acl.can_protect?this.props.post.is_protected?null:(0,s.Z)("li",{},void 0,(0,s.Z)("button",{className:"btn btn-link",onClick:this.onClick,type:"button"},void 0,ca||(ca=(0,s.Z)("span",{className:"material-icon"},void 0,"lock_outline")),pgettext("post options protect btn","Protect"))):null}}]),n}(m().Component),La=function(e){(0,u.Z)(n,e);var t=ba(n);function n(){var e;(0,r.Z)(this,n);for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return e=t.call.apply(t,[this].concat(i)),(0,h.Z)((0,c.Z)(e),"onClick",(function(){Vt(e.props)})),e}return(0,l.Z)(n,[{key:"render",value:function(){return this.props.post.acl.can_protect&&this.props.post.is_protected?(0,s.Z)("li",{},void 0,(0,s.Z)("button",{className:"btn btn-link",onClick:this.onClick,type:"button"},void 0,ua||(ua=(0,s.Z)("span",{className:"material-icon"},void 0,"lock_open")),pgettext("post options protect btn","Remove protection"))):null}}]),n}(m().Component),Pa=function(e){(0,u.Z)(n,e);var t=ba(n);function n(){var e;(0,r.Z)(this,n);for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return e=t.call.apply(t,[this].concat(i)),(0,h.Z)((0,c.Z)(e),"onClick",(function(){Yt(e.props)})),e}return(0,l.Z)(n,[{key:"render",value:function(){var e=this.props,t=e.post,n=e.thread;return t.id===n.best_answer?null:t.acl.can_hide?t.is_hidden?null:(0,s.Z)("li",{},void 0,(0,s.Z)("button",{className:"btn btn-link",onClick:this.onClick,type:"button"},void 0,da||(da=(0,s.Z)("span",{className:"material-icon"},void 0,"visibility_off")),pgettext("post options hide btn","Hide"))):null}}]),n}(m().Component),Ta=function(e){(0,u.Z)(n,e);var t=ba(n);function n(){var e;(0,r.Z)(this,n);for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return e=t.call.apply(t,[this].concat(i)),(0,h.Z)((0,c.Z)(e),"onClick",(function(){Gt(e.props)})),e}return(0,l.Z)(n,[{key:"render",value:function(){return this.props.post.acl.can_unhide&&this.props.post.is_hidden?(0,s.Z)("li",{},void 0,(0,s.Z)("button",{className:"btn btn-link",onClick:this.onClick,type:"button"},void 0,pa||(pa=(0,s.Z)("span",{className:"material-icon"},void 0,"visibility")),pgettext("post options hide btn","Unhide"))):null}}]),n}(m().Component),Aa=function(e){(0,u.Z)(n,e);var t=ba(n);function n(){var e;(0,r.Z)(this,n);for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return e=t.call.apply(t,[this].concat(i)),(0,h.Z)((0,c.Z)(e),"onClick",(function(){Kt(e.props)})),e}return(0,l.Z)(n,[{key:"render",value:function(){var e=this.props,t=e.post,n=e.thread;return t.id===n.best_answer?null:t.acl.can_delete?(0,s.Z)("li",{},void 0,(0,s.Z)("button",{className:"btn btn-link",onClick:this.onClick,type:"button"},void 0,ha||(ha=(0,s.Z)("span",{className:"material-icon"},void 0,"clear")),pgettext("post options delete btn","Delete"))):null}}]),n}(m().Component);function Ia(e){return(0,s.Z)("div",{className:"pull-right dropdown"},void 0,_a||(_a=(0,s.Z)("button",{"aria-expanded":"true","aria-haspopup":"true",className:"btn btn-default btn-icon dropdown-toggle","data-toggle":"dropdown",type:"button"},void 0,(0,s.Z)("span",{className:"material-icon"},void 0,"expand_more"))),m().createElement(ya,e))}var Ba=n(21981);var ja,Da=function(e){(0,u.Z)(i,e);var t,n,a=(t=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,a=(0,p.Z)(t);if(n){var i=(0,p.Z)(this).constructor;e=Reflect.construct(a,arguments,i)}else e=a.apply(this,arguments);return(0,d.Z)(this,e)});function i(){var e;(0,r.Z)(this,i);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return e=a.call.apply(a,[this].concat(n)),(0,h.Z)((0,c.Z)(e),"onClick",(function(){e.props.post.isSelected?x.Z.dispatch(Ba._H(e.props.post)):x.Z.dispatch(Ba.Ys(e.props.post))})),e}return(0,l.Z)(i,[{key:"render",value:function(){return this.props.thread.acl.can_merge_posts||(e=this.props.post.acl).can_approve||e.can_hide||e.can_protect||e.can_unhide||e.can_delete||e.can_move?(0,s.Z)("div",{className:"pull-right"},void 0,(0,s.Z)("button",{className:"btn btn-default btn-icon",onClick:this.onClick,type:"button"},void 0,(0,s.Z)("span",{className:"material-icon"},void 0,this.props.post.isSelected?"check_box":"check_box_outline_blank"))):null;var e}}]),i}(m().Component),za=n(24678),Ua=n(16069);function qa(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=(0,p.Z)(e);if(t){var i=(0,p.Z)(this).constructor;n=Reflect.construct(a,arguments,i)}else n=a.apply(this,arguments);return(0,d.Z)(this,n)}}function Ma(e){return(0,s.Z)("div",{className:"post-heading"},void 0,m().createElement(Fa,e),m().createElement(Ha,e),m().createElement(Va,e),m().createElement(Ya,e),m().createElement(Wa,e),m().createElement(Qa,e),m().createElement(Ka,e),m().createElement(Da,e),m().createElement(Ia,e))}function Fa(e){return e.post.is_read?null:(0,s.Z)("span",{className:"label label-unread hidden-xs"},void 0,pgettext("post unread label","New post"))}function Ha(e){return e.post.is_read?null:(0,s.Z)("span",{className:"label label-unread visible-xs-inline-block"},void 0,pgettext("post unread label","New"))}function Va(e){return(0,s.Z)("a",{href:e.post.url.index,className:"btn btn-link posted-on hidden-xs"},void 0,(0,s.Z)(Ua.Z,{datetime:e.post.posted_on.toISOString()}))}function Ya(e){return(0,s.Z)("a",{href:e.post.url.index,className:"btn btn-link posted-on visible-xs-inline-block"},void 0,e.post.posted_on.fromNow())}var Ga,$a,Wa=function(e){(0,u.Z)(n,e);var t=qa(n);function n(){var e;(0,r.Z)(this,n);for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return e=t.call.apply(t,[this].concat(i)),(0,h.Z)((0,c.Z)(e),"onClick",(function(){k.Z.show((0,s.Z)(Mn,{post:e.props.post}))})),e}return(0,l.Z)(n,[{key:"render",value:function(){var e=this.props.post.is_hidden&&!this.props.post.acl.can_see_hidden,t=0===this.props.post.edits;if(e||t)return null;var n=npgettext("post edits stat","This post was edited %(edits)s time.","This post was edited %(edits)s times.",this.props.post.edits),a=interpolate(n,{edits:this.props.post.edits},!0),i=npgettext("post edits stat","edited %(edits)s time","edited %(edits)s times",this.props.post.edits);return(0,s.Z)("button",{className:"btn btn-link btn-see-edits hidden-xs",onClick:this.onClick,title:a,type:"button"},void 0,interpolate(i,{edits:this.props.post.edits},!0))}}]),n}(m().Component),Qa=function(e){(0,u.Z)(n,e);var t=qa(n);function n(){return(0,r.Z)(this,n),t.apply(this,arguments)}return(0,l.Z)(n,[{key:"render",value:function(){var e=this.props.post.is_hidden&&!this.props.post.acl.can_see_hidden,t=0===this.props.post.edits;if(e||t)return null;var n=npgettext("post edits stat","%(edits)s edit","%(edits)s edits",this.props.post.edits);return(0,s.Z)("button",{className:"btn btn-link btn-see-edits visible-xs-inline-block",onClick:this.onClick,type:"button"},void 0,interpolate(n,{edits:this.props.post.edits},!0))}}]),n}(Wa);function Ka(e){var t=e.post.poster&&e.post.poster.id===e.user.id,n=e.post.acl.can_protect;return e.user.id&&e.post.is_protected&&(t||n)?(0,s.Z)("span",{className:"label label-protected hidden-xs",title:pgettext("post protected label","This post is protected and may not be edited.")},void 0,ja||(ja=(0,s.Z)("span",{className:"material-icon"},void 0,"lock_outline")),pgettext("post protected label","protected")):null}function Xa(e){var t=e.post,n=e.thread;return(0,s.Z)("div",{className:"post-side post-side-anonymous"},void 0,(0,s.Z)(Da,{post:t,thread:n}),(0,s.Z)(Ia,{post:t,thread:n}),(0,s.Z)("div",{className:"media"},void 0,Ga||(Ga=(0,s.Z)("div",{className:"media-left"},void 0,(0,s.Z)("span",{},void 0,(0,s.Z)(I.ZP,{className:"poster-avatar",size:100})))),(0,s.Z)("div",{className:"media-body"},void 0,(0,s.Z)("span",{className:"media-heading item-title"},void 0,t.poster_name),(0,s.Z)("span",{className:"user-title user-title-anonymous"},void 0,pgettext("post removed poster username","Removed user")))))}function Ja(e){var t=e.title,n=e.rank;return n.is_tab||!!t||!!n.title}function ei(e){var t=e.poster,n=npgettext("poster stats","%(posts)s post","%(posts)s posts",t.posts),a="user-postcount";return Ja(t)&&(a+=" hidden-xs hidden-sm"),(0,s.Z)("span",{className:a},void 0,interpolate(n,{posts:t.posts},!0))}function ti(e){var t=e.poster,n="hidden-xs";return Ja(t)&&(n+=" hidden-sm"),(0,s.Z)("span",{className:n},void 0,(0,s.Z)(za.ZP,{status:t.status},void 0,(0,s.Z)(za.pg,{status:t.status,user:t})))}function ni(e){var t=e.rank,n=e.title||t.title;if(!n&&t.is_tab&&(n=t.name),!n)return null;var a="user-title";return t.css_class&&(a+=" user-title-"+t.css_class),t.is_tab?(0,s.Z)("div",{className:a},void 0,(0,s.Z)("a",{href:t.url},void 0,n)):(0,s.Z)("div",{className:a},void 0,n)}function ai(e){var t=e.post,n=e.thread,a=t.poster;return(0,s.Z)("div",{className:"post-side post-side-registered"},void 0,(0,s.Z)(Da,{post:t,thread:n}),(0,s.Z)(Ia,{post:t,thread:n}),(0,s.Z)("div",{className:"media"},void 0,(0,s.Z)("div",{className:"media-left"},void 0,(0,s.Z)("a",{href:a.url},void 0,(0,s.Z)(I.ZP,{className:"poster-avatar",size:100,user:a}))),(0,s.Z)("div",{className:"media-body"},void 0,(0,s.Z)("div",{className:"media-heading"},void 0,(0,s.Z)("a",{className:"item-title",href:a.url},void 0,a.username),(0,s.Z)(za.ZP,{status:a.status},void 0,(0,s.Z)(za.Jj,{status:a.status}))),(0,s.Z)(ni,{rank:a.rank,title:a.title}),(0,s.Z)(ti,{poster:a}),(0,s.Z)(ei,{poster:a}))))}function ii(e){return e.post.poster?m().createElement(ai,e):m().createElement(Xa,e)}function oi(e){var t="post";return e.post.isDeleted?t="hide":e.post.is_hidden&&!e.post.acl.can_see_hidden&&(t="post post-hidden"),e.post.poster&&e.post.poster.rank.css_class&&(t+=" post-"+e.post.poster.rank.css_class),e.post.is_read||(t+=" post-new"),(0,s.Z)("li",{id:"post-"+e.post.id,className:t},void 0,(0,s.Z)("div",{className:"panel panel-default panel-post"},void 0,(0,s.Z)("div",{className:"panel-body"},void 0,m().createElement(ii,e),(0,s.Z)("div",{className:"panel-content"},void 0,m().createElement(Ma,e),m().createElement(Dt,e),m().createElement(Ut,e),m().createElement(qt,e),m().createElement(zt,e),m().createElement(At,e),m().createElement(xt,e),m().createElement(hn,e)))))}const si=function(){return(0,s.Z)("li",{className:"post"},void 0,(0,s.Z)("div",{className:"panel panel-default panel-post"},void 0,(0,s.Z)("div",{className:"panel-body"},void 0,(0,s.Z)("div",{className:"post-side post-side-registered"},void 0,(0,s.Z)("div",{className:"media"},void 0,$a||($a=(0,s.Z)("div",{className:"media-left"},void 0,(0,s.Z)("span",{},void 0,(0,s.Z)(I.ZP,{className:"poster-avatar",size:"100"})))),(0,s.Z)("div",{className:"media-body"},void 0,(0,s.Z)("span",{className:"media-heading item-title"},void 0,(0,s.Z)("span",{className:"ui-preview-text",style:{width:"80px"}},void 0," ")),(0,s.Z)("span",{className:"user-title user-title-anonymous"},void 0,(0,s.Z)("span",{className:"ui-preview-text",style:{width:"60px"}},void 0," "))))),(0,s.Z)("div",{className:"panel-content"},void 0,(0,s.Z)("div",{className:"post-body"},void 0,(0,s.Z)("article",{className:"misago-markup"},void 0,(0,s.Z)("p",{className:"ui-preview-text",style:{width:"100%"}},void 0," "),(0,s.Z)("p",{className:"ui-preview-text",style:{width:"70%"}},void 0," "),(0,s.Z)("p",{className:"ui-preview-text hidden-xs hidden-sm",style:{width:"85%"}},void 0," ")))))))};var ri;function li(e){return e.posts.isLoaded?(0,s.Z)("ul",{className:"posts-list ui-ready"},void 0,e.posts.results.map((function(t){return m().createElement(ci,(0,f.Z)({key:t.id,post:t},e))}))):ri||(ri=(0,s.Z)("ul",{className:"posts-list ui-preview"},void 0,(0,s.Z)(si,{})))}function ci(e){return e.post.is_event?m().createElement(ft,e):m().createElement(oi,e)}var ui,di,pi,hi,vi,mi,fi,Zi=n(55547),gi=n(53328),bi=n(9771),yi=n(59131),_i=n(98936);const ki=function(e){var t=e.thread;return(0,s.Z)("ul",{className:"thread-flags"},void 0,2==t.weight&&(0,s.Z)("li",{className:"thread-flag-pinned-globally",title:pgettext("thread flag","Pinned globally")},void 0,ui||(ui=(0,s.Z)("span",{className:"material-icon"},void 0,"bookmark"))),1==t.weight&&(0,s.Z)("li",{className:"thread-flag-pinned-locally",title:pgettext("thread flag","Pinned in category")},void 0,di||(di=(0,s.Z)("span",{className:"material-icon"},void 0,"bookmark_outline"))),t.best_answer&&(0,s.Z)("li",{className:"thread-flag-answered",title:pgettext("thread flag","Answered")},void 0,pi||(pi=(0,s.Z)("span",{className:"material-icon"},void 0,"check_circle"))),t.has_poll&&(0,s.Z)("li",{className:"thread-flag-poll",title:pgettext("thread flag","Poll")},void 0,hi||(hi=(0,s.Z)("span",{className:"material-icon"},void 0,"poll"))),(t.is_unapproved||t.has_unapproved_posts)&&(0,s.Z)("li",{className:"thread-flag-unapproved",title:t.is_unapproved?pgettext("thread flag","Awaiting approval"):pgettext("thread flag","Has unapproved posts")},void 0,vi||(vi=(0,s.Z)("span",{className:"material-icon"},void 0,"visibility"))),t.is_closed&&(0,s.Z)("li",{className:"thread-flag-closed",title:pgettext("thread flag","Closed")},void 0,mi||(mi=(0,s.Z)("span",{className:"material-icon"},void 0,"lock"))),t.is_hidden&&(0,s.Z)("li",{className:"thread-flag-hidden",title:pgettext("thread flag","Hidden")},void 0,fi||(fi=(0,s.Z)("span",{className:"material-icon"},void 0,"visibility_off"))))};var Ni;const xi=function(e){var t=e.thread;return(0,s.Z)("span",{className:"threads-replies",title:interpolate(npgettext("thread replies stat","%(replies)s reply","%(replies)s replies",t.replies),{replies:t.replies},!0)},void 0,Ni||(Ni=(0,s.Z)("span",{className:"material-icon"},void 0,"chat_bubble_outline")),t.replies>980?Math.round(t.replies/1e3)+"K":t.replies)};var wi;const Ci=function(e){var t=e.thread;return(0,s.Z)("div",{className:"thread-user-card"},void 0,(0,s.Z)("div",{className:"thread-user-card-media"},void 0,t.starter?(0,s.Z)("a",{href:t.url.starter},void 0,(0,s.Z)(I.ZP,{size:40,user:t.starter})):wi||(wi=(0,s.Z)(I.ZP,{size:40}))),(0,s.Z)("div",{className:"thread-user-card-body"},void 0,(0,s.Z)("div",{className:"thread-user-card-header"},void 0,t.starter?(0,s.Z)("a",{className:"item-title",href:t.url.starter,title:pgettext("thread starter info","Thread author")},void 0,t.starter.username):(0,s.Z)("span",{className:"item-title",title:pgettext("thread starter info","Thread author")},void 0,t.starter_name)),(0,s.Z)("div",{},void 0,(0,s.Z)("span",{className:"text-muted",title:interpolate(pgettext("thread starter info","Started on: %(timestamp)s"),{timestamp:t.started_on.format("LLL")},!0)},void 0,t.started_on.fromNow()))))};var Ri,Ei,Si=n(99755),Oi=n(12891);var Li,Pi=function(e){(0,u.Z)(i,e);var t,n,a=(t=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,a=(0,p.Z)(t);if(n){var i=(0,p.Z)(this).constructor;e=Reflect.construct(a,arguments,i)}else e=a.apply(this,arguments);return(0,d.Z)(this,e)});function i(e){var t;return(0,r.Z)(this,i),t=a.call(this,e),(0,h.Z)((0,c.Z)(t),"handleSuccess",(function(e){t.handleSuccessUnmounted(e),t.setState({isLoading:!0}),k.Z.hide()})),(0,h.Z)((0,c.Z)(t),"handleSuccessUnmounted",(function(e){x.Z.dispatch(y.Ar()),x.Z.dispatch(y.Vx(e))})),(0,h.Z)((0,c.Z)(t),"handleError",(function(e){x.Z.dispatch(y.Ar()),400===e.status?N.Z.error(e.detail[0]):N.Z.apiError(e)})),(0,h.Z)((0,c.Z)(t),"onChange",(function(e){t.changeValue("title",e.target.value)})),t.state={isLoading:!1,title:e.thread.title,validators:{title:(0,Oi.jn)()},errors:{}},t}return(0,l.Z)(i,[{key:"clean",value:function(){if(!this.state.title.trim().length)return N.Z.error(pgettext("thread title form","You have to enter thread title.")),!1;var e=this.validate();return!e.title||(N.Z.error(e.title[0]),!1)}},{key:"send",value:function(){return x.Z.dispatch(y.n6()),_.Z.patch(this.props.thread.api.index,[{op:"replace",path:"title",value:this.state.title}])}},{key:"render",value:function(){return(0,s.Z)("div",{className:"modal-dialog modal-lg",role:"document"},void 0,(0,s.Z)("form",{onSubmit:this.handleSubmit},void 0,(0,s.Z)("div",{className:"modal-content"},void 0,Ri||(Ri=(0,s.Z)(Ti,{})),(0,s.Z)("div",{className:"modal-body"},void 0,(0,s.Z)(g.Z,{for:"id_modal_title",label:pgettext("thread title form field","Thread title")},void 0,(0,s.Z)("input",{className:"form-control",disabled:this.state.isLoading||this.props.thread.isBusy,id:"id_modal_title",onChange:this.onChange,value:this.state.title}))),(0,s.Z)("div",{className:"modal-footer"},void 0,(0,s.Z)("button",{className:"btn btn-default","data-dismiss":"modal",disabled:this.state.isLoading,type:"button"},void 0,pgettext("thread title form btn","Cancel")),(0,s.Z)("button",{className:"btn btn-primary",disabled:this.state.isLoading||this.props.thread.isBusy},void 0,pgettext("thread title form btn","Change title"))))))}}]),i}(Z.Z);function Ti(e){return(0,s.Z)("div",{className:"modal-header"},void 0,(0,s.Z)("button",{"aria-label":pgettext("modal","Close"),className:"close","data-dismiss":"modal",type:"button"},void 0,Ei||(Ei=(0,s.Z)("span",{"aria-hidden":"true"},void 0,"×"))),(0,s.Z)("h4",{className:"modal-title"},void 0,pgettext("thread title form title","Change title")))}var Ai,Ii,Bi=function(e){(0,u.Z)(i,e);var t,n,a=(t=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,a=(0,p.Z)(t);if(n){var i=(0,p.Z)(this).constructor;e=Reflect.construct(a,arguments,i)}else e=a.apply(this,arguments);return(0,d.Z)(this,e)});function i(e){var t;return(0,r.Z)(this,i),t=a.call(this,e),(0,h.Z)((0,c.Z)(t),"handleSuccess",(function(e){t.props.onSuccess(e),k.Z.hide()})),(0,h.Z)((0,c.Z)(t),"handleError",(function(e){t.props.onError(e)})),(0,h.Z)((0,c.Z)(t),"onBestAnswerChange",(function(e){t.changeValue("bestAnswer",e.target.value)})),(0,h.Z)((0,c.Z)(t),"onPollChange",(function(e){t.changeValue("poll",e.target.value)})),t.state={isLoading:!1,bestAnswer:"0",poll:"0"},t}return(0,l.Z)(i,[{key:"clean",value:function(){return!this.props.polls||"0"!==this.state.poll||window.confirm(pgettext("merge threads conflict form","Are you sure you want to delete all polls?"))}},{key:"send",value:function(){var e=Object.assign({},this.props.data,{best_answer:this.state.bestAnswer,poll:this.state.poll});return _.Z.post(this.props.api,e)}},{key:"render",value:function(){return(0,s.Z)("div",{className:"modal-dialog",role:"document"},void 0,(0,s.Z)("div",{className:"modal-content"},void 0,(0,s.Z)("div",{className:"modal-header"},void 0,(0,s.Z)("button",{"aria-label":pgettext("modal","Close"),className:"close","data-dismiss":"modal",type:"button"},void 0,Li||(Li=(0,s.Z)("span",{"aria-hidden":"true"},void 0,"×"))),(0,s.Z)("h4",{className:"modal-title"},void 0,pgettext("merge threads conflict modal title","Merge threads"))),(0,s.Z)("form",{onSubmit:this.handleSubmit},void 0,(0,s.Z)("div",{className:"modal-body"},void 0,(0,s.Z)(ji,{choices:this.props.bestAnswers,onChange:this.onBestAnswerChange,value:this.state.bestAnswer}),(0,s.Z)(Di,{choices:this.props.polls,onChange:this.onPollChange,value:this.state.poll})),(0,s.Z)("div",{className:"modal-footer"},void 0,(0,s.Z)("button",{className:"btn btn-default","data-dismiss":"modal",disabled:this.state.isLoading,type:"button"},void 0,pgettext("merge threads conflict btn","Cancel")),(0,s.Z)(Ae.Z,{className:"btn-primary",loading:this.state.isLoading},void 0,pgettext("merge threads conflict btn","Merge threads"))))))}}]),i}(Z.Z);function ji(e){var t=e.choices,n=e.onChange,a=e.value;return t?(0,s.Z)(g.Z,{label:pgettext("merge threads conflict best answer","Best answer"),helpText:pgettext("merge threads conflict best answer","Select the best answer for your newly merged thread. No posts will be deleted during the merge."),for:"id_best_answer"},void 0,(0,s.Z)("select",{className:"form-control",id:"id_best_answer",onChange:n,value:a},void 0,t.map((function(e){return(0,s.Z)("option",{value:e[0]},e[0],e[1])})))):null}function Di(e){var t=e.choices,n=e.onChange,a=e.value;return t?(0,s.Z)(g.Z,{label:pgettext("merge threads conflict poll","Poll"),helpText:pgettext("merge threads conflict poll","Select the poll for your newly merged thread. Rejected polls will be permanently deleted and cannot be recovered."),for:"id_poll"},void 0,(0,s.Z)("select",{className:"form-control",id:"id_poll",onChange:n,value:a},void 0,t.map((function(e){return(0,s.Z)("option",{value:e[0]},e[0],e[1])})))):null}var zi,Ui,qi,Mi,Fi,Hi,Vi=function(e){(0,u.Z)(i,e);var t,n,a=(t=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,a=(0,p.Z)(t);if(n){var i=(0,p.Z)(this).constructor;e=Reflect.construct(a,arguments,i)}else e=a.apply(this,arguments);return(0,d.Z)(this,e)});function i(e){var t;return(0,r.Z)(this,i),t=a.call(this,e),(0,h.Z)((0,c.Z)(t),"handleSuccess",(function(e){t.handleSuccessUnmounted(e),t.setState({isLoading:!0})})),(0,h.Z)((0,c.Z)(t),"handleSuccessUnmounted",(function(e){N.Z.success(pgettext("thread merge form","Thread has been merged with other one.")),window.location=e.url})),(0,h.Z)((0,c.Z)(t),"handleError",(function(e){x.Z.dispatch(y.Ar()),400===e.status?e.best_answers||e.polls?k.Z.show((0,s.Z)(Bi,{api:t.props.thread.api.merge,bestAnswers:e.best_answers,data:{other_thread:t.state.url},polls:e.polls,onError:t.handleError,onSuccess:t.handleSuccessUnmounted})):e.best_answer?N.Z.error(e.best_answer[0]):e.poll?N.Z.error(e.poll[0]):N.Z.error(e.detail):N.Z.apiError(e)})),(0,h.Z)((0,c.Z)(t),"onUrlChange",(function(e){t.changeValue("url",e.target.value)})),t.state={isLoading:!1,url:"",validators:{url:[]},errors:{}},t}return(0,l.Z)(i,[{key:"clean",value:function(){return!!this.state.url.trim().length||(N.Z.error(pgettext("thread merge form","You have to enter link to the other thread.")),!1)}},{key:"send",value:function(){return x.Z.dispatch(y.n6()),_.Z.post(this.props.thread.api.merge,{other_thread:this.state.url})}},{key:"render",value:function(){return(0,s.Z)("div",{className:"modal-dialog",role:"document"},void 0,(0,s.Z)("form",{onSubmit:this.handleSubmit},void 0,(0,s.Z)("div",{className:"modal-content"},void 0,Ai||(Ai=(0,s.Z)(Yi,{})),(0,s.Z)("div",{className:"modal-body"},void 0,(0,s.Z)(g.Z,{for:"id_url",label:pgettext("thread merge form field","Link to thread you want to merge with"),help_text:pgettext("thread merge form field","Merge will delete current thread and move its contents to the thread specified here.")},void 0,(0,s.Z)("input",{className:"form-control",disabled:this.state.isLoading||this.props.thread.isBusy,id:"id_url",onChange:this.onUrlChange,value:this.state.url}))),(0,s.Z)("div",{className:"modal-footer"},void 0,(0,s.Z)("button",{className:"btn btn-default","data-dismiss":"modal",disabled:this.state.isLoading,type:"button"},void 0,pgettext("thread merge form btn","Cancel")),(0,s.Z)("button",{className:"btn btn-primary",disabled:this.state.isLoading||this.props.thread.isBusy},void 0,pgettext("thread merge form btn","Merge thread"))))))}}]),i}(Z.Z);function Yi(e){return(0,s.Z)("div",{className:"modal-header"},void 0,(0,s.Z)("button",{"aria-label":pgettext("modal","Close"),className:"close","data-dismiss":"modal",type:"button"},void 0,Ii||(Ii=(0,s.Z)("span",{"aria-hidden":"true"},void 0,"×"))),(0,s.Z)("h4",{className:"modal-title"},void 0,pgettext("thread merge form title","Merge thread")))}var Gi,$i,Wi,Qi,Ki,Xi,Ji,eo,to,no,ao,io,oo=function(e){(0,u.Z)(i,e);var t,n,a=(t=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,a=(0,p.Z)(t);if(n){var i=(0,p.Z)(this).constructor;e=Reflect.construct(a,arguments,i)}else e=a.apply(this,arguments);return(0,d.Z)(this,e)});function i(e){var t;return(0,r.Z)(this,i),t=a.call(this,e),(0,h.Z)((0,c.Z)(t),"onCategoryChange",(function(e){t.changeValue("category",e.target.value)})),t.state={isReady:!1,isLoading:!1,isError:!1,category:null,categories:[]},t}return(0,l.Z)(i,[{key:"componentDidMount",value:function(){var e=this;_.Z.get(S.Z.get("THREAD_EDITOR_API")).then((function(t){var n=null,a=t.map((function(e){return!1===e.post||n||(n=e.id),Object.assign(e,{disabled:!1===e.post,label:e.name,value:e.id})}));e.setState({isReady:!0,category:n,categories:a})}),(function(t){e.setState({isError:t.detail})}))}},{key:"send",value:function(){return x.Z.dispatch(y.n6()),_.Z.patch(this.props.thread.api.index,[{op:"replace",path:"category",value:this.state.category}])}},{key:"handleSuccess",value:function(){_.Z.get(this.props.thread.api.posts.index,{page:this.props.posts.page}).then((function(e){x.Z.dispatch(y.gx(e)),x.Z.dispatch(Ba.zD(e.post_set)),x.Z.dispatch(y.Ar()),N.Z.success(pgettext("thread move form","Thread has been moved.")),k.Z.hide()}),(function(e){x.Z.dispatch(y.Ar()),N.Z.apiError(e)}))}},{key:"handleError",value:function(e){400===e.status?N.Z.error(e.detail[0]):N.Z.apiError(e)}},{key:"render",value:function(){return this.state.isReady?(0,s.Z)("div",{className:"modal-dialog",role:"document"},void 0,(0,s.Z)("form",{onSubmit:this.handleSubmit},void 0,(0,s.Z)("div",{className:"modal-content"},void 0,zi||(zi=(0,s.Z)(so,{})),(0,s.Z)("div",{className:"modal-body"},void 0,(0,s.Z)(g.Z,{for:"id_category",label:pgettext("thread move form field","New category")},void 0,(0,s.Z)(Qn.Z,{choices:this.state.categories,disabled:this.state.isLoading||this.props.thread.isBusy,id:"id_category",onChange:this.onCategoryChange,value:this.state.category}))),(0,s.Z)("div",{className:"modal-footer"},void 0,(0,s.Z)("button",{className:"btn btn-default","data-dismiss":"modal",disabled:this.state.isLoading,type:"button"},void 0,pgettext("thread move form btn","Cancel")),(0,s.Z)("button",{className:"btn btn-primary",disabled:this.state.isLoading||this.props.thread.isBusy},void 0,pgettext("thread move form btn","Move thread")))))):this.state.isError?(0,s.Z)(lo,{message:this.state.isError}):Ui||(Ui=(0,s.Z)(ro,{}))}}]),i}(Z.Z);function so(e){return(0,s.Z)("div",{className:"modal-header"},void 0,(0,s.Z)("button",{"aria-label":pgettext("modal","Close"),className:"close","data-dismiss":"modal",type:"button"},void 0,qi||(qi=(0,s.Z)("span",{"aria-hidden":"true"},void 0,"×"))),(0,s.Z)("h4",{className:"modal-title"},void 0,pgettext("thread move form title","Move thread")))}function ro(e){return Mi||(Mi=(0,s.Z)("div",{className:"modal-dialog",role:"document"},void 0,(0,s.Z)("div",{className:"modal-content"},void 0,(0,s.Z)(so,{}),(0,s.Z)(J.Z,{}))))}function lo(e){return(0,s.Z)("div",{className:"modal-dialog modal-message",role:"document"},void 0,(0,s.Z)("div",{className:"modal-content"},void 0,Fi||(Fi=(0,s.Z)(so,{})),Hi||(Hi=(0,s.Z)("div",{className:"message-icon"},void 0,(0,s.Z)("span",{className:"material-icon"},void 0,"info_outline"))),(0,s.Z)("div",{className:"message-body"},void 0,(0,s.Z)("p",{className:"lead"},void 0,pgettext("thread move form","You can't move this thread at the moment.")),(0,s.Z)("p",{},void 0,e.message),(0,s.Z)("button",{className:"btn btn-default","data-dismiss":"modal",type:"button"},void 0,pgettext("thread move form dismiss btn","Ok")))))}var co=function(e){(0,u.Z)(i,e);var t,n,a=(t=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,a=(0,p.Z)(t);if(n){var i=(0,p.Z)(this).constructor;e=Reflect.construct(a,arguments,i)}else e=a.apply(this,arguments);return(0,d.Z)(this,e)});function i(){var e;(0,r.Z)(this,i);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return e=a.call.apply(a,[this].concat(n)),(0,h.Z)((0,c.Z)(e),"callApi",(function(t,n){x.Z.dispatch(y.n6()),t.push({op:"add",path:"acl",value:!0}),_.Z.patch(e.props.thread.api.index,t).then((function(e){x.Z.dispatch(y.Vx(e)),x.Z.dispatch(y.Ar()),N.Z.success(n)}),(function(e){x.Z.dispatch(y.Ar()),400===e.status?N.Z.error(e.detail[0]):N.Z.apiError(e)}))})),(0,h.Z)((0,c.Z)(e),"changeTitle",(function(){k.Z.show((0,s.Z)(Pi,{thread:e.props.thread}))})),(0,h.Z)((0,c.Z)(e),"pinGlobally",(function(){e.callApi([{op:"replace",path:"weight",value:2}],pgettext("thread moderation","Thread has been pinned globally."))})),(0,h.Z)((0,c.Z)(e),"pinLocally",(function(){e.callApi([{op:"replace",path:"weight",value:1}],pgettext("thread moderation","Thread has been pinned in category."))})),(0,h.Z)((0,c.Z)(e),"unpin",(function(){e.callApi([{op:"replace",path:"weight",value:0}],pgettext("thread moderation","Thread has been unpinned."))})),(0,h.Z)((0,c.Z)(e),"approve",(function(){e.callApi([{op:"replace",path:"is-unapproved",value:!1}],pgettext("thread moderation","Thread has been approved."))})),(0,h.Z)((0,c.Z)(e),"open",(function(){e.callApi([{op:"replace",path:"is-closed",value:!1}],gettext("Thread has been opened."))})),(0,h.Z)((0,c.Z)(e),"close",(function(){e.callApi([{op:"replace",path:"is-closed",value:!0}],pgettext("thread moderation","Thread has been closed."))})),(0,h.Z)((0,c.Z)(e),"unhide",(function(){e.callApi([{op:"replace",path:"is-hidden",value:!1}],pgettext("thread moderation","Thread has been made visible."))})),(0,h.Z)((0,c.Z)(e),"hide",(function(){e.callApi([{op:"replace",path:"is-hidden",value:!0}],pgettext("thread moderation","Thread has been made hidden."))})),(0,h.Z)((0,c.Z)(e),"move",(function(){k.Z.show((0,s.Z)(oo,{posts:e.props.posts,thread:e.props.thread}))})),(0,h.Z)((0,c.Z)(e),"merge",(function(){k.Z.show((0,s.Z)(Vi,{thread:e.props.thread}))})),(0,h.Z)((0,c.Z)(e),"delete",(function(){window.confirm(pgettext("thread moderation","Are you sure you want to delete this thread?"))&&(x.Z.dispatch(y.n6()),_.Z.delete(e.props.thread.api.index).then((function(t){N.Z.success(pgettext("thread moderation","Thread has been deleted.")),window.location=e.props.thread.category.url.index}),(function(e){x.Z.dispatch(y.Ar()),N.Z.apiError(e)})))})),e}return(0,l.Z)(i,[{key:"render",value:function(){var e=this.props.moderation;return(0,s.Z)("ul",{className:"dropdown-menu dropdown-menu-right stick-to-bottom"},void 0,!!e.edit&&(0,s.Z)("li",{},void 0,(0,s.Z)("button",{className:"btn btn-link",onClick:this.changeTitle,type:"button"},void 0,Gi||(Gi=(0,s.Z)("span",{className:"material-icon"},void 0,"edit")),pgettext("thread moderation btn","Change title"))),!!e.pinGlobally&&(0,s.Z)("li",{},void 0,(0,s.Z)("button",{className:"btn btn-link",onClick:this.pinGlobally,type:"button"},void 0,$i||($i=(0,s.Z)("span",{className:"material-icon"},void 0,"bookmark")),pgettext("thread moderation btn","Pin globally"))),!!e.pinLocally&&(0,s.Z)("li",{},void 0,(0,s.Z)("button",{className:"btn btn-link",onClick:this.pinLocally,type:"button"},void 0,Wi||(Wi=(0,s.Z)("span",{className:"material-icon"},void 0,"bookmark_border")),pgettext("thread moderation btn","Pin in category"))),!!e.unpin&&(0,s.Z)("li",{},void 0,(0,s.Z)("button",{className:"btn btn-link",onClick:this.unpin,type:"button"},void 0,Qi||(Qi=(0,s.Z)("span",{className:"material-icon"},void 0,"panorama_fish_eye")),pgettext("thread moderation btn","Unpin"))),!!e.move&&(0,s.Z)("li",{},void 0,(0,s.Z)("button",{className:"btn btn-link",onClick:this.move,type:"button"},void 0,Ki||(Ki=(0,s.Z)("span",{className:"material-icon"},void 0,"arrow_forward")),pgettext("thread moderation btn","Move"))),!!e.merge&&(0,s.Z)("li",{},void 0,(0,s.Z)("button",{className:"btn btn-link",onClick:this.merge,type:"button"},void 0,Xi||(Xi=(0,s.Z)("span",{className:"material-icon"},void 0,"call_merge")),pgettext("thread moderation btn","Merge"))),!!e.approve&&(0,s.Z)("li",{},void 0,(0,s.Z)("button",{className:"btn btn-link",onClick:this.approve,type:"button"},void 0,Ji||(Ji=(0,s.Z)("span",{className:"material-icon"},void 0,"done")),pgettext("thread moderation btn","Approve"))),!!e.open&&(0,s.Z)("li",{},void 0,(0,s.Z)("button",{className:"btn btn-link",onClick:this.open,type:"button"},void 0,eo||(eo=(0,s.Z)("span",{className:"material-icon"},void 0,"lock_open")),pgettext("thread moderation btn","Open"))),!!e.close&&(0,s.Z)("li",{},void 0,(0,s.Z)("button",{className:"btn btn-link",onClick:this.close,type:"button"},void 0,to||(to=(0,s.Z)("span",{className:"material-icon"},void 0,"lock_outline")),pgettext("thread moderation btn","Close"))),!!e.unhide&&(0,s.Z)("li",{},void 0,(0,s.Z)("button",{className:"btn btn-link",onClick:this.unhide,type:"button"},void 0,no||(no=(0,s.Z)("span",{className:"material-icon"},void 0,"visibility")),pgettext("thread moderation btn","Unhide"))),!!e.hide&&(0,s.Z)("li",{},void 0,(0,s.Z)("button",{className:"btn btn-link",onClick:this.hide,type:"button"},void 0,ao||(ao=(0,s.Z)("span",{className:"material-icon"},void 0,"visibility_off")),pgettext("thread moderation btn","Hide"))),!!e.delete&&(0,s.Z)("li",{},void 0,(0,s.Z)("button",{className:"btn btn-link",onClick:this.delete,type:"button"},void 0,io||(io=(0,s.Z)("span",{className:"material-icon"},void 0,"clear")),pgettext("thread moderation btn","Delete"))))}}]),i}(m().Component);const uo=co;var po;const ho=function(e){var t=e.thread,n=e.posts,a=e.moderation;return(0,s.Z)("div",{className:"dropdown"},void 0,(0,s.Z)("button",{type:"button",className:"btn btn-default btn-outline btn-icon dropdown-toggle",title:pgettext("thread options btn","Thread options"),"data-toggle":"dropdown","aria-haspopup":"true","aria-expanded":"false",disabled:t.isBusy},void 0,po||(po=(0,s.Z)("span",{className:"material-icon"},void 0,"settings"))),(0,s.Z)(uo,{thread:t,posts:n,moderation:a}))};var vo,mo,fo,Zo=n(94184),go=n.n(Zo),bo=n(60642),yo=n(49021);const _o=(0,o.$j)()((function(e){var t=e.dispatch,n=e.dropup,a=e.stickToBottom,i=e.thread;return(0,s.Z)(bo.D,{url:i.api.watch},void 0,(function(e,o){var r,l=o.loading;function c(n){i.notifications!==n&&(t((0,y.Vx)({notifications:n})),e({json:{notifications:n},onError:function(e){N.Z.apiError(e),t((0,y.Vx)({notifications:i.notifications}))}}))}return(0,s.Z)("div",{className:n?"dropup":"dropdown"},void 0,(0,s.Z)("button",{className:"btn btn-default btn-outline btn-block","aria-expanded":"true","aria-haspopup":"true","data-toggle":"dropdown",type:"button"},void 0,(0,s.Z)("span",{className:"material-icon"},void 0,2===(r=i.notifications)?"mail":1===r?"notifications_active":"notifications_none"),function(e){return e?pgettext("watch thread","Watching"):pgettext("watch thread","Watch")}(i.notifications)),(0,s.Z)("ul",{className:go()("dropdown-menu dropdown-menu-right",{"stick-to-bottom":a})},void 0,(0,s.Z)(yo.iC,{},void 0,pgettext("watch thread","Notify about new replies")),(0,s.Z)("li",{},void 0,(0,s.Z)("button",{className:"btn btn-link",disabled:l,onClick:function(){return c(2)}},void 0,vo||(vo=(0,s.Z)("span",{className:"material-icon"},void 0,"mail")),pgettext("watch thread","On site and with e-mail"))),(0,s.Z)("li",{},void 0,(0,s.Z)("button",{className:"btn btn-link",disabled:l,onClick:function(){return c(1)}},void 0,mo||(mo=(0,s.Z)("span",{className:"material-icon"},void 0,"notifications_active")),pgettext("watch thread","On site only"))),(0,s.Z)("li",{},void 0,(0,s.Z)("button",{className:"btn btn-link",disabled:l,onClick:function(){return c(0)}},void 0,fo||(fo=(0,s.Z)("span",{className:"material-icon"},void 0,"notifications_none")),pgettext("watch thread","Don't notify")))))}))})),ko=function(e){var t=e.children,n=e.className;return(0,s.Z)("ul",{className:go()("breadcrumbs",n)},void 0,t)},No=function(e){var t=e.category,n=e.className;return(0,s.Z)("li",{className:go()("breadcrumbs-item",n)},void 0,(0,s.Z)("a",{href:t.url.index},void 0,(0,s.Z)("span",{className:"material-icon",style:{color:t.color||"inherit"}},void 0,"label"),!!t.short_name&&(0,s.Z)("span",{className:"breadcrumbs-item-name hidden-sm hidden-md hidden-lg",title:t.name},void 0,t.short_name),!!t.short_name&&(0,s.Z)("span",{className:"breadcrumbs-item-name hidden-xs"},void 0,t.name),!t.short_name&&(0,s.Z)("span",{className:"breadcrumbs-item-name"},void 0,t.name)))};var xo;const wo=function(e){var t=e.category,n=e.className;return(0,s.Z)("li",{className:go()("breadcrumbs-item",n)},void 0,(0,s.Z)("a",{href:t.url.index},void 0,xo||(xo=(0,s.Z)("span",{className:"material-icon"},void 0,"chevron_right")),(0,s.Z)("span",{className:"breadcrumbs-item-name"},void 0,"root_category"===t.special_role?pgettext("breadcrumb","Threads"):pgettext("breadcrumb","Private threads"))))},Co=function(e){var t=e.breadcrumbs;return(0,s.Z)(ko,{},void 0,t.map((function(e){return e.special_role?(0,s.Z)(wo,{category:e},e.id):(0,s.Z)(No,{category:e},e.id)})))};var Ro;const Eo=function(e){var t=e.styleName,n=e.thread,a=e.posts,i=e.user,o=e.moderation;return(0,s.Z)(Si.sP,{},void 0,(0,s.Z)(Si.mr,{styleName:t},void 0,(0,s.Z)(Si.gC,{styleName:t},void 0,(0,s.Z)(Co,{breadcrumbs:n.path}),(0,s.Z)("h1",{},void 0,n.title)),(0,s.Z)(Si.eA,{className:"page-header-thread-details"},void 0,(0,s.Z)(_i.gq,{},void 0,(0,s.Z)(_i.kw,{auto:!0},void 0,(0,s.Z)(_i.Z6,{shrink:!0},void 0,(0,s.Z)(Ci,{thread:n})),Ro||(Ro=(0,s.Z)(_i.Z6,{auto:!0})),n.replies>0&&(0,s.Z)(_i.Z6,{shrink:!0},void 0,(0,s.Z)(xi,{thread:n})),function(e){return e.is_closed||e.is_hidden||e.is_unapproved||e.weight>0||e.best_answer||e.has_poll||e.has_unapproved_posts}(n)&&(0,s.Z)(_i.Z6,{shrink:!0},void 0,(0,s.Z)(ki,{thread:n}))),i.is_authenticated&&(0,s.Z)(_i.kw,{},void 0,(0,s.Z)(_i.Z6,{},void 0,(0,s.Z)(_o,{thread:n})),o.enabled&&(0,s.Z)(_i.Z6,{shrink:!0},void 0,(0,s.Z)(ho,{thread:n,posts:a,moderation:o})))))))};var So,Oo,Lo,Po,To,Ao,Io,Bo,jo=n(92490),Do=n(69987);function zo(){window.scrollTo(0,0)}var Uo=(0,Do.EN)((function(e){var t=e.router,n=e.baseUrl,a=e.posts,i=e.scrollToTop;return(0,s.Z)("div",{className:"thread-paginator"},void 0,a.isLoaded&&a.first?(0,s.Z)(Do.rU,{className:"btn btn-default btn-outline btn-icon",to:n,title:pgettext("paginator","Go to first page"),onClick:i?zo:null},void 0,So||(So=(0,s.Z)("span",{className:"material-icon"},void 0,"first_page"))):(0,s.Z)("button",{className:"btn btn-default btn-outline btn-icon",title:pgettext("paginator","Go to first page"),type:"button",disabled:!0},void 0,Oo||(Oo=(0,s.Z)("span",{className:"material-icon"},void 0,"first_page"))),a.isLoaded&&a.previous?(0,s.Z)(Do.rU,{className:"btn btn-default btn-outline btn-icon",to:n+(a.previous>1?a.previous+"/":""),title:pgettext("paginator","Go to previous page"),onClick:i?zo:null},void 0,Lo||(Lo=(0,s.Z)("span",{className:"material-icon"},void 0,"chevron_left"))):(0,s.Z)("button",{className:"btn btn-default btn-outline btn-icon",title:pgettext("paginator","Go to previous page"),type:"button",disabled:!0},void 0,Po||(Po=(0,s.Z)("span",{className:"material-icon"},void 0,"chevron_left"))),(0,s.Z)(yo.Lt,{toggle:function(e){var t,n,i=e.aria,o=e.toggle;return m().createElement("button",(0,f.Z)({},i,{className:"btn btn-default btn-block btn-outline",type:"button",disabled:!a.isLoaded,onClick:o}),(t=a.page,n=a.pages,pgettext("paginator","Page %(page)s of %(pages)s").replace("%(page)s",t).replace("%(pages)s",n)))},onOpen:function(e){e.querySelector("input").focus()}},void 0,(function(e){var o=e.close;return(0,s.Z)("form",{className:"thread-paginator-form",onSubmit:function(e){if(a.isLoaded){var s=new FormData(e.target),r=parseInt(s.get("page"));if(r&&r!=a.page&&r>=1&&r<=a.pages){var l=r>1?n+r+"/":n;t.push({pathname:l})}}e.preventDefault(),o(),i&&zo()}},void 0,(0,s.Z)("input",{className:"form-control",name:"page",type:"number",min:1,max:a.pages,placeholder:pgettext("paginator input","Page"),disabled:!a.isLoaded}),(0,s.Z)("button",{className:"btn btn-primary",type:"submit",disabled:!a.isLoaded},void 0,pgettext("paginator","Go")))})),a.isLoaded&&a.next?(0,s.Z)(Do.rU,{className:"btn btn-default btn-outline btn-icon",to:n+a.next+"/",title:pgettext("paginator","Go to next page"),onClick:i?zo:null},void 0,To||(To=(0,s.Z)("span",{className:"material-icon"},void 0,"chevron_right"))):(0,s.Z)("button",{className:"btn btn-default btn-outline btn-icon",title:pgettext("paginator","Go to next page"),type:"button",disabled:!0},void 0,Ao||(Ao=(0,s.Z)("span",{className:"material-icon"},void 0,"chevron_right"))),a.isLoaded&&a.last?(0,s.Z)(Do.rU,{className:"btn btn-default btn-outline btn-icon",to:n+a.last+"/",title:pgettext("paginator","Go to last page"),onClick:i?zo:null},void 0,Io||(Io=(0,s.Z)("span",{className:"material-icon"},void 0,"last_page"))):(0,s.Z)("button",{className:"btn btn-default btn-outline btn-icon",title:pgettext("paginator","Go to last page"),type:"button",disabled:!0},void 0,Bo||(Bo=(0,s.Z)("span",{className:"material-icon"},void 0,"last_page"))))}));const qo=Uo;var Mo,Fo,Ho;function Vo(e){var t=e.errors,n=e.posts;return(0,s.Z)("div",{className:"modal-dialog",role:"document"},void 0,(0,s.Z)("div",{className:"modal-content"},void 0,(0,s.Z)("div",{className:"modal-header"},void 0,(0,s.Z)("button",{"aria-label":pgettext("modal","Close"),className:"close","data-dismiss":"modal",type:"button"},void 0,Mo||(Mo=(0,s.Z)("span",{"aria-hidden":"true"},void 0,"×"))),(0,s.Z)("h4",{className:"modal-title"},void 0,pgettext("thread posts moderation modal title","Moderation"))),(0,s.Z)("div",{className:"modal-body"},void 0,(0,s.Z)("p",{className:"lead"},void 0,pgettext("thread posts moderation modal","One or more posts could not be changed:")),(0,s.Z)("ul",{className:"list-unstyled list-errored-items"},void 0,t.map((function(e){return(0,s.Z)(Yo,{errors:e.detail,post:n[e.id]},e.id)}))))))}function Yo(e){var t=e.errors,n=e.post,a=interpolate(pgettext("thread posts moderation modal","%(username)s on %(posted_on)s"),{posted_on:n.posted_on.format("LL, LT"),username:n.poster_name},!0);return(0,s.Z)("li",{},void 0,(0,s.Z)("h5",{},void 0,a,":"),t.map((function(e,t){return(0,s.Z)("p",{},t,e)})))}function Go(e){var t=e.selection,n=t.map((function(e){return{id:e.id,is_unapproved:!1}})),a=t.map((function(e){return{id:e.id,is_unapproved:e.is_unapproved}}));Xo(e,[{op:"replace",path:"is-unapproved",value:!1}],n,a)}function $o(e){var t=e.selection,n=t.map((function(e){return{id:e.id,is_protected:!0}})),a=t.map((function(e){return{id:e.id,is_protected:e.is_protected}}));Xo(e,[{op:"replace",path:"is-protected",value:!0}],n,a)}function Wo(e){var t=e.selection,n=t.map((function(e){return{id:e.id,is_protected:!1}})),a=t.map((function(e){return{id:e.id,is_protected:e.is_protected}}));Xo(e,[{op:"replace",path:"is-protected",value:!1}],n,a)}function Qo(e){var t=e.selection,n=t.map((function(t){return{id:t.id,is_hidden:!0,hidden_on:F()(),hidden_by_name:e.user.username,url:Object.assign(t.url,{hidden_by:e.user.url})}})),a=t.map((function(e){return{id:e.id,is_hidden:e.is_hidden,hidden_on:e.hidden_on,hidden_by_name:e.hidden_by_name,url:e.url}}));Xo(e,[{op:"replace",path:"is-hidden",value:!0}],n,a)}function Ko(e){var t=e.selection,n=t.map((function(t){return{id:t.id,is_hidden:!1,hidden_on:F()(),hidden_by_name:e.user.username,url:Object.assign(t.url,{hidden_by:e.user.url})}})),a=t.map((function(e){return{id:e.id,is_hidden:e.is_hidden,hidden_on:e.hidden_on,hidden_by_name:e.hidden_by_name,url:e.url}}));Xo(e,[{op:"replace",path:"is-hidden",value:!1}],n,a)}function Xo(e,t,n,a){var i=e.selection,o=e.thread;n.forEach((function(e){Ge.r$(e,e)})),x.Z.dispatch(Ba.kR());var r={ops:t,ids:i.map((function(e){return e.id}))};_.Z.patch(o.api.posts.index,r).then((function(e){e.forEach((function(e){x.Z.dispatch(Ge.r$(e,e))}))}),(function(e){if(400!==e.status)return a.forEach((function(e){x.Z.dispatch(Ge.r$(e,e))})),N.Z.apiError(e);var t=[],n=[];e.forEach((function(e){e.detail?(t.push(e),n.push(e.id)):x.Z.dispatch(Ge.r$(e,e)),a.forEach((function(e){-1!==n.indexOf(e)&&x.Z.dispatch(Ge.r$(e,e))}))}));var o={};i.forEach((function(e){o[e.id]=e})),k.Z.show((0,s.Z)(Vo,{errors:t,posts:o}))}))}function Jo(e){window.confirm(pgettext("merge posts","Are you sure you want to merge selected posts? This action is not reversible!"))&&(e.selection.slice(1).map((function(e){x.Z.dispatch(Ge.r$(e,{isDeleted:!0}))})),_.Z.post(e.thread.api.posts.merge,{posts:e.selection.map((function(e){return e.id}))}).then((function(e){x.Z.dispatch(Ge.r$(e,Ge.ZB(e)))}),(function(t){400===t.status?N.Z.error(t.detail):N.Z.apiError(t),e.selection.slice(1).map((function(e){x.Z.dispatch(Ge.r$(e,{isDeleted:!1}))}))})),x.Z.dispatch(Ba.kR()))}function es(e){if(window.confirm(pgettext("delete posts","Are you sure you want to delete selected posts? This action is not reversible!"))){e.selection.map((function(e){x.Z.dispatch(Ge.r$(e,{isDeleted:!0}))}));var t=e.selection.map((function(e){return e.id}));_.Z.delete(e.thread.api.posts.index,t).then((function(){}),(function(t){400===t.status?N.Z.error(t.detail):N.Z.apiError(t),e.selection.map((function(e){x.Z.dispatch(Ge.r$(e,{isDeleted:!1}))}))})),x.Z.dispatch(Ba.kR())}}var ts,ns,as,is,os,ss,rs=function(e){(0,u.Z)(i,e);var t,n,a=(t=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,a=(0,p.Z)(t);if(n){var i=(0,p.Z)(this).constructor;e=Reflect.construct(a,arguments,i)}else e=a.apply(this,arguments);return(0,d.Z)(this,e)});function i(e){var t;return(0,r.Z)(this,i),t=a.call(this,e),(0,h.Z)((0,c.Z)(t),"onUrlChange",(function(e){t.changeValue("url",e.target.value)})),t.state={isLoading:!1,url:"",validators:{url:[]},errors:{}},t}return(0,l.Z)(i,[{key:"clean",value:function(){return!!this.state.url.trim().length||(N.Z.error(pgettext("thread posts moderation move","You have to enter link to the other thread.")),!1)}},{key:"send",value:function(){return _.Z.post(this.props.thread.api.posts.move,{new_thread:this.state.url,posts:this.props.selection.map((function(e){return e.id}))})}},{key:"handleSuccess",value:function(e){this.props.selection.forEach((function(e){x.Z.dispatch(Ge.r$(e,{isDeleted:!0}))})),k.Z.hide(),N.Z.success(pgettext("thread posts moderation move","Selected posts were moved to the other thread."))}},{key:"handleError",value:function(e){400===e.status?N.Z.error(e.detail):N.Z.apiError(e)}},{key:"render",value:function(){return(0,s.Z)("div",{className:"modal-dialog",role:"document"},void 0,(0,s.Z)("form",{onSubmit:this.handleSubmit},void 0,(0,s.Z)("div",{className:"modal-content"},void 0,Fo||(Fo=(0,s.Z)(ls,{})),(0,s.Z)("div",{className:"modal-body"},void 0,(0,s.Z)(g.Z,{for:"id_url",label:pgettext("thread posts moderation move","Link to thread you want to move posts to")},void 0,(0,s.Z)("input",{className:"form-control",disabled:this.state.isLoading,id:"id_url",onChange:this.onUrlChange,value:this.state.url}))),(0,s.Z)("div",{className:"modal-footer"},void 0,(0,s.Z)("button",{className:"btn btn-default","data-dismiss":"modal",disabled:this.state.isLoading,type:"button"},void 0,pgettext("thread posts moderation move btn","Cancel")),(0,s.Z)("button",{className:"btn btn-primary",disabled:this.state.isLoading},void 0,pgettext("thread posts moderation move btn","Move posts"))))))}}]),i}(Z.Z);function ls(e){return(0,s.Z)("div",{className:"modal-header"},void 0,(0,s.Z)("button",{"aria-label":pgettext("modal","Close"),className:"close","data-dismiss":"modal",type:"button"},void 0,Ho||(Ho=(0,s.Z)("span",{"aria-hidden":"true"},void 0,"×"))),(0,s.Z)("h4",{className:"modal-title"},void 0,pgettext("thread posts moderation move title","Move posts")))}function cs(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=(0,p.Z)(e);if(t){var i=(0,p.Z)(this).constructor;n=Reflect.construct(a,arguments,i)}else n=a.apply(this,arguments);return(0,d.Z)(this,n)}}function us(e){return m().createElement(ys,(0,f.Z)({},e,{Form:_s}))}var ds,ps,hs,vs,ms,fs,Zs,gs,bs,ys=function(e){(0,u.Z)(n,e);var t=cs(n);function n(e){var a;return(0,r.Z)(this,n),(a=t.call(this,e)).state={isLoaded:!1,isError:!1,categories:[]},a}return(0,l.Z)(n,[{key:"componentDidMount",value:function(){var e=this;_.Z.get(misago.get("THREAD_EDITOR_API")).then((function(t){var n=t.map((function(e){return Object.assign(e,{disabled:!1===e.post,label:e.name,value:e.id,post:e.post})}));e.setState({isLoaded:!0,categories:n})}),(function(t){e.setState({isError:t.detail})}))}},{key:"render",value:function(){return this.state.isError?(0,s.Z)(Ns,{message:this.state.isError}):this.state.isLoaded?m().createElement(_s,(0,f.Z)({},this.props,{categories:this.state.categories})):ts||(ts=(0,s.Z)(ks,{}))}}]),n}(m().Component),_s=function(e){(0,u.Z)(n,e);var t=cs(n);function n(e){var a;return(0,r.Z)(this,n),a=t.call(this,e),(0,h.Z)((0,c.Z)(a),"onCategoryChange",(function(e){var t=e.target.value,n={category:t};a.acl[t].can_pin_threads<n.weight&&(n.weight=0),a.acl[t].can_hide_threads||(n.is_hidden=0),a.acl[t].can_close_threads||(n.is_closed=!1),a.setState(n)})),a.state={isLoading:!1,title:"",category:null,categories:e.categories,weight:0,is_hidden:0,is_closed:!1,validators:{title:[Xn.C1()]},errors:{}},a.isHiddenChoices=[{value:0,icon:"visibility",label:pgettext("thread hidden switch choice","No")},{value:1,icon:"visibility_off",label:pgettext("thread hidden switch choice","Yes")}],a.isClosedChoices=[{value:!1,icon:"lock_outline",label:pgettext("thread closed switch choice","No")},{value:!0,icon:"lock",label:pgettext("thread closed switch choice","Yes")}],a.acl={},a.props.categories.forEach((function(e){e.post&&(a.state.category||(a.state.category=e.id),a.acl[e.id]={can_pin_threads:e.post.pin,can_close_threads:e.post.close,can_hide_threads:e.post.hide})})),a}return(0,l.Z)(n,[{key:"clean",value:function(){return!!this.isValid()||(N.Z.error(gettext("Form contains errors.")),this.setState({errors:this.validate()}),!1)}},{key:"send",value:function(){return _.Z.post(this.props.thread.api.posts.split,{title:this.state.title,category:this.state.category,weight:this.state.weight,is_hidden:this.state.is_hidden,is_closed:this.state.is_closed,posts:this.props.selection.map((function(e){return e.id}))})}},{key:"handleSuccess",value:function(e){this.props.selection.forEach((function(e){x.Z.dispatch(Ge.r$(e,{isDeleted:!0}))})),k.Z.hide(),N.Z.success(pgettext("posts moderation split","Selected posts were split into new thread."))}},{key:"handleError",value:function(e){400===e.status?(this.setState({errors:Object.assign({},this.state.errors,e)}),N.Z.error(gettext("Form contains errors."))):403===e.status&&Array.isArray(e)?k.Z.show((0,s.Z)(Vo,{errors:e})):N.Z.apiError(e)}},{key:"getWeightChoices",value:function(){var e=[{value:0,icon:"remove",label:pgettext("thread weight choice","Not pinned")},{value:1,icon:"bookmark_border",label:pgettext("thread weight choice","Pinned in category")}];return 2==this.acl[this.state.category].can_pin_threads&&e.push({value:2,icon:"bookmark",label:pgettext("thread weight choice","Pinned globally")}),e}},{key:"renderWeightField",value:function(){return this.acl[this.state.category].can_pin_threads?(0,s.Z)(g.Z,{label:pgettext("posts moderation split field","Thread weight"),for:"id_weight",labelClass:"col-sm-4",controlClass:"col-sm-8"},void 0,(0,s.Z)(Kn.Z,{id:"id_weight",onChange:this.bindInput("weight"),value:this.state.weight,choices:this.getWeightChoices()})):null}},{key:"renderHiddenField",value:function(){return this.acl[this.state.category].can_hide_threads?(0,s.Z)(g.Z,{label:pgettext("posts moderation split field","Hide thread"),for:"id_is_hidden",labelClass:"col-sm-4",controlClass:"col-sm-8"},void 0,(0,s.Z)(Kn.Z,{id:"id_is_closed",onChange:this.bindInput("is_hidden"),value:this.state.is_hidden,choices:this.isHiddenChoices})):null}},{key:"renderClosedField",value:function(){return this.acl[this.state.category].can_close_threads?(0,s.Z)(g.Z,{label:pgettext("posts moderation split field","Close thread"),for:"id_is_closed",labelClass:"col-sm-4",controlClass:"col-sm-8"},void 0,(0,s.Z)(Kn.Z,{id:"id_is_closed",onChange:this.bindInput("is_closed"),value:this.state.is_closed,choices:this.isClosedChoices})):null}},{key:"render",value:function(){return(0,s.Z)(xs,{className:"modal-dialog"},void 0,(0,s.Z)("form",{onSubmit:this.handleSubmit},void 0,(0,s.Z)("div",{className:"modal-body"},void 0,(0,s.Z)(g.Z,{label:pgettext("posts moderation split field","Thread title"),for:"id_title",labelClass:"col-sm-4",controlClass:"col-sm-8",validation:this.state.errors.title},void 0,(0,s.Z)("input",{id:"id_title",className:"form-control",type:"text",onChange:this.bindInput("title"),value:this.state.title})),ns||(ns=(0,s.Z)("div",{className:"clearfix"})),(0,s.Z)(g.Z,{label:pgettext("posts moderation split field","Category"),for:"id_category",labelClass:"col-sm-4",controlClass:"col-sm-8",validation:this.state.errors.category},void 0,(0,s.Z)(Qn.Z,{id:"id_category",onChange:this.onCategoryChange,value:this.state.category,choices:this.state.categories})),as||(as=(0,s.Z)("div",{className:"clearfix"})),this.renderWeightField(),this.renderHiddenField(),this.renderClosedField()),(0,s.Z)("div",{className:"modal-footer"},void 0,(0,s.Z)("button",{className:"btn btn-default","data-dismiss":"modal",disabled:this.state.isLoading,type:"button"},void 0,pgettext("posts moderation split btn","Cancel")),(0,s.Z)(Ae.Z,{className:"btn-primary",loading:this.state.isLoading},void 0,pgettext("posts moderation split btn","Split posts")))))}}]),n}(Z.Z);function ks(){return is||(is=(0,s.Z)(xs,{className:"modal-dialog"},void 0,(0,s.Z)(J.Z,{})))}function Ns(e){return(0,s.Z)(xs,{className:"modal-dialog modal-message"},void 0,os||(os=(0,s.Z)("div",{className:"message-icon"},void 0,(0,s.Z)("span",{className:"material-icon"},void 0,"info_outline"))),(0,s.Z)("div",{className:"message-body"},void 0,(0,s.Z)("p",{className:"lead"},void 0,pgettext("posts moderation split","You can't move selected posts at the moment.")),(0,s.Z)("p",{},void 0,e.message),(0,s.Z)("button",{className:"btn btn-default","data-dismiss":"modal",type:"button"},void 0,pgettext("posts moderation split dismiss btn","Ok"))))}function xs(e){return(0,s.Z)("div",{className:e.className,role:"document"},void 0,(0,s.Z)("div",{className:"modal-content"},void 0,(0,s.Z)("div",{className:"modal-header"},void 0,(0,s.Z)("button",{"aria-label":pgettext("modal","Close"),className:"close","data-dismiss":"modal",type:"button"},void 0,ss||(ss=(0,s.Z)("span",{"aria-hidden":"true"},void 0,"×"))),(0,s.Z)("h4",{className:"modal-title"},void 0,pgettext("posts moderation split title","Split posts into new thread"))),e.children))}function ws(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=(0,p.Z)(e);if(t){var i=(0,p.Z)(this).constructor;n=Reflect.construct(a,arguments,i)}else n=a.apply(this,arguments);return(0,d.Z)(this,n)}}function Cs(e){return(0,s.Z)("ul",{className:"dropdown-menu dropdown-menu-right stick-to-bottom"},void 0,m().createElement(Es,e),m().createElement(Ss,e),m().createElement(Os,e),m().createElement(Ls,e),m().createElement(Ps,e),m().createElement(Ts,e),m().createElement(Is,e),m().createElement(As,e),m().createElement(Bs,e))}var Rs,Es=function(e){(0,u.Z)(n,e);var t=ws(n);function n(){var e;(0,r.Z)(this,n);for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return e=t.call.apply(t,[this].concat(i)),(0,h.Z)((0,c.Z)(e),"onClick",(function(){Go(e.props)})),e}return(0,l.Z)(n,[{key:"render",value:function(){var e=this.props.selection.find((function(e){return e.acl.can_approve&&e.is_unapproved}));return e?(0,s.Z)("li",{},void 0,(0,s.Z)("button",{type:"button",className:"btn btn-link",onClick:this.onClick},void 0,ds||(ds=(0,s.Z)("span",{className:"material-icon"},void 0,"done")),pgettext("thread posts moderation","Approve"))):null}}]),n}(m().Component),Ss=function(e){(0,u.Z)(n,e);var t=ws(n);function n(){var e;(0,r.Z)(this,n);for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return e=t.call.apply(t,[this].concat(i)),(0,h.Z)((0,c.Z)(e),"onClick",(function(){Jo(e.props)})),e}return(0,l.Z)(n,[{key:"render",value:function(){var e=this.props.selection.length>1&&this.props.selection.find((function(e){return e.acl.can_merge}));return e?(0,s.Z)("li",{},void 0,(0,s.Z)("button",{type:"button",className:"btn btn-link",onClick:this.onClick},void 0,ps||(ps=(0,s.Z)("span",{className:"material-icon"},void 0,"call_merge")),pgettext("thread posts moderation","Merge"))):null}}]),n}(m().Component),Os=function(e){(0,u.Z)(n,e);var t=ws(n);function n(){var e;(0,r.Z)(this,n);for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return e=t.call.apply(t,[this].concat(i)),(0,h.Z)((0,c.Z)(e),"onClick",(function(){k.Z.show(m().createElement(rs,e.props))})),e}return(0,l.Z)(n,[{key:"render",value:function(){var e=this.props.selection.find((function(e){return e.acl.can_move}));return e?(0,s.Z)("li",{},void 0,(0,s.Z)("button",{type:"button",className:"btn btn-link",onClick:this.onClick},void 0,hs||(hs=(0,s.Z)("span",{className:"material-icon"},void 0,"arrow_forward")),pgettext("thread posts moderation","Move"))):null}}]),n}(m().Component),Ls=function(e){(0,u.Z)(n,e);var t=ws(n);function n(){var e;(0,r.Z)(this,n);for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return e=t.call.apply(t,[this].concat(i)),(0,h.Z)((0,c.Z)(e),"onClick",(function(){k.Z.show(m().createElement(us,e.props))})),e}return(0,l.Z)(n,[{key:"render",value:function(){var e=this.props.selection.find((function(e){return e.acl.can_move}));return e?(0,s.Z)("li",{},void 0,(0,s.Z)("button",{type:"button",className:"btn btn-link",onClick:this.onClick},void 0,vs||(vs=(0,s.Z)("span",{className:"material-icon"},void 0,"call_split")),pgettext("thread posts moderation","Split"))):null}}]),n}(m().Component),Ps=function(e){(0,u.Z)(n,e);var t=ws(n);function n(){var e;(0,r.Z)(this,n);for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return e=t.call.apply(t,[this].concat(i)),(0,h.Z)((0,c.Z)(e),"onClick",(function(){$o(e.props)})),e}return(0,l.Z)(n,[{key:"render",value:function(){var e=this.props.selection.find((function(e){return!e.is_protected&&e.acl.can_protect}));return e?(0,s.Z)("li",{},void 0,(0,s.Z)("button",{type:"button",className:"btn btn-link",onClick:this.onClick},void 0,ms||(ms=(0,s.Z)("span",{className:"material-icon"},void 0,"lock_outline")),pgettext("thread posts moderation","Protect"))):null}}]),n}(m().Component),Ts=function(e){(0,u.Z)(n,e);var t=ws(n);function n(){var e;(0,r.Z)(this,n);for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return e=t.call.apply(t,[this].concat(i)),(0,h.Z)((0,c.Z)(e),"onClick",(function(){Wo(e.props)})),e}return(0,l.Z)(n,[{key:"render",value:function(){var e=this.props.selection.find((function(e){return e.is_protected&&e.acl.can_protect}));return e?(0,s.Z)("li",{},void 0,(0,s.Z)("button",{type:"button",className:"btn btn-link",onClick:this.onClick},void 0,fs||(fs=(0,s.Z)("span",{className:"material-icon"},void 0,"lock_open")),pgettext("thread posts moderation","Unprotect"))):null}}]),n}(m().Component),As=function(e){(0,u.Z)(n,e);var t=ws(n);function n(){var e;(0,r.Z)(this,n);for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return e=t.call.apply(t,[this].concat(i)),(0,h.Z)((0,c.Z)(e),"onClick",(function(){Qo(e.props)})),e}return(0,l.Z)(n,[{key:"render",value:function(){var e=this.props.selection.find((function(e){return e.acl.can_hide&&!e.is_hidden}));return e?(0,s.Z)("li",{},void 0,(0,s.Z)("button",{type:"button",className:"btn btn-link",onClick:this.onClick},void 0,Zs||(Zs=(0,s.Z)("span",{className:"material-icon"},void 0,"visibility_off")),pgettext("thread posts moderation","Hide"))):null}}]),n}(m().Component),Is=function(e){(0,u.Z)(n,e);var t=ws(n);function n(){var e;(0,r.Z)(this,n);for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return e=t.call.apply(t,[this].concat(i)),(0,h.Z)((0,c.Z)(e),"onClick",(function(){Ko(e.props)})),e}return(0,l.Z)(n,[{key:"render",value:function(){var e=this.props.selection.find((function(e){return e.acl.can_unhide&&e.is_hidden}));return e?(0,s.Z)("li",{},void 0,(0,s.Z)("button",{type:"button",className:"btn btn-link",onClick:this.onClick},void 0,gs||(gs=(0,s.Z)("span",{className:"material-icon"},void 0,"visibility")),pgettext("thread posts moderation","Unhide"))):null}}]),n}(m().Component),Bs=function(e){(0,u.Z)(n,e);var t=ws(n);function n(){var e;(0,r.Z)(this,n);for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return e=t.call.apply(t,[this].concat(i)),(0,h.Z)((0,c.Z)(e),"onClick",(function(){es(e.props)})),e}return(0,l.Z)(n,[{key:"render",value:function(){var e=this.props.selection.find((function(e){return e.acl.can_delete}));return e?(0,s.Z)("li",{},void 0,(0,s.Z)("button",{type:"button",className:"btn btn-link",onClick:this.onClick},void 0,bs||(bs=(0,s.Z)("span",{className:"material-icon"},void 0,"clear")),pgettext("thread posts moderation","Delete"))):null}}]),n}(m().Component);const js=function(e){var t=e.thread,n=e.user,a=e.selection,i=e.dropup;return(0,s.Z)("div",{className:i?"dropup":"dropdown"},void 0,(0,s.Z)("button",{type:"button",className:"btn btn-default btn-outline btn-icon dropdown-toggle",title:pgettext("post options btn","Posts options"),"data-toggle":"dropdown","aria-haspopup":"true","aria-expanded":"false",disabled:0===a.length},void 0,Rs||(Rs=(0,s.Z)("span",{className:"material-icon"},void 0,"settings"))),(0,s.Z)(Cs,{thread:t,user:n,selection:a}))};var Ds;const zs=function(e){var t=e.onClick;return(0,s.Z)("button",{className:"btn btn-primary btn-outline btn-block",type:"button",onClick:t},void 0,Ds||(Ds=(0,s.Z)("span",{className:"material-icon"},void 0,"chat")),pgettext("thread reply btn","Reply"))};var Us;const qs=function(e){var t=e.thread,n=e.posts,a=e.user,i=e.selection,o=e.moderation,r=e.onReply;return(0,s.Z)(jo.o8,{},void 0,n.pages>1&&(0,s.Z)(jo.Z2,{},void 0,(0,s.Z)(jo.Eg,{},void 0,(0,s.Z)(qo,{baseUrl:t.url.index,posts:n,scrollToTop:!0}))),Us||(Us=(0,s.Z)(jo.tw,{})),a.is_authenticated&&(0,s.Z)(jo.Z2,{},void 0,(0,s.Z)(jo.Eg,{className:"hidden-xs"},void 0,(0,s.Z)(_o,{thread:t,dropup:!0})),t.acl.can_reply&&(0,s.Z)(jo.Eg,{},void 0,(0,s.Z)(zs,{onClick:r})),o.enabled&&(0,s.Z)(jo.Eg,{shrink:!0},void 0,(0,s.Z)(js,{thread:t,user:a,selection:i,dropup:!0}))),a.is_authenticated&&(0,s.Z)(jo.Z2,{className:"hidden-sm hidden-md hidden-lg"},void 0,(0,s.Z)(jo.Eg,{},void 0,(0,s.Z)(_o,{thread:t,dropup:!0}))))};var Ms,Fs;const Hs=function(){return(0,s.Z)(jo.o8,{className:"thread-toolbar-third"},void 0,Ms||(Ms=(0,s.Z)(jo.tw,{})),(0,s.Z)(jo.Z2,{},void 0,(0,s.Z)(jo.Eg,{},void 0,(0,s.Z)("button",{className:"btn btn-muted btn-block",type:"button",onClick:function(){return window.scrollTo(0,0)}},void 0,Fs||(Fs=(0,s.Z)("span",{className:"material-icon"},void 0,"arrow_upward")),pgettext("go up","Go to top")))))};var Vs;const Ys=function(e){var t=e.compact,n=e.disabled,a=e.onClick;return(0,s.Z)("button",{className:go()("btn btn-default btn-outline",{"btn-block":!t,"btn-icon":t}),type:"button",title:t?pgettext("thread poll btn","Add poll"):null,disabled:n,onClick:a},void 0,Vs||(Vs=(0,s.Z)("span",{className:"material-icon"},void 0,"poll")),!t&&pgettext("thread poll btn","Add poll"))};var Gs,$s,Ws,Qs,Ks,Xs;const Js=function(e){var t=e.user,n=e.thread,a=e.posts;return(0,s.Z)("div",{className:"dropdown"},void 0,(0,s.Z)("button",{className:"btn btn-default btn-outline btn-icon",title:pgettext("thread shortcuts btn","Shortcuts"),"aria-expanded":"true","aria-haspopup":"true","data-toggle":"dropdown",type:"button"},void 0,Gs||(Gs=(0,s.Z)("span",{className:"material-icon"},void 0,"bookmark"))),(0,s.Z)("ul",{className:"dropdown-menu"},void 0,!!a.first&&(0,s.Z)("li",{},void 0,(0,s.Z)(Do.rU,{className:"btn btn-link",href:n.url.index},void 0,$s||($s=(0,s.Z)("span",{className:"material-icon"},void 0,"place")),pgettext("thread shortcut btn","Go to first post"))),t.is_authenticated&&n.is_new&&(0,s.Z)("li",{},void 0,(0,s.Z)("a",{className:"btn btn-link",href:n.url.new_post},void 0,Ws||(Ws=(0,s.Z)("span",{className:"material-icon"},void 0,"comment")),pgettext("thread shortcut btn","Go to new post"))),n.best_answer&&(0,s.Z)("li",{},void 0,(0,s.Z)("a",{className:"btn btn-link",href:n.url.best_answer},void 0,Qs||(Qs=(0,s.Z)("span",{className:"material-icon"},void 0,"check_circle")),pgettext("thread shortcut btn","Go to best answer"))),n.has_unapproved_posts&&n.acl.can_approve&&(0,s.Z)("li",{},void 0,(0,s.Z)("a",{className:"btn btn-link",href:n.url.unapproved_post},void 0,Ks||(Ks=(0,s.Z)("span",{className:"material-icon"},void 0,"visibility")),pgettext("thread shortcut btn","Go to unapproved post"))),(0,s.Z)("li",{},void 0,(0,s.Z)("a",{className:"btn btn-link",href:n.url.last_post},void 0,Xs||(Xs=(0,s.Z)("span",{className:"material-icon"},void 0,"reply")),pgettext("thread shortcut btn","Go to last post")))))};var er;const tr=function(e){var t=e.thread,n=e.posts,a=e.user,i=e.pollDisabled,o=e.selection,r=e.moderation,l=e.onPoll,c=e.onReply;return(0,s.Z)(jo.o8,{},void 0,(0,s.Z)(jo.Z2,{className:"hidden-xs"},void 0,(0,s.Z)(jo.Eg,{},void 0,(0,s.Z)(Js,{posts:n,thread:t,user:a})),n.pages>1&&(0,s.Z)(jo.Eg,{},void 0,(0,s.Z)(qo,{baseUrl:t.url.index,posts:n}))),er||(er=(0,s.Z)(jo.tw,{})),t.acl.can_start_poll&&!t.poll&&(0,s.Z)(jo.Z2,{className:"hidden-xs"},void 0,(0,s.Z)(jo.Eg,{},void 0,(0,s.Z)(Ys,{disabled:i,onClick:l}))),t.acl.can_reply?(0,s.Z)(jo.Z2,{},void 0,(0,s.Z)(jo.Eg,{className:"hidden-sm hidden-md hidden-lg",shrink:!0},void 0,(0,s.Z)(Js,{posts:n,thread:t,user:a})),(0,s.Z)(jo.Eg,{},void 0,(0,s.Z)(zs,{onClick:c})),t.acl.can_start_poll&&!t.poll&&(0,s.Z)(jo.Eg,{className:"hidden-sm hidden-md hidden-lg",shrink:!0},void 0,(0,s.Z)(Ys,{disabled:i,onClick:l,compact:!0})),r.enabled&&(0,s.Z)(jo.Eg,{className:"hidden-xs",shrink:!0},void 0,(0,s.Z)(js,{thread:t,user:a,selection:o}))):(0,s.Z)(jo.Z2,{},void 0,(0,s.Z)(jo.Eg,{className:"hidden-sm hidden-md hidden-lg",shrink:!0},void 0,(0,s.Z)(Js,{posts:n,thread:t,user:a})),t.acl.can_start_poll&&!t.poll&&(0,s.Z)(jo.Eg,{},void 0,(0,s.Z)(Ys,{disabled:i,onClick:l})),r.enabled&&(0,s.Z)(jo.Eg,{shrink:!0},void 0,(0,s.Z)(js,{thread:t,user:a,selection:o}))),n.pages>1&&(0,s.Z)(jo.Z2,{className:"hidden-sm hidden-md hidden-lg"},void 0,(0,s.Z)(jo.Eg,{},void 0,(0,s.Z)(qo,{baseUrl:t.url.index,posts:n}))))};var nr;var ar=function(e){(0,u.Z)(i,e);var t,n,a=(t=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,a=(0,p.Z)(t);if(n){var i=(0,p.Z)(this).constructor;e=Reflect.construct(a,arguments,i)}else e=a.apply(this,arguments);return(0,d.Z)(this,e)});function i(e){var t;return(0,r.Z)(this,i),t=a.call(this,e),(0,h.Z)((0,c.Z)(t),"update",(function(e){x.Z.dispatch(y.gx(e)),x.Z.dispatch(Ba.zD(e.post_set)),e.participants&&x.Z.dispatch(b.gx(e.participants)),e.poll&&x.Z.dispatch(le.gx(e.poll)),t.setPageTitle()})),(0,h.Z)((0,c.Z)(t),"openPollForm",(function(){t.setState({editPoll:!0})})),(0,h.Z)((0,c.Z)(t),"closePollForm",(function(){t.setState({editPoll:!1})})),(0,h.Z)((0,c.Z)(t),"openReplyForm",(function(){ce.Z.open({mode:"REPLY",thread:t.props.thread,config:t.props.thread.api.editor,submit:t.props.thread.api.posts.index})})),t.state={editPoll:!1},t}return(0,l.Z)(i,[{key:"componentDidMount",value:function(){this.shouldFetchData()&&(this.fetchData(),this.setPageTitle()),this.startPollingApi()}},{key:"componentDidUpdate",value:function(){this.shouldFetchData()&&(this.fetchData(),this.startPollingApi(),this.setPageTitle())}},{key:"componentWillUnmount",value:function(){this.stopPollingApi()}},{key:"shouldFetchData",value:function(){return!!this.props.posts.isLoaded&&1*(this.props.params.page||1)!=this.props.posts.page}},{key:"fetchData",value:function(){var e=this;x.Z.dispatch(Ba.Rz()),_.Z.get(this.props.thread.api.posts.index,{page:this.props.params.page||1},"posts").then((function(t){e.update(t)}),(function(e){N.Z.apiError(e)}))}},{key:"startPollingApi",value:function(){Zi.Z.start({poll:"thread-posts",url:this.props.thread.api.posts.index,data:{page:this.props.params.page||1},update:this.update,frequency:12e4,delayed:!0})}},{key:"stopPollingApi",value:function(){Zi.Z.stop("thread-posts")}},{key:"setPageTitle",value:function(){gi.Z.set({title:this.props.thread.title,parent:this.props.thread.category.name,page:1*(this.props.params.page||1)})}},{key:"render",value:function(){var e=this.props.thread.category,t="page page-thread";e.css_class&&(t+=" page-thread-"+e.css_class);var n="private_threads"===e.special_role?"private-threads":e.css_class||"category-threads",a=ir(this.props.thread,this.props.user),i=or(this.props.posts.results,this.props.user),o=this.props.posts.results.filter((function(e){return e.isSelected}));return(0,s.Z)("div",{className:t},void 0,(0,s.Z)(Eo,{styleName:n,thread:this.props.thread,posts:this.props.posts,user:this.props.user,moderation:a}),(0,s.Z)(yi.Z,{},void 0,(0,s.Z)(z,{participants:this.props.participants,thread:this.props.thread,user:this.props.user}),(0,s.Z)(tr,{thread:this.props.thread,posts:this.props.posts,user:this.props.user,selection:o,moderation:i,pollDisabled:this.state.editPoll,onPoll:this.openPollForm,onReply:this.openReplyForm}),this.state.editPoll?(0,s.Z)(Fe,{poll:this.props.poll,thread:this.props.thread,close:this.closePollForm}):(0,s.Z)(je,{poll:this.props.poll,thread:this.props.thread,user:this.props.user,edit:this.openPollForm}),this.props.thread.acl.can_reply?(0,s.Z)(bi.mv,{posting:{mode:"REPLY",thread:this.props.thread,config:this.props.thread.api.editor,submit:this.props.thread.api.posts.index}},void 0,m().createElement(li,this.props)):m().createElement(li,this.props),(0,s.Z)(qs,{thread:this.props.thread,posts:this.props.posts,user:this.props.user,selection:o,moderation:i,onReply:this.openReplyForm}),nr||(nr=(0,s.Z)(Hs,{}))))}}]),i}(m().Component),ir=function(e,t){var n={enabled:!1,edit:!1,approve:!1,close:!1,open:!1,hide:!1,unhide:!1,move:!1,merge:!1,pinGlobally:!1,pinLocally:!1,unpin:!1,delete:!1};return t.is_authenticated?(n.edit=e.acl.can_edit,n.approve=e.acl.can_approve&&e.is_unapproved,n.close=e.acl.can_close&&!e.is_closed,n.open=e.acl.can_close&&e.is_closed,n.hide=e.acl.can_hide&&!e.is_hidden,n.unhide=e.acl.can_unhide&&e.is_hidden,n.move=e.acl.can_move,n.merge=e.acl.can_merge,n.pinGlobally=e.acl.can_pin_globally&&e.weight<2,n.pinLocally=e.acl.can_pin&&1!==e.weight,n.unpin=e.acl.can_pin&&1===e.weight||e.acl.can_pin_globally&&2===e.weight,n.delete=e.acl.can_delete,n.enabled=n.edit||n.approve||n.close||n.open||n.hide||n.unhide||n.move||n.merge||n.pinGlobally||n.pinLocally||n.unpin||n.delete,n):n},or=function(e,t){var n={enabled:!1,approve:!1,move:!1,merge:!1,protect:!1,hide:!1,delete:!1};return t.is_authenticated?(e.forEach((function(e){e.is_event||(e.acl.can_approve&&e.is_unapproved&&(n.approve=!0),e.acl.can_move&&(n.move=!0),e.acl.can_merge&&(n.merge=!0),(e.acl.can_protect||e.acl.can_unprotect)&&(n.protect=!0),(e.acl.can_hide||e.acl.can_unhide)&&(n.hide=!0),e.acl.can_delete&&(n.delete=!0),(n.approve||n.move||n.merge||n.protect||n.hide||n.delete)&&(n.enabled=!0))})),n):n};function sr(e){return{participants:e.participants,poll:e.poll,posts:e.posts,thread:e.thread,tick:e.tick.tick,user:e.auth.user}}var rr=n(39633);S.Z.addInitializer({name:"component:thread",initializer:function(e){var t,n;e.has("THREAD")&&e.has("POSTS")&&(0,rr.Z)({paths:(t=S.Z.get("THREAD"),n=t.url.index.replace(t.slug+"-"+t.pk,":slug"),[{path:n,component:(0,o.$j)(sr)(ar)},{path:n+":page/",component:(0,o.$j)(sr)(ar)}])})},after:"store"})},63290:(e,t,n)=>{"use strict";var a,i=n(22928),o=(n(57588),n(73935)),s=n.n(o),r=n(37424),l=n(28166),c=n(90287);misago.addInitializer({name:"component:user-nav-overlay",initializer:function(e){var t=document.getElementById("user-nav-mount");s().render((0,i.Z)(r.zt,{store:c.Z.getStore()},void 0,a||(a=(0,i.Z)(l.Qm,{}))),t)},after:"store"})},77031:(e,t,n)=>{"use strict";var a,i=n(22928),o=n(15671),s=n(43144),r=n(79340),l=n(6215),c=n(61120),u=n(57588),d=n.n(u),p=n(37424),h=n(97326),v=n(4942),m=n(59131),f=n(69987),Z=n(94417),g=function(e,t){var n=e;return"rank"===t.component?n+=t.slug:n+=t.component,n+"/"};const b=function(e){var t=e.baseUrl,n=e.page,o=e.pages;return(0,i.Z)("div",{className:"nav-container"},void 0,(0,i.Z)("div",{className:"dropdown hidden-sm hidden-md hidden-lg"},void 0,(0,i.Z)("button",{className:"btn btn-default btn-block btn-outline dropdown-toggle",type:"button","data-toggle":"dropdown","aria-haspopup":"true","aria-expanded":"false"},void 0,a||(a=(0,i.Z)("span",{className:"material-icon"},void 0,"menu")),n.name),(0,i.Z)("ul",{className:"dropdown-menu stick-to-bottom"},void 0,o.map((function(e){var n=g(t,e);return(0,i.Z)("li",{},n,(0,i.Z)(f.rU,{to:n},void 0,e.name))})))),(0,i.Z)("ul",{className:"nav nav-pills hidden-xs",role:"menu"},void 0,o.map((function(e){var n=g(t,e);return(0,i.Z)(Z.Z,{path:n},n,(0,i.Z)(f.rU,{to:n},void 0,e.name))}))))};var y,_,k=function(e){(0,r.Z)(u,e);var t,n,a=(t=u,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,a=(0,c.Z)(t);if(n){var i=(0,c.Z)(this).constructor;e=Reflect.construct(a,arguments,i)}else e=a.apply(this,arguments);return(0,l.Z)(this,e)});function u(){return(0,o.Z)(this,u),a.apply(this,arguments)}return(0,s.Z)(u,[{key:"getEmptyMessage",value:function(){return interpolate(npgettext("top posters empty","No users have posted any new messages during last %(days)s day.","No users have posted any new messages during last %(days)s days.",this.props.trackedPeriod),{days:this.props.trackedPeriod},!0)}},{key:"render",value:function(){return(0,i.Z)("div",{className:"active-posters-list"},void 0,(0,i.Z)(m.Z,{},void 0,(0,i.Z)(b,{baseUrl:misago.get("USERS_LIST_URL"),page:this.props.page,pages:misago.get("USERS_LISTS")}),(0,i.Z)("p",{className:"lead"},void 0,this.getEmptyMessage())))}}]),u}(d().Component),N=n(19605),x=n(44039);var w=function(e){(0,r.Z)(u,e);var t,n,a=(t=u,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,a=(0,c.Z)(t);if(n){var i=(0,c.Z)(this).constructor;e=Reflect.construct(a,arguments,i)}else e=a.apply(this,arguments);return(0,l.Z)(this,e)});function u(){return(0,o.Z)(this,u),a.apply(this,arguments)}return(0,s.Z)(u,[{key:"shouldComponentUpdate",value:function(){return!1}},{key:"getClassName",value:function(){return this.props.hiddenOnMobile?"list-group-item hidden-xs hidden-sm":"list-group-item"}},{key:"render",value:function(){return(0,i.Z)("li",{className:this.getClassName()},void 0,y||(y=(0,i.Z)("div",{className:"rank-user-avatar"},void 0,(0,i.Z)("span",{},void 0,(0,i.Z)(N.ZP,{size:"50"})))),(0,i.Z)("div",{className:"rank-user"},void 0,(0,i.Z)("div",{className:"user-name"},void 0,(0,i.Z)("span",{className:"item-title"},void 0,(0,i.Z)("span",{className:"ui-preview-text",style:{width:x.e(30,80)+"px"}},void 0," "))),(0,i.Z)("div",{className:"user-details"},void 0,(0,i.Z)("span",{className:"user-status"},void 0,_||(_=(0,i.Z)("span",{className:"status-icon ui-preview-text"},void 0," ")),(0,i.Z)("span",{className:"status-label ui-preview-text hidden-xs hidden-sm",style:{width:x.e(30,50)+"px"}},void 0," ")),(0,i.Z)("span",{className:"rank-name"},void 0,(0,i.Z)("span",{className:"ui-preview-text",style:{width:x.e(30,50)+"px"}},void 0," ")),(0,i.Z)("span",{className:"user-title hidden-xs hidden-sm"},void 0,(0,i.Z)("span",{className:"ui-preview-text",style:{width:x.e(30,50)+"px"}},void 0," "))),(0,i.Z)("div",{className:"user-compact-stats visible-xs-block"},void 0,(0,i.Z)("span",{className:"rank-position"},void 0,(0,i.Z)("strong",{},void 0,(0,i.Z)("span",{className:"ui-preview-text",style:{width:x.e(20,30)+"px"}},void 0," ")),(0,i.Z)("small",{},void 0,pgettext("top posters list item","Rank"))),(0,i.Z)("span",{className:"rank-posts-counted"},void 0,(0,i.Z)("strong",{},void 0,(0,i.Z)("span",{className:"ui-preview-text",style:{width:x.e(20,30)+"px"}},void 0," ")),(0,i.Z)("small",{},void 0,pgettext("top posters list item","Ranked posts"))))),(0,i.Z)("div",{className:"rank-position hidden-xs"},void 0,(0,i.Z)("strong",{},void 0,(0,i.Z)("span",{className:"ui-preview-text",style:{width:x.e(20,30)+"px"}},void 0," ")),(0,i.Z)("small",{},void 0,pgettext("top posters list item","Rank"))),(0,i.Z)("div",{className:"rank-posts-counted hidden-xs"},void 0,(0,i.Z)("strong",{},void 0,(0,i.Z)("span",{className:"ui-preview-text",style:{width:x.e(20,30)+"px"}},void 0," ")),(0,i.Z)("small",{},void 0,pgettext("top posters list item","Ranked posts"))),(0,i.Z)("div",{className:"rank-posts-total hidden-xs"},void 0,(0,i.Z)("strong",{},void 0,(0,i.Z)("span",{className:"ui-preview-text",style:{width:x.e(20,30)+"px"}},void 0," ")),(0,i.Z)("small",{},void 0,pgettext("top posters list item","Total posts"))))}}]),u}(d().Component);var C,R=function(e){(0,r.Z)(u,e);var t,n,a=(t=u,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,a=(0,c.Z)(t);if(n){var i=(0,c.Z)(this).constructor;e=Reflect.construct(a,arguments,i)}else e=a.apply(this,arguments);return(0,l.Z)(this,e)});function u(){return(0,o.Z)(this,u),a.apply(this,arguments)}return(0,s.Z)(u,[{key:"shouldComponentUpdate",value:function(){return!1}},{key:"render",value:function(){return(0,i.Z)("div",{className:"active-posters-list"},void 0,(0,i.Z)(m.Z,{},void 0,(0,i.Z)(b,{baseUrl:misago.get("USERS_LIST_URL"),page:this.props.page,pages:misago.get("USERS_LISTS")}),(0,i.Z)("p",{className:"lead ui-preview"},void 0,(0,i.Z)("span",{className:"ui-preview-text",style:{width:x.e(50,220)+"px"}},void 0," ")),(0,i.Z)("div",{className:"active-posters ui-preview"},void 0,(0,i.Z)("ul",{className:"list-group"},void 0,[0,1,2].map((function(e){return(0,i.Z)(w,{hiddenOnMobile:e>0},e)}))))))}}]),u}(d().Component),E=n(24678),S=n(15579);var O=function(e){(0,r.Z)(u,e);var t,n,a=(t=u,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,a=(0,c.Z)(t);if(n){var i=(0,c.Z)(this).constructor;e=Reflect.construct(a,arguments,i)}else e=a.apply(this,arguments);return(0,l.Z)(this,e)});function u(){return(0,o.Z)(this,u),a.apply(this,arguments)}return(0,s.Z)(u,[{key:"getClassName",value:function(){return this.props.rank.css_class?"list-group-item list-group-rank-"+this.props.rank.css_class:"list-group-item"}},{key:"getUserStatus",value:function(){return this.props.user.status?(0,i.Z)(E.ZP,{user:this.props.user,status:this.props.user.status},void 0,(0,i.Z)(E.Jj,{user:this.props.user,status:this.props.user.status}),(0,i.Z)(E.pg,{user:this.props.user,status:this.props.user.status,className:"status-label hidden-xs hidden-sm"})):(0,i.Z)("span",{className:"user-status"},void 0,C||(C=(0,i.Z)("span",{className:"status-icon ui-preview-text"},void 0," ")),(0,i.Z)("span",{className:"status-label ui-preview-text hidden-xs hidden-sm",style:{width:x.e(30,50)+"px"}},void 0," "))}},{key:"getRankName",value:function(){if(!this.props.rank.is_tab)return(0,i.Z)("span",{className:"rank-name item-title"},void 0,this.props.rank.name);var e=S.Z.get("USERS_LIST_URL")+this.props.rank.slug+"/";return(0,i.Z)(f.rU,{to:e,className:"rank-name item-title"},void 0,this.props.rank.name)}},{key:"getUserTitle",value:function(){return this.props.user.title?(0,i.Z)("span",{className:"user-title hidden-xs hidden-sm"},void 0,this.props.user.title):null}},{key:"render",value:function(){return(0,i.Z)("li",{className:this.getClassName()},void 0,(0,i.Z)("div",{className:"rank-user-avatar"},void 0,(0,i.Z)("a",{href:this.props.user.url},void 0,(0,i.Z)(N.ZP,{user:this.props.user,size:50,size2x:64}))),(0,i.Z)("div",{className:"rank-user"},void 0,(0,i.Z)("div",{className:"user-name"},void 0,(0,i.Z)("a",{href:this.props.user.url,className:"item-title"},void 0,this.props.user.username)),(0,i.Z)("div",{className:"user-details"},void 0,this.getUserStatus(),this.getRankName(),this.getUserTitle()),(0,i.Z)("div",{className:"user-compact-stats visible-xs-block"},void 0,(0,i.Z)("span",{className:"rank-position"},void 0,(0,i.Z)("strong",{},void 0,"#",this.props.counter),(0,i.Z)("small",{},void 0,pgettext("top posters list item","Rank"))),(0,i.Z)("span",{className:"rank-posts-counted"},void 0,(0,i.Z)("strong",{},void 0,this.props.user.meta.score),(0,i.Z)("small",{},void 0,pgettext("top posters list item","Ranked posts"))))),(0,i.Z)("div",{className:"rank-position hidden-xs"},void 0,(0,i.Z)("strong",{},void 0,"#",this.props.counter),(0,i.Z)("small",{},void 0,pgettext("top posters list item","Rank"))),(0,i.Z)("div",{className:"rank-posts-counted hidden-xs"},void 0,(0,i.Z)("strong",{},void 0,this.props.user.meta.score),(0,i.Z)("small",{},void 0,pgettext("top posters list item","Ranked posts"))),(0,i.Z)("div",{className:"rank-posts-total hidden-xs"},void 0,(0,i.Z)("strong",{},void 0,this.props.user.posts),(0,i.Z)("small",{},void 0,pgettext("top posters list item","Total posts"))))}}]),u}(d().Component);var L=function(e){(0,r.Z)(u,e);var t,n,a=(t=u,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,a=(0,c.Z)(t);if(n){var i=(0,c.Z)(this).constructor;e=Reflect.construct(a,arguments,i)}else e=a.apply(this,arguments);return(0,l.Z)(this,e)});function u(){return(0,o.Z)(this,u),a.apply(this,arguments)}return(0,s.Z)(u,[{key:"getLeadMessage",value:function(){var e=npgettext("top posters list","%(posters)s top poster from last %(days)s days.","%(posters)s top posters from last %(days)s days.",this.props.count);return interpolate(e,{posters:this.props.count,days:this.props.trackedPeriod},!0)}},{key:"render",value:function(){return(0,i.Z)("div",{className:"active-posters-list"},void 0,(0,i.Z)(m.Z,{},void 0,(0,i.Z)(b,{baseUrl:misago.get("USERS_LIST_URL"),page:this.props.page,pages:misago.get("USERS_LISTS")}),(0,i.Z)("p",{className:"lead"},void 0,this.getLeadMessage()),(0,i.Z)("div",{className:"active-posters ui-ready"},void 0,(0,i.Z)("ul",{className:"list-group"},void 0,this.props.users.map((function(e,t){return(0,i.Z)(O,{user:e,rank:e.rank,counter:t+1},e.id)}))))))}}]),u}(d().Component),P=n(6935),T=n(55547),A=n(90287),I=n(53328);var B=function(e){(0,r.Z)(u,e);var t,n,a=(t=u,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,a=(0,c.Z)(t);if(n){var i=(0,c.Z)(this).constructor;e=Reflect.construct(a,arguments,i)}else e=a.apply(this,arguments);return(0,l.Z)(this,e)});function u(e){var t;return(0,o.Z)(this,u),t=a.call(this,e),(0,v.Z)((0,h.Z)(t),"update",(function(e){A.Z.dispatch((0,P.ZB)(e.results)),t.setState({isLoaded:!0,trackedPeriod:e.tracked_period,count:e.count})})),S.Z.has("USERS")?t.initWithPreloadedData(S.Z.pop("USERS")):t.initWithoutPreloadedData(),t.startPolling(),t}return(0,s.Z)(u,[{key:"initWithPreloadedData",value:function(e){this.state={isLoaded:!0,trackedPeriod:e.tracked_period,count:e.count},A.Z.dispatch((0,P.ZB)(e.results))}},{key:"initWithoutPreloadedData",value:function(){this.state={isLoaded:!1}}},{key:"startPolling",value:function(){T.Z.start({poll:"active-posters",url:S.Z.get("USERS_API"),data:{list:"active"},frequency:9e4,update:this.update})}},{key:"componentDidMount",value:function(){I.Z.set({title:this.props.route.extra.name,parent:pgettext("users page title","Users")})}},{key:"componentWillUnmount",value:function(){T.Z.stop("active-posters")}},{key:"render",value:function(){var e={name:this.props.route.extra.name};return this.state.isLoaded?this.state.count>0?(0,i.Z)(L,{page:e,users:this.props.users,trackedPeriod:this.state.trackedPeriod,count:this.state.count}):(0,i.Z)(k,{page:e,trackedPeriod:this.state.trackedPeriod}):(0,i.Z)(R,{page:e})}}]),u}(d().Component);var j=function(e){(0,r.Z)(u,e);var t,n,a=(t=u,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,a=(0,c.Z)(t);if(n){var i=(0,c.Z)(this).constructor;e=Reflect.construct(a,arguments,i)}else e=a.apply(this,arguments);return(0,l.Z)(this,e)});function u(){return(0,o.Z)(this,u),a.apply(this,arguments)}return(0,s.Z)(u,[{key:"getClassName",value:function(){return this.props.copy&&this.props.copy.length&&1===function(e,t){if(e=(e+"").toLowerCase(),(t=(t+"").toLowerCase()).length<=0)return 0;for(var n=0,a=0,i=t.length;(a=e.indexOf(t,a))>=0;)n+=1,a+=i;return n}(this.props.copy,"<p")&&-1===this.props.copy.indexOf("<br")?"page-lead lead":"page-lead"}},{key:"render",value:function(){return this.props.copy&&this.props.copy.length?(0,i.Z)("div",{className:this.getClassName(),dangerouslySetInnerHTML:{__html:this.props.copy}}):null}}]),u}(d().Component),D=n(40429);const z=function(e){var t=e.users;return(0,i.Z)(D.Z,{cols:4,isReady:!0,showStatus:!0,users:t})};var U;const q=function(e){(0,r.Z)(u,e);var t,n,a=(t=u,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,a=(0,c.Z)(t);if(n){var i=(0,c.Z)(this).constructor;e=Reflect.construct(a,arguments,i)}else e=a.apply(this,arguments);return(0,l.Z)(this,e)});function u(){var e;(0,o.Z)(this,u);for(var t=arguments.length,n=new Array(t),s=0;s<t;s++)n[s]=arguments[s];return e=a.call.apply(a,[this].concat(n)),(0,v.Z)((0,h.Z)(e),"render",(function(){return U||(U=(0,i.Z)(D.Z,{cols:4,isReady:!1}))})),e}return(0,s.Z)(u,[{key:"shouldComponentUpdate",value:function(){return!1}}]),u}(d().Component);var M=n(92490);const F=function(e){var t=e.users;return t.more?(0,i.Z)("p",{},void 0,interpolate(npgettext("rank users list","There is %(more)s more user with this rank.","There are %(more)s more users with this rank.",t.more),{more:t.more},!0)):(0,i.Z)("p",{},void 0,pgettext("rank users list empty","There are no more users with this rank."))};var H,V,Y,G,$,W,Q,K;const X=function(e){var t=e.baseUrl,n=e.users;return(0,i.Z)("div",{className:"misago-pagination"},void 0,n.isLoaded&&n.first?(0,i.Z)(f.rU,{className:"btn btn-default btn-outline btn-icon",to:t,title:pgettext("rank users list paginator","Go to first page")},void 0,H||(H=(0,i.Z)("span",{className:"material-icon"},void 0,"first_page"))):(0,i.Z)("button",{className:"btn btn-default btn-outline btn-icon",title:pgettext("rank users list paginator","Go to first page"),type:"button",disabled:!0},void 0,V||(V=(0,i.Z)("span",{className:"material-icon"},void 0,"first_page"))),n.isLoaded&&n.previous?(0,i.Z)(f.rU,{className:"btn btn-default btn-outline btn-icon",to:t+(n.previous>1?n.previous+"/":""),title:pgettext("rank users list paginator","Go to previous page")},void 0,Y||(Y=(0,i.Z)("span",{className:"material-icon"},void 0,"chevron_left"))):(0,i.Z)("button",{className:"btn btn-default btn-outline btn-icon",title:pgettext("rank users list paginator","Go to previous page"),type:"button",disabled:!0},void 0,G||(G=(0,i.Z)("span",{className:"material-icon"},void 0,"chevron_left"))),n.isLoaded&&n.next?(0,i.Z)(f.rU,{className:"btn btn-default btn-outline btn-icon",to:t+n.next+"/",title:pgettext("rank users list paginator","Go to next page")},void 0,$||($=(0,i.Z)("span",{className:"material-icon"},void 0,"chevron_right"))):(0,i.Z)("button",{className:"btn btn-default btn-outline btn-icon",title:pgettext("rank users list paginator","Go to next page"),type:"button",disabled:!0},void 0,W||(W=(0,i.Z)("span",{className:"material-icon"},void 0,"chevron_right"))),n.isLoaded&&n.last?(0,i.Z)(f.rU,{className:"btn btn-default btn-outline btn-icon",to:t+n.last+"/",title:pgettext("rank users list paginator","Go to last page")},void 0,Q||(Q=(0,i.Z)("span",{className:"material-icon"},void 0,"last_page"))):(0,i.Z)("button",{className:"btn btn-default btn-outline btn-icon",title:pgettext("rank users list paginator","Go to last page"),type:"button",disabled:!0},void 0,K||(K=(0,i.Z)("span",{className:"material-icon"},void 0,"last_page"))))},J=function(e){var t=e.baseUrl,n=e.users;return(0,i.Z)(M.o8,{},void 0,(0,i.Z)(M.Z2,{},void 0,(0,i.Z)(M.Eg,{},void 0,(0,i.Z)(X,{baseUrl:t,users:n}))),(0,i.Z)(M.Z2,{auto:!0},void 0,(0,i.Z)(M.Eg,{},void 0,(0,i.Z)(F,{users:n}))))};var ee;var te=function(e){(0,r.Z)(u,e);var t,n,a=(t=u,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,a=(0,c.Z)(t);if(n){var i=(0,c.Z)(this).constructor;e=Reflect.construct(a,arguments,i)}else e=a.apply(this,arguments);return(0,l.Z)(this,e)});function u(e){var t;return(0,o.Z)(this,u),t=a.call(this,e),(0,v.Z)((0,h.Z)(t),"update",(function(e){A.Z.dispatch((0,P.ZB)(e.results)),e.isLoaded=!0,t.setState(e)})),S.Z.has("USERS")?t.initWithPreloadedData(S.Z.pop("USERS")):t.initWithoutPreloadedData(),t.startPolling(e.params.page||1),t}return(0,s.Z)(u,[{key:"initWithPreloadedData",value:function(e){this.state=Object.assign(e,{isLoaded:!0}),A.Z.dispatch((0,P.ZB)(e.results))}},{key:"initWithoutPreloadedData",value:function(){this.state={isLoaded:!1}}},{key:"startPolling",value:function(e){T.Z.start({poll:"rank-users",url:S.Z.get("USERS_API"),data:{rank:this.props.route.rank.id,page:e},frequency:9e4,update:this.update})}},{key:"componentDidMount",value:function(){I.Z.set({title:this.props.route.rank.name,page:this.props.params.page||null,parent:pgettext("users page title","Users")})}},{key:"componentWillUnmount",value:function(){T.Z.stop("rank-users")}},{key:"componentWillReceiveProps",value:function(e){this.props.params.page!==e.params.page&&(I.Z.set({title:this.props.route.rank.name,page:e.params.page||null,parent:pgettext("users page title","Users")}),this.setState({isLoaded:!1}),T.Z.stop("rank-users"),this.startPolling(e.params.page))}},{key:"getClassName",value:function(){return this.props.route.rank.css_class?"rank-users-list rank-users-"+this.props.route.rank.css_class:"rank-users-list"}},{key:"getRankDescription",value:function(){return this.props.route.rank.description?(0,i.Z)("div",{className:"rank-description"},void 0,(0,i.Z)(j,{copy:this.props.route.rank.description.html})):null}},{key:"getComponent",value:function(){return this.state.isLoaded?this.state.count>0?(0,i.Z)(z,{users:this.props.users}):(0,i.Z)("p",{className:"lead"},void 0,pgettext("rank users list","There are no users with this rank at the moment.")):ee||(ee=(0,i.Z)(q,{}))}},{key:"render",value:function(){return(0,i.Z)("div",{className:this.getClassName()},void 0,(0,i.Z)(m.Z,{},void 0,(0,i.Z)(b,{baseUrl:S.Z.get("USERS_LIST_URL"),page:{name:this.props.route.rank.name},pages:S.Z.get("USERS_LISTS")}),this.getRankDescription(),this.getComponent(),(0,i.Z)(J,{baseUrl:S.Z.get("USERS_LIST_URL")+this.props.route.rank.slug+"/",users:this.state})))}}]),u}(d().Component),ne=n(82125),ae=n(99755);var ie=function(e){(0,r.Z)(u,e);var t,n,a=(t=u,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,a=(0,c.Z)(t);if(n){var i=(0,c.Z)(this).constructor;e=Reflect.construct(a,arguments,i)}else e=a.apply(this,arguments);return(0,l.Z)(this,e)});function u(){return(0,o.Z)(this,u),a.apply(this,arguments)}return(0,s.Z)(u,[{key:"render",value:function(){return(0,i.Z)("div",{className:"page page-users-lists"},void 0,(0,i.Z)(ae.sP,{},void 0,(0,i.Z)(ae.mr,{styleName:"users-lists"},void 0,(0,i.Z)(ae.gC,{styleName:"users-lists"},void 0,(0,i.Z)("h1",{},void 0,pgettext("users page title","Users"))))),this.props.children)}}]),u}(ne.Z);function oe(e){return{tick:e.tick.tick,user:e.auth.user,users:e.users}}function se(){var e=[];return S.Z.get("USERS_LISTS").forEach((function(t){"rank"===t.component?(e.push({path:S.Z.get("USERS_LIST_URL")+t.slug+"/:page/",component:(0,p.$j)(oe)(te),rank:t}),e.push({path:S.Z.get("USERS_LIST_URL")+t.slug+"/",component:(0,p.$j)(oe)(te),rank:t})):"active-posters"===t.component&&e.push({path:S.Z.get("USERS_LIST_URL")+t.component+"/",component:(0,p.$j)(oe)(B),extra:{name:t.name}})})),e}var re=n(39633);S.Z.addInitializer({name:"component:users",initializer:function(e){e.has("USERS_LISTS")&&(0,re.Z)({root:S.Z.get("USERS_LIST_URL"),component:ie,paths:se()})},after:"store"})},97751:(e,t,n)=>{"use strict";var a=n(15579),i=n(96142);a.Z.addInitializer({name:"include",initializer:function(e){i.Z.init(e.get("STATIC_URL"))}})},76093:(e,t,n)=>{"use strict";var a=n(15579),i=n(62833);a.Z.addInitializer({name:"local-storage",initializer:function(){i.Z.init("misago_")}})},87336:(e,t,n)=>{"use strict";var a=n(15579),i=n(15671),o=n(43144),s=n(4869),r=n(19755);const l=new(function(){function e(){(0,i.Z)(this,e)}return(0,o.Z)(e,[{key:"init",value:function(e){this._element=e,this._component=null}},{key:"show",value:function(e){this._component===e?this.hide():(this._component=e,(0,s.Z)(e,this._element.id),r(this._element).addClass("open"))}},{key:"showConnected",value:function(e,t){this._component===e?this.hide():(this._component=e,(0,s.Z)(t,this._element.id,!0),r(this._element).addClass("open"))}},{key:"hide",value:function(){r(this._element).removeClass("open"),this._component=null}}]),e}());a.Z.addInitializer({name:"dropdown",initializer:function(){var e=document.getElementById("mobile-navbar-dropdown-mount");e&&l.init(e)},before:"store"})},47549:(e,t,n)=>{"use strict";var a=n(15579),i=n(59801);a.Z.addInitializer({name:"modal",initializer:function(){var e=document.getElementById("modal-mount");e&&i.Z.init(e)},before:"store"})},22331:(e,t,n)=>{"use strict";var a=n(30381),i=n.n(a),o=n(15579),s=n(19755);o.Z.addInitializer({name:"moment",initializer:function(){i().locale(s("html").attr("lang"))}})},21513:(e,t,n)=>{"use strict";var a=n(15579),i=n(53328);a.Z.addInitializer({name:"page-title",initializer:function(e){i.Z.init(e.get("SETTINGS").forum_index_title,e.get("SETTINGS").forum_name)}})},98749:(e,t,n)=>{"use strict";var a=n(15579),i=n(78657),o=n(53904),s=n(55547);a.Z.addInitializer({name:"polls",initializer:function(){s.Z.init(i.Z,o.Z)}})},98251:(e,t,n)=>{"use strict";var a=n(15579),i=n(78657),o=n(64646),s=n(53904);a.Z.addInitializer({name:"posting",initializer:function(){o.Z.init(i.Z,s.Z,document.getElementById("posting-mount"))}})},6720:(e,t,n)=>{"use strict";var a=n(15579),i=n(35486),o=n(90287);a.Z.addInitializer({name:"reducer:auth",initializer:function(e){o.Z.addReducer("auth",i.ZP,Object.assign({isAuthenticated:e.get("isAuthenticated"),isAnonymous:!e.get("isAuthenticated"),user:e.get("user")},i.E3))},before:"store"})},66806:(e,t,n)=>{"use strict";var a=n(15579),i=n(993),o=n(90287);a.Z.addInitializer({name:"reducer:overlay",initializer:function(e){o.Z.addReducer("overlay",i.ZP,i.E3)},before:"store"})},10846:(e,t,n)=>{"use strict";var a=n(15579),i=n(8154),o=n(90287);a.Z.addInitializer({name:"reducer:participants",initializer:function(){var e=null;a.Z.has("THREAD")&&(e=a.Z.get("THREAD").participants),o.Z.addReducer("participants",i.ZP,e||[])},before:"store"})},18255:(e,t,n)=>{"use strict";var a=n(15579),i=n(59752),o=n(90287);a.Z.addInitializer({name:"reducer:poll",initializer:function(){var e;e=a.Z.has("THREAD")&&a.Z.get("THREAD").poll?(0,i.ZB)(a.Z.get("THREAD").poll):{},o.Z.addReducer("poll",i.ZP,e)},before:"store"})},14113:(e,t,n)=>{"use strict";var a=n(15579),i=n(21981),o=n(90287);a.Z.addInitializer({name:"reducer:posts",initializer:function(){var e;e=a.Z.has("POSTS")?(0,i.ZB)(a.Z.get("POSTS")):{isLoaded:!1,isBusy:!1},o.Z.addReducer("posts",i.ZP,e)},before:"store"})},24444:(e,t,n)=>{"use strict";var a=n(15579),i=n(58598),o=n(90287);a.Z.addInitializer({name:"reducer:profile-details",initializer:function(){var e=null;a.Z.has("PROFILE_DETAILS")&&(e=a.Z.get("PROFILE_DETAILS")),o.Z.addReducer("profile-details",i.ZP,e||{})},before:"store"})},1764:(e,t,n)=>{"use strict";var a=n(15579),i=n(27519),o=n(90287);a.Z.addInitializer({name:"reducer:profile-hydrate",initializer:function(){a.Z.has("PROFILE")&&o.Z.dispatch((0,i.ZB)(a.Z.get("PROFILE")))},after:"store"})},68351:(e,t,n)=>{"use strict";var a=n(15579),i=n(27519),o=n(90287);a.Z.addInitializer({name:"reducer:profile",initializer:function(){o.Z.addReducer("profile",i.ZP,{})},before:"store"})},81521:(e,t,n)=>{"use strict";var a=n(15579),i=n(16427),o=n(90287);a.Z.addInitializer({name:"reducer:search",initializer:function(){o.Z.addReducer("search",i.ZP,Object.assign({},i.E3,{providers:a.Z.get("SEARCH_PROVIDERS")||[],query:a.Z.get("SEARCH_QUERY")||""}))},before:"store"})},68585:(e,t,n)=>{"use strict";var a=n(15579);function i(e,t){if(-1===e.indexOf(t)){var n=e.slice();return n.push(t),n}return e.filter((function(e){return e!==t}))}var o="SELECT_ALL",s="SELECT_NONE",r="SELECT_ITEM";function l(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;switch(t.type){case o:return t.items;case s:return[];case r:return i(e,t.item);default:return e}}var c=n(90287);a.Z.addInitializer({name:"reducer:selection",initializer:function(){c.Z.addReducer("selection",l,[])},before:"store"})},41229:(e,t,n)=>{"use strict";var a=n(15579),i=n(27346),o=n(90287);a.Z.addInitializer({name:"reducer:snackbar",initializer:function(){o.Z.addReducer("snackbar",i.ZP,i.E3)},before:"store"})},43589:(e,t,n)=>{"use strict";var a=n(15579),i=n(7738),o=n(90287);a.Z.addInitializer({name:"reducer:thread",initializer:function(){var e;e=a.Z.has("THREAD")?(0,i.ZB)(a.Z.get("THREAD")):{isBusy:!1},o.Z.addReducer("thread",i.ZP,e)},before:"store"})},62894:(e,t,n)=>{"use strict";var a=n(15579),i=(n(30381),n(89759)),o="APPEND_THREADS",s="DELETE_THREAD",r="FILTER_THREADS",l="HYDRATE_THREADS",c="PATCH_THREAD",u="SORT_THREADS",d=["can_announce","can_approve","can_close","can_hide","can_move","can_merge","can_pin","can_review"];function p(e){return Object.assign({},e,{moderation:(t=e.acl,n=[],d.forEach((function(e){t[e]&&n.push(e)})),n)});var t,n}function h(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;switch(t.type){case o:var n=(0,i.Z)(t.items.map(p),e);return n.sort(t.sorting);case s:return e.filter((function(e){return e.id!==t.thread.id}));case r:return e.filter((function(e){var n=t.categoriesMap[e.category];return n.lft>=t.category.lft&&n.rght<=t.category.rght||2==e.weight}));case l:return t.items.map(p);case c:var a=e.map((function(e){return e.id===t.thread.id?Object.assign({},e,t.patch):e}));return t.sorting?a.sort(t.sorting):a;case u:return e.sort(t.sorting);default:return e}}var v=n(90287);a.Z.addInitializer({name:"reducer:threads",initializer:function(){v.Z.addReducer("threads",h,[])},before:"store"})},33934:(e,t,n)=>{"use strict";var a=n(15579),i=n(85586),o=n(90287);a.Z.addInitializer({name:"reducer:tick",initializer:function(){o.Z.addReducer("tick",i.ZP,i.E3)},before:"store"})},85577:(e,t,n)=>{"use strict";var a=n(15579),i=n(48927),o=n(90287);a.Z.addInitializer({name:"reducer:username-history",initializer:function(){o.Z.addReducer("username-history",i.ZP,[])},before:"store"})},83526:(e,t,n)=>{"use strict";var a=n(15579),i=n(6935),o=n(90287);a.Z.addInitializer({name:"reducer:users",initializer:function(){o.Z.addReducer("users",i.ZP,[])},before:"store"})},43060:(e,t,n)=>{"use strict";var a=n(15579),i=n(53904),o=n(90287);a.Z.addInitializer({name:"snackbar",initializer:function(){i.Z.init(o.Z)},after:"store"})},92292:(e,t,n)=>{"use strict";var a=n(15579),i=n(90287);a.Z.addInitializer({name:"store",initializer:function(){i.Z.init()},before:"_end"})},33409:(e,t,n)=>{"use strict";var a=n(15579),i=n(85586),o=n(90287);a.Z.addInitializer({name:"tick-start",initializer:function(){window.setInterval((function(){o.Z.dispatch((0,i.bq)())}),5e4)},after:"store"})},31341:(e,t,n)=>{"use strict";var a=n(15579),i=n(96142),o=n(59940);a.Z.addInitializer({name:"zxcvbn",initializer:function(){o.Z.init(i.Z)}})},35486:(e,t,n)=>{"use strict";n.d(t,{E3:()=>i,ZP:()=>h,r$:()=>u,w7:()=>p,yH:()=>c,zB:()=>d});var a=n(6935),i={signedIn:!1,signedOut:!1},o="UPDATE_AUTHENTICATED_USER",s="PATCH_USER",r="SIGN_IN",l="SIGN_OUT";function c(e){return{type:o,data:e}}function u(e){return{type:s,patch:e}}function d(e){return{type:r,user:e}}function p(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return{type:l,soft:e}}function h(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:i,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;switch(t.type){case s:var n=Object.assign({},e);return n.user=Object.assign({},e.user,t.patch),n;case o:var c=Object.assign({},e);return c.user=Object.assign({},e.user,t.data),c;case r:return Object.assign({},e,{signedIn:t.user});case l:return Object.assign({},e,{isAuthenticated:!1,isAnonymous:!0,signedOut:!t.soft});case a.oB:if(e.isAuthenticated&&e.user.id===t.userId){var u=Object.assign({},e);return u.user=Object.assign({},e.user,{avatars:t.avatars}),u}return e;case a.D9:if(e.isAuthenticated&&e.user.id===t.userId){var d=Object.assign({},e);return d.user=Object.assign({},e.user,{username:t.username,slug:t.slug}),d}return e;default:return e}}},993:(e,t,n)=>{"use strict";n.d(t,{AU:()=>c,E3:()=>v,T5:()=>p,UL:()=>u,ZP:()=>m,hN:()=>d,xv:()=>h});var a="OPEN_SITE_NAV",i="OPEN_SEARCH",o="OPEN_NOTIFICATIONS",s="OPEN_PRIVATE_THREADS",r="OPEN_USER_NAV",l="CLOSE_OVERLAYS";function c(){return{type:a}}function u(){return{type:i}}function d(){return{type:o}}function p(){return{type:r}}function h(){return{type:l}}var v={siteNav:!1,search:!1,notifications:!1,privateThreads:!1,userNav:!1};function m(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:v,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;switch(t.type){case a:return Object.assign({},e,v,{siteNav:!0});case i:return Object.assign({},e,v,{search:!0});case o:return Object.assign({},e,v,{notifications:!0});case s:return Object.assign({},e,v,{privateThreads:!0});case r:return Object.assign({},e,v,{userNav:!0});case l:return Object.assign({},e,v);default:return e}}},8154:(e,t,n)=>{"use strict";n.d(t,{ZP:()=>o,gx:()=>i});var a="REPLACE_PARTICIPANTS";function i(e){return{type:a,state:e}}function o(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return t.type===a?t.state:e}},59752:(e,t,n)=>{"use strict";n.d(t,{Ar:()=>p,Od:()=>v,ZB:()=>u,ZH:()=>r,ZP:()=>m,b9:()=>l,gx:()=>h,n6:()=>d});var a=n(30381),i=n.n(a),o="BUSY_POLL",s="RELEASE_POLL",r="REMOVE_POLL",l="REPLACE_POLL",c="UPDATE_POLL";function u(e){var t=!1;for(var n in e.choices)if(e.choices[n].selected){t=!0;break}return Object.assign({},e,{posted_on:i()(e.posted_on),hasSelectedChoices:t,endsOn:e.length?i()(e.posted_on).add(e.length,"days"):null,isBusy:!1})}function d(){return{type:o}}function p(){return{type:s}}function h(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return{type:l,state:t?e:u(e)}}function v(){return{type:r}}function m(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;switch(t.type){case o:return Object.assign({},e,{isBusy:!0});case s:return Object.assign({},e,{isBusy:!1});case r:return{isBusy:!1};case l:return t.state;case c:return Object.assign({},e,t.data);default:return e}}},92747:(e,t,n)=>{"use strict";n.d(t,{Qu:()=>s,ZB:()=>r,ZP:()=>u,r$:()=>c});var a=n(30381),i=n.n(a),o=n(6935),s="PATCH_POST";function r(e){return Object.assign({},e,{posted_on:i()(e.posted_on),updated_on:i()(e.updated_on),hidden_on:i()(e.hidden_on),attachments:e.attachments?e.attachments.map(l):null,poster:e.poster?(0,o.Ru)(e.poster):null,isSelected:!1,isBusy:!1,isDeleted:!1})}function l(e){return Object.assign({},e,{uploaded_on:i()(e.uploaded_on)})}function c(e,t){return{type:s,post:e,patch:t}}function u(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return t.type===s&&e.id==t.post.id?Object.assign({},e,t.patch):e}},21981:(e,t,n)=>{"use strict";n.d(t,{R3:()=>f,Rz:()=>Z,Vx:()=>g,Ys:()=>d,ZB:()=>v,ZP:()=>b,_H:()=>p,kR:()=>h,zD:()=>m});var a=n(92747),i="APPEND_POSTS",o="SELECT_POST",s="DESELECT_POST",r="DESELECT_POSTS",l="LOAD_POSTS",c="UNLOAD_POSTS",u="UPDATE_POSTS";function d(e){return{type:o,post:e}}function p(e){return{type:s,post:e}}function h(){return{type:r}}function v(e){return Object.assign({},e,{results:e.results.map(a.ZB),isLoaded:!0,isBusy:!1,isSelected:!1})}function m(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return{type:l,state:t?e:v(e)}}function f(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return{type:i,state:t?e:v(e)}}function Z(){return{type:c}}function g(e){return{type:u,update:e}}function b(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;switch(t.type){case o:var n=e.results.map((function(e){return e.id==t.post.id?Object.assign({},e,{isSelected:!0}):e}));return Object.assign({},e,{results:n});case s:var d=e.results.map((function(e){return e.id==t.post.id?Object.assign({},e,{isSelected:!1}):e}));return Object.assign({},e,{results:d});case r:var p=e.results.map((function(e){return Object.assign({},e,{isSelected:!1})}));return Object.assign({},e,{results:p});case i:var h=e.results.slice(),v=e.results.map((function(e){return e.id}));return t.state.results.map((function(e){-1===v.indexOf(e.id)&&h.push(e)})),Object.assign({},t.state,{results:h});case l:return t.state;case c:return Object.assign({},e,{isLoaded:!1});case u:return Object.assign({},e,t.update);case a.Qu:var m=e.results.map((function(e){return(0,a.ZP)(e,t)}));return Object.assign({},e,{results:m});default:return e}}},58598:(e,t,n)=>{"use strict";n.d(t,{ZP:()=>o,zD:()=>i});var a="LOAD_DETAILS";function i(e){return{type:a,newState:e}}function o(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return t.type===a?t.newState:e}},27519:(e,t,n)=>{"use strict";n.d(t,{ZB:()=>l,ZP:()=>u,r$:()=>c});var a=n(30381),i=n.n(a),o=n(6935),s="HYDRATE_PROFILE",r="PATCH_PROFILE";function l(e){return{type:s,profile:e}}function c(e){return{type:r,patch:e}}function u(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;switch(t.type){case s:return Object.assign({},t.profile,{joined_on:i()(t.profile.joined_on),status:(0,o.$q)(t.profile.status)});case r:return Object.assign({},e,t.patch);case o.oB:return e.id===t.userId?Object.assign({},e,{avatars:t.avatars}):e;case o.D9:return e.id===t.userId?Object.assign({},e,{username:t.username,slug:t.slug}):e;default:return e}}},16427:(e,t,n)=>{"use strict";n.d(t,{E3:()=>s,P0:()=>l,Vx:()=>r,ZP:()=>c});var a="REPLACE_SEARCH",i="UPDATE_SEARCH",o="UPDATE_SEARCH_PROVIDER",s={isLoading:!1,query:"",providers:[]};function r(e){return{type:i,update:e}}function l(e){return{type:o,provider:e}}function c(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;switch(t.type){case a:return t.state;case i:return Object.assign({},e,t.update);case o:return Object.assign({},e,{providers:e.providers.map((function(e){return e.id===t.provider.id?t.provider:e}))});default:return e}}},27346:(e,t,n)=>{"use strict";n.d(t,{E3:()=>a,OV:()=>s,ZP:()=>l,p2:()=>r});var a={type:"info",message:"",isVisible:!1},i="SHOW_SNACKBAR",o="HIDE_SNACKBAR";function s(e,t){return{type:i,message:e,messageType:t}}function r(){return{type:o}}function l(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:a,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return t.type===i?{type:t.messageType,message:t.message,isVisible:!0}:t.type===o?Object.assign({},e,{isVisible:!1}):e}},7738:(e,t,n)=>{"use strict";n.d(t,{Ar:()=>h,Vx:()=>m,ZB:()=>d,ZP:()=>Z,gx:()=>v,n6:()=>p,y8:()=>f});var a=n(30381),i=n.n(a),o=n(59752),s="BUSY_THREAD",r="RELEASE_THREAD",l="REPLACE_THREAD",c="UPDATE_THREAD",u="UPDATE_THREAD_ACL";function d(e){return Object.assign({},e,{started_on:i()(e.started_on),last_post_on:i()(e.last_post_on),best_answer_marked_on:e.best_answer_marked_on?i()(e.best_answer_marked_on):null,isBusy:!1})}function p(){return{type:s}}function h(){return{type:r}}function v(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return{type:l,state:t?e:d(e)}}function m(e){return{type:c,data:e}}function f(e){return{type:u,data:e}}function Z(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;switch(t.type){case s:return Object.assign({},e,{isBusy:!0});case r:return Object.assign({},e,{isBusy:!1});case o.ZH:return Object.assign({},e,{poll:null});case o.b9:return Object.assign({},e,{poll:t.state});case l:return t.state;case c:return Object.assign({},e,t.data);case u:var n=Object.assign({},e.acl,t.data);return Object.assign({},e,{acl:n});default:return e}}},85586:(e,t,n)=>{"use strict";n.d(t,{E3:()=>a,ZP:()=>s,bq:()=>o});var a={tick:0},i="TICK";function o(){return{type:i}}function s(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:a,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return t.type===i?Object.assign({},e,{tick:e.tick+1}):e}},48927:(e,t,n)=>{"use strict";n.d(t,{KP:()=>u,R3:()=>d,ZB:()=>p,ZP:()=>v});var a=n(30381),i=n.n(a),o=n(6935),s=n(89759),r="ADD_NAME_CHANGE",l="APPEND_HISTORY",c="HYDRATE_HISTORY";function u(e,t,n){return{type:r,change:e,user:t,changedBy:n}}function d(e){return{type:l,items:e}}function p(e){return{type:c,items:e}}function h(e){return Object.assign({},e,{changed_on:i()(e.changed_on)})}function v(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;switch(t.type){case r:var n=e.slice();return n.unshift({id:Math.floor(Date.now()/1e3),changed_by:t.changedBy,changed_by_username:t.changedBy.username,changed_on:i()(),new_username:t.change.username,old_username:t.user.username}),n;case l:return(0,s.Z)(e,t.items.map(h));case c:return t.items.map(h);case o.oB:return e.map((function(e){return(e=Object.assign({},e)).changed_by&&e.changed_by.id===t.userId&&(e.changed_by=Object.assign({},e.changed_by,{avatars:t.avatars})),e}));case o.D9:return e.map((function(e){return(e=Object.assign({},e)).changed_by&&e.changed_by.id===t.userId&&(e.changed_by=Object.assign({},e.changed_by,{username:t.username,slug:t.slug})),Object.assign({},e)}));default:return e}}},6935:(e,t,n)=>{"use strict";n.d(t,{$q:()=>p,D9:()=>c,R3:()=>u,Ru:()=>h,ZB:()=>d,ZP:()=>f,_S:()=>m,n1:()=>v,oB:()=>l});var a=n(30381),i=n.n(a),o=n(89759),s="APPEND_USERS",r="HYDRATE_USERS",l="UPDATE_AVATAR",c="UPDATE_USERNAME";function u(e){return{type:s,items:e}}function d(e){return{type:r,items:e}}function p(e){return e?Object.assign({},e,{last_click:e.last_click?i()(e.last_click):null,banned_until:e.banned_until?i()(e.banned_until):null}):null}function h(e){return Object.assign({},e,{joined_on:i()(e.joined_on),status:p(e.status)})}function v(e,t){return{type:l,userId:e.id,avatars:t}}function m(e,t,n){return{type:c,userId:e.id,username:t,slug:n}}function f(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;switch(t.type){case s:return(0,o.Z)(e,t.items.map(h));case r:return t.items.map(h);case l:return e.map((function(e){return(e=Object.assign({},e)).id===t.userId&&(e.avatars=t.avatars),e}));default:return e}}},78657:(e,t,n)=>{"use strict";n.d(t,{Z:()=>s});var a=n(15671),i=n(43144),o=n(19755);const s=new(function(){function e(){(0,a.Z)(this,e),this._cookieName=null,this._csrfToken=null,this._locks={}}return(0,i.Z)(e,[{key:"init",value:function(e){this._cookieName=e}},{key:"getCsrfToken",value:function(){if(-1!==document.cookie.indexOf(this._cookieName)){var e=new RegExp(this._cookieName+"=([^;]*)"),t=document.cookie.match(e)[0];return t?t.split("=")[1]:null}return null}},{key:"request",value:function(e,t,n){var a=this;return new Promise((function(i,s){var r={url:t,method:e,headers:{"X-CSRFToken":a.getCsrfToken()},data:n?JSON.stringify(n):null,contentType:"application/json; charset=utf-8",dataType:"json",success:function(e){i(e)},error:function(e){var t=e.responseJSON||{};t.status=e.status,0===t.status&&(t.detail=pgettext("ajax client error","Could not connect to the site.")),404===t.status&&(t.detail&&"NOT FOUND"!==t.detail||(t.detail=pgettext("ajax client error","Action link is invalid."))),500!==t.status||t.detail||(t.detail=pgettext("ajax client error","Unknown error has occurred.")),t.statusText=e.statusText,s(t)}};o.ajax(r)}))}},{key:"get",value:function(e,t,n){if(t&&(e+="?"+o.param(t)),n){var a=this;return this._locks[n]&&(this._locks[n].url=e),this._locks[n]&&this._locks[n].waiter?{then:function(){}}:this._locks[n]&&this._locks[n].wait?(this._locks[n].waiter=!0,new Promise((function(t,i){var o=function e(o){a._locks[n].wait?window.setTimeout((function(){e(o)}),300):a._locks[n].url!==o?e(a._locks[n].url):(a._locks[n].waiter=!1,a.request("GET",a._locks[n].url).then((function(i){a._locks[n].url===o?t(i):(a._locks[n].waiter=!0,e(a._locks[n].url))}),(function(t){a._locks[n].url===o?i(t):(a._locks[n].waiter=!0,e(a._locks[n].url))})))};window.setTimeout((function(){o(e)}),300)}))):(this._locks[n]={url:e,wait:!0,waiter:!1},new Promise((function(t,i){a.request("GET",e).then((function(i){a._locks[n].wait=!1,a._locks[n].url===e&&t(i)}),(function(t){a._locks[n].wait=!1,a._locks[n].url===e&&i(t)}))})))}return this.request("GET",e)}},{key:"post",value:function(e,t){return this.request("POST",e,t)}},{key:"patch",value:function(e,t){return this.request("PATCH",e,t)}},{key:"put",value:function(e,t){return this.request("PUT",e,t)}},{key:"delete",value:function(e,t){return this.request("DELETE",e,t)}},{key:"upload",value:function(e,t,n){var a=this;return new Promise((function(i,s){var r={url:e,method:"POST",headers:{"X-CSRFToken":a.getCsrfToken()},data:t,contentType:!1,processData:!1,xhr:function(){var e=new window.XMLHttpRequest;return e.upload.addEventListener("progress",(function(e){e.lengthComputable&&n(Math.round(e.loaded/e.total*100))}),!1),e},success:function(e){i(e)},error:function(e){var t=e.responseJSON||{};t.status=e.status,0===t.status&&(t.detail=pgettext("api error","Could not connect to the site.")),413!==t.status||t.detail||(t.detail=pgettext("api error","Upload was rejected by the site as too large.")),404===t.status&&(t.detail&&"NOT FOUND"!==t.detail||(t.detail=pgettext("api error","Action link is invalid."))),500!==t.status||t.detail||(t.detail=pgettext("api error","Unknown error has occurred.")),t.statusText=e.statusText,s(t)}};o.ajax(r)}))}}]),e}())},98274:(e,t,n)=>{"use strict";n.d(t,{Z:()=>s});var a=n(15671),i=n(43144),o=n(35486);const s=new(function(){function e(){(0,a.Z)(this,e)}return(0,i.Z)(e,[{key:"init",value:function(e,t,n){this._store=e,this._local=t,this._modal=n,this.syncSession(),this.watchState()}},{key:"syncSession",value:function(){var e=this._store.getState().auth;e.isAuthenticated?this._local.set("auth",{isAuthenticated:!0,username:e.user.username}):this._local.set("auth",{isAuthenticated:!1})}},{key:"watchState",value:function(){var e=this,t=this._store.getState().auth;this._local.watch("auth",(function(n){n.isAuthenticated?e._store.dispatch((0,o.zB)({username:n.username})):t.isAuthenticated&&e._store.dispatch((0,o.w7)())})),this._modal.hide()}},{key:"signIn",value:function(e){this._store.dispatch((0,o.zB)(e)),this._local.set("auth",{isAuthenticated:!0,username:e.username}),this._modal.hide()}},{key:"signOut",value:function(){this._store.dispatch((0,o.w7)()),this._local.set("auth",{isAuthenticated:!1}),this._modal.hide()}},{key:"softSignOut",value:function(){this._store.dispatch((0,o.w7)(!0)),this._local.set("auth",{isAuthenticated:!1}),this._modal.hide()}}]),e}())},93825:(e,t,n)=>{"use strict";n.d(t,{ZP:()=>b});var a,i=n(22928),o=n(79340),s=n(6215),r=n(61120),l=n(15671),c=n(43144),u=n(57588),d=n.n(u),p=n(96359);function h(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=(0,r.Z)(e);if(t){var i=(0,r.Z)(this).constructor;n=Reflect.construct(a,arguments,i)}else n=a.apply(this,arguments);return(0,s.Z)(this,n)}}var v=function(){function e(){(0,l.Z)(this,e)}return(0,c.Z)(e,[{key:"init",value:function(e,t,n,a){this._context=e,this._ajax=t,this._include=n,this._snackbar=a}}]),e}(),m=function(e){(0,o.Z)(n,e);var t=h(n);function n(){return(0,l.Z)(this,n),t.apply(this,arguments)}return(0,c.Z)(n,[{key:"load",value:function(){return new Promise((function(e){e()}))}},{key:"validator",value:function(){return null}},{key:"component",value:function(){return null}}]),n}(v),f=function(e){(0,o.Z)(n,e);var t=h(n);function n(){return(0,l.Z)(this,n),t.apply(this,arguments)}return(0,c.Z)(n,[{key:"load",value:function(){var e=this;return new Promise((function(t,n){e._ajax.get(e._context.get("CAPTCHA_API")).then((function(n){e.question=n.question,e.helpText=n.help_text,t()}),(function(){e._snackbar.error(pgettext("captcha field","Failed to load CAPTCHA.")),n()}))}))}},{key:"validator",value:function(){return[]}},{key:"component",value:function(e){return(0,i.Z)(p.Z,{label:this.question,for:"id_captcha",labelClass:e.labelClass||"",controlClass:e.controlClass||"",validation:e.form.state.errors.captcha,helpText:this.helpText||null},void 0,(0,i.Z)("input",{"aria-describedby":"id_captcha_status",className:"form-control",disabled:e.form.state.isLoading,id:"id_captcha",onChange:e.form.bindInput("captcha"),type:"text",value:e.form.state.captcha}))}}]),n}(v),Z=function(e){(0,o.Z)(n,e);var t=h(n);function n(){return(0,l.Z)(this,n),t.apply(this,arguments)}return(0,c.Z)(n,[{key:"componentDidMount",value:function(){var e=this;grecaptcha.render("recaptcha",{sitekey:this.props.siteKey,callback:function(t){e.props.binding({target:{value:t}})}})}},{key:"render",value:function(){return a||(a=(0,i.Z)("div",{id:"recaptcha"}))}}]),n}(d().Component),g=function(e){(0,o.Z)(n,e);var t=h(n);function n(){return(0,l.Z)(this,n),t.apply(this,arguments)}return(0,c.Z)(n,[{key:"load",value:function(){return this._include.include("https://www.google.com/recaptcha/api.js",!0),new Promise((function(e){!function t(){"undefined"==typeof grecaptcha?window.setTimeout((function(){t()}),200):e()}()}))}},{key:"validator",value:function(){return[]}},{key:"component",value:function(e){return(0,i.Z)(p.Z,{label:pgettext("captcha field","Please solve the quick test"),for:"id_captcha",labelClass:e.labelClass||"",controlClass:e.controlClass||"",validation:e.form.state.errors.captcha,helpText:pgettext("captcha field","This test helps us prevent automated spam registrations on the site.")},void 0,(0,i.Z)(Z,{binding:e.form.bindInput("captcha"),siteKey:this._context.get("SETTINGS").recaptcha_site_key}))}}]),n}(v);const b=new(function(){function e(){(0,l.Z)(this,e)}return(0,c.Z)(e,[{key:"init",value:function(e,t,n,a){switch(e.get("SETTINGS").captcha_type){case"no":this._captcha=new m;break;case"qa":this._captcha=new f;break;case"re":this._captcha=new g}this._captcha.init(e,t,n,a)}},{key:"load",value:function(){return this._captcha.load()}},{key:"validator",value:function(){return this._captcha.validator()}},{key:"component",value:function(e){return this._captcha.component(e)}}]),e}())},96142:(e,t,n)=>{"use strict";n.d(t,{Z:()=>s});var a=n(15671),i=n(43144),o=n(19755);const s=new(function(){function e(){(0,a.Z)(this,e)}return(0,i.Z)(e,[{key:"init",value:function(e){this._staticUrl=e,this._included=[]}},{key:"include",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];-1===this._included.indexOf(e)&&(this._included.push(e),this._include(e,t))}},{key:"_include",value:function(e,t){o.ajax({url:(t?"":this._staticUrl)+e,cache:!0,dataType:"script"})}}]),e}())},62833:(e,t,n)=>{"use strict";n.d(t,{Z:()=>s});var a=n(15671),i=n(43144),o=window.localStorage;const s=new(function(){function e(){(0,a.Z)(this,e)}return(0,i.Z)(e,[{key:"init",value:function(e){var t=this;this._prefix=e,this._watchers=[],window.addEventListener("storage",(function(e){var n=JSON.parse(e.newValue);t._watchers.forEach((function(t){t.key===e.key&&e.oldValue!==e.newValue&&t.callback(n)}))}))}},{key:"set",value:function(e,t){o.setItem(this._prefix+e,JSON.stringify(t))}},{key:"get",value:function(e){var t=o.getItem(this._prefix+e);return t?JSON.parse(t):null}},{key:"watch",value:function(e,t){this._watchers.push({key:this._prefix+e,callback:t})}}]),e}())},59801:(e,t,n)=>{"use strict";n.d(t,{Z:()=>c});var a=n(15671),i=n(43144),o=n(73935),s=n.n(o),r=n(4869),l=n(19755);const c=new(function(){function e(){(0,a.Z)(this,e)}return(0,i.Z)(e,[{key:"init",value:function(e){var t=this;this._element=e,this._modal=l(e).modal({show:!1}),this._modal.on("hidden.bs.modal",(function(){s().unmountComponentAtNode(t._element)}))}},{key:"show",value:function(e){(0,r.Z)(e,this._element.id),this._modal.modal("show")}},{key:"hide",value:function(){this._modal.modal("hide")}}]),e}())},53328:(e,t,n)=>{"use strict";n.d(t,{Z:()=>o});var a=n(15671),i=n(43144);const o=new(function(){function e(){(0,a.Z)(this,e)}return(0,i.Z)(e,[{key:"init",value:function(e,t){this._indexTitle=e,this._forumName=t}},{key:"set",value:function(e){if(e){"string"==typeof e&&(e={title:e});var t=e.title;e.page>1&&(t+=" ("+interpolate(pgettext("page title pagination","page: %(page)s"),{page:e.page},!0)+")"),e.parent&&(t+=" | "+e.parent),document.title=t+" | "+this._forumName}else document.title=this._indexTitle||this._forumName}}]),e}())},55547:(e,t,n)=>{"use strict";n.d(t,{Z:()=>o});var a=n(15671),i=n(43144);const o=new(function(){function e(){(0,a.Z)(this,e)}return(0,i.Z)(e,[{key:"init",value:function(e,t){this._ajax=e,this._snackbar=t,this._polls={}}},{key:"start",value:function(e){var t=this;this.stop(e.poll);var n=function n(){t._polls[e.poll]=e,t._ajax.get(e.url,e.data||null).then((function(a){t._polls[e.poll]._stopped||(e.update(a),t._polls[e.poll].timeout=window.setTimeout(n,e.frequency))}),(function(n){t._polls[e.poll]._stopped||(e.error?e.error(n):t._snackbar.apiError(n))}))};e.delayed?this._polls[e.poll]={timeout:window.setTimeout(n,e.frequency)}:n()}},{key:"stop",value:function(e){this._polls[e]&&(window.clearTimeout(this._polls[e].timeout),this._polls[e]._stopped=!0)}}]),e}())},64646:(e,t,n)=>{"use strict";n.d(t,{Z:()=>p});var a=n(15671),i=n(43144),o=n(4942),s=n(57588),r=n.n(s),l=n(73935),c=n.n(l),u=n(9771),d=n(4869);const p=new(function(){function e(){var t=this;(0,a.Z)(this,e),(0,o.Z)(this,"close",(function(){t.unsetBeforeUnload(),t._props=null,t._isOpen&&!t._isClosing&&(t._isClosing=!0,t._mount.classList.remove("show"),window.setTimeout((function(){c().unmountComponentAtNode(t._mount),t._observer.unobserve(t._mount),t._spacer.style.height="0px;",t._isClosing=!1,t._isOpen=!1,t._mode=null}),300))}))}return(0,i.Z)(e,[{key:"init",value:function(e,t,n){var a=this;this._ajax=e,this._snackbar=t,this._mount=n,this._mode=null,this._spacer=document.getElementById("posting-spacer"),this._observer=new ResizeObserver((function(e){a._spacer.style.height=e[0].contentRect.height+"px"})),this._isOpen=!1,this._isClosing=!1,this._beforeunloadSet=!1,this._props=null}},{key:"isOpen",value:function(){return this._isOpen}},{key:"setBeforeUnload",value:function(){this._beforeunloadSet||(window.addEventListener("beforeunload",this.beforeUnload,{capture:!0}),this._beforeunloadSet=!0)}},{key:"unsetBeforeUnload",value:function(){window.removeEventListener("beforeunload",this.beforeUnload,{capture:!0}),this._beforeunloadSet=!1}},{key:"beforeUnload",value:function(e){return e.returnValue="true","true"}},{key:"open",value:function(e){if(!1===this._isOpen)"QUOTE"===e.mode?this._mode="REPLY":this._mode=e.mode,this._isOpen=e.submit,this._realOpen(Object.assign({},e,{mode:this._mode}));else if("QUOTE"===e.mode)this._realOpen(Object.assign({},this._props,{config:e.config,context:e.context}));else if(this._isOpen!==e.submit){var t=gettext("You are already working on other message. Do you want to discard it?");window.confirm(t)&&(this._mode=e.mode,this._isOpen=e.submit,this._realOpen(e))}else"REPLY"==this._mode&&"REPLY"==e.mode&&this._realOpen(e)}},{key:"_realOpen",value:function(e){(0,d.Z)(r().createElement(u.ZP,e),this._mount.id),this._props=e,this._mount.classList.add("show"),this._observer.observe(this._mount),this.setBeforeUnload()}}]),e}())},53904:(e,t,n)=>{"use strict";n.d(t,{Z:()=>r});var a=n(15671),i=n(43144),o=n(4942),s=n(27346);const r=new(function(){function e(){var t=this;(0,a.Z)(this,e),(0,o.Z)(this,"alert",(function(e,n){t._timeout?(window.clearTimeout(t._timeout),t._store.dispatch((0,s.p2)()),t._timeout=window.setTimeout((function(){t._timeout=null,t.alert(e,n)}),300)):(t._store.dispatch((0,s.OV)(e,n)),t._timeout=window.setTimeout((function(){t._store.dispatch((0,s.p2)()),t._timeout=null}),5e3))})),(0,o.Z)(this,"info",(function(e){t.alert(e,"info")})),(0,o.Z)(this,"success",(function(e){t.alert(e,"success")})),(0,o.Z)(this,"warning",(function(e){t.alert(e,"warning")})),(0,o.Z)(this,"error",(function(e){t.alert(e,"error")})),(0,o.Z)(this,"apiError",(function(e){var n=e.data?e.data.detail:e.detail;n||(n=0===e.status?pgettext("api error","Could not connect to the site."):404===e.status?pgettext("api error","Action link is invalid."):pgettext("api error","Unknown error has occurred.")),403===e.status&&"Permission denied"===n&&(n=pgettext("api error","You don't have permission to perform this action.")),t.error(n)}))}return(0,i.Z)(e,[{key:"init",value:function(e){this._store=e,this._timeout=null}}]),e}())},90287:(e,t,n)=>{"use strict";n.d(t,{Z:()=>s});var a=n(15671),i=n(43144),o=n(41438);const s=new(function(){function e(){(0,a.Z)(this,e),this._store=null,this._reducers={},this._initialState={}}return(0,i.Z)(e,[{key:"addReducer",value:function(e,t,n){this._reducers[e]=t,this._initialState[e]=n}},{key:"init",value:function(){this._store=(0,o.createStore)((0,o.combineReducers)(this._reducers),this._initialState)}},{key:"getStore",value:function(){return this._store}},{key:"getState",value:function(){return this._store.getState()}},{key:"dispatch",value:function(e){return this._store.dispatch(e)}}]),e}())},59940:(e,t,n)=>{"use strict";n.d(t,{Z:()=>o});var a=n(15671),i=n(43144);const o=new(function(){function e(){(0,a.Z)(this,e)}return(0,i.Z)(e,[{key:"init",value:function(e){this._include=e,this._isLoaded=!1}},{key:"scorePassword",value:function(e,t){return this._isLoaded?zxcvbn(e,t).score:0}},{key:"load",value:function(){return this._isLoaded?this._loadedPromise():(this._include.include("misago/js/zxcvbn.js"),this._loadingPromise())}},{key:"_loadingPromise",value:function(){var e=this;return new Promise((function(t,n){!function a(){var i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;(i+=1)>200?n():"undefined"==typeof zxcvbn?window.setTimeout((function(){a(i)}),200):(e._isLoaded=!0,t())}()}))}},{key:"_loadedPromise",value:function(){return new Promise((function(e){e()}))}}]),e}())},93051:(e,t,n)=>{"use strict";n.d(t,{Z:()=>_});var a,i=n(22928),o=n(30381),s=n.n(o),r=n(57588),l=n.n(r),c=n(73935),u=n.n(c),d=n(37424),p=n(15671),h=n(43144),v=n(79340),m=n(6215),f=n(61120);var Z=function(e){(0,v.Z)(r,e);var t,n,o=(t=r,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,a=(0,f.Z)(t);if(n){var i=(0,f.Z)(this).constructor;e=Reflect.construct(a,arguments,i)}else e=a.apply(this,arguments);return(0,m.Z)(this,e)});function r(){return(0,p.Z)(this,r),o.apply(this,arguments)}return(0,h.Z)(r,[{key:"getReasonMessage",value:function(){return this.props.message.html?(0,i.Z)("div",{className:"lead",dangerouslySetInnerHTML:{__html:this.props.message.html}}):(0,i.Z)("p",{className:"lead"},void 0,this.props.message.plain)}},{key:"getExpirationMessage",value:function(){if(this.props.expires){if(this.props.expires.isAfter(s()())){var e=interpolate(pgettext("banned page","This ban expires on %(expires_on)s."),{expires_on:this.props.expires.format("LL, LT")},!0),t=interpolate(pgettext("banned page","This ban expires %(expires_on)s."),{expires_on:this.props.expires.fromNow()},!0);return(0,i.Z)("abbr",{title:e},void 0,t)}return pgettext("banned page","This ban has expired.")}return pgettext("banned page","This ban is permanent.")}},{key:"render",value:function(){return(0,i.Z)("div",{className:"page page-error page-error-banned"},void 0,(0,i.Z)("div",{className:"container"},void 0,(0,i.Z)("div",{className:"message-panel"},void 0,a||(a=(0,i.Z)("div",{className:"message-icon"},void 0,(0,i.Z)("span",{className:"material-icon"},void 0,"highlight_off"))),(0,i.Z)("div",{className:"message-body"},void 0,this.getReasonMessage(),(0,i.Z)("p",{className:"message-footnote"},void 0,this.getExpirationMessage())))))}}]),r}(l().Component),g=n(15579),b=n(90287),y=(0,d.$j)((function(e){return e.tick}))(Z);function _(e,t){if(u().render((0,i.Z)(d.zt,{store:b.Z.getStore()},void 0,(0,i.Z)(y,{message:e.message,expires:e.expires_on?s()(e.expires_on):null})),document.getElementById("page-mount")),void 0===t||t){var n=g.Z.get("SETTINGS").forum_name;document.title=pgettext("banned error title","You are banned")+" | "+n,window.history.pushState({},"",g.Z.get("BANNED_URL"))}}},69130:(e,t,n)=>{"use strict";function a(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=[],i=[];if(e.forEach((function(e){i.push(e),i.length===t&&(a.push(i),i=[])})),!1!==n&&i.length>0&&i.length<t)for(var o=i.length;o<t;o++)i.push(n);return i.length&&a.push(i),a}n.d(t,{Z:()=>a})},89759:(e,t,n)=>{"use strict";function a(e,t){var n=[];return e.concat(t).filter((function(e){return-1===n.indexOf(e.id)&&(n.push(e.id),!0)}))}n.d(t,{Z:()=>a})},89627:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i});var a={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#039;"};function i(e){return e.replace(/[&<>"']/g,(function(e){return a[e]}))}},48772:(e,t,n)=>{"use strict";function a(e){return e>1073741824?i(e/1073741824)+" GB":e>1048576?i(e/1048576)+" MB":e>1024?i(e/1024)+" KB":i(e)+" B"}function i(e){return e.toFixed(1)}n.d(t,{Z:()=>a})},54031:(e,t,n)=>{"use strict";n.d(t,{ZP:()=>o});var a="12345678990abcdefghijklmnopqrstuvwxyz",i=a.length;function o(e){for(var t=[],n=0;n<e;n++){var o=Math.floor(Math.random()*i);t.push(a[o])}return t.join("")}},4869:(e,t,n)=>{"use strict";n.d(t,{Z:()=>l});var a=n(22928),i=(n(57588),n(73935)),o=n.n(i),s=n(37424),r=n(90287);function l(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],i=document.getElementById(t),l=e.props?e:(0,a.Z)(e,{});i&&(n?o().render((0,a.Z)(s.zt,{store:r.Z.getStore()},void 0,l),i):o().render(l,i))}},44039:(e,t,n)=>{"use strict";function a(e,t){return Math.floor(Math.random()*(t-e+1))+e}n.d(t,{e:()=>a})},39633:(e,t,n)=>{"use strict";n.d(t,{Z:()=>u});var a=n(22928),i=(n(57588),n(73935)),o=n.n(i),s=n(37424),r=n(69987),l=n(90287),c=document.getElementById("page-mount");function u(e){var t={component:e.component||null,childRoutes:[]};e.root?t.childRoutes=[{path:e.root,onEnter:function(t,n){n(null,e.paths[0].path)}}].concat(e.paths):t.childRoutes=e.paths,o().render((0,a.Z)(s.zt,{store:l.Z.getStore()},void 0,(0,a.Z)(r.F0,{routes:t,history:r.mW})),c)}},55210:(e,t,n)=>{"use strict";n.d(t,{BS:()=>d,C1:()=>s,Do:()=>c,Ei:()=>u,HR:()=>p,Vb:()=>m,fT:()=>r,gS:()=>h,jA:()=>l,lG:()=>v});var a=/^(([^<>()[\]\.,;:\s@\"]+(\.[^<>()[\]\.,;:\s@\"]+)*)|(\".+\"))@(([^<>()[\]\.,;:\s@\"]+\.)+[^<>()[\]\.,;:\s@\"]{2,})$/i,i=new RegExp("^[0-9a-z_]+$","i"),o=new RegExp("[0-9a-z]","i");function s(e){return function(t){if(!1===t||null===t||0===String(t).trim().length)return e||gettext("This field is required.")}}function r(e){var t=pgettext("agreement validator","You have to accept the terms of service.");return s(e||t)}function l(e){var t=pgettext("agreement validator","You have to accept the privacy policy.");return s(e||t)}function c(e){return function(t){if(!a.test(t))return e||pgettext("email validator","Enter a valid e-mail address.")}}function u(e,t){return function(n){var a="",i=n.trim().length;if(i<e)return a=t?t(e,i):npgettext("value length validator","Ensure this value has at least %(limit_value)s character (it has %(show_value)s).","Ensure this value has at least %(limit_value)s characters (it has %(show_value)s).",e),interpolate(a,{limit_value:e,show_value:i},!0)}}function d(e,t){return function(n){var a="",i=n.trim().length;if(i>e)return a=t?t(e,i):npgettext("value length validator","Ensure this value has at most %(limit_value)s character (it has %(show_value)s).","Ensure this value has at most %(limit_value)s characters (it has %(show_value)s).",e),interpolate(a,{limit_value:e,show_value:i},!0)}}function p(e){return u(e,(function(e){return npgettext("username length validator","Username must be at least %(limit_value)s character long.","Username must be at least %(limit_value)s characters long.",e)}))}function h(e){return d(e,(function(e){return npgettext("username length validator","Username cannot be longer than %(limit_value)s character.","Username cannot be longer than %(limit_value)s characters.",e)}))}function v(){return function(e){var t=e.trim();return i.test(t)?o.test(t)?void 0:pgettext("username validator","Username must contain Latin alphabet letters or digits."):pgettext("username validator","Username can only contain Latin alphabet letters, digits, and an underscore sign.")}}function m(e){return function(t){var n=t.length;if(n<e){var a=npgettext("password length validator","Valid password must be at least %(limit_value)s character long.","Valid password must be at least %(limit_value)s characters long.",e);return interpolate(a,{limit_value:e,show_value:n},!0)}}}},46700:(e,t,n)=>{var a={"./af":42786,"./af.js":42786,"./ar":30867,"./ar-dz":14130,"./ar-dz.js":14130,"./ar-kw":96135,"./ar-kw.js":96135,"./ar-ly":56440,"./ar-ly.js":56440,"./ar-ma":47702,"./ar-ma.js":47702,"./ar-sa":16040,"./ar-sa.js":16040,"./ar-tn":37100,"./ar-tn.js":37100,"./ar.js":30867,"./az":31083,"./az.js":31083,"./be":9808,"./be.js":9808,"./bg":68338,"./bg.js":68338,"./bm":67438,"./bm.js":67438,"./bn":8905,"./bn-bd":76225,"./bn-bd.js":76225,"./bn.js":8905,"./bo":11560,"./bo.js":11560,"./br":1278,"./br.js":1278,"./bs":80622,"./bs.js":80622,"./ca":2468,"./ca.js":2468,"./cs":5822,"./cs.js":5822,"./cv":50877,"./cv.js":50877,"./cy":47373,"./cy.js":47373,"./da":24780,"./da.js":24780,"./de":59740,"./de-at":60217,"./de-at.js":60217,"./de-ch":60894,"./de-ch.js":60894,"./de.js":59740,"./dv":5300,"./dv.js":5300,"./el":50837,"./el.js":50837,"./en-au":78348,"./en-au.js":78348,"./en-ca":77925,"./en-ca.js":77925,"./en-gb":22243,"./en-gb.js":22243,"./en-ie":46436,"./en-ie.js":46436,"./en-il":47207,"./en-il.js":47207,"./en-in":44175,"./en-in.js":44175,"./en-nz":76319,"./en-nz.js":76319,"./en-sg":31662,"./en-sg.js":31662,"./eo":92915,"./eo.js":92915,"./es":55655,"./es-do":55251,"./es-do.js":55251,"./es-mx":96112,"./es-mx.js":96112,"./es-us":71146,"./es-us.js":71146,"./es.js":55655,"./et":5603,"./et.js":5603,"./eu":77763,"./eu.js":77763,"./fa":76959,"./fa.js":76959,"./fi":11897,"./fi.js":11897,"./fil":42549,"./fil.js":42549,"./fo":94694,"./fo.js":94694,"./fr":94470,"./fr-ca":63049,"./fr-ca.js":63049,"./fr-ch":52330,"./fr-ch.js":52330,"./fr.js":94470,"./fy":5044,"./fy.js":5044,"./ga":29295,"./ga.js":29295,"./gd":2101,"./gd.js":2101,"./gl":38794,"./gl.js":38794,"./gom-deva":27884,"./gom-deva.js":27884,"./gom-latn":23168,"./gom-latn.js":23168,"./gu":95349,"./gu.js":95349,"./he":24206,"./he.js":24206,"./hi":30094,"./hi.js":30094,"./hr":30316,"./hr.js":30316,"./hu":22138,"./hu.js":22138,"./hy-am":11423,"./hy-am.js":11423,"./id":29218,"./id.js":29218,"./is":90135,"./is.js":90135,"./it":90626,"./it-ch":10150,"./it-ch.js":10150,"./it.js":90626,"./ja":39183,"./ja.js":39183,"./jv":24286,"./jv.js":24286,"./ka":12105,"./ka.js":12105,"./kk":47772,"./kk.js":47772,"./km":18758,"./km.js":18758,"./kn":79282,"./kn.js":79282,"./ko":33730,"./ko.js":33730,"./ku":1408,"./ku.js":1408,"./ky":33291,"./ky.js":33291,"./lb":36841,"./lb.js":36841,"./lo":55466,"./lo.js":55466,"./lt":57010,"./lt.js":57010,"./lv":37595,"./lv.js":37595,"./me":39861,"./me.js":39861,"./mi":35493,"./mi.js":35493,"./mk":95966,"./mk.js":95966,"./ml":87341,"./ml.js":87341,"./mn":5115,"./mn.js":5115,"./mr":10370,"./mr.js":10370,"./ms":9847,"./ms-my":41237,"./ms-my.js":41237,"./ms.js":9847,"./mt":72126,"./mt.js":72126,"./my":56165,"./my.js":56165,"./nb":64924,"./nb.js":64924,"./ne":16744,"./ne.js":16744,"./nl":93901,"./nl-be":59814,"./nl-be.js":59814,"./nl.js":93901,"./nn":83877,"./nn.js":83877,"./oc-lnc":92135,"./oc-lnc.js":92135,"./pa-in":15858,"./pa-in.js":15858,"./pl":64495,"./pl.js":64495,"./pt":89520,"./pt-br":57971,"./pt-br.js":57971,"./pt.js":89520,"./ro":96459,"./ro.js":96459,"./ru":21793,"./ru.js":21793,"./sd":40950,"./sd.js":40950,"./se":10490,"./se.js":10490,"./si":90124,"./si.js":90124,"./sk":64249,"./sk.js":64249,"./sl":14985,"./sl.js":14985,"./sq":51104,"./sq.js":51104,"./sr":49131,"./sr-cyrl":79915,"./sr-cyrl.js":79915,"./sr.js":49131,"./ss":85893,"./ss.js":85893,"./sv":98760,"./sv.js":98760,"./sw":91172,"./sw.js":91172,"./ta":27333,"./ta.js":27333,"./te":23110,"./te.js":23110,"./tet":52095,"./tet.js":52095,"./tg":27321,"./tg.js":27321,"./th":9041,"./th.js":9041,"./tk":19005,"./tk.js":19005,"./tl-ph":75768,"./tl-ph.js":75768,"./tlh":89444,"./tlh.js":89444,"./tr":72397,"./tr.js":72397,"./tzl":28254,"./tzl.js":28254,"./tzm":51106,"./tzm-latn":30699,"./tzm-latn.js":30699,"./tzm.js":51106,"./ug-cn":9288,"./ug-cn.js":9288,"./uk":67691,"./uk.js":67691,"./ur":13795,"./ur.js":13795,"./uz":6791,"./uz-latn":60588,"./uz-latn.js":60588,"./uz.js":6791,"./vi":65666,"./vi.js":65666,"./x-pseudo":14378,"./x-pseudo.js":14378,"./yo":75805,"./yo.js":75805,"./zh-cn":83839,"./zh-cn.js":83839,"./zh-hk":55726,"./zh-hk.js":55726,"./zh-mo":99807,"./zh-mo.js":99807,"./zh-tw":74152,"./zh-tw.js":74152};function i(e){var t=o(e);return n(t)}function o(e){if(!n.o(a,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return a[e]}i.keys=function(){return Object.keys(a)},i.resolve=o,e.exports=i,i.id=46700}},i={};function o(e){var t=i[e];if(void 0!==t)return t.exports;var n=i[e]={id:e,loaded:!1,exports:{}};return a[e].call(n.exports,n,n.exports,o),n.loaded=!0,n.exports}o.m=a,e=[],o.O=(t,n,a,i)=>{if(!n){var s=1/0;for(u=0;u<e.length;u++){for(var[n,a,i]=e[u],r=!0,l=0;l<n.length;l++)(!1&i||s>=i)&&Object.keys(o.O).every((e=>o.O[e](n[l])))?n.splice(l--,1):(r=!1,i<s&&(s=i));if(r){e.splice(u--,1);var c=a();void 0!==c&&(t=c)}}return t}i=i||0;for(var u=e.length;u>0&&e[u-1][2]>i;u--)e[u]=e[u-1];e[u]=[n,a,i]},o.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return o.d(t,{a:t}),t},o.d=(e,t)=>{for(var n in t)o.o(t,n)&&!o.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},o.f={},o.e=e=>Promise.all(Object.keys(o.f).reduce(((t,n)=>(o.f[n](e,t),t)),[])),o.u=e=>"hljs.js",o.miniCssF=e=>{},o.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),o.hmd=e=>((e=Object.create(e)).children||(e.children=[]),Object.defineProperty(e,"exports",{enumerable:!0,set:()=>{throw new Error("ES Modules may not assign module.exports or exports.*, Use ESM export syntax, instead: "+e.id)}}),e),o.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),t={},n="misago:",o.l=(e,a,i,s)=>{if(t[e])t[e].push(a);else{var r,l;if(void 0!==i)for(var c=document.getElementsByTagName("script"),u=0;u<c.length;u++){var d=c[u];if(d.getAttribute("src")==e||d.getAttribute("data-webpack")==n+i){r=d;break}}r||(l=!0,(r=document.createElement("script")).charset="utf-8",r.timeout=120,o.nc&&r.setAttribute("nonce",o.nc),r.setAttribute("data-webpack",n+i),r.src=e),t[e]=[a];var p=(n,a)=>{r.onerror=r.onload=null,clearTimeout(h);var i=t[e];if(delete t[e],r.parentNode&&r.parentNode.removeChild(r),i&&i.forEach((e=>e(a))),n)return n(a)},h=setTimeout(p.bind(null,void 0,{type:"timeout",target:r}),12e4);r.onerror=p.bind(null,r.onerror),r.onload=p.bind(null,r.onload),l&&document.head.appendChild(r)}},o.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.nmd=e=>(e.paths=[],e.children||(e.children=[]),e),(()=>{var e;o.g.importScripts&&(e=o.g.location+"");var t=o.g.document;if(!e&&t&&(t.currentScript&&(e=t.currentScript.src),!e)){var n=t.getElementsByTagName("script");n.length&&(e=n[n.length-1].src)}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),o.p=e})(),(()=>{var e={174:0};o.f.j=(t,n)=>{var a=o.o(e,t)?e[t]:void 0;if(0!==a)if(a)n.push(a[2]);else{var i=new Promise(((n,i)=>a=e[t]=[n,i]));n.push(a[2]=i);var s=o.p+o.u(t),r=new Error;o.l(s,(n=>{if(o.o(e,t)&&(0!==(a=e[t])&&(e[t]=void 0),a)){var i=n&&("load"===n.type?"missing":n.type),s=n&&n.target&&n.target.src;r.message="Loading chunk "+t+" failed.\n("+i+": "+s+")",r.name="ChunkLoadError",r.type=i,r.request=s,a[1](r)}}),"chunk-"+t,t)}},o.O.j=t=>0===e[t];var t=(t,n)=>{var a,i,[s,r,l]=n,c=0;if(s.some((t=>0!==e[t]))){for(a in r)o.o(r,a)&&(o.m[a]=r[a]);if(l)var u=l(o)}for(t&&t(n);c<s.length;c++)i=s[c],o.o(e,i)&&e[i]&&e[i][0](),e[i]=0;return o.O(u)},n=self.webpackChunkmisago=self.webpackChunkmisago||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})(),o.O(void 0,[736],(()=>o(15579))),o.O(void 0,[736],(()=>o(58339))),o.O(void 0,[736],(()=>o(64109))),o.O(void 0,[736],(()=>o(46226))),o.O(void 0,[736],(()=>o(93240))),o.O(void 0,[736],(()=>o(75147))),o.O(void 0,[736],(()=>o(4894))),o.O(void 0,[736],(()=>o(29223))),o.O(void 0,[736],(()=>o(73806))),o.O(void 0,[736],(()=>o(27015))),o.O(void 0,[736],(()=>o(88097))),o.O(void 0,[736],(()=>o(46016))),o.O(void 0,[736],(()=>o(32488))),o.O(void 0,[736],(()=>o(11768))),o.O(void 0,[736],(()=>o(61323))),o.O(void 0,[736],(()=>o(64752))),o.O(void 0,[736],(()=>o(40949))),o.O(void 0,[736],(()=>o(78679))),o.O(void 0,[736],(()=>o(61814))),o.O(void 0,[736],(()=>o(95920))),o.O(void 0,[736],(()=>o(44095))),o.O(void 0,[736],(()=>o(63290))),o.O(void 0,[736],(()=>o(77031))),o.O(void 0,[736],(()=>o(97751))),o.O(void 0,[736],(()=>o(76093))),o.O(void 0,[736],(()=>o(87336))),o.O(void 0,[736],(()=>o(47549))),o.O(void 0,[736],(()=>o(22331))),o.O(void 0,[736],(()=>o(21513))),o.O(void 0,[736],(()=>o(98749))),o.O(void 0,[736],(()=>o(98251))),o.O(void 0,[736],(()=>o(6720))),o.O(void 0,[736],(()=>o(66806))),o.O(void 0,[736],(()=>o(10846))),o.O(void 0,[736],(()=>o(18255))),o.O(void 0,[736],(()=>o(14113))),o.O(void 0,[736],(()=>o(24444))),o.O(void 0,[736],(()=>o(1764))),o.O(void 0,[736],(()=>o(68351))),o.O(void 0,[736],(()=>o(81521))),o.O(void 0,[736],(()=>o(68585))),o.O(void 0,[736],(()=>o(41229))),o.O(void 0,[736],(()=>o(43589))),o.O(void 0,[736],(()=>o(62894))),o.O(void 0,[736],(()=>o(33934))),o.O(void 0,[736],(()=>o(85577))),o.O(void 0,[736],(()=>o(83526))),o.O(void 0,[736],(()=>o(43060))),o.O(void 0,[736],(()=>o(92292))),o.O(void 0,[736],(()=>o(33409)));var s=o.O(void 0,[736],(()=>o(31341)));s=o.O(s)})();
//# sourceMappingURL=misago.js.map