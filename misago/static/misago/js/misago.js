!function(){var e,t,s,a={98936:function(e,t,s){"use strict";s.d(t,{gq:function(){return n},Z6:function(){return r},kw:function(){return l}});var a=s(22928),i=s(94184),o=s.n(i);s(57588);var n=e=>{let{children:t,className:s}=e;return(0,a.Z)("div",{className:o()("flex-row",s)},void 0,t)},r=e=>{let{children:t,className:s,shrink:i}=e;return(0,a.Z)("div",{className:o()("flex-row-col",s,{"flex-row-col-shrink":i})},void 0,t)},l=e=>{let{auto:t,children:s,className:i}=e;return(0,a.Z)("div",{className:o()("flex-row-section",{"flex-row-section-auto":t},i)},void 0,s)}},59131:function(e,t,s){"use strict";var a=s(22928);s(57588),t.Z=e=>{let{children:t}=e;return(0,a.Z)("div",{className:"container page-container"},void 0,t)}},99755:function(e,t,s){"use strict";s.d(t,{mr:function(){return r},gC:function(){return l},sP:function(){return d},eA:function(){return c},Ql:function(){return p},bM:function(){return u},Iv:function(){return h}});var a,i=s(22928),o=s(94184),n=s.n(o);s(57588);var r=e=>{let{children:t,className:s,styleName:o}=e;return(0,i.Z)("div",{className:n()("page-header",s,o&&"page-header-"+o)},void 0,(0,i.Z)("div",{className:"page-header-bg-image"},void 0,(0,i.Z)("div",{className:"page-header-bg-overlay"},void 0,a||(a=(0,i.Z)("div",{className:"page-header-image"})),t)))},l=e=>{let{children:t,className:s,styleName:a}=e;return(0,i.Z)("div",{className:n()("page-header-banner",s,a&&"page-header-banner-"+a)},void 0,(0,i.Z)("div",{className:"page-header-banner-bg-image"},void 0,(0,i.Z)("div",{className:"page-header-banner-bg-overlay"},void 0,t)))},d=e=>{let{children:t}=e;return(0,i.Z)("div",{className:"container page-header-container"},void 0,t)},c=e=>{let{children:t,className:s}=e;return(0,i.Z)("div",{className:n()("page-header-details",s)},void 0,t)},p=e=>{let{className:t,message:s}=e;return(0,i.Z)("div",{className:n()("page-header-message",t),dangerouslySetInnerHTML:{__html:s}})},u=e=>{let{children:t,className:s}=e;return(0,i.Z)("div",{className:n()("page-header-message",s)},void 0,t)},h=e=>{let{styleName:t,header:s,message:a}=e;return(0,i.Z)(d,{},void 0,(0,i.Z)(r,{styleName:t},void 0,(0,i.Z)(l,{styleName:t},void 0,(0,i.Z)("h1",{},void 0,s)),a&&(0,i.Z)(c,{styleName:t},void 0,a)))}},26106:function(e,t,s){"use strict";var a=s(22928),i=(s(57588),s(32233)),o=s(89627);const n=e=>{const{agreement:t,checked:s,errors:i,url:n,value:r,onChange:l}=e;if(!n)return null;const d=interpolate('<a href="%(url)s" target="_blank">%(agreement)s</a>',{agreement:(0,o.Z)(t),url:(0,o.Z)(n)},!0),c=interpolate(gettext("I have read and accept %(agreement)s."),{agreement:d},!0);return(0,a.Z)("div",{className:"checkbox legal-footnote"},void 0,(0,a.Z)("label",{},void 0,(0,a.Z)("input",{checked:s,type:"checkbox",value:r,onChange:l}),(0,a.Z)("span",{dangerouslySetInnerHTML:{__html:c}})),i&&i.map(((e,t)=>(0,a.Z)("div",{className:"help-block errors"},t,e))))};t.Z=e=>{const{errors:t,privacyPolicy:s,termsOfService:o,onPrivacyPolicyChange:r,onTermsOfServiceChange:l}=e,d=i.Z.get("TERMS_OF_SERVICE_ID"),c=i.Z.get("TERMS_OF_SERVICE_URL"),p=i.Z.get("PRIVACY_POLICY_ID"),u=i.Z.get("PRIVACY_POLICY_URL");return d||p?(0,a.Z)("div",{},void 0,(0,a.Z)(n,{agreement:gettext("the terms of service"),checked:null!==o,errors:t.termsOfService,url:c,value:d,onChange:l}),(0,a.Z)(n,{agreement:gettext("the privacy policy"),checked:null!==s,errors:t.privacyPolicy,url:u,value:p,onChange:r})):null}},47235:function(e,t,s){"use strict";var a,i=s(22928),o=(s(57588),s(32233));const n=e=>{let{className:t,text:s}=e;return s?(0,i.Z)("h5",{className:t||""},void 0,s):null};t.Z=e=>{const{buttonClassName:t,buttonLabel:s,formLabel:r,header:l,labelClassName:d}=e,c=o.Z.get("SOCIAL_AUTH");return 0===c.length?null:(0,i.Z)("div",{className:"form-group form-social-auth"},void 0,(0,i.Z)(n,{className:d,text:l}),(0,i.Z)("div",{className:"row"},void 0,c.map((e=>{let{id:a,name:o,button_text:n,button_color:r,url:l}=e;const d="btn btn-block btn-default btn-social-"+a,c=r?{color:r}:null,p=n||interpolate(s,{site:o},!0);return(0,i.Z)("div",{className:t||"col-xs-12"},a,(0,i.Z)("a",{className:d,style:c,href:l},void 0,p))}))),a||(a=(0,i.Z)("hr",{})),(0,i.Z)(n,{className:d,text:r}))}},50366:function(e,t,s){"use strict";var a,i,o,n,r,l,d,c=s(22928);s(57588),t.Z=e=>{let{thread:t}=e;return(0,c.Z)("ul",{className:"thread-flags"},void 0,2==t.weight&&(0,c.Z)("li",{className:"thread-flag-pinned-globally",title:gettext("Pinned globally")},void 0,a||(a=(0,c.Z)("span",{className:"material-icon"},void 0,"bookmark"))),1==t.weight&&(0,c.Z)("li",{className:"thread-flag-pinned-locally",title:gettext("Pinned in category")},void 0,i||(i=(0,c.Z)("span",{className:"material-icon"},void 0,"bookmark_outline"))),t.best_answer&&(0,c.Z)("li",{className:"thread-flag-answered",title:gettext("Answered")},void 0,o||(o=(0,c.Z)("span",{className:"material-icon"},void 0,"check_circle"))),t.has_poll&&(0,c.Z)("li",{className:"thread-flag-poll",title:gettext("Poll")},void 0,n||(n=(0,c.Z)("span",{className:"material-icon"},void 0,"poll"))),(t.is_unapproved||t.has_unapproved_posts)&&(0,c.Z)("li",{className:"thread-flag-unapproved",title:t.is_unapproved?gettext("Awaiting approval"):gettext("Has unapproved posts")},void 0,r||(r=(0,c.Z)("span",{className:"material-icon"},void 0,"visibility"))),t.is_closed&&(0,c.Z)("li",{className:"thread-flag-closed",title:gettext("Closed")},void 0,l||(l=(0,c.Z)("span",{className:"material-icon"},void 0,"lock"))),t.is_hidden&&(0,c.Z)("li",{className:"thread-flag-hidden",title:gettext("Hidden")},void 0,d||(d=(0,c.Z)("span",{className:"material-icon"},void 0,"visibility_off"))))}},16768:function(e,t,s){"use strict";var a,i=s(22928);s(57588),t.Z=e=>{let{thread:t}=e;return(0,i.Z)("span",{className:"threads-replies",title:interpolate(ngettext("%(replies)s reply","%(replies)s replies",t.replies),{replies:t.replies},!0)},void 0,a||(a=(0,i.Z)("span",{className:"material-icon"},void 0,"chat_bubble_outline")),t.replies>980?Math.round(t.replies/1e3)+"K":t.replies)}},92490:function(e,t,s){"use strict";s.d(t,{o8:function(){return n},Eg:function(){return r},Z2:function(){return l},tw:function(){return d}});var a=s(22928),i=s(94184),o=s.n(i);s(57588);var n=e=>{let{children:t,className:s}=e;return(0,a.Z)("nav",{className:o()("toolbar",s)},void 0,t)},r=e=>{let{children:t,className:s,shrink:i}=e;return(0,a.Z)("div",{className:o()("toolbar-item",s,{"toolbar-item-shrink":i})},void 0,t)},l=e=>{let{auto:t,children:s,className:i}=e;return(0,a.Z)("div",{className:o()("toolbar-section",{"toolbar-section-auto":t},i)},void 0,s)},d=e=>{let{className:t}=e;return(0,a.Z)("div",{className:o()("toolbar-spacer",t)})}},19605:function(e,t,s){"use strict";s.d(t,{ZP:function(){return o}});var a=s(22928),i=(s(57588),s(32233));function o(e){const t=e.size||100,s=e.size2x||t;return(0,a.Z)("img",{alt:"",className:e.className||"user-avatar",src:n(e.user,t),srcSet:n(e.user,s),width:t,height:t})}function n(e,t){return e&&e.id?function(e,t){let s=e[0];return e.forEach((e=>{e.size>=t&&(s=e)})),s}(e.avatars,t).url:i.Z.get("BLANK_AVATAR_URL")}},82211:function(e,t,s){"use strict";s.d(t,{Z:function(){return l}});var a,i=s(22928),o=s(57588),n=s.n(o),r=s(37848);class l extends n().Component{render(){let e="btn "+this.props.className,t=this.props.disabled;return this.props.loading&&(e+=" btn-loading",t=!0),(0,i.Z)("button",{className:e,disabled:t,onClick:this.props.onClick,type:this.props.onClick?"button":"submit"},void 0,this.props.children,this.props.loading?a||(a=(0,i.Z)(r.Z,{})):null)}}l.defaultProps={className:"btn-default",type:"submit",loading:!1,disabled:!1,onClick:null}},57026:function(e,t,s){"use strict";s.d(t,{Z:function(){return i}});var a=s(22928);function i(e){return(0,a.Z)("select",{className:e.className||"form-control",disabled:e.disabled||!1,id:e.id||null,onChange:e.onChange,value:e.value},void 0,e.choices.map((e=>(0,a.Z)("option",{disabled:e.disabled||!1,value:e.value},e.value,"- - ".repeat(e.level)+e.label))))}s(57588)},21688:function(e,t,s){"use strict";s.d(t,{Z:function(){return x}});var a=s(22928),i=s(57588),o=s.n(i),n=s(33556);function r(e){let{display:t}=e;return t?(0,a.Z)(n.Z,{helpText:gettext("No profile details are editable at this time."),message:gettext("This option is currently unavailable.")}):null}var l,d=s(37848);function c(e){let{display:t}=e;return t?l||(l=(0,a.Z)("div",{className:"panel-body"},void 0,(0,a.Z)(d.Z,{}))):null}var p=s(4942),u=s(60471),h=class extends o().Component{constructor(){super(...arguments),(0,p.Z)(this,"onChange",(e=>{const{field:t,onChange:s}=this.props;s(t.fieldname,e.target.value)}))}render(){const{disabled:e,field:t,value:s}=this.props,{input:i}=t;return"select"===i.type?(0,a.Z)(u.Z,{choices:i.choices,disabled:e,id:"id_"+t.fieldname,onChange:this.onChange,value:s}):"textarea"===i.type?(0,a.Z)("textarea",{className:"form-control",disabled:e,id:"id_"+t.fieldname,onChange:this.onChange,rows:"4",type:"text",value:s}):"text"===i.type?(0,a.Z)("input",{className:"form-control",disabled:e,id:"id_"+t.fieldname,onChange:this.onChange,type:"text",value:s}):null}},m=s(96359);function v(e){let{disabled:t,errors:s,fields:i,name:o,onChange:n,value:r}=e;return(0,a.Z)("fieldset",{},void 0,(0,a.Z)("legend",{},void 0,o),i.map((e=>(0,a.Z)(m.Z,{for:"id_"+e.fieldname,helpText:e.help_text,label:e.label,validation:s[e.fieldname]},e.fieldname,(0,a.Z)(h,{disabled:t,field:e,onChange:n,value:r[e.fieldname]})))))}var g=s(82211),Z=s(43345),b=s(78657),f=s(53904),_=class extends Z.Z{constructor(e){super(e),(0,p.Z)(this,"onChange",((e,t)=>{this.setState({[e]:t})})),this.state={isLoading:!1,errors:{}};const t=e.groups.length;for(let s=0;s<t;s++){const t=e.groups[s],a=t.fields.length;for(let e=0;e<a;e++){const s=t.fields[e].fieldname,a=t.fields[e].initial;this.state[s]=a}}}send(){const e=Object.assign({},this.state,{errors:null,isLoading:null});return b.Z.post(this.props.api,e)}handleSuccess(e){this.props.onSuccess(e)}handleError(e){400===e.status?(f.Z.error(gettext("Form contains errors.")),this.setState({errors:e})):f.Z.apiError(e)}render(){return(0,a.Z)("form",{onSubmit:this.handleSubmit},void 0,(0,a.Z)("div",{className:"panel-body"},void 0,this.props.groups.map(((e,t)=>(0,a.Z)(v,{disabled:this.state.isLoading,errors:this.state.errors,fields:e.fields,name:e.name,onChange:this.onChange,value:this.state},t)))),(0,a.Z)("div",{className:"panel-footer text-right"},void 0,(0,a.Z)(N,{disabled:this.state.isLoading,onCancel:this.props.onCancel})," ",(0,a.Z)(g.Z,{className:"btn-primary",loading:this.state.isLoading},void 0,gettext("Save changes"))))}};function N(e){let{onCancel:t,disabled:s}=e;return t?(0,a.Z)("button",{className:"btn btn-default",disabled:s,onClick:t,type:"button"},void 0,gettext("Cancel")):null}var x=class extends o().Component{constructor(e){super(e),this.state={loading:!0,groups:null}}componentDidMount(){b.Z.get(this.props.api).then((e=>{this.setState({loading:!1,groups:e})}),(e=>{f.Z.apiError(e),this.props.cancel&&this.props.cancel()}))}render(){const{groups:e,loading:t}=this.state;return(0,a.Z)("div",{className:"panel panel-default panel-form"},void 0,(0,a.Z)("div",{className:"panel-heading"},void 0,(0,a.Z)("h3",{className:"panel-title"},void 0,gettext("Edit details"))),(0,a.Z)(c,{display:t}),(0,a.Z)(r,{display:!t&&!e.length}),(0,a.Z)(y,{api:this.props.api,display:!t&&e.length,groups:e,onCancel:this.props.onCancel,onSuccess:this.props.onSuccess}))}};function y(e){let{api:t,display:s,groups:i,onCancel:o,onSuccess:n}=e;return s?(0,a.Z)(_,{api:t,groups:i,onCancel:o,onSuccess:n}):null}},96359:function(e,t,s){"use strict";var a=s(22928),i=s(57588),o=s.n(i);t.Z=class extends o().Component{isValidated(){return void 0!==this.props.validation}getClassName(){let e="form-group";return this.isValidated()&&(e+=" has-feedback",null===this.props.validation?e+=" has-success":e+=" has-error"),e}getFeedback(){return this.props.validation?(0,a.Z)("div",{className:"help-block errors"},void 0,this.props.validation.map(((e,t)=>(0,a.Z)("p",{},this.props.for+"FeedbackItem"+t,e)))):null}getFeedbackDescription(){return this.isValidated()?(0,a.Z)("span",{id:this.props.for+"_status",className:"sr-only"},void 0,this.props.validation?gettext("(error)"):gettext("(success)")):null}getHelpText(){return this.props.helpText?(0,a.Z)("p",{className:"help-block"},void 0,this.props.helpText):null}render(){return(0,a.Z)("div",{className:this.getClassName()},void 0,(0,a.Z)("label",{className:"control-label "+(this.props.labelClass||""),htmlFor:this.props.for||""},void 0,this.props.label+":"),(0,a.Z)("div",{className:this.props.controlClass||""},void 0,this.props.children,this.getFeedbackDescription(),this.getFeedback(),this.getHelpText(),this.props.extra||null))}}},43345:function(e,t,s){"use strict";var a=s(4942),i=s(57588),o=s.n(i),n=s(55210),r=s(53904);let l=(0,n.C1)();t.Z=class extends o().Component{constructor(){super(...arguments),(0,a.Z)(this,"bindInput",(e=>t=>{this.changeValue(e,t.target.value)})),(0,a.Z)(this,"changeValue",((e,t)=>{let s={[e]:t};const a=this.state.errors||{};a[e]=this.validateField(e,s[e]),s.errors=a,this.setState(s)})),(0,a.Z)(this,"handleSubmit",(e=>{if(e&&e.preventDefault(),!this.state.isLoading&&this.clean()){this.setState({isLoading:!0});let e=this.send();e?e.then((e=>{this.setState({isLoading:!1}),this.handleSuccess(e)}),(e=>{this.setState({isLoading:!1}),this.handleError(e)})):this.setState({isLoading:!1})}}))}validate(){let e={};if(!this.state.validators)return e;let t={required:this.state.validators.required||this.state.validators,optional:this.state.validators.optional||{}},s=[];for(let e in t.required)t.required.hasOwnProperty(e)&&t.required[e]&&s.push(e);for(let e in t.optional)t.optional.hasOwnProperty(e)&&t.optional[e]&&s.push(e);for(let t in s){let a=s[t],i=this.validateField(a,this.state[a]);null===i?e[a]=null:i&&(e[a]=i)}return e}isValid(){let e=this.validate();for(let t in e)if(e.hasOwnProperty(t)&&null!==e[t])return!1;return!0}validateField(e,t){let s=[];if(!this.state.validators)return s;let a={required:(this.state.validators.required||this.state.validators)[e],optional:(this.state.validators.optional||{})[e]},i=l(t)||!1;if(a.required){if(i)s=[i];else for(let e in a.required){let i=a.required[e](t);i&&s.push(i)}return s.length?s:null}if(!1===i&&a.optional){for(let e in a.optional){let i=a.optional[e](t);i&&s.push(i)}return s.length?s:null}return!1}clean(){return!0}send(){return null}handleSuccess(e){}handleError(e){r.Z.apiError(e)}}},94417:function(e,t,s){"use strict";var a=s(22928),i=s(57588),o=s.n(i);t.Z=class extends o().Component{isActive(){return this.props.isControlled?this.props.isActive:!!this.props.path&&0===document.location.pathname.indexOf(this.props.path)}getClassName(){return this.isActive()?(this.props.className||"")+" "+(this.props.activeClassName||"active"):this.props.className||""}render(){return(0,a.Z)("li",{className:this.getClassName()},void 0,this.props.children)}}},37848:function(e,t,s){"use strict";s.d(t,{Z:function(){return o}});var a,i=s(22928);function o(e){return(0,i.Z)("div",{className:e.className||"loader"},void 0,a||(a=(0,i.Z)("div",{className:"loader-spinning-wheel"})))}s(57588)},52753:function(e,t,s){"use strict";var a,i=s(22928),o=s(4942),n=(s(57588),s(82211)),r=s(43345),l=s(96359),d=s(78657),c=s(59801);function p(e){let{choices:t,onChange:s,value:a}=e;return t?(0,i.Z)(l.Z,{label:gettext("Best answer"),helpText:gettext("Please select the best answer for your newly merged thread. No posts will be deleted during the merge."),for:"id_best_answer"},void 0,(0,i.Z)("select",{className:"form-control",id:"id_best_answer",onChange:s,value:a},void 0,t.map((e=>(0,i.Z)("option",{value:e[0]},e[0],e[1]))))):null}function u(e){let{choices:t,onChange:s,value:a}=e;return t?(0,i.Z)(l.Z,{label:gettext("Poll"),helpText:gettext("Please select the poll for your newly merged thread. Rejected polls will be permanently deleted and cannot be recovered."),for:"id_poll"},void 0,(0,i.Z)("select",{className:"form-control",id:"id_poll",onChange:s,value:a},void 0,t.map((e=>(0,i.Z)("option",{value:e[0]},e[0],e[1]))))):null}t.ZP=class extends r.Z{constructor(e){super(e),(0,o.Z)(this,"handleSuccess",(e=>{this.props.onSuccess(e),c.Z.hide()})),(0,o.Z)(this,"handleError",(e=>{this.props.onError(e)})),(0,o.Z)(this,"onBestAnswerChange",(e=>{this.changeValue("bestAnswer",e.target.value)})),(0,o.Z)(this,"onPollChange",(e=>{this.changeValue("poll",e.target.value)})),this.state={isLoading:!1,bestAnswer:"0",poll:"0"}}clean(){return!this.props.polls||"0"!==this.state.poll||window.confirm(gettext("Are you sure you want to delete all polls?"))}send(){const e=Object.assign({},this.props.data,{best_answer:this.state.bestAnswer,poll:this.state.poll});return d.Z.post(this.props.api,e)}render(){return(0,i.Z)("div",{className:"modal-dialog",role:"document"},void 0,(0,i.Z)("div",{className:"modal-content"},void 0,(0,i.Z)("div",{className:"modal-header"},void 0,(0,i.Z)("button",{"aria-label":pgettext("modal","Close"),className:"close","data-dismiss":"modal",type:"button"},void 0,a||(a=(0,i.Z)("span",{"aria-hidden":"true"},void 0,"×"))),(0,i.Z)("h4",{className:"modal-title"},void 0,gettext("Merge threads"))),(0,i.Z)("form",{onSubmit:this.handleSubmit},void 0,(0,i.Z)("div",{className:"modal-body"},void 0,(0,i.Z)(p,{choices:this.props.bestAnswers,onChange:this.onBestAnswerChange,value:this.state.bestAnswer}),(0,i.Z)(u,{choices:this.props.polls,onChange:this.onPollChange,value:this.state.poll})),(0,i.Z)("div",{className:"modal-footer"},void 0,(0,i.Z)("button",{className:"btn btn-default","data-dismiss":"modal",disabled:this.state.isLoading,type:"button"},void 0,gettext("Cancel")),(0,i.Z)(n.Z,{className:"btn-primary",loading:this.state.isLoading},void 0,gettext("Merge threads"))))))}}},69092:function(e,t,s){"use strict";s.d(t,{Z:function(){return h}});var a=s(94184),i=s.n(a),o=s(57588),n=s.n(o),r=s(4942),l=s(19755);const d=new RegExp("^.*(?:(?:youtu.be/|v/|vi/|u/w/|embed/)|(?:(?:watch)??v(?:i)?=|&v(?:i)?=))([^#&?]*).*");var c=new class{constructor(){(0,r.Z)(this,"render",(e=>{e&&(this.highlightCode(e),this.embedYoutubePlayers(e))})),this._youtube={}}highlightCode(e){s.e(417).then(s.bind(s,15739)).then((t=>{let{default:s}=t;const a=e.querySelectorAll("pre>code");for(let e=0;e<a.length;e++)s.highlightElement(a[e])}))}embedYoutubePlayers(e){const t=e.querySelectorAll("p>a");for(let e=0;e<t.length;e++){const s=t[e],a=1===s.parentNode.childNodes.length;this._youtube[s.href]||(this._youtube[s.href]=p(s.href));const i=this._youtube[s.href];a&&i&&!1!==i.data&&this.swapYoutubePlayer(s,i)}}swapYoutubePlayer(e,t){let s="https://www.youtube.com/embed/";s+=t.video,s+="?feature=oembed",t.start&&(s+="&start="+t.start);const a=l('<iframe class="embed-responsive-item" frameborder="0" src="'+s+'" allow="encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>');l(e).replaceWith(a),a.wrap('<div class="embed-responsive embed-responsive-16by9"></div>')}};function p(e){const t=function(e){let t=e;return"https://"===e.substr(0,8)?t=t.substr(8):"http://"===e.substr(0,7)&&(t=t.substr(7)),"www."===t.substr(0,4)&&(t=t.substr(4)),t}(e),s=function(e){if(-1===e.indexOf("youtu"))return null;const t=e.match(d);return t?t[1]:null}(t);if(!s)return null;let a=0;if(t.indexOf("?")>0){const e=t.substr(t.indexOf("?")+1).split("&").filter((e=>"t="===e.substr(0,2)))[0];if(e){const t=e.substr(2).split("m");"s"===t[0].substr(-1)?a+=parseInt(t[0].substr(0,t[0].length-1)):(a+=60*parseInt(t[0]),t[1]&&"s"===t[1].substr(-1)&&(a+=parseInt(t[1].substr(0,t[1].length-1))))}}return{start:a,video:s}}var u=s(19755),h=class extends n().Component{componentDidMount(){c.render(this.documentNode),u(this.documentNode).find(".spoiler-reveal").click(m)}componentDidUpdate(e,t){c.render(this.documentNode),u(this.documentNode).find(".spoiler-reveal").click(m)}shouldComponentUpdate(e,t){return e.markup!==this.props.markup}render(){return n().createElement("article",{className:i()("misago-markup",this.props.className),dangerouslySetInnerHTML:{__html:this.props.markup},"data-author":this.props.author||void 0,ref:e=>{this.documentNode=e}})}};function m(e){var t=e.target;u(t).parent().parent().addClass("revealed")}},3784:function(e,t,s){"use strict";var a,i=s(22928),o=s(57588),n=s.n(o),r=s(37848);t.Z=class extends n().Component{render(){return a||(a=(0,i.Z)("div",{className:"modal-body modal-loader"},void 0,(0,i.Z)(r.Z,{})))}}},30337:function(e,t,s){"use strict";var a=s(22928),i=(s(57588),s(33556));t.Z=class extends i.Z{getHelpText(){return this.props.helpText?(0,a.Z)("p",{className:"help-block"},void 0,this.props.helpText):null}render(){return(0,a.Z)("div",{className:"modal-body"},void 0,(0,a.Z)("div",{className:"message-icon"},void 0,(0,a.Z)("span",{className:"material-icon"},void 0,this.props.icon||"info_outline")),(0,a.Z)("div",{className:"message-body"},void 0,(0,a.Z)("p",{className:"lead"},void 0,this.props.message),this.getHelpText(),(0,a.Z)("button",{className:"btn btn-default","data-dismiss":"modal",type:"button"},void 0,gettext("Ok"))))}}},95187:function(e,t,s){"use strict";var a,i=s(22928),o=s(57588),n=s.n(o),r=s(37848);t.Z=class extends n().Component{render(){return a||(a=(0,i.Z)("div",{className:"panel-body panel-body-loading"},void 0,(0,i.Z)(r.Z,{className:"loader loader-spaced"})))}}},33556:function(e,t,s){"use strict";var a=s(22928),i=s(57588),o=s.n(i);t.Z=class extends o().Component{getHelpText(){return this.props.helpText?(0,a.Z)("p",{className:"help-block"},void 0,this.props.helpText):null}render(){return(0,a.Z)("div",{className:"panel-body panel-message-body"},void 0,(0,a.Z)("div",{className:"message-icon"},void 0,(0,a.Z)("span",{className:"material-icon"},void 0,this.props.icon||"info_outline")),(0,a.Z)("div",{className:"message-body"},void 0,(0,a.Z)("p",{className:"lead"},void 0,this.props.message),this.getHelpText()))}}},11005:function(e,t,s){"use strict";s.d(t,{Z:function(){return w}});var a=s(22928),i=s(57588),o=s.n(i),n=s(69092);function r(e){return e.post.content?o().createElement(l,e):o().createElement(d,e)}function l(e){return(0,a.Z)("div",{className:"post-body"},void 0,(0,a.Z)(n.Z,{markup:e.post.content}))}function d(e){return(0,a.Z)("div",{className:"post-body post-body-invalid"},void 0,(0,a.Z)("p",{className:"lead"},void 0,gettext("This post's contents cannot be displayed.")),(0,a.Z)("p",{className:"text-muted"},void 0,gettext("This error is caused by invalid post content manipulation.")))}function c(e){let{post:t}=e;const{category:s,thread:i}=t,o=interpolate(gettext("posted %(posted_on)s"),{posted_on:t.posted_on.format("LL, LT")},!0);return(0,a.Z)("div",{className:"post-heading"},void 0,(0,a.Z)("a",{className:"btn btn-link item-title",href:i.url},void 0,i.title),(0,a.Z)("a",{className:"btn btn-link post-category",href:s.url.index},void 0,s.name),(0,a.Z)("a",{href:t.url.index,className:"btn btn-link posted-on",title:o},void 0,t.posted_on.fromNow()))}var p,u,h=s(19605);function m(e){let{post:t}=e;return(0,a.Z)("a",{className:"btn btn-default btn-icon pull-right",href:t.url.index},void 0,(0,a.Z)("span",{className:"btn-text-left hidden-xs"},void 0,gettext("See post")),p||(p=(0,a.Z)("span",{className:"material-icon"},void 0,"chevron_right")))}function v(e){let{post:t}=e;return(0,a.Z)("div",{className:"post-side post-side-anonymous"},void 0,(0,a.Z)(m,{post:t}),(0,a.Z)("div",{className:"media"},void 0,u||(u=(0,a.Z)("div",{className:"media-left"},void 0,(0,a.Z)("span",{},void 0,(0,a.Z)(h.ZP,{className:"poster-avatar",size:50})))),(0,a.Z)("div",{className:"media-body"},void 0,(0,a.Z)("div",{className:"media-heading"},void 0,(0,a.Z)("span",{className:"item-title"},void 0,t.poster_name)),(0,a.Z)("span",{className:"user-title user-title-anonymous"},void 0,gettext("Removed user")))))}function g(e){let{rank:t,title:s}=e,i=s||t.title||t.name,o="user-title";return t.css_class&&(o+=" user-title-"+t.css_class),t.is_tab?(0,a.Z)("a",{className:o,href:t.url},void 0,i):(0,a.Z)("span",{className:o},void 0,i)}function Z(e){let{post:t,poster:s}=e;return(0,a.Z)("div",{className:"post-side post-side-registered"},void 0,(0,a.Z)(m,{post:t}),(0,a.Z)("div",{className:"media"},void 0,(0,a.Z)("div",{className:"media-left"},void 0,(0,a.Z)("a",{href:s.url},void 0,(0,a.Z)(h.ZP,{className:"poster-avatar",size:50,user:s}))),(0,a.Z)("div",{className:"media-body"},void 0,(0,a.Z)("div",{className:"media-heading"},void 0,(0,a.Z)("a",{className:"item-title",href:s.url},void 0,s.username)),(0,a.Z)(g,{title:s.title,rank:s.rank}))))}function b(e){let{post:t,poster:s}=e;return s&&s.id?(0,a.Z)(Z,{post:t,poster:s}):(0,a.Z)(v,{post:t})}function f(e){let{post:t,poster:s}=e;const i=s||t.poster;let o="post";return i&&i.rank.css_class&&(o+=" post-"+i.rank.css_class),(0,a.Z)("li",{className:o,id:"post-"+t.id},void 0,(0,a.Z)("div",{className:"panel panel-default panel-post"},void 0,(0,a.Z)("div",{className:"panel-body"},void 0,(0,a.Z)("div",{className:"panel-content"},void 0,(0,a.Z)(b,{post:t,poster:i}),(0,a.Z)(c,{post:t}),(0,a.Z)(r,{post:t})))))}var _,N,x=s(44039);function y(){return(0,a.Z)("ul",{className:"posts-list post-feed ui-preview"},void 0,(0,a.Z)("li",{className:"post"},void 0,(0,a.Z)("div",{className:"panel panel-default panel-post"},void 0,(0,a.Z)("div",{className:"panel-body"},void 0,(0,a.Z)("div",{className:"panel-content"},void 0,(0,a.Z)("div",{className:"post-side post-side-anonymous"},void 0,(0,a.Z)("div",{className:"media"},void 0,_||(_=(0,a.Z)("div",{className:"media-left"},void 0,(0,a.Z)("span",{},void 0,(0,a.Z)(h.ZP,{className:"poster-avatar",size:50})))),(0,a.Z)("div",{className:"media-body"},void 0,(0,a.Z)("div",{className:"media-heading"},void 0,(0,a.Z)("span",{className:"item-title"},void 0,(0,a.Z)("span",{className:"ui-preview-text",style:{width:x.e(30,200)+"px"}},void 0," "))),(0,a.Z)("span",{className:"user-title user-title-anonymous"},void 0,(0,a.Z)("span",{className:"ui-preview-text",style:{width:x.e(30,200)+"px"}},void 0," "))))),(0,a.Z)("div",{className:"post-heading"},void 0,(0,a.Z)("span",{className:"ui-preview-text",style:{width:x.e(30,200)+"px"}},void 0," ")),(0,a.Z)("div",{className:"post-body"},void 0,(0,a.Z)("article",{className:"misago-markup"},void 0,(0,a.Z)("p",{},void 0,(0,a.Z)("span",{className:"ui-preview-text",style:{width:x.e(30,200)+"px"}},void 0," ")," ",(0,a.Z)("span",{className:"ui-preview-text",style:{width:x.e(30,200)+"px"}},void 0," ")," ",(0,a.Z)("span",{className:"ui-preview-text",style:{width:x.e(30,200)+"px"}},void 0," ")))))))))}function w(e){let{isReady:t,posts:s,poster:i}=e;return t?(0,a.Z)("ul",{className:"posts-list post-feed ui-ready"},void 0,s.map((e=>(0,a.Z)(f,{post:e,poster:i},e.id)))):N||(N=(0,a.Z)(y,{}))}},78107:function(e,t,s){"use strict";s.d(t,{mv:function(){return d},ZP:function(){return ls},MO:function(){return C},Fi:function(){return v}});var a,i=s(57588),o=s.n(i),n=s(22928),r=s(4942),l=s(64646);class d extends o().Component{constructor(e){super(e),(0,r.Z)(this,"selected",(()=>{if(this.element){const e=p(this.element)||null,t=e?e.getBoundingClientRect():null;this.setState({range:e,rect:t})}})),(0,r.Z)(this,"reply",(()=>{if(l.Z.isOpen()){const e=C();e&&!e.disabled&&(e.quote(v(this.state.range)),this.setState({range:null,rect:null}),c())}else{const e=v(this.state.range);l.Z.open(Object.assign({},this.props.posting,{default:e})),this.setState({range:null,rect:null}),window.setTimeout(c,1e3)}})),(0,r.Z)(this,"render",(()=>(0,n.Z)("div",{},void 0,o().createElement("div",{ref:e=>{e&&(this.element=e)},onMouseUp:this.selected,onTouchEnd:this.selected},this.props.children),!!this.state.rect&&(0,n.Z)("div",{className:"quote-control",style:{position:"absolute",left:this.state.rect.left+window.scrollX,top:this.state.rect.bottom+window.scrollY}},void 0,a||(a=(0,n.Z)("div",{className:"quote-control-arrow"})),(0,n.Z)("div",{className:"quote-control-inner"},void 0,(0,n.Z)("button",{className:"btn quote-control-btn",type:"button",onClick:this.reply},void 0,pgettext("post reply","Quote"))))))),this.state={range:null,rect:null},this.element=null}}function c(){const e=document.querySelector("#posting-mount textarea");e.focus(),e.selectionStart=e.selectionEnd=e.value.length}const p=e=>{if(void 0===window.getSelection)return;const t=window.getSelection();if(!t)return;if("Range"!==t.type)return;if(1!==t.rangeCount)return;const s=t.getRangeAt(0);return u(s,e)&&h(s)&&m(s.cloneContents())?s:void 0},u=(e,t)=>{const s=e.commonAncestorContainer;if(s===t)return!0;let a=s.parentNode;for(;a;){if(a===t)return!0;a=a.parentNode}return!1},h=e=>{const t=e.commonAncestorContainer;if("ARTICLE"===t.nodeName)return!0;if(t.dataset&&"1"===t.dataset.noquote)return!1;let s=t.parentNode;for(;s;){if(s.dataset&&"1"===s.dataset.noquote)return!1;if("ARTICLE"===s.nodeName)return!0;s=s.parentNode}return!1},m=e=>{for(let t=0;t<e.childNodes.length;t++){const s=e.childNodes[t];if(s.nodeType===Node.TEXT_NODE&&s.textContent&&s.textContent.trim().length>0)return!0;if("IMG"===s.nodeName)return!0;if(m(s))return!0}return!1};var v=e=>{const t=g(e);let s=y(e.cloneContents().childNodes,[]),a=t?`[quote="${t}"]\n`:"[quote]\n",i="\n[/quote]\n\n";const o=f(e);return o?(a+=o.syntax?`[code=${o.syntax}]\n`:"[code]\n",i="\n[/code]"+i):N(e)?(s=s.trim(),a+="`",i="`"+i):s=s.trim(),a+s+i};const g=e=>{const t=e.commonAncestorContainer;if(Z(t))return b(t);let s=t.parentNode;for(;s;){if(Z(s))return b(s);s=s.parentNode}return""},Z=e=>e.nodeType===Node.ELEMENT_NODE&&("ARTICLE"===e.nodeName||"BLOCKQUOTE"===e.nodeName&&e.dataset&&"quote"===e.dataset.block),b=e=>e.dataset&&e.dataset.author||null,f=e=>{const t=e.commonAncestorContainer;if(_(t))return x(t);let s=t.parentNode;for(;s;){if(_(s))return x(s);s=s.parentNode}return null},_=e=>"PRE"===e.nodeName,N=e=>{const t=e.commonAncestorContainer;if("CODE"===t.nodeName)return!0;let s=t.parentNode;for(;s;){if(Z(s))return!1;if("CODE"===s.nodeName)return!0;s=s.parentNode}return!1},x=e=>e.dataset?{syntax:e.dataset.syntax||null}:{syntax:null},y=(e,t)=>{let s="";for(let a=0;a<e.length;a++){const i=e[a];s+=k(i,t)}return s},w={H1:["\n\n# ",""],H2:["\n\n## ",""],H3:["\n\n### ",""],H4:["\n\n#### ",""],H5:["\n\n##### ",""],H6:["\n\n###### ",""],STRONG:["**","**"],EM:["*","*"],DEL:["~~","~~"],B:["[b]","[/b]"],U:["[u]","[/u]"],I:["[i]","[/i]"],SUB:["[sub]","[/sub]"],SUP:["[sup]","[/sup]"]},k=(e,t)=>{const s=e.dataset||{};if(e.nodeType===Node.TEXT_NODE)return e.textContent||"";if(e.nodeType===Node.ELEMENT_NODE){if(s.quote)return s.quote||"";if("1"===s.noquote)return""}if(e.nodeType===Node.ELEMENT_NODE&&s.quote&&s.quote.trim())return"";if("HR"===e.nodeName)return"\n\n- - -";if(w[e.nodeName]){const[s,a]=w[e.nodeName];return s+y(e.childNodes,[...t,e.nodeName])+a}if("A"===e.nodeName){const s=e.href,a=y(e.childNodes,[...t,e.nodeName]);return a?`[${a}](${s})`:`!(${s})`}if("IMG"===e.nodeName){const t=e.src,s=e.alt;return s?`![${s}](${t})`:`!(${t})`}if("DIV"===e.nodeName||"ASIDE"===e.nodeName){const a=s.block&&s.block.toUpperCase();if(a&&w[a]){const[s,i]=w[a];return s+y(e.childNodes,[...t,a])+i}return y(e.childNodes,t)}if("BLOCKQUOTE"===e.nodeName){if("spoiler"===s.block){const s=y(e.childNodes,[...t,"SPOILER"]).trim();if(!s)return"";let a="\n[spoiler]\n";return a+=s,a+="\n[/spoiler]",a}const a=y(e.childNodes,[...t,"QUOTE"]).trim();if(!a)return"";const i=b(e);let o=i?`\n[quote=${i}]\n`:"\n\n[quote]\n";return o+=a,o+="\n[/quote]",o}if("PRE"===e.nodeName){const t=s.syntax||null,a=e.querySelector("code"),i=a&&a.innerText||"";return i.trim()?"\n[code"+(t?"="+t:"")+"]"+i+"[/code]":""}if("CODE"===e.nodeName)return"`"+e.innerText+"`";if("P"===e.nodeName)return"\n"+y(e.childNodes,[...t,e.nodeName]);if("UL"===e.nodeName||"OL"===e.nodeName)return(0===t.filter((e=>"OL"===e||"UL"===e)).length?"\n":"")+y(e.childNodes,[...t,e.nodeName]);if("LI"===e.nodeName){let a="";const i=t.filter((e=>"OL"===e||"UL"===e)).length;for(let e=1;e<i;e++)a+="    ";a+="OL"===t[t.length-1]?s.index?s.index+". ":"1. ":"- ";const o=y(e.childNodes,[...t,e.nodeName]);return o.trim()?"\n"+a+o:""}return"SPAN"===e.nodeName?y(e.childNodes,t):""};function C(){return window.misagoReply}function S(e,t){window.misagoReply={disabled:e,quote:t}}function E(){window.misagoReply=null}var L=s(57026),T=s(43345),P=s(30381),O=s.n(P);function R(e){return e.filter((e=>e.id&&!e.isRemoved)).map((e=>e.id))}var A,I=s(12891),D=s(78657),j=s(53904),z=s(94184),U=s.n(z),M=s(32233),B=s(69092),q=s(59801),H=s(48772);function F(e){let{attachment:t}=e;return(0,n.Z)("div",{className:"modal-dialog modal-lg",role:"document"},void 0,(0,n.Z)("div",{className:"modal-content"},void 0,(0,n.Z)("div",{className:"modal-header"},void 0,(0,n.Z)("button",{"aria-label":pgettext("modal","Close"),className:"close","data-dismiss":"modal",type:"button"},void 0,A||(A=(0,n.Z)("span",{"aria-hidden":"true"},void 0,"×"))),(0,n.Z)("h4",{className:"modal-title"},void 0,pgettext("markup editor","Attachment details"))),(0,n.Z)("div",{className:"modal-body"},void 0,!!t.is_image&&(0,n.Z)("div",{className:"markup-editor-attachment-modal-preview"},void 0,(0,n.Z)("a",{href:t.url.index+"?shva=1",target:"_blank"},void 0,(0,n.Z)("img",{src:t.url.index+"?shva=1",alt:""}))),(0,n.Z)("div",{className:"markup-editor-attachment-modal-filename"},void 0,t.filename),(0,n.Z)("div",{className:"row markup-editor-attachment-modal-details"},void 0,(0,n.Z)("div",{className:"col-xs-12 col-md-3"},void 0,(0,n.Z)("strong",{},void 0,t.filetype+", "+(0,H.Z)(t.size)),(0,n.Z)("div",{className:"text-muted"},void 0,(0,n.Z)("small",{},void 0,pgettext("markup editor","Type and size")))),(0,n.Z)("div",{className:"col-xs-12 col-md-4"},void 0,(0,n.Z)("strong",{},void 0,(0,n.Z)("abbr",{title:t.uploaded_on.format("LLL")},void 0,t.uploaded_on.fromNow())),(0,n.Z)("div",{className:"text-muted"},void 0,(0,n.Z)("small",{},void 0,pgettext("markup editor","Uploaded at")))),(0,n.Z)("div",{className:"col-xs-12 col-md-3"},void 0,t.url.uploader?(0,n.Z)("a",{href:t.url.uploader,target:"_blank",className:"item-title"},void 0,t.uploader_name):(0,n.Z)("span",{className:"item-title"},void 0,t.uploader_name),(0,n.Z)("div",{className:"text-muted"},void 0,(0,n.Z)("small",{},void 0,pgettext("markup editor","Uploader")))))),(0,n.Z)("div",{className:"modal-footer"},void 0,(0,n.Z)("button",{className:"btn btn-default","data-dismiss":"modal",type:"button"},void 0,pgettext("modal","Close")))))}const Y=(e,t,s,a,i)=>{const o=e.text||i||"";let n=e.prefix;n+=s+o+a,n+=e.suffix,t(n),window.setTimeout((()=>{W(e.textarea);const t=e.start+s.length;e.textarea.setSelectionRange(t,t+o.length)}),250)},V=(e,t,s)=>{let a=e.prefix;a+=s,a+=e.suffix,t(a),window.setTimeout((()=>{W(e.textarea);const t=e.end+s.length;e.textarea.setSelectionRange(t,t)}),250)},G=e=>{if(document.selection){e.focus();const t=document.selection.createRange(),s=t.text.length;return t.moveStart("character",-e.value.length),$(e,t.text.length-s,t.text.length)}if(e.selectionStart||"0"==e.selectionStart)return $(e,e.selectionStart,e.selectionEnd)},$=(e,t,s)=>({textarea:e,start:t,end:s,text:e.value.substring(t,s),prefix:e.value.substring(0,t),suffix:e.value.substring(s)});function W(e){const t=e.scrollTop;e.focus(),e.scrollTop=t}var Q,K,J,X,ee,te,se=e=>{var t;let{attachment:s,disabled:a,element:i,setState:o,update:r}=e;return(0,n.Z)("div",{className:"markup-editor-attachments-item"},void 0,(0,n.Z)("div",{className:"markup-editor-attachment"},void 0,(0,n.Z)("div",{className:"markup-editor-attachment-details"},void 0,s.id?(0,n.Z)("a",{className:"item-title",href:s.url.index+"?shva=1",target:"_blank",onClick:e=>{e.preventDefault(),q.Z.show(t||(t=(0,n.Z)(F,{attachment:s})))}},void 0,s.filename):(0,n.Z)("strong",{className:"item-title"},void 0,s.filename),(0,n.Z)("div",{className:"text-muted"},void 0,(0,n.Z)("ul",{className:"list-unstyled list-inline"},void 0,!s.id&&(0,n.Z)("li",{},void 0,s.progress+"%"),!!s.filetype&&(0,n.Z)("li",{},void 0,s.filetype),s.size>0&&(0,n.Z)("li",{},void 0,(0,H.Z)(s.size))))),!!s.id&&(0,n.Z)("div",{className:"markup-editor-attachment-buttons"},void 0,(0,n.Z)("button",{className:"btn btn-markup-editor-attachment btn-icon",title:pgettext("markup editor","Insert into message"),type:"button",disabled:a,onClick:()=>{const e=function(e){let t="[";return e.is_image?(t+="!["+e.filename+"]",t+="("+(e.url.thumb||e.url.index)+"?shva=1)"):t+=e.filename,t+="]("+e.url.index+"?shva=1)",t}(s),t=G(i);V(t,r,e)}},void 0,Q||(Q=(0,n.Z)("span",{className:"material-icon"},void 0,"flip_to_front"))),(0,n.Z)("button",{className:"btn btn-markup-editor-attachment btn-icon",title:pgettext("markup editor","Remove attachment"),type:"button",disabled:a,onClick:()=>{o((e=>{let{attachments:t}=e;if(window.confirm(pgettext("markup editor","Remove this attachment?")))return{attachments:t.filter((e=>{let{id:t}=e;return t!==s.id}))}}))}},void 0,K||(K=(0,n.Z)("span",{className:"material-icon"},void 0,"close")))),!s.id&&!!s.key&&(0,n.Z)("div",{className:"markup-editor-attachment-buttons"},void 0,s.error&&(0,n.Z)("button",{className:"btn btn-markup-editor-attachment btn-icon",title:pgettext("markup editor","See error"),type:"button",onClick:()=>{j.Z.error(interpolate(pgettext("markup editor","%(filename)s: %(error)s"),{filename:s.filename,error:s.error},!0))}},void 0,J||(J=(0,n.Z)("span",{className:"material-icon"},void 0,"warning"))),(0,n.Z)("button",{className:"btn btn-markup-editor-attachment btn-icon",title:pgettext("markup editor","Remove attachment"),type:"button",disabled:a,onClick:()=>{o((e=>{let{attachments:t}=e;return{attachments:t.filter((e=>{let{key:t}=e;return t!==s.key}))}}))}},void 0,X||(X=(0,n.Z)("span",{className:"material-icon"},void 0,"close"))))))},ae=e=>{let{attachments:t,disabled:s,element:a,setState:i,update:o}=e;return(0,n.Z)("div",{className:"markup-editor-attachments"},void 0,(0,n.Z)("div",{className:"markup-editor-attachments-container"},void 0,t.map((e=>(0,n.Z)(se,{attachment:e,disabled:s,element:a,setState:i,update:o},e.key||e.id)))))},ie=s(82211),oe=e=>{let{canProtect:t,disabled:s,empty:a,preview:i,isProtected:o,submitText:r,showPreview:l,closePreview:d,enableProtection:c,disableProtection:p}=e;return(0,n.Z)("div",{className:"markup-editor-footer"},void 0,!!t&&(0,n.Z)(ie.Z,{className:"btn-default btn-icon hidden-sm hidden-md hidden-lg",title:o?pgettext("markup editor","Protected"):pgettext("markup editor","Protect"),type:"button",disabled:s,onClick:()=>{o?p():c()}},void 0,(0,n.Z)("span",{className:"material-icon"},void 0,o?"lock":"lock_open")),!!t&&(0,n.Z)("div",{},void 0,(0,n.Z)(ie.Z,{className:"btn-default hidden-xs",type:"button",disabled:s,onClick:()=>{o?p():c()}},void 0,(0,n.Z)("span",{className:"material-icon"},void 0,o?"lock":"lock_open"),o?pgettext("markup editor","Protected"):pgettext("markup editor","Protect"))),ee||(ee=(0,n.Z)("div",{className:"markup-editor-spacer"})),i?(0,n.Z)(ie.Z,{className:"btn-default btn-auto",type:"button",onClick:d},void 0,pgettext("markup editor","Edit")):(0,n.Z)(ie.Z,{className:"btn-default btn-auto",disabled:s||a,type:"button",onClick:l},void 0,pgettext("markup editor","Preview")),(0,n.Z)(ie.Z,{className:"btn-primary btn-auto",disabled:s||a},void 0,r||gettext("Post")))},ne=s(96359);class re extends o().Component{constructor(e){super(e),(0,r.Z)(this,"handleSubmit",(e=>{e.preventDefault();const{selection:t,update:s}=this.props,a=this.state.syntax.trim(),i=this.state.text.trim();if(0===i.length)return this.setState({error:gettext("This field is required.")}),!1;const o=t.prefix.trim().length?"\n\n":"";return V(Object.assign({},t,{text:i}),s,o+"```"+a+"\n"+i+"\n```\n\n"),q.Z.hide(),!1})),this.state={error:null,syntax:"",text:e.selection.text}}render(){return(0,n.Z)("div",{className:"modal-dialog modal-lg",role:"document"},void 0,(0,n.Z)("div",{className:"modal-content"},void 0,(0,n.Z)("div",{className:"modal-header"},void 0,(0,n.Z)("button",{"aria-label":pgettext("modal","Close"),className:"close","data-dismiss":"modal",type:"button"},void 0,te||(te=(0,n.Z)("span",{"aria-hidden":"true"},void 0,"×"))),(0,n.Z)("h4",{className:"modal-title"},void 0,pgettext("markup editor","Code"))),(0,n.Z)("form",{onSubmit:this.handleSubmit},void 0,(0,n.Z)("div",{className:"modal-body"},void 0,(0,n.Z)(ne.Z,{for:"markup_code_syntax",label:pgettext("markup editor","Syntax highlighting")},void 0,(0,n.Z)("select",{id:"markup_code_syntax",className:"form-control",value:this.state.syntax,onChange:e=>this.setState({syntax:e.target.value})},void 0,(0,n.Z)("option",{value:""},void 0,pgettext("markup editor","No syntax highlighting")),le.map((e=>{let{value:t,name:s}=e;return(0,n.Z)("option",{value:t},t,s)})))),(0,n.Z)(ne.Z,{for:"markup_code_text",label:pgettext("markup editor","Code to insert"),validation:this.state.error?[this.state.error]:void 0},void 0,(0,n.Z)("textarea",{id:"markup_code_text",className:"form-control",rows:"8",value:this.state.text,onChange:e=>this.setState({text:e.target.value})}))),(0,n.Z)("div",{className:"modal-footer"},void 0,(0,n.Z)("button",{className:"btn btn-default","data-dismiss":"modal",type:"button"},void 0,gettext("Cancel")),(0,n.Z)("button",{className:"btn btn-primary"},void 0,pgettext("markup editor","Insert code"))))))}}const le=[{value:"bash",name:"Bash"},{value:"c",name:"C"},{value:"c#",name:"C#"},{value:"c++",name:"C++"},{value:"css",name:"CSS"},{value:"diff",name:"Diff"},{value:"go",name:"Go"},{value:"graphql",name:"GraphQL"},{value:"html,",name:"HTML"},{value:"xml",name:"XML"},{value:"json",name:"JSON"},{value:"java",name:"Java"},{value:"javascript",name:"JavaScript"},{value:"kotlin",name:"Kotlin"},{value:"less",name:"Less"},{value:"lua",name:"Lua"},{value:"makefile",name:"Makefile"},{value:"markdown",name:"Markdown"},{value:"objective-C",name:"Objective-C"},{value:"php",name:"PHP"},{value:"perl",name:"Perl"},{value:"plain",name:"Plain"},{value:"text",name:"text"},{value:"python",name:"Python"},{value:"repl",name:"REPL"},{value:"r",name:"R"},{value:"ruby",name:"Ruby"},{value:"rust",name:"Rust"},{value:"scss",name:"SCSS"},{value:"sql",name:"SQL"},{value:"shell",name:"Shell Session"},{value:"swift",name:"Swift"},{value:"toml",name:"TOML"},{value:"ini",name:"INI"},{value:"typescript",name:"TypeScript"},{value:"visualbasic",name:"Visual Basic .NET"},{value:"webassembly",name:"WebAssembly"},{value:"yaml",name:"YAML"}];var de,ce,pe,ue,he,me,ve,ge,Ze,be,fe,_e,Ne,xe,ye,we,ke,Ce,Se,Ee,Le,Te,Pe,Oe,Re,Ae,Ie,De,je,ze,Ue,Me,Be,qe,He,Fe,Ye,Ve,Ge,$e,We,Qe,Ke,Je,Xe,et=re;function tt(){return(0,n.Z)("div",{className:"modal-dialog modal-lg",role:"document"},void 0,(0,n.Z)("div",{className:"modal-content"},void 0,(0,n.Z)("div",{className:"modal-header"},void 0,(0,n.Z)("button",{"aria-label":pgettext("modal","Close"),className:"close","data-dismiss":"modal",type:"button"},void 0,de||(de=(0,n.Z)("span",{"aria-hidden":"true"},void 0,"×"))),(0,n.Z)("h4",{className:"modal-title"},void 0,pgettext("markup help","Formatting help"))),(0,n.Z)("div",{className:"modal-body formatting-help"},void 0,(0,n.Z)("h4",{},void 0,pgettext("markup help","Emphasis text")),(0,n.Z)(st,{markup:pgettext("markup help","_This text will have emphasis_"),result:(0,n.Z)("p",{},void 0,(0,n.Z)("em",{},void 0,pgettext("markup help","This text will have emphasis")))}),ce||(ce=(0,n.Z)("hr",{})),(0,n.Z)("h4",{},void 0,pgettext("markup help","Bold text")),(0,n.Z)(st,{markup:pgettext("markup help","**This text will be bold**"),result:(0,n.Z)("p",{},void 0,(0,n.Z)("strong",{},void 0,pgettext("markup help","This text will be bold")))}),pe||(pe=(0,n.Z)("hr",{})),(0,n.Z)("h4",{},void 0,pgettext("markup help","Removed text")),(0,n.Z)(st,{markup:pgettext("markup help","~~This text will be removed~~"),result:(0,n.Z)("p",{},void 0,(0,n.Z)("del",{},void 0,pgettext("markup help","This text will be removed")))}),ue||(ue=(0,n.Z)("hr",{})),(0,n.Z)("h4",{},void 0,pgettext("markup help","Bold text (BBCode)")),(0,n.Z)(st,{markup:pgettext("markup help","[b]This text will be bold[/b]"),result:(0,n.Z)("p",{},void 0,(0,n.Z)("b",{},void 0,pgettext("markup help","This text will be bold")))}),he||(he=(0,n.Z)("hr",{})),(0,n.Z)("h4",{},void 0,pgettext("markup help","Underlined text (BBCode)")),(0,n.Z)(st,{markup:pgettext("markup help","[u]This text will be underlined[/u]"),result:(0,n.Z)("p",{},void 0,(0,n.Z)("u",{},void 0,pgettext("markup help","This text will be underlined")))}),me||(me=(0,n.Z)("hr",{})),(0,n.Z)("h4",{},void 0,pgettext("markup help","Italics text (BBCode)")),(0,n.Z)(st,{markup:pgettext("markup help","[i]This text will be in italics[/i]"),result:(0,n.Z)("p",{},void 0,(0,n.Z)("i",{},void 0,pgettext("markup help","This text will be in italics")))}),ve||(ve=(0,n.Z)("hr",{})),(0,n.Z)("h4",{},void 0,pgettext("markup help","Link")),ge||(ge=(0,n.Z)(st,{markup:"<http://example.com>",result:(0,n.Z)("p",{},void 0,(0,n.Z)("a",{href:"#"},void 0,"example.com"))})),Ze||(Ze=(0,n.Z)("hr",{})),(0,n.Z)("h4",{},void 0,pgettext("markup help","Link with text")),(0,n.Z)(st,{markup:"["+pgettext("markup help","Link text")+"](http://example.com)",result:(0,n.Z)("p",{},void 0,(0,n.Z)("a",{href:"#"},void 0,pgettext("markup help","Link text")))}),be||(be=(0,n.Z)("hr",{})),(0,n.Z)("h4",{},void 0,pgettext("markup help","Link (BBCode)")),fe||(fe=(0,n.Z)(st,{markup:"[url]http://example.com[/url]",result:(0,n.Z)("p",{},void 0,(0,n.Z)("a",{href:"#"},void 0,"example.com"))})),_e||(_e=(0,n.Z)("hr",{})),(0,n.Z)("h4",{},void 0,pgettext("markup help","Link with text (BBCode)")),(0,n.Z)(st,{markup:"[url=http://example.com]"+pgettext("markup help","Link text")+"[/url]",result:(0,n.Z)("p",{},void 0,(0,n.Z)("a",{href:"#"},void 0,pgettext("markup help","Link text")))}),Ne||(Ne=(0,n.Z)("hr",{})),(0,n.Z)("h4",{},void 0,pgettext("markup help","Image")),xe||(xe=(0,n.Z)(st,{markup:"!(http://placekitten.com/38/38)",result:(0,n.Z)("p",{},void 0,(0,n.Z)("img",{alt:"",src:"http://placekitten.com/38/38"}))})),ye||(ye=(0,n.Z)("hr",{})),(0,n.Z)("h4",{},void 0,pgettext("markup help","Image with alternate text")),(0,n.Z)(st,{markup:"!["+pgettext("markup help","Image text")+"](http://placekitten.com/38/38)",result:(0,n.Z)("p",{},void 0,(0,n.Z)("img",{alt:pgettext("markup help","Image text"),src:"http://placekitten.com/38/38"}))}),we||(we=(0,n.Z)("hr",{})),(0,n.Z)("h4",{},void 0,pgettext("markup help","Image (BBCode)")),ke||(ke=(0,n.Z)(st,{markup:"[img]http://placekitten.com/38/38[/img]",result:(0,n.Z)("p",{},void 0,(0,n.Z)("img",{alt:"",src:"http://placekitten.com/38/38"}))})),Ce||(Ce=(0,n.Z)("hr",{})),(0,n.Z)("h4",{},void 0,pgettext("markup help","Mention user by their name")),Se||(Se=(0,n.Z)(st,{markup:"@username",result:(0,n.Z)("p",{},void 0,(0,n.Z)("a",{href:"#"},void 0,"@username"))})),Ee||(Ee=(0,n.Z)("hr",{})),(0,n.Z)("h4",{},void 0,pgettext("markup help","Heading 1")),(0,n.Z)(st,{markup:pgettext("markup help","# First level heading"),result:(0,n.Z)("h1",{},void 0,pgettext("markup help","First level heading"))}),Le||(Le=(0,n.Z)("hr",{})),(0,n.Z)("h4",{},void 0,pgettext("markup help","Heading 2")),(0,n.Z)(st,{markup:pgettext("markup help","## Second level heading"),result:(0,n.Z)("h2",{},void 0,pgettext("markup help","Second level heading"))}),Te||(Te=(0,n.Z)("hr",{})),(0,n.Z)("h4",{},void 0,pgettext("markup help","Heading 3")),(0,n.Z)(st,{markup:pgettext("markup help","### Third level heading"),result:(0,n.Z)("h3",{},void 0,pgettext("markup help","Third level heading"))}),Pe||(Pe=(0,n.Z)("hr",{})),(0,n.Z)("h4",{},void 0,pgettext("markup help","Heading 4")),(0,n.Z)(st,{markup:pgettext("markup help","#### Fourth level heading"),result:(0,n.Z)("h4",{},void 0,pgettext("markup help","Fourth level heading"))}),Oe||(Oe=(0,n.Z)("hr",{})),(0,n.Z)("h4",{},void 0,pgettext("markup help","Heading 5")),(0,n.Z)(st,{markup:pgettext("markup help","##### Fifth level heading"),result:(0,n.Z)("h5",{},void 0,pgettext("markup help","Fifth level heading"))}),Re||(Re=(0,n.Z)("hr",{})),(0,n.Z)("h4",{},void 0,pgettext("markup help","Unordered list")),Ae||(Ae=(0,n.Z)(st,{markup:"- Lorem ipsum\n- Dolor met\n- Vulputate lectus",result:(0,n.Z)("ul",{},void 0,(0,n.Z)("li",{},void 0,"Lorem ipsum"),(0,n.Z)("li",{},void 0,"Dolor met"),(0,n.Z)("li",{},void 0,"Vulputate lectus"))})),Ie||(Ie=(0,n.Z)("hr",{})),(0,n.Z)("h4",{},void 0,pgettext("markup help","Ordered list")),De||(De=(0,n.Z)(st,{markup:"1. Lorem ipsum\n2. Dolor met\n3. Vulputate lectus",result:(0,n.Z)("ol",{},void 0,(0,n.Z)("li",{},void 0,"Lorem ipsum"),(0,n.Z)("li",{},void 0,"Dolor met"),(0,n.Z)("li",{},void 0,"Vulputate lectus"))})),je||(je=(0,n.Z)("hr",{})),(0,n.Z)("h4",{},void 0,pgettext("markup help","Quote text")),(0,n.Z)(st,{markup:"> "+pgettext("markup help","Quoted text"),result:(0,n.Z)("blockquote",{},void 0,(0,n.Z)("p",{},void 0,pgettext("markup help","Quoted text")))}),ze||(ze=(0,n.Z)("hr",{})),(0,n.Z)("h4",{},void 0,pgettext("markup help","Quote text (BBCode)")),(0,n.Z)(st,{markup:"[quote]\n"+pgettext("markup help","Quoted text")+"\n[/quote]",result:(0,n.Z)("aside",{className:"quote-block"},void 0,(0,n.Z)("div",{className:"quote-heading"},void 0,gettext("Quoted message:")),(0,n.Z)("blockquote",{className:"quote-body"},void 0,(0,n.Z)("p",{},void 0,pgettext("markup help","Quoted text"))))}),Ue||(Ue=(0,n.Z)("hr",{})),(0,n.Z)("h4",{},void 0,pgettext("markup help","Quote text with title (BBCode)")),(0,n.Z)(st,{markup:'[quote="'+pgettext("markup help","Quote title")+'"]\n'+pgettext("markup help","Quoted text")+"\n[/quote]",result:(0,n.Z)("aside",{className:"quote-block"},void 0,(0,n.Z)("div",{className:"quote-heading"},void 0,gettext("Quote title has written:")),(0,n.Z)("blockquote",{className:"quote-body"},void 0,(0,n.Z)("p",{},void 0,pgettext("markup help","Quoted text"))))}),Me||(Me=(0,n.Z)("hr",{})),(0,n.Z)("h4",{},void 0,pgettext("markup help","Spoiler")),(0,n.Z)(st,{markup:"[spoiler]\n"+pgettext("markup help","Secret text")+"\n[/spoiler]",result:(0,n.Z)(at,{},void 0,pgettext("markup help","Secret text"))}),Be||(Be=(0,n.Z)("hr",{})),(0,n.Z)("h4",{},void 0,pgettext("markup help","Inline code")),(0,n.Z)(st,{markup:pgettext("markup help","`Inline code`"),result:(0,n.Z)("p",{},void 0,(0,n.Z)("code",{},void 0,pgettext("markup help","Inline code")))}),qe||(qe=(0,n.Z)("hr",{})),(0,n.Z)("h4",{},void 0,pgettext("markup help","Code block")),He||(He=(0,n.Z)(st,{markup:'```\nalert("Hello world!");\n```',result:(0,n.Z)("pre",{},void 0,(0,n.Z)("code",{className:"hljs"},void 0,'alert("Hello world!");'))})),Fe||(Fe=(0,n.Z)("hr",{})),(0,n.Z)("h4",{},void 0,pgettext("markup help","Code block with syntax highlighting")),Ye||(Ye=(0,n.Z)(st,{markup:'```python\nprint("Hello world!");\n```',result:(0,n.Z)("pre",{},void 0,(0,n.Z)("code",{className:"hljs language-python"},void 0,(0,n.Z)("span",{className:"hljs-built_in"},void 0,"print"),'("Hello world!");'))})),Ve||(Ve=(0,n.Z)("hr",{})),(0,n.Z)("h4",{},void 0,pgettext("markup help","Code block (BBCode)")),Ge||(Ge=(0,n.Z)(st,{markup:'[code]\nalert("Hello world!");\n[/code]',result:(0,n.Z)("pre",{},void 0,(0,n.Z)("code",{className:"hljs"},void 0,'alert("Hello world!");'))})),$e||($e=(0,n.Z)("hr",{})),(0,n.Z)("h4",{},void 0,pgettext("markup help","Code block with syntax highlighting (BBCode)")),We||(We=(0,n.Z)(st,{markup:'[code="python"]\nprint("Hello world!");\n[/code]',result:(0,n.Z)("pre",{},void 0,(0,n.Z)("code",{className:"hljs language-python"},void 0,(0,n.Z)("span",{className:"hljs-built_in"},void 0,"print"),'("Hello world!");'))})),Qe||(Qe=(0,n.Z)("hr",{})),(0,n.Z)("h4",{},void 0,pgettext("markup help","Horizontal rule")),Ke||(Ke=(0,n.Z)(st,{markup:"Lorem ipsum\n- - -\nDolor met",result:(0,n.Z)("div",{},void 0,(0,n.Z)("p",{},void 0,"Lorem ipsum"),(0,n.Z)("hr",{}),(0,n.Z)("p",{},void 0,"Dolor met"))})),Je||(Je=(0,n.Z)("hr",{})),(0,n.Z)("h4",{},void 0,pgettext("markup help","Horizontal rule (BBCode)")),Xe||(Xe=(0,n.Z)(st,{markup:"Lorem ipsum\n[hr]\nDolor met",result:(0,n.Z)("div",{},void 0,(0,n.Z)("p",{},void 0,"Lorem ipsum"),(0,n.Z)("hr",{}),(0,n.Z)("p",{},void 0,"Dolor met"))}))),(0,n.Z)("div",{className:"modal-footer"},void 0,(0,n.Z)("button",{className:"btn btn-default","data-dismiss":"modal",type:"button"},void 0,pgettext("modal","Close")))))}function st(e){let{markup:t,result:s}=e;return(0,n.Z)("div",{className:"formatting-help-item"},void 0,(0,n.Z)("div",{className:"formatting-help-item-markup"},void 0,(0,n.Z)("pre",{},void 0,(0,n.Z)("code",{},void 0,t))),(0,n.Z)("div",{className:"formatting-help-item-preview"},void 0,(0,n.Z)("article",{className:"misago-markup"},void 0,s)))}class at extends o().Component{constructor(e){super(e),this.state={reveal:!1}}render(){return(0,n.Z)("aside",{className:this.state.reveal?"spoiler-block revealed":"spoiler-block"},void 0,(0,n.Z)("blockquote",{className:"spoiler-body"},void 0,(0,n.Z)("p",{},void 0,this.props.children)),!this.state.reveal&&(0,n.Z)("div",{className:"spoiler-overlay"},void 0,(0,n.Z)("button",{className:"spoiler-reveal",type:"button",onClick:()=>{this.setState({reveal:!0})}},void 0,gettext("Reveal spoiler"))))}}var it=s(19755);const ot=new RegExp("^(https?:\\/\\/)?((([a-z\\d]([a-z\\d-]*[a-z\\d])*)\\.)+[a-z]{2,}|((\\d{1,3}\\.){3}\\d{1,3}))(\\:\\d+)?(\\/[-a-z\\d%_.~+]*)*(\\?[;&a-z\\d%_.~+=-]*)?(\\#[-a-z\\d_]*)?$","i");function nt(e){return ot.test(it.trim(e))}var rt;class lt extends o().Component{constructor(e){super(e),(0,r.Z)(this,"handleSubmit",(e=>{e.preventDefault();const{selection:t,update:s}=this.props,a=this.state.text.trim(),i=this.state.url.trim();return 0===i.length?(this.setState({error:gettext("This field is required.")}),!1):nt(i)?(a.length>0?V(t,s,"!["+a+"]("+i+")"):V(t,s,"!("+i+")"),q.Z.hide(),!1):(this.setState({error:gettext("Enter a valid address.")}),!1)}));const t=e.selection.text.trim(),s=nt(t);this.state={error:null,text:s?"":t,url:s?t:""}}render(){return(0,n.Z)("div",{className:"modal-dialog",role:"document"},void 0,(0,n.Z)("div",{className:"modal-content"},void 0,(0,n.Z)("div",{className:"modal-header"},void 0,(0,n.Z)("button",{"aria-label":pgettext("modal","Close"),className:"close","data-dismiss":"modal",type:"button"},void 0,rt||(rt=(0,n.Z)("span",{"aria-hidden":"true"},void 0,"×"))),(0,n.Z)("h4",{className:"modal-title"},void 0,pgettext("markup editor","Image"))),(0,n.Z)("form",{onSubmit:this.handleSubmit},void 0,(0,n.Z)("div",{className:"modal-body"},void 0,(0,n.Z)(ne.Z,{for:"markup_link_url",label:pgettext("markup editor","Image description"),helpText:pgettext("markup editor","Optional but recommended . Will be displayed instead of image when it fails to load.")},void 0,(0,n.Z)("input",{id:"markup_link_text",className:"form-control",type:"text",value:this.state.text,onChange:e=>this.setState({text:e.target.value})})),(0,n.Z)(ne.Z,{for:"markup_link_url",label:pgettext("markup editor","Image address"),validation:this.state.error?[this.state.error]:void 0},void 0,(0,n.Z)("input",{id:"markup_link_url",className:"form-control",type:"text",value:this.state.url,onChange:e=>this.setState({url:e.target.value})}))),(0,n.Z)("div",{className:"modal-footer"},void 0,(0,n.Z)("button",{className:"btn btn-default","data-dismiss":"modal",type:"button"},void 0,gettext("Cancel")),(0,n.Z)("button",{className:"btn btn-primary"},void 0,pgettext("markup editor","Insert image"))))))}}var dt,ct=lt;class pt extends o().Component{constructor(e){super(e),(0,r.Z)(this,"handleSubmit",(e=>{e.preventDefault();const{selection:t,update:s}=this.props,a=this.state.text.trim(),i=this.state.url.trim();return 0===i.length?(this.setState({error:gettext("This field is required.")}),!1):nt(i)?(a.length>0?V(t,s,"["+a+"]("+i+")"):V(t,s,"<"+i+">"),q.Z.hide(),!1):(this.setState({error:gettext("Enter a valid address.")}),!1)}));const t=e.selection.text.trim(),s=nt(t);this.state={error:null,text:s?"":t,url:s?t:""}}render(){return(0,n.Z)("div",{className:"modal-dialog",role:"document"},void 0,(0,n.Z)("div",{className:"modal-content"},void 0,(0,n.Z)("div",{className:"modal-header"},void 0,(0,n.Z)("button",{"aria-label":pgettext("modal","Close"),className:"close","data-dismiss":"modal",type:"button"},void 0,dt||(dt=(0,n.Z)("span",{"aria-hidden":"true"},void 0,"×"))),(0,n.Z)("h4",{className:"modal-title"},void 0,pgettext("markup editor","Link"))),(0,n.Z)("form",{onSubmit:this.handleSubmit},void 0,(0,n.Z)("div",{className:"modal-body"},void 0,(0,n.Z)(ne.Z,{for:"markup_link_url",label:pgettext("markup editor","Link text"),helpText:pgettext("markup editor","Optional. Will be displayed instead of link's address.")},void 0,(0,n.Z)("input",{id:"markup_link_text",className:"form-control",type:"text",value:this.state.text,onChange:e=>this.setState({text:e.target.value})})),(0,n.Z)(ne.Z,{for:"markup_link_url",label:pgettext("markup editor","Link address"),validation:this.state.error?[this.state.error]:void 0},void 0,(0,n.Z)("input",{id:"markup_link_url",className:"form-control",type:"text",value:this.state.url,onChange:e=>this.setState({url:e.target.value})}))),(0,n.Z)("div",{className:"modal-footer"},void 0,(0,n.Z)("button",{className:"btn btn-default","data-dismiss":"modal",type:"button"},void 0,gettext("Cancel")),(0,n.Z)("button",{className:"btn btn-primary"},void 0,pgettext("markup editor","Insert link"))))))}}var ut,ht=pt;class mt extends o().Component{constructor(e){super(e),(0,r.Z)(this,"handleSubmit",(e=>{e.preventDefault();const{selection:t,update:s}=this.props,a=this.state.author.trim(),i=this.state.text.trim();if(0===i.length)return this.setState({error:gettext("This field is required.")}),!1;const o=t.prefix.trim().length?"\n\n":"";return V(t,s,a?o+'[quote="'+a+'"]\n'+i+"\n[/quote]\n\n":o+"[quote]\n"+i+"\n[/quote]\n\n"),q.Z.hide(),!1})),this.state={error:null,author:"",text:e.selection.text}}render(){return(0,n.Z)("div",{className:"modal-dialog modal-lg",role:"document"},void 0,(0,n.Z)("div",{className:"modal-content"},void 0,(0,n.Z)("div",{className:"modal-header"},void 0,(0,n.Z)("button",{"aria-label":pgettext("modal","Close"),className:"close","data-dismiss":"modal",type:"button"},void 0,ut||(ut=(0,n.Z)("span",{"aria-hidden":"true"},void 0,"×"))),(0,n.Z)("h4",{className:"modal-title"},void 0,pgettext("markup editor","Quote"))),(0,n.Z)("form",{onSubmit:this.handleSubmit},void 0,(0,n.Z)("div",{className:"modal-body"},void 0,(0,n.Z)(ne.Z,{for:"markup_quote_author",label:pgettext("markup editor","Quote's author or source"),helpText:pgettext("markup editor",'Optional. If it\'s username, put "@" before it ("@JohnDoe").')},void 0,(0,n.Z)("input",{id:"markup_quote_author",className:"form-control",type:"text",value:this.state.author,onChange:e=>this.setState({author:e.target.value})})),(0,n.Z)(ne.Z,{for:"markup_quote_text",label:pgettext("markup editor","Quoted text"),validation:this.state.error?[this.state.error]:void 0},void 0,(0,n.Z)("textarea",{id:"markup_quote_text",className:"form-control",rows:"8",value:this.state.text,onChange:e=>this.setState({text:e.target.value})}))),(0,n.Z)("div",{className:"modal-footer"},void 0,(0,n.Z)("button",{className:"btn btn-default","data-dismiss":"modal",type:"button"},void 0,gettext("Cancel")),(0,n.Z)("button",{className:"btn btn-primary"},void 0,pgettext("markup editor","Insert quote"))))))}}var vt=mt,gt=e=>{let{disabled:t,icon:s,title:a,onClick:i}=e;return(0,n.Z)("button",{className:"btn btn-markup-editor",title:a,type:"button",disabled:t,onClick:i},void 0,(0,n.Z)("span",{className:"material-icon"},void 0,s))};const Zt="12345678990abcdefghijklmnopqrstuvwxyz",bt=Zt.length,ft=e=>{const t=[];for(let s=0;s<e;s++){const e=Math.floor(Math.random()*bt);t.push(Zt[e])}return t.join("")};var _t,Nt,xt=(e,t)=>{const s=1024*M.Z.get("user").acl.max_attachment_size;if(e.size>s)return void j.Z.error(interpolate(pgettext("markup editor","File %(filename)s is bigger than %(limit)s."),{filename:e.name,limit:(0,H.Z)(s)},!0));let a={id:null,key:ft(32),error:null,uploaded_on:null,progress:0,filename:e.name,filetype:null,is_image:!1,size:e.size,url:null,uploader_name:null};t((e=>{let{attachments:t}=e;return{attachments:[a].concat(t)}}));const i=()=>{t((e=>{let{attachments:t}=e;return{attachments:t.concat()}}))},o=new FormData;o.append("upload",e),D.Z.upload(M.Z.get("ATTACHMENTS_API"),o,(e=>{a.progress=e,i()})).then((e=>{Object.assign(a,e,{uploaded_on:O()(e.uploaded_on)}),i()}),(e=>{400===e.status||413===e.status?(a.error=e.detail,j.Z.error(e.detail),i()):j.Z.apiError(e)}))};var yt=e=>{let{disabled:t,element:s,update:a,updateAttachments:i}=e;const o=[{name:pgettext("markup editor","Strong"),icon:"format_bold",onClick:()=>{Y(G(s),a,"**","**",pgettext("example markup","Strong text"))}},{name:pgettext("markup editor","Emphasis"),icon:"format_italic",onClick:()=>{Y(G(s),a,"*","*",pgettext("example markup","Text with emphasis"))}},{name:pgettext("markup editor","Strikethrough"),icon:"format_strikethrough",onClick:()=>{Y(G(s),a,"~~","~~",pgettext("example markup","Text with strikethrough"))}},{name:pgettext("markup editor","Horizontal ruler"),icon:"remove",onClick:()=>{V(G(s),a,"\n\n- - -\n\n")}},{name:pgettext("markup editor","Link"),icon:"insert_link",onClick:()=>{const e=G(s);q.Z.show((0,n.Z)(ht,{selection:e,element:s,update:a}))}},{name:pgettext("markup editor","Image"),icon:"insert_photo",onClick:()=>{const e=G(s);q.Z.show((0,n.Z)(ct,{selection:e,element:s,update:a}))}},{name:pgettext("markup editor","Quote"),icon:"format_quote",onClick:()=>{const e=G(s);q.Z.show((0,n.Z)(vt,{selection:e,element:s,update:a}))}},{name:pgettext("markup editor","Spoiler"),icon:"visibility_off",onClick:()=>{((e,t)=>{const s=G(e),a=s.prefix.trim().length?"\n\n":"";Y(s,t,a+"[spoiler]\n","\n[/spoiler]\n\n",pgettext("markup editor","Spoiler text"))})(s,a)}},{name:pgettext("markup editor","Code"),icon:"code",onClick:()=>{const e=G(s);q.Z.show((0,n.Z)(et,{selection:e,element:s,update:a}))}}];return M.Z.get("user").acl.max_attachment_size&&o.push({name:pgettext("markup editor","Upload file"),icon:"file_upload",onClick:()=>(e=>{const t=document.createElement("input");t.type="file",t.multiple="multiple",t.addEventListener("change",(function(){for(let s=0;s<t.files.length;s++)xt(t.files[s],e)})),t.click()})(i)}),(0,n.Z)("div",{className:"markup-editor-toolbar"},void 0,(0,n.Z)("div",{className:"markup-editor-toolbar-left"},void 0,o.map((e=>{let{name:a,icon:i,onClick:o}=e;return(0,n.Z)(gt,{title:a,icon:i,disabled:t||!s,onClick:o},i)}))),(0,n.Z)("div",{className:"markup-editor-toolbar-right"},void 0,(0,n.Z)("div",{className:"markup-editor-controls-dropdown"},void 0,(0,n.Z)("button",{type:"button",className:"btn btn-markup-editor dropdown-toggle","data-toggle":"dropdown","aria-haspopup":"true","aria-expanded":"false",disabled:t||!s},void 0,_t||(_t=(0,n.Z)("span",{className:"material-icon"},void 0,"more_vert"))),(0,n.Z)("ul",{className:"dropdown-menu dropdown-menu-right stick-to-bottom"},void 0,o.map((e=>{let{name:a,icon:i,onClick:o}=e;return(0,n.Z)("li",{},i,(0,n.Z)("button",{type:"button",className:"btn-link",disabled:t||!s,onClick:o},void 0,(0,n.Z)("span",{className:"material-icon"},void 0,i),a))})))),(0,n.Z)(gt,{title:pgettext("markup editor","Formatting help"),icon:"help_outline",onClick:()=>{q.Z.show(Nt||(Nt=(0,n.Z)(tt,{})))}})))},wt=s(19755);class kt extends o().Component{constructor(e){super(e),(0,r.Z)(this,"showPreview",(()=>{this.state.loading||(this.setState({loading:!0,preview:!0,element:null}),D.Z.post(M.Z.get("PARSE_MARKUP_API"),{post:this.props.value}).then((e=>{this.setState({loading:!1,parsed:e.parsed})}),(e=>{400===e.status?j.Z.error(e.detail):j.Z.apiError(e),this.setState({loading:!1,preview:!1})})))})),(0,r.Z)(this,"closePreview",(()=>{this.setState({loading:!1,preview:!1})})),(0,r.Z)(this,"onDrop",(e=>{if(e.preventDefault(),e.stopPropagation(),!e.dataTransfer.files)return;const{onAttachmentsChange:t}=this.props;if(M.Z.get("user").acl.max_attachment_size)for(let s=0;s<e.dataTransfer.files.length;s++){const a=e.dataTransfer.files[s];xt(a,t)}})),(0,r.Z)(this,"onPaste",(e=>{const{onAttachmentsChange:t}=this.props,s=[];for(let t=0;t<e.clipboardData.items.length;t++){const a=e.clipboardData.items[t];"file"===a.kind&&s.push(a.getAsFile())}if(s.length&&(e.preventDefault(),e.stopPropagation(),M.Z.get("user").acl.max_attachment_size))for(let e=0;e<s.length;e++)xt(s[e],t)})),(0,r.Z)(this,"render",(()=>(0,n.Z)("div",{className:U()("markup-editor",{"markup-editor-focused":this.state.focused&&!this.state.preview})},void 0,(0,n.Z)(yt,{disabled:this.props.disabled||this.state.preview,element:this.state.element,update:e=>this.props.onChange({target:{value:e}}),updateAttachments:this.props.onAttachmentsChange}),this.state.preview?(0,n.Z)("div",{className:"markup-editor-preview"},void 0,this.state.loading?(0,n.Z)("div",{className:"markup-editor-preview-loading"},void 0,(0,n.Z)("div",{className:"ui-preview"},void 0,(0,n.Z)("span",{className:"ui-preview-text",style:{width:"240px"}}))):(0,n.Z)(B.Z,{className:"markup-editor-preview-contents",markup:this.state.parsed})):o().createElement("textarea",{className:"markup-editor-textarea form-control",placeholder:this.props.placeholder,value:this.props.value,disabled:this.props.disabled||this.state.loading,rows:6,ref:e=>{e&&this.state.element!==e&&(this.setState({element:e}),function(e,t){wt(t).atwho({at:"@",displayTpl:'<li><img src="${avatar}" alt="">${username}</li>',insertTpl:"@${username}",searchKey:"username",callbacks:{remoteFilter:function(e,t){wt.getJSON(M.Z.get("MENTION_API"),{q:e},t)}}}),wt(t).on("inserted.atwho",((t,s,a,i)=>{const{query:o}=i,n=a.target.innerText.trim(),r=t.target.value.substr(0,o.headPos),l=t.target.value.substr(o.endPos);t.target.value=r+n+l,e.onChange(t);const d=o.headPos+n.length;t.target.setSelectionRange(d,d),t.target.focus()}))}(this.props,e))},onChange:this.props.onChange,onDrop:this.onDrop,onFocus:()=>this.setState({focused:!0}),onPaste:this.onPaste,onBlur:()=>this.setState({focused:!1})}),this.props.attachments.length>0&&(0,n.Z)(ae,{attachments:this.props.attachments,disabled:this.props.disabled||this.state.preview,element:this.state.element,setState:this.props.onAttachmentsChange,update:e=>this.props.onChange({target:{value:e}})}),(0,n.Z)(oe,{preview:this.state.preview,canProtect:this.props.canProtect,isProtected:this.props.isProtected,disabled:this.props.disabled,empty:this.props.value.trim().length<M.Z.get("SETTINGS").post_length_min||this.state.loading,enableProtection:this.props.enableProtection,disableProtection:this.props.disableProtection,showPreview:this.showPreview,closePreview:this.closePreview,submitText:this.props.submitText})))),this.state={element:null,focused:!1,loading:!1,preview:!1,parsed:null}}}var Ct=kt,St=s(92490);const Et="posting-active",Lt="posting-default",Tt="posting-minimized",Pt="posting-fullscreen";class Ot extends o().Component{componentDidMount(){document.body.classList.add(Et,Lt)}componentWillUnmount(){document.body.classList.remove(Et,Lt,Tt,Pt)}componentWillReceiveProps(e){let{fullscreen:t,minimized:s}=e;s?(document.body.classList.remove(Lt,Pt),document.body.classList.add(Tt)):t?(document.body.classList.remove(Lt,Tt),document.body.classList.add(Pt)):(document.body.classList.remove(Pt,Tt),document.body.classList.add(Lt))}render(){const{children:e,fullscreen:t,minimized:s}=this.props;return(0,n.Z)("div",{className:U()("posting-dialog",{"posting-dialog-minimized":s,"posting-dialog-fullscreen":t&&!s})},void 0,(0,n.Z)("div",{className:"posting-dialog-container"},void 0,e))}}var Rt,At,It,Dt,jt,zt,Ut,Mt,Bt,qt,Ht,Ft,Yt,Vt,Gt,$t=Ot,Wt=e=>{let{children:t}=e;return(0,n.Z)("div",{className:"posting-dialog-body"},void 0,t)},Qt=e=>{let{close:t,message:s}=e;return(0,n.Z)("div",{className:"posting-dialog-error"},void 0,Rt||(Rt=(0,n.Z)("div",{className:"posting-dialog-error-icon"},void 0,(0,n.Z)("span",{className:"material-icon"},void 0,"error_outlined"))),(0,n.Z)("div",{className:"posting-dialog-error-detail"},void 0,(0,n.Z)("p",{},void 0,s),(0,n.Z)("button",{type:"button",className:"btn btn-default",onClick:t},void 0,pgettext("modal","Close"))))},Kt=e=>{let{children:t,close:s,fullscreen:a,minimize:i,minimized:o,fullscreenEnter:r,fullscreenExit:l,open:d}=e;return(0,n.Z)("div",{className:"posting-dialog-header"},void 0,(0,n.Z)("div",{className:"posting-dialog-caption"},void 0,t),o?(0,n.Z)("button",{className:"btn btn-posting-dialog",title:pgettext("dialog","Open"),type:"button",onClick:d},void 0,At||(At=(0,n.Z)("span",{className:"material-icon"},void 0,"expand_less"))):(0,n.Z)("button",{className:"btn btn-posting-dialog",title:pgettext("dialog","Minimize"),type:"button",onClick:i},void 0,It||(It=(0,n.Z)("span",{className:"material-icon"},void 0,"expand_more"))),a?(0,n.Z)("button",{className:"btn btn-posting-dialog hidden-xs",title:pgettext("dialog","Exit the fullscreen mode"),type:"button",onClick:l},void 0,Dt||(Dt=(0,n.Z)("span",{className:"material-icon"},void 0,"fullscreen_exit"))):(0,n.Z)("button",{className:"btn btn-posting-dialog hidden-xs",title:pgettext("dialog","Enter the fullscreen mode"),type:"button",onClick:r},void 0,jt||(jt=(0,n.Z)("span",{className:"material-icon"},void 0,"fullscreen"))),(0,n.Z)("button",{className:"btn btn-posting-dialog",title:pgettext("dialog","Cancel"),type:"button",onClick:s},void 0,zt||(zt=(0,n.Z)("span",{className:"material-icon"},void 0,"close"))))};function Jt(e){let{isClosed:t,isHidden:s,isPinned:a,disabled:i,options:o,close:r,open:l,hide:d,unhide:c,pinGlobally:p,pinLocally:u,unpin:h}=e;const m=function(e,t,s){const a=[];return 2===s&&a.push("bookmark"),1===s&&a.push("bookmark_outline"),e&&a.push("lock"),t&&a.push("visibility_off"),a}(t,s,a);return(0,n.Z)("div",{className:"dropdown"},void 0,(0,n.Z)("button",{className:"btn btn-default btn-outline btn-icon",title:pgettext("post thread","Options"),"aria-expanded":"true","aria-haspopup":"true","data-toggle":"dropdown",type:"button",disabled:i},void 0,m.length>0?(0,n.Z)("span",{className:"btn-icons-family"},void 0,m.map((e=>(0,n.Z)("span",{className:"material-icon"},e,e)))):Ut||(Ut=(0,n.Z)("span",{className:"material-icon"},void 0,"more_horiz"))),(0,n.Z)("ul",{className:"dropdown-menu dropdown-menu-right stick-to-bottom"},void 0,2===o.pin&&2!==a&&(0,n.Z)("li",{},void 0,(0,n.Z)("button",{className:"btn btn-link",onClick:p,type:"button",disabled:i},void 0,Mt||(Mt=(0,n.Z)("span",{className:"material-icon"},void 0,"bookmark")),pgettext("post thread","Pinned globally"))),o.pin>=a&&1!==a&&(0,n.Z)("li",{},void 0,(0,n.Z)("button",{className:"btn btn-link",onClick:u,type:"button",disabled:i},void 0,Bt||(Bt=(0,n.Z)("span",{className:"material-icon"},void 0,"bookmark_outline")),pgettext("post thread","Pinned locally"))),o.pin>=a&&0!==a&&(0,n.Z)("li",{},void 0,(0,n.Z)("button",{className:"btn btn-link",onClick:h,type:"button",disabled:i},void 0,qt||(qt=(0,n.Z)("span",{className:"material-icon"},void 0,"radio_button_unchecked")),pgettext("post thread","Not pinned"))),o.close&&!!t&&(0,n.Z)("li",{},void 0,(0,n.Z)("button",{className:"btn btn-link",onClick:l,type:"button",disabled:i},void 0,Ht||(Ht=(0,n.Z)("span",{className:"material-icon"},void 0,"lock_outline")),pgettext("post thread","Open"))),o.close&&!t&&(0,n.Z)("li",{},void 0,(0,n.Z)("button",{className:"btn btn-link",onClick:r,type:"button",disabled:i},void 0,Ft||(Ft=(0,n.Z)("span",{className:"material-icon"},void 0,"lock")),pgettext("post thread","Closed"))),o.hide&&!!s&&(0,n.Z)("li",{},void 0,(0,n.Z)("button",{className:"btn btn-link",onClick:c,type:"button",disabled:i},void 0,Yt||(Yt=(0,n.Z)("span",{className:"material-icon"},void 0,"visibility")),pgettext("post thread","Visible"))),o.hide&&!s&&(0,n.Z)("li",{},void 0,(0,n.Z)("button",{className:"btn btn-link",onClick:d,type:"button",disabled:i},void 0,Vt||(Vt=(0,n.Z)("span",{className:"material-icon"},void 0,"visibility_off")),pgettext("post thread","Hidden")))))}var Xt=class extends T.Z{constructor(e){super(e),(0,r.Z)(this,"loadSuccess",(e=>{let t=null,s=null;const a=e.map((e=>(!1===e.post||t&&e.id!=this.state.category||(t=e.id,s=e.post),Object.assign(e,{disabled:!1===e.post,label:e.name,value:e.id}))));this.setState({isReady:!0,options:s,categories:a,category:t})})),(0,r.Z)(this,"loadError",(e=>{this.setState({error:e.detail})})),(0,r.Z)(this,"onCancel",(()=>{window.confirm(pgettext("post thread","Are you sure you want to discard thread?"))&&(this.minimize(),l.Z.close())})),(0,r.Z)(this,"onTitleChange",(e=>{this.changeValue("title",e.target.value)})),(0,r.Z)(this,"onCategoryChange",(e=>{const t=this.state.categories.find((t=>e.target.value==t.value));let s=this.state.pin;t.post.pin&&t.post.pin<s&&(s=t.post.pin),this.setState({category:t.id,categoryOptions:t.post,pin:s})})),(0,r.Z)(this,"onPostChange",(e=>{this.changeValue("post",e.target.value)})),(0,r.Z)(this,"onAttachmentsChange",(e=>{this.setState(e)})),(0,r.Z)(this,"onClose",(()=>{this.changeValue("close",!0)})),(0,r.Z)(this,"onOpen",(()=>{this.changeValue("close",!1)})),(0,r.Z)(this,"onPinGlobally",(()=>{this.changeValue("pin",2)})),(0,r.Z)(this,"onPinLocally",(()=>{this.changeValue("pin",1)})),(0,r.Z)(this,"onUnpin",(()=>{this.changeValue("pin",0)})),(0,r.Z)(this,"onHide",(()=>{this.changeValue("hide",!0)})),(0,r.Z)(this,"onUnhide",(()=>{this.changeValue("hide",!1)})),(0,r.Z)(this,"close",(()=>{this.minimize(),l.Z.close()})),(0,r.Z)(this,"minimize",(()=>{this.setState({fullscreen:!1,minimized:!0})})),(0,r.Z)(this,"open",(()=>{this.setState({minimized:!1}),this.state.fullscreen})),(0,r.Z)(this,"fullscreenEnter",(()=>{this.setState({fullscreen:!0,minimized:!1})})),(0,r.Z)(this,"fullscreenExit",(()=>{this.setState({fullscreen:!1,minimized:!1})})),this.state={isReady:!1,isLoading:!1,error:null,minimized:!1,fullscreen:!1,options:null,title:"",category:e.category||null,categories:[],post:"",attachments:[],close:!1,hide:!1,pin:0,validators:{title:(0,I.jn)(),post:(0,I.Jh)()},errors:{}}}componentDidMount(){D.Z.get(this.props.config).then(this.loadSuccess,this.loadError)}clean(){if(!this.state.title.trim().length)return j.Z.error(gettext("You have to enter thread title.")),!1;if(!this.state.post.trim().length)return j.Z.error(gettext("You have to enter a message.")),!1;const e=this.validate();return e.title?(j.Z.error(e.title[0]),!1):!e.post||(j.Z.error(e.post[0]),!1)}send(){return D.Z.post(this.props.submit,{title:this.state.title,category:this.state.category,post:this.state.post,attachments:R(this.state.attachments),close:this.state.close,hide:this.state.hide,pin:this.state.pin})}handleSuccess(e){j.Z.success(pgettext("post thread","Your thread has been posted.")),window.location=e.url,this.setState({isLoading:!0})}handleError(e){if(400===e.status){const t=[].concat(e.non_field_errors||[],e.category||[],e.title||[],e.post||[],e.attachments||[]);j.Z.error(t[0])}else j.Z.apiError(e)}render(){const e={minimized:this.state.minimized,minimize:this.minimize,open:this.open,fullscreen:this.state.fullscreen,fullscreenEnter:this.fullscreenEnter,fullscreenExit:this.fullscreenExit,close:this.onCancel};if(this.state.error)return o().createElement(es,e,(0,n.Z)(Qt,{message:this.state.error,close:this.close}));if(!this.state.isReady)return o().createElement(es,e,(0,n.Z)("div",{className:"posting-loading ui-preview"},void 0,Gt||(Gt=(0,n.Z)(St.o8,{className:"posting-dialog-toolbar"},void 0,(0,n.Z)(St.Z2,{className:"posting-dialog-thread-title",auto:!0},void 0,(0,n.Z)(St.Eg,{auto:!0},void 0,(0,n.Z)("input",{className:"form-control",disabled:!0,type:"text"}))),(0,n.Z)(St.Z2,{className:"posting-dialog-category-select",auto:!0},void 0,(0,n.Z)(St.Eg,{},void 0,(0,n.Z)("input",{className:"form-control",disabled:!0,type:"text"}))))),(0,n.Z)(Ct,{attachments:[],value:"",submitText:pgettext("post thread submit","Post thread"),disabled:!0,onAttachmentsChange:()=>{},onChange:()=>{}})));const t=!!(this.state.options.close||this.state.options.hide||this.state.options.pin);return o().createElement(es,e,(0,n.Z)("form",{className:"posting-dialog-form",onSubmit:this.handleSubmit},void 0,(0,n.Z)(St.o8,{className:"posting-dialog-toolbar"},void 0,(0,n.Z)(St.Z2,{className:"posting-dialog-thread-title",auto:!0},void 0,(0,n.Z)(St.Eg,{auto:!0},void 0,(0,n.Z)("input",{className:"form-control",disabled:this.state.isLoading,onChange:this.onTitleChange,placeholder:pgettext("post thread","Thread title"),type:"text",value:this.state.title}))),(0,n.Z)(St.Z2,{className:"posting-dialog-category-select",auto:!0},void 0,(0,n.Z)(St.Eg,{},void 0,(0,n.Z)(L.Z,{choices:this.state.categories,disabled:this.state.isLoading,onChange:this.onCategoryChange,value:this.state.category})),t&&(0,n.Z)(St.Eg,{shrink:!0},void 0,(0,n.Z)(Jt,{isClosed:this.state.close,isHidden:this.state.hide,isPinned:this.state.pin,disabled:this.state.isLoading,options:this.state.options,close:this.onClose,open:this.onOpen,hide:this.onHide,unhide:this.onUnhide,pinGlobally:this.onPinGlobally,pinLocally:this.onPinLocally,unpin:this.onUnpin})))),(0,n.Z)(Ct,{attachments:this.state.attachments,value:this.state.post,submitText:pgettext("post thread submit","Start thread"),disabled:this.state.isLoading,onAttachmentsChange:this.onAttachmentsChange,onChange:this.onPostChange})))}};const es=e=>{let{children:t,close:s,minimized:a,minimize:i,open:o,fullscreen:r,fullscreenEnter:l,fullscreenExit:d}=e;return(0,n.Z)($t,{fullscreen:r,minimized:a},void 0,(0,n.Z)(Kt,{fullscreen:r,fullscreenEnter:l,fullscreenExit:d,minimized:a,minimize:i,open:o,close:s},void 0,pgettext("post thread","Start new thread")),(0,n.Z)(Wt,{},void 0,t))};function ts(e){const t=e.split(",").map((e=>e.trim().toLowerCase())).filter((e=>e.length>0));return t.filter(((e,s)=>t.indexOf(e)==s))}var ss=class extends T.Z{constructor(e){super(e),(0,r.Z)(this,"onCancel",(()=>{window.confirm(pgettext("post thread","Are you sure you want to discard private thread?"))&&this.close()})),(0,r.Z)(this,"onToChange",(e=>{this.changeValue("to",e.target.value)})),(0,r.Z)(this,"onTitleChange",(e=>{this.changeValue("title",e.target.value)})),(0,r.Z)(this,"onPostChange",(e=>{this.changeValue("post",e.target.value)})),(0,r.Z)(this,"onAttachmentsChange",(e=>{this.setState(e)})),(0,r.Z)(this,"close",(()=>{this.minimize(),l.Z.close()})),(0,r.Z)(this,"minimize",(()=>{this.setState({fullscreen:!1,minimized:!0})})),(0,r.Z)(this,"open",(()=>{this.setState({minimized:!1}),this.state.fullscreen})),(0,r.Z)(this,"fullscreenEnter",(()=>{this.setState({fullscreen:!0,minimized:!1})})),(0,r.Z)(this,"fullscreenExit",(()=>{this.setState({fullscreen:!1,minimized:!1})}));const t=(e.to||[]).map((e=>e.username)).join(", ");this.state={isLoading:!1,error:null,minimized:!1,fullscreen:!1,to:t,title:"",post:"",attachments:[],validators:{title:(0,I.jn)(),post:(0,I.Jh)()},errors:{}}}clean(){if(!ts(this.state.to).length)return j.Z.error(gettext("You have to enter at least one recipient.")),!1;if(!this.state.title.trim().length)return j.Z.error(gettext("You have to enter thread title.")),!1;if(!this.state.post.trim().length)return j.Z.error(gettext("You have to enter a message.")),!1;const e=this.validate();return e.title?(j.Z.error(e.title[0]),!1):!e.post||(j.Z.error(e.post[0]),!1)}send(){return D.Z.post(this.props.submit,{to:ts(this.state.to),title:this.state.title,post:this.state.post,attachments:R(this.state.attachments)})}handleSuccess(e){j.Z.success(pgettext("post thread","Your thread has been posted.")),window.location=e.url,this.setState({isLoading:!0})}handleError(e){if(400===e.status){const t=[].concat(e.non_field_errors||[],e.to||[],e.title||[],e.post||[],e.attachments||[]);j.Z.error(t[0])}else j.Z.apiError(e)}render(){const e={minimized:this.state.minimized,minimize:this.minimize,open:this.open,fullscreen:this.state.fullscreen,fullscreenEnter:this.fullscreenEnter,fullscreenExit:this.fullscreenExit,close:this.onCancel};return o().createElement(as,e,(0,n.Z)("form",{className:"posting-dialog-form",onSubmit:this.handleSubmit},void 0,(0,n.Z)(St.o8,{className:"posting-dialog-toolbar"},void 0,(0,n.Z)(St.Z2,{className:"posting-dialog-thread-recipients",auto:!0},void 0,(0,n.Z)(St.Eg,{auto:!0},void 0,(0,n.Z)("input",{className:"form-control",disabled:this.state.isLoading,onChange:this.onToChange,placeholder:pgettext("post thread","Recipients, eg.: Danny, Lisa, Alice"),type:"text",value:this.state.to}))),(0,n.Z)(St.Z2,{className:"posting-dialog-thread-title",auto:!0},void 0,(0,n.Z)(St.Eg,{auto:!0},void 0,(0,n.Z)("input",{className:"form-control",disabled:this.state.isLoading,onChange:this.onTitleChange,placeholder:pgettext("post thread","Thread title"),type:"text",value:this.state.title})))),(0,n.Z)(Ct,{attachments:this.state.attachments,value:this.state.post,submitText:pgettext("post thread submit","Start thread"),disabled:this.state.isLoading,onAttachmentsChange:this.onAttachmentsChange,onChange:this.onPostChange})))}};const as=e=>{let{children:t,close:s,minimized:a,minimize:i,open:o,fullscreen:r,fullscreenEnter:l,fullscreenExit:d}=e;return(0,n.Z)($t,{fullscreen:r,minimized:a},void 0,(0,n.Z)(Kt,{fullscreen:r,fullscreenEnter:l,fullscreenExit:d,minimized:a,minimize:i,open:o,close:s},void 0,pgettext("post thread","Start private thread")),(0,n.Z)(Wt,{},void 0,t))};var is=class extends T.Z{constructor(e){super(e),(0,r.Z)(this,"loadSuccess",(e=>{this.setState({isReady:!0,post:e.post?'[quote="@'+e.poster+'"]\n'+e.post+"\n[/quote]":this.state.post})})),(0,r.Z)(this,"loadError",(e=>{this.setState({error:e.detail})})),(0,r.Z)(this,"appendData",(e=>{const t=e.post?'[quote="@'+e.poster+'"]\n'+e.post+"\n[/quote]\n\n":"";this.setState(((e,s)=>e.post.length>0?{post:e.post+"\n\n"+t}:{post:t})),this.open()})),(0,r.Z)(this,"onCancel",(()=>{window.confirm(pgettext("post reply","Are you sure you want to discard your reply?"))&&this.close()})),(0,r.Z)(this,"onPostChange",(e=>{this.changeValue("post",e.target.value)})),(0,r.Z)(this,"onAttachmentsChange",(e=>{this.setState(e)})),(0,r.Z)(this,"onQuote",(e=>{this.setState((t=>{let{post:s}=t;return s.length>0?{post:s.trim()+"\n\n"+e}:{post:e}})),this.open()})),(0,r.Z)(this,"close",(()=>{this.minimize(),l.Z.close()})),(0,r.Z)(this,"minimize",(()=>{this.setState({fullscreen:!1,minimized:!0})})),(0,r.Z)(this,"open",(()=>{this.setState({minimized:!1}),this.state.fullscreen})),(0,r.Z)(this,"fullscreenEnter",(()=>{this.setState({fullscreen:!0,minimized:!1})})),(0,r.Z)(this,"fullscreenExit",(()=>{this.setState({fullscreen:!1,minimized:!1})})),this.state={isReady:!1,isLoading:!1,error:null,minimized:!1,fullscreen:!1,post:this.props.default||"",attachments:[],validators:{post:(0,I.Jh)()},errors:{}}}componentDidMount(){D.Z.get(this.props.config,this.props.context||null).then(this.loadSuccess,this.loadError),S(!1,this.onQuote)}componentWillUnmount(){E()}componentWillReceiveProps(e){const t=this.props.context,s=e.context;t&&s&&t.reply===s.reply||D.Z.get(e.config,e.context||null).then(this.appendData,j.Z.apiError)}clean(){if(!this.state.post.trim().length)return j.Z.error(gettext("You have to enter a message.")),!1;const e=this.validate();return!e.post||(j.Z.error(e.post[0]),!1)}send(){return S(!0,this.onQuote),D.Z.post(this.props.submit,{post:this.state.post,attachments:R(this.state.attachments)})}handleSuccess(e){j.Z.success(pgettext("post reply","Your reply has been posted.")),window.location=e.url.index,this.setState({isLoading:!0}),S(!1,this.onQuote)}handleError(e){if(400===e.status){const t=[].concat(e.non_field_errors||[],e.post||[],e.attachments||[]);j.Z.error(t[0])}else j.Z.apiError(e);S(!1,this.onQuote)}render(){const e={thread:this.props.thread,minimized:this.state.minimized,minimize:this.minimize,open:this.open,fullscreen:this.state.fullscreen,fullscreenEnter:this.fullscreenEnter,fullscreenExit:this.fullscreenExit,close:this.onCancel};return this.state.error?o().createElement(os,e,(0,n.Z)(Qt,{message:this.state.error,close:this.close})):this.state.isReady?o().createElement(os,e,(0,n.Z)("form",{className:"posting-dialog-form",method:"POST",onSubmit:this.handleSubmit},void 0,(0,n.Z)(Ct,{attachments:this.state.attachments,value:this.state.post,submitText:pgettext("post reply submit","Post reply"),disabled:this.state.isLoading,onAttachmentsChange:this.onAttachmentsChange,onChange:this.onPostChange}))):o().createElement(os,e,(0,n.Z)("div",{className:"posting-loading ui-preview"},void 0,(0,n.Z)(Ct,{attachments:[],value:"",submitText:pgettext("post reply submit","Post reply"),disabled:!0,onAttachmentsChange:()=>{},onChange:()=>{}})))}};const os=e=>{let{children:t,close:s,minimized:a,minimize:i,open:o,fullscreen:r,fullscreenEnter:l,fullscreenExit:d,thread:c}=e;return(0,n.Z)($t,{fullscreen:r,minimized:a},void 0,(0,n.Z)(Kt,{fullscreen:r,fullscreenEnter:l,fullscreenExit:d,minimized:a,minimize:i,open:o,close:s},void 0,interpolate(pgettext("post reply","Reply to: %(thread)s"),{thread:c.title},!0)),(0,n.Z)(Wt,{},void 0,t))};var ns=class extends T.Z{constructor(e){super(e),(0,r.Z)(this,"loadSuccess",(e=>{var t;this.setState({isReady:!0,post:e.post,attachments:(t=e.attachments,t.map((e=>Object.assign({},e,{uploaded_on:O()(e.uploaded_on)})))),protect:e.is_protected,canProtect:e.can_protect})})),(0,r.Z)(this,"loadError",(e=>{this.setState({error:e.detail})})),(0,r.Z)(this,"appendData",(e=>{const t=e.post?'[quote="@'+e.poster+'"]\n'+e.post+"\n[/quote]\n\n":"";this.setState(((e,s)=>e.post.length>0?{post:e.post+"\n\n"+t}:{post:t})),this.open()})),(0,r.Z)(this,"onCancel",(()=>{window.confirm(gettext("Are you sure you want to discard changes?"))&&this.close()})),(0,r.Z)(this,"onProtect",(()=>{this.setState({protect:!0})})),(0,r.Z)(this,"onUnprotect",(()=>{this.setState({protect:!1})})),(0,r.Z)(this,"onPostChange",(e=>{this.changeValue("post",e.target.value)})),(0,r.Z)(this,"onAttachmentsChange",(e=>{this.setState(e)})),(0,r.Z)(this,"onQuote",(e=>{this.setState((t=>{let{post:s}=t;return s.length>0?{post:s.trim()+"\n\n"+e}:{post:e}})),this.open()})),(0,r.Z)(this,"close",(()=>{this.minimize(),l.Z.close()})),(0,r.Z)(this,"minimize",(()=>{this.setState({fullscreen:!1,minimized:!0})})),(0,r.Z)(this,"open",(()=>{this.setState({minimized:!1}),this.state.fullscreen})),(0,r.Z)(this,"fullscreenEnter",(()=>{this.setState({fullscreen:!0,minimized:!1})})),(0,r.Z)(this,"fullscreenExit",(()=>{this.setState({fullscreen:!1,minimized:!1})})),this.state={isReady:!1,isLoading:!1,error:!1,minimized:!1,fullscreen:!1,post:"",attachments:[],protect:!1,canProtect:!1,validators:{post:(0,I.Jh)()},errors:{}}}componentDidMount(){D.Z.get(this.props.config).then(this.loadSuccess,this.loadError),S(!1,this.onQuote)}componentWillUnmount(){E()}componentWillReceiveProps(e){const t=this.props.context,s=e.context;t&&s&&t.reply===s.reply||D.Z.get(e.config,e.context||null).then(this.appendData,j.Z.apiError)}clean(){if(!this.state.post.trim().length)return j.Z.error(gettext("You have to enter a message.")),!1;const e=this.validate();return!e.post||(j.Z.error(e.post[0]),!1)}send(){return S(!0,this.onQuote),D.Z.put(this.props.submit,{post:this.state.post,attachments:R(this.state.attachments),protect:this.state.protect})}handleSuccess(e){j.Z.success(gettext("Reply has been edited.")),window.location=e.url.index,this.setState({isLoading:!0}),S(!1,this.onQuote)}handleError(e){if(400===e.status){const t=[].concat(e.non_field_errors||[],e.category||[],e.title||[],e.post||[],e.attachments||[]);j.Z.error(t[0])}else j.Z.apiError(e);S(!1,this.onQuote)}render(){const e={post:this.props.post,minimized:this.state.minimized,minimize:this.minimize,open:this.open,fullscreen:this.state.fullscreen,fullscreenEnter:this.fullscreenEnter,fullscreenExit:this.fullscreenExit,close:this.onCancel};return this.state.error?o().createElement(rs,e,(0,n.Z)(Qt,{message:this.state.error,close:this.close})):this.state.isReady?o().createElement(rs,e,(0,n.Z)("form",{className:"posting-dialog-form",method:"POST",onSubmit:this.handleSubmit},void 0,(0,n.Z)(Ct,{attachments:this.state.attachments,canProtect:this.state.canProtect,isProtected:this.state.protect,enableProtection:()=>this.setState({protect:!0}),disableProtection:()=>this.setState({protect:!1}),value:this.state.post,submitText:pgettext("edit reply submit","Edit reply"),disabled:this.state.isLoading,onAttachmentsChange:this.onAttachmentsChange,onChange:this.onPostChange}))):o().createElement(rs,e,(0,n.Z)("div",{className:"posting-loading ui-preview"},void 0,(0,n.Z)(Ct,{attachments:[],value:"",submitText:pgettext("edit reply submit","Edit reply"),disabled:!0,onAttachmentsChange:()=>{},onChange:()=>{}})))}};const rs=e=>{let{children:t,close:s,minimized:a,minimize:i,open:o,fullscreen:r,fullscreenEnter:l,fullscreenExit:d,post:c}=e;return(0,n.Z)($t,{fullscreen:r,minimized:a},void 0,(0,n.Z)(Kt,{fullscreen:r,fullscreenEnter:l,fullscreenExit:d,minimized:a,minimize:i,open:o,close:s},void 0,interpolate(pgettext("edit reply","Edit reply by %(poster)s from %(date)s"),{poster:c.poster?c.poster.username:c.poster_name,date:c.posted_on.fromNow()},!0)),(0,n.Z)(Wt,{},void 0,t))};function ls(e){switch(e.mode){case"START":return o().createElement(Xt,e);case"START_PRIVATE":return o().createElement(ss,e);case"REPLY":return o().createElement(is,e);case"EDIT":return o().createElement(ns,e);default:return null}}},12891:function(e,t,s){"use strict";s.d(t,{Jh:function(){return n},jn:function(){return o}});var a=s(55210),i=s(32233);function o(){return[(0,a.Ei)(i.Z.get("SETTINGS").thread_title_length_min,((e,t)=>{const s=ngettext("Thread title should be at least %(limit_value)s character long (it has %(show_value)s).","Thread title should be at least %(limit_value)s characters long (it has %(show_value)s).",e);return interpolate(s,{limit_value:e,show_value:t},!0)})),(0,a.BS)(i.Z.get("SETTINGS").thread_title_length_max,((e,t)=>{const s=ngettext("Thread title cannot be longer than %(limit_value)s character (it has %(show_value)s).","Thread title cannot be longer than %(limit_value)s characters (it has %(show_value)s).",e);return interpolate(s,{limit_value:e,show_value:t},!0)}))]}function n(){return i.Z.get("SETTINGS").post_length_max?[r(),(0,a.BS)(i.Z.get("SETTINGS").post_length_max||1e6,((e,t)=>{const s=ngettext("Posted message cannot be longer than %(limit_value)s character (it has %(show_value)s).","Posted message cannot be longer than %(limit_value)s characters (it has %(show_value)s).",e);return interpolate(s,{limit_value:e,show_value:t},!0)}))]:[r()]}function r(){return(0,a.Ei)(i.Z.get("SETTINGS").post_length_min,((e,t)=>{const s=ngettext("Posted message should be at least %(limit_value)s character long (it has %(show_value)s).","Posted message should be at least %(limit_value)s characters long (it has %(show_value)s).",e);return interpolate(s,{limit_value:e,show_value:t},!0)}))}},60471:function(e,t,s){"use strict";var a=s(22928),i=s(4942),o=s(57588),n=s.n(o);function r(e){let{icon:t}=e;return t?(0,a.Z)("span",{className:"material-icon"},void 0,t):null}t.Z=class extends n().Component{constructor(){super(...arguments),(0,i.Z)(this,"change",(e=>()=>{this.props.onChange({target:{value:e}})}))}getChoice(){let e=null;return this.props.choices.map((t=>{t.value===this.props.value&&(e=t)})),e}getIcon(){return this.getChoice().icon}getLabel(){return this.getChoice().label}render(){return(0,a.Z)("div",{className:"btn-group btn-select-group"},void 0,(0,a.Z)("button",{type:"button",className:"btn btn-select dropdown-toggle",id:this.props.id||null,"data-toggle":"dropdown","aria-haspopup":"true","aria-expanded":"false","aria-describedby":this.props["aria-describedby"]||null,disabled:this.props.disabled||!1},void 0,(0,a.Z)(r,{icon:this.getIcon()}),this.getLabel()),(0,a.Z)("ul",{className:"dropdown-menu"},void 0,this.props.choices.map(((e,t)=>(0,a.Z)("li",{},t,(0,a.Z)("button",{type:"button",className:"btn-link",onClick:this.change(e.value)},void 0,(0,a.Z)(r,{icon:e.icon}),e.label))))))}}},14467:function(e,t,s){"use strict";var a,i=s(22928),o=(s(57588),s(32233)),n=s(82211),r=s(43345),l=s(47235),d=s(78657),c=s(59801),p=s(53904),u=s(93051),h=s(19755);t.Z=class extends r.Z{constructor(e){super(e),this.state={isLoading:!1,showActivation:!1,username:"",password:"",validators:{username:[],password:[]}}}clean(){return!!this.isValid()||(p.Z.error(gettext("Fill out both fields.")),!1)}send(){return d.Z.post(o.Z.get("AUTH_API"),{username:this.state.username,password:this.state.password})}handleSuccess(){let e=h("#hidden-login-form");e.append('<input type="text" name="username" />'),e.append('<input type="password" name="password" />'),e.find('input[type="hidden"]').val(d.Z.getCsrfToken()),e.find('input[name="redirect_to"]').val(window.location.pathname),e.find('input[name="username"]').val(this.state.username),e.find('input[name="password"]').val(this.state.password),e.submit(),this.setState({isLoading:!0})}handleError(e){400===e.status?"inactive_admin"===e.code?p.Z.info(e.detail):"inactive_user"===e.code?(p.Z.info(e.detail),this.setState({showActivation:!0})):"banned"===e.code?((0,u.Z)(e.detail),c.Z.hide()):p.Z.error(e.detail):403===e.status&&e.ban?((0,u.Z)(e.ban),c.Z.hide()):p.Z.apiError(e)}getActivationButton(){return this.state.showActivation?(0,i.Z)("a",{className:"btn btn-success btn-block",href:o.Z.get("REQUEST_ACTIVATION_URL")},void 0,gettext("Activate account")):null}render(){return(0,i.Z)("div",{className:"modal-dialog modal-sm modal-sign-in",role:"document"},void 0,(0,i.Z)("div",{className:"modal-content"},void 0,(0,i.Z)("div",{className:"modal-header"},void 0,(0,i.Z)("button",{"aria-label":pgettext("modal","Close"),className:"close","data-dismiss":"modal",type:"button"},void 0,a||(a=(0,i.Z)("span",{"aria-hidden":"true"},void 0,"×"))),(0,i.Z)("h4",{className:"modal-title"},void 0,gettext("Sign in"))),(0,i.Z)("form",{onSubmit:this.handleSubmit},void 0,(0,i.Z)("div",{className:"modal-body"},void 0,(0,i.Z)(l.Z,{buttonLabel:gettext("Sign in with %(site)s"),formLabel:gettext("Or use your forum account:"),labelClassName:"text-center"}),(0,i.Z)("div",{className:"form-group"},void 0,(0,i.Z)("div",{className:"control-input"},void 0,(0,i.Z)("input",{className:"form-control input-lg",disabled:this.state.isLoading,id:"id_username",onChange:this.bindInput("username"),placeholder:gettext("Username or e-mail"),type:"text",value:this.state.username}))),(0,i.Z)("div",{className:"form-group"},void 0,(0,i.Z)("div",{className:"control-input"},void 0,(0,i.Z)("input",{className:"form-control input-lg",disabled:this.state.isLoading,id:"id_password",onChange:this.bindInput("password"),placeholder:gettext("Password"),type:"password",value:this.state.password})))),(0,i.Z)("div",{className:"modal-footer"},void 0,this.getActivationButton(),(0,i.Z)(n.Z,{className:"btn-primary btn-block",loading:this.state.isLoading},void 0,gettext("Sign in")),(0,i.Z)("a",{className:"btn btn-default btn-block",href:o.Z.get("FORGOTTEN_PASSWORD_URL")},void 0,gettext("Forgot password?"))))))}}},24678:function(e,t,s){"use strict";s.d(t,{Jj:function(){return n},pg:function(){return r}});var a=s(22928),i=s(57588),o=s.n(i);t.ZP=class extends o().Component{getClass(){return function(e){let t="";return e.is_banned?t="banned":e.is_hidden?t="offline":e.is_online_hidden?t="online":e.is_offline_hidden?t="offline":e.is_online?t="online":e.is_offline&&(t="offline"),"user-status user-"+t}(this.props.status)}render(){return(0,a.Z)("span",{className:this.getClass()},void 0,this.props.children)}};class n extends o().Component{getIcon(){return this.props.status.is_banned?"remove_circle_outline":this.props.status.is_hidden?"help_outline":this.props.status.is_online_hidden?"label":this.props.status.is_offline_hidden?"label_outline":this.props.status.is_online?"lens":this.props.status.is_offline?"panorama_fish_eye":void 0}render(){return(0,a.Z)("span",{className:"material-icon status-icon"},void 0,this.getIcon())}}class r extends o().Component{getHelp(){return e=this.props.user,(t=this.props.status).is_banned?t.banned_until?interpolate(gettext("%(username)s is banned until %(ban_expires)s"),{username:e.username,ban_expires:t.banned_until.format("LL, LT")},!0):interpolate(gettext("%(username)s is banned"),{username:e.username},!0):t.is_hidden?interpolate(gettext("%(username)s is hiding presence"),{username:e.username},!0):t.is_online_hidden?interpolate(gettext("%(username)s is online (hidden)"),{username:e.username},!0):t.is_offline_hidden?interpolate(gettext("%(username)s was last seen %(last_click)s (hidden)"),{username:e.username,last_click:t.last_click.fromNow()},!0):t.is_online?interpolate(gettext("%(username)s is online"),{username:e.username},!0):t.is_offline?interpolate(gettext("%(username)s was last seen %(last_click)s"),{username:e.username,last_click:t.last_click.fromNow()},!0):void 0;var e,t}getLabel(){return this.props.status.is_banned?gettext("Banned"):this.props.status.is_hidden?gettext("Hidden"):this.props.status.is_online_hidden?gettext("Online (hidden)"):this.props.status.is_offline_hidden?gettext("Offline (hidden)"):this.props.status.is_online?gettext("Online"):this.props.status.is_offline?gettext("Offline"):void 0}render(){return(0,a.Z)("span",{className:this.props.className||"status-label",title:this.getHelp()},void 0,this.getLabel())}}},7850:function(e,t,s){"use strict";s.d(t,{Z:function(){return b}});var a,i,o,n,r,l=s(22928),d=s(57588),c=s.n(d),p=class extends c().Component{getEmptyMessage(){return this.props.emptyMessage?this.props.emptyMessage:gettext("No name changes have been recorded for your account.")}render(){return(0,l.Z)("div",{className:"username-history ui-ready"},void 0,(0,l.Z)("ul",{className:"list-group"},void 0,(0,l.Z)("li",{className:"list-group-item empty-message"},void 0,this.getEmptyMessage())))}},u=s(19605),h=class extends c().Component{renderUserAvatar(){return this.props.change.changed_by?(0,l.Z)("a",{href:this.props.change.changed_by.url,className:"user-avatar-wrapper"},void 0,(0,l.Z)(u.ZP,{user:this.props.change.changed_by,size:"100"})):a||(a=(0,l.Z)("span",{className:"user-avatar-wrapper"},void 0,(0,l.Z)(u.ZP,{size:"100"})))}renderUsername(){return this.props.change.changed_by?(0,l.Z)("a",{href:this.props.change.changed_by.url,className:"item-title"},void 0,this.props.change.changed_by.username):(0,l.Z)("span",{className:"item-title"},void 0,this.props.change.changed_by_username)}render(){return(0,l.Z)("li",{className:"list-group-item"},this.props.change.id,(0,l.Z)("div",{className:"change-avatar"},void 0,this.renderUserAvatar()),(0,l.Z)("div",{className:"change-author"},void 0,this.renderUsername()),(0,l.Z)("div",{className:"change"},void 0,(0,l.Z)("span",{className:"old-username"},void 0,this.props.change.old_username),i||(i=(0,l.Z)("span",{className:"material-icon"},void 0,"arrow_forward")),(0,l.Z)("span",{className:"new-username"},void 0,this.props.change.new_username)),(0,l.Z)("div",{className:"change-date"},void 0,(0,l.Z)("abbr",{title:this.props.change.changed_on.format("LLL")},void 0,this.props.change.changed_on.fromNow())))}},m=class extends c().Component{render(){return(0,l.Z)("div",{className:"username-history ui-ready"},void 0,(0,l.Z)("ul",{className:"list-group"},void 0,this.props.changes.map((e=>(0,l.Z)(h,{change:e},e.id)))))}},v=s(44039),g=class extends c().Component{shouldComponentUpdate(){return!1}getClassName(){return this.props.hiddenOnMobile?"list-group-item hidden-xs hidden-sm":"list-group-item"}render(){return(0,l.Z)("li",{className:this.getClassName()},void 0,o||(o=(0,l.Z)("div",{className:"change-avatar"},void 0,(0,l.Z)("span",{className:"user-avatar"},void 0,(0,l.Z)(u.ZP,{size:"100"})))),(0,l.Z)("div",{className:"change-author"},void 0,(0,l.Z)("span",{className:"ui-preview-text",style:{width:v.e(30,100)+"px"}},void 0," ")),(0,l.Z)("div",{className:"change"},void 0,(0,l.Z)("span",{className:"ui-preview-text",style:{width:v.e(30,70)+"px"}},void 0," "),n||(n=(0,l.Z)("span",{className:"material-icon"},void 0,"arrow_forward")),(0,l.Z)("span",{className:"ui-preview-text",style:{width:v.e(30,70)+"px"}},void 0," ")),(0,l.Z)("div",{className:"change-date"},void 0,(0,l.Z)("span",{className:"ui-preview-text",style:{width:v.e(80,140)+"px"}},void 0," ")))}},Z=class extends c().Component{shouldComponentUpdate(){return!1}render(){return(0,l.Z)("div",{className:"username-history ui-preview"},void 0,(0,l.Z)("ul",{className:"list-group"},void 0,[0,1,2].map((e=>(0,l.Z)(g,{hiddenOnMobile:e>0},e)))))}},b=class extends c().Component{render(){return this.props.isLoaded?this.props.changes.length?(0,l.Z)(m,{changes:this.props.changes}):(0,l.Z)(p,{emptyMessage:this.props.emptyMessage}):r||(r=(0,l.Z)(Z,{}))}}},40429:function(e,t,s){"use strict";s.d(t,{Z:function(){return k}});var a,i=s(22928),o=s(57588),n=s.n(o),r=s(19605),l=s(24678);function d(e){let{showStatus:t,user:s}=e;return(0,i.Z)("ul",{className:"list-unstyled"},void 0,(0,i.Z)(c,{showStatus:t,user:s}),(0,i.Z)(p,{user:s}),a||(a=(0,i.Z)("li",{className:"user-stat-divider"})),(0,i.Z)(u,{user:s}),(0,i.Z)(h,{user:s}),(0,i.Z)(m,{user:s}))}function c(e){let{showStatus:t,user:s}=e;return t?(0,i.Z)("li",{className:"user-stat-status"},void 0,(0,i.Z)(l.ZP,{status:s.status},void 0,(0,i.Z)(l.pg,{status:s.status,user:s}))):null}function p(e){let{user:t}=e;const{joined_on:s}=t;let a=interpolate(gettext("Joined on %(joined_on)s"),{joined_on:s.format("LL, LT")},!0),o=interpolate(gettext("Joined %(joined_on)s"),{joined_on:s.fromNow()},!0);return(0,i.Z)("li",{className:"user-stat-join-date"},void 0,(0,i.Z)("abbr",{title:a},void 0,o))}function u(e){let{user:t}=e;const s=v("user-stat-posts",t.posts),a=ngettext("%(posts)s post","%(posts)s posts",t.posts);return(0,i.Z)("li",{className:s},void 0,interpolate(a,{posts:t.posts},!0))}function h(e){let{user:t}=e;const s=v("user-stat-threads",t.threads),a=ngettext("%(threads)s thread","%(threads)s threads",t.threads);return(0,i.Z)("li",{className:s},void 0,interpolate(a,{threads:t.threads},!0))}function m(e){let{user:t}=e;const s=v("user-stat-followers",t.followers),a=ngettext("%(followers)s follower","%(followers)s followers",t.followers);return(0,i.Z)("li",{className:s},void 0,interpolate(a,{followers:t.followers},!0))}function v(e,t){return 0===t?e+" user-stat-empty":e}function g(e){let{rank:t,title:s}=e,a=s||t.title||t.name,o="user-title";return t.css_class&&(o+=" user-title-"+t.css_class),t.is_tab?(0,i.Z)("a",{className:o,href:t.url},void 0,a):(0,i.Z)("span",{className:o},void 0,a)}function Z(e){let{showStatus:t,user:s}=e;const{rank:a}=s;let o="panel user-card";return a.css_class&&(o+=" user-card-"+a.css_class),(0,i.Z)("div",{className:o},void 0,(0,i.Z)("div",{className:"panel-body"},void 0,(0,i.Z)("div",{className:"row"},void 0,(0,i.Z)("div",{className:"col-xs-3 user-card-left"},void 0,(0,i.Z)("div",{className:"user-card-small-avatar"},void 0,(0,i.Z)("a",{href:s.url},void 0,(0,i.Z)(r.ZP,{size:"50",size2x:"80",user:s})))),(0,i.Z)("div",{className:"col-xs-9 col-sm-12 user-card-body"},void 0,(0,i.Z)("div",{className:"user-card-avatar"},void 0,(0,i.Z)("a",{href:s.url},void 0,(0,i.Z)(r.ZP,{size:"150",size2x:"200",user:s}))),(0,i.Z)("div",{className:"user-card-username"},void 0,(0,i.Z)("a",{href:s.url},void 0,s.username)),(0,i.Z)("div",{className:"user-card-title"},void 0,(0,i.Z)(g,{rank:a,title:s.title})),(0,i.Z)("div",{className:"user-card-stats"},void 0,(0,i.Z)(d,{showStatus:t,user:s}))))))}var b,f,_,N,x=s(44039),y=class extends n().Component{shouldComponentUpdate(){return!1}render(){return(0,i.Z)("div",{className:"panel user-card user-card-preview"},void 0,(0,i.Z)("div",{className:"panel-body"},void 0,(0,i.Z)("div",{className:"row"},void 0,b||(b=(0,i.Z)("div",{className:"col-xs-3 user-card-left"},void 0,(0,i.Z)("div",{className:"user-card-small-avatar"},void 0,(0,i.Z)("span",{},void 0,(0,i.Z)(r.ZP,{size:"50",size2x:"80"}))))),(0,i.Z)("div",{className:"col-xs-9 col-sm-12 user-card-body"},void 0,f||(f=(0,i.Z)("div",{className:"user-card-avatar"},void 0,(0,i.Z)("span",{},void 0,(0,i.Z)(r.ZP,{size:"150",size2x:"200"})))),(0,i.Z)("div",{className:"user-card-username"},void 0,(0,i.Z)("span",{className:"ui-preview-text",style:{width:x.e(60,150)+"px"}},void 0," ")),(0,i.Z)("div",{className:"user-card-title"},void 0,(0,i.Z)("span",{className:"ui-preview-text",style:{width:x.e(60,150)+"px"}},void 0," ")),(0,i.Z)("div",{className:"user-card-stats"},void 0,(0,i.Z)("ul",{className:"list-unstyled"},void 0,(0,i.Z)("li",{},void 0,(0,i.Z)("span",{className:"ui-preview-text",style:{width:x.e(30,70)+"px"}},void 0," ")),(0,i.Z)("li",{},void 0,(0,i.Z)("span",{className:"ui-preview-text",style:{width:x.e(30,70)+"px"}},void 0," ")),_||(_=(0,i.Z)("li",{className:"user-stat-divider"})),(0,i.Z)("li",{},void 0,(0,i.Z)("span",{className:"ui-preview-text",style:{width:x.e(30,70)+"px"}},void 0," ")),(0,i.Z)("li",{},void 0,(0,i.Z)("span",{className:"ui-preview-text",style:{width:x.e(30,70)+"px"}},void 0," "))))))))}};function w(e){let{colClassName:t,cols:s}=e;const a=Array.apply(null,{length:s}).map(Number.call,Number);return(0,i.Z)("div",{className:"users-cards-list ui-preview"},void 0,(0,i.Z)("div",{className:"row"},void 0,a.map((e=>{let s=t;return 0!==e&&(s+=" hidden-xs"),3===e&&(s+=" hidden-sm"),(0,i.Z)("div",{className:s},e,N||(N=(0,i.Z)(y,{})))}))))}function k(e){let{cols:t,isReady:s,showStatus:a,users:o}=e,n="col-xs-12 col-sm-4";return 4===t&&(n+=" col-md-3"),s?(0,i.Z)("div",{className:"users-cards-list ui-ready"},void 0,(0,i.Z)("div",{className:"row"},void 0,o.map((e=>(0,i.Z)("div",{className:n},e.id,(0,i.Z)(Z,{showStatus:a,user:e})))))):(0,i.Z)(w,{colClassName:n,cols:t})}},82125:function(e,t,s){"use strict";var a=s(4942),i=s(57588),o=s.n(i);t.Z=class extends o().Component{constructor(e){super(e),(0,a.Z)(this,"toggleNav",(()=>{this.setState({dropdown:!this.state.dropdown})})),(0,a.Z)(this,"hideNav",(()=>{this.setState({dropdown:!1})})),this.state={dropdown:!1}}getCompactNavClassName(){return this.state.dropdown?"compact-nav open":"compact-nav"}}},7227:function(e,t,s){"use strict";var a=s(22928),i=s(4942),o=s(57588),n=s.n(o);t.Z=class extends n().Component{constructor(){super(...arguments),(0,i.Z)(this,"toggle",(()=>{this.props.onChange({target:{value:!this.props.value}})}))}getClassName(){return this.props.value?"btn btn-yes-no btn-yes-no-on":"btn btn-yes-no btn-yes-no-off"}getIcon(){return this.props.value?this.props.iconOn||"check_box":this.props.iconOff||"check_box_outline_blank"}getLabel(){return this.props.value?this.props.labelOn||gettext("yes"):this.props.labelOff||gettext("no")}render(){return(0,a.Z)("button",{type:"button",onClick:this.toggle,className:this.getClassName(),id:this.props.id||null,"aria-describedby":this.props["aria-describedby"]||null,disabled:this.props.disabled||!1},void 0,(0,a.Z)("span",{className:"material-icon"},void 0,this.getIcon()),(0,a.Z)("span",{className:"btn-text"},void 0,this.getLabel()))}}},32233:function(e,t,s){"use strict";s.d(t,{Z:function(){return i}}),s(58294),s(95377),s(68852),s(39737),s(14316),s(43204),s(43511),s(7023);var a=new class{constructor(){this._initializers=[],this._context={}}addInitializer(e){this._initializers.push({key:e.name,item:e.initializer,after:e.after,before:e.before})}init(e){this._context=e,new class{constructor(e){this.isOrdered=!1,this._items=e||[]}add(e,t,s){this._items.push({key:e,item:t,after:s&&s.after||null,before:s&&s.before||null})}get(e,t){for(var s=0;s<this._items.length;s++)if(this._items[s].key===e)return this._items[s].item;return t}has(e){return void 0!==this.get(e)}values(){for(var e=[],t=0;t<this._items.length;t++)e.push(this._items[t].item);return e}order(e){return this.isOrdered||(this._items=this._order(this._items),this.isOrdered=!0),e||void 0===e?this.values():this._items}orderedValues(){return this.order(!0)}_order(e){var t=[];e.forEach((function(e){t.push(e.key)}));var s=[],a=[];function i(e){var t=-1;-1===a.indexOf(e.key)&&(e.after?-1!==(t=a.indexOf(e.after))&&(t+=1):e.before&&(t=a.indexOf(e.before)),-1!==t&&(s.splice(t,0,e),a.splice(t,0,e.key)))}e.forEach((function(e){e.after||e.before||(s.push(e),a.push(e.key))})),e.forEach((function(e){"_end"===e.before&&(s.push(e),a.push(e.key))}));for(var o=200;o>0&&t.length!==a.length;)o-=1,e.forEach(i);return s}}(this._initializers).orderedValues().forEach((e=>{e(this)}))}has(e){return!!this._context[e]}get(e,t){return this.has(e)?this._context[e]:t||void 0}pop(e){if(this.has(e)){let t=this._context[e];return this._context[e]=null,t}}};window.misago=a;var i=a},58339:function(e,t,s){"use strict";var a=s(32233),i=s(78657);a.Z.addInitializer({name:"ajax",initializer:function(){i.Z.init(a.Z.get("CSRF_COOKIE_NAME"))}})},64109:function(e,t,s){"use strict";var a=s(32233),i=s(35486),o=s(78657),n=s(53904),r=s(90287);a.Z.addInitializer({name:"auth-sync",initializer:function(e){e.get("isAuthenticated")&&window.setInterval((function(){o.Z.get(e.get("AUTH_API")).then((function(e){r.Z.dispatch((0,i.r$)(e))}),(function(e){n.Z.apiError(e)}))}),45e3)},after:"auth"})},46226:function(e,t,s){"use strict";var a=s(32233),i=s(98274),o=s(59801),n=s(90287),r=s(62833);a.Z.addInitializer({name:"auth",initializer:function(){i.Z.init(n.Z,r.Z,o.Z)},after:"store"})},93240:function(e,t,s){"use strict";var a=s(32233),i=s(78657),o=s(93825),n=s(96142),r=s(53904);a.Z.addInitializer({name:"captcha",initializer:function(e){o.ZP.init(e,i.Z,n.Z,r.Z)}})},75147:function(e,t,s){"use strict";var a=s(22928),i=s(57588),o=s.n(i),n=s(32233),r=s(4942),l=s(78657);class d extends o().Component{constructor(e){super(e),(0,r.Z)(this,"handleDecline",(()=>{this.state.submiting||window.confirm(gettext("Declining will result in immediate deactivation and deletion of your account. This action is not reversible."))&&(this.setState({submiting:!0}),l.Z.post(this.props.api,{accept:!1}).then((()=>{window.location.reload(!0)})))})),(0,r.Z)(this,"handleAccept",(()=>{this.state.submiting||(this.setState({submiting:!0}),l.Z.post(this.props.api,{accept:!0}).then((()=>{window.location.reload(!0)})))})),this.state={submiting:!1}}render(){return(0,a.Z)("div",{},void 0,(0,a.Z)("button",{className:"btn btn-default",disabled:this.state.submiting,type:"buton",onClick:this.handleDecline},void 0,gettext("Decline")),(0,a.Z)("button",{className:"btn btn-primary",disabled:this.state.submiting,type:"buton",onClick:this.handleAccept},void 0,gettext("Accept and continue")))}}var c=s(4869);n.Z.addInitializer({name:"component:accept-agreement",initializer:function(e){document.getElementById("required-agreement-mount")&&(0,c.Z)((0,a.Z)(d,{api:e.get("REQUIRED_AGREEMENT_API")}),"required-agreement-mount",!1)},after:"store"})},4894:function(e,t,s){"use strict";var a=s(37424),i=s(32233),o=s(22928),n=s(57588),r=s.n(n),l=class extends r().Component{refresh(){window.location.reload()}getMessage(){return this.props.signedIn?interpolate(gettext("You have signed in as %(username)s. Please refresh the page before continuing."),{username:this.props.signedIn.username},!0):this.props.signedOut?interpolate(gettext("%(username)s, you have been signed out. Please refresh the page before continuing."),{username:this.props.user.username},!0):void 0}render(){let e="auth-message";return(this.props.signedIn||this.props.signedOut)&&(e+=" show"),(0,o.Z)("div",{className:e},void 0,(0,o.Z)("div",{className:"container"},void 0,(0,o.Z)("p",{className:"lead"},void 0,this.getMessage()),(0,o.Z)("p",{},void 0,(0,o.Z)("button",{className:"btn btn-default",type:"button",onClick:this.refresh},void 0,gettext("Reload page")),(0,o.Z)("span",{className:"hidden-xs hidden-sm"},void 0," "+gettext("or press F5 key.")))))}};function d(e){return{user:e.auth.user,signedIn:e.auth.signedIn,signedOut:e.auth.signedOut}}var c=s(4869);i.Z.addInitializer({name:"component:auth-message",initializer:function(){(0,c.Z)((0,a.$j)(d)(l),"auth-message-mount")},after:"store"})},29223:function(e,t,s){"use strict";var a=s(32233),i=s(93051);a.Z.addInitializer({name:"component:banmed-page",initializer:function(e){e.has("BAN_MESSAGE")&&(0,i.Z)(e.get("BAN_MESSAGE"),!1)},after:"store"})},3026:function(e,t,s){"use strict";var a=s(37424),i=s(22928),o=s(4942),n=s(30381),r=s.n(n),l=s(57588),d=s.n(l);function c(e){return(0,i.Z)("div",{className:"categories-list"},void 0,(0,i.Z)("ul",{className:"list-group"},void 0,(0,i.Z)("li",{className:"list-group-item empty-message"},void 0,(0,i.Z)("p",{className:"lead"},void 0,gettext("No categories exist or you don't have permission to see them.")))))}function p(e){let{category:t}=e;return t.description?(0,i.Z)("div",{className:"category-description",dangerouslySetInnerHTML:{__html:t.description.html}}):null}function u(e){let{category:t}=e;return(0,i.Z)("div",{className:h(t),title:m(t)},void 0,(0,i.Z)("span",{className:"material-icon"},void 0,function(e){return e.is_closed?e.is_read?"lock_outline":"lock":e.is_read?"chat_bubble_outline":"chat_bubble"}(t)))}function h(e){return e.is_read?"read-status item-read":"read-status item-new"}function m(e){return e.is_closed?e.is_read?gettext("This category has no new posts. (closed)"):gettext("This category has new posts. (closed)"):e.is_read?gettext("This category has no new posts."):gettext("This category has new posts.")}function v(e){let{category:t}=e;return(0,i.Z)("div",{className:"col-xs-12 col-sm-6 col-md-6 category-main"},void 0,(0,i.Z)("div",{className:"media"},void 0,(0,i.Z)("div",{className:"media-left"},void 0,(0,i.Z)(u,{category:t})),(0,i.Z)("div",{className:"media-body"},void 0,(0,i.Z)("h4",{className:"media-heading"},void 0,(0,i.Z)("a",{href:t.url.index},void 0,t.name)),(0,i.Z)(p,{category:t}))))}var g,Z,b,f=s(19605);function _(e){let{category:t}=e;return(0,i.Z)("div",{className:"col-xs-12 col-sm-6 col-md-4 category-last-thread"},void 0,(0,i.Z)(N,{category:t}),(0,i.Z)(w,{category:t}),(0,i.Z)(k,{category:t}),(0,i.Z)(C,{category:t}))}function N(e){let{category:t}=e;return t.acl.can_browse&&t.acl.can_see_all_threads&&t.last_thread_title?(0,i.Z)("div",{className:"media"},void 0,(0,i.Z)("div",{className:"media-left hidden-xs"},void 0,(0,i.Z)(x,{category:t})),(0,i.Z)("div",{className:"media-body"},void 0,(0,i.Z)("div",{className:"media-heading"},void 0,(0,i.Z)("a",{className:"item-title thread-title",href:t.url.last_thread_new,title:t.last_thread_title},void 0,t.last_thread_title)),(0,i.Z)("ul",{className:"list-inline"},void 0,(0,i.Z)("li",{className:"category-last-thread-poster"},void 0,(0,i.Z)(y,{category:t})),g||(g=(0,i.Z)("li",{className:"divider"},void 0,"—")),(0,i.Z)("li",{className:"category-last-thread-date"},void 0,(0,i.Z)("a",{href:t.url.last_post},void 0,t.last_post_on.fromNow()))))):null}function x(e){let{category:t}=e;return t.last_poster?(0,i.Z)("a",{className:"last-poster-avatar",href:t.last_poster.url,title:t.last_poster_name},void 0,(0,i.Z)(f.ZP,{className:"media-object",size:40,user:t.last_poster})):(0,i.Z)("span",{className:"last-poster-avatar",title:t.last_poster_name},void 0,Z||(Z=(0,i.Z)(f.ZP,{className:"media-object",size:40})))}function y(e){let{category:t}=e;return t.last_poster?(0,i.Z)("a",{className:"item-title",href:t.last_poster.url},void 0,t.last_poster_name):(0,i.Z)("span",{className:"item-title"},void 0,t.last_poster_name)}function w(e){let{category:t}=e;return t.acl.can_browse&&t.acl.can_see_all_threads?t.last_thread_title?null:(0,i.Z)(S,{message:gettext("This category is empty. No threads were posted within it so far.")}):null}function k(e){let{category:t}=e;return t.acl.can_browse?t.acl.can_see_all_threads?null:(0,i.Z)(S,{message:gettext("This category is private. You can see only your own threads within it.")}):null}function C(e){let{category:t}=e;return t.acl.can_browse?null:(0,i.Z)(S,{message:gettext("This category is protected. You can't browse its contents.")})}function S(e){let{message:t}=e;return(0,i.Z)("div",{className:"media category-thread-message"},void 0,b||(b=(0,i.Z)("div",{className:"media-left"},void 0,(0,i.Z)("span",{className:"material-icon"},void 0,"info_outline"))),(0,i.Z)("div",{className:"media-body"},void 0,(0,i.Z)("p",{},void 0,t)))}function E(e){let{category:t}=e;return(0,i.Z)("div",{className:"col-md-2 hidden-xs hidden-sm"},void 0,(0,i.Z)("ul",{className:"list-unstyled category-stats"},void 0,(0,i.Z)(L,{threads:t.threads}),(0,i.Z)(T,{posts:t.posts})))}function L(e){let{threads:t}=e;const s=ngettext("%(threads)s thread","%(threads)s threads",t);return(0,i.Z)("li",{className:"category-stat-threads"},void 0,interpolate(s,{threads:t},!0))}function T(e){let{posts:t}=e;const s=ngettext("%(posts)s post","%(posts)s posts",t);return(0,i.Z)("li",{className:"category-stat-posts"},void 0,interpolate(s,{posts:t},!0))}function P(e){let{category:t}=e,s="btn btn-default btn-block btn-sm btn-subcategory";return t.is_read||(s+=" btn-subcategory-new"),(0,i.Z)("div",{className:"col-xs-12 col-sm-4 col-md-3"},void 0,(0,i.Z)("a",{className:s,href:t.url.index},void 0,(0,i.Z)("span",{className:"material-icon"},void 0,function(e){return e.is_closed?e.is_read?"lock_outline":"lock":e.is_read?"chat_bubble_outline":"chat_bubble"}(t)),(0,i.Z)("span",{className:"icon-text"},void 0,t.name)))}function O(e){let{category:t,isFirst:s}=e;return s||0===t.subcategories.length?null:(0,i.Z)("div",{className:"row subcategories-list"},void 0,t.subcategories.map((e=>(0,i.Z)(P,{category:e},e.id))))}function R(e){let{category:t,isFirst:s}=e,a="list-group-item";return t.description?a+=" list-group-category-has-description":a+=" list-group-category-no-description",s&&(a+=" list-group-item-first"),t.css_class&&(a+=" list-group-category-has-flavor",a+=" list-group-item-category-"+t.css_class),(0,i.Z)("li",{className:a},void 0,(0,i.Z)("div",{className:"row"},void 0,(0,i.Z)(v,{category:t}),(0,i.Z)(E,{category:t}),(0,i.Z)(_,{category:t})),(0,i.Z)(O,{category:t,isFirst:s}))}function A(e){let{category:t}=e,s="list-group list-group-category";return t.css_class&&(s+=" list-group-category-has-flavor",s+=" list-group-category-"+t.css_class),(0,i.Z)("ul",{className:s},void 0,(0,i.Z)(R,{category:t,isFirst:!0}),t.subcategories.map((e=>(0,i.Z)(R,{category:e,isFirst:!1},e.id))))}function I(e){let{categories:t}=e;return(0,i.Z)("div",{className:"categories-list"},void 0,t.map((e=>(0,i.Z)(A,{category:e},e.id))))}var D,j=s(32233),z=s(55547);const U=function(e){return Object.assign({},e,{last_post_on:e.last_post_on?r()(e.last_post_on):null,subcategories:e.subcategories.map(U)})};var M=class extends d().Component{constructor(e){super(e),(0,o.Z)(this,"update",(e=>{this.setState({categories:e.map(U)})})),this.state={categories:j.Z.get("CATEGORIES").map(U)},this.startPolling(j.Z.get("CATEGORIES_API"))}startPolling(e){z.Z.start({poll:"categories",url:e,frequency:18e4,update:this.update})}render(){const{categories:e}=this.state;return 0===e.length?D||(D=(0,i.Z)(c,{})):(0,i.Z)(I,{categories:e})}};function B(e){return{tick:e.tick.tick}}var q=s(4869);j.Z.addInitializer({name:"component:categories",initializer:function(){document.getElementById("categories-mount")&&(0,q.Z)((0,a.$j)(B)(M),"categories-mount")},after:"store"})},94795:function(e,t,s){"use strict";var a=s(22928),i=s(57588),o=s.n(i),n=s(37424),r=s(69987),l=s(94417);function d(e){return(0,a.Z)("div",{className:"list-group nav-side"},void 0,e.options.map((t=>(0,a.Z)(r.rU,{to:e.baseUrl+t.component+"/",className:"list-group-item",activeClassName:"active"},t.component,(0,a.Z)("span",{className:"material-icon"},void 0,t.icon),t.name))))}function c(e){return(0,a.Z)("ul",{className:e.className||"dropdown-menu",role:"menu"},void 0,e.options.map((t=>(0,a.Z)(l.Z,{path:e.baseUrl+t.component+"/"},t.component,(0,a.Z)(r.rU,{to:e.baseUrl+t.component+"/",onClick:e.hideNav},void 0,(0,a.Z)("span",{className:"material-icon hidden-sm"},void 0,t.icon),t.name)))))}var p,u=s(4942),h=s(82211),m=s(78657),v=s(53328),g=s(53904),Z=s(90287),b=s(32233),f=class extends o().Component{constructor(e){super(e),(0,u.Z)(this,"onPasswordChange",(e=>{this.setState({password:e.target.value})})),(0,u.Z)(this,"handleSubmit",(e=>{e.preventDefault();const{isLoading:t,password:s}=this.state,{user:a}=this.props;return 0==s.length?(g.Z.error(gettext("Enter your password to confirm account deletion.")),!1):!t&&(this.setState({isLoading:!0}),void m.Z.post(a.api.delete,{password:s}).then((e=>{window.location.href=b.Z.get("MISAGO_PATH")}),(e=>{this.setState({isLoading:!1}),e.password?g.Z.error(e.password[0]):g.Z.apiError(e)})))})),this.state={isLoading:!1,password:""}}componentDidMount(){v.Z.set({title:gettext("Delete account"),parent:gettext("Change your options")})}render(){return(0,a.Z)("form",{onSubmit:this.handleSubmit},void 0,(0,a.Z)("div",{className:"panel panel-danger panel-form"},void 0,(0,a.Z)("div",{className:"panel-heading"},void 0,(0,a.Z)("h3",{className:"panel-title"},void 0,gettext("Delete account"))),(0,a.Z)("div",{className:"panel-body"},void 0,(0,a.Z)("p",{className:"lead"},void 0,gettext("You are going to delete your account. This action is nonreversible, and will result in following data being deleted:")),(0,a.Z)("p",{},void 0,"-"," ",gettext("Stored IP addresses associated with content that you have posted will be deleted.")),(0,a.Z)("p",{},void 0,"-"," ",gettext("Your username will become available for other user to rename to or for new user to register their account with.")),(0,a.Z)("p",{},void 0,"-"," ",gettext("Your e-mail will become available for use in new account registration.")),p||(p=(0,a.Z)("hr",{})),(0,a.Z)("p",{},void 0,gettext("All your posted content will NOT be deleted, but username associated with it will be changed to one shared by all deleted accounts."))),(0,a.Z)("div",{className:"panel-footer"},void 0,(0,a.Z)("div",{className:"input-group"},void 0,(0,a.Z)("input",{className:"form-control",disabled:this.state.isLoading,name:"password-confirmation",type:"password",placeholder:gettext("Enter your password to confirm account deletion."),value:this.state.password,onChange:this.onPasswordChange}),(0,a.Z)("span",{className:"input-group-btn"},void 0,(0,a.Z)(h.Z,{className:"btn-danger",loading:this.state.isLoading},void 0,gettext("Delete my account")))))))}},_=s(21688),N=class extends o().Component{constructor(){super(...arguments),(0,u.Z)(this,"onSuccess",(()=>{g.Z.info(gettext("Your details have been updated."))}))}componentDidMount(){v.Z.set({title:gettext("Edit details"),parent:gettext("Change your options")})}render(){return(0,a.Z)(_.Z,{api:this.props.user.api.edit_details,onSuccess:this.onSuccess})}},x=s(30381),y=s.n(x);class w extends o().Component{constructor(e){super(e),(0,u.Z)(this,"handleLoadDownloads",(()=>{m.Z.get(this.props.user.api.data_downloads).then((e=>{this.setState({isLoading:!1,downloads:e})}),(e=>{g.Z.apiError(e)}))})),(0,u.Z)(this,"handleRequestDataDownload",(()=>{this.setState({isSubmiting:!0}),m.Z.post(this.props.user.api.request_data_download).then((()=>{this.handleLoadDownloads(),g.Z.success(gettext("Your request for data download has been registered.")),this.setState({isSubmiting:!1})}),(e=>{g.Z.apiError(e),this.setState({isSubmiting:!1})}))})),this.state={isLoading:!1,isSubmiting:!1,downloads:[]}}componentDidMount(){v.Z.set({title:gettext("Download your data"),parent:gettext("Change your options")}),this.handleLoadDownloads()}render(){return(0,a.Z)("div",{},void 0,(0,a.Z)("div",{className:"panel panel-default panel-form"},void 0,(0,a.Z)("div",{className:"panel-heading"},void 0,(0,a.Z)("h3",{className:"panel-title"},void 0,gettext("Download your data"))),(0,a.Z)("div",{className:"panel-body"},void 0,(0,a.Z)("p",{},void 0,gettext('To download your data from the site, click the "Request data download" button. Depending on amount of data to be archived and number of users wanting to download their data at same time it may take up to few days for your download to be prepared. An e-mail with notification will be sent to you when your data is ready to be downloaded.')),(0,a.Z)("p",{},void 0,gettext("The download will only be available for limited amount of time, after which it will be deleted from the site and marked as expired."))),(0,a.Z)("table",{className:"table"},void 0,(0,a.Z)("thead",{},void 0,(0,a.Z)("tr",{},void 0,(0,a.Z)("th",{},void 0,gettext("Requested on")),(0,a.Z)("th",{className:"col-md-4"},void 0,gettext("Download")))),(0,a.Z)("tbody",{},void 0,this.state.downloads.map((e=>(0,a.Z)("tr",{},e.id,(0,a.Z)("td",{style:k},void 0,y()(e.requested_on).fromNow()),(0,a.Z)("td",{},void 0,(0,a.Z)(C,{exportFile:e.file,status:e.status}))))),0==this.state.downloads.length?(0,a.Z)("tr",{},void 0,(0,a.Z)("td",{colSpan:"2"},void 0,gettext("You have no data downloads."))):null)),(0,a.Z)("div",{className:"panel-footer text-right"},void 0,(0,a.Z)(h.Z,{className:"btn-primary",loading:this.state.isSubmiting,type:"button",onClick:this.handleRequestDataDownload},void 0,gettext("Request data download")))))}}const k={verticalAlign:"middle"},C=e=>{let{exportFile:t,status:s}=e;return 0===s||1===s?(0,a.Z)(h.Z,{className:"btn-info btn-sm btn-block",disabled:!0,type:"button"},void 0,gettext("Download is being prepared")):t?(0,a.Z)("a",{className:"btn btn-success btn-sm btn-block",href:t},void 0,gettext("Download your data")):(0,a.Z)(h.Z,{className:"btn-default btn-sm btn-block",disabled:!0,type:"button"},void 0,gettext("Download is expired"))};var S,E=s(43345),L=s(96359),T=s(60471),P=s(7227),O=s(35486),R=class extends E.Z{constructor(e){super(e),this.state={isLoading:!1,is_hiding_presence:e.user.is_hiding_presence,limits_private_thread_invites_to:e.user.limits_private_thread_invites_to,subscribe_to_started_threads:e.user.subscribe_to_started_threads,subscribe_to_replied_threads:e.user.subscribe_to_replied_threads,errors:{}},this.privateThreadInvitesChoices=[{value:0,icon:"help_outline",label:gettext("Everybody")},{value:1,icon:"done_all",label:gettext("Users I follow")},{value:2,icon:"highlight_off",label:gettext("Nobody")}],this.subscribeToChoices=[{value:0,icon:"star_border",label:gettext("No")},{value:1,icon:"star_half",label:gettext("Notify")},{value:2,icon:"star",label:gettext("Notify with e-mail")}]}send(){return m.Z.post(this.props.user.api.options,{is_hiding_presence:this.state.is_hiding_presence,limits_private_thread_invites_to:this.state.limits_private_thread_invites_to,subscribe_to_started_threads:this.state.subscribe_to_started_threads,subscribe_to_replied_threads:this.state.subscribe_to_replied_threads})}handleSuccess(){Z.Z.dispatch((0,O.r$)({is_hiding_presence:this.state.is_hiding_presence,limits_private_thread_invites_to:this.state.limits_private_thread_invites_to,subscribe_to_started_threads:this.state.subscribe_to_started_threads,subscribe_to_replied_threads:this.state.subscribe_to_replied_threads})),g.Z.success(gettext("Your forum options have been changed."))}handleError(e){400===e.status?g.Z.error(gettext("Please reload page and try again.")):g.Z.apiError(e)}componentDidMount(){v.Z.set({title:gettext("Forum options"),parent:gettext("Change your options")})}render(){return(0,a.Z)("form",{onSubmit:this.handleSubmit},void 0,(0,a.Z)("div",{className:"panel panel-default panel-form"},void 0,(0,a.Z)("div",{className:"panel-heading"},void 0,(0,a.Z)("h3",{className:"panel-title"},void 0,gettext("Change forum options"))),(0,a.Z)("div",{className:"panel-body"},void 0,(0,a.Z)("fieldset",{},void 0,(0,a.Z)("legend",{},void 0,gettext("Privacy settings")),(0,a.Z)(L.Z,{label:gettext("Hide my presence"),helpText:gettext("If you hide your presence, only members with permission to see hidden users will see when you are online."),for:"id_is_hiding_presence"},void 0,(0,a.Z)(P.Z,{id:"id_is_hiding_presence",disabled:this.state.isLoading,iconOn:"visibility_off",iconOff:"visibility",labelOn:gettext("Hide my presence from other users"),labelOff:gettext("Show my presence to other users"),onChange:this.bindInput("is_hiding_presence"),value:this.state.is_hiding_presence})),(0,a.Z)(L.Z,{label:gettext("Private thread invitations"),for:"id_limits_private_thread_invites_to"},void 0,(0,a.Z)(T.Z,{id:"id_limits_private_thread_invites_to",disabled:this.state.isLoading,onChange:this.bindInput("limits_private_thread_invites_to"),value:this.state.limits_private_thread_invites_to,choices:this.privateThreadInvitesChoices}))),(0,a.Z)("fieldset",{},void 0,(0,a.Z)("legend",{},void 0,gettext("Automatic subscriptions")),(0,a.Z)(L.Z,{label:gettext("Threads I start"),for:"id_subscribe_to_started_threads"},void 0,(0,a.Z)(T.Z,{id:"id_subscribe_to_started_threads",disabled:this.state.isLoading,onChange:this.bindInput("subscribe_to_started_threads"),value:this.state.subscribe_to_started_threads,choices:this.subscribeToChoices})),(0,a.Z)(L.Z,{label:gettext("Threads I reply to"),for:"id_subscribe_to_replied_threads"},void 0,(0,a.Z)(T.Z,{id:"id_subscribe_to_replied_threads",disabled:this.state.isLoading,onChange:this.bindInput("subscribe_to_replied_threads"),value:this.state.subscribe_to_replied_threads,choices:this.subscribeToChoices})))),(0,a.Z)("div",{className:"panel-footer"},void 0,(0,a.Z)(h.Z,{className:"btn-primary",loading:this.state.isLoading},void 0,gettext("Save changes")))))}},A=s(95187);function I(){return(0,a.Z)("div",{className:"panel panel-default panel-form"},void 0,(0,a.Z)("div",{className:"panel-heading"},void 0,(0,a.Z)("h3",{className:"panel-title"},void 0,gettext("Change username"))),S||(S=(0,a.Z)(A.Z,{})))}var D,j,z,U,M,B,q,H=s(33556),F=class extends o().Component{getHelpText(){return this.props.options.next_on?interpolate(gettext("You will be able to change your username %(next_change)s."),{next_change:this.props.options.next_on.fromNow()},!0):gettext("You have used up available name changes.")}render(){return(0,a.Z)("div",{className:"panel panel-default panel-form"},void 0,(0,a.Z)("div",{className:"panel-heading"},void 0,(0,a.Z)("h3",{className:"panel-title"},void 0,gettext("Change username"))),(0,a.Z)(H.Z,{helpText:this.getHelpText(),message:gettext("You can't change your username at the moment.")}))}},Y=s(55210),V=class extends E.Z{constructor(e){super(e),this.state={username:"",validators:{username:[Y.lG(),Y.HR(e.options.length_min),Y.gS(e.options.length_max)]},isLoading:!1}}getHelpText(){let e=[];if(this.props.options.changes_left>0){let t=ngettext("You can change your username %(changes_left)s more time.","You can change your username %(changes_left)s more times.",this.props.options.changes_left);e.push(interpolate(t,{changes_left:this.props.options.changes_left},!0))}if(this.props.user.acl.name_changes_expire>0){let t=ngettext("Used changes become available again after %(name_changes_expire)s day.","Used changes become available again after %(name_changes_expire)s days.",this.props.user.acl.name_changes_expire);e.push(interpolate(t,{name_changes_expire:this.props.user.acl.name_changes_expire},!0))}return e.length?e.join(" "):null}clean(){let e=this.validate();return e.username?(g.Z.error(e.username[0]),!1):this.state.username.trim()!==this.props.user.username||(g.Z.info(gettext("Your new username is same as current one.")),!1)}send(){return m.Z.post(this.props.user.api.username,{username:this.state.username})}handleSuccess(e){this.setState({username:""}),this.props.complete(e.username,e.slug,e.options)}handleError(e){g.Z.apiError(e)}render(){return(0,a.Z)("form",{onSubmit:this.handleSubmit},void 0,(0,a.Z)("div",{className:"panel panel-default panel-form"},void 0,(0,a.Z)("div",{className:"panel-heading"},void 0,(0,a.Z)("h3",{className:"panel-title"},void 0,gettext("Change username"))),(0,a.Z)("div",{className:"panel-body"},void 0,(0,a.Z)(L.Z,{label:gettext("New username"),for:"id_username",helpText:this.getHelpText()},void 0,(0,a.Z)("input",{type:"text",id:"id_username",className:"form-control",disabled:this.state.isLoading,onChange:this.bindInput("username"),value:this.state.username}))),(0,a.Z)("div",{className:"panel-footer"},void 0,(0,a.Z)(h.Z,{className:"btn-primary",loading:this.state.isLoading},void 0,gettext("Change username")))))}},G=s(7850),$=s(48927),W=s(6935),Q=class extends o().Component{constructor(e){super(e),(0,u.Z)(this,"onComplete",((e,t,s)=>{this.setState({options:s}),Z.Z.dispatch((0,$.KP)({username:e,slug:t},this.props.user,this.props.user)),Z.Z.dispatch((0,W._S)(this.props.user,e,t)),g.Z.success(gettext("Your username has been changed successfully."))})),this.state={isLoaded:!1,options:null}}componentDidMount(){v.Z.set({title:gettext("Change username"),parent:gettext("Change your options")}),Promise.all([m.Z.get(this.props.user.api.username),m.Z.get(b.Z.get("USERNAME_CHANGES_API"),{user:this.props.user.id})]).then((e=>{Z.Z.dispatch((0,$.ZB)(e[1].results)),this.setState({isLoaded:!0,options:{changes_left:e[0].changes_left,length_min:e[0].length_min,length_max:e[0].length_max,next_on:e[0].next_on?y()(e[0].next_on):null}})}))}getChangeForm(){return this.state.isLoaded?0===this.state.options.changes_left?(0,a.Z)(F,{options:this.state.options}):(0,a.Z)(V,{complete:this.onComplete,options:this.state.options,user:this.props.user}):D||(D=(0,a.Z)(I,{}))}render(){return(0,a.Z)("div",{},void 0,this.getChangeForm(),(0,a.Z)(G.Z,{changes:this.props["username-history"],isLoaded:this.state.isLoaded}))}},K=class extends E.Z{constructor(e){super(e),this.state={new_email:"",password:"",validators:{new_email:[Y.Do()],password:[]},isLoading:!1}}clean(){let e=this.validate();return-1!==[this.state.new_email.trim().length,this.state.password.trim().length].indexOf(0)?(g.Z.error(gettext("Fill out all fields.")),!1):!e.new_email||(g.Z.error(e.new_email[0]),!1)}send(){return m.Z.post(this.props.user.api.change_email,{new_email:this.state.new_email,password:this.state.password})}handleSuccess(e){this.setState({new_email:"",password:""}),g.Z.success(e.detail)}handleError(e){400===e.status?e.new_email?g.Z.error(e.new_email):g.Z.error(e.password):g.Z.apiError(e)}render(){return(0,a.Z)("form",{onSubmit:this.handleSubmit},void 0,(0,a.Z)("input",{type:"type",style:{display:"none"}}),(0,a.Z)("input",{type:"password",style:{display:"none"}}),(0,a.Z)("div",{className:"panel panel-default panel-form"},void 0,(0,a.Z)("div",{className:"panel-heading"},void 0,(0,a.Z)("h3",{className:"panel-title"},void 0,gettext("Change e-mail address"))),(0,a.Z)("div",{className:"panel-body"},void 0,(0,a.Z)(L.Z,{label:gettext("New e-mail"),for:"id_new_email"},void 0,(0,a.Z)("input",{type:"text",id:"id_new_email",className:"form-control",disabled:this.state.isLoading,onChange:this.bindInput("new_email"),value:this.state.new_email})),j||(j=(0,a.Z)("hr",{})),(0,a.Z)(L.Z,{label:gettext("Your current password"),for:"id_confirm_email"},void 0,(0,a.Z)("input",{type:"password",id:"id_confirm_email",className:"form-control",disabled:this.state.isLoading,onChange:this.bindInput("password"),value:this.state.password}))),(0,a.Z)("div",{className:"panel-footer"},void 0,(0,a.Z)(h.Z,{className:"btn-primary",loading:this.state.isLoading},void 0,gettext("Change e-mail")))))}},J=class extends E.Z{constructor(e){super(e),this.state={new_password:"",repeat_password:"",password:"",validators:{new_password:[],repeat_password:[],password:[]},isLoading:!1}}clean(){let e=this.validate();return-1!==[this.state.new_password.trim().length,this.state.repeat_password.trim().length,this.state.password.trim().length].indexOf(0)?(g.Z.error(gettext("Fill out all fields.")),!1):e.new_password?(g.Z.error(e.new_password[0]),!1):this.state.new_password===this.state.repeat_password||(g.Z.error(gettext("New passwords are different.")),!1)}send(){return m.Z.post(this.props.user.api.change_password,{new_password:this.state.new_password,password:this.state.password})}handleSuccess(e){this.setState({new_password:"",repeat_password:"",password:""}),g.Z.success(e.detail)}handleError(e){400===e.status?e.new_password?g.Z.error(e.new_password):g.Z.error(e.password):g.Z.apiError(e)}render(){return(0,a.Z)("form",{onSubmit:this.handleSubmit},void 0,(0,a.Z)("input",{type:"type",style:{display:"none"}}),(0,a.Z)("input",{type:"password",style:{display:"none"}}),(0,a.Z)("div",{className:"panel panel-default panel-form"},void 0,(0,a.Z)("div",{className:"panel-heading"},void 0,(0,a.Z)("h3",{className:"panel-title"},void 0,gettext("Change password"))),(0,a.Z)("div",{className:"panel-body"},void 0,(0,a.Z)(L.Z,{label:gettext("New password"),for:"id_new_password"},void 0,(0,a.Z)("input",{type:"password",id:"id_new_password",className:"form-control",disabled:this.state.isLoading,onChange:this.bindInput("new_password"),value:this.state.new_password})),(0,a.Z)(L.Z,{label:gettext("Repeat password"),for:"id_repeat_password"},void 0,(0,a.Z)("input",{type:"password",id:"id_repeat_password",className:"form-control",disabled:this.state.isLoading,onChange:this.bindInput("repeat_password"),value:this.state.repeat_password})),z||(z=(0,a.Z)("hr",{})),(0,a.Z)(L.Z,{label:gettext("Your current password"),for:"id_confirm_password"},void 0,(0,a.Z)("input",{type:"password",id:"id_confirm_password",className:"form-control",disabled:this.state.isLoading,onChange:this.bindInput("password"),value:this.state.password}))),(0,a.Z)("div",{className:"panel-footer"},void 0,(0,a.Z)(h.Z,{className:"btn-primary",loading:this.state.isLoading},void 0,gettext("Change password")))))}},X=()=>(0,a.Z)("div",{className:"panel panel-default panel-form"},void 0,(0,a.Z)("div",{className:"panel-heading"},void 0,(0,a.Z)("h3",{className:"panel-title"},void 0,gettext("Change email or password"))),(0,a.Z)("div",{className:"panel-body panel-message-body"},void 0,U||(U=(0,a.Z)("div",{className:"message-icon"},void 0,(0,a.Z)("span",{className:"material-icon"},void 0,"info_outline"))),(0,a.Z)("div",{className:"message-body"},void 0,(0,a.Z)("p",{className:"lead"},void 0,gettext("You need to set a password for your account to be able to change your username or email.")),(0,a.Z)("p",{className:"help-block"},void 0,(0,a.Z)("a",{className:"btn btn-primary",href:b.Z.get("FORGOTTEN_PASSWORD_URL")},void 0,gettext("Set password")))))),ee=class extends o().Component{componentDidMount(){v.Z.set({title:gettext("Change email or password"),parent:gettext("Change your options")})}render(){return this.props.user.has_usable_password?(0,a.Z)("div",{},void 0,(0,a.Z)(K,{user:this.props.user}),(0,a.Z)(J,{user:this.props.user}),(0,a.Z)("p",{className:"message-line"},void 0,B||(B=(0,a.Z)("span",{className:"material-icon"},void 0,"warning")),(0,a.Z)("a",{href:b.Z.get("FORGOTTEN_PASSWORD_URL")},void 0,gettext("Change forgotten password")))):M||(M=(0,a.Z)(X,{}))}},te=s(82125),se=s(98936),ae=s(59131),ie=s(99755),oe=class extends te.Z{render(){const e=b.Z.get("USER_OPTIONS").filter((e=>{const t=b.Z.get("USERCP_URL")+e.component+"/";return this.props.location.pathname.substr(0,t.length)===t}))[0];return(0,a.Z)("div",{className:"page page-options"},void 0,(0,a.Z)(ie.sP,{},void 0,(0,a.Z)(ie.mr,{styleName:"options"},void 0,(0,a.Z)(ie.gC,{styleName:"options"},void 0,(0,a.Z)(se.gq,{},void 0,(0,a.Z)(se.kw,{auto:!0},void 0,(0,a.Z)(se.Z6,{auto:!0},void 0,(0,a.Z)("h1",{},void 0,gettext("Change your options"))),(0,a.Z)(se.Z6,{className:"hidden-xs hidden-md hidden-lg",shrink:!0},void 0,(0,a.Z)("div",{className:"dropdown"},void 0,(0,a.Z)("button",{type:"button",className:"btn btn-default btn-outline btn-icon dropdown-toggle",title:gettext("Menu"),"data-toggle":"dropdown","aria-haspopup":"true","aria-expanded":"false"},void 0,q||(q=(0,a.Z)("span",{className:"material-icon"},void 0,"menu"))),(0,a.Z)(c,{className:"dropdown-menu dropdown-menu-right",baseUrl:b.Z.get("USERCP_URL"),options:b.Z.get("USER_OPTIONS")})))),(0,a.Z)(se.kw,{className:"hidden-sm hidden-md hidden-lg"},void 0,(0,a.Z)(se.Z6,{},void 0,(0,a.Z)("div",{className:"dropdown"},void 0,(0,a.Z)("button",{type:"button",className:"btn btn-default btn-outline btn-block dropdown-toggle","data-toggle":"dropdown","aria-haspopup":"true","aria-expanded":"false"},void 0,(0,a.Z)("span",{className:"material-icon"},void 0,e.icon),e.name),(0,a.Z)(c,{className:"dropdown-menu",baseUrl:b.Z.get("USERCP_URL"),options:b.Z.get("USER_OPTIONS")})))))))),(0,a.Z)(ae.Z,{},void 0,(0,a.Z)("div",{className:"row"},void 0,(0,a.Z)("div",{className:"col-md-3 hidden-xs hidden-sm"},void 0,(0,a.Z)(d,{baseUrl:b.Z.get("USERCP_URL"),options:b.Z.get("USER_OPTIONS")})),(0,a.Z)("div",{className:"col-md-9"},void 0,this.props.children))))}};function ne(e){return{tick:e.tick.tick,user:e.auth.user,"username-history":e["username-history"]}}function re(){const e=[{path:b.Z.get("USERCP_URL")+"forum-options/",component:(0,n.$j)(ne)(R)},{path:b.Z.get("USERCP_URL")+"edit-details/",component:(0,n.$j)(ne)(N)}],t=b.Z.get("SETTINGS").DELEGATE_AUTH;return t||(e.push({path:b.Z.get("USERCP_URL")+"change-username/",component:(0,n.$j)(ne)(Q)}),e.push({path:b.Z.get("USERCP_URL")+"sign-in-credentials/",component:(0,n.$j)(ne)(ee)})),b.Z.get("ENABLE_DOWNLOAD_OWN_DATA")&&e.push({path:b.Z.get("USERCP_URL")+"download-data/",component:(0,n.$j)(ne)(w)}),!t&&b.Z.get("ENABLE_DELETE_OWN_ACCOUNT")&&e.push({path:b.Z.get("USERCP_URL")+"delete-account/",component:(0,n.$j)(ne)(f)}),e}var le=s(39633);b.Z.addInitializer({name:"component:options",initializer:function(e){e.has("USER_OPTIONS")&&(0,le.Z)({root:b.Z.get("USERCP_URL"),component:oe,paths:re()})},after:"store"})},95563:function(e,t,s){"use strict";var a,i=s(37424),o=s(22928),n=s(4942),r=s(57588),l=s.n(r),d=s(30381),c=s.n(d),p=s(95187),u=s(33556),h=s(32233),m=s(55547),v=s(53328),g=class extends l().Component{constructor(e){super(e),(0,n.Z)(this,"update",(e=>{e.expires_on&&(e.expires_on=c()(e.expires_on)),this.setState({isLoaded:!0,error:null,ban:e})})),(0,n.Z)(this,"error",(e=>{this.setState({isLoaded:!0,error:e.detail,ban:null})})),h.Z.has("PROFILE_BAN")?this.initWithPreloadedData(h.Z.pop("PROFILE_BAN")):this.initWithoutPreloadedData(),this.startPolling(e.profile.api.ban)}initWithPreloadedData(e){e.expires_on&&(e.expires_on=c()(e.expires_on)),this.state={isLoaded:!0,ban:e}}initWithoutPreloadedData(){this.state={isLoaded:!1}}startPolling(e){m.Z.start({poll:"ban-details",url:e,frequency:9e4,update:this.update,error:this.error})}componentDidMount(){v.Z.set({title:gettext("Ban details"),parent:this.props.profile.username})}componentWillUnmount(){m.Z.stop("ban-details")}getUserMessage(){return this.state.ban.user_message?(0,o.Z)("div",{className:"panel-body ban-message ban-user-message"},void 0,(0,o.Z)("h4",{},void 0,gettext("User-shown ban message")),(0,o.Z)("div",{className:"lead",dangerouslySetInnerHTML:{__html:this.state.ban.user_message.html}})):null}getStaffMessage(){return this.state.ban.staff_message?(0,o.Z)("div",{className:"panel-body ban-message ban-staff-message"},void 0,(0,o.Z)("h4",{},void 0,gettext("Team-shown ban message")),(0,o.Z)("div",{className:"lead",dangerouslySetInnerHTML:{__html:this.state.ban.staff_message.html}})):null}getExpirationMessage(){if(this.state.ban.expires_on){if(this.state.ban.expires_on.isAfter(c()())){let e=interpolate(gettext("This ban expires on %(expires_on)s."),{expires_on:this.state.ban.expires_on.format("LL, LT")},!0),t=interpolate(gettext("This ban expires %(expires_on)s."),{expires_on:this.state.ban.expires_on.fromNow()},!0);return(0,o.Z)("abbr",{title:e},void 0,t)}return gettext("This ban has expired.")}return interpolate(gettext("%(username)s's ban is permanent."),{username:this.props.profile.username},!0)}getPanelBody(){return this.state.ban?Object.keys(this.state.ban).length?(0,o.Z)("div",{},void 0,this.getUserMessage(),this.getStaffMessage(),(0,o.Z)("div",{className:"panel-body ban-expires"},void 0,(0,o.Z)("h4",{},void 0,gettext("Ban expiration")),(0,o.Z)("p",{className:"lead"},void 0,this.getExpirationMessage()))):(0,o.Z)("div",{},void 0,(0,o.Z)(u.Z,{message:gettext("No ban is active at the moment.")})):this.state.error?(0,o.Z)("div",{},void 0,(0,o.Z)(u.Z,{icon:"error_outline",message:this.state.error})):a||(a=(0,o.Z)("div",{},void 0,(0,o.Z)(p.Z,{})))}render(){return(0,o.Z)("div",{className:"profile-ban-details"},void 0,(0,o.Z)("div",{className:"panel panel-default"},void 0,(0,o.Z)("div",{className:"panel-heading"},void 0,(0,o.Z)("h3",{className:"panel-title"},void 0,gettext("Ban details"))),this.getPanelBody()))}},Z=s(21688);function b(e){let{api:t,display:s,onCancel:a,onSuccess:i}=e;return s?(0,o.Z)(Z.Z,{api:t,onCancel:a,onSuccess:i}):null}function f(e){let{isAuthenticated:t,profile:s}=e,a=null;return a=t?gettext("You are not sharing any details with others."):interpolate(gettext("%(username)s is not sharing any details with others."),{username:s.username},!0),(0,o.Z)("div",{className:"panel panel-default"},void 0,(0,o.Z)("div",{className:"panel-body text-center lead"},void 0,a))}function _(e){let{html:t,text:s,url:a}=e;return t?(0,o.Z)("div",{className:"form-control-static col-md-9",dangerouslySetInnerHTML:{__html:t}}):(0,o.Z)("div",{className:"form-control-static col-md-9"},void 0,(0,o.Z)(N,{text:s,url:a}))}function N(e){let{text:t,url:s}=e;return s?(0,o.Z)("p",{},void 0,(0,o.Z)("a",{href:s,target:"_blank",rel:"nofollow"},void 0,t||s)):t?(0,o.Z)("p",{},void 0,t):null}function x(e){return(0,o.Z)("div",{className:"form-group"},void 0,(0,o.Z)("strong",{className:"control-label col-md-3"},void 0,e.name,":"),l().createElement(_,e))}function y(e){let{fields:t,name:s}=e;return(0,o.Z)("div",{className:"panel panel-default panel-profile-details-group"},void 0,(0,o.Z)("div",{className:"panel-heading"},void 0,(0,o.Z)("h3",{className:"panel-title"},void 0,s)),(0,o.Z)("div",{className:"panel-body"},void 0,(0,o.Z)("div",{className:"form-horizontal"},void 0,t.map((e=>{let{fieldname:t,html:s,name:a,text:i,url:n}=e;return(0,o.Z)(x,{name:a,html:s,text:i,url:n},t)})))))}var w,k=s(37848);function C(e){let{display:t,groups:s,isAuthenticated:a,loading:i,profile:n}=e;return t?i?w||(w=(0,o.Z)(k.Z,{})):s.length?(0,o.Z)("div",{},void 0,s.map(((e,t)=>(0,o.Z)(y,{fields:e.fields,name:e.name},t)))):(0,o.Z)(f,{isAuthenticated:a,profile:n}):null}var S,E=s(92490),L=e=>{let{onEdit:t,showEditButton:s}=e;return(0,o.Z)(E.o8,{},void 0,(0,o.Z)(E.Z2,{auto:!0},void 0,(0,o.Z)(E.Eg,{auto:!0},void 0,(0,o.Z)("h3",{},void 0,gettext("Details")))),s&&(0,o.Z)(E.Z2,{},void 0,(0,o.Z)(E.Eg,{},void 0,(0,o.Z)("button",{className:"btn btn-default btn-outline btn-block",onClick:t,type:"button"},void 0,gettext("Edit")))))},T=s(58598),P=s(78657),O=s(53904),R=class extends l().Component{componentDidMount(){const{data:e,dispatch:t,user:s}=this.props;e&&e.id===s.id||P.Z.get(this.props.user.api.details).then((e=>{t((0,T.zD)(e))}),(e=>{O.Z.apiError(e)}))}render(){return this.props.children}},A=class extends l().Component{constructor(e){super(e),(0,n.Z)(this,"onCancel",(()=>{this.setState({editing:!1})})),(0,n.Z)(this,"onEdit",(()=>{this.setState({editing:!0})})),(0,n.Z)(this,"onSuccess",(e=>{const{dispatch:t,isAuthenticated:s,profile:a}=this.props;let i=null;i=s?gettext("Your details have been updated."):interpolate(gettext("%(username)s's details have been updated."),{username:a.username},!0),O.Z.info(i),t((0,T.zD)(e)),this.setState({editing:!1})})),this.state={editing:!1}}componentDidMount(){v.Z.set({title:gettext("Details"),parent:this.props.profile.username})}render(){const{dispatch:e,isAuthenticated:t,profile:s,profileDetails:a}=this.props,i=a.id!==s.id;return(0,o.Z)(R,{data:a,dispatch:e,user:s},void 0,(0,o.Z)("div",{className:"profile-details"},void 0,(0,o.Z)(L,{onEdit:this.onEdit,showEditButton:!!a.edit&&!this.state.editing}),(0,o.Z)(C,{display:!this.state.editing,groups:a.groups,isAuthenticated:t,loading:i,profile:s}),(0,o.Z)(b,{api:s.api.edit_details,dispatch:e,display:this.state.editing,onCancel:this.onCancel,onSuccess:this.onSuccess})))}},I=s(87462),D=s(11005),j=s(82211),z=s(21981),U=s(90287),M=class extends l().Component{constructor(e){super(e),(0,n.Z)(this,"loadMore",(()=>{this.setState({isLoading:!0}),this.loadItems(this.props.posts.next)})),this.state={isLoading:!1}}loadItems(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;P.Z.get(this.props.api,{start:e||0}).then((t=>{0===e?U.Z.dispatch(z.zD(t)):U.Z.dispatch(z.R3(t)),this.setState({isLoading:!1})}),(e=>{this.setState({isLoading:!1}),O.Z.apiError(e)}))}componentDidMount(){v.Z.set({title:this.props.title,parent:this.props.profile.username}),this.loadItems()}render(){return(0,o.Z)("div",{className:"profile-feed"},void 0,(0,o.Z)(E.o8,{},void 0,(0,o.Z)(E.Z2,{auto:!0},void 0,(0,o.Z)(E.Eg,{auto:!0},void 0,(0,o.Z)("h3",{},void 0,this.props.header)))),l().createElement(B,(0,I.Z)({isLoading:this.state.isLoading,loadMore:this.loadMore},this.props)))}};function B(e){return e.posts.isLoaded&&!e.posts.results.length?(0,o.Z)("p",{className:"lead"},void 0,e.emptyMessage):(0,o.Z)("div",{},void 0,(0,o.Z)(D.Z,{isReady:e.posts.isLoaded,posts:e.posts.results,poster:e.profile}),(0,o.Z)(q,{isLoading:e.isLoading,loadMore:e.loadMore,next:e.posts.next}))}function q(e){return e.next?(0,o.Z)("div",{className:"pager-more"},void 0,(0,o.Z)(j.Z,{className:"btn btn-default btn-outline",loading:e.isLoading,onClick:e.loadMore},void 0,gettext("Show older activity"))):null}var H,F,Y,V,G,$,W,Q,K,J,X,ee=class extends l().Component{getClassName(){return this.props.className?"form-search "+this.props.className:"form-search"}render(){return(0,o.Z)("div",{className:this.getClassName()},void 0,(0,o.Z)("input",{type:"text",className:"form-control",value:this.props.value,onChange:this.props.onChange,placeholder:this.props.placeholder||gettext("Search...")}),S||(S=(0,o.Z)("span",{className:"material-icon"},void 0,"search")))}},te=s(40429),se=s(6935),ae=class extends l().Component{constructor(e){super(e),(0,n.Z)(this,"loadMore",(()=>{this.setState({isBusy:!0}),this.loadUsers(this.state.page+1,this.state.search)})),(0,n.Z)(this,"search",(e=>{this.setState({isLoaded:!1,isBusy:!0,search:e.target.value,count:0,more:0,page:1,pages:1}),this.loadUsers(1,e.target.value)})),this.setSpecialProps(),h.Z.has(this.PRELOADED_DATA_KEY)?this.initWithPreloadedData(h.Z.pop(this.PRELOADED_DATA_KEY)):this.initWithoutPreloadedData()}setSpecialProps(){this.PRELOADED_DATA_KEY="PROFILE_FOLLOWERS",this.TITLE=gettext("Followers"),this.API_FILTER="followers"}initWithPreloadedData(e){this.state={isLoaded:!0,isBusy:!1,search:"",count:e.count,more:e.more,page:e.page,pages:e.pages},U.Z.dispatch((0,se.ZB)(e.results))}initWithoutPreloadedData(){this.state={isLoaded:!1,isBusy:!1,search:"",count:0,more:0,page:1,pages:1},this.loadUsers()}loadUsers(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;const s=this.props.profile.api[this.API_FILTER];P.Z.get(s,{search:t,page:e||1},"user-"+this.API_FILTER).then((t=>{1===e?U.Z.dispatch((0,se.ZB)(t.results)):U.Z.dispatch((0,se.R3)(t.results)),this.setState({isLoaded:!0,isBusy:!1,count:t.count,more:t.more,page:t.page,pages:t.pages})}),(e=>{O.Z.apiError(e)}))}componentDidMount(){v.Z.set({title:this.TITLE,parent:this.props.profile.username})}getLabel(){if(this.state.isLoaded){if(this.state.search){let e=ngettext("Found %(users)s user.","Found %(users)s users.",this.state.count);return interpolate(e,{users:this.state.count},!0)}if(this.props.profile.id===this.props.user.id){let e=ngettext("You have %(users)s follower.","You have %(users)s followers.",this.state.count);return interpolate(e,{users:this.state.count},!0)}{let e=ngettext("%(username)s has %(users)s follower.","%(username)s has %(users)s followers.",this.state.count);return interpolate(e,{username:this.props.profile.username,users:this.state.count},!0)}}return gettext("Loading...")}getEmptyMessage(){return this.state.search?gettext("Search returned no users matching specified criteria."):this.props.user.id===this.props.profile.id?gettext("You have no followers."):interpolate(gettext("%(username)s has no followers."),{username:this.props.profile.username},!0)}getMoreButton(){return this.state.more?(0,o.Z)("div",{className:"pager-more"},void 0,(0,o.Z)(j.Z,{className:"btn btn-default btn-outline",loading:this.state.isBusy,onClick:this.loadMore},void 0,interpolate(gettext("Show more (%(more)s)"),{more:this.state.more},!0))):null}getListBody(){return this.state.isLoaded&&0===this.state.count?(0,o.Z)("p",{className:"lead"},void 0,this.getEmptyMessage()):(0,o.Z)("div",{},void 0,(0,o.Z)(te.Z,{cols:3,isReady:this.state.isLoaded,users:this.props.users}),this.getMoreButton())}getClassName(){return"profile-"+this.API_FILTER}render(){return(0,o.Z)("div",{className:this.getClassName()},void 0,(0,o.Z)(E.o8,{},void 0,(0,o.Z)(E.Z2,{auto:!0},void 0,(0,o.Z)(E.Eg,{auto:!0},void 0,(0,o.Z)("h3",{},void 0,this.getLabel()))),(0,o.Z)(E.Z2,{},void 0,(0,o.Z)(E.Eg,{},void 0,(0,o.Z)(ee,{value:this.state.search,onChange:this.search,placeholder:gettext("Search users...")})))),this.getListBody())}},ie=s(7850),oe=s(48927),ne=class extends l().Component{constructor(e){super(e),(0,n.Z)(this,"loadMore",(()=>{this.setState({isBusy:!0}),this.loadChanges(this.state.page+1,this.state.search)})),(0,n.Z)(this,"search",(e=>{this.setState({isLoaded:!1,isBusy:!0,search:e.target.value,count:0,more:0,page:1,pages:1}),this.loadChanges(1,e.target.value)})),h.Z.has("PROFILE_NAME_HISTORY")?this.initWithPreloadedData(h.Z.pop("PROFILE_NAME_HISTORY")):this.initWithoutPreloadedData()}initWithPreloadedData(e){this.state={isLoaded:!0,isBusy:!1,search:"",count:e.count,more:e.more,page:e.page,pages:e.pages},U.Z.dispatch((0,oe.ZB)(e.results))}initWithoutPreloadedData(){this.state={isLoaded:!1,isBusy:!1,search:"",count:0,more:0,page:1,pages:1},this.loadChanges()}loadChanges(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;P.Z.get(h.Z.get("USERNAME_CHANGES_API"),{user:this.props.profile.id,search:t,page:e||1},"search-username-history").then((t=>{1===e?U.Z.dispatch((0,oe.ZB)(t.results)):U.Z.dispatch((0,oe.R3)(t.results)),this.setState({isLoaded:!0,isBusy:!1,count:t.count,more:t.more,page:t.page,pages:t.pages})}),(e=>{O.Z.apiError(e)}))}componentDidMount(){v.Z.set({title:gettext("Username history"),parent:this.props.profile.username})}getLabel(){if(this.state.isLoaded){if(this.state.search){let e=ngettext("Found %(changes)s username change.","Found %(changes)s username changes.",this.state.count);return interpolate(e,{changes:this.state.count},!0)}if(this.props.profile.id===this.props.user.id){let e=ngettext("Your username was changed %(changes)s time.","Your username was changed %(changes)s times.",this.state.count);return interpolate(e,{changes:this.state.count},!0)}{let e=ngettext("%(username)s's username was changed %(changes)s time.","%(username)s's username was changed %(changes)s times.",this.state.count);return interpolate(e,{username:this.props.profile.username,changes:this.state.count},!0)}}return gettext("Loading...")}getEmptyMessage(){return this.state.search?gettext("Search returned no username changes matching specified criteria."):this.props.user.id===this.props.profile.id?gettext("No name changes have been recorded for your account."):interpolate(gettext("%(username)s's username was never changed."),{username:this.props.profile.username},!0)}getMoreButton(){return this.state.more?(0,o.Z)("div",{className:"pager-more"},void 0,(0,o.Z)(j.Z,{className:"btn btn-default btn-outline",loading:this.state.isBusy,onClick:this.loadMore},void 0,interpolate(gettext("Show older (%(more)s)"),{more:this.state.more},!0))):null}render(){return(0,o.Z)("div",{className:"profile-username-history"},void 0,(0,o.Z)(E.o8,{},void 0,(0,o.Z)(E.Z2,{auto:!0},void 0,(0,o.Z)(E.Eg,{auto:!0},void 0,(0,o.Z)("h3",{},void 0,this.getLabel()))),(0,o.Z)(E.Z2,{},void 0,(0,o.Z)(E.Eg,{},void 0,(0,o.Z)(ee,{value:this.state.search,onChange:this.search,placeholder:gettext("Search history...")})))),(0,o.Z)(ie.Z,{isLoaded:this.state.isLoaded,emptyMessage:this.getEmptyMessage(),changes:this.props["username-history"]}),this.getMoreButton())}},re=s(82125),le=s(27519),de=s(59131),ce=s(19605),pe=s(98936),ue=s(99755),he=class extends l().Component{constructor(e){super(e),(0,n.Z)(this,"action",(()=>{this.setState({isLoading:!0}),this.props.profile.is_followed?U.Z.dispatch((0,le.r$)({is_followed:!1,followers:this.props.profile.followers-1})):U.Z.dispatch((0,le.r$)({is_followed:!0,followers:this.props.profile.followers+1})),P.Z.post(this.props.profile.api.follow).then((e=>{this.setState({isLoading:!1}),U.Z.dispatch((0,le.r$)(e))}),(e=>{this.setState({isLoading:!1}),O.Z.apiError(e)}))})),this.state={isLoading:!1}}getClassName(){return this.props.profile.is_followed?this.props.className+" btn-default btn-following":this.props.className+" btn-default btn-follow"}getIcon(){return this.props.profile.is_followed?"favorite":"favorite_border"}getLabel(){return this.props.profile.is_followed?gettext("Following"):gettext("Follow")}render(){return(0,o.Z)(j.Z,{className:this.getClassName(),disabled:this.state.isLoading,onClick:this.action},void 0,(0,o.Z)("span",{className:"material-icon"},void 0,this.getIcon()),this.getLabel())}},me=s(64646),ve=class extends l().Component{constructor(){super(...arguments),(0,n.Z)(this,"onClick",(()=>{me.Z.open({mode:"START_PRIVATE",submit:h.Z.get("PRIVATE_THREADS_API"),to:[this.props.profile]})}))}render(){const e=this.props.user.acl.can_start_private_threads,t=this.props.user.id===this.props.profile.id;return!e||t?null:(0,o.Z)("button",{className:this.props.className,onClick:this.onClick,type:"button"},void 0,H||(H=(0,o.Z)("span",{className:"material-icon"},void 0,"comment")),gettext("Message"))}},ge=s(43345),Ze=s(96359),be=s(3784),fe=s(7227),_e=s(30337),Ne=class extends ge.Z{constructor(e){super(e),this.state={isLoaded:!1,isLoading:!1,error:null,is_avatar_locked:"",avatar_lock_user_message:"",avatar_lock_staff_message:""}}componentDidMount(){P.Z.get(this.props.profile.api.moderate_avatar).then((e=>{this.setState({isLoaded:!0,is_avatar_locked:e.is_avatar_locked,avatar_lock_user_message:e.avatar_lock_user_message||"",avatar_lock_staff_message:e.avatar_lock_staff_message||""})}),(e=>{this.setState({isLoaded:!0,error:e.detail})}))}clean(){return!!this.isValid()||(O.Z.error(this.validate().username[0]),!1)}send(){return P.Z.post(this.props.profile.api.moderate_avatar,{is_avatar_locked:this.state.is_avatar_locked,avatar_lock_user_message:this.state.avatar_lock_user_message,avatar_lock_staff_message:this.state.avatar_lock_staff_message})}handleSuccess(e){U.Z.dispatch((0,se.n1)(this.props.profile,e.avatar_hash)),O.Z.success(gettext("Avatar controls have been changed."))}getFormBody(){return(0,o.Z)("form",{onSubmit:this.handleSubmit},void 0,(0,o.Z)("div",{className:"modal-body"},void 0,(0,o.Z)(Ze.Z,{label:gettext("Lock avatar"),helpText:gettext("Locking user avatar will prohibit user from changing his avatar and will reset his/her avatar to default one."),for:"id_is_avatar_locked"},void 0,(0,o.Z)(fe.Z,{id:"id_is_avatar_locked",disabled:this.state.isLoading,iconOn:"lock_outline",iconOff:"lock_open",labelOn:gettext("Disallow user from changing avatar"),labelOff:gettext("Allow user to change avatar"),onChange:this.bindInput("is_avatar_locked"),value:this.state.is_avatar_locked})),(0,o.Z)(Ze.Z,{label:gettext("User message"),helpText:gettext("Optional message for user explaining why he/she is prohibited form changing avatar."),for:"id_avatar_lock_user_message"},void 0,(0,o.Z)("textarea",{id:"id_avatar_lock_user_message",className:"form-control",rows:"4",disabled:this.state.isLoading,onChange:this.bindInput("avatar_lock_user_message"),value:this.state.avatar_lock_user_message})),(0,o.Z)(Ze.Z,{label:gettext("Staff message"),helpText:gettext("Optional message for forum team members explaining why user is prohibited form changing avatar."),for:"id_avatar_lock_staff_message"},void 0,(0,o.Z)("textarea",{id:"id_avatar_lock_staff_message",className:"form-control",rows:"4",disabled:this.state.isLoading,onChange:this.bindInput("avatar_lock_staff_message"),value:this.state.avatar_lock_staff_message}))),(0,o.Z)("div",{className:"modal-footer"},void 0,(0,o.Z)("button",{type:"button",className:"btn btn-default","data-dismiss":"modal"},void 0,gettext("Close")),(0,o.Z)(j.Z,{className:"btn-primary",loading:this.state.isLoading},void 0,gettext("Save changes"))))}getModalBody(){return this.state.error?(0,o.Z)(_e.Z,{icon:"remove_circle_outline",message:this.state.error}):this.state.isLoaded?this.getFormBody():F||(F=(0,o.Z)(be.Z,{}))}getClassName(){return this.state.error?"modal-dialog modal-message modal-avatar-controls":"modal-dialog modal-avatar-controls"}render(){return(0,o.Z)("div",{className:this.getClassName(),role:"document"},void 0,(0,o.Z)("div",{className:"modal-content"},void 0,(0,o.Z)("div",{className:"modal-header"},void 0,(0,o.Z)("button",{type:"button",className:"close","data-dismiss":"modal","aria-label":pgettext("modal","Close")},void 0,Y||(Y=(0,o.Z)("span",{"aria-hidden":"true"},void 0,"×"))),(0,o.Z)("h4",{className:"modal-title"},void 0,gettext("Avatar controls"))),this.getModalBody()))}},xe=s(55210),ye=class extends ge.Z{constructor(e){super(e),this.state={isLoaded:!1,isLoading:!1,error:null,username:"",validators:{username:[xe.lG()]}}}componentDidMount(){P.Z.get(this.props.profile.api.moderate_username).then((()=>{this.setState({isLoaded:!0})}),(e=>{this.setState({isLoaded:!0,error:e.detail})}))}clean(){return!!this.isValid()||(O.Z.error(this.validate().username[0]),!1)}send(){return P.Z.post(this.props.profile.api.moderate_username,{username:this.state.username})}handleSuccess(e){this.setState({username:""}),U.Z.dispatch((0,oe.KP)(e,this.props.profile,this.props.user)),U.Z.dispatch((0,se._S)(this.props.profile,e.username,e.slug)),O.Z.success(gettext("Username has been changed."))}getFormBody(){return(0,o.Z)("form",{onSubmit:this.handleSubmit},void 0,(0,o.Z)("div",{className:"modal-body"},void 0,(0,o.Z)(Ze.Z,{label:gettext("New username"),for:"id_username"},void 0,(0,o.Z)("input",{type:"text",id:"id_username",className:"form-control",disabled:this.state.isLoading,onChange:this.bindInput("username"),value:this.state.username}))),(0,o.Z)("div",{className:"modal-footer"},void 0,(0,o.Z)("button",{className:"btn btn-default","data-dismiss":"modal",disabled:this.state.isLoading,type:"button"},void 0,gettext("Cancel")),(0,o.Z)(j.Z,{className:"btn-primary",loading:this.state.isLoading},void 0,gettext("Change username"))))}getModalBody(){return this.state.error?(0,o.Z)(_e.Z,{icon:"remove_circle_outline",message:this.state.error}):this.state.isLoaded?this.getFormBody():V||(V=(0,o.Z)(be.Z,{}))}getClassName(){return this.state.error?"modal-dialog modal-message modal-rename-user":"modal-dialog modal-rename-user"}render(){return(0,o.Z)("div",{className:this.getClassName(),role:"document"},void 0,(0,o.Z)("div",{className:"modal-content"},void 0,(0,o.Z)("div",{className:"modal-header"},void 0,(0,o.Z)("button",{type:"button",className:"close","data-dismiss":"modal","aria-label":pgettext("modal","Close")},void 0,G||(G=(0,o.Z)("span",{"aria-hidden":"true"},void 0,"×"))),(0,o.Z)("h4",{className:"modal-title"},void 0,gettext("Change username"))),this.getModalBody()))}},we=class extends ge.Z{constructor(e){super(e),(0,n.Z)(this,"countdown",(()=>{window.setTimeout((()=>{this.state.countdown>1?(this.setState({countdown:this.state.countdown-1}),this.countdown()):this.state.confirm||this.setState({confirm:!0})}),1e3)})),this.state={isLoaded:!1,isLoading:!1,isDeleted:!1,error:null,countdown:5,confirm:!1,with_content:!1}}componentDidMount(){P.Z.get(this.props.profile.api.delete).then((()=>{this.setState({isLoaded:!0}),this.countdown()}),(e=>{this.setState({isLoaded:!0,error:e.detail})}))}send(){return P.Z.post(this.props.profile.api.delete,{with_content:this.state.with_content})}handleSuccess(){m.Z.stop("user-profile"),this.state.with_content?this.setState({isDeleted:interpolate(gettext("%(username)s's account, threads, posts and other content has been deleted."),{username:this.props.profile.username},!0)}):this.setState({isDeleted:interpolate(gettext("%(username)s's account has been deleted and other content has been hidden."),{username:this.props.profile.username},!0)})}getButtonLabel(){return this.state.confirm?interpolate(gettext("Delete %(username)s"),{username:this.props.profile.username},!0):interpolate(gettext("Please wait... (%(countdown)ss)"),{countdown:this.state.countdown},!0)}getForm(){return(0,o.Z)("form",{onSubmit:this.handleSubmit},void 0,(0,o.Z)("div",{className:"modal-body"},void 0,(0,o.Z)(Ze.Z,{label:gettext("User content"),for:"id_with_content"},void 0,(0,o.Z)(fe.Z,{id:"id_with_content",disabled:this.state.isLoading,labelOn:gettext("Delete together with user's account"),labelOff:gettext("Hide after deleting user's account"),onChange:this.bindInput("with_content"),value:this.state.with_content}))),(0,o.Z)("div",{className:"modal-footer"},void 0,(0,o.Z)("button",{type:"button",className:"btn btn-default","data-dismiss":"modal"},void 0,gettext("Cancel")),(0,o.Z)(j.Z,{className:"btn-danger",loading:this.state.isLoading,disabled:!this.state.confirm},void 0,this.getButtonLabel())))}getDeletedBody(){return(0,o.Z)("div",{className:"modal-body"},void 0,$||($=(0,o.Z)("div",{className:"message-icon"},void 0,(0,o.Z)("span",{className:"material-icon"},void 0,"info_outline"))),(0,o.Z)("div",{className:"message-body"},void 0,(0,o.Z)("p",{className:"lead"},void 0,this.state.isDeleted),(0,o.Z)("p",{},void 0,(0,o.Z)("a",{href:h.Z.get("USERS_LIST_URL")},void 0,gettext("Return to users list")))))}getModalBody(){return this.state.error?(0,o.Z)(_e.Z,{icon:"remove_circle_outline",message:this.state.error}):this.state.isLoaded?this.state.isDeleted?this.getDeletedBody():this.getForm():W||(W=(0,o.Z)(be.Z,{}))}getClassName(){return this.state.error||this.state.isDeleted?"modal-dialog modal-message modal-delete-account":"modal-dialog modal-delete-account"}render(){return(0,o.Z)("div",{className:this.getClassName(),role:"document"},void 0,(0,o.Z)("div",{className:"modal-content"},void 0,(0,o.Z)("div",{className:"modal-header"},void 0,(0,o.Z)("button",{type:"button",className:"close","data-dismiss":"modal","aria-label":pgettext("modal","Close")},void 0,Q||(Q=(0,o.Z)("span",{"aria-hidden":"true"},void 0,"×"))),(0,o.Z)("h4",{className:"modal-title"},void 0,gettext("Delete user account"))),this.getModalBody()))}},ke=s(59801);let Ce=function(e){return{tick:e.tick,user:e.auth,profile:e.profile}};var Se,Ee,Le,Te,Pe,Oe=class extends l().Component{constructor(){super(...arguments),(0,n.Z)(this,"showAvatarDialog",(()=>{ke.Z.show((0,i.$j)(Ce)(Ne))})),(0,n.Z)(this,"showRenameDialog",(()=>{ke.Z.show((0,i.$j)(Ce)(ye))})),(0,n.Z)(this,"showDeleteDialog",(()=>{ke.Z.show((0,i.$j)(Ce)(we))}))}render(){const{moderation:e}=this.props;return(0,o.Z)("ul",{className:"dropdown-menu dropdown-menu-right",role:"menu"},void 0,!!e.avatar&&(0,o.Z)("li",{},void 0,(0,o.Z)("button",{type:"button",className:"btn btn-link",onClick:this.showAvatarDialog},void 0,K||(K=(0,o.Z)("span",{className:"material-icon"},void 0,"portrait")),gettext("Avatar controls"))),!!e.rename&&(0,o.Z)("li",{},void 0,(0,o.Z)("button",{type:"button",className:"btn btn-link",onClick:this.showRenameDialog},void 0,J||(J=(0,o.Z)("span",{className:"material-icon"},void 0,"credit_card")),gettext("Change username"))),!!e.delete&&(0,o.Z)("li",{},void 0,(0,o.Z)("button",{type:"button",className:"btn btn-link",onClick:this.showDeleteDialog},void 0,X||(X=(0,o.Z)("span",{className:"material-icon"},void 0,"clear")),gettext("Delete account"))))}},Re=s(24678),Ae=e=>{let{profile:t}=e;return(0,o.Z)("ul",{className:"profile-data-list"},void 0,!1===t.is_active&&(0,o.Z)("li",{className:"user-account-disabled"},void 0,(0,o.Z)("abbr",{title:gettext("This user's account has been disabled by administrator.")},void 0,gettext("Account disabled"))),(0,o.Z)("li",{className:"user-status-display"},void 0,(0,o.Z)(Re.ZP,{user:t,status:t.status},void 0,(0,o.Z)(Re.Jj,{user:t,status:t.status}),(0,o.Z)(Re.pg,{user:t,status:t.status,className:"status-label"}))),t.rank.is_tab?(0,o.Z)("li",{className:"user-rank"},void 0,(0,o.Z)("a",{href:t.rank.url,className:"item-title"},void 0,t.rank.name)):(0,o.Z)("li",{className:"user-rank"},void 0,(0,o.Z)("span",{className:"item-title"},void 0,t.rank.name)),(t.title||t.rank.title)&&(0,o.Z)("li",{className:"user-title"},void 0,t.title||t.rank.title),(0,o.Z)("li",{className:"user-joined-on"},void 0,(0,o.Z)("abbr",{title:interpolate(gettext("Joined on %(joined_on)s"),{joined_on:t.joined_on.format("LL, LT")},!0)},void 0,interpolate(gettext("Joined %(joined_on)s"),{joined_on:t.joined_on.fromNow()},!0))),t.email&&(0,o.Z)("li",{className:"user-email"},void 0,(0,o.Z)("a",{href:"mailto:"+t.email,className:"item-title"},void 0,t.email)))};const Ie=()=>(0,o.Z)("button",{className:"btn btn-default btn-icon btn-outline dropdown-toggle",type:"button",title:gettext("Options"),"data-toggle":"dropdown","aria-haspopup":"true","aria-expanded":"false"},void 0,Pe||(Pe=(0,o.Z)("span",{className:"material-icon"},void 0,"settings")));var De=e=>{let{profile:t,user:s,moderation:a,message:i,follow:n}=e;return(0,o.Z)(ue.sP,{},void 0,(0,o.Z)(ue.mr,{styleName:t.rank.css_class?"rank-"+t.rank.css_class:"profile"},void 0,(0,o.Z)(ue.gC,{styleName:t.rank.css_class?"rank-"+t.rank.css_class:"profile"},void 0,(0,o.Z)("div",{className:"profile-page-header"},void 0,(0,o.Z)("div",{className:"profile-page-header-avatar"},void 0,(0,o.Z)(ce.ZP,{className:"user-avatar hidden-sm hidden-md hidden-lg",user:t,size:200,size2x:400}),(0,o.Z)(ce.ZP,{className:"user-avatar hidden-xs hidden-md hidden-lg",user:t,size:64,size2x:128}),(0,o.Z)(ce.ZP,{className:"user-avatar hidden-xs hidden-sm",user:t,size:128,size2x:256})),(0,o.Z)("h1",{},void 0,t.username))),(0,o.Z)(ue.eA,{className:"profile-page-header-details"},void 0,(0,o.Z)(pe.gq,{},void 0,(0,o.Z)(pe.kw,{auto:!0},void 0,(0,o.Z)(pe.Z6,{},void 0,(0,o.Z)(Ae,{profile:t}))),i&&(0,o.Z)(pe.kw,{},void 0,(0,o.Z)(pe.Z6,{},void 0,(0,o.Z)(ve,{className:"btn btn-default btn-block btn-outline",profile:t,user:s})),a.available&&!n&&(0,o.Z)(pe.Z6,{shrink:!0},void 0,(0,o.Z)("div",{className:"dropdown"},void 0,Se||(Se=(0,o.Z)(Ie,{})),(0,o.Z)(Oe,{profile:t,moderation:a})))),n&&(0,o.Z)(pe.kw,{},void 0,(0,o.Z)(pe.Z6,{},void 0,(0,o.Z)(he,{className:"btn btn-block btn-outline",profile:t})),a.available&&(0,o.Z)(pe.Z6,{shrink:!0},void 0,(0,o.Z)("div",{className:"dropdown"},void 0,Ee||(Ee=(0,o.Z)(Ie,{})),(0,o.Z)(Oe,{profile:t,moderation:a})))),a.available&&!n&&!i&&(0,o.Z)(pe.kw,{},void 0,(0,o.Z)(pe.Z6,{className:"hidden-xs",shrink:!0},void 0,(0,o.Z)("div",{className:"dropdown"},void 0,Le||(Le=(0,o.Z)(Ie,{})),(0,o.Z)(Oe,{profile:t,moderation:a}))),(0,o.Z)(pe.Z6,{className:"hidden-sm hidden-md hidden-lg"},void 0,(0,o.Z)("div",{className:"dropdown"},void 0,(0,o.Z)("button",{className:"btn btn-default btn-block btn-outline dropdown-toggle",type:"button","data-toggle":"dropdown","aria-haspopup":"true","aria-expanded":"false"},void 0,Te||(Te=(0,o.Z)("span",{className:"material-icon"},void 0,"settings")),gettext("Options")),(0,o.Z)(Oe,{profile:t,moderation:a}))))))))},je=s(69987),ze=s(94417),Ue=e=>{let{baseUrl:t,page:s,pages:a}=e;return(0,o.Z)("div",{className:"nav-container"},void 0,(0,o.Z)("div",{className:"dropdown hidden-sm hidden-md hidden-lg"},void 0,(0,o.Z)("button",{className:"btn btn-default btn-block btn-outline dropdown-toggle",type:"button","data-toggle":"dropdown","aria-haspopup":"true","aria-expanded":"false"},void 0,(0,o.Z)("span",{className:"material-icon"},void 0,s.icon),s.name),(0,o.Z)("ul",{className:"dropdown-menu stick-to-bottom"},void 0,a.map((e=>(0,o.Z)("li",{},e.component,(0,o.Z)(je.rU,{to:t+e.component+"/"},void 0,(0,o.Z)("span",{className:"material-icon"},void 0,e.icon),e.name)))))),(0,o.Z)("ul",{className:"nav nav-pills hidden-xs",role:"menu"},void 0,a.map((e=>(0,o.Z)(ze.Z,{path:t+e.component+"/"},e.component,(0,o.Z)(je.rU,{to:t+e.component+"/"},void 0,(0,o.Z)("span",{className:"material-icon"},void 0,e.icon),e.name))))))},Me=class extends re.Z{constructor(e){super(e),(0,n.Z)(this,"update",(e=>{U.Z.dispatch((0,le.ZB)(e))})),this.startPolling(e.profile.api.index)}startPolling(e){m.Z.start({poll:"user-profile",url:e,frequency:9e4,update:this.update})}render(){const e=h.Z.get("PROFILE").url,t=h.Z.get("PROFILE_PAGES"),s=t.filter((t=>{const s=e+t.component+"/";return this.props.location.pathname===s}))[0],{profile:a,user:i}=this.props,n=Be(a,i),r=!!i.acl.can_start_private_threads&&a.id!==i.id,l=!!a.acl.can_follow&&a.id!==i.id;return(0,o.Z)("div",{className:"page page-user-profile"},void 0,(0,o.Z)(De,{profile:this.props.profile,user:this.props.user,moderation:n,message:r,follow:l}),(0,o.Z)(de.Z,{},void 0,(0,o.Z)(Ue,{baseUrl:e,page:s,pages:t}),this.props.children))}};const Be=(e,t)=>{const s={available:!1,rename:!1,avatar:!1,delete:!1};return t.is_anonymous||(s.rename=e.acl.can_rename,s.avatar=e.acl.can_moderate_avatar,s.delete=e.acl.can_delete,s.available=!!(s.rename||s.avatar||s.delete)),s};function qe(e){return{isAuthenticated:e.auth.user.id===e.profile.id,tick:e.tick.tick,user:e.auth.user,users:e.users,posts:e.posts,profile:e.profile,profileDetails:e["profile-details"],"username-history":e["username-history"]}}const He={posts:function(e){let t=null;t=e.user.id===e.profile.id?gettext("You have posted no messages."):interpolate(gettext("%(username)s posted no messages."),{username:e.profile.username},!0);let s=null;if(e.posts.isLoaded)if(e.profile.id===e.user.id){const t=ngettext("You have posted %(posts)s message.","You have posted %(posts)s messages.",e.profile.posts);s=interpolate(t,{posts:e.profile.posts},!0)}else{const t=ngettext("%(username)s has posted %(posts)s message.","%(username)s has posted %(posts)s messages.",e.profile.posts);s=interpolate(t,{username:e.profile.username,posts:e.profile.posts},!0)}else s=gettext("Loading...");return l().createElement(M,(0,I.Z)({api:e.profile.api.posts,emptyMessage:t,header:s,title:gettext("Posts")},e))},threads:function(e){let t=null;t=e.user.id===e.profile.id?gettext("You have no started threads."):interpolate(gettext("%(username)s started no threads."),{username:e.profile.username},!0);let s=null;if(e.posts.isLoaded)if(e.profile.id===e.user.id){const t=ngettext("You have started %(threads)s thread.","You have started %(threads)s threads.",e.profile.threads);s=interpolate(t,{threads:e.profile.threads},!0)}else{const t=ngettext("%(username)s has started %(threads)s thread.","%(username)s has started %(threads)s threads.",e.profile.threads);s=interpolate(t,{username:e.profile.username,threads:e.profile.threads},!0)}else s=gettext("Loading...");return l().createElement(M,(0,I.Z)({api:e.profile.api.threads,emptyMessage:t,header:s,title:gettext("Threads")},e))},followers:ae,follows:class extends ae{setSpecialProps(){this.PRELOADED_DATA_KEY="PROFILE_FOLLOWS",this.TITLE=gettext("Follows"),this.API_FILTER="follows"}getLabel(){if(this.state.isLoaded){if(this.state.search){let e=ngettext("Found %(users)s user.","Found %(users)s users.",this.state.count);return interpolate(e,{users:this.state.count},!0)}if(this.props.profile.id===this.props.user.id){let e=ngettext("You are following %(users)s user.","You are following %(users)s users.",this.state.count);return interpolate(e,{users:this.state.count},!0)}{let e=ngettext("%(username)s is following %(users)s user.","%(username)s is following %(users)s users.",this.state.count);return interpolate(e,{username:this.props.profile.username,users:this.state.count},!0)}}return gettext("Loading...")}getEmptyMessage(){return this.state.search?gettext("Search returned no users matching specified criteria."):this.props.user.id===this.props.profile.id?gettext("You are not following any users."):interpolate(gettext("%(username)s is not following any users."),{username:this.props.profile.username},!0)}},details:A,"username-history":ne,"ban-details":g};function Fe(){let e=[];return h.Z.get("PROFILE_PAGES").forEach((function(t){e.push(Object.assign({},t,{path:h.Z.get("PROFILE").url+t.component+"/",component:(0,i.$j)(qe)(He[t.component])}))})),e}var Ye=s(39633);h.Z.addInitializer({name:"component:profile",initializer:function(e){e.has("PROFILE")&&e.has("PROFILE_PAGES")&&(0,Ye.Z)({root:h.Z.get("PROFILE").url,component:(0,i.$j)(qe)(Me),paths:Fe()})},after:"reducer:profile-hydrate"})},32488:function(e,t,s){"use strict";var a,i=s(32233),o=s(4942),n=s(22928),r=s(57588),l=s.n(r),d=s(82211),c=s(43345),p=s(78657),u=s(53904),h=s(55210),m=s(93051);class v extends c.Z{constructor(e){super(e),this.state={isLoading:!1,email:"",validators:{email:[h.Do()]}}}clean(){return!!this.isValid()||(u.Z.error(gettext("Enter a valid email address.")),!1)}send(){return p.Z.post(i.Z.get("SEND_ACTIVATION_API"),{email:this.state.email})}handleSuccess(e){this.props.callback(e)}handleError(e){["already_active","inactive_admin"].indexOf(e.code)>-1?u.Z.info(e.detail):403===e.status&&e.ban?(0,m.Z)(e.ban):u.Z.apiError(e)}render(){return(0,n.Z)("div",{className:"well well-form well-form-request-activation-link"},void 0,(0,n.Z)("form",{onSubmit:this.handleSubmit},void 0,(0,n.Z)("div",{className:"form-group"},void 0,(0,n.Z)("div",{className:"control-input"},void 0,(0,n.Z)("input",{type:"text",className:"form-control",placeholder:gettext("Your e-mail address"),disabled:this.state.isLoading,onChange:this.bindInput("email"),value:this.state.email}))),(0,n.Z)(d.Z,{className:"btn-primary btn-block",loading:this.state.isLoading},void 0,gettext("Send link"))))}}class g extends l().Component{getMessage(){return interpolate(gettext("Activation link was sent to %(email)s"),{email:this.props.user.email},!0)}render(){return(0,n.Z)("div",{className:"well well-form well-form-request-activation-link well-done"},void 0,(0,n.Z)("div",{className:"done-message"},void 0,a||(a=(0,n.Z)("div",{className:"message-icon"},void 0,(0,n.Z)("span",{className:"material-icon"},void 0,"check"))),(0,n.Z)("div",{className:"message-body"},void 0,(0,n.Z)("p",{},void 0,this.getMessage())),(0,n.Z)("button",{className:"btn btn-primary btn-block",type:"button",onClick:this.props.callback},void 0,gettext("Request another link"))))}}var Z=class extends l().Component{constructor(e){super(e),(0,o.Z)(this,"complete",(e=>{this.setState({complete:e})})),(0,o.Z)(this,"reset",(()=>{this.setState({complete:!1})})),this.state={complete:!1}}render(){return this.state.complete?(0,n.Z)(g,{user:this.state.complete,callback:this.reset}):(0,n.Z)(v,{callback:this.complete})}},b=s(4869);i.Z.addInitializer({name:"component:request-activation-link",initializer:function(){document.getElementById("request-activation-link-mount")&&(0,b.Z)(Z,"request-activation-link-mount",!1)},after:"store"})},11768:function(e,t,s){"use strict";var a,i,o=s(32233),n=s(4942),r=s(22928),l=s(57588),d=s.n(l),c=s(73935),p=s.n(c),u=s(82211),h=s(43345),m=s(78657),v=s(53904),g=s(55210),Z=s(93051);class b extends h.Z{constructor(e){super(e),this.state={isLoading:!1,email:"",validators:{email:[g.Do()]}}}clean(){return!!this.isValid()||(v.Z.error(gettext("Enter a valid email address.")),!1)}send(){return m.Z.post(o.Z.get("SEND_PASSWORD_RESET_API"),{email:this.state.email})}handleSuccess(e){this.props.callback(e)}handleError(e){["inactive_user","inactive_admin"].indexOf(e.code)>-1?this.props.showInactivePage(e):403===e.status&&e.ban?(0,Z.Z)(e.ban):v.Z.apiError(e)}render(){return(0,r.Z)("div",{className:"well well-form well-form-request-password-reset"},void 0,(0,r.Z)("form",{onSubmit:this.handleSubmit},void 0,(0,r.Z)("div",{className:"form-group"},void 0,(0,r.Z)("div",{className:"control-input"},void 0,(0,r.Z)("input",{type:"text",className:"form-control",placeholder:gettext("Your e-mail address"),disabled:this.state.isLoading,onChange:this.bindInput("email"),value:this.state.email}))),(0,r.Z)(u.Z,{className:"btn-primary btn-block",loading:this.state.isLoading},void 0,gettext("Send link"))))}}class f extends d().Component{getMessage(){return interpolate(gettext("Reset password link was sent to %(email)s"),{email:this.props.user.email},!0)}render(){return(0,r.Z)("div",{className:"well well-form well-form-request-password-reset well-done"},void 0,(0,r.Z)("div",{className:"done-message"},void 0,a||(a=(0,r.Z)("div",{className:"message-icon"},void 0,(0,r.Z)("span",{className:"material-icon"},void 0,"check"))),(0,r.Z)("div",{className:"message-body"},void 0,(0,r.Z)("p",{},void 0,this.getMessage())),(0,r.Z)("button",{type:"button",className:"btn btn-primary btn-block",onClick:this.props.callback},void 0,gettext("Request another link"))))}}class _ extends d().Component{getActivateButton(){return"inactive_user"===this.props.activation?(0,r.Z)("p",{},void 0,(0,r.Z)("a",{href:o.Z.get("REQUEST_ACTIVATION_URL")},void 0,gettext("Activate your account."))):null}render(){return(0,r.Z)("div",{className:"page page-message page-message-info page-forgotten-password-inactive"},void 0,(0,r.Z)("div",{className:"container"},void 0,(0,r.Z)("div",{className:"message-panel"},void 0,i||(i=(0,r.Z)("div",{className:"message-icon"},void 0,(0,r.Z)("span",{className:"material-icon"},void 0,"info_outline"))),(0,r.Z)("div",{className:"message-body"},void 0,(0,r.Z)("p",{className:"lead"},void 0,gettext("Your account is inactive.")),(0,r.Z)("p",{},void 0,this.props.message),this.getActivateButton()))))}}var N=class extends d().Component{constructor(e){super(e),(0,n.Z)(this,"complete",(e=>{this.setState({complete:e})})),(0,n.Z)(this,"reset",(()=>{this.setState({complete:!1})})),this.state={complete:!1}}showInactivePage(e){p().render((0,r.Z)(_,{activation:e.code,message:e.detail}),document.getElementById("page-mount"))}render(){return this.state.complete?(0,r.Z)(f,{callback:this.reset,user:this.state.complete}):(0,r.Z)(b,{callback:this.complete,showInactivePage:this.showInactivePage})}},x=s(4869);o.Z.addInitializer({name:"component:request-password-reset",initializer:function(){document.getElementById("request-password-reset-mount")&&(0,x.Z)(N,"request-password-reset-mount",!1)},after:"store"})},61323:function(e,t,s){"use strict";var a,i=s(32233),o=s(4942),n=s(22928),r=s(57588),l=s.n(r),d=s(73935),c=s.n(d),p=s(82211),u=s(43345),h=s(14467),m=s(78657),v=s(98274),g=s(59801),Z=s(53904),b=s(93051),f=s(19755);class _ extends u.Z{constructor(e){super(e),this.state={isLoading:!1,password:""}}clean(){return!!this.state.password.trim().length||(Z.Z.error(gettext("Enter new password.")),!1)}send(){return m.Z.post(i.Z.get("CHANGE_PASSWORD_API"),{password:this.state.password})}handleSuccess(e){this.props.callback(e)}handleError(e){403===e.status&&e.ban?(0,b.Z)(e.ban):Z.Z.apiError(e)}render(){return(0,n.Z)("div",{className:"well well-form well-form-reset-password"},void 0,(0,n.Z)("form",{onSubmit:this.handleSubmit},void 0,(0,n.Z)("div",{className:"form-group"},void 0,(0,n.Z)("div",{className:"control-input"},void 0,(0,n.Z)("input",{type:"password",className:"form-control",placeholder:gettext("Enter new password"),disabled:this.state.isLoading,onChange:this.bindInput("password"),value:this.state.password}))),(0,n.Z)(p.Z,{className:"btn-primary btn-block",loading:this.state.isLoading},void 0,gettext("Change password"))))}}class N extends l().Component{getMessage(){return interpolate(gettext("%(username)s, your password has been changed successfully."),{username:this.props.user.username},!0)}showSignIn(){g.Z.show(h.Z)}render(){return(0,n.Z)("div",{className:"page page-message page-message-success page-forgotten-password-changed"},void 0,(0,n.Z)("div",{className:"container"},void 0,(0,n.Z)("div",{className:"message-panel"},void 0,a||(a=(0,n.Z)("div",{className:"message-icon"},void 0,(0,n.Z)("span",{className:"material-icon"},void 0,"check"))),(0,n.Z)("div",{className:"message-body"},void 0,(0,n.Z)("p",{className:"lead"},void 0,this.getMessage()),(0,n.Z)("p",{},void 0,gettext("You will have to sign in using new password before continuing.")),(0,n.Z)("p",{},void 0,(0,n.Z)("button",{type:"button",className:"btn btn-primary",onClick:this.showSignIn},void 0,gettext("Sign in")))))))}}var x=class extends l().Component{constructor(){super(...arguments),(0,o.Z)(this,"complete",(e=>{v.Z.softSignOut(),f('#hidden-login-form input[name="redirect_to"]').remove(),c().render((0,n.Z)(N,{user:e}),document.getElementById("page-mount"))}))}render(){return(0,n.Z)(_,{callback:this.complete})}},y=s(4869);i.Z.addInitializer({name:"component:reset-password-form",initializer:function(){document.getElementById("reset-password-form-mount")&&(0,y.Z)(x,"reset-password-form-mount",!1)},after:"store"})},15049:function(e,t,s){"use strict";var a,i=s(37424),o=s(22928),n=s(87462),r=s(57588),l=s.n(r),d=s(59131),c=s(4942),p=s(32233),u=s(43345),h=s(21981),m=s(16427),v=s(6935),g=s(78657),Z=s(53904),b=s(90287),f=s(98936),_=s(99755),N=class extends u.Z{constructor(e){super(e),(0,c.Z)(this,"onQueryChange",(e=>{this.changeValue("query",e.target.value)})),this.state={isLoading:!1,query:e.search.query}}componentDidMount(){this.state.query.length&&this.handleSubmit()}clean(){return!!this.state.query.trim().length||(Z.Z.error(gettext("You have to enter search query.")),!1)}send(){b.Z.dispatch((0,m.Vx)({isLoading:!0}));const e=this.state.query.trim();let t=window.location.href;const s=t.indexOf("?q=");return s>0&&(t=t.substring(0,s+3)),window.history.pushState({},"",t+encodeURIComponent(e)),g.Z.get(p.Z.get("SEARCH_API"),{q:e})}handleSuccess(e){b.Z.dispatch((0,m.Vx)({query:this.state.query.trim(),isLoading:!1,providers:e})),e.forEach((e=>{"users"===e.id?b.Z.dispatch((0,v.ZB)(e.results.results)):"threads"===e.id&&b.Z.dispatch((0,h.zD)(e.results))}))}handleError(e){Z.Z.apiError(e),b.Z.dispatch((0,m.Vx)({isLoading:!1}))}render(){return(0,o.Z)("form",{onSubmit:this.handleSubmit},void 0,(0,o.Z)(_.sP,{},void 0,(0,o.Z)(_.mr,{styleName:"site-search"},void 0,(0,o.Z)(_.gC,{styleName:"site-search"},void 0,(0,o.Z)("h1",{},void 0,gettext("Search"))),(0,o.Z)(_.eA,{className:"page-header-search-form"},void 0,(0,o.Z)(f.gq,{},void 0,(0,o.Z)(f.kw,{auto:!0},void 0,(0,o.Z)(f.Z6,{},void 0,(0,o.Z)("input",{className:"form-control",disabled:this.state.isLoading,type:"text",value:this.state.query,placeholder:gettext("Search"),onChange:this.onQueryChange})),(0,o.Z)(f.Z6,{shrink:!0},void 0,(0,o.Z)("button",{className:"btn btn-secondary btn-icon btn-outline",disabled:this.state.isLoading},void 0,a||(a=(0,o.Z)("span",{className:"material-icon"},void 0,"search"))))))))))}},x=s(69987);function y(e){return(0,o.Z)("div",{className:"list-group nav-side"},void 0,e.providers.map((e=>(0,o.Z)(x.rU,{activeClassName:"active",className:"list-group-item",to:e.url},e.id,(0,o.Z)("span",{className:"material-icon"},void 0,e.icon),e.name,(0,o.Z)(w,{results:e.results})))))}function w(e){if(!e.results)return null;let t=e.results.count;return t>1e6?t=Math.ceil(t/1e6)+"KK":t>1e3&&(t=Math.ceil(t/1e3)+"K"),(0,o.Z)("span",{className:"badge"},void 0,t)}function k(e){return(0,o.Z)("div",{className:"page page-search"},void 0,(0,o.Z)(N,{provider:e.provider,search:e.search}),(0,o.Z)(d.Z,{},void 0,(0,o.Z)("div",{className:"row"},void 0,(0,o.Z)("div",{className:"col-md-3"},void 0,(0,o.Z)(y,{providers:e.search.providers})),(0,o.Z)("div",{className:"col-md-9"},void 0,e.children,(0,o.Z)(C,{provider:e.provider,search:e.search})))))}function C(e){let t=null;if(e.search.providers.forEach((s=>{s.id===e.provider.id&&(t=s.time)})),null===t)return null;const s=gettext("Search took %(time)s s to complete");return(0,o.Z)("footer",{className:"search-footer"},void 0,(0,o.Z)("p",{},void 0,interpolate(s,{time:t},!0)))}var S=s(11005),E=s(82211);function L(e){return(0,o.Z)("div",{},void 0,(0,o.Z)(S.Z,{isReady:!0,posts:e.results}),l().createElement(T,e))}s(69092);class T extends l().Component{constructor(){super(...arguments),(0,c.Z)(this,"onClick",(()=>{b.Z.dispatch((0,h.Vx)({isBusy:!0})),g.Z.get(this.props.provider.api,{q:this.props.query,page:this.props.next}).then((e=>{e.forEach((e=>{"threads"===e.id&&(b.Z.dispatch((0,h.R3)(e.results)),b.Z.dispatch((0,m.P0)(e)))})),b.Z.dispatch((0,h.Vx)({isBusy:!1}))}),(e=>{Z.Z.apiError(e),b.Z.dispatch((0,h.Vx)({isBusy:!1}))}))}))}render(){return this.props.more?(0,o.Z)("div",{className:"pager-more"},void 0,(0,o.Z)(E.Z,{className:"btn btn-default btn-outline",loading:this.props.isBusy,onClick:this.onClick},void 0,gettext("Show more"))):null}}function P(e){let{children:t,loading:s,posts:a,query:i}=e;return a&&a.count?t:i.length?(0,o.Z)("p",{className:"lead"},void 0,s?gettext("Loading results..."):gettext("No threads matching search query have been found.")):(0,o.Z)("p",{className:"lead"},void 0,gettext("Enter at least two characters to search threads."))}var O=s(40429);function R(e){let{children:t,loading:s,query:a,users:i}=e;return i.length?t:a.length?(0,o.Z)("p",{className:"lead"},void 0,s?gettext("Loading results..."):gettext("No users matching search query have been found.")):(0,o.Z)("p",{className:"lead"},void 0,gettext("Enter at least two characters to search users."))}const A={threads:function(e){return(0,o.Z)(k,{provider:e.route.provider,search:e.search},void 0,(0,o.Z)(P,{loading:e.search.isLoading,query:e.search.query,posts:e.posts},void 0,l().createElement(L,(0,n.Z)({provider:e.route.provider,query:e.search.query},e.posts))))},users:function(e){return(0,o.Z)(k,{provider:e.route.provider,search:e.search},void 0,(0,o.Z)(R,{loading:e.search.isLoading,query:e.search.query,users:e.users},void 0,(0,o.Z)(O.Z,{cols:3,isReady:!e.search.isLoading,users:e.users})))}};function I(e){return{posts:e.posts,search:e.search,tick:e.tick.tick,user:e.auth.user,users:e.users}}var D=s(39633);p.Z.addInitializer({name:"component:search",initializer:function(e){var t;"misago:search"===e.get("CURRENT_LINK")&&(0,D.Z)({paths:(t=p.Z.get("SEARCH_PROVIDERS"),t.map((e=>({path:e.url,component:(0,i.$j)(I)(A[e.id]),provider:e}))))})},after:"store"})},61814:function(e,t,s){"use strict";var a=s(37424),i=s(32233),o=s(22928),n=s(57588),r=s.n(n);const l={info:"alert-info",success:"alert-success",warning:"alert-warning",error:"alert-danger"};class d extends r().Component{getSnackbarClass(){let e="alerts-snackbar";return this.props.isVisible?e+=" in":e+=" out",e}render(){return(0,o.Z)("div",{className:this.getSnackbarClass()},void 0,(0,o.Z)("p",{className:"alert "+l[this.props.type]},void 0,this.props.message))}}function c(e){return e.snackbar}var p=s(4869);i.Z.addInitializer({name:"component:snackbar",initializer:function(){(0,p.Z)((0,a.$j)(c)(d),"snackbar-mount")},after:"snackbar"})},95920:function(e,t,s){"use strict";var a=s(57588),i=s.n(a),o=s(22928),n=s(4942),r=s(32233),l=s(26106),d=s(82211),c=s(43345),p=s(96359),u=s(78657),h=s(53904),m=s(55210),v=s(59131),g=s(99755),Z=e=>{let{backendName:t}=e;const s=gettext("Sign in with %(backend)s"),a=interpolate(s,{backend:t},!0);return(0,o.Z)(g.sP,{},void 0,(0,o.Z)(g.mr,{styleName:"social-auth"},void 0,(0,o.Z)(g.gC,{styleName:"social-auth"},void 0,(0,o.Z)("h1",{},void 0,a))))};class b extends c.Z{constructor(e){super(e),(0,n.Z)(this,"handlePrivacyPolicyChange",(e=>{const t=e.target.value;this.handleToggleAgreement("privacyPolicy",t)})),(0,n.Z)(this,"handleTermsOfServiceChange",(e=>{const t=e.target.value;this.handleToggleAgreement("termsOfService",t)})),(0,n.Z)(this,"handleToggleAgreement",((e,t)=>{this.setState(((s,a)=>{if(null===s[e])return{errors:{...s.errors,[e]:null},[e]:t};const i=this.state.validators[e][0];return{errors:{...s.errors,[e]:[i(null)]},[e]:null}}))}));const t={email:[m.Do()],username:[m.lG()]};r.Z.get("TERMS_OF_SERVICE_ID")&&(t.termsOfService=[m.fT()]),r.Z.get("PRIVACY_POLICY_ID")&&(t.privacyPolicy=[m.jA()]),this.state={email:e.email||"",emailProtected:!!e.email,username:e.username||"",termsOfService:null,privacyPolicy:null,validators:t,errors:{},isLoading:!1}}clean(){if(this.validate(),-1!==[this.state.email.trim().length,this.state.username.trim().length].indexOf(0))return h.Z.error(gettext("Fill out all fields.")),!1;const{validators:e}=this.state;return r.Z.get("TERMS_OF_SERVICE_ID")&&null===this.state.termsOfService?(h.Z.error(e.termsOfService[0](null)),!1):!r.Z.get("PRIVACY_POLICY_ID")||null!==this.state.privacyPolicy||(h.Z.error(e.privacyPolicy[0](null)),h.Z.error(gettext("You need to accept the privacy policy.")),!1)}send(){return u.Z.post(this.props.url,{email:this.state.email,username:this.state.username,terms_of_service:this.state.termsOfService,privacy_policy:this.state.privacyPolicy})}handleSuccess(e){const{onRegistrationComplete:t}=this.props;t(e)}handleError(e){if(200===e.status){const{onRegistrationComplete:e}=this.props,{username:t}=this.state;e({activation:"active",step:"done",username:t})}else if(400===e.status){const t={errors:e};e.email&&(t.emailProtected=!1),this.setState(t)}else h.Z.apiError(e)}render(){const{backend_name:e}=this.props,{email:t,emailProtected:s,username:a,isLoading:i}=this.state;let n=null;if(s){const t=gettext("Your e-mail address has been verified by %(backend)s.");n=interpolate(t,{backend:e},!0)}return(0,o.Z)("div",{className:"page page-social-auth page-social-auth-register"},void 0,(0,o.Z)(Z,{backendName:e}),(0,o.Z)(v.Z,{},void 0,(0,o.Z)("div",{className:"row"},void 0,(0,o.Z)("div",{className:"col-md-6 col-md-offset-3"},void 0,(0,o.Z)("form",{onSubmit:this.handleSubmit},void 0,(0,o.Z)("div",{className:"panel panel-default panel-form"},void 0,(0,o.Z)("div",{className:"panel-heading"},void 0,(0,o.Z)("h3",{className:"panel-title"},void 0,gettext("Complete your details"))),(0,o.Z)("div",{className:"panel-body"},void 0,(0,o.Z)(p.Z,{for:"id_username",label:gettext("Username"),validation:this.state.errors.username},void 0,(0,o.Z)("input",{type:"text",id:"id_username",className:"form-control",disabled:i,onChange:this.bindInput("username"),value:a})),(0,o.Z)(p.Z,{for:"id_email",label:gettext("E-mail address"),helpText:n,validation:s?null:this.state.errors.email},void 0,(0,o.Z)("input",{type:"email",id:"id_email",className:"form-control",disabled:i||s,onChange:this.bindInput("email"),value:t})),(0,o.Z)(l.Z,{errors:this.state.errors,privacyPolicy:this.state.privacyPolicy,termsOfService:this.state.termsOfService,onPrivacyPolicyChange:this.handlePrivacyPolicyChange,onTermsOfServiceChange:this.handleTermsOfServiceChange})),(0,o.Z)("div",{className:"panel-footer"},void 0,(0,o.Z)(d.Z,{className:"btn-primary",loading:this.state.isLoading},void 0,gettext("Sign in")))))))))}}var f=e=>{let{activation:t,backend_name:s,username:a}=e,i="",n="";return n="user"===t?gettext("%(username)s, your account has been created but you need to activate it before you will be able to sign in."):"admin"===t?gettext("%(username)s, your account has been created but board administrator will have to activate it before you will be able to sign in."):gettext("%(username)s, your account has been created and you have been signed in to it."),i="active"===t?"check":"info_outline",(0,o.Z)("div",{className:"page page-social-auth page-social-auth-register"},void 0,(0,o.Z)(Z,{backendName:s}),(0,o.Z)(v.Z,{},void 0,(0,o.Z)("div",{className:"row"},void 0,(0,o.Z)("div",{className:"col-md-6 col-md-offset-3"},void 0,(0,o.Z)("div",{className:"panel panel-default panel-form"},void 0,(0,o.Z)("div",{className:"panel-heading"},void 0,(0,o.Z)("h3",{className:"panel-title"},void 0,gettext("Registration completed!"))),(0,o.Z)("div",{className:"panel-body panel-message-body"},void 0,(0,o.Z)("div",{className:"message-icon"},void 0,(0,o.Z)("span",{className:"material-icon"},void 0,i)),(0,o.Z)("div",{className:"message-body"},void 0,(0,o.Z)("p",{className:"lead"},void 0,interpolate(n,{username:a},!0)),(0,o.Z)("p",{className:"help-block"},void 0,(0,o.Z)("a",{className:"btn btn-default",href:r.Z.get("MISAGO_PATH")},void 0,gettext("Return to forum index"))))))))))};class _ extends i().Component{constructor(e){super(e),(0,n.Z)(this,"handleRegistrationComplete",(e=>{let{activation:t,email:s,step:a,username:i}=e;this.setState({activation:t,email:s,step:a,username:i})})),this.state={step:e.step,activation:e.activation||"",email:e.email||"",username:e.username||""}}render(){const{backend_name:e,url:t}=this.props,{activation:s,email:a,step:i,username:n}=this.state;return"register"===i?(0,o.Z)(b,{backend_name:e,email:a,url:t,username:n,onRegistrationComplete:this.handleRegistrationComplete}):(0,o.Z)(f,{activation:s,backend_name:e,email:a,url:t,username:n})}}var N=s(4869);r.Z.addInitializer({name:"component:social-auth",initializer:function(e){if("misago:social-complete"===e.get("CURRENT_LINK")){const t=e.get("SOCIAL_AUTH_FORM");(0,N.Z)(i().createElement(_,t),"page-mount")}},after:"store"})},60630:function(e,t,s){"use strict";var a,i,o,n=s(37424),r=s(22928),l=s(4942),d=s(57588),c=s.n(d),p=s(87462),u=s(43345),h=s(96359),m=s(8154),v=s(7738),g=s(78657),Z=s(59801),b=s(53904),f=s(90287),_=class extends u.Z{constructor(e){super(e),(0,l.Z)(this,"onUsernameChange",(e=>{this.changeValue("username",e.target.value)})),this.state={isLoading:!1,username:""}}clean(){return!!this.state.username.trim().length||(b.Z.error(gettext("You have to enter user name.")),!1)}send(){return g.Z.patch(this.props.thread.api.index,[{op:"add",path:"participants",value:this.state.username},{op:"add",path:"acl",value:1}])}handleSuccess(e){f.Z.dispatch((0,v.y8)(e)),f.Z.dispatch(m.gx(e.participants)),b.Z.success(gettext("New participant has been added to thread.")),Z.Z.hide()}render(){return(0,r.Z)("div",{className:"modal-dialog modal-sm",role:"document"},void 0,(0,r.Z)("form",{onSubmit:this.handleSubmit},void 0,(0,r.Z)("div",{className:"modal-content"},void 0,a||(a=(0,r.Z)(N,{})),(0,r.Z)("div",{className:"modal-body"},void 0,(0,r.Z)(h.Z,{for:"id_username",label:gettext("User to add")},void 0,(0,r.Z)("input",{id:"id_username",className:"form-control",disabled:this.state.isLoading,onChange:this.onUsernameChange,type:"text",value:this.state.username}))),(0,r.Z)("div",{className:"modal-footer"},void 0,(0,r.Z)("button",{className:"btn btn-block btn-primary",disabled:this.state.isLoading},void 0,gettext("Add participant")),(0,r.Z)("button",{className:"btn btn-block btn-default","data-dismiss":"modal",disabled:this.state.isLoading,type:"button"},void 0,gettext("Cancel"))))))}};function N(e){return(0,r.Z)("div",{className:"modal-header"},void 0,(0,r.Z)("button",{"aria-label":pgettext("modal","Close"),className:"close","data-dismiss":"modal",type:"button"},void 0,i||(i=(0,r.Z)("span",{"aria-hidden":"true"},void 0,"×"))),(0,r.Z)("h4",{className:"modal-title"},void 0,gettext("Add participant")))}var x,y,w,k=class extends c().Component{constructor(){super(...arguments),(0,l.Z)(this,"onClick",(()=>{Z.Z.show((0,r.Z)(_,{thread:this.props.thread}))}))}render(){return this.props.thread.acl.can_add_participants?(0,r.Z)("div",{className:"col-xs-12 col-sm-3"},void 0,(0,r.Z)("button",{className:"btn btn-default btn-block",onClick:this.onClick,type:"button"},void 0,o||(o=(0,r.Z)("span",{className:"material-icon"},void 0,"person_add")),gettext("Add participant"))):null}},C=s(32233),S=class extends c().Component{constructor(e){super(e),(0,l.Z)(this,"onClick",(()=>{let e=!1;if(this.isUser)e=window.confirm(gettext("Are you sure you want to take over this thread?"));else{const t=gettext("Are you sure you want to change thread owner to %(user)s?");e=window.confirm(interpolate(t,{user:this.props.participant.username},!0))}var t,s;e&&(t=this.props.thread,s=this.props.participant,g.Z.patch(t.api.index,[{op:"replace",path:"owner",value:s.id},{op:"add",path:"acl",value:1}]).then((e=>{f.Z.dispatch((0,v.y8)(e)),f.Z.dispatch(m.gx(e.participants));const t=gettext("%(user)s has been made new thread owner.");b.Z.success(interpolate(t,{user:s.username},!0))}),(e=>{b.Z.apiError(e)})))})),this.isUser=e.participant.id===e.user.id}render(){return this.props.participant.is_owner?null:this.props.thread.acl.can_change_owner?(0,r.Z)("li",{},void 0,(0,r.Z)("button",{className:"btn btn-link",onClick:this.onClick,type:"button"},void 0,gettext("Make owner"))):null}},E=class extends c().Component{constructor(e){super(e),(0,l.Z)(this,"onClick",(()=>{let e=!1;if(this.isUser)e=window.confirm(gettext("Are you sure you want to leave this thread?"));else{const t=gettext("Are you sure you want to remove %(user)s from this thread?");e=window.confirm(interpolate(t,{user:this.props.participant.username},!0))}var t,s;e&&(this.isUser?(t=this.props.thread,s=this.props.participant,g.Z.patch(t.api.index,[{op:"remove",path:"participants",value:s.id}]).then((()=>{b.Z.success(gettext("You have left this thread.")),window.setTimeout((()=>{window.location=C.Z.get("PRIVATE_THREADS_URL")}),3e3)}),(e=>{b.Z.apiError(e)}))):function(e,t){g.Z.patch(e.api.index,[{op:"remove",path:"participants",value:t.id},{op:"add",path:"acl",value:1}]).then((e=>{f.Z.dispatch((0,v.y8)(e)),f.Z.dispatch(m.gx(e.participants));const s=gettext("%(user)s has been removed from this thread.");b.Z.success(interpolate(s,{user:t.username},!0))}),(e=>{b.Z.apiError(e)}))}(this.props.thread,this.props.participant))})),this.isUser=e.participant.id===e.user.id}render(){const e=this.props.user.acl.can_moderate_private_threads;return this.props.userIsOwner||this.isUser||e?(0,r.Z)("li",{},void 0,(0,r.Z)("button",{className:"btn btn-link",onClick:this.onClick,type:"button"},void 0,this.isUser?gettext("Leave thread"):gettext("Remove"))):null}},L=s(19605);function T(e){const t=e.participant;let s="btn btn-default";return t.is_owner&&(s="btn btn-primary"),s+=" btn-user btn-block",(0,r.Z)("div",{className:"col-xs-12 col-sm-3 col-md-2 participant-card"},void 0,(0,r.Z)("div",{className:"dropdown"},void 0,(0,r.Z)("button",{"aria-haspopup":"true","aria-expanded":"false",className:s,"data-toggle":"dropdown",type:"button"},void 0,(0,r.Z)(L.ZP,{size:"34",user:t}),(0,r.Z)("span",{className:"btn-text"},void 0,t.username)),(0,r.Z)("ul",{className:"dropdown-menu stick-to-bottom"},void 0,(0,r.Z)(P,{isOwner:t.is_owner}),x||(x=(0,r.Z)("li",{className:"dropdown-header"})),(0,r.Z)("li",{},void 0,(0,r.Z)("a",{href:t.url},void 0,gettext("See profile"))),y||(y=(0,r.Z)("li",{role:"separator",className:"divider"})),c().createElement(S,e),c().createElement(E,e))))}function P(e){let{isOwner:t}=e;return t?(0,r.Z)("li",{className:"dropdown-header dropdown-header-owner"},void 0,w||(w=(0,r.Z)("span",{className:"material-icon"},void 0,"start")),(0,r.Z)("span",{className:"icon-text"},void 0,gettext("Thread owner"))):null}function O(e){let{participants:t,thread:s,user:a,userIsOwner:i}=e;return(0,r.Z)("div",{className:"participants-cards"},void 0,(0,r.Z)("div",{className:"row"},void 0,t.map((e=>(0,r.Z)(T,{participant:e,thread:s,user:a,userIsOwner:i},e.id)))))}function R(e){return e.participants.length?(0,r.Z)("div",{className:"panel panel-default panel-participants"},void 0,(0,r.Z)("div",{className:"panel-body"},void 0,c().createElement(O,(0,p.Z)({userIsOwner:A(e.user,e.participants)},e)),(0,r.Z)("div",{className:"row"},void 0,(0,r.Z)(k,{thread:e.thread}),(0,r.Z)("div",{className:"col-xs-12 col-sm-9"},void 0,(0,r.Z)("p",{},void 0,function(e){const t=e.length,s=ngettext("This thread has %(users)s participant.","This thread has %(users)s participants.",t);return interpolate(s,{users:t},!0)}(e.participants)))))):null}function A(e,t){return t[0].id===e.id}var I,D=s(30381),j=s.n(D);function z(e){return(0,r.Z)("div",{className:"poll-choices-bars"},void 0,e.poll.choices.map((t=>(0,r.Z)(U,{choice:t,poll:e.poll},t.hash))))}function U(e){let t=0;return e.choice.votes&&e.poll.votes&&(t=Math.ceil(100*e.choice.votes/e.poll.votes)),(0,r.Z)("dl",{className:"dl-horizontal"},void 0,(0,r.Z)("dt",{},void 0,e.choice.label),(0,r.Z)("dd",{},void 0,(0,r.Z)("div",{className:"progress"},void 0,(0,r.Z)("div",{className:"progress-bar",role:"progressbar","aria-valuenow":t,"aria-valuemin":"0","aria-valuemax":"100",style:{width:t+"%"}},void 0,(0,r.Z)("span",{className:"sr-only"},void 0,B(e.votes,e.proc)))),(0,r.Z)("ul",{className:"list-unstyled list-inline poll-chart"},void 0,(0,r.Z)(M,{proc:t,votes:e.choice.votes}),(0,r.Z)(q,{selected:e.choice.selected}))))}function M(e){return(0,r.Z)("li",{className:"poll-chart-votes"},void 0,B(e.votes,e.proc))}function B(e,t){const s=npgettext("thread poll","%(votes)s vote, %(proc)s% of total.","%(votes)s votes, %(proc)s% of total.",e);return interpolate(s,{votes:e,proc:t},!0)}function q(e){return e.selected?(0,r.Z)("li",{className:"poll-chart-selected"},void 0,I||(I=(0,r.Z)("span",{className:"material-icon"},void 0,"check_box")),pgettext("thread poll","You've voted on this choice.")):null}var H,F,Y,V=s(30337),G=s(3784),$=class extends c().Component{constructor(e){super(e),this.state={isLoading:!0,error:null,data:[]}}componentDidMount(){g.Z.get(this.props.poll.api.votes).then((e=>{const t=e.map((e=>Object.assign({},e,{voters:e.voters.map((e=>Object.assign({},e,{voted_on:j()(e.voted_on)})))})));this.setState({isLoading:!1,data:t})}),(e=>{this.setState({isLoading:!1,error:e.detail})}))}render(){return(0,r.Z)("div",{className:"modal-dialog"+(this.state.error?" modal-message":" modal-sm"),role:"document"},void 0,(0,r.Z)("div",{className:"modal-content"},void 0,(0,r.Z)("div",{className:"modal-header"},void 0,(0,r.Z)("button",{type:"button",className:"close","data-dismiss":"modal","aria-label":pgettext("modal","Close")},void 0,H||(H=(0,r.Z)("span",{"aria-hidden":"true"},void 0,"×"))),(0,r.Z)("h4",{className:"modal-title"},void 0,pgettext("thread poll","Poll votes"))),(0,r.Z)(W,{data:this.state.data,error:this.state.error,isLoading:this.state.isLoading})))}};function W(e){return e.isLoading?F||(F=(0,r.Z)(G.Z,{})):e.error?(0,r.Z)(V.Z,{icon:"error_outline",message:e.error}):(0,r.Z)(Q,{data:e.data})}function Q(e){return(0,r.Z)("div",{className:"modal-body modal-poll-votes"},void 0,(0,r.Z)("ul",{className:"list-unstyled votes-details"},void 0,e.data.map((e=>c().createElement(K,(0,p.Z)({key:e.hash},e))))))}function K(e){return(0,r.Z)("li",{},void 0,(0,r.Z)("h4",{},void 0,e.label),(0,r.Z)(J,{votes:e.votes}),(0,r.Z)(X,{voters:e.voters}),Y||(Y=(0,r.Z)("hr",{})))}function J(e){const t=npgettext("thread poll","%(votes)s user has voted for this choice.","%(votes)s users have voted for this choice.",e.votes),s=interpolate(t,{votes:e.votes},!0);return(0,r.Z)("p",{},void 0,s)}function X(e){return e.voters.length?(0,r.Z)("ul",{className:"list-unstyled"},void 0,e.voters.map((e=>c().createElement(ee,(0,p.Z)({key:e.username},e))))):null}function ee(e){return e.url?(0,r.Z)("li",{},void 0,(0,r.Z)("a",{className:"item-title",href:e.url},void 0,e.username)," ",(0,r.Z)(te,{voted_on:e.voted_on})):(0,r.Z)("li",{},void 0,(0,r.Z)("strong",{},void 0,e.username)," ",(0,r.Z)(te,{voted_on:e.voted_on}))}function te(e){return(0,r.Z)("abbr",{className:"text-muted",title:e.voted_on.format("LLL")},void 0,e.voted_on.fromNow())}var se=s(59752),ae=s(64646);function ie(e){const{isPollOver:t,poll:s,showVoting:a,thread:i}=e;if(!function(e,t,s){return s.is_public||t.can_delete||t.can_edit||t.can_see_votes||t.can_vote&&!e&&(!s.hasSelectedChoices||s.allow_revotes)}(t,s.acl,s))return null;const o=[],n=s.acl.can_vote,l=!s.hasSelectedChoices||s.allow_revotes;return n&&l&&o.push(0),(s.is_public||s.acl.can_see_votes)&&o.push(1),s.acl.can_edit&&o.push(2),s.acl.can_delete&&o.push(3),(0,r.Z)("div",{className:"row poll-options"},void 0,(0,r.Z)(ne,{controls:o,isPollOver:t,poll:s,showVoting:a}),(0,r.Z)(re,{controls:o,poll:s}),(0,r.Z)(le,{controls:o,poll:s,thread:i,onClick:e.edit}),(0,r.Z)(de,{controls:o,poll:s}))}function oe(e,t){let s="col-xs-6";return 1===e.length&&(s="col-xs-12"),3===e.length&&e[0]===t&&(s="col-xs-12"),s+" col-sm-3 col-md-2"}function ne(e){const t=e.poll.acl.can_vote,s=!e.poll.hasSelectedChoices||e.poll.allow_revotes;return t&&s?(0,r.Z)("div",{className:oe(e.controls,0)},void 0,(0,r.Z)("button",{className:"btn btn-default btn-block btn-sm",disabled:e.poll.isBusy,onClick:e.showVoting,type:"button"},void 0,pgettext("thread poll","Vote"))):null}class re extends c().Component{constructor(){super(...arguments),(0,l.Z)(this,"onClick",(()=>{Z.Z.show((0,r.Z)($,{poll:this.props.poll}))}))}render(){return this.props.poll.is_public||this.props.poll.acl.can_see_votes?(0,r.Z)("div",{className:oe(this.props.controls,1)},void 0,(0,r.Z)("button",{className:"btn btn-default btn-block btn-sm",disabled:this.props.poll.isBusy,onClick:this.onClick,type:"button"},void 0,pgettext("thread poll","See votes"))):null}}function le(e){return e.poll.acl.can_edit?(0,r.Z)("div",{className:oe(e.controls,2)},void 0,(0,r.Z)("button",{className:"btn btn-default btn-block btn-sm",disabled:e.poll.isBusy,onClick:e.onClick,type:"button"},void 0,pgettext("thread poll","Edit"))):null}class de extends c().Component{constructor(){super(...arguments),(0,l.Z)(this,"onClick",(()=>{if(!window.confirm(pgettext("thread poll","Are you sure you want to delete this poll? This action is not reversible.")))return!1;f.Z.dispatch(se.n6()),g.Z.delete(this.props.poll.api.index).then(this.handleSuccess,this.handleError)})),(0,l.Z)(this,"handleSuccess",(e=>{b.Z.success(pgettext("thread poll","Poll has been deleted")),f.Z.dispatch(se.Od()),f.Z.dispatch(v.y8(e))})),(0,l.Z)(this,"handleError",(e=>{b.Z.apiError(e),f.Z.dispatch(se.Ar())}))}render(){return this.props.poll.acl.can_delete?(0,r.Z)("div",{className:oe(this.props.controls,3)},void 0,(0,r.Z)("button",{className:"btn btn-default btn-block btn-sm",disabled:this.props.poll.isBusy,onClick:this.onClick,type:"button"},void 0,pgettext("thread poll","Delete"))):null}}var ce=s(89627);const pe='<abbr title="%(absolute)s">%(relative)s</abbr>';function ue(e){return(0,r.Z)("ul",{className:"list-unstyled list-inline poll-details"},void 0,(0,r.Z)(be,{votes:e.poll.votes}),(0,r.Z)(ge,{poll:e.poll}),(0,r.Z)(fe,{poll:e.poll}),(0,r.Z)(he,{poll:e.poll}))}function he(e){const t=interpolate((0,ce.Z)(pgettext("thread poll","Started by %(poster)s %(posted_on)s.")),{poster:me(e.poll),posted_on:ve(e.poll)},!0);return(0,r.Z)("li",{className:"poll-info-creation",dangerouslySetInnerHTML:{__html:t}})}function me(e){return e.url.poster?interpolate('<a href="%(url)s" class="item-title">%(user)s</a>',{url:(0,ce.Z)(e.url.poster),user:(0,ce.Z)(e.poster_name)},!0):interpolate('<span class="item-title">%(user)s</span>',{user:(0,ce.Z)(e.poster_name)},!0)}function ve(e){return interpolate(pe,{absolute:(0,ce.Z)(e.posted_on.format("LLL")),relative:(0,ce.Z)(e.posted_on.fromNow())},!0)}function ge(e){if(!e.poll.length)return null;const t=interpolate((0,ce.Z)(pgettext("thread poll","Voting ends %(ends_on)s.")),{ends_on:Ze(e.poll)},!0);return(0,r.Z)("li",{className:"poll-info-ends-on",dangerouslySetInnerHTML:{__html:t}})}function Ze(e){return interpolate(pe,{absolute:(0,ce.Z)(e.endsOn.format("LLL")),relative:(0,ce.Z)(e.endsOn.fromNow())},!0)}function be(e){const t=npgettext("thread poll","%(votes)s vote.","%(votes)s votes.",e.votes),s=interpolate(t,{votes:e.votes},!0);return(0,r.Z)("li",{className:"poll-info-votes"},void 0,s)}function fe(e){return e.poll.is_public?(0,r.Z)("li",{className:"poll-info-public"},void 0,pgettext("thread poll","Voting is public.")):null}function _e(e){return(0,r.Z)("div",{className:"panel panel-default panel-poll"},void 0,(0,r.Z)("div",{className:"panel-body"},void 0,(0,r.Z)("h2",{},void 0,e.poll.question),(0,r.Z)(ue,{poll:e.poll}),(0,r.Z)(z,{poll:e.poll}),(0,r.Z)(ie,{isPollOver:e.isPollOver,poll:e.poll,showVoting:e.showVoting,thread:e.thread})))}function Ne(e){return(0,r.Z)("ul",{className:"list-unstyled list-inline poll-help"},void 0,(0,r.Z)(xe,{choicesLeft:e.choicesLeft}),(0,r.Z)(ye,{poll:e.poll}))}function xe(e){let{choicesLeft:t}=e;if(0===t)return(0,r.Z)("li",{className:"poll-help-choices-left"},void 0,pgettext("thread poll","You can't select any more choices."));const s=npgettext("thread poll","You can select %(choices)s more choice.","You can select %(choices)s more choices.",t),a=interpolate(s,{choices:t},!0);return(0,r.Z)("li",{className:"poll-help-choices-left"},void 0,a)}function ye(e){return e.poll.allow_revotes?(0,r.Z)("li",{className:"poll-help-allow-revotes"},void 0,pgettext("thread poll","You can change your vote later.")):(0,r.Z)("li",{className:"poll-help-no-revotes"},void 0,pgettext("thread poll","Votes are final."))}function we(e){return(0,r.Z)("ul",{className:"list-unstyled poll-select-choices"},void 0,e.choices.map((t=>(0,r.Z)(ke,{choice:t,toggleChoice:e.toggleChoice},t.hash))))}class ke extends c().Component{constructor(){super(...arguments),(0,l.Z)(this,"onClick",(()=>{this.props.toggleChoice(this.props.choice.hash)}))}render(){return(0,r.Z)("li",{className:"poll-select-choice"},void 0,(0,r.Z)("button",{className:this.props.choice.selected?"btn btn-selected":"btn",onClick:this.onClick,type:"button"},void 0,(0,r.Z)("span",{className:"material-icon"},void 0,this.props.choice.selected?"check_box":"check_box_outline_blank"),(0,r.Z)("strong",{},void 0,this.props.choice.label)))}}function Ce(e,t){let s=[];for(const e in t){const a=t[e];a.selected&&s.push(a)}return e.allowed_choices-s.length}var Se,Ee=s(82211),Le=class extends u.Z{constructor(e){super(e),(0,l.Z)(this,"toggleChoice",(e=>{const t=function(e,t){for(const s in e){const a=e[s];if(a.hash===t)return a}return null}(this.state.choices,e);let s=null;s=t.selected?this.deselectChoice(t,e):this.selectChoice(t,e),this.setState({choices:s,choicesLeft:Ce(this.props.poll,s)})})),(0,l.Z)(this,"selectChoice",((e,t)=>{if(!Ce(this.props.poll,this.state.choices))for(const e in this.state.choices.slice()){const s=this.state.choices[e];if(s.selected&&s.hash!=t){s.selected=!1;break}}return this.state.choices.map((e=>Object.assign({},e,{selected:e.hash==t||e.selected})))})),(0,l.Z)(this,"deselectChoice",((e,t)=>this.state.choices.map((e=>Object.assign({},e,{selected:e.hash!=t&&e.selected}))))),this.state={isLoading:!1,choices:e.poll.choices,choicesLeft:Ce(e.poll,e.poll.choices)}}clean(){return this.state.choicesLeft!==this.props.poll.allowed_choices||(b.Z.error(gettext("You need to select at least one choice")),!1)}send(){let e=[];for(const t in this.state.choices.slice()){const s=this.state.choices[t];s.selected&&e.push(s.hash)}return g.Z.post(this.props.poll.api.votes,e)}handleSuccess(e){f.Z.dispatch(se.gx(e)),b.Z.success(gettext("Your vote has been saved.")),this.props.showResults()}handleError(e){400===e.status?b.Z.error(e.detail):b.Z.apiError(e)}render(){const e=[];return this.props.poll.acl.can_vote&&e.push(0),(this.props.poll.is_public||this.props.poll.acl.can_see_votes)&&e.push(1),this.props.poll.acl.can_edit&&e.push(2),this.props.poll.acl.can_delete&&e.push(3),(0,r.Z)("div",{className:"panel panel-default panel-poll"},void 0,(0,r.Z)("form",{onSubmit:this.handleSubmit},void 0,(0,r.Z)("div",{className:"panel-body"},void 0,(0,r.Z)("h2",{},void 0,this.props.poll.question),(0,r.Z)(ue,{poll:this.props.poll}),(0,r.Z)(we,{choices:this.state.choices,toggleChoice:this.toggleChoice}),(0,r.Z)(Ne,{choicesLeft:this.state.choicesLeft,poll:this.props.poll})),(0,r.Z)("div",{className:"panel-footer"},void 0,(0,r.Z)("div",{className:"row"},void 0,(0,r.Z)("div",{className:oe(e,0)},void 0,(0,r.Z)(Ee.Z,{className:"btn-primary btn-block btn-sm",loading:this.state.isLoading},void 0,gettext("Save your vote"))),(0,r.Z)("div",{className:oe(e,1)},void 0,(0,r.Z)("button",{className:"btn btn-default btn-block btn-sm",disabled:this.state.isLoading,onClick:this.props.showResults,type:"button"},void 0,gettext("See results"))),(0,r.Z)(le,{controls:e,poll:this.props.poll,thread:this.props.thread,onClick:this.props.edit}),(0,r.Z)(de,{controls:e,poll:this.props.poll})))))}},Te=class extends c().Component{constructor(e){super(e),(0,l.Z)(this,"showResults",(()=>{this.setState({showResults:!0})})),(0,l.Z)(this,"showVoting",(()=>{this.setState({showResults:!1})}));let t=!0;e.user.id&&!e.poll.hasSelectedChoices&&(t=!1),this.state={showResults:t}}render(){if(!this.props.thread.poll)return null;const e=function(e){return!!e.length&&j()().isAfter(e.endsOn)}(this.props.poll);return e||!this.props.poll.acl.can_vote||this.state.showResults?c().createElement(_e,(0,p.Z)({isPollOver:e,showVoting:this.showVoting},this.props)):c().createElement(Le,(0,p.Z)({showResults:this.showResults},this.props))}},Pe=class extends c().Component{constructor(){super(...arguments),(0,l.Z)(this,"onAdd",(()=>{let e=this.props.choices.slice();e.push({hash:Re(),label:""}),this.props.setChoices(e)})),(0,l.Z)(this,"onChange",((e,t)=>{const s=this.props.choices.map((s=>(s.hash===e&&(s.label=t),s)));this.props.setChoices(s)})),(0,l.Z)(this,"onDelete",(e=>{const t=this.props.choices.filter((t=>t.hash!==e));this.props.setChoices(t)}))}render(){return(0,r.Z)("div",{className:"poll-choices-control"},void 0,(0,r.Z)("ul",{className:"list-group"},void 0,this.props.choices.map((e=>(0,r.Z)(Oe,{canDelete:this.props.choices.length>2,choice:e,disabled:this.props.disabled,onChange:this.onChange,onDelete:this.onDelete},e.hash)))),(0,r.Z)("button",{className:"btn btn-default btn-sm",disabled:this.props.disabled,onClick:this.onAdd,type:"button"},void 0,pgettext("thread poll","Add choice")))}};class Oe extends c().Component{constructor(){super(...arguments),(0,l.Z)(this,"onChange",(e=>{this.props.onChange(this.props.choice.hash,e.target.value)})),(0,l.Z)(this,"onDelete",(()=>{window.confirm(pgettext("thread poll","Are you sure you want to remove this choice?"))&&this.props.onDelete(this.props.choice.hash)}))}render(){return(0,r.Z)("li",{className:"list-group-item"},void 0,(0,r.Z)("button",{className:"btn",disabled:!this.props.canDelete||this.props.disabled,onClick:this.onDelete,title:pgettext("thread poll","Remove this choice"),type:"button"},void 0,Se||(Se=(0,r.Z)("span",{className:"material-icon"},void 0,"close"))),(0,r.Z)("input",{disabled:this.props.disabled,maxLength:"255",placeholder:pgettext("thread poll","Poll choice"),type:"text",onChange:this.onChange,value:this.props.choice.label}))}}function Re(){let e="";for(;12!=e.length;)e=Math.random().toString(36).replace(/[^a-zA-Z0-9]+/g,"").substr(1,12);return e}var Ae=s(7227),Ie=class extends u.Z{constructor(e){super(e),(0,l.Z)(this,"setChoices",(e=>{const t=Object.assign({},t,{choices:null});this.setState({choices:e,errors:t})})),(0,l.Z)(this,"onCancel",(()=>{let e=!1;e=this.props.poll?window.confirm(pgettext("thread poll","Are you sure you want to discard changes?")):window.confirm(pgettext("thread poll","Are you sure you want to discard new poll?")),e&&this.props.close()}));const t=e.poll.id?e.poll:{question:"",choices:[{hash:"choice-10000",label:""},{hash:"choice-20000",label:""}],length:0,allowed_choices:1,allow_revotes:0,is_public:0};this.state={isLoading:!1,isEdit:!!t.id,question:t.question,choices:t.choices,length:t.length,allowed_choices:t.allowed_choices,allow_revotes:t.allow_revotes,is_public:t.is_public,validators:{question:[],choices:[],length:[],allowed_choices:[]},errors:{}}}send(){const e={question:this.state.question,choices:this.state.choices,length:this.state.length,allowed_choices:this.state.allowed_choices,allow_revotes:this.state.allow_revotes,is_public:this.state.is_public};return this.state.isEdit?g.Z.put(this.props.poll.api.index,e):g.Z.post(this.props.thread.api.poll,e)}handleSuccess(e){f.Z.dispatch(se.gx(e)),this.state.isEdit?b.Z.success(pgettext("thread poll","Poll has been edited.")):b.Z.success(pgettext("thread poll","Poll has been posted.")),this.props.close()}handleError(e){400===e.status?(e.non_field_errors&&(e.allowed_choices=e.non_field_errors),this.setState({errors:Object.assign({},e)}),b.Z.error(gettext("Form contains errors."))):b.Z.apiError(e)}render(){return(0,r.Z)("div",{className:"poll-form"},void 0,(0,r.Z)("form",{onSubmit:this.handleSubmit},void 0,(0,r.Z)("div",{className:"panel panel-default panel-form"},void 0,(0,r.Z)("div",{className:"panel-heading"},void 0,(0,r.Z)("h3",{className:"panel-title"},void 0,this.state.isEdit?pgettext("thread poll","Edit poll"):pgettext("thread poll","Add poll"))),(0,r.Z)("div",{className:"panel-body"},void 0,(0,r.Z)("fieldset",{},void 0,(0,r.Z)("legend",{},void 0,pgettext("thread poll","Question and choices")),(0,r.Z)(h.Z,{label:pgettext("thread poll","Poll question"),for:"id_questions",validation:this.state.errors.question},void 0,(0,r.Z)("input",{className:"form-control",disabled:this.state.isLoading,id:"id_questions",onChange:this.bindInput("question"),type:"text",maxLength:"255",value:this.state.question})),(0,r.Z)(h.Z,{label:pgettext("thread poll","Available choices"),validation:this.state.errors.choices},void 0,(0,r.Z)(Pe,{choices:this.state.choices,disabled:this.state.isLoading,setChoices:this.setChoices}))),(0,r.Z)("fieldset",{},void 0,(0,r.Z)("legend",{},void 0,pgettext("thread poll","Voting")),(0,r.Z)("div",{className:"row"},void 0,(0,r.Z)("div",{className:"col-xs-12 col-sm-6"},void 0,(0,r.Z)(h.Z,{label:pgettext("thread poll","Poll length"),helpText:pgettext("thread poll","Enter number of days for which voting in this poll should be possible or zero to run this poll indefinitely."),for:"id_length",validation:this.state.errors.length},void 0,(0,r.Z)("input",{className:"form-control",disabled:this.state.isLoading,id:"id_length",onChange:this.bindInput("length"),type:"text",value:this.state.length}))),(0,r.Z)("div",{className:"col-xs-12 col-sm-6"},void 0,(0,r.Z)(h.Z,{label:pgettext("thread poll","Allowed choices"),for:"id_allowed_choices",validation:this.state.errors.allowed_choices},void 0,(0,r.Z)("input",{className:"form-control",disabled:this.state.isLoading,id:"id_allowed_choices",onChange:this.bindInput("allowed_choices"),type:"text",maxLength:"255",value:this.state.allowed_choices})))),(0,r.Z)("div",{className:"row"},void 0,(0,r.Z)(De,{bindInput:this.bindInput,disabled:this.state.isLoading,isEdit:this.state.isEdit,value:this.state.is_public}),(0,r.Z)("div",{className:"col-xs-12 col-sm-6"},void 0,(0,r.Z)(h.Z,{label:pgettext("thread poll","Allow vote changes"),for:"id_allow_revotes"},void 0,(0,r.Z)(Ae.Z,{id:"id_allow_revotes",disabled:this.state.isLoading,iconOn:"check",iconOff:"close",labelOn:pgettext("thread poll","Allow participants to change their vote"),labelOff:pgettext("thread poll","Don't allow participants to change their vote"),onChange:this.bindInput("allow_revotes"),value:this.state.allow_revotes})))))),(0,r.Z)("div",{className:"panel-footer text-right"},void 0,(0,r.Z)("button",{className:"btn btn-default",disabled:this.state.isLoading,onClick:this.onCancel,type:"button"},void 0,pgettext("thread poll","Cancel"))," ",(0,r.Z)(Ee.Z,{className:"btn-primary",loading:this.state.isLoading},void 0,this.state.isEdit?pgettext("thread poll","Save changes"):pgettext("thread poll","Post poll"))))))}};function De(e){return e.isEdit?null:(0,r.Z)("div",{className:"col-xs-12 col-sm-6"},void 0,(0,r.Z)(h.Z,{label:pgettext("thread poll","Make voting public"),helpText:pgettext("thread poll","Making voting public will allow everyone to access detailed list of votes, showing which users voted for which choices and at which times. This option can't be changed after poll's creation. Moderators may see voting details for all polls."),for:"id_is_public"},void 0,(0,r.Z)(Ae.Z,{id:"id_is_public",disabled:e.disabled,iconOn:"visibility",iconOff:"visibility_off",labelOn:pgettext("thread poll","Votes are public"),labelOff:pgettext("thread poll","Votes are hidden"),onChange:e.bindInput("is_public"),value:e.value})))}const je={changed_title:"edit",pinned_globally:"bookmark",pinned_locally:"bookmark_border",unpinned:"panorama_fish_eye",moved:"arrow_forward",merged:"call_merge",approved:"done",opened:"lock_open",closed:"lock_outline",unhid:"visibility",hid:"visibility_off",changed_owner:"grade",tookover:"grade",added_participant:"person_add",owner_left:"person_outline",participant_left:"person_outline",removed_participant:"remove_circle_outline"};var ze=e=>(0,r.Z)("span",{className:"event-icon-bg"},void 0,(0,r.Z)("span",{className:"material-icon"},void 0,je[e.post.event_type])),Ue=s(92747);function Me(e){return e.post.acl.can_hide?(0,r.Z)("li",{className:"event-controls"},void 0,c().createElement(Be,e),c().createElement(qe,e),c().createElement(He,e)):null}class Be extends c().Component{constructor(){super(...arguments),(0,l.Z)(this,"onClick",(()=>{f.Z.dispatch(Ue.r$(this.props.post,{is_hidden:!0,hidden_on:j()(),hidden_by_name:this.props.user.username,url:Object.assign(this.props.post.url,{hidden_by:this.props.user.url})})),g.Z.patch(this.props.post.api.index,[{op:"replace",path:"is-hidden",value:!0}]).then((e=>{f.Z.dispatch(Ue.r$(this.props.post,e))}),(e=>{400===e.status?b.Z.error(e.detail[0]):b.Z.apiError(e),f.Z.dispatch(Ue.r$(this.props.post,{is_hidden:!1}))}))}))}render(){return this.props.post.is_hidden?null:(0,r.Z)("button",{type:"button",className:"btn btn-link",onClick:this.onClick},void 0,gettext("Hide"))}}class qe extends c().Component{constructor(){super(...arguments),(0,l.Z)(this,"onClick",(()=>{f.Z.dispatch(Ue.r$(this.props.post,{is_hidden:!1})),g.Z.patch(this.props.post.api.index,[{op:"replace",path:"is-hidden",value:!1}]).then((e=>{f.Z.dispatch(Ue.r$(this.props.post,e))}),(e=>{400===e.status?b.Z.error(e.detail[0]):b.Z.apiError(e),f.Z.dispatch(Ue.r$(this.props.post,{is_hidden:!0}))}))}))}render(){return this.props.post.is_hidden?(0,r.Z)("button",{type:"button",className:"btn btn-link",onClick:this.onClick},void 0,gettext("Unhide")):null}}class He extends c().Component{constructor(){super(...arguments),(0,l.Z)(this,"onClick",(()=>{window.confirm(gettext("Are you sure you wish to delete this event? This action is not reversible!"))&&this.delete()})),(0,l.Z)(this,"delete",(()=>{f.Z.dispatch(Ue.r$(this.props.post,{isDeleted:!0})),g.Z.delete(this.props.post.api.index).then((()=>{b.Z.success(gettext("Event has been deleted."))}),(e=>{400===e.status?b.Z.error(e.detail[0]):b.Z.apiError(e),f.Z.dispatch(Ue.r$(this.props.post,{isDeleted:!1}))}))}))}render(){return(0,r.Z)("button",{type:"button",className:"btn btn-link",onClick:this.onClick},void 0,gettext("Delete"))}}const Fe='<span class="item-title">%(user)s</span>',Ye='<a href="%(url)s" class="item-title">%(user)s</a>';function Ve(e){return(0,r.Z)("ul",{className:"list-inline event-info"},void 0,c().createElement(Ge,e),c().createElement($e,e),c().createElement(Me,e))}function Ge(e){if(e.post.is_hidden){let t=null;t=e.post.url.hidden_by?interpolate(Ye,{url:(0,ce.Z)(e.post.url.hidden_by),user:(0,ce.Z)(e.post.hidden_by_name)},!0):interpolate(Fe,{user:(0,ce.Z)(e.post.hidden_by_name)},!0);const s=interpolate('<abbr title="%(absolute)s">%(relative)s</abbr>',{absolute:(0,ce.Z)(e.post.hidden_on.format("LLL")),relative:(0,ce.Z)(e.post.hidden_on.fromNow())},!0),a=interpolate((0,ce.Z)(gettext("Hidden by %(event_by)s %(event_on)s.")),{event_by:t,event_on:s},!0);return(0,r.Z)("li",{className:"event-hidden-message",dangerouslySetInnerHTML:{__html:a}})}return null}function $e(e){let t=null;t=e.post.poster?interpolate(Ye,{url:(0,ce.Z)(e.post.poster.url),user:(0,ce.Z)(e.post.poster_name)},!0):interpolate(Fe,{user:(0,ce.Z)(e.post.poster_name)},!0);const s=interpolate('<a href="%(url)s" title="%(absolute)s">%(relative)s</a>',{url:(0,ce.Z)(e.post.url.index),absolute:(0,ce.Z)(e.post.posted_on.format("LLL")),relative:(0,ce.Z)(e.post.posted_on.fromNow())},!0),a=interpolate((0,ce.Z)(gettext("By %(event_by)s %(event_on)s.")),{event_by:t,event_on:s},!0);return(0,r.Z)("li",{className:"event-posters",dangerouslySetInnerHTML:{__html:a}})}const We={pinned_globally:gettext("Thread has been pinned globally."),pinned_locally:gettext("Thread has been pinned locally."),unpinned:gettext("Thread has been unpinned."),approved:gettext("Thread has been approved."),opened:gettext("Thread has been opened."),closed:gettext("Thread has been closed."),unhid:gettext("Thread has been revealed."),hid:gettext("Thread has been made hidden."),tookover:gettext("Took thread over."),owner_left:gettext("Owner has left thread. This thread is now closed."),participant_left:gettext("Participant has left thread.")},Qe='<a href="%(url)s" class="item-title">%(name)s</a>',Ke='<span class="item-title">%(name)s</span>';function Je(e){return We[e.post.event_type]?(0,r.Z)("p",{className:"event-message"},void 0,We[e.post.event_type]):"changed_title"===e.post.event_type?c().createElement(Xe,e):"moved"===e.post.event_type?c().createElement(et,e):"merged"===e.post.event_type?c().createElement(tt,e):"changed_owner"===e.post.event_type?c().createElement(st,e):"added_participant"===e.post.event_type?c().createElement(at,e):"removed_participant"===e.post.event_type?c().createElement(it,e):null}function Xe(e){const t=(0,ce.Z)(gettext("Thread title has been changed from %(old_title)s.")),s=interpolate(Ke,{name:(0,ce.Z)(e.post.event_context.old_title)},!0),a=interpolate(t,{old_title:s},!0);return(0,r.Z)("p",{className:"event-message",dangerouslySetInnerHTML:{__html:a}})}function et(e){const t=(0,ce.Z)(gettext("Thread has been moved from %(from_category)s.")),s=interpolate(Qe,{url:(0,ce.Z)(e.post.event_context.from_category.url),name:(0,ce.Z)(e.post.event_context.from_category.name)},!0),a=interpolate(t,{from_category:s},!0);return(0,r.Z)("p",{className:"event-message",dangerouslySetInnerHTML:{__html:a}})}function tt(e){const t=(0,ce.Z)(gettext("The %(merged_thread)s thread has been merged into this thread.")),s=interpolate(Ke,{name:(0,ce.Z)(e.post.event_context.merged_thread)},!0),a=interpolate(t,{merged_thread:s},!0);return(0,r.Z)("p",{className:"event-message",dangerouslySetInnerHTML:{__html:a}})}function st(e){const t=(0,ce.Z)(gettext("Changed thread owner to %(user)s.")),s=interpolate(Qe,{url:(0,ce.Z)(e.post.event_context.user.url),name:(0,ce.Z)(e.post.event_context.user.username)},!0),a=interpolate(t,{user:s},!0);return(0,r.Z)("p",{className:"event-message",dangerouslySetInnerHTML:{__html:a}})}function at(e){const t=(0,ce.Z)(gettext("Added %(user)s to thread.")),s=interpolate(Qe,{url:(0,ce.Z)(e.post.event_context.user.url),name:(0,ce.Z)(e.post.event_context.user.username)},!0),a=interpolate(t,{user:s},!0);return(0,r.Z)("p",{className:"event-message",dangerouslySetInnerHTML:{__html:a}})}function it(e){const t=(0,ce.Z)(gettext("Removed %(user)s from thread.")),s=interpolate(Qe,{url:(0,ce.Z)(e.post.event_context.user.url),name:(0,ce.Z)(e.post.event_context.user.username)},!0),a=interpolate(t,{user:s},!0);return(0,r.Z)("p",{className:"event-message",dangerouslySetInnerHTML:{__html:a}})}function ot(e){let{post:t}=e;return t.is_read?null:(0,r.Z)("div",{className:"event-label"},void 0,(0,r.Z)("span",{className:"label label-unread"},void 0,gettext("New event")))}var nt=s(19755),rt=class extends c().Component{componentDidMount(){this.props.post.is_read||nt(this.element).waypoint({handler:e=>{"down"!==e||this.props.post.is_read||window.setTimeout((()=>{const e=this.element.getBoundingClientRect(),t=e.height+e.top,s=document.documentElement.clientHeight;t<5||t>s||(f.Z.dispatch(Ue.r$(this.props.post,{is_read:!0})),g.Z.post(this.props.post.api.read).then((e=>{f.Z.dispatch(v.Vx(this.props.thread,{is_read:e.thread_is_read}))}),(e=>{b.Z.apiError(e)})))}),1e3)},offset:"bottom-in-view"})}render(){return c().createElement("div",{className:this.props.className,ref:e=>{e&&(this.element=e)}},this.props.children)}};function lt(e){let t="event";return e.post.isDeleted?t="hide":e.post.is_hidden&&(t="event post-hidden"),(0,r.Z)("li",{id:"post-"+e.post.id,className:t},void 0,(0,r.Z)(ot,{post:e.post}),(0,r.Z)("div",{className:"event-body"},void 0,(0,r.Z)("div",{className:"event-icon"},void 0,c().createElement(ze,e)),(0,r.Z)(rt,{className:"event-content",post:e.post},void 0,c().createElement(Je,e),c().createElement(Ve,e))))}var dt=s(69130),ct=s(48772);function pt(e){return(0,r.Z)("div",{className:"col-xs-12 col-md-6"},void 0,c().createElement(ut,e),(0,r.Z)("div",{className:"post-attachment"},void 0,(0,r.Z)("a",{href:e.attachment.url.index,className:"attachment-name item-title"},void 0,e.attachment.filename),c().createElement(vt,e)))}function ut(e){return e.attachment.is_image?(0,r.Z)("div",{className:"post-attachment-preview"},void 0,c().createElement(mt,e)):(0,r.Z)("div",{className:"post-attachment-preview"},void 0,c().createElement(ht,e))}function ht(e){return(0,r.Z)("a",{href:e.attachment.url.index,className:"material-icon"},void 0,"insert_drive_file")}function mt(e){const t=e.attachment.url.thumb||e.attachment.url.index;return(0,r.Z)("a",{className:"post-thumbnail",href:e.attachment.url.index,style:{backgroundImage:'url("'+(0,ce.Z)(t)+'")'}})}function vt(e){let t=null;t=e.attachment.url.uploader?interpolate('<a href="%(url)s" class="item-title">%(user)s</a>',{url:(0,ce.Z)(e.attachment.url.uploader),user:(0,ce.Z)(e.attachment.uploader_name)},!0):interpolate('<span class="item-title">%(user)s</span>',{user:(0,ce.Z)(e.attachment.uploader_name)},!0);const s=interpolate('<abbr title="%(absolute)s">%(relative)s</abbr>',{absolute:(0,ce.Z)(e.attachment.uploaded_on.format("LLL")),relative:(0,ce.Z)(e.attachment.uploaded_on.fromNow())},!0),a=interpolate((0,ce.Z)(gettext("%(filetype)s, %(size)s, uploaded by %(uploader)s %(uploaded_on)s.")),{filetype:e.attachment.filetype,size:(0,ct.Z)(e.attachment.size),uploader:t,uploaded_on:s},!0);return(0,r.Z)("p",{className:"post-attachment-description",dangerouslySetInnerHTML:{__html:a}})}function gt(e){return function(e){return(!e.is_hidden||e.acl.can_see_hidden)&&e.attachments}(e.post)?(0,r.Z)("div",{className:"post-attachments"},void 0,(0,dt.Z)(e.post.attachments,2).map((e=>{const t=e.map((e=>e?e.id:0)).join("_");return(0,r.Z)(Zt,{row:e},t)}))):null}function Zt(e){return(0,r.Z)("div",{className:"row"},void 0,e.row.map((e=>(0,r.Z)(pt,{attachment:e},e?e.id:0))))}var bt,ft,_t,Nt,xt,yt,wt,kt=s(69092);function Ct(e){return e.post.is_hidden&&!e.post.acl.can_see_hidden?c().createElement(Et,e):e.post.content?c().createElement(St,e):c().createElement(Lt,e)}function St(e){let{post:t}=e;const s="@"+(t.poster?t.poster.username:t.poster_name);return(0,r.Z)(rt,{className:"post-body",post:t},void 0,(0,r.Z)(kt.Z,{author:s,markup:t.content}))}function Et(e){let t=null;t=e.post.hidden_by?interpolate('<a href="%(url)s" class="item-title">%(user)s</a>',{url:(0,ce.Z)(e.post.url.hidden_by),user:(0,ce.Z)(e.post.hidden_by_name)},!0):interpolate('<span class="item-title">%(user)s</span>',{user:(0,ce.Z)(e.post.hidden_by_name)},!0);const s=interpolate('<abbr class="last-title" title="%(absolute)s">%(relative)s</abbr>',{absolute:(0,ce.Z)(e.post.hidden_on.format("LLL")),relative:(0,ce.Z)(e.post.hidden_on.fromNow())},!0),a=interpolate((0,ce.Z)(gettext("Hidden by %(hidden_by)s %(hidden_on)s.")),{hidden_by:t,hidden_on:s},!0);return(0,r.Z)(rt,{className:"post-body post-body-hidden",post:e.post},void 0,(0,r.Z)("p",{className:"lead"},void 0,gettext("This post is hidden. You cannot see its contents.")),(0,r.Z)("p",{className:"text-muted",dangerouslySetInnerHTML:{__html:a}}))}function Lt(e){return(0,r.Z)(rt,{className:"post-body post-body-invalid",post:e.post},void 0,(0,r.Z)("p",{className:"lead"},void 0,gettext("This post's contents cannot be displayed.")),(0,r.Z)("p",{className:"text-muted"},void 0,gettext("This error is caused by invalid post content manipulation.")))}function Tt(e){let{post:t,thread:s,user:a}=e;if(!At(t)||t.id!==s.best_answer)return null;let i=null;return i=a.id&&s.best_answer_marked_by===a.id?interpolate(gettext("Marked as best answer by you %(marked_on)s."),{marked_on:s.best_answer_marked_on.fromNow()},!0):interpolate(gettext("Marked as best answer by %(marked_by)s %(marked_on)s."),{marked_by:s.best_answer_marked_by_name,marked_on:s.best_answer_marked_on.fromNow()},!0),(0,r.Z)("div",{className:"post-status-message post-status-best-answer"},void 0,bt||(bt=(0,r.Z)("span",{className:"material-icon"},void 0,"check_box")),(0,r.Z)("p",{},void 0,i))}function Pt(e){return At(e.post)&&e.post.is_hidden?(0,r.Z)("div",{className:"post-status-message post-status-hidden"},void 0,ft||(ft=(0,r.Z)("span",{className:"material-icon"},void 0,"visibility_off")),(0,r.Z)("p",{},void 0,gettext("This post is hidden. Only users with permission may see its contents."))):null}function Ot(e){return At(e.post)&&e.post.is_unapproved?(0,r.Z)("div",{className:"post-status-message post-status-unapproved"},void 0,_t||(_t=(0,r.Z)("span",{className:"material-icon"},void 0,"remove_circle_outline")),(0,r.Z)("p",{},void 0,gettext("This post is unapproved. Only users with permission to approve posts and its author may see its contents."))):null}function Rt(e){return At(e.post)&&e.post.is_protected?(0,r.Z)("div",{className:"post-status-message post-status-protected visible-xs-block"},void 0,Nt||(Nt=(0,r.Z)("span",{className:"material-icon"},void 0,"lock_outline")),(0,r.Z)("p",{},void 0,gettext("This post is protected. Only moderators may change it."))):null}function At(e){return!e.is_hidden||e.acl.can_see_hidden}function It(e,t,s){g.Z.patch(e.post.api.index,t).then((t=>{f.Z.dispatch(Ue.r$(e.post,t))}),(t=>{400===t.status?b.Z.error(t.detail[0]):b.Z.apiError(t),f.Z.dispatch(Ue.r$(e.post,s))}))}function Dt(e){const{post:t,user:s}=e;f.Z.dispatch(v.Vx({best_answer:t.id,best_answer_is_protected:t.is_protected,best_answer_marked_on:j()(),best_answer_marked_by:s.id,best_answer_marked_by_name:s.username,best_answer_marked_by_slug:s.slug})),jt(e,[{op:"replace",path:"best-answer",value:t.id},{op:"add",path:"acl",value:!0}],{best_answer:e.thread.best_answer,best_answer_is_protected:e.thread.best_answer_is_protected,best_answer_marked_on:e.thread.best_answer_marked_on,best_answer_marked_by:e.thread.best_answer_marked_by,best_answer_marked_by_name:e.thread.best_answer_marked_by_name,best_answer_marked_by_slug:e.thread.best_answer_marked_by_slug})}function jt(e,t,s){g.Z.patch(e.thread.api.index,t).then((e=>{e.best_answer_marked_on&&(e.best_answer_marked_on=j()(e.best_answer_marked_on)),f.Z.dispatch(v.Vx(e))}),(e=>{400===e.status?b.Z.error(e.detail[0]):b.Z.apiError(e),f.Z.dispatch(v.Vx(s))}))}var zt,Ut,Mt,Bt,qt,Ht,Ft=class extends c().Component{constructor(e){super(e),this.state={isReady:!1,error:null,likes:[]}}componentDidMount(){g.Z.get(this.props.post.api.likes).then((e=>{this.setState({isReady:!0,likes:e.map(Yt)})}),(e=>{this.setState({isReady:!0,error:e.detail})}))}render(){return this.state.error?(0,r.Z)(Vt,{className:"modal-message"},void 0,(0,r.Z)(V.Z,{message:this.state.error})):this.state.isReady?this.state.likes.length?(0,r.Z)(Vt,{className:"modal-sm",likes:this.state.likes},void 0,(0,r.Z)(Gt,{likes:this.state.likes})):(0,r.Z)(Vt,{className:"modal-message"},void 0,(0,r.Z)(V.Z,{message:gettext("No users have liked this post.")})):xt||(xt=(0,r.Z)(Vt,{className:"modal-sm"},void 0,(0,r.Z)(G.Z,{})))}};function Yt(e){return Object.assign({},e,{liked_on:j()(e.liked_on)})}function Vt(e){let{className:t,children:s,likes:a}=e,i=gettext("Post Likes");if(a){const e=a.length,t=ngettext("%(likes)s like","%(likes)s likes",e);i=interpolate(t,{likes:e},!0)}return(0,r.Z)("div",{className:"modal-dialog "+(t||""),role:"document"},void 0,(0,r.Z)("div",{className:"modal-content"},void 0,(0,r.Z)("div",{className:"modal-header"},void 0,(0,r.Z)("button",{"aria-label":pgettext("modal","Close"),className:"close","data-dismiss":"modal",type:"button"},void 0,yt||(yt=(0,r.Z)("span",{"aria-hidden":"true"},void 0,"×"))),(0,r.Z)("h4",{className:"modal-title"},void 0,i)),s))}function Gt(e){return(0,r.Z)("div",{className:"modal-body modal-post-likers"},void 0,(0,r.Z)("ul",{className:"media-list"},void 0,e.likes.map((e=>c().createElement($t,(0,p.Z)({key:e.id},e))))))}function $t(e){if(e.url){const t={id:e.liker_id,avatars:e.avatars};return(0,r.Z)("li",{className:"media"},void 0,(0,r.Z)("div",{className:"media-left"},void 0,(0,r.Z)("a",{className:"user-avatar",href:e.url},void 0,(0,r.Z)(L.ZP,{size:"50",user:t}))),(0,r.Z)("div",{className:"media-body"},void 0,(0,r.Z)("a",{className:"item-title",href:e.url},void 0,e.username)," ",(0,r.Z)(Wt,{likedOn:e.liked_on})))}return(0,r.Z)("li",{className:"media"},void 0,wt||(wt=(0,r.Z)("div",{className:"media-left"},void 0,(0,r.Z)("span",{className:"user-avatar"},void 0,(0,r.Z)(L.ZP,{size:"50"})))),(0,r.Z)("div",{className:"media-body"},void 0,(0,r.Z)("strong",{},void 0,e.username)," ",(0,r.Z)(Wt,{likedOn:e.liked_on})))}function Wt(e){return(0,r.Z)("span",{className:"text-muted",title:e.likedOn.format("LLL")},void 0,e.likedOn.fromNow())}function Qt(e){return function(e){return(!e.is_hidden||e.acl.can_see_hidden)&&(e.acl.can_reply||e.acl.can_edit||e.acl.can_see_likes&&(e.last_likes||[]).length||e.acl.can_like)}(e.post)?(0,r.Z)("div",{className:"post-footer"},void 0,c().createElement(Kt,e),c().createElement(Jt,e),c().createElement(Xt,e),c().createElement(es,(0,p.Z)({lastLikes:e.post.last_likes,likes:e.post.likes},e)),c().createElement(ts,(0,p.Z)({likes:e.post.likes},e)),c().createElement(as,e),c().createElement(is,e)):null}class Kt extends c().Component{constructor(){super(...arguments),(0,l.Z)(this,"onClick",(()=>{Dt(this.props)}))}render(){const{post:e,thread:t}=this.props;return t.acl.can_mark_best_answer&&e.acl.can_mark_as_best_answer?t.best_answer&&!t.acl.can_change_best_answer?null:(0,r.Z)("button",{className:"hidden-xs btn btn-default btn-sm pull-left",disabled:this.props.post.isBusy||e.id===t.best_answer,onClick:this.onClick,type:"button"},void 0,zt||(zt=(0,r.Z)("span",{className:"material-icon"},void 0,"check_box")),gettext("Best answer")):null}}class Jt extends c().Component{constructor(){super(...arguments),(0,l.Z)(this,"onClick",(()=>{Dt(this.props)}))}render(){const{post:e,thread:t}=this.props;return t.acl.can_mark_best_answer&&e.acl.can_mark_as_best_answer?t.best_answer&&!t.acl.can_change_best_answer?null:(0,r.Z)("button",{className:"visible-xs-inline-block btn btn-default btn-sm pull-left",disabled:this.props.post.isBusy||e.id===t.best_answer,onClick:this.onClick,type:"button"},void 0,Ut||(Ut=(0,r.Z)("span",{className:"material-icon"},void 0,"check_box"))):null}}class Xt extends c().Component{constructor(){super(...arguments),(0,l.Z)(this,"onClick",(()=>{this.props.post.is_liked?function(e){f.Z.dispatch(Ue.r$(e.post,{is_liked:!1,likes:e.post.likes-1,last_likes:e.post.last_likes.filter((t=>!t.id||t.id!==e.user.id))}));const t={is_liked:e.post.is_liked,likes:e.post.likes,last_likes:e.post.last_likes};It(e,[{op:"replace",path:"is-liked",value:!1}],t)}(this.props):function(e){const t=e.post.last_likes||[],s=[e.user].concat(t),a=s.length>3?s.slice(0,-1):s;f.Z.dispatch(Ue.r$(e.post,{is_liked:!0,likes:e.post.likes+1,last_likes:a})),It(e,[{op:"replace",path:"is-liked",value:!0}],{is_liked:e.post.is_liked,likes:e.post.likes,last_likes:e.post.last_likes})}(this.props)}))}render(){if(!this.props.post.acl.can_like)return null;let e="btn btn-default btn-sm pull-left";return this.props.post.is_liked&&(e="btn btn-success btn-sm pull-left"),(0,r.Z)("button",{className:e,disabled:this.props.post.isBusy,onClick:this.onClick,type:"button"},void 0,this.props.post.is_liked?gettext("Liked"):gettext("Like"))}}class es extends c().Component{constructor(){super(...arguments),(0,l.Z)(this,"onClick",(()=>{Z.Z.show((0,r.Z)(Ft,{post:this.props.post}))}))}render(){const e=(this.props.post.last_likes||[]).length>0;return this.props.post.acl.can_see_likes&&e?2===this.props.post.acl.can_see_likes?(0,r.Z)("button",{className:"btn btn-link btn-sm pull-left hidden-xs",onClick:this.onClick,type:"button"},void 0,ss(this.props.likes,this.props.lastLikes)):(0,r.Z)("p",{className:"pull-left hidden-xs"},void 0,ss(this.props.likes,this.props.lastLikes)):null}}class ts extends es{render(){const e=(this.props.post.last_likes||[]).length>0;return this.props.post.acl.can_see_likes&&e?2===this.props.post.acl.can_see_likes?(0,r.Z)("button",{className:"btn btn-link btn-sm likes-compact pull-left visible-xs-block",onClick:this.onClick,type:"button"},void 0,Mt||(Mt=(0,r.Z)("span",{className:"material-icon"},void 0,"favorite")),this.props.likes):(0,r.Z)("p",{className:"likes-compact pull-left visible-xs-block"},void 0,Bt||(Bt=(0,r.Z)("span",{className:"material-icon"},void 0,"favorite")),this.props.likes):null}}function ss(e,t){const s=t.slice(0,3).map((e=>e.username));if(1==s.length)return interpolate(gettext("%(user)s likes this."),{user:s[0]},!0);const a=e-s.length,i=s.slice(0,-1).join(", "),o=s.slice(-1)[0],n=interpolate(gettext("%(users)s and %(last_user)s"),{users:i,last_user:o},!0);if(0===a)return interpolate(gettext("%(users)s like this."),{users:n},!0);const r=ngettext("%(users)s and %(likes)s other user like this.","%(users)s and %(likes)s other users like this.",a);return interpolate(r,{users:s.join(", "),likes:a},!0)}class as extends c().Component{constructor(){super(...arguments),(0,l.Z)(this,"onClick",(()=>{ae.Z.open({mode:"REPLY",thread:this.props.thread,config:this.props.thread.api.editor,submit:this.props.thread.api.posts.index,context:{reply:this.props.post.id}})}))}render(){return this.props.post.acl.can_reply?(0,r.Z)("button",{className:"btn btn-primary btn-sm pull-right",type:"button",onClick:this.onClick},void 0,gettext("Reply")):null}}class is extends c().Component{constructor(){super(...arguments),(0,l.Z)(this,"onClick",(()=>{ae.Z.open({mode:"EDIT",thread:this.props.thread,post:this.props.post,config:this.props.post.api.editor,submit:this.props.post.api.index})}))}render(){return this.props.post.acl.can_edit?(0,r.Z)("button",{className:"hidden-xs btn btn-default btn-sm pull-right",type:"button",onClick:this.onClick},void 0,gettext("Edit")):null}}var os=class extends u.Z{constructor(e){super(e),(0,l.Z)(this,"onUrlChange",(e=>{this.changeValue("url",e.target.value)})),this.state={isLoading:!1,url:"",validators:{url:[]},errors:{}}}clean(){return!!this.state.url.trim().length||(b.Z.error(gettext("You have to enter link to the other thread.")),!1)}send(){return g.Z.post(this.props.thread.api.posts.move,{new_thread:this.state.url,posts:[this.props.post.id]})}handleSuccess(e){f.Z.dispatch(Ue.r$(this.props.post,{isDeleted:!0})),Z.Z.hide(),b.Z.success(gettext("Selected post was moved to the other thread."))}handleError(e){400===e.status?b.Z.error(e.detail):b.Z.apiError(e)}render(){return(0,r.Z)("div",{className:"modal-dialog",role:"document"},void 0,(0,r.Z)("form",{onSubmit:this.handleSubmit},void 0,(0,r.Z)("div",{className:"modal-content"},void 0,qt||(qt=(0,r.Z)(ns,{})),(0,r.Z)("div",{className:"modal-body"},void 0,(0,r.Z)(h.Z,{for:"id_url",label:gettext("Link to thread you want to move post to")},void 0,(0,r.Z)("input",{className:"form-control",disabled:this.state.isLoading,id:"id_url",onChange:this.onUrlChange,value:this.state.url}))),(0,r.Z)("div",{className:"modal-footer"},void 0,(0,r.Z)("button",{className:"btn btn-primary",disabled:this.state.isLoading},void 0,gettext("Move post"))))))}};function ns(e){return(0,r.Z)("div",{className:"modal-header"},void 0,(0,r.Z)("button",{"aria-label":pgettext("modal","Close"),className:"close","data-dismiss":"modal",type:"button"},void 0,Ht||(Ht=(0,r.Z)("span",{"aria-hidden":"true"},void 0,"×"))),(0,r.Z)("h4",{className:"modal-title"},void 0,gettext("Move post")))}function rs(e){return(0,r.Z)("div",{className:"modal-body post-changelog-diff"},void 0,(0,r.Z)("ul",{className:"list-unstyled"},void 0,e.diff.map(((e,t)=>(0,r.Z)(ls,{item:e},t)))))}function ls(e){return"?"===e.item[0]?null:(0,r.Z)("li",{className:ds(e.item)},void 0,e.item.substr(2))}function ds(e){let t="diff-item";return"-"===e[0]?t+=" diff-item-sub":"+"===e[0]&&(t+=" diff-item-add"),t}var cs,ps,us,hs,ms,vs=class extends c().Component{constructor(){super(...arguments),(0,l.Z)(this,"onClick",(()=>{this.props.revertEdit(this.props.edit.id)}))}render(){return this.props.canRevert?(0,r.Z)("div",{className:"modal-footer visible-xs-block"},void 0,(0,r.Z)(Ee.Z,{className:"btn-default btn-sm btn-block",disabled:this.props.disabled,onClick:this.onClick,title:gettext("Revert post to state from before this edit.")},void 0,gettext("Revert"))):null}},gs=class extends c().Component{constructor(){super(...arguments),(0,l.Z)(this,"goLast",(()=>{this.props.goToEdit()})),(0,l.Z)(this,"goForward",(()=>{this.props.goToEdit(this.props.edit.next)})),(0,l.Z)(this,"goBack",(()=>{this.props.goToEdit(this.props.edit.previous)})),(0,l.Z)(this,"revertEdit",(()=>{this.props.revertEdit(this.props.edit.id)}))}render(){return(0,r.Z)("div",{className:"modal-toolbar post-changelog-toolbar"},void 0,(0,r.Z)("div",{className:"row"},void 0,(0,r.Z)("div",{className:"col-xs-12 col-sm-4"},void 0,(0,r.Z)("div",{className:"row"},void 0,(0,r.Z)("div",{className:"col-xs-4"},void 0,(0,r.Z)(Zs,{disabled:this.props.disabled,edit:this.props.edit,onClick:this.goBack})),(0,r.Z)("div",{className:"col-xs-4"},void 0,(0,r.Z)(bs,{disabled:this.props.disabled,edit:this.props.edit,onClick:this.goForward})),(0,r.Z)("div",{className:"col-xs-4"},void 0,(0,r.Z)(fs,{disabled:this.props.disabled,edit:this.props.edit,onClick:this.goLast})))),(0,r.Z)("div",{className:"col-xs-12 col-sm-5 xs-margin-top-half post-change-label"},void 0,(0,r.Z)(Ns,{edit:this.props.edit})),(0,r.Z)(_s,{canRevert:this.props.canRevert,disabled:this.props.disabled,onClick:this.revertEdit})))}};function Zs(e){return(0,r.Z)(Ee.Z,{className:"btn-default btn-block btn-icon btn-sm",disabled:e.disabled||!e.edit.previous,onClick:e.onClick,title:gettext("See previous change")},void 0,cs||(cs=(0,r.Z)("span",{className:"material-icon"},void 0,"chevron_left")))}function bs(e){return(0,r.Z)(Ee.Z,{className:"btn-default btn-block btn-icon btn-sm",disabled:e.disabled||!e.edit.next,onClick:e.onClick,title:gettext("See next change")},void 0,ps||(ps=(0,r.Z)("span",{className:"material-icon"},void 0,"chevron_right")))}function fs(e){return(0,r.Z)(Ee.Z,{className:"btn-default btn-block btn-icon btn-sm",disabled:e.disabled||!e.edit.next,onClick:e.onClick,title:gettext("See previous change")},void 0,us||(us=(0,r.Z)("span",{className:"material-icon"},void 0,"last_page")))}function _s(e){return e.canRevert?(0,r.Z)("div",{className:"col-sm-3 hidden-xs"},void 0,(0,r.Z)(Ee.Z,{className:"btn-default btn-sm btn-block",disabled:e.disabled,onClick:e.onClick,title:gettext("Revert post to state from before this edit.")},void 0,gettext("Revert"))):null}function Ns(e){let t=null;t=e.edit.url.editor?interpolate('<a href="%(url)s" class="item-title">%(user)s</a>',{url:(0,ce.Z)(e.edit.url.editor),user:(0,ce.Z)(e.edit.editor_name)},!0):interpolate('<span class="item-title">%(user)s</span>',{user:(0,ce.Z)(e.edit.editor_name)},!0);const s=interpolate('<abbr title="%(absolute)s">%(relative)s</abbr>',{absolute:(0,ce.Z)(e.edit.edited_on.format("LLL")),relative:(0,ce.Z)(e.edit.edited_on.fromNow())},!0),a=interpolate((0,ce.Z)(gettext("By %(edited_by)s %(edited_on)s.")),{edited_by:t,edited_on:s},!0);return(0,r.Z)("p",{dangerouslySetInnerHTML:{__html:a}})}function xs(e){return Object.assign({},e,{edited_on:j()(e.edited_on)})}var ys=class extends c().Component{constructor(e){var t;super(e),t=this,(0,l.Z)(this,"goToEdit",(function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;t.setState({isBusy:!0});let s=t.props.post.api.edits;null!==e&&(s+="?edit="+e),g.Z.get(s).then((e=>{t.setState({isReady:!0,isBusy:!1,edit:xs(e)})}),(e=>{t.setState({isReady:!0,isBusy:!1,error:e.detail})}))})),(0,l.Z)(this,"revertEdit",(e=>{if(this.state.isBusy)return;if(!window.confirm(gettext("Are you sure you with to revert this post to the state from before this edit?")))return;this.setState({isBusy:!0});const t=this.props.post.api.edits+"?edit="+e;g.Z.post(t).then((e=>{const t=Ue.ZB(e);f.Z.dispatch(Ue.r$(e,t)),b.Z.success(gettext("Post has been reverted to previous state.")),Z.Z.hide()}),(e=>{b.Z.apiError(e),this.setState({isBusy:!1})}))})),this.state={isReady:!1,isBusy:!0,canRevert:e.post.acl.can_edit,error:null,edit:null}}componentDidMount(){this.goToEdit()}render(){return this.state.error?(0,r.Z)(ws,{className:"modal-dialog modal-message"},void 0,(0,r.Z)(V.Z,{message:this.state.error})):this.state.isReady?(0,r.Z)(ws,{},void 0,(0,r.Z)(gs,{canRevert:this.state.canRevert,disabled:this.state.isBusy,edit:this.state.edit,goToEdit:this.goToEdit,revertEdit:this.revertEdit}),(0,r.Z)(rs,{diff:this.state.edit.diff}),(0,r.Z)(vs,{canRevert:this.state.canRevert,disabled:this.state.isBusy,edit:this.state.edit,revertEdit:this.revertEdit})):hs||(hs=(0,r.Z)(ws,{},void 0,(0,r.Z)(G.Z,{})))}};function ws(e){return(0,r.Z)("div",{className:e.className||"modal-dialog",role:"document"},void 0,(0,r.Z)("div",{className:"modal-content"},void 0,(0,r.Z)("div",{className:"modal-header"},void 0,(0,r.Z)("button",{"aria-label":pgettext("modal","Close"),className:"close","data-dismiss":"modal",type:"button"},void 0,ms||(ms=(0,r.Z)("span",{"aria-hidden":"true"},void 0,"×"))),(0,r.Z)("h4",{className:"modal-title"},void 0,gettext("Post edits history"))),e.children))}var ks,Cs,Ss,Es,Ls,Ts,Ps,Os,Rs,As,Is,Ds,js,zs,Us,Ms,Bs,qs,Hs,Fs,Ys=s(57026),Vs=s(60471),Gs=s(55210);function $s(e){return c().createElement(Ws,(0,p.Z)({},e,{Form:Qs}))}class Ws extends c().Component{constructor(e){super(e),this.state={isLoaded:!1,isError:!1,categories:[]}}componentDidMount(){g.Z.get(misago.get("THREAD_EDITOR_API")).then((e=>{const t=e.map((e=>Object.assign(e,{disabled:!1===e.post,label:e.name,value:e.id,post:e.post})));this.setState({isLoaded:!0,categories:t})}),(e=>{this.setState({isError:e.detail})}))}render(){return this.state.isError?(0,r.Z)(Js,{message:this.state.isError}):this.state.isLoaded?c().createElement(Qs,(0,p.Z)({},this.props,{categories:this.state.categories})):ks||(ks=(0,r.Z)(Ks,{}))}}class Qs extends u.Z{constructor(e){super(e),(0,l.Z)(this,"onCategoryChange",(e=>{const t=e.target.value,s={category:t};this.acl[t].can_pin_threads<s.weight&&(s.weight=0),this.acl[t].can_hide_threads||(s.is_hidden=0),this.acl[t].can_close_threads||(s.is_closed=!1),this.setState(s)})),this.state={isLoading:!1,title:"",category:null,categories:e.categories,weight:0,is_hidden:0,is_closed:!1,validators:{title:[Gs.C1()]},errors:{}},this.isHiddenChoices=[{value:0,icon:"visibility",label:gettext("No")},{value:1,icon:"visibility_off",label:gettext("Yes")}],this.isClosedChoices=[{value:!1,icon:"lock_outline",label:gettext("No")},{value:!0,icon:"lock",label:gettext("Yes")}],this.acl={},this.props.categories.forEach((e=>{e.post&&(this.state.category||(this.state.category=e.id),this.acl[e.id]={can_pin_threads:e.post.pin,can_close_threads:e.post.close,can_hide_threads:e.post.hide})}))}clean(){return!!this.isValid()||(b.Z.error(gettext("Form contains errors.")),this.setState({errors:this.validate()}),!1)}send(){return g.Z.post(this.props.thread.api.posts.split,{title:this.state.title,category:this.state.category,weight:this.state.weight,is_hidden:this.state.is_hidden,is_closed:this.state.is_closed,posts:[this.props.post.id]})}handleSuccess(e){f.Z.dispatch(Ue.r$(this.props.post,{isDeleted:!0})),Z.Z.hide(),b.Z.success(gettext("Selected post was split into new thread."))}handleError(e){400===e.status?(this.setState({errors:Object.assign({},this.state.errors,e)}),b.Z.error(gettext("Form contains errors."))):b.Z.apiError(e)}getWeightChoices(){const e=[{value:0,icon:"remove",label:gettext("Not pinned")},{value:1,icon:"bookmark_border",label:gettext("Pinned locally")}];return 2==this.acl[this.state.category].can_pin_threads&&e.push({value:2,icon:"bookmark",label:gettext("Pinned globally")}),e}renderWeightField(){return this.acl[this.state.category].can_pin_threads?(0,r.Z)(h.Z,{label:gettext("Thread weight"),for:"id_weight",labelClass:"col-sm-4",controlClass:"col-sm-8"},void 0,(0,r.Z)(Vs.Z,{id:"id_weight",onChange:this.bindInput("weight"),value:this.state.weight,choices:this.getWeightChoices()})):null}renderHiddenField(){return this.acl[this.state.category].can_hide_threads?(0,r.Z)(h.Z,{label:gettext("Hide thread"),for:"id_is_hidden",labelClass:"col-sm-4",controlClass:"col-sm-8"},void 0,(0,r.Z)(Vs.Z,{id:"id_is_closed",onChange:this.bindInput("is_hidden"),value:this.state.is_hidden,choices:this.isHiddenChoices})):null}renderClosedField(){return this.acl[this.state.category].can_close_threads?(0,r.Z)(h.Z,{label:gettext("Close thread"),for:"id_is_closed",labelClass:"col-sm-4",controlClass:"col-sm-8"},void 0,(0,r.Z)(Vs.Z,{id:"id_is_closed",onChange:this.bindInput("is_closed"),value:this.state.is_closed,choices:this.isClosedChoices})):null}render(){return(0,r.Z)(Xs,{className:"modal-dialog"},void 0,(0,r.Z)("form",{onSubmit:this.handleSubmit},void 0,(0,r.Z)("div",{className:"modal-body"},void 0,(0,r.Z)(h.Z,{label:gettext("Thread title"),for:"id_title",labelClass:"col-sm-4",controlClass:"col-sm-8",validation:this.state.errors.title},void 0,(0,r.Z)("input",{id:"id_title",className:"form-control",type:"text",onChange:this.bindInput("title"),value:this.state.title})),Cs||(Cs=(0,r.Z)("div",{className:"clearfix"})),(0,r.Z)(h.Z,{label:gettext("Category"),for:"id_category",labelClass:"col-sm-4",controlClass:"col-sm-8",validation:this.state.errors.category},void 0,(0,r.Z)(Ys.Z,{id:"id_category",onChange:this.onCategoryChange,value:this.state.category,choices:this.state.categories})),Ss||(Ss=(0,r.Z)("div",{className:"clearfix"})),this.renderWeightField(),this.renderHiddenField(),this.renderClosedField()),(0,r.Z)("div",{className:"modal-footer"},void 0,(0,r.Z)(Ee.Z,{className:"btn-primary",loading:this.state.isLoading},void 0,gettext("Split post")))))}}function Ks(){return Es||(Es=(0,r.Z)(Xs,{className:"modal-dialog"},void 0,(0,r.Z)(G.Z,{})))}function Js(e){return(0,r.Z)(Xs,{className:"modal-dialog modal-message"},void 0,Ls||(Ls=(0,r.Z)("div",{className:"message-icon"},void 0,(0,r.Z)("span",{className:"material-icon"},void 0,"info_outline"))),(0,r.Z)("div",{className:"message-body"},void 0,(0,r.Z)("p",{className:"lead"},void 0,gettext("You can't move this post at the moment.")),(0,r.Z)("p",{},void 0,e.message)))}function Xs(e){return(0,r.Z)("div",{className:e.className,role:"document"},void 0,(0,r.Z)("div",{className:"modal-content"},void 0,(0,r.Z)("div",{className:"modal-header"},void 0,(0,r.Z)("button",{"aria-label":pgettext("modal","Close"),className:"close","data-dismiss":"modal",type:"button"},void 0,Ts||(Ts=(0,r.Z)("span",{"aria-hidden":"true"},void 0,"×"))),(0,r.Z)("h4",{className:"modal-title"},void 0,gettext("Split post into new thread"))),e.children))}function ea(e){return(0,r.Z)("ul",{className:"dropdown-menu dropdown-menu-right stick-to-bottom"},void 0,c().createElement(ta,e),c().createElement(sa,e),c().createElement(aa,e),c().createElement(ia,e),c().createElement(oa,e),c().createElement(na,e),c().createElement(ra,e),c().createElement(la,e),c().createElement(da,e),c().createElement(ca,e),c().createElement(pa,e),c().createElement(ua,e),c().createElement(ha,e))}class ta extends c().Component{constructor(){super(...arguments),(0,l.Z)(this,"onClick",(()=>{let e=window.location.protocol+"//";e+=window.location.host,e+=this.props.post.url.index,prompt(gettext("Permament link to this post:"),e)}))}render(){return(0,r.Z)("li",{},void 0,(0,r.Z)("button",{className:"btn btn-link",onClick:this.onClick,type:"button"},void 0,Ps||(Ps=(0,r.Z)("span",{className:"material-icon"},void 0,"link")),gettext("Permament link")))}}class sa extends c().Component{constructor(){super(...arguments),(0,l.Z)(this,"onClick",(()=>{ae.Z.open({mode:"EDIT",thread:this.props.thread,post:this.props.post,config:this.props.post.api.editor,submit:this.props.post.api.index})}))}render(){return this.props.post.acl.can_edit?(0,r.Z)("li",{},void 0,(0,r.Z)("button",{className:"btn btn-link",onClick:this.onClick,type:"button"},void 0,Os||(Os=(0,r.Z)("span",{className:"material-icon"},void 0,"edit")),gettext("Edit"))):null}}class aa extends c().Component{constructor(){super(...arguments),(0,l.Z)(this,"onClick",(()=>{Dt(this.props)}))}render(){const{post:e,thread:t}=this.props;return t.acl.can_mark_best_answer&&e.acl.can_mark_as_best_answer?e.id===t.best_answer||t.best_answer&&!t.acl.can_change_best_answer?null:(0,r.Z)("li",{},void 0,(0,r.Z)("button",{className:"btn btn-link",onClick:this.onClick,type:"button"},void 0,Rs||(Rs=(0,r.Z)("span",{className:"material-icon"},void 0,"check_box")),gettext("Mark as best answer"))):null}}class ia extends c().Component{constructor(){super(...arguments),(0,l.Z)(this,"onClick",(()=>{!function(e){const{post:t}=e;f.Z.dispatch(v.Vx({best_answer:null,best_answer_is_protected:!1,best_answer_marked_on:null,best_answer_marked_by:null,best_answer_marked_by_name:null,best_answer_marked_by_slug:null})),jt(e,[{op:"remove",path:"best-answer",value:t.id},{op:"add",path:"acl",value:!0}],{best_answer:e.thread.best_answer,best_answer_is_protected:e.thread.best_answer_is_protected,best_answer_marked_on:e.thread.best_answer_marked_on,best_answer_marked_by:e.thread.best_answer_marked_by,best_answer_marked_by_name:e.thread.best_answer_marked_by_name,best_answer_marked_by_slug:e.thread.best_answer_marked_by_slug})}(this.props)}))}render(){const{post:e,thread:t}=this.props;return e.id!==t.best_answer?null:t.acl.can_unmark_best_answer?(0,r.Z)("li",{},void 0,(0,r.Z)("button",{className:"btn btn-link",onClick:this.onClick,type:"button"},void 0,As||(As=(0,r.Z)("span",{className:"material-icon"},void 0,"check_box_outline_blank")),gettext("Unmark best answer"))):null}}class oa extends c().Component{constructor(){super(...arguments),(0,l.Z)(this,"onClick",(()=>{Z.Z.show((0,r.Z)(ys,{post:this.props.post}))}))}render(){const e=this.props.post.is_hidden&&!this.props.post.acl.can_see_hidden,t=0===this.props.post.edits;if(e||t)return null;const s=ngettext("This post was edited %(edits)s time.","This post was edited %(edits)s times.",this.props.post.edits);return interpolate(s,{edits:this.props.post.edits},!0),(0,r.Z)("li",{},void 0,(0,r.Z)("button",{className:"btn btn-link",onClick:this.onClick,type:"button"},void 0,Is||(Is=(0,r.Z)("span",{className:"material-icon"},void 0,"edit")),gettext("Changes history")))}}class na extends c().Component{constructor(){super(...arguments),(0,l.Z)(this,"onClick",(()=>{var e;e=this.props,f.Z.dispatch(Ue.r$(e.post,{is_unapproved:!1})),It(e,[{op:"replace",path:"is-unapproved",value:!1}],{is_unapproved:e.post.is_unapproved})}))}render(){return this.props.post.acl.can_approve&&this.props.post.is_unapproved?(0,r.Z)("li",{},void 0,(0,r.Z)("button",{className:"btn btn-link",onClick:this.onClick,type:"button"},void 0,Ds||(Ds=(0,r.Z)("span",{className:"material-icon"},void 0,"done")),gettext("Approve"))):null}}class ra extends c().Component{constructor(){super(...arguments),(0,l.Z)(this,"onClick",(()=>{Z.Z.show(c().createElement(os,this.props))}))}render(){return this.props.post.acl.can_move?(0,r.Z)("li",{},void 0,(0,r.Z)("button",{className:"btn btn-link",onClick:this.onClick,type:"button"},void 0,js||(js=(0,r.Z)("span",{className:"material-icon"},void 0,"arrow_forward")),gettext("Move"))):null}}class la extends c().Component{constructor(){super(...arguments),(0,l.Z)(this,"onClick",(()=>{Z.Z.show(c().createElement($s,this.props))}))}render(){return this.props.post.acl.can_move?(0,r.Z)("li",{},void 0,(0,r.Z)("button",{className:"btn btn-link",onClick:this.onClick,type:"button"},void 0,zs||(zs=(0,r.Z)("span",{className:"material-icon"},void 0,"call_split")),gettext("Split"))):null}}class da extends c().Component{constructor(){super(...arguments),(0,l.Z)(this,"onClick",(()=>{var e;e=this.props,f.Z.dispatch(Ue.r$(e.post,{is_protected:!0})),It(e,[{op:"replace",path:"is-protected",value:!0}],{is_protected:e.post.is_protected})}))}render(){return this.props.post.acl.can_protect?this.props.post.is_protected?null:(0,r.Z)("li",{},void 0,(0,r.Z)("button",{className:"btn btn-link",onClick:this.onClick,type:"button"},void 0,Us||(Us=(0,r.Z)("span",{className:"material-icon"},void 0,"lock_outline")),gettext("Protect"))):null}}class ca extends c().Component{constructor(){super(...arguments),(0,l.Z)(this,"onClick",(()=>{var e;e=this.props,f.Z.dispatch(Ue.r$(e.post,{is_protected:!1})),It(e,[{op:"replace",path:"is-protected",value:!1}],{is_protected:e.post.is_protected})}))}render(){return this.props.post.acl.can_protect&&this.props.post.is_protected?(0,r.Z)("li",{},void 0,(0,r.Z)("button",{className:"btn btn-link",onClick:this.onClick,type:"button"},void 0,Ms||(Ms=(0,r.Z)("span",{className:"material-icon"},void 0,"lock_open")),gettext("Remove protection"))):null}}class pa extends c().Component{constructor(){super(...arguments),(0,l.Z)(this,"onClick",(()=>{var e;e=this.props,f.Z.dispatch(Ue.r$(e.post,{is_hidden:!0,hidden_on:j()(),hidden_by_name:e.user.username,url:Object.assign(e.post.url,{hidden_by:e.user.url})})),It(e,[{op:"replace",path:"is-hidden",value:!0}],{is_hidden:e.post.is_hidden,hidden_on:e.post.hidden_on,hidden_by_name:e.post.hidden_by_name,url:e.post.url})}))}render(){const{post:e,thread:t}=this.props;return e.id===t.best_answer?null:e.acl.can_hide?e.is_hidden?null:(0,r.Z)("li",{},void 0,(0,r.Z)("button",{className:"btn btn-link",onClick:this.onClick,type:"button"},void 0,Bs||(Bs=(0,r.Z)("span",{className:"material-icon"},void 0,"visibility_off")),gettext("Hide"))):null}}class ua extends c().Component{constructor(){super(...arguments),(0,l.Z)(this,"onClick",(()=>{var e;e=this.props,f.Z.dispatch(Ue.r$(e.post,{is_hidden:!1})),It(e,[{op:"replace",path:"is-hidden",value:!1}],{is_hidden:e.post.is_hidden})}))}render(){return this.props.post.acl.can_unhide&&this.props.post.is_hidden?(0,r.Z)("li",{},void 0,(0,r.Z)("button",{className:"btn btn-link",onClick:this.onClick,type:"button"},void 0,qs||(qs=(0,r.Z)("span",{className:"material-icon"},void 0,"visibility")),gettext("Unhide"))):null}}class ha extends c().Component{constructor(){super(...arguments),(0,l.Z)(this,"onClick",(()=>{var e;e=this.props,window.confirm(gettext("Are you sure you want to delete this post? This action is not reversible!"))&&(f.Z.dispatch(Ue.r$(e.post,{isDeleted:!0})),g.Z.delete(e.post.api.index).then((()=>{b.Z.success(gettext("Post has been deleted."))}),(t=>{400===t.status?b.Z.error(t.detail):b.Z.apiError(t),f.Z.dispatch(Ue.r$(e.post,{isDeleted:!1}))})))}))}render(){const{post:e,thread:t}=this.props;return e.id===t.best_answer?null:e.acl.can_delete?(0,r.Z)("li",{},void 0,(0,r.Z)("button",{className:"btn btn-link",onClick:this.onClick,type:"button"},void 0,Hs||(Hs=(0,r.Z)("span",{className:"material-icon"},void 0,"clear")),gettext("Delete"))):null}}function ma(e){return(0,r.Z)("div",{className:"pull-right dropdown"},void 0,Fs||(Fs=(0,r.Z)("button",{"aria-expanded":"true","aria-haspopup":"true",className:"btn btn-default btn-icon dropdown-toggle","data-toggle":"dropdown",type:"button"},void 0,(0,r.Z)("span",{className:"material-icon"},void 0,"expand_more"))),c().createElement(ea,e))}var va,ga,Za,ba=s(21981),fa=class extends c().Component{constructor(){super(...arguments),(0,l.Z)(this,"onClick",(()=>{this.props.post.isSelected?f.Z.dispatch(ba._H(this.props.post)):f.Z.dispatch(ba.Ys(this.props.post))}))}render(){return this.props.thread.acl.can_merge_posts||(e=this.props.post.acl).can_approve||e.can_hide||e.can_protect||e.can_unhide||e.can_delete||e.can_move?(0,r.Z)("div",{className:"pull-right"},void 0,(0,r.Z)("button",{className:"btn btn-default btn-icon",onClick:this.onClick,type:"button"},void 0,(0,r.Z)("span",{className:"material-icon"},void 0,this.props.post.isSelected?"check_box":"check_box_outline_blank"))):null;var e}},_a=s(24678);function Na(e){return(0,r.Z)("div",{className:"post-heading"},void 0,c().createElement(xa,e),c().createElement(ya,e),c().createElement(wa,e),c().createElement(ka,e),c().createElement(Ca,e),c().createElement(Sa,e),c().createElement(Ea,e),c().createElement(fa,e),c().createElement(ma,e))}function xa(e){return e.post.is_read?null:(0,r.Z)("span",{className:"label label-unread hidden-xs"},void 0,gettext("New post"))}function ya(e){return e.post.is_read?null:(0,r.Z)("span",{className:"label label-unread visible-xs-inline-block"},void 0,gettext("New"))}function wa(e){const t=interpolate(gettext("posted %(posted_on)s"),{posted_on:e.post.posted_on.format("LL, LT")},!0);return(0,r.Z)("a",{href:e.post.url.index,className:"btn btn-link posted-on hidden-xs",title:t},void 0,e.post.posted_on.fromNow())}function ka(e){return(0,r.Z)("a",{href:e.post.url.index,className:"btn btn-link posted-on visible-xs-inline-block"},void 0,e.post.posted_on.fromNow())}class Ca extends c().Component{constructor(){super(...arguments),(0,l.Z)(this,"onClick",(()=>{Z.Z.show((0,r.Z)(ys,{post:this.props.post}))}))}render(){const e=this.props.post.is_hidden&&!this.props.post.acl.can_see_hidden,t=0===this.props.post.edits;if(e||t)return null;const s=ngettext("This post was edited %(edits)s time.","This post was edited %(edits)s times.",this.props.post.edits),a=interpolate(s,{edits:this.props.post.edits},!0),i=ngettext("edited %(edits)s time","edited %(edits)s times",this.props.post.edits);return(0,r.Z)("button",{className:"btn btn-link btn-see-edits hidden-xs",onClick:this.onClick,title:a,type:"button"},void 0,interpolate(i,{edits:this.props.post.edits},!0))}}class Sa extends Ca{render(){const e=this.props.post.is_hidden&&!this.props.post.acl.can_see_hidden,t=0===this.props.post.edits;if(e||t)return null;const s=ngettext("%(edits)s edit","%(edits)s edits",this.props.post.edits);return(0,r.Z)("button",{className:"btn btn-link btn-see-edits visible-xs-inline-block",onClick:this.onClick,type:"button"},void 0,interpolate(s,{edits:this.props.post.edits},!0))}}function Ea(e){const t=e.post.poster&&e.post.poster.id===e.user.id,s=e.post.acl.can_protect;return e.user.id&&e.post.is_protected&&(t||s)?(0,r.Z)("span",{className:"label label-protected hidden-xs",title:gettext("This post is protected and may not be edited.")},void 0,va||(va=(0,r.Z)("span",{className:"material-icon"},void 0,"lock_outline")),gettext("protected")):null}function La(e){let{post:t,thread:s}=e;return(0,r.Z)("div",{className:"post-side post-side-anonymous"},void 0,(0,r.Z)(fa,{post:t,thread:s}),(0,r.Z)(ma,{post:t,thread:s}),(0,r.Z)("div",{className:"media"},void 0,ga||(ga=(0,r.Z)("div",{className:"media-left"},void 0,(0,r.Z)("span",{},void 0,(0,r.Z)(L.ZP,{className:"poster-avatar",size:100})))),(0,r.Z)("div",{className:"media-body"},void 0,(0,r.Z)("span",{className:"media-heading item-title"},void 0,t.poster_name),(0,r.Z)("span",{className:"user-title user-title-anonymous"},void 0,gettext("Removed user")))))}function Ta(e){let{title:t,rank:s}=e;return s.is_tab||!!t||!!s.title}function Pa(e){let{poster:t}=e;const s=ngettext("%(posts)s post","%(posts)s posts",t.posts);let a="user-postcount";return Ta(t)&&(a+=" hidden-xs hidden-sm"),(0,r.Z)("span",{className:a},void 0,interpolate(s,{posts:t.posts},!0))}function Oa(e){let{poster:t}=e,s="hidden-xs";return Ta(t)&&(s+=" hidden-sm"),(0,r.Z)("span",{className:s},void 0,(0,r.Z)(_a.ZP,{status:t.status},void 0,(0,r.Z)(_a.pg,{status:t.status,user:t})))}function Ra(e){let{rank:t,title:s}=e,a=s||t.title;if(!a&&t.is_tab&&(a=t.name),!a)return null;let i="user-title";return t.css_class&&(i+=" user-title-"+t.css_class),t.is_tab?(0,r.Z)("div",{className:i},void 0,(0,r.Z)("a",{href:t.url},void 0,a)):(0,r.Z)("div",{className:i},void 0,a)}function Aa(e){let{post:t,thread:s}=e;const{poster:a}=t;return(0,r.Z)("div",{className:"post-side post-side-registered"},void 0,(0,r.Z)(fa,{post:t,thread:s}),(0,r.Z)(ma,{post:t,thread:s}),(0,r.Z)("div",{className:"media"},void 0,(0,r.Z)("div",{className:"media-left"},void 0,(0,r.Z)("a",{href:a.url},void 0,(0,r.Z)(L.ZP,{className:"poster-avatar",size:100,user:a}))),(0,r.Z)("div",{className:"media-body"},void 0,(0,r.Z)("div",{className:"media-heading"},void 0,(0,r.Z)("a",{className:"item-title",href:a.url},void 0,a.username),(0,r.Z)(_a.ZP,{status:a.status},void 0,(0,r.Z)(_a.Jj,{status:a.status}))),(0,r.Z)(Ra,{rank:a.rank,title:a.title}),(0,r.Z)(Oa,{poster:a}),(0,r.Z)(Pa,{poster:a}))))}function Ia(e){return e.post.poster?c().createElement(Aa,e):c().createElement(La,e)}function Da(e){let t="post";return e.post.isDeleted?t="hide":e.post.is_hidden&&!e.post.acl.can_see_hidden&&(t="post post-hidden"),e.post.poster&&e.post.poster.rank.css_class&&(t+=" post-"+e.post.poster.rank.css_class),e.post.is_read||(t+=" post-new"),(0,r.Z)("li",{id:"post-"+e.post.id,className:t},void 0,(0,r.Z)("div",{className:"panel panel-default panel-post"},void 0,(0,r.Z)("div",{className:"panel-body"},void 0,c().createElement(Ia,e),(0,r.Z)("div",{className:"panel-content"},void 0,c().createElement(Na,e),c().createElement(Tt,e),c().createElement(Ot,e),c().createElement(Rt,e),c().createElement(Pt,e),c().createElement(Ct,e),c().createElement(gt,e),c().createElement(Qt,e)))))}var ja,za=()=>(0,r.Z)("li",{className:"post"},void 0,(0,r.Z)("div",{className:"panel panel-default panel-post"},void 0,(0,r.Z)("div",{className:"panel-body"},void 0,(0,r.Z)("div",{className:"post-side post-side-registered"},void 0,(0,r.Z)("div",{className:"media"},void 0,Za||(Za=(0,r.Z)("div",{className:"media-left"},void 0,(0,r.Z)("span",{},void 0,(0,r.Z)(L.ZP,{className:"poster-avatar",size:"100"})))),(0,r.Z)("div",{className:"media-body"},void 0,(0,r.Z)("span",{className:"media-heading item-title"},void 0,(0,r.Z)("span",{className:"ui-preview-text",style:{width:"80px"}},void 0," ")),(0,r.Z)("span",{className:"user-title user-title-anonymous"},void 0,(0,r.Z)("span",{className:"ui-preview-text",style:{width:"60px"}},void 0," "))))),(0,r.Z)("div",{className:"panel-content"},void 0,(0,r.Z)("div",{className:"post-body"},void 0,(0,r.Z)("article",{className:"misago-markup"},void 0,(0,r.Z)("p",{className:"ui-preview-text",style:{width:"100%"}},void 0," "),(0,r.Z)("p",{className:"ui-preview-text",style:{width:"70%"}},void 0," "),(0,r.Z)("p",{className:"ui-preview-text hidden-xs hidden-sm",style:{width:"85%"}},void 0," ")))))));function Ua(e){return e.posts.isLoaded?(0,r.Z)("ul",{className:"posts-list ui-ready"},void 0,e.posts.results.map((t=>c().createElement(Ma,(0,p.Z)({key:t.id,post:t},e))))):ja||(ja=(0,r.Z)("ul",{className:"posts-list ui-preview"},void 0,(0,r.Z)(za,{})))}function Ma(e){return e.post.is_event?c().createElement(lt,e):c().createElement(Da,e)}var Ba,qa,Ha,Fa=s(55547),Ya=s(53328),Va=s(78107),Ga=s(59131),$a=s(98936),Wa=s(50366),Qa=s(16768),Ka=e=>{let{thread:t}=e;return(0,r.Z)("div",{className:"thread-user-card"},void 0,(0,r.Z)("div",{className:"thread-user-card-media"},void 0,t.starter?(0,r.Z)("a",{href:t.url.starter},void 0,(0,r.Z)(L.ZP,{size:40,user:t.starter})):Ba||(Ba=(0,r.Z)(L.ZP,{size:40}))),(0,r.Z)("div",{className:"thread-user-card-body"},void 0,(0,r.Z)("div",{className:"thread-user-card-header"},void 0,t.starter?(0,r.Z)("a",{className:"item-title",href:t.url.starter,title:gettext("Thread author")},void 0,t.starter.username):(0,r.Z)("span",{className:"item-title",title:gettext("Thread author")},void 0,t.starter_name)),(0,r.Z)("div",{},void 0,(0,r.Z)("span",{className:"text-muted",title:interpolate(gettext("Started on: %(timestamp)s"),{timestamp:t.started_on.format("LLL")},!0)},void 0,t.started_on.fromNow()))))},Ja=s(99755),Xa=s(12891),ei=class extends u.Z{constructor(e){super(e),(0,l.Z)(this,"handleSuccess",(e=>{this.handleSuccessUnmounted(e),this.setState({isLoading:!0}),Z.Z.hide()})),(0,l.Z)(this,"handleSuccessUnmounted",(e=>{f.Z.dispatch(v.Ar()),f.Z.dispatch(v.Vx(e))})),(0,l.Z)(this,"handleError",(e=>{f.Z.dispatch(v.Ar()),400===e.status?b.Z.error(e.detail[0]):b.Z.apiError(e)})),(0,l.Z)(this,"onChange",(e=>{this.changeValue("title",e.target.value)})),this.state={isLoading:!1,title:e.thread.title,validators:{title:(0,Xa.jn)()},errors:{}}}clean(){if(!this.state.title.trim().length)return b.Z.error(gettext("You have to enter thread title.")),!1;const e=this.validate();return!e.title||(b.Z.error(e.title[0]),!1)}send(){return f.Z.dispatch(v.n6()),g.Z.patch(this.props.thread.api.index,[{op:"replace",path:"title",value:this.state.title}])}render(){return(0,r.Z)("div",{className:"modal-dialog modal-lg",role:"document"},void 0,(0,r.Z)("form",{onSubmit:this.handleSubmit},void 0,(0,r.Z)("div",{className:"modal-content"},void 0,qa||(qa=(0,r.Z)(ti,{})),(0,r.Z)("div",{className:"modal-body"},void 0,(0,r.Z)(h.Z,{for:"id_modal_title",label:gettext("Thread title")},void 0,(0,r.Z)("input",{className:"form-control",disabled:this.state.isLoading||this.props.thread.isBusy,id:"id_modal_title",onChange:this.onChange,value:this.state.title}))),(0,r.Z)("div",{className:"modal-footer"},void 0,(0,r.Z)("button",{className:"btn btn-default","data-dismiss":"modal",disabled:this.state.isLoading,type:"button"},void 0,gettext("Cancel")),(0,r.Z)("button",{className:"btn btn-primary",disabled:this.state.isLoading||this.props.thread.isBusy},void 0,gettext("Change title"))))))}};function ti(e){return(0,r.Z)("div",{className:"modal-header"},void 0,(0,r.Z)("button",{"aria-label":pgettext("modal","Close"),className:"close","data-dismiss":"modal",type:"button"},void 0,Ha||(Ha=(0,r.Z)("span",{"aria-hidden":"true"},void 0,"×"))),(0,r.Z)("h4",{className:"modal-title"},void 0,gettext("Change title")))}var si,ai,ii,oi,ni,ri,li,di,ci=s(52753),pi=class extends u.Z{constructor(e){super(e),(0,l.Z)(this,"handleSuccess",(e=>{this.handleSuccessUnmounted(e),this.setState({isLoading:!0})})),(0,l.Z)(this,"handleSuccessUnmounted",(e=>{b.Z.success(gettext("Thread has been merged with other one.")),window.location=e.url})),(0,l.Z)(this,"handleError",(e=>{f.Z.dispatch(v.Ar()),400===e.status?e.best_answers||e.polls?Z.Z.show((0,r.Z)(ci.ZP,{api:this.props.thread.api.merge,bestAnswers:e.best_answers,data:{other_thread:this.state.url},polls:e.polls,onError:this.handleError,onSuccess:this.handleSuccessUnmounted})):e.best_answer?b.Z.error(e.best_answer[0]):e.poll?b.Z.error(e.poll[0]):b.Z.error(e.detail):b.Z.apiError(e)})),(0,l.Z)(this,"onUrlChange",(e=>{this.changeValue("url",e.target.value)})),this.state={isLoading:!1,url:"",validators:{url:[]},errors:{}}}clean(){return!!this.state.url.trim().length||(b.Z.error(gettext("You have to enter link to the other thread.")),!1)}send(){return f.Z.dispatch(v.n6()),g.Z.post(this.props.thread.api.merge,{other_thread:this.state.url})}render(){return(0,r.Z)("div",{className:"modal-dialog",role:"document"},void 0,(0,r.Z)("form",{onSubmit:this.handleSubmit},void 0,(0,r.Z)("div",{className:"modal-content"},void 0,si||(si=(0,r.Z)(ui,{})),(0,r.Z)("div",{className:"modal-body"},void 0,(0,r.Z)(h.Z,{for:"id_url",label:gettext("Link to thread you want to merge with"),help_text:gettext("Merge will delete current thread and move its contents to the thread specified here.")},void 0,(0,r.Z)("input",{className:"form-control",disabled:this.state.isLoading||this.props.thread.isBusy,id:"id_url",onChange:this.onUrlChange,value:this.state.url}))),(0,r.Z)("div",{className:"modal-footer"},void 0,(0,r.Z)("button",{className:"btn btn-default","data-dismiss":"modal",disabled:this.state.isLoading,type:"button"},void 0,gettext("Cancel")),(0,r.Z)("button",{className:"btn btn-primary",disabled:this.state.isLoading||this.props.thread.isBusy},void 0,gettext("Merge thread"))))))}};function ui(e){return(0,r.Z)("div",{className:"modal-header"},void 0,(0,r.Z)("button",{"aria-label":pgettext("modal","Close"),className:"close","data-dismiss":"modal",type:"button"},void 0,ai||(ai=(0,r.Z)("span",{"aria-hidden":"true"},void 0,"×"))),(0,r.Z)("h4",{className:"modal-title"},void 0,gettext("Merge thread")))}var hi,mi,vi,gi,Zi,bi,fi,_i,Ni,xi,yi,wi,ki=class extends u.Z{constructor(e){super(e),(0,l.Z)(this,"onCategoryChange",(e=>{this.changeValue("category",e.target.value)})),this.state={isReady:!1,isLoading:!1,isError:!1,category:null,categories:[]}}componentDidMount(){g.Z.get(C.Z.get("THREAD_EDITOR_API")).then((e=>{let t=null;const s=e.map((e=>(!1===e.post||t||(t=e.id),Object.assign(e,{disabled:!1===e.post,label:e.name,value:e.id}))));this.setState({isReady:!0,category:t,categories:s})}),(e=>{this.setState({isError:e.detail})}))}send(){return f.Z.dispatch(v.n6()),g.Z.patch(this.props.thread.api.index,[{op:"replace",path:"category",value:this.state.category}])}handleSuccess(){g.Z.get(this.props.thread.api.posts.index,{page:this.props.posts.page}).then((e=>{f.Z.dispatch(v.gx(e)),f.Z.dispatch(ba.zD(e.post_set)),f.Z.dispatch(v.Ar()),b.Z.success(gettext("Thread has been moved.")),Z.Z.hide()}),(e=>{f.Z.dispatch(v.Ar()),b.Z.apiError(e)}))}handleError(e){400===e.status?b.Z.error(e.detail[0]):b.Z.apiError(e)}render(){return this.state.isReady?(0,r.Z)("div",{className:"modal-dialog",role:"document"},void 0,(0,r.Z)("form",{onSubmit:this.handleSubmit},void 0,(0,r.Z)("div",{className:"modal-content"},void 0,ii||(ii=(0,r.Z)(Ci,{})),(0,r.Z)("div",{className:"modal-body"},void 0,(0,r.Z)(h.Z,{for:"id_category",label:gettext("New category")},void 0,(0,r.Z)(Ys.Z,{choices:this.state.categories,disabled:this.state.isLoading||this.props.thread.isBusy,id:"id_category",onChange:this.onCategoryChange,value:this.state.category}))),(0,r.Z)("div",{className:"modal-footer"},void 0,(0,r.Z)("button",{className:"btn btn-default","data-dismiss":"modal",disabled:this.state.isLoading,type:"button"},void 0,gettext("Cancel")),(0,r.Z)("button",{className:"btn btn-primary",disabled:this.state.isLoading||this.props.thread.isBusy},void 0,gettext("Move thread")))))):this.state.isError?(0,r.Z)(Ei,{message:this.state.isError}):oi||(oi=(0,r.Z)(Si,{}))}};function Ci(e){return(0,r.Z)("div",{className:"modal-header"},void 0,(0,r.Z)("button",{"aria-label":pgettext("modal","Close"),className:"close","data-dismiss":"modal",type:"button"},void 0,ni||(ni=(0,r.Z)("span",{"aria-hidden":"true"},void 0,"×"))),(0,r.Z)("h4",{className:"modal-title"},void 0,gettext("Move thread")))}function Si(e){return ri||(ri=(0,r.Z)("div",{className:"modal-dialog",role:"document"},void 0,(0,r.Z)("div",{className:"modal-content"},void 0,(0,r.Z)(Ci,{}),(0,r.Z)(G.Z,{}))))}function Ei(e){return(0,r.Z)("div",{className:"modal-dialog modal-message",role:"document"},void 0,(0,r.Z)("div",{className:"modal-content"},void 0,li||(li=(0,r.Z)(Ci,{})),di||(di=(0,r.Z)("div",{className:"message-icon"},void 0,(0,r.Z)("span",{className:"material-icon"},void 0,"info_outline"))),(0,r.Z)("div",{className:"message-body"},void 0,(0,r.Z)("p",{className:"lead"},void 0,gettext("You can't move this thread at the moment.")),(0,r.Z)("p",{},void 0,e.message),(0,r.Z)("button",{className:"btn btn-default","data-dismiss":"modal",type:"button"},void 0,gettext("Ok")))))}var Li,Ti,Pi,Oi,Ri=class extends c().Component{constructor(){super(...arguments),(0,l.Z)(this,"callApi",((e,t)=>{f.Z.dispatch(v.n6()),e.push({op:"add",path:"acl",value:!0}),g.Z.patch(this.props.thread.api.index,e).then((e=>{f.Z.dispatch(v.Vx(e)),f.Z.dispatch(v.Ar()),b.Z.success(t)}),(e=>{f.Z.dispatch(v.Ar()),400===e.status?b.Z.error(e.detail[0]):b.Z.apiError(e)}))})),(0,l.Z)(this,"changeTitle",(()=>{Z.Z.show((0,r.Z)(ei,{thread:this.props.thread}))})),(0,l.Z)(this,"pinGlobally",(()=>{this.callApi([{op:"replace",path:"weight",value:2}],gettext("Thread has been pinned globally."))})),(0,l.Z)(this,"pinLocally",(()=>{this.callApi([{op:"replace",path:"weight",value:1}],gettext("Thread has been pinned locally."))})),(0,l.Z)(this,"unpin",(()=>{this.callApi([{op:"replace",path:"weight",value:0}],gettext("Thread has been unpinned."))})),(0,l.Z)(this,"approve",(()=>{this.callApi([{op:"replace",path:"is-unapproved",value:!1}],gettext("Thread has been approved."))})),(0,l.Z)(this,"open",(()=>{this.callApi([{op:"replace",path:"is-closed",value:!1}],gettext("Thread has been opened."))})),(0,l.Z)(this,"close",(()=>{this.callApi([{op:"replace",path:"is-closed",value:!0}],gettext("Thread has been closed."))})),(0,l.Z)(this,"unhide",(()=>{this.callApi([{op:"replace",path:"is-hidden",value:!1}],gettext("Thread has been made visible."))})),(0,l.Z)(this,"hide",(()=>{this.callApi([{op:"replace",path:"is-hidden",value:!0}],gettext("Thread has been made hidden."))})),(0,l.Z)(this,"move",(()=>{Z.Z.show((0,r.Z)(ki,{posts:this.props.posts,thread:this.props.thread}))})),(0,l.Z)(this,"merge",(()=>{Z.Z.show((0,r.Z)(pi,{thread:this.props.thread}))})),(0,l.Z)(this,"delete",(()=>{window.confirm(gettext("Are you sure you want to delete this thread?"))&&(f.Z.dispatch(v.n6()),g.Z.delete(this.props.thread.api.index).then((e=>{b.Z.success(gettext("Thread has been deleted.")),window.location=this.props.thread.category.url.index}),(e=>{f.Z.dispatch(v.Ar()),b.Z.apiError(e)})))}))}render(){const{moderation:e}=this.props;return(0,r.Z)("ul",{className:"dropdown-menu dropdown-menu-right stick-to-bottom"},void 0,!!e.edit&&(0,r.Z)("li",{},void 0,(0,r.Z)("button",{className:"btn btn-link",onClick:this.changeTitle,type:"button"},void 0,hi||(hi=(0,r.Z)("span",{className:"material-icon"},void 0,"edit")),gettext("Change title"))),!!e.pinGlobally&&(0,r.Z)("li",{},void 0,(0,r.Z)("button",{className:"btn btn-link",onClick:this.pinGlobally,type:"button"},void 0,mi||(mi=(0,r.Z)("span",{className:"material-icon"},void 0,"bookmark")),gettext("Pin globally"))),!!e.pinLocally&&(0,r.Z)("li",{},void 0,(0,r.Z)("button",{className:"btn btn-link",onClick:this.pinLocally,type:"button"},void 0,vi||(vi=(0,r.Z)("span",{className:"material-icon"},void 0,"bookmark_border")),gettext("Pin locally"))),!!e.unpin&&(0,r.Z)("li",{},void 0,(0,r.Z)("button",{className:"btn btn-link",onClick:this.unpin,type:"button"},void 0,gi||(gi=(0,r.Z)("span",{className:"material-icon"},void 0,"panorama_fish_eye")),gettext("Unpin"))),!!e.move&&(0,r.Z)("li",{},void 0,(0,r.Z)("button",{className:"btn btn-link",onClick:this.move,type:"button"},void 0,Zi||(Zi=(0,r.Z)("span",{className:"material-icon"},void 0,"arrow_forward")),gettext("Move"))),!!e.merge&&(0,r.Z)("li",{},void 0,(0,r.Z)("button",{className:"btn btn-link",onClick:this.merge,type:"button"},void 0,bi||(bi=(0,r.Z)("span",{className:"material-icon"},void 0,"call_merge")),gettext("Merge"))),!!e.approve&&(0,r.Z)("li",{},void 0,(0,r.Z)("button",{className:"btn btn-link",onClick:this.approve,type:"button"},void 0,fi||(fi=(0,r.Z)("span",{className:"material-icon"},void 0,"done")),gettext("Approve"))),!!e.open&&(0,r.Z)("li",{},void 0,(0,r.Z)("button",{className:"btn btn-link",onClick:this.open,type:"button"},void 0,_i||(_i=(0,r.Z)("span",{className:"material-icon"},void 0,"lock_open")),gettext("Open"))),!!e.close&&(0,r.Z)("li",{},void 0,(0,r.Z)("button",{className:"btn btn-link",onClick:this.close,type:"button"},void 0,Ni||(Ni=(0,r.Z)("span",{className:"material-icon"},void 0,"lock_outline")),gettext("Close"))),!!e.unhide&&(0,r.Z)("li",{},void 0,(0,r.Z)("button",{className:"btn btn-link",onClick:this.unhide,type:"button"},void 0,xi||(xi=(0,r.Z)("span",{className:"material-icon"},void 0,"visibility")),gettext("Unhide"))),!!e.hide&&(0,r.Z)("li",{},void 0,(0,r.Z)("button",{className:"btn btn-link",onClick:this.hide,type:"button"},void 0,yi||(yi=(0,r.Z)("span",{className:"material-icon"},void 0,"visibility_off")),gettext("Hide"))),!!e.delete&&(0,r.Z)("li",{},void 0,(0,r.Z)("button",{className:"btn btn-link",onClick:this.delete,type:"button"},void 0,wi||(wi=(0,r.Z)("span",{className:"material-icon"},void 0,"clear")),gettext("Delete"))))}},Ai=Ri,Ii=e=>{let{thread:t,posts:s,moderation:a}=e;return(0,r.Z)("div",{className:"dropdown"},void 0,(0,r.Z)("button",{type:"button",className:"btn btn-default btn-outline btn-icon dropdown-toggle",title:gettext("Thread options"),"data-toggle":"dropdown","aria-haspopup":"true","aria-expanded":"false",disabled:t.isBusy},void 0,Li||(Li=(0,r.Z)("span",{className:"material-icon"},void 0,"settings"))),(0,r.Z)(Ai,{thread:t,posts:s,moderation:a}))},Di=s(94184),ji=s.n(Di);function zi(e,t,s){const a={subscription:e.subscription};f.Z.dispatch(v.Vx({subscription:t})),g.Z.patch(e.api.index,[{op:"replace",path:"subscription",value:s}]).then((e=>{f.Z.dispatch(v.Vx(e))}),(e=>{400===e.status?b.Z.error(e.detail[0]):b.Z.apiError(e),f.Z.dispatch(v.Vx(a))}))}var Ui,Mi,Bi=e=>{let{stickToBottom:t,thread:s}=e;return(0,r.Z)("div",{className:"dropdown"},void 0,(0,r.Z)("button",{className:"btn btn-default btn-outline btn-block","aria-expanded":"true","aria-haspopup":"true","data-toggle":"dropdown",type:"button"},void 0,(0,r.Z)("span",{className:"material-icon"},void 0,!0===(a=s.subscription)?"star":!1===a?"star_half":"star_border"),function(e){return!0===e?gettext("E-mail"):!1===e?gettext("Enabled"):gettext("Disabled")}(s.subscription)),(0,r.Z)("ul",{className:ji()("dropdown-menu dropdown-menu-right",{"stick-to-bottom":t})},void 0,(0,r.Z)("li",{},void 0,(0,r.Z)("button",{className:"btn btn-link",onClick:()=>function(e){null!==e.subscription&&zi(e,null,"unsubscribe")}(s)},void 0,Ti||(Ti=(0,r.Z)("span",{className:"material-icon"},void 0,"star_border")),gettext("Unsubscribe"))),(0,r.Z)("li",{},void 0,(0,r.Z)("button",{className:"btn btn-link",onClick:()=>function(e){!1!==e.subscription&&zi(e,!1,"notify")}(s)},void 0,Pi||(Pi=(0,r.Z)("span",{className:"material-icon"},void 0,"star_half")),gettext("Subscribe"))),(0,r.Z)("li",{},void 0,(0,r.Z)("button",{className:"btn btn-link",onClick:()=>function(e){!0!==e.subscription&&zi(e,!0,"email")}(s)},void 0,Oi||(Oi=(0,r.Z)("span",{className:"material-icon"},void 0,"star")),gettext("Subscribe with e-mail")))));var a},qi=e=>{let{children:t,className:s}=e;return(0,r.Z)("ul",{className:ji()("breadcrumbs",s)},void 0,t)},Hi=e=>{let{category:t,className:s}=e;return(0,r.Z)("li",{className:ji()("breadcrumbs-item",s)},void 0,(0,r.Z)("a",{href:t.url.index},void 0,(0,r.Z)("span",{className:"material-icon",style:{color:t.color||"inherit"}},void 0,"label"),!!t.short_name&&(0,r.Z)("span",{className:"breadcrumbs-item-name hidden-sm hidden-md hidden-lg",title:t.name},void 0,t.short_name),!!t.short_name&&(0,r.Z)("span",{className:"breadcrumbs-item-name hidden-xs"},void 0,t.name),!t.short_name&&(0,r.Z)("span",{className:"breadcrumbs-item-name"},void 0,t.name)))},Fi=e=>{let{category:t,className:s}=e;return(0,r.Z)("li",{className:ji()("breadcrumbs-item",s)},void 0,(0,r.Z)("a",{href:t.url.index},void 0,Ui||(Ui=(0,r.Z)("span",{className:"material-icon"},void 0,"chevron_right")),(0,r.Z)("span",{className:"breadcrumbs-item-name"},void 0,"root_category"===t.special_role?gettext("Threads"):gettext("Private threads"))))},Yi=e=>{let{breadcrumbs:t}=e;return(0,r.Z)(qi,{},void 0,t.map((e=>e.special_role?(0,r.Z)(Fi,{category:e},e.id):(0,r.Z)(Hi,{category:e},e.id))))};var Vi,Gi,$i,Wi,Qi,Ki,Ji,Xi,eo,to,so,ao=e=>{let{styleName:t,thread:s,posts:a,user:i,moderation:o}=e;return(0,r.Z)(Ja.sP,{},void 0,(0,r.Z)(Ja.mr,{styleName:t},void 0,(0,r.Z)(Ja.gC,{styleName:t},void 0,(0,r.Z)(Yi,{breadcrumbs:s.path}),(0,r.Z)("h1",{},void 0,s.title)),(0,r.Z)(Ja.eA,{className:"page-header-thread-details"},void 0,(0,r.Z)($a.gq,{},void 0,(0,r.Z)($a.kw,{auto:!0},void 0,(0,r.Z)($a.Z6,{shrink:!0},void 0,(0,r.Z)(Ka,{thread:s})),Mi||(Mi=(0,r.Z)($a.Z6,{auto:!0})),s.replies>0&&(0,r.Z)($a.Z6,{shrink:!0},void 0,(0,r.Z)(Qa.Z,{thread:s})),(e=>e.is_closed||e.is_hidden||e.is_unapproved||e.weight>0||e.best_answer||e.has_poll||e.has_unapproved_posts)(s)&&(0,r.Z)($a.Z6,{shrink:!0},void 0,(0,r.Z)(Wa.Z,{thread:s}))),i.is_authenticated&&(0,r.Z)($a.kw,{},void 0,(0,r.Z)($a.Z6,{},void 0,(0,r.Z)(Bi,{thread:s})),o.enabled&&(0,r.Z)($a.Z6,{shrink:!0},void 0,(0,r.Z)(Ii,{thread:s,posts:a,moderation:o})))))))},io=s(92490),oo=s(69987),no=e=>{let{baseUrl:t,posts:s}=e;return(0,r.Z)("div",{className:"misago-pagination"},void 0,s.isLoaded&&s.first?(0,r.Z)(oo.rU,{className:"btn btn-default btn-outline btn-icon",to:t,title:gettext("Go to first page")},void 0,Vi||(Vi=(0,r.Z)("span",{className:"material-icon"},void 0,"first_page"))):(0,r.Z)("button",{className:"btn btn-default btn-outline btn-icon",title:gettext("Go to first page"),type:"button",disabled:!0},void 0,Gi||(Gi=(0,r.Z)("span",{className:"material-icon"},void 0,"first_page"))),s.isLoaded&&s.previous?(0,r.Z)(oo.rU,{className:"btn btn-default btn-outline btn-icon",to:t+(s.previous>1?s.previous+"/":""),title:gettext("Go to previous page")},void 0,$i||($i=(0,r.Z)("span",{className:"material-icon"},void 0,"chevron_left"))):(0,r.Z)("button",{className:"btn btn-default btn-outline btn-icon",title:gettext("Go to previous page"),type:"button",disabled:!0},void 0,Wi||(Wi=(0,r.Z)("span",{className:"material-icon"},void 0,"chevron_left"))),s.isLoaded&&s.next?(0,r.Z)(oo.rU,{className:"btn btn-default btn-outline btn-icon",to:t+s.next+"/",title:gettext("Go to next page")},void 0,Qi||(Qi=(0,r.Z)("span",{className:"material-icon"},void 0,"chevron_right"))):(0,r.Z)("button",{className:"btn btn-default btn-outline btn-icon",title:gettext("Go to next page"),type:"button",disabled:!0},void 0,Ki||(Ki=(0,r.Z)("span",{className:"material-icon"},void 0,"chevron_right"))),s.isLoaded&&s.last?(0,r.Z)(oo.rU,{className:"btn btn-default btn-outline btn-icon",to:t+s.last+"/",title:gettext("Go to last page")},void 0,Ji||(Ji=(0,r.Z)("span",{className:"material-icon"},void 0,"last_page"))):(0,r.Z)("button",{className:"btn btn-default btn-outline btn-icon",title:gettext("Go to last page"),type:"button",disabled:!0},void 0,Xi||(Xi=(0,r.Z)("span",{className:"material-icon"},void 0,"last_page"))))},ro=e=>{let{posts:t}=e;return t.more?(0,r.Z)("p",{},void 0,interpolate(ngettext("There is %(more)s more post in this thread.","There are %(more)s more posts in this thread.",t.more),{more:t.more},!0)):(0,r.Z)("p",{},void 0,gettext("There are no more posts in this thread."))};function lo(e){let{errors:t,posts:s}=e;return(0,r.Z)("div",{className:"modal-dialog",role:"document"},void 0,(0,r.Z)("div",{className:"modal-content"},void 0,(0,r.Z)("div",{className:"modal-header"},void 0,(0,r.Z)("button",{"aria-label":pgettext("modal","Close"),className:"close","data-dismiss":"modal",type:"button"},void 0,eo||(eo=(0,r.Z)("span",{"aria-hidden":"true"},void 0,"×"))),(0,r.Z)("h4",{className:"modal-title"},void 0,gettext("Moderation"))),(0,r.Z)("div",{className:"modal-body"},void 0,(0,r.Z)("p",{className:"lead"},void 0,gettext("One or more posts could not be changed:")),(0,r.Z)("ul",{className:"list-unstyled list-errored-items"},void 0,t.map((e=>(0,r.Z)(co,{errors:e.detail,post:s[e.id]},e.id)))))))}function co(e){let{errors:t,post:s}=e;const a=interpolate(gettext("%(username)s on %(posted_on)s"),{posted_on:s.posted_on.format("LL, LT"),username:s.poster_name},!0);return(0,r.Z)("li",{},void 0,(0,r.Z)("h5",{},void 0,a,":"),t.map(((e,t)=>(0,r.Z)("p",{},t,e))))}function po(e,t,s,a){const{selection:i,thread:o}=e;s.forEach((e=>{Ue.r$(e,e)})),f.Z.dispatch(ba.kR());const n={ops:t,ids:i.map((e=>e.id))};g.Z.patch(o.api.posts.index,n).then((e=>{e.forEach((e=>{f.Z.dispatch(Ue.r$(e,e))}))}),(e=>{if(400!==e.status)return a.forEach((e=>{f.Z.dispatch(Ue.r$(e,e))})),b.Z.apiError(e);let t=[],s=[];e.forEach((e=>{e.detail?(t.push(e),s.push(e.id)):f.Z.dispatch(Ue.r$(e,e)),a.forEach((e=>{-1!==s.indexOf(e)&&f.Z.dispatch(Ue.r$(e,e))}))}));let o={};i.forEach((e=>{o[e.id]=e})),Z.Z.show((0,r.Z)(lo,{errors:t,posts:o}))}))}var uo,ho,mo,vo,go,Zo,bo,fo,_o,No,xo,yo,wo,ko,Co,So,Eo=class extends u.Z{constructor(e){super(e),(0,l.Z)(this,"onUrlChange",(e=>{this.changeValue("url",e.target.value)})),this.state={isLoading:!1,url:"",validators:{url:[]},errors:{}}}clean(){return!!this.state.url.trim().length||(b.Z.error(gettext("You have to enter link to the other thread.")),!1)}send(){return g.Z.post(this.props.thread.api.posts.move,{new_thread:this.state.url,posts:this.props.selection.map((e=>e.id))})}handleSuccess(e){this.props.selection.forEach((e=>{f.Z.dispatch(Ue.r$(e,{isDeleted:!0}))})),Z.Z.hide(),b.Z.success(gettext("Selected posts were moved to the other thread."))}handleError(e){400===e.status?b.Z.error(e.detail):b.Z.apiError(e)}render(){return(0,r.Z)("div",{className:"modal-dialog",role:"document"},void 0,(0,r.Z)("form",{onSubmit:this.handleSubmit},void 0,(0,r.Z)("div",{className:"modal-content"},void 0,to||(to=(0,r.Z)(Lo,{})),(0,r.Z)("div",{className:"modal-body"},void 0,(0,r.Z)(h.Z,{for:"id_url",label:gettext("Link to thread you want to move posts to")},void 0,(0,r.Z)("input",{className:"form-control",disabled:this.state.isLoading,id:"id_url",onChange:this.onUrlChange,value:this.state.url}))),(0,r.Z)("div",{className:"modal-footer"},void 0,(0,r.Z)("button",{className:"btn btn-default","data-dismiss":"modal",disabled:this.state.isLoading,type:"button"},void 0,gettext("Cancel")),(0,r.Z)("button",{className:"btn btn-primary",disabled:this.state.isLoading},void 0,gettext("Move posts"))))))}};function Lo(e){return(0,r.Z)("div",{className:"modal-header"},void 0,(0,r.Z)("button",{"aria-label":pgettext("modal","Close"),className:"close","data-dismiss":"modal",type:"button"},void 0,so||(so=(0,r.Z)("span",{"aria-hidden":"true"},void 0,"×"))),(0,r.Z)("h4",{className:"modal-title"},void 0,gettext("Move posts")))}function To(e){return c().createElement(Po,(0,p.Z)({},e,{Form:Oo}))}class Po extends c().Component{constructor(e){super(e),this.state={isLoaded:!1,isError:!1,categories:[]}}componentDidMount(){g.Z.get(misago.get("THREAD_EDITOR_API")).then((e=>{const t=e.map((e=>Object.assign(e,{disabled:!1===e.post,label:e.name,value:e.id,post:e.post})));this.setState({isLoaded:!0,categories:t})}),(e=>{this.setState({isError:e.detail})}))}render(){return this.state.isError?(0,r.Z)(Ao,{message:this.state.isError}):this.state.isLoaded?c().createElement(Oo,(0,p.Z)({},this.props,{categories:this.state.categories})):uo||(uo=(0,r.Z)(Ro,{}))}}class Oo extends u.Z{constructor(e){super(e),(0,l.Z)(this,"onCategoryChange",(e=>{const t=e.target.value,s={category:t};this.acl[t].can_pin_threads<s.weight&&(s.weight=0),this.acl[t].can_hide_threads||(s.is_hidden=0),this.acl[t].can_close_threads||(s.is_closed=!1),this.setState(s)})),this.state={isLoading:!1,title:"",category:null,categories:e.categories,weight:0,is_hidden:0,is_closed:!1,validators:{title:[Gs.C1()]},errors:{}},this.isHiddenChoices=[{value:0,icon:"visibility",label:gettext("No")},{value:1,icon:"visibility_off",label:gettext("Yes")}],this.isClosedChoices=[{value:!1,icon:"lock_outline",label:gettext("No")},{value:!0,icon:"lock",label:gettext("Yes")}],this.acl={},this.props.categories.forEach((e=>{e.post&&(this.state.category||(this.state.category=e.id),this.acl[e.id]={can_pin_threads:e.post.pin,can_close_threads:e.post.close,can_hide_threads:e.post.hide})}))}clean(){return!!this.isValid()||(b.Z.error(gettext("Form contains errors.")),this.setState({errors:this.validate()}),!1)}send(){return g.Z.post(this.props.thread.api.posts.split,{title:this.state.title,category:this.state.category,weight:this.state.weight,is_hidden:this.state.is_hidden,is_closed:this.state.is_closed,posts:this.props.selection.map((e=>e.id))})}handleSuccess(e){this.props.selection.forEach((e=>{f.Z.dispatch(Ue.r$(e,{isDeleted:!0}))})),Z.Z.hide(),b.Z.success(gettext("Selected posts were split into new thread."))}handleError(e){400===e.status?(this.setState({errors:Object.assign({},this.state.errors,e)}),b.Z.error(gettext("Form contains errors."))):403===e.status&&Array.isArray(e)?Z.Z.show((0,r.Z)(lo,{errors:e})):b.Z.apiError(e)}getWeightChoices(){const e=[{value:0,icon:"remove",label:gettext("Not pinned")},{value:1,icon:"bookmark_border",label:gettext("Pinned locally")}];return 2==this.acl[this.state.category].can_pin_threads&&e.push({value:2,icon:"bookmark",label:gettext("Pinned globally")}),e}renderWeightField(){return this.acl[this.state.category].can_pin_threads?(0,r.Z)(h.Z,{label:gettext("Thread weight"),for:"id_weight",labelClass:"col-sm-4",controlClass:"col-sm-8"},void 0,(0,r.Z)(Vs.Z,{id:"id_weight",onChange:this.bindInput("weight"),value:this.state.weight,choices:this.getWeightChoices()})):null}renderHiddenField(){return this.acl[this.state.category].can_hide_threads?(0,r.Z)(h.Z,{label:gettext("Hide thread"),for:"id_is_hidden",labelClass:"col-sm-4",controlClass:"col-sm-8"},void 0,(0,r.Z)(Vs.Z,{id:"id_is_closed",onChange:this.bindInput("is_hidden"),value:this.state.is_hidden,choices:this.isHiddenChoices})):null}renderClosedField(){return this.acl[this.state.category].can_close_threads?(0,r.Z)(h.Z,{label:gettext("Close thread"),for:"id_is_closed",labelClass:"col-sm-4",controlClass:"col-sm-8"},void 0,(0,r.Z)(Vs.Z,{id:"id_is_closed",onChange:this.bindInput("is_closed"),value:this.state.is_closed,choices:this.isClosedChoices})):null}render(){return(0,r.Z)(Io,{className:"modal-dialog"},void 0,(0,r.Z)("form",{onSubmit:this.handleSubmit},void 0,(0,r.Z)("div",{className:"modal-body"},void 0,(0,r.Z)(h.Z,{label:gettext("Thread title"),for:"id_title",labelClass:"col-sm-4",controlClass:"col-sm-8",validation:this.state.errors.title},void 0,(0,r.Z)("input",{id:"id_title",className:"form-control",type:"text",onChange:this.bindInput("title"),value:this.state.title})),ho||(ho=(0,r.Z)("div",{className:"clearfix"})),(0,r.Z)(h.Z,{label:gettext("Category"),for:"id_category",labelClass:"col-sm-4",controlClass:"col-sm-8",validation:this.state.errors.category},void 0,(0,r.Z)(Ys.Z,{id:"id_category",onChange:this.onCategoryChange,value:this.state.category,choices:this.state.categories})),mo||(mo=(0,r.Z)("div",{className:"clearfix"})),this.renderWeightField(),this.renderHiddenField(),this.renderClosedField()),(0,r.Z)("div",{className:"modal-footer"},void 0,(0,r.Z)("button",{className:"btn btn-default","data-dismiss":"modal",disabled:this.state.isLoading,type:"button"},void 0,gettext("Cancel")),(0,r.Z)(Ee.Z,{className:"btn-primary",loading:this.state.isLoading},void 0,gettext("Split posts")))))}}function Ro(){return vo||(vo=(0,r.Z)(Io,{className:"modal-dialog"},void 0,(0,r.Z)(G.Z,{})))}function Ao(e){return(0,r.Z)(Io,{className:"modal-dialog modal-message"},void 0,go||(go=(0,r.Z)("div",{className:"message-icon"},void 0,(0,r.Z)("span",{className:"material-icon"},void 0,"info_outline"))),(0,r.Z)("div",{className:"message-body"},void 0,(0,r.Z)("p",{className:"lead"},void 0,gettext("You can't move selected posts at the moment.")),(0,r.Z)("p",{},void 0,e.message),(0,r.Z)("button",{className:"btn btn-default","data-dismiss":"modal",type:"button"},void 0,gettext("Ok"))))}function Io(e){return(0,r.Z)("div",{className:e.className,role:"document"},void 0,(0,r.Z)("div",{className:"modal-content"},void 0,(0,r.Z)("div",{className:"modal-header"},void 0,(0,r.Z)("button",{"aria-label":pgettext("modal","Close"),className:"close","data-dismiss":"modal",type:"button"},void 0,Zo||(Zo=(0,r.Z)("span",{"aria-hidden":"true"},void 0,"×"))),(0,r.Z)("h4",{className:"modal-title"},void 0,gettext("Split posts into new thread"))),e.children))}function Do(e){return(0,r.Z)("ul",{className:"dropdown-menu dropdown-menu-right stick-to-bottom"},void 0,c().createElement(jo,e),c().createElement(zo,e),c().createElement(Uo,e),c().createElement(Mo,e),c().createElement(Bo,e),c().createElement(qo,e),c().createElement(Fo,e),c().createElement(Ho,e),c().createElement(Yo,e))}class jo extends c().Component{constructor(){super(...arguments),(0,l.Z)(this,"onClick",(()=>{!function(e){const{selection:t}=e,s=t.map((e=>({id:e.id,is_unapproved:!1}))),a=t.map((e=>({id:e.id,is_unapproved:e.is_unapproved})));po(e,[{op:"replace",path:"is-unapproved",value:!1}],s,a)}(this.props)}))}render(){const e=this.props.selection.find((e=>e.acl.can_approve&&e.is_unapproved));return e?(0,r.Z)("li",{},void 0,(0,r.Z)("button",{type:"button",className:"btn btn-link",onClick:this.onClick},void 0,bo||(bo=(0,r.Z)("span",{className:"material-icon"},void 0,"done")),gettext("Approve"))):null}}class zo extends c().Component{constructor(){super(...arguments),(0,l.Z)(this,"onClick",(()=>{var e;e=this.props,window.confirm(gettext("Are you sure you want to merge selected posts? This action is not reversible!"))&&(e.selection.slice(1).map((e=>{f.Z.dispatch(Ue.r$(e,{isDeleted:!0}))})),g.Z.post(e.thread.api.posts.merge,{posts:e.selection.map((e=>e.id))}).then((e=>{f.Z.dispatch(Ue.r$(e,Ue.ZB(e)))}),(t=>{400===t.status?b.Z.error(t.detail):b.Z.apiError(t),e.selection.slice(1).map((e=>{f.Z.dispatch(Ue.r$(e,{isDeleted:!1}))}))})),f.Z.dispatch(ba.kR()))}))}render(){const e=this.props.selection.length>1&&this.props.selection.find((e=>e.acl.can_merge));return e?(0,r.Z)("li",{},void 0,(0,r.Z)("button",{type:"button",className:"btn btn-link",onClick:this.onClick},void 0,fo||(fo=(0,r.Z)("span",{className:"material-icon"},void 0,"call_merge")),gettext("Merge"))):null}}class Uo extends c().Component{constructor(){super(...arguments),(0,l.Z)(this,"onClick",(()=>{Z.Z.show(c().createElement(Eo,this.props))}))}render(){const e=this.props.selection.find((e=>e.acl.can_move));return e?(0,r.Z)("li",{},void 0,(0,r.Z)("button",{type:"button",className:"btn btn-link",onClick:this.onClick},void 0,_o||(_o=(0,r.Z)("span",{className:"material-icon"},void 0,"arrow_forward")),gettext("Move"))):null}}class Mo extends c().Component{constructor(){super(...arguments),(0,l.Z)(this,"onClick",(()=>{Z.Z.show(c().createElement(To,this.props))}))}render(){const e=this.props.selection.find((e=>e.acl.can_move));return e?(0,r.Z)("li",{},void 0,(0,r.Z)("button",{type:"button",className:"btn btn-link",onClick:this.onClick},void 0,No||(No=(0,r.Z)("span",{className:"material-icon"},void 0,"call_split")),gettext("Split"))):null}}class Bo extends c().Component{constructor(){super(...arguments),(0,l.Z)(this,"onClick",(()=>{!function(e){const{selection:t}=e,s=t.map((e=>({id:e.id,is_protected:!0}))),a=t.map((e=>({id:e.id,is_protected:e.is_protected})));po(e,[{op:"replace",path:"is-protected",value:!0}],s,a)}(this.props)}))}render(){const e=this.props.selection.find((e=>!e.is_protected&&e.acl.can_protect));return e?(0,r.Z)("li",{},void 0,(0,r.Z)("button",{type:"button",className:"btn btn-link",onClick:this.onClick},void 0,xo||(xo=(0,r.Z)("span",{className:"material-icon"},void 0,"lock_outline")),gettext("Protect"))):null}}class qo extends c().Component{constructor(){super(...arguments),(0,l.Z)(this,"onClick",(()=>{!function(e){const{selection:t}=e,s=t.map((e=>({id:e.id,is_protected:!1}))),a=t.map((e=>({id:e.id,is_protected:e.is_protected})));po(e,[{op:"replace",path:"is-protected",value:!1}],s,a)}(this.props)}))}render(){const e=this.props.selection.find((e=>e.is_protected&&e.acl.can_protect));return e?(0,r.Z)("li",{},void 0,(0,r.Z)("button",{type:"button",className:"btn btn-link",onClick:this.onClick},void 0,yo||(yo=(0,r.Z)("span",{className:"material-icon"},void 0,"lock_open")),gettext("Unprotect"))):null}}class Ho extends c().Component{constructor(){super(...arguments),(0,l.Z)(this,"onClick",(()=>{!function(e){const{selection:t}=e,s=t.map((t=>({id:t.id,is_hidden:!0,hidden_on:j()(),hidden_by_name:e.user.username,url:Object.assign(t.url,{hidden_by:e.user.url})}))),a=t.map((e=>({id:e.id,is_hidden:e.is_hidden,hidden_on:e.hidden_on,hidden_by_name:e.hidden_by_name,url:e.url})));po(e,[{op:"replace",path:"is-hidden",value:!0}],s,a)}(this.props)}))}render(){const e=this.props.selection.find((e=>e.acl.can_hide&&!e.is_hidden));return e?(0,r.Z)("li",{},void 0,(0,r.Z)("button",{type:"button",className:"btn btn-link",onClick:this.onClick},void 0,wo||(wo=(0,r.Z)("span",{className:"material-icon"},void 0,"visibility_off")),gettext("Hide"))):null}}class Fo extends c().Component{constructor(){super(...arguments),(0,l.Z)(this,"onClick",(()=>{!function(e){const{selection:t}=e,s=t.map((t=>({id:t.id,is_hidden:!1,hidden_on:j()(),hidden_by_name:e.user.username,url:Object.assign(t.url,{hidden_by:e.user.url})}))),a=t.map((e=>({id:e.id,is_hidden:e.is_hidden,hidden_on:e.hidden_on,hidden_by_name:e.hidden_by_name,url:e.url})));po(e,[{op:"replace",path:"is-hidden",value:!1}],s,a)}(this.props)}))}render(){const e=this.props.selection.find((e=>e.acl.can_unhide&&e.is_hidden));return e?(0,r.Z)("li",{},void 0,(0,r.Z)("button",{type:"button",className:"btn btn-link",onClick:this.onClick},void 0,ko||(ko=(0,r.Z)("span",{className:"material-icon"},void 0,"visibility")),gettext("Unhide"))):null}}class Yo extends c().Component{constructor(){super(...arguments),(0,l.Z)(this,"onClick",(()=>{!function(e){if(!window.confirm(gettext("Are you sure you want to delete selected posts? This action is not reversible!")))return;e.selection.map((e=>{f.Z.dispatch(Ue.r$(e,{isDeleted:!0}))}));const t=e.selection.map((e=>e.id));g.Z.delete(e.thread.api.posts.index,t).then((()=>{}),(t=>{400===t.status?b.Z.error(t.detail):b.Z.apiError(t),e.selection.map((e=>{f.Z.dispatch(Ue.r$(e,{isDeleted:!1}))}))})),f.Z.dispatch(ba.kR())}(this.props)}))}render(){const e=this.props.selection.find((e=>e.acl.can_delete));return e?(0,r.Z)("li",{},void 0,(0,r.Z)("button",{type:"button",className:"btn btn-link",onClick:this.onClick},void 0,Co||(Co=(0,r.Z)("span",{className:"material-icon"},void 0,"clear")),gettext("Delete"))):null}}var Vo,Go,$o,Wo,Qo,Ko,Jo,Xo,en,tn=e=>{let{thread:t,user:s,selection:a,dropup:i}=e;return(0,r.Z)("div",{className:i?"dropup":"dropdown"},void 0,(0,r.Z)("button",{type:"button",className:"btn btn-default btn-outline btn-icon dropdown-toggle",title:gettext("Posts options"),"data-toggle":"dropdown","aria-haspopup":"true","aria-expanded":"false",disabled:0===a.length},void 0,So||(So=(0,r.Z)("span",{className:"material-icon"},void 0,"settings"))),(0,r.Z)(Do,{thread:t,user:s,selection:a}))},sn=e=>{let{onClick:t}=e;return(0,r.Z)("button",{className:"btn btn-primary btn-outline btn-block",type:"button",onClick:t},void 0,Vo||(Vo=(0,r.Z)("span",{className:"material-icon"},void 0,"chat")),gettext("Reply"))},an=e=>{let{thread:t,posts:s,user:a,selection:i,moderation:o,onReply:n}=e;return(0,r.Z)(io.o8,{},void 0,(0,r.Z)(io.Z2,{},void 0,(0,r.Z)(io.Eg,{},void 0,(0,r.Z)(no,{baseUrl:t.url.index,posts:s})),o.enabled&&(0,r.Z)(io.Eg,{className:"hidden-sm hidden-md hidden-lg",shrink:!0},void 0,(0,r.Z)(tn,{thread:t,user:a,selection:i,dropup:!0}))),(0,r.Z)(io.Z2,{className:"hidden-xs hidden-sm",auto:!0},void 0,(0,r.Z)(io.Eg,{},void 0,(0,r.Z)(ro,{posts:s}))),Go||(Go=(0,r.Z)(io.tw,{className:"hidden-md hidden-lg"})),a.is_authenticated&&(0,r.Z)(io.Z2,{},void 0,(0,r.Z)(io.Eg,{},void 0,(0,r.Z)(Bi,{thread:t})),t.acl.can_reply&&(0,r.Z)(io.Eg,{},void 0,(0,r.Z)(sn,{onClick:n})),o.enabled&&(0,r.Z)(io.Eg,{className:"hidden-xs",shrink:!0},void 0,(0,r.Z)(tn,{thread:t,user:a,selection:i,dropup:!0}))))},on=e=>{let{compact:t,disabled:s,onClick:a}=e;return(0,r.Z)("button",{className:ji()("btn btn-default btn-outline",{"btn-block":!t,"btn-icon":t}),type:"button",title:t?gettext("Add poll"):null,disabled:s,onClick:a},void 0,$o||($o=(0,r.Z)("span",{className:"material-icon"},void 0,"poll")),!t&&gettext("Add poll"))},nn=e=>{let{user:t,thread:s}=e;return(0,r.Z)("div",{className:"dropdown"},void 0,(0,r.Z)("button",{className:"btn btn-default btn-outline btn-icon",title:gettext("Shortcuts"),"aria-expanded":"true","aria-haspopup":"true","data-toggle":"dropdown",type:"button"},void 0,Wo||(Wo=(0,r.Z)("span",{className:"material-icon"},void 0,"bookmark"))),(0,r.Z)("ul",{className:"dropdown-menu"},void 0,t.is_authenticated&&s.is_new&&(0,r.Z)("li",{},void 0,(0,r.Z)("a",{className:"btn btn-link",href:s.url.new_post},void 0,Qo||(Qo=(0,r.Z)("span",{className:"material-icon"},void 0,"comment")),gettext("Go to new post"))),s.best_answer&&(0,r.Z)("li",{},void 0,(0,r.Z)("a",{className:"btn btn-link",href:s.url.best_answer},void 0,Ko||(Ko=(0,r.Z)("span",{className:"material-icon"},void 0,"check_circle")),gettext("Go to best answer"))),s.has_unapproved_posts&&s.acl.can_approve&&(0,r.Z)("li",{},void 0,(0,r.Z)("a",{className:"btn btn-link",href:s.url.unapproved_post},void 0,Jo||(Jo=(0,r.Z)("span",{className:"material-icon"},void 0,"visibility")),gettext("Go to unapproved post"))),(0,r.Z)("li",{},void 0,(0,r.Z)("a",{className:"btn btn-link",href:s.url.last_post},void 0,Xo||(Xo=(0,r.Z)("span",{className:"material-icon"},void 0,"reply")),gettext("Go to last post")))))},rn=e=>{let{thread:t,posts:s,user:a,pollDisabled:i,selection:o,moderation:n,onPoll:l,onReply:d}=e;return(0,r.Z)(io.o8,{},void 0,(0,r.Z)(io.Z2,{className:"hidden-xs"},void 0,(0,r.Z)(io.Eg,{},void 0,(0,r.Z)(nn,{thread:t,user:a})),(0,r.Z)(io.Eg,{className:"hidden-xs hidden-sm"},void 0,(0,r.Z)(no,{baseUrl:t.url.index,posts:s}))),en||(en=(0,r.Z)(io.tw,{})),t.acl.can_start_poll&&!t.poll&&(0,r.Z)(io.Z2,{className:"hidden-xs"},void 0,(0,r.Z)(io.Eg,{},void 0,(0,r.Z)(on,{disabled:i,onClick:l}))),t.acl.can_reply?(0,r.Z)(io.Z2,{},void 0,(0,r.Z)(io.Eg,{className:"hidden-sm hidden-md hidden-lg",shrink:!0},void 0,(0,r.Z)(nn,{thread:t,user:a})),(0,r.Z)(io.Eg,{},void 0,(0,r.Z)(sn,{onClick:d})),t.acl.can_start_poll&&!t.poll&&(0,r.Z)(io.Eg,{className:"hidden-sm hidden-md hidden-lg",shrink:!0},void 0,(0,r.Z)(on,{disabled:i,onClick:l,compact:!0})),n.enabled&&(0,r.Z)(io.Eg,{className:"hidden-xs",shrink:!0},void 0,(0,r.Z)(tn,{thread:t,user:a,selection:o}))):(0,r.Z)(io.Z2,{},void 0,(0,r.Z)(io.Eg,{className:"hidden-sm hidden-md hidden-lg",shrink:!0},void 0,(0,r.Z)(nn,{thread:t,user:a})),t.acl.can_start_poll&&!t.poll&&(0,r.Z)(io.Eg,{},void 0,(0,r.Z)(on,{disabled:i,onClick:l})),n.enabled&&(0,r.Z)(io.Eg,{shrink:!0},void 0,(0,r.Z)(tn,{thread:t,user:a,selection:o}))))},ln=class extends c().Component{constructor(e){super(e),(0,l.Z)(this,"update",(e=>{f.Z.dispatch(v.gx(e)),f.Z.dispatch(ba.zD(e.post_set)),e.participants&&f.Z.dispatch(m.gx(e.participants)),e.poll&&f.Z.dispatch(se.gx(e.poll)),this.setPageTitle()})),(0,l.Z)(this,"openPollForm",(()=>{this.setState({editPoll:!0})})),(0,l.Z)(this,"closePollForm",(()=>{this.setState({editPoll:!1})})),(0,l.Z)(this,"openReplyForm",(()=>{ae.Z.open({mode:"REPLY",thread:this.props.thread,config:this.props.thread.api.editor,submit:this.props.thread.api.posts.index})})),this.state={editPoll:!1}}componentDidMount(){this.shouldFetchData()&&(this.fetchData(),this.setPageTitle()),this.startPollingApi()}componentDidUpdate(){this.shouldFetchData()&&(this.fetchData(),this.startPollingApi(),this.setPageTitle())}componentWillUnmount(){this.stopPollingApi()}shouldFetchData(){return!!this.props.posts.isLoaded&&1*(this.props.params.page||1)!=this.props.posts.page}fetchData(){f.Z.dispatch(ba.Rz()),g.Z.get(this.props.thread.api.posts.index,{page:this.props.params.page||1},"posts").then((e=>{this.update(e)}),(e=>{b.Z.apiError(e)}))}startPollingApi(){Fa.Z.start({poll:"thread-posts",url:this.props.thread.api.posts.index,data:{page:this.props.params.page||1},update:this.update,frequency:12e4,delayed:!0})}stopPollingApi(){Fa.Z.stop("thread-posts")}setPageTitle(){Ya.Z.set({title:this.props.thread.title,parent:this.props.thread.category.name,page:1*(this.props.params.page||1)})}render(){const e=this.props.thread.category;let t="page page-thread";e.css_class&&(t+=" page-thread-"+e.css_class);const s="private_threads"===e.special_role?"private-threads":e.css_class||"category-threads",a=dn(this.props.thread,this.props.user),i=cn(this.props.posts.results,this.props.user),o=this.props.posts.results.filter((e=>e.isSelected));return(0,r.Z)("div",{className:t},void 0,(0,r.Z)(ao,{styleName:s,thread:this.props.thread,posts:this.props.posts,user:this.props.user,moderation:a}),(0,r.Z)(Ga.Z,{},void 0,(0,r.Z)(R,{participants:this.props.participants,thread:this.props.thread,user:this.props.user}),(0,r.Z)(rn,{thread:this.props.thread,posts:this.props.posts,user:this.props.user,selection:o,moderation:i,pollDisabled:this.state.editPoll,onPoll:this.openPollForm,onReply:this.openReplyForm}),this.state.editPoll?(0,r.Z)(Ie,{poll:this.props.poll,thread:this.props.thread,close:this.closePollForm}):(0,r.Z)(Te,{poll:this.props.poll,thread:this.props.thread,user:this.props.user,edit:this.openPollForm}),this.props.thread.acl.can_reply?(0,r.Z)(Va.mv,{posting:{mode:"REPLY",thread:this.props.thread,config:this.props.thread.api.editor,submit:this.props.thread.api.posts.index}},void 0,c().createElement(Ua,this.props)):c().createElement(Ua,this.props),(0,r.Z)(an,{thread:this.props.thread,posts:this.props.posts,user:this.props.user,selection:o,moderation:i,onReply:this.openReplyForm})))}};const dn=(e,t)=>{const s={enabled:!1,edit:!1,approve:!1,close:!1,open:!1,hide:!1,unhide:!1,move:!1,merge:!1,pinGlobally:!1,pinLocally:!1,unpin:!1,delete:!1};return t.is_authenticated?(s.edit=e.acl.can_edit,s.approve=e.acl.can_approve&&e.is_unapproved,s.close=e.acl.can_close&&!e.is_closed,s.open=e.acl.can_close&&e.is_closed,s.hide=e.acl.can_hide&&!e.is_hidden,s.unhide=e.acl.can_unhide&&e.is_hidden,s.move=e.acl.can_move,s.merge=e.acl.can_merge,s.pinGlobally=e.acl.can_pin_globally&&e.weight<2,s.pinLocally=e.acl.can_pin&&1!==e.weight,s.unpin=e.acl.can_pin&&1===e.weight||e.acl.can_pin_globally&&2===e.weight,s.delete=e.acl.can_delete,s.enabled=s.edit||s.approve||s.close||s.open||s.hide||s.unhide||s.move||s.merge||s.pinGlobally||s.pinLocally||s.unpin||s.delete,s):s},cn=(e,t)=>{const s={enabled:!1,approve:!1,move:!1,merge:!1,protect:!1,hide:!1,delete:!1};return t.is_authenticated?(e.forEach((e=>{e.is_event||(e.acl.can_approve&&e.is_unapproved&&(s.approve=!0),e.acl.can_move&&(s.move=!0),e.acl.can_merge&&(s.merge=!0),(e.acl.can_protect||e.acl.can_unprotect)&&(s.protect=!0),(e.acl.can_hide||e.acl.can_unhide)&&(s.hide=!0),e.acl.can_delete&&(s.delete=!0),(s.approve||s.move||s.merge||s.protect||s.hide||s.delete)&&(s.enabled=!0))})),s):s};function pn(e){return{participants:e.participants,poll:e.poll,posts:e.posts,thread:e.thread,tick:e.tick.tick,user:e.auth.user}}function un(){const e=C.Z.get("THREAD"),t=e.url.index.replace(e.slug+"-"+e.pk,":slug");return[{path:t,component:(0,n.$j)(pn)(ln)},{path:t+":page/",component:(0,n.$j)(pn)(ln)}]}var hn=s(39633);C.Z.addInitializer({name:"component:thread",initializer:function(e){e.has("THREAD")&&e.has("POSTS")&&(0,hn.Z)({paths:un()})},after:"store"})},72168:function(e,t,s){"use strict";var a=s(37424),i=s(22928),o=s(4942),n=s(57588),r=s.n(n),l=s(82211);function d(e,t){return e.last_post>t.last_post?-1:e.last_post<t.last_post?1:0}function c(e,t){return 2===e.weight&&e.weight>t.weight?-1:2===t.weight&&e.weight<t.weight?1:d(e,t)}function p(e,t){return e.weight>t.weight?-1:e.weight<t.weight?1:d(e,t)}var u,h,m=s(59131),v=s(64646),g=s(92490),Z=s(69987),b=e=>{let{allItems:t,parentUrl:s,category:a,categories:o,list:n}=e;return(0,i.Z)("div",{className:"dropdown threads-category-picker"},void 0,(0,i.Z)("button",{type:"button",className:"btn btn-default btn-outline dropdown-toggle btn-block text-ellipsis","data-toggle":"dropdown","aria-haspopup":"true","aria-expanded":"false"},void 0,a&&(0,i.Z)("span",{className:"material-icon",style:{color:a.color||"inherit"}},void 0,"label"),a&&a.short_name&&(0,i.Z)("span",{className:a.short_name&&"hidden-md hidden-lg"},void 0,a.short_name),a?(0,i.Z)("span",{className:a.short_name&&"hidden-xs hidden-sm"},void 0,a.name):t),(0,i.Z)("ul",{className:"dropdown-menu"},void 0,(0,i.Z)("li",{},void 0,(0,i.Z)(Z.rU,{to:s+n.path},void 0,t)),u||(u=(0,i.Z)("li",{role:"separator",className:"divider"})),o.map((e=>(0,i.Z)("li",{},e.id,(0,i.Z)(Z.rU,{to:e.url.index+n.path},void 0,(0,i.Z)("span",{className:"material-icon",style:{color:e.color||"inherit"}},void 0,"label"),e.name))))))},f=e=>{let{baseUrl:t,list:s,lists:a}=e;return(0,i.Z)("div",{className:"dropdown threads-list-picker"},void 0,(0,i.Z)("button",{type:"button",className:"btn btn-default btn-outline dropdown-toggle btn-block","data-toggle":"dropdown","aria-haspopup":"true","aria-expanded":"false"},void 0,s.longName),(0,i.Z)("ul",{className:"dropdown-menu stick-to-bottom"},void 0,a.map((e=>(0,i.Z)("li",{},e.type,(0,i.Z)(Z.rU,{to:t+e.path},void 0,e.longName))))))},_=class extends r().Component{render(){return(0,i.Z)("div",{className:"modal-dialog",role:"document"},void 0,(0,i.Z)("div",{className:"modal-content"},void 0,(0,i.Z)("div",{className:"modal-header"},void 0,(0,i.Z)("button",{"aria-label":pgettext("modal","Close"),className:"close","data-dismiss":"modal",type:"button"},void 0,h||(h=(0,i.Z)("span",{"aria-hidden":"true"},void 0,"×"))),(0,i.Z)("h4",{className:"modal-title"},void 0,gettext("Threads moderation"))),(0,i.Z)("div",{className:"modal-body"},void 0,(0,i.Z)("p",{className:"lead"},void 0,gettext("One or more threads could not be deleted:")),(0,i.Z)("ul",{className:"list-unstyled list-errored-items"},void 0,this.props.errors.map((e=>(0,i.Z)(N,{errors:e.errors,thread:e.thread},e.thread.id)))))))}};function N(e){let{errors:t,thread:s}=e;return(0,i.Z)("li",{},void 0,(0,i.Z)("h5",{},void 0,s.title),t.map(((e,t)=>(0,i.Z)("p",{},void 0,e))))}var x,y,w,k,C,S,E,L,T,P,O,R,A,I,D,j,z,U,M,B,q,H,F,Y=s(43345),V=s(96359),G=s(57026),$=s(60471),W=s(32233),Q=s(61340),K=s(77751),J=s(52753),X=s(78657),ee=s(59801),te=s(53904),se=s(90287),ae=s(55210),ie=class extends Y.Z{constructor(e){super(e),(0,o.Z)(this,"getFormdata",(()=>({threads:this.props.threads.map((e=>e.id)),title:this.state.title,category:this.state.category,weight:this.state.weight,is_hidden:this.state.is_hidden,is_closed:this.state.is_closed}))),(0,o.Z)(this,"handleSuccess",(e=>{this.props.threads.forEach((e=>{this.props.freezeThread(e.id),this.props.deleteThread(e)})),se.Z.dispatch(K.YP()),this.props.addThreads([e]),se.Z.dispatch((0,Q.V8)(this.props.route.category,this.props.categoriesMap)),ee.Z.hide()})),(0,o.Z)(this,"handleError",(e=>{400===e.status?e.best_answers||e.polls?ee.Z.show((0,i.Z)(J.ZP,{api:W.Z.get("MERGE_THREADS_API"),bestAnswers:e.best_answers,data:this.getFormdata(),polls:e.polls,onError:this.handleError,onSuccess:this.handleSuccess})):(this.setState({errors:Object.assign({},this.state.errors,e)}),te.Z.error(gettext("Form contains errors."))):403===e.status&&Array.isArray(e)?ee.Z.show((0,i.Z)(_,{errors:e})):e.best_answer?te.Z.error(e.best_answer[0]):e.poll?te.Z.error(e.poll[0]):te.Z.apiError(e)})),(0,o.Z)(this,"onCategoryChange",(e=>{const t=e.target.value,s={category:t};this.acl[t].can_pin_threads<s.weight&&(s.weight=0),this.acl[t].can_hide_threads||(s.is_hidden=0),this.acl[t].can_close_threads||(s.is_closed=!1),this.setState(s)})),this.state={isLoading:!1,title:"",category:null,weight:0,is_hidden:0,is_closed:!1,validators:{title:[ae.C1()]},errors:{}},this.acl={};for(const t in e.user.acl.categories){if(!e.user.acl.categories.hasOwnProperty(t))continue;const s=e.user.acl.categories[t];this.acl[s.id]=s}this.categoryChoices=[],e.categories.forEach((e=>{if(e.level>0){const t=this.acl[e.id],s=!t.can_start_threads||e.is_closed&&!t.can_close_threads;this.categoryChoices.push({value:e.id,disabled:s,level:e.level-1,label:e.name}),s||this.state.category||(this.state.category=e.id)}})),this.isHiddenChoices=[{value:0,icon:"visibility",label:gettext("No")},{value:1,icon:"visibility_off",label:gettext("Yes")}],this.isClosedChoices=[{value:!1,icon:"lock_outline",label:gettext("No")},{value:!0,icon:"lock",label:gettext("Yes")}]}clean(){return!!this.isValid()||(te.Z.error(gettext("Form contains errors.")),this.setState({errors:this.validate()}),!1)}send(){return X.Z.post(W.Z.get("MERGE_THREADS_API"),this.getFormdata())}getWeightChoices(){const e=[{value:0,icon:"remove",label:gettext("Not pinned")},{value:1,icon:"bookmark_border",label:gettext("Pinned locally")}];return 2==this.acl[this.state.category].can_pin_threads&&e.push({value:2,icon:"bookmark",label:gettext("Pinned globally")}),e}renderWeightField(){return this.acl[this.state.category].can_pin_threads?(0,i.Z)(V.Z,{label:gettext("Thread weight"),for:"id_weight"},void 0,(0,i.Z)($.Z,{id:"id_weight",onChange:this.bindInput("weight"),value:this.state.weight,choices:this.getWeightChoices()})):null}renderHiddenField(){return this.acl[this.state.category].can_hide_threads?(0,i.Z)(V.Z,{label:gettext("Hide thread"),for:"id_is_hidden"},void 0,(0,i.Z)($.Z,{id:"id_is_closed",onChange:this.bindInput("is_hidden"),value:this.state.is_hidden,choices:this.isHiddenChoices})):null}renderClosedField(){return this.acl[this.state.category].can_close_threads?(0,i.Z)(V.Z,{label:gettext("Close thread"),for:"id_is_closed"},void 0,(0,i.Z)($.Z,{id:"id_is_closed",onChange:this.bindInput("is_closed"),value:this.state.is_closed,choices:this.isClosedChoices})):null}renderForm(){return(0,i.Z)("form",{onSubmit:this.handleSubmit},void 0,(0,i.Z)("div",{className:"modal-body"},void 0,(0,i.Z)(V.Z,{label:gettext("Thread title"),for:"id_title",validation:this.state.errors.title},void 0,(0,i.Z)("input",{id:"id_title",className:"form-control",type:"text",onChange:this.bindInput("title"),value:this.state.title})),x||(x=(0,i.Z)("div",{className:"clearfix"})),(0,i.Z)(V.Z,{label:gettext("Category"),for:"id_category",validation:this.state.errors.category},void 0,(0,i.Z)(G.Z,{id:"id_category",onChange:this.onCategoryChange,value:this.state.category,choices:this.categoryChoices})),y||(y=(0,i.Z)("div",{className:"clearfix"})),this.renderWeightField(),this.renderHiddenField(),this.renderClosedField()),(0,i.Z)("div",{className:"modal-footer"},void 0,(0,i.Z)("button",{className:"btn btn-default","data-dismiss":"modal",disabled:this.state.isLoading,type:"button"},void 0,gettext("Cancel")),(0,i.Z)(l.Z,{className:"btn-primary",loading:this.state.isLoading},void 0,gettext("Merge threads"))))}renderCantMergeMessage(){return(0,i.Z)("div",{className:"modal-body"},void 0,w||(w=(0,i.Z)("div",{className:"message-icon"},void 0,(0,i.Z)("span",{className:"material-icon"},void 0,"info_outline"))),(0,i.Z)("div",{className:"message-body"},void 0,(0,i.Z)("p",{className:"lead"},void 0,gettext("You can't move threads because there are no categories you are allowed to move them to.")),(0,i.Z)("p",{},void 0,gettext("You need permission to start threads in category to be able to merge threads to it.")),(0,i.Z)("button",{className:"btn btn-default","data-dismiss":"modal",type:"button"},void 0,gettext("Ok"))))}getClassName(){return this.state.category?"modal-dialog":"modal-dialog modal-message"}render(){return(0,i.Z)("div",{className:this.getClassName(),role:"document"},void 0,(0,i.Z)("div",{className:"modal-content"},void 0,(0,i.Z)("div",{className:"modal-header"},void 0,(0,i.Z)("button",{type:"button",className:"close","data-dismiss":"modal","aria-label":pgettext("modal","Close")},void 0,k||(k=(0,i.Z)("span",{"aria-hidden":"true"},void 0,"×"))),(0,i.Z)("h4",{className:"modal-title"},void 0,gettext("Merge threads"))),this.state.category?this.renderForm():this.renderCantMergeMessage()))}},oe=class extends Y.Z{constructor(e){super(e),(0,o.Z)(this,"handleSubmit",(e=>{e.preventDefault(),ee.Z.hide(),this.props.callApi([{op:"replace",path:"category",value:this.state.category},{op:"replace",path:"flatten-categories",value:null},{op:"add",path:"acl",value:!0}],gettext("Selected threads were moved."),(()=>{se.Z.dispatch((0,Q.V8)(this.props.route.category,this.props.categoriesMap));const e=se.Z.getState(),t=e.threads.map((e=>e.id));se.Z.dispatch(K.$6(e.selection.filter((e=>-1!==t.indexOf(e)))))}))})),this.state={category:null};const t={};for(const s in e.user.acl.categories){if(!e.user.acl.categories.hasOwnProperty(s))continue;const a=e.user.acl.categories[s];t[a.id]=a}this.categoryChoices=[],e.categories.forEach((e=>{if(e.level>0){const s=t[e.id],a=!s.can_start_threads||e.is_closed&&!s.can_close_threads;this.categoryChoices.push({value:e.id,disabled:a,level:e.level-1,label:e.name}),a||this.state.category||(this.state.category=e.id)}}))}getClassName(){return this.state.category?"modal-dialog":"modal-dialog modal-message"}renderForm(){return(0,i.Z)("form",{onSubmit:this.handleSubmit},void 0,(0,i.Z)("div",{className:"modal-body"},void 0,(0,i.Z)(V.Z,{label:gettext("New category"),for:"id_new_category"},void 0,(0,i.Z)(G.Z,{id:"id_new_category",onChange:this.bindInput("category"),value:this.state.category,choices:this.categoryChoices}))),(0,i.Z)("div",{className:"modal-footer"},void 0,(0,i.Z)("button",{className:"btn btn-default","data-dismiss":"modal",disabled:this.state.isLoading,type:"button"},void 0,gettext("Cancel")),(0,i.Z)("button",{className:"btn btn-primary"},void 0,gettext("Move threads"))))}renderCantMoveMessage(){return(0,i.Z)("div",{className:"modal-body"},void 0,C||(C=(0,i.Z)("div",{className:"message-icon"},void 0,(0,i.Z)("span",{className:"material-icon"},void 0,"info_outline"))),(0,i.Z)("div",{className:"message-body"},void 0,(0,i.Z)("p",{className:"lead"},void 0,gettext("You can't move threads because there are no categories you are allowed to move them to.")),(0,i.Z)("p",{},void 0,gettext("You need permission to start threads in category to be able to move threads to it.")),(0,i.Z)("button",{className:"btn btn-default","data-dismiss":"modal",type:"button"},void 0,gettext("Ok"))))}render(){return(0,i.Z)("div",{className:this.getClassName(),role:"document"},void 0,(0,i.Z)("div",{className:"modal-content"},void 0,(0,i.Z)("div",{className:"modal-header"},void 0,(0,i.Z)("button",{type:"button",className:"close","data-dismiss":"modal","aria-label":pgettext("modal","Close")},void 0,S||(S=(0,i.Z)("span",{"aria-hidden":"true"},void 0,"×"))),(0,i.Z)("h4",{className:"modal-title"},void 0,gettext("Move threads"))),this.state.category?this.renderForm():this.renderCantMoveMessage()))}},ne=class extends r().Component{constructor(){var e;super(...arguments),e=this,(0,o.Z)(this,"callApi",(function(t,s){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;e.props.threads.forEach((t=>{e.props.freezeThread(t.id)}));const o=e.props.threads.map((e=>e.id));t.push({op:"add",path:"acl",value:!0}),X.Z.patch(e.props.api,{ids:o,ops:t}).then((t=>{e.props.threads.forEach((t=>{e.props.freezeThread(t.id)})),t.forEach((t=>{e.props.updateThread(t)})),te.Z.success(s),a&&a()}),(t=>{if(e.props.threads.forEach((t=>{e.props.freezeThread(t.id)})),400!==t.status)return te.Z.apiError(t);let s=[],a={};e.props.threads.forEach((e=>{a[e.id]=e})),t.forEach((e=>{let{id:t,detail:i}=e;void 0!==a[t]&&s.push({errors:i,thread:a[t]})})),ee.Z.show((0,i.Z)(_,{errors:s}))}))})),(0,o.Z)(this,"pinGlobally",(()=>{this.callApi([{op:"replace",path:"weight",value:2}],gettext("Selected threads were pinned globally."))})),(0,o.Z)(this,"pinLocally",(()=>{this.callApi([{op:"replace",path:"weight",value:1}],gettext("Selected threads were pinned locally."))})),(0,o.Z)(this,"unpin",(()=>{this.callApi([{op:"replace",path:"weight",value:0}],gettext("Selected threads were unpinned."))})),(0,o.Z)(this,"approve",(()=>{this.callApi([{op:"replace",path:"is-unapproved",value:!1}],gettext("Selected threads were approved."))})),(0,o.Z)(this,"open",(()=>{this.callApi([{op:"replace",path:"is-closed",value:!1}],gettext("Selected threads were opened."))})),(0,o.Z)(this,"close",(()=>{this.callApi([{op:"replace",path:"is-closed",value:!0}],gettext("Selected threads were closed."))})),(0,o.Z)(this,"unhide",(()=>{this.callApi([{op:"replace",path:"is-hidden",value:!1}],gettext("Selected threads were unhidden."))})),(0,o.Z)(this,"hide",(()=>{this.callApi([{op:"replace",path:"is-hidden",value:!0}],gettext("Selected threads were hidden."))})),(0,o.Z)(this,"move",(()=>{ee.Z.show((0,i.Z)(oe,{callApi:this.callApi,categories:this.props.categories,categoriesMap:this.props.categoriesMap,route:this.props.route,user:this.props.user}))})),(0,o.Z)(this,"merge",(()=>{const e=[];if(this.props.threads.forEach((t=>{t.acl.can_merge||e.append({id:t.id,title:t.title,errors:[gettext("You don't have permission to merge this thread with others.")]})})),this.props.threads.length<2)te.Z.info(gettext("You have to select at least two threads to merge."));else{if(e.length)return void ee.Z.show((0,i.Z)(_,{errors:e}));ee.Z.show(r().createElement(ie,this.props))}})),(0,o.Z)(this,"delete",(()=>{if(!window.confirm(gettext("Are you sure you want to delete selected threads?")))return;this.props.threads.map((e=>{this.props.freezeThread(e.id)}));const e=this.props.threads.map((e=>e.id));X.Z.delete(this.props.api,e).then((()=>{this.props.threads.map((e=>{this.props.freezeThread(e.id),this.props.deleteThread(e)})),te.Z.success(gettext("Selected threads were deleted."))}),(e=>{if(400===e.status){const t=e.map((e=>e.id));this.props.threads.map((e=>{this.props.freezeThread(e.id),-1===t.indexOf(e.id)&&this.props.deleteThread(e)})),ee.Z.show((0,i.Z)(_,{errors:e}))}else te.Z.apiError(e)}))}))}render(){const{moderation:e,threads:t}=this.props,s=0==this.props.selection.length;return(0,i.Z)("ul",{className:"dropdown-menu dropdown-menu-right stick-to-bottom"},void 0,(0,i.Z)("li",{},void 0,(0,i.Z)("button",{className:"btn btn-link",type:"button",onClick:()=>se.Z.dispatch(K.$6(t.map((e=>e.id))))},void 0,E||(E=(0,i.Z)("span",{className:"material-icon"},void 0,"check_box")),gettext("Select all"))),(0,i.Z)("li",{},void 0,(0,i.Z)("button",{className:"btn btn-link",type:"button",disabled:s,onClick:()=>se.Z.dispatch(K.YP())},void 0,L||(L=(0,i.Z)("span",{className:"material-icon"},void 0,"check_box_outline_blank")),gettext("Select none"))),T||(T=(0,i.Z)("li",{role:"separator",className:"divider"})),!!e.can_pin_globally&&(0,i.Z)("li",{},void 0,(0,i.Z)("button",{className:"btn btn-link",type:"button",disabled:s,onClick:this.pinGlobally},void 0,P||(P=(0,i.Z)("span",{className:"material-icon"},void 0,"bookmark")),gettext("Pin threads globally"))),!!e.can_pin&&(0,i.Z)("li",{},void 0,(0,i.Z)("button",{className:"btn btn-link",type:"button",disabled:s,onClick:this.pinLocally},void 0,O||(O=(0,i.Z)("span",{className:"material-icon"},void 0,"bookmark_border")),gettext("Pin threads locally"))),!!e.can_pin&&(0,i.Z)("li",{},void 0,(0,i.Z)("button",{className:"btn btn-link",type:"button",disabled:s,onClick:this.unpin},void 0,R||(R=(0,i.Z)("span",{className:"material-icon"},void 0,"panorama_fish_eye")),gettext("Unpin threads"))),!!e.can_move&&(0,i.Z)("li",{},void 0,(0,i.Z)("button",{className:"btn btn-link",type:"button",disabled:s,onClick:this.move},void 0,A||(A=(0,i.Z)("span",{className:"material-icon"},void 0,"arrow_forward")),gettext("Move threads"))),!!e.can_merge&&(0,i.Z)("li",{},void 0,(0,i.Z)("button",{className:"btn btn-link",type:"button",disabled:s,onClick:this.merge},void 0,I||(I=(0,i.Z)("span",{className:"material-icon"},void 0,"call_merge")),gettext("Merge threads"))),!!e.can_approve&&(0,i.Z)("li",{},void 0,(0,i.Z)("button",{className:"btn btn-link",type:"button",disabled:s,onClick:this.approve},void 0,D||(D=(0,i.Z)("span",{className:"material-icon"},void 0,"done")),gettext("Approve threads"))),!!e.can_close&&(0,i.Z)("li",{},void 0,(0,i.Z)("button",{className:"btn btn-link",type:"button",disabled:s,onClick:this.open},void 0,j||(j=(0,i.Z)("span",{className:"material-icon"},void 0,"lock_open")),gettext("Open threads"))),!!e.can_close&&(0,i.Z)("li",{},void 0,(0,i.Z)("button",{className:"btn btn-link",type:"button",disabled:s,onClick:this.close},void 0,z||(z=(0,i.Z)("span",{className:"material-icon"},void 0,"lock_outline")),gettext("Close threads"))),!!e.can_unhide&&(0,i.Z)("li",{},void 0,(0,i.Z)("button",{className:"btn btn-link",type:"button",disabled:s,onClick:this.unhide},void 0,U||(U=(0,i.Z)("span",{className:"material-icon"},void 0,"visibility")),gettext("Unhide threads"))),!!e.can_hide&&(0,i.Z)("li",{},void 0,(0,i.Z)("button",{className:"btn btn-link",type:"button",disabled:s,onClick:this.hide},void 0,M||(M=(0,i.Z)("span",{className:"material-icon"},void 0,"visibility_off")),gettext("Hide threads"))),!!e.can_delete&&(0,i.Z)("li",{},void 0,(0,i.Z)("button",{className:"btn btn-link",type:"button",disabled:s,onClick:this.delete},void 0,B||(B=(0,i.Z)("span",{className:"material-icon"},void 0,"clear")),gettext("Delete threads"))))}},re=e=>{let{api:t,categoriesMap:s,categories:a,threads:o,addThreads:n,freezeThread:r,updateThread:l,deleteThread:d,selection:c,moderation:p,route:u,user:h,disabled:m}=e;return(0,i.Z)("div",{className:"dropdown threads-moderation"},void 0,(0,i.Z)("button",{type:"button",className:"btn btn-default btn-outline btn-icon dropdown-toggle",title:gettext("Moderation"),"data-toggle":"dropdown","aria-haspopup":"true","aria-expanded":"false",disabled:m},void 0,q||(q=(0,i.Z)("span",{className:"material-icon"},void 0,"settings"))),(0,i.Z)(ne,{api:t,categories:a,categoriesMap:s,threads:o,addThreads:n,freezeThread:r,updateThread:l,deleteThread:d,selection:c,moderation:p,route:u,user:h,disabled:m}))},le=e=>{let{api:t,baseUrl:s,category:a,categories:o,categoriesMap:n,topCategory:r,topCategories:d,subCategory:c,subCategories:p,list:u,lists:h,threads:m,addThreads:Z,startThread:_,freezeThread:N,updateThread:x,deleteThread:y,selection:w,moderation:k,route:C,user:S,disabled:E}=e;return(0,i.Z)(g.o8,{},void 0,d.length>0&&(0,i.Z)(g.Z2,{},void 0,(0,i.Z)(g.Eg,{},void 0,(0,i.Z)(b,{allItems:gettext("All categories"),parentUrl:u.path,category:r,categories:d,list:u})),r&&p.length>0&&(0,i.Z)(g.Eg,{},void 0,(0,i.Z)(b,{allItems:gettext("All subcategories"),parentUrl:r.url.index,category:c,categories:p,list:u}))),h.length>1&&(0,i.Z)(g.Z2,{className:"hidden-xs"},void 0,(0,i.Z)(g.Eg,{},void 0,(0,i.Z)(f,{baseUrl:s,list:u,lists:h}))),H||(H=(0,i.Z)(g.tw,{})),!!S.id&&(0,i.Z)(g.Z2,{},void 0,(0,i.Z)(g.Eg,{},void 0,(0,i.Z)(l.Z,{className:"btn-primary btn-outline btn-block",disabled:E,onClick:()=>{v.Z.open(_||{mode:"START",config:misago.get("THREAD_EDITOR_API"),submit:misago.get("THREADS_API"),category:a.id})}},void 0,F||(F=(0,i.Z)("span",{className:"material-icon"},void 0,"chat")),gettext("Start thread"))),!!k.allow&&(0,i.Z)(g.Eg,{shrink:!0},void 0,(0,i.Z)(re,{api:t,categories:o,categoriesMap:n,threads:m.filter((e=>-1!==w.indexOf(e.id))),addThreads:Z,freezeThread:N,updateThread:x,deleteThread:y,selection:w,moderation:k,route:C,user:S,disabled:E}))))},de=class extends r().Component{render(){const{root:e}=this.props,{category:t,categories:s,categoriesMap:a}=this.props.route,o=ce(e,t,a);return(0,i.Z)(m.Z,{},void 0,(0,i.Z)(le,{api:this.props.api,baseUrl:t.url.index,category:t,categories:s,categoriesMap:a,topCategory:o,topCategories:s.filter((t=>t.parent===e.id)),subCategories:o?s.filter((e=>e.parent===o.id)):[],subCategory:2===t.level?t:null,subcategories:this.props.subcategories,list:this.props.route.list,lists:this.props.route.lists,threads:this.props.threads,addThreads:this.props.addThreads,startThread:this.props.startThread,freezeThread:this.props.freezeThread,deleteThread:this.props.deleteThread,updateThread:this.props.updateThread,selection:this.props.selection,moderation:this.props.moderation,route:this.props.route,user:this.props.user,disabled:!this.props.isLoaded||this.props.isBusy||this.props.busyThreads.length}),this.props.children)}};const ce=(e,t,s)=>t.parent?t.parent===e.id?t:s[t.parent]:null;function pe(e,t){let s={};return e.forEach((function(e){s[e.id]=e})),t.filter((function(e){return!s[e.id]||function(e,t){return[e.title===t.title,e.weight===t.weight,e.category===t.category,e.last_post===t.last_post,e.last_poster_name===t.last_poster_name].indexOf(!1)>=0}(s[e.id],e)}))}function ue(e){let t={allow:!1,can_approve:0,can_close:0,can_delete:0,can_hide:0,can_merge:0,can_move:0,can_pin:0,can_pin_globally:0,can_unhide:0};return e.forEach((function(e){e.is_unapproved&&e.acl.can_approve>t.can_approve&&(t.can_approve=e.acl.can_approve),e.acl.can_close>t.can_close&&(t.can_close=e.acl.can_close),e.acl.can_delete>t.can_delete&&(t.can_delete=e.acl.can_delete),e.acl.can_hide>t.can_hide&&(t.can_hide=e.acl.can_hide),e.acl.can_merge>t.can_merge&&(t.can_merge=e.acl.can_merge),e.acl.can_move>t.can_move&&(t.can_move=e.acl.can_move),e.acl.can_pin>t.can_pin&&(t.can_pin=e.acl.can_pin),e.acl.can_pin_globally>t.can_pin_globally&&(t.can_pin_globally=e.acl.can_pin_globally),e.is_hidden&&e.acl.can_unhide>t.can_unhide&&(t.can_unhide=e.acl.can_unhide),t.allow=t.can_approve||t.can_close||t.can_delete||t.can_hide||t.can_merge||t.can_move||t.can_pin||t.can_pin_globally||t.can_unhide})),t}var he=e=>{let{category:t,list:s,message:a}=e;return"all"===s.type?a?(0,i.Z)("li",{className:"list-group-item empty-message"},void 0,(0,i.Z)("p",{className:"lead"},void 0,a),(0,i.Z)("p",{},void 0,gettext("Why not start one yourself?"))):(0,i.Z)("li",{className:"list-group-item empty-message"},void 0,(0,i.Z)("p",{className:"lead"},void 0,t.special_role?gettext("There are no threads on this forum... yet!"):gettext("There are no threads in this category.")),(0,i.Z)("p",{},void 0,gettext("Why not start one yourself?"))):(0,i.Z)("li",{className:"list-group-item empty-message"},void 0,(0,i.Z)("p",{className:"lead"},void 0,gettext("No threads matching specified criteria were found.")))},me=s(50366),ve=s(16768),ge=e=>{let{thread:t}=e;return(0,i.Z)("a",{href:t.url.last_post,className:"threads-list-item-last-activity",title:interpolate(gettext("Last activity: %(timestamp)s"),{timestamp:t.last_post_on.format("LLL")},!0)},void 0,t.last_post_on.fromNow(!0))};const Ze=e=>{let t="threads-list-item-category threads-list-category-label";return e.color&&(t+=" threads-list-category-label-color"),t};var be,fe,_e,Ne,xe=e=>{let{parent:t,category:s}=e;return(0,i.Z)("span",{},void 0,t&&(0,i.Z)("a",{href:t.url.index,className:Ze(t)+" threads-list-item-parent-category",style:t.color?{"--label-color":t.color}:null,title:t.short_name?t.name:null},void 0,t.short_name||t.name),(0,i.Z)("a",{href:s.url.index,className:Ze(s),style:s.color?{"--label-color":s.color}:null,title:s.short_name?s.name:null},void 0,s.short_name||s.name))},ye=e=>{let{checked:t,disabled:s,thread:a}=e;return(0,i.Z)("button",{className:"btn btn-default btn-icon",type:"button",disabled:s,onClick:()=>se.Z.dispatch(K.wc(a.id))},void 0,(0,i.Z)("span",{className:"material-icon"},void 0,t?"check_box":"check_box_outline_blank"))},we=e=>{let{thread:t}=e,s="threads-list-icon";return t.is_read||(s+=" threads-list-icon-new"),(0,i.Z)("a",{title:t.is_read?gettext("No new posts"):gettext("New posts"),href:t.is_read?t.url.last_post:t.url.new_post,className:s},void 0,(0,i.Z)("span",{className:"material-icon"},void 0,t.is_read?"chat_bubble_outline":"chat_bubble"))},ke=s(19605),Ce=e=>{let{thread:t}=e;return t.last_poster?(0,i.Z)("a",{href:t.url.last_poster,className:"threads-list-item-last-poster",title:interpolate(gettext("Last post by: %(poster)s"),{poster:t.last_poster.username},!0)},void 0,(0,i.Z)(ke.ZP,{size:32,user:t.last_poster})):(0,i.Z)("span",{className:"threads-list-item-last-poster",title:interpolate(gettext("Last post by: %(poster)s"),{poster:t.last_poster_name},!0)},void 0,be||(be=(0,i.Z)(ke.ZP,{size:32})))};const Se={unsubscribe:null,notify:!1,email:!0};class Ee extends r().Component{constructor(e){super(e),(0,o.Z)(this,"update",(e=>{const{thread:t}=this.props;this.setState({loading:!0}),se.Z.dispatch((0,Q.r$)(t,{subscription:Se[e]})),X.Z.patch(t.api.index,[{op:"replace",path:"subscription",value:e}]).then((()=>{}),(e=>{se.Z.dispatch((0,Q.r$)(t,{subscription:Se[t.subscription]})),te.Z.apiError(e)})).then((()=>this.setState({loading:!1})))})),(0,o.Z)(this,"render",(()=>{const{loading:e}=this.state,{disabled:t,thread:s}=this.props;return(0,i.Z)("ul",{className:"dropdown-menu dropdown-menu-right"},void 0,(0,i.Z)("li",{},void 0,(0,i.Z)("button",{className:"btn-link",disabled:t||e||null===s.subscription,onClick:()=>this.update("unsubscribe")},void 0,fe||(fe=(0,i.Z)("span",{className:"material-icon"},void 0,"star_border")),gettext("Unsubscribe"))),(0,i.Z)("li",{},void 0,(0,i.Z)("button",{className:"btn-link",disabled:t||e||!1===s.subscription,onClick:()=>this.update("notify")},void 0,_e||(_e=(0,i.Z)("span",{className:"material-icon"},void 0,"star_half")),gettext("Subscribe with alert"))),(0,i.Z)("li",{},void 0,(0,i.Z)("button",{className:"btn-link",disabled:t||e||!0===s.subscription,onClick:()=>this.update("email")},void 0,Ne||(Ne=(0,i.Z)("span",{className:"material-icon"},void 0,"star")),gettext("Subscribe with e-mail"))))})),this.state={loading:!1}}}var Le=Ee;var Te,Pe,Oe,Re,Ae,Ie,De,je,ze,Ue,Me,Be=e=>{let{disabled:t,thread:s}=e;return(0,i.Z)("div",{className:"dropdown"},void 0,(0,i.Z)("button",{className:"btn btn-default btn-icon",type:"button",title:(a=s.subscription,!0===a?gettext("Subscribed to e-mails"):!1===a?gettext("Subscribed to alerts"):gettext("Not subscribed")),disabled:t,"data-toggle":"dropdown","aria-haspopup":"true","aria-expanded":"false"},void 0,(0,i.Z)("span",{className:"material-icon"},void 0,(e=>!0===e?"star":!1===e?"star_half":"star_border")(s.subscription))),(0,i.Z)(Le,{disabled:t,thread:s}));var a},qe=e=>{let{activeCategory:t,categories:s,showOptions:a,showSubscription:o,thread:n,isBusy:r,isSelected:l}=e,d=null,c=null;t.id!==n.category&&(c=s[n.category],c.parent&&c.parent!==t.id&&s[c.parent]&&!s[c.parent].special_role&&(d=s[c.parent]));const p=n.is_closed||n.is_hidden||n.is_unapproved||n.weight>0||n.best_answer||n.has_poll||n.has_unapproved_posts,u=!!a&&n.is_new;return(0,i.Z)("li",{className:"list-group-item threads-list-item"+(r?" threads-list-item-is-busy":"")},void 0,(0,i.Z)("div",{className:"threads-list-item-top-row"},void 0,a&&(0,i.Z)("div",{className:"threads-list-item-col-icon"},void 0,(0,i.Z)(we,{thread:n})),(0,i.Z)("div",{className:"threads-list-item-col-title"},void 0,(0,i.Z)("a",{href:n.url.index,className:"threads-list-item-title"},void 0,n.title),(0,i.Z)("a",{href:u?n.url.new_post:n.url.index,className:"threads-list-item-title-sm"+(u?" threads-list-item-title-new":"")},void 0,n.title)),a&&n.moderation.length>0&&(0,i.Z)("div",{className:"threads-list-item-col-checkbox-sm"},void 0,(0,i.Z)(ye,{checked:l,disabled:r,thread:n}))),(0,i.Z)("div",{className:"threads-list-item-bottom-row"},void 0,p&&(0,i.Z)("div",{className:"threads-list-item-col-flags"},void 0,(0,i.Z)(me.Z,{thread:n})),!!c&&(0,i.Z)("div",{className:"threads-list-item-col-category"},void 0,(0,i.Z)(xe,{parent:d,category:c})),Te||(Te=(0,i.Z)("div",{className:"threads-list-item-col-spacer-xs"})),(0,i.Z)("div",{className:"threads-list-item-col-replies"},void 0,(0,i.Z)(ve.Z,{thread:n})),(0,i.Z)("div",{className:"threads-list-item-col-last-poster"},void 0,(0,i.Z)(Ce,{thread:n})),(0,i.Z)("div",{className:"threads-list-item-col-last-activity"},void 0,(0,i.Z)(ge,{thread:n})),a&&o&&(0,i.Z)("div",{className:"threads-list-item-col-subscription"},void 0,(0,i.Z)(Be,{disabled:r,thread:n})),a&&n.moderation.length>0&&(0,i.Z)("div",{className:"threads-list-item-col-checkbox"},void 0,(0,i.Z)(ye,{checked:l,disabled:r,thread:n}))))},He=e=>{let{width:t}=e;return(0,i.Z)("span",{className:"ui-preview-text",style:{width:t+"px"}},void 0," ")},Fe=e=>{let{showOptions:t}=e;return(0,i.Z)("div",{className:"threads-list threads-list-loader"},void 0,(0,i.Z)("ul",{className:"list-group"},void 0,(0,i.Z)("li",{className:"list-group-item threads-list-item"},void 0,(0,i.Z)("div",{className:"threads-list-item-top-row"},void 0,t&&(Pe||(Pe=(0,i.Z)("div",{className:"threads-list-item-col-icon"},void 0,(0,i.Z)("span",{className:"threads-list-icon ui-preview-img"})))),Oe||(Oe=(0,i.Z)("div",{className:"threads-list-item-col-title"},void 0,(0,i.Z)("span",{className:"threads-list-item-title"},void 0,(0,i.Z)(He,{width:"90"})," ",(0,i.Z)(He,{width:"40"})," ",(0,i.Z)(He,{width:"120"})),(0,i.Z)("span",{className:"threads-list-item-title-sm"},void 0,(0,i.Z)(He,{width:"90"})," ",(0,i.Z)(He,{width:"40"})," ",(0,i.Z)(He,{width:"120"}))))),Re||(Re=(0,i.Z)("div",{className:"threads-list-item-bottom-row"},void 0,(0,i.Z)("div",{className:"threads-list-item-col-category"},void 0,(0,i.Z)(He,{width:"70"})),(0,i.Z)("div",{className:"threads-list-item-col-replies"},void 0,(0,i.Z)(He,{width:"50"})),(0,i.Z)("div",{className:"threads-list-item-col-last-poster"},void 0,(0,i.Z)("span",{className:"threads-list-item-last-poster"},void 0,(0,i.Z)(ke.ZP,{size:32}))),(0,i.Z)("div",{className:"threads-list-item-col-last-activity"},void 0,(0,i.Z)("span",{className:"threads-list-item-last-activity"},void 0,(0,i.Z)(He,{width:"50"})))))),(0,i.Z)("li",{className:"list-group-item threads-list-item"},void 0,(0,i.Z)("div",{className:"threads-list-item-top-row"},void 0,t&&(Ae||(Ae=(0,i.Z)("div",{className:"threads-list-item-col-icon"},void 0,(0,i.Z)("span",{className:"threads-list-icon ui-preview-img"})))),Ie||(Ie=(0,i.Z)("div",{className:"threads-list-item-col-title"},void 0,(0,i.Z)("span",{className:"threads-list-item-title"},void 0,(0,i.Z)(He,{width:"120"})," ",(0,i.Z)(He,{width:"30"})," ",(0,i.Z)(He,{width:"60"})),(0,i.Z)("span",{className:"threads-list-item-title-sm"},void 0,(0,i.Z)(He,{width:"120"})," ",(0,i.Z)(He,{width:"30"})," ",(0,i.Z)(He,{width:"60"}))))),De||(De=(0,i.Z)("div",{className:"threads-list-item-bottom-row"},void 0,(0,i.Z)("div",{className:"threads-list-item-col-category"},void 0,(0,i.Z)(He,{width:"55"})),(0,i.Z)("div",{className:"threads-list-item-col-replies"},void 0,(0,i.Z)(He,{width:"60"})),(0,i.Z)("div",{className:"threads-list-item-col-last-poster"},void 0,(0,i.Z)("span",{className:"threads-list-item-last-poster"},void 0,(0,i.Z)(ke.ZP,{size:32}))),(0,i.Z)("div",{className:"threads-list-item-col-last-activity"},void 0,(0,i.Z)("span",{className:"threads-list-item-last-activity"},void 0,(0,i.Z)(He,{width:"70"})))))),(0,i.Z)("li",{className:"list-group-item threads-list-item"},void 0,(0,i.Z)("div",{className:"threads-list-item-top-row"},void 0,t&&(je||(je=(0,i.Z)("div",{className:"threads-list-item-col-icon"},void 0,(0,i.Z)("span",{className:"threads-list-icon ui-preview-img"})))),ze||(ze=(0,i.Z)("div",{className:"threads-list-item-col-title"},void 0,(0,i.Z)("span",{className:"threads-list-item-title"},void 0,(0,i.Z)(He,{width:"40"})," ",(0,i.Z)(He,{width:"120"})," ",(0,i.Z)(He,{width:"80"})),(0,i.Z)("span",{className:"threads-list-item-title-sm"},void 0,(0,i.Z)(He,{width:"40"})," ",(0,i.Z)(He,{width:"120"})," ",(0,i.Z)(He,{width:"80"}))))),Ue||(Ue=(0,i.Z)("div",{className:"threads-list-item-bottom-row"},void 0,(0,i.Z)("div",{className:"threads-list-item-col-category"},void 0,(0,i.Z)(He,{width:"75"})),(0,i.Z)("div",{className:"threads-list-item-col-replies"},void 0,(0,i.Z)(He,{width:"40"})),(0,i.Z)("div",{className:"threads-list-item-col-last-poster"},void 0,(0,i.Z)("span",{className:"threads-list-item-last-poster"},void 0,(0,i.Z)(ke.ZP,{size:32}))),(0,i.Z)("div",{className:"threads-list-item-col-last-activity"},void 0,(0,i.Z)("span",{className:"threads-list-item-last-activity"},void 0,(0,i.Z)(He,{width:"60"}))))))))},Ye=e=>{let{threads:t,onClick:s}=e;return(0,i.Z)("li",{className:"list-group-item threads-list-update-prompt"},void 0,(0,i.Z)("button",{type:"button",className:"btn btn-block threads-list-update-prompt-btn",onClick:s},void 0,Me||(Me=(0,i.Z)("span",{className:"material-icon"},void 0,"cached")),(0,i.Z)("span",{className:"threads-list-update-prompt-message"},void 0,interpolate(ngettext("There is %(threads)s new or updated thread. Click here to show it.","There are %(threads)s new or updated threads. Click here to show them.",t),{threads:t},!0))))},Ve=e=>{let{list:t,categories:s,category:a,threads:o,busyThreads:n,selection:r,isLoaded:l,showOptions:d,updatedThreads:c,applyUpdate:p,emptyMessage:u}=e;return l?(0,i.Z)("div",{className:"threads-list"},void 0,o.length>0?(0,i.Z)("ul",{className:"list-group"},void 0,c>0&&(0,i.Z)(Ye,{threads:c,onClick:p}),o.map((e=>(0,i.Z)(qe,{activeCategory:a,categories:s,thread:e,showOptions:d,showSubscription:d&&"subscribed"===t.type,isBusy:n.indexOf(e.id)>=0,isSelected:r.indexOf(e.id)>=0},e.id)))):(0,i.Z)("ul",{className:"list-group"},void 0,c>0&&(0,i.Z)(Ye,{threads:c,onClick:p}),(0,i.Z)(he,{category:a,list:t,message:u}))):(0,i.Z)(Fe,{showOptions:d})},Ge=s(82125),$e=s(55547),We=s(53328),Qe=s(20370),Ke=s(99755),Je=class extends Ge.Z{constructor(e){super(e),(0,o.Z)(this,"loadMore",(()=>{this.setState({isBusy:!0}),this.loadThreads(this.getCategory(),this.state.next)})),(0,o.Z)(this,"pollResponse",(e=>{this.setState({diff:Object.assign({},e,{results:pe(this.props.threads,e.results)})})})),(0,o.Z)(this,"addThreads",(e=>{se.Z.dispatch((0,Q.R3)(e,this.getSorting()))})),(0,o.Z)(this,"applyDiff",(()=>{this.addThreads(this.state.diff.results),this.setState(Object.assign({},this.state.diff,{moderation:ue(se.Z.getState().threads),diff:{results:[]}}))})),(0,o.Z)(this,"freezeThread",(e=>{this.setState((function(t){return{busyThreads:Qe.ZN(t.busyThreads,e)}}))})),(0,o.Z)(this,"updateThread",(e=>{se.Z.dispatch((0,Q.r$)(e,e,this.getSorting()))})),(0,o.Z)(this,"deleteThread",(e=>{se.Z.dispatch((0,Q.l8)(e))})),this.state={isMounted:!0,isLoaded:!1,isBusy:!1,diff:{results:[]},moderation:[],busyThreads:[],dropdown:!1,subcategories:[],next:0};let t=this.getCategory();W.Z.has("THREADS")?this.initWithPreloadedData(t,W.Z.get("THREADS")):this.initWithoutPreloadedData(t)}getCategory(){return this.props.route.category.special_role?null:this.props.route.category.id}initWithPreloadedData(e,t){this.state=Object.assign(this.state,{moderation:ue(t.results),subcategories:t.subcategories,next:t.next}),this.startPolling(e)}initWithoutPreloadedData(e){this.loadThreads(e)}loadThreads(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;X.Z.get(this.props.options.api,{category:e,list:this.props.route.list.type,start:t||0},"threads").then((s=>{this.state.isMounted&&(0===t?se.Z.dispatch((0,Q.ZB)(s.results)):se.Z.dispatch((0,Q.R3)(s.results,this.getSorting())),this.setState({isLoaded:!0,isBusy:!1,moderation:ue(se.Z.getState().threads),subcategories:s.subcategories,next:s.next}),this.startPolling(e))}),(e=>{te.Z.apiError(e)}))}startPolling(e){$e.Z.start({poll:"threads",url:this.props.options.api,data:{category:e,list:this.props.route.list.type},frequency:12e4,update:this.pollResponse})}componentDidMount(){this.setPageTitle(),W.Z.has("THREADS")&&(se.Z.dispatch((0,Q.ZB)(W.Z.pop("THREADS").results)),this.setState({isLoaded:!0})),se.Z.dispatch(K.YP())}componentWillUnmount(){this.state.isMounted=!1,$e.Z.stop("threads")}getTitle(){return this.props.options.title?this.props.options.title:function(e){return e.category.level?e.category.name:W.Z.get("THREADS_ON_INDEX")?W.Z.get("SETTINGS").index_header?W.Z.get("SETTINGS").index_header:W.Z.get("SETTINGS").forum_name:gettext("Threads")}(this.props.route)}setPageTitle(){this.props.route.category.level||!W.Z.get("THREADS_ON_INDEX")?We.Z.set(function(e){return e.category.level?e.list.path?{title:e.list.longName,parent:e.category.name}:{title:e.category.name}:W.Z.get("THREADS_ON_INDEX")?e.list.path?{title:e.list.longName}:null:e.list.path?{title:e.list.longName,parent:gettext("Threads")}:{title:gettext("Threads")}}(this.props.route)):this.props.options.title?We.Z.set(this.props.options.title):W.Z.get("SETTINGS").index_title?document.title=W.Z.get("SETTINGS").index_title:document.title=W.Z.get("SETTINGS").forum_name}getSorting(){return this.props.route.category.level?p:c}getMoreButton(){return this.state.next?(0,i.Z)("div",{className:"pager-more"},void 0,(0,i.Z)(l.Z,{className:"btn btn-default btn-outline",loading:this.state.isBusy||this.state.busyThreads.length,onClick:this.loadMore},void 0,gettext("Show more"))):null}getClassName(){let e="page page-threads";var t;return e+=" page-threads-"+this.props.route.list.type,(t=this.props).route.category.level||!W.Z.get("THREADS_ON_INDEX")||t.options.title||(e+=" page-threads-index"),this.props.route.category.css_class&&(e+=" page-threads-"+this.props.route.category.css_class),e}render(){const e=this.props.route.categories[0],{category:t,list:s}=this.props.route,a=t.special_role;return(0,i.Z)("div",{className:this.getClassName()},void 0,"root_category"==a&&W.Z.get("THREADS_ON_INDEX")&&W.Z.get("SETTINGS").index_header&&(0,i.Z)(Ke.Iv,{header:W.Z.get("SETTINGS").index_header,message:t.description&&(0,i.Z)(Ke.Ql,{message:t.description.html}),styleName:"forum-index"}),"root_category"==a&&!W.Z.get("THREADS_ON_INDEX")&&(0,i.Z)(Ke.Iv,{header:gettext("Threads"),styleName:"threads"}),"private_threads"==a&&(0,i.Z)(Ke.Iv,{header:this.props.options.title,message:this.props.options.pageLead&&(0,i.Z)(Ke.bM,{},void 0,(0,i.Z)("p",{},void 0,this.props.options.pageLead)),styleName:"private-threads"}),!a&&(0,i.Z)(Ke.Iv,{header:t.name,message:t.description&&(0,i.Z)(Ke.Ql,{message:t.description.html}),styleName:t.css_class||"category-threads"}),(0,i.Z)(de,{api:this.props.options.api,root:e,route:this.props.route,user:this.props.user,pageLead:this.props.options.pageLead,threads:this.props.threads,threadsCount:this.state.count,moderation:this.state.moderation,selection:this.props.selection,busyThreads:this.state.busyThreads,addThreads:this.addThreads,startThread:this.props.options.startThread,freezeThread:this.freezeThread,deleteThread:this.deleteThread,updateThread:this.updateThread,isLoaded:this.state.isLoaded,isBusy:this.state.isBusy},void 0,(0,i.Z)(Ve,{category:t,categories:this.props.route.categoriesMap,list:s,selection:this.props.selection,threads:this.props.threads,updatedThreads:this.state.diff.results.length,applyUpdate:this.applyDiff,showOptions:!!this.props.user.id,isLoaded:this.state.isLoaded,busyThreads:this.state.busyThreads,emptyMessage:this.props.options.emptyMessage}),this.getMoreButton()))}};function Xe(e,t){let s=function(e){let t=[{type:"all",path:"",name:gettext("All"),longName:gettext("All threads")}];return e.id&&(t.push({type:"my",path:"my/",name:gettext("My"),longName:gettext("My threads")}),t.push({type:"new",path:"new/",name:gettext("New"),longName:gettext("New threads")}),t.push({type:"unread",path:"unread/",name:gettext("Unread"),longName:gettext("Unread threads")}),t.push({type:"subscribed",path:"subscribed/",name:gettext("Subscribed"),longName:gettext("Subscribed threads")}),e.acl.can_see_unapproved_content_lists&&t.push({type:"unapproved",path:"unapproved/",name:gettext("Unapproved"),longName:gettext("Unapproved content")})),t}(e),i=[],o={};return W.Z.get("CATEGORIES").forEach((function(e){s.forEach((function(n){var r;o[e.id]=e,i.push({path:e.url.index+n.path,component:(0,a.$j)((r=t,function(e){return{options:r,selection:e.selection,threads:e.threads,tick:e.tick.tick,user:e.auth.user}}))(Je),categories:W.Z.get("CATEGORIES"),categoriesMap:o,category:e,lists:s,list:n})}))})),i}var et=s(39633);const tt="misago:private-threads";function st(e){return e.get("CURRENT_LINK").substr(0,tt.length)===tt?{api:e.get("PRIVATE_THREADS_API"),startThread:{mode:"START_PRIVATE",submit:W.Z.get("PRIVATE_THREADS_API")},title:gettext("Private threads"),pageLead:gettext("Private threads are threads which only those that started them and those they have invited may see and participate in."),emptyMessage:gettext("You aren't participating in any private threads.")}:{api:e.get("THREADS_API")}}W.Z.addInitializer({name:"component:threads",initializer:function(e){e.has("THREADS")&&e.has("CATEGORIES")&&(0,et.Z)({paths:Xe(e.get("user"),st(e))})},after:"store"})},47806:function(e,t,s){"use strict";var a=s(37424),i=s(32233),o=s(22928),n=s(57588),r=s.n(n),l=s(19605),d=s(4942),c=s(78657),p=s(53904);function u(e){return e.filter((e=>e.results.count>0)).map((e=>Object.assign({},e,{count:e.results.count,results:e.results.results.slice(0,5)})))}var h=s(87462);const m="HEADER",v="RESULT",g="FOOTER";function Z(e){let{value:t,onChange:s}=e;return(0,o.Z)("input",{"aria-haspopup":"true","aria-expanded":"false","aria-controls":"dropdown-menu dropdown-search-results",autoComplete:"off",className:"form-control",value:t,onChange:s,placeholder:gettext("Search"),role:"combobox",type:"text"})}function b(e){let{children:t,onChange:s,query:a}=e;return(0,o.Z)("ul",{className:"dropdown-menu dropdown-search-results",role:"menu"},void 0,(0,o.Z)("li",{className:"form-group"},void 0,(0,o.Z)(Z,{value:a,onChange:s})),t)}function f(){return(0,o.Z)("li",{className:"dropdown-search-message"},void 0,gettext("Search returned no results."))}var _,N=s(37848);function x(e){let{message:t}=e;return _||(_=(0,o.Z)("li",{className:"dropdown-search-loader"},void 0,(0,o.Z)(N.Z,{})))}function y(e){let{provider:t,query:s}=e;const a=t.url+"?q="+encodeURI(s),i=ngettext('See full "%(provider)s" results page with %(count)s result.','See full "%(provider)s" results page with %(count)s results.',t.count);return(0,o.Z)("li",{className:"dropdown-search-footer"},void 0,(0,o.Z)("a",{href:a},void 0,interpolate(i,{count:t.count,provider:t.name},!0)))}function w(e){let{provider:t}=e;return(0,o.Z)("li",{className:"dropdown-search-header"},void 0,t.name)}var k,C,S,E=s(30381),L=s.n(E),T=s(19755);function P(e){let{result:t}=e;const{poster:s,thread:a}=t,i=gettext("Posted by %(poster)s on %(posted_on)s in %(category)s.");return(0,o.Z)("li",{},void 0,(0,o.Z)("a",{href:t.url.index,className:"dropdown-search-thread"},void 0,(0,o.Z)("h5",{},void 0,a.title),(0,o.Z)("small",{className:"dropdown-search-post-content"},void 0,T(t.content).text()),(0,o.Z)("small",{className:"dropdown-search-post-footer"},void 0,interpolate(i,{category:t.category.name,posted_on:L()(t.posted_on).format("LL"),poster:t.poster_name},!0))))}function O(e){let{result:t}=e;const{rank:s}=t,a=gettext("%(title)s, joined on %(joined_on)s"),i=t.title||s.title||s.name;return(0,o.Z)("li",{},void 0,(0,o.Z)("a",{href:t.url,className:"dropdown-search-user"},void 0,(0,o.Z)("div",{className:"media"},void 0,(0,o.Z)("div",{className:"media-left"},void 0,(0,o.Z)(l.ZP,{size:38,user:t})),(0,o.Z)("div",{className:"media-body"},void 0,(0,o.Z)("h5",{className:"media-heading"},void 0,t.username),(0,o.Z)("small",{},void 0,interpolate(a,{title:i,joined_on:L()(t.joined_on).format("LL")},!0))))))}function R(e){let{provider:t,result:s}=e;return"threads"===t.id?(0,o.Z)(P,{result:s}):(0,o.Z)(O,{result:s})}function A(e){let{provider:t,result:s,type:a,query:i}=e;return a===m?(0,o.Z)(w,{provider:t}):a===g?(0,o.Z)(y,{provider:t,query:i}):(0,o.Z)(R,{provider:t,result:s})}function I(e,t){const s=e.results.length;for(var a=0;a<s;a++){const s=e.results[a];t.push({provider:e,result:s,type:v})}t.push({provider:e,type:g})}function D(e){let{isLoading:t,onChange:s,results:a,query:i}=e;if(!i.trim().length)return(0,o.Z)(b,{onChange:s,query:i});if(a.length){const e=function(e){const t=[];return function(e,t){const s=e.length;for(var a=0;a<s;a++){const s=e[a];t.push({provider:s,type:m}),I(s,t)}}(e,t),t}(a);return(0,o.Z)(b,{onChange:s,query:i},void 0,e.map((e=>{const{type:t,provider:s,result:a}=e;return t===v?r().createElement(A,(0,h.Z)({key:[s.id,t,a.id].join("_")},e)):r().createElement(A,(0,h.Z)({key:[s.id,t].join("_"),query:i},e))})))}return t?(0,o.Z)(b,{onChange:s,query:i},void 0,k||(k=(0,o.Z)(x,{}))):(0,o.Z)(b,{onChange:s,query:i},void 0,C||(C=(0,o.Z)(f,{})))}var j=class extends r().Component{constructor(){super(),(0,d.Z)(this,"onToggle",(e=>{this.setState(((e,t)=>(e.isOpen||window.setTimeout((()=>{this.container.querySelector("input").focus()}),100),{isOpen:!e.isOpen})))})),(0,d.Z)(this,"onDocumentMouseDown",(e=>{let t=!0,s=e.target;for(;null!==s&&s!==document;){if(s===this.container)return void(t=!1);s=s.parentNode}t&&this.setState({isOpen:!1})})),(0,d.Z)(this,"onEscape",(e=>{"Escape"===e.key&&this.setState({isOpen:!1})})),(0,d.Z)(this,"onChange",(e=>{const t=e.target.value;this.setState({query:t}),this.loadResults(t.trim())})),this.state={isLoading:!1,isOpen:!1,query:"",results:[]},this.intervalId=null}componentDidMount(){document.addEventListener("mousedown",this.onDocumentMouseDown),document.addEventListener("keydown",this.onEscape)}componentWillUnmount(){document.removeEventListener("mousedown",this.onDocumentMouseDown),document.removeEventListener("keydown",this.onEscape)}loadResults(e){if(!e.length)return;const t=300+300*Math.random();this.intervalId&&window.clearTimeout(this.intervalId),this.setState({isLoading:!0}),this.intervalId=window.setTimeout((()=>{c.Z.get(i.Z.get("SEARCH_API"),{q:e}).then((e=>{this.setState({intervalId:null,isLoading:!1,results:u(e)})}),(e=>{p.Z.apiError(e),this.setState({intervalId:null,isLoading:!1,results:[]})}))}),t)}render(){let e="navbar-search dropdown";return this.state.isOpen&&(e+=" open"),r().createElement("div",{className:e,ref:e=>this.container=e},(0,o.Z)("a",{"aria-haspopup":"true","aria-expanded":"false",className:"navbar-icon","data-toggle":"dropdown",href:i.Z.get("SEARCH_URL"),onClick:this.onToggle},void 0,S||(S=(0,o.Z)("i",{className:"material-icon"},void 0,"search"))),(0,o.Z)(D,{isLoading:this.state.isLoading,onChange:this.onChange,results:this.state.results,query:this.state.query}))}},z=s(82211),U=s(43345),M=s(96359),B=s(59940);const q=["progress-bar-danger","progress-bar-warning","progress-bar-warning","progress-bar-primary","progress-bar-success"],H=[gettext("Entered password is very weak."),gettext("Entered password is weak."),gettext("Entered password is average."),gettext("Entered password is strong."),gettext("Entered password is very strong.")];var F,Y,V,G=class extends r().Component{constructor(e){super(e),this._score=0,this._password=null,this._inputs=[],this.state={loaded:!1}}componentDidMount(){B.Z.load().then((()=>{this.setState({loaded:!0})}))}getScore(e,t){let s=!1;return e!==this._password&&(s=!0),t.length!==this._inputs.length?s=!0:t.map(((e,t)=>{e.trim()!==this._inputs[t]&&(s=!0)})),s&&(this._score=B.Z.scorePassword(e,t),this._password=e,this._inputs=t.map((function(e){return e.trim()}))),this._score}render(){if(!this.state.loaded)return null;let e=this.getScore(this.props.password,this.props.inputs);return(0,o.Z)("div",{className:"help-block password-strength"},void 0,(0,o.Z)("div",{className:"progress"},void 0,(0,o.Z)("div",{className:"progress-bar "+q[e],style:{width:20+20*e+"%"},role:"progress-bar","aria-valuenow":e,"aria-valuemin":"0","aria-valuemax":"4"},void 0,(0,o.Z)("span",{className:"sr-only"},void 0,H[e]))),(0,o.Z)("p",{className:"text-small"},void 0,H[e]))}},$=s(26106),W=s(47235),Q=s(98274),K=s(93825),J=s(59801),X=s(93051),ee=s(55210);class te extends U.Z{constructor(e){super(e),(0,d.Z)(this,"handlePrivacyPolicyChange",(e=>{const t=e.target.value;this.handleToggleAgreement("privacyPolicy",t)})),(0,d.Z)(this,"handleTermsOfServiceChange",(e=>{const t=e.target.value;this.handleToggleAgreement("termsOfService",t)})),(0,d.Z)(this,"handleToggleAgreement",((e,t)=>{this.setState(((s,a)=>{if(null===s[e])return{errors:{...s.errors,[e]:null},[e]:t};const i=this.state.validators[e][0];return{errors:{...s.errors,[e]:[i(null)]},[e]:null}}))}));const{username:t,password:s}=this.props.criteria;let a=0;s.forEach((e=>{"MinimumLengthValidator"===e.name&&(a=e.min_length)}));const o={username:[ee.lG(),ee.HR(t.min_length),ee.gS(t.max_length)],email:[ee.Do()],password:[ee.Vb(a)],captcha:K.ZP.validator()};i.Z.get("TERMS_OF_SERVICE_ID")&&(o.termsOfService=[ee.fT()]),i.Z.get("PRIVACY_POLICY_ID")&&(o.privacyPolicy=[ee.jA()]),this.state={isLoading:!1,username:"",email:"",password:"",captcha:"",termsOfService:null,privacyPolicy:null,validators:o,errors:{}}}clean(){return!!this.isValid()||(p.Z.error(gettext("Form contains errors.")),this.setState({errors:this.validate()}),!1)}send(){return c.Z.post(i.Z.get("USERS_API"),{username:this.state.username,email:this.state.email,password:this.state.password,captcha:this.state.captcha,terms_of_service:this.state.termsOfService,privacy_policy:this.state.privacyPolicy})}handleSuccess(e){this.props.callback(e)}handleError(e){400===e.status?(this.setState({errors:Object.assign({},this.state.errors,e)}),e.__all__&&e.__all__.length>0?p.Z.error(e.__all__[0]):p.Z.error(gettext("Form contains errors."))):403===e.status&&e.ban?((0,X.Z)(e.ban),J.Z.hide()):p.Z.apiError(e)}render(){return(0,o.Z)("div",{className:"modal-dialog modal-register",role:"document"},void 0,(0,o.Z)("div",{className:"modal-content"},void 0,(0,o.Z)("div",{className:"modal-header"},void 0,(0,o.Z)("button",{type:"button",className:"close","data-dismiss":"modal","aria-label":pgettext("modal","Close")},void 0,F||(F=(0,o.Z)("span",{"aria-hidden":"true"},void 0,"×"))),(0,o.Z)("h4",{className:"modal-title"},void 0,gettext("Register"))),(0,o.Z)("form",{onSubmit:this.handleSubmit},void 0,(0,o.Z)("input",{type:"type",style:{display:"none"}}),(0,o.Z)("input",{type:"password",style:{display:"none"}}),(0,o.Z)("div",{className:"modal-body"},void 0,(0,o.Z)(W.Z,{buttonClassName:"col-xs-12 col-sm-6",buttonLabel:gettext("Join with %(site)s"),formLabel:gettext("Or create forum account:")}),(0,o.Z)(M.Z,{label:gettext("Username"),for:"id_username",validation:this.state.errors.username},void 0,(0,o.Z)("input",{type:"text",id:"id_username",className:"form-control","aria-describedby":"id_username_status",disabled:this.state.isLoading,onChange:this.bindInput("username"),value:this.state.username})),(0,o.Z)(M.Z,{label:gettext("E-mail"),for:"id_email",validation:this.state.errors.email},void 0,(0,o.Z)("input",{type:"text",id:"id_email",className:"form-control","aria-describedby":"id_email_status",disabled:this.state.isLoading,onChange:this.bindInput("email"),value:this.state.email})),(0,o.Z)(M.Z,{label:gettext("Password"),for:"id_password",validation:this.state.errors.password,extra:(0,o.Z)(G,{password:this.state.password,inputs:[this.state.username,this.state.email]})},void 0,(0,o.Z)("input",{type:"password",id:"id_password",className:"form-control","aria-describedby":"id_password_status",disabled:this.state.isLoading,onChange:this.bindInput("password"),value:this.state.password})),K.ZP.component({form:this}),(0,o.Z)($.Z,{errors:this.state.errors,privacyPolicy:this.state.privacyPolicy,termsOfService:this.state.termsOfService,onPrivacyPolicyChange:this.handlePrivacyPolicyChange,onTermsOfServiceChange:this.handleTermsOfServiceChange})),(0,o.Z)("div",{className:"modal-footer"},void 0,(0,o.Z)("button",{className:"btn btn-default","data-dismiss":"modal",disabled:this.state.isLoading,type:"button"},void 0,gettext("Cancel")),(0,o.Z)(z.Z,{className:"btn-primary",loading:this.state.isLoading},void 0,gettext("Register account"))))))}}class se extends r().Component{getLead(){return"user"===this.props.activation?gettext("%(username)s, your account has been created but you need to activate it before you will be able to sign in."):"admin"===this.props.activation?gettext("%(username)s, your account has been created but board administrator will have to activate it before you will be able to sign in."):void 0}getSubscript(){return"user"===this.props.activation?gettext("We have sent an e-mail to %(email)s with link that you have to click to activate your account."):"admin"===this.props.activation?gettext("We will send an e-mail to %(email)s when this takes place."):void 0}render(){return(0,o.Z)("div",{className:"modal-dialog modal-message modal-register",role:"document"},void 0,(0,o.Z)("div",{className:"modal-content"},void 0,(0,o.Z)("div",{className:"modal-header"},void 0,(0,o.Z)("button",{type:"button",className:"close","data-dismiss":"modal","aria-label":pgettext("modal","Close")},void 0,Y||(Y=(0,o.Z)("span",{"aria-hidden":"true"},void 0,"×"))),(0,o.Z)("h4",{className:"modal-title"},void 0,gettext("Registration complete"))),(0,o.Z)("div",{className:"modal-body"},void 0,V||(V=(0,o.Z)("div",{className:"message-icon"},void 0,(0,o.Z)("span",{className:"material-icon"},void 0,"info_outline"))),(0,o.Z)("div",{className:"message-body"},void 0,(0,o.Z)("p",{className:"lead"},void 0,interpolate(this.getLead(),{username:this.props.username},!0)),(0,o.Z)("p",{},void 0,interpolate(this.getSubscript(),{email:this.props.email},!0)),(0,o.Z)("button",{className:"btn btn-default","data-dismiss":"modal",type:"button"},void 0,gettext("Ok"))))))}}var ae,ie,oe,ne,re,le=class extends r().Component{constructor(e){super(e),(0,d.Z)(this,"completeRegistration",(e=>{"active"===e.activation?(J.Z.hide(),Q.Z.signIn(e)):this.setState({complete:e})})),this.state={complete:!1}}render(){return this.state.complete?(0,o.Z)(se,{activation:this.state.complete.activation,email:this.state.complete.email,username:this.state.complete.username}):r().createElement(te,(0,h.Z)({callback:this.completeRegistration},this.props))}},de=class extends r().Component{constructor(e){super(e),(0,d.Z)(this,"showRegisterForm",(()=>{"closed"===misago.get("SETTINGS").account_activation?p.Z.info(gettext("New registrations are currently disabled.")):this.state.isLoaded?J.Z.show((0,o.Z)(le,{criteria:this.state.criteria})):(this.setState({isLoading:!0}),Promise.all([K.ZP.load(),c.Z.get(misago.get("AUTH_CRITERIA_API"))]).then((e=>{this.setState({isLoading:!1,isLoaded:!0,criteria:e[1]}),J.Z.show((0,o.Z)(le,{criteria:e[1]}))}),(()=>{this.setState({isLoading:!1}),p.Z.error(gettext("Registration is currently unavailable due to an error."))})))})),this.state={isLoading:!1,isLoaded:!1,criteria:null}}getClassName(){return this.props.className+(this.state.isLoading?" btn-loading":"")}render(){return(0,o.Z)("button",{className:"btn "+this.getClassName(),disabled:this.state.isLoading,onClick:this.showRegisterForm,type:"button"},void 0,gettext("Register"),this.state.isLoading?ae||(ae=(0,o.Z)(N.Z,{})):null)}},ce=s(14467),pe=s(8621);class ue extends r().Component{showSignInModal(){J.Z.show(ce.Z)}render(){const e=i.Z.get("SETTINGS").DELEGATE_AUTH;return(0,o.Z)("ul",{className:"dropdown-menu user-dropdown dropdown-menu-right",role:"menu"},void 0,(0,o.Z)("li",{className:"guest-preview"},void 0,(0,o.Z)("h4",{},void 0,gettext("You are browsing as guest.")),(0,o.Z)("p",{},void 0,gettext("Sign in or register to start and participate in discussions.")),e?(0,o.Z)("div",{className:"row"},void 0,(0,o.Z)("div",{className:"col-xs-12"},void 0,(0,o.Z)("a",{className:"btn btn-default btn-sign-in btn-block",href:i.Z.get("SETTINGS").LOGIN_URL},void 0,gettext("Sign in")))):(0,o.Z)("div",{className:"row"},void 0,(0,o.Z)("div",{className:"col-xs-6"},void 0,(0,o.Z)("button",{className:"btn btn-default btn-sign-in btn-block",onClick:this.showSignInModal,type:"button"},void 0,gettext("Sign in"))),(0,o.Z)("div",{className:"col-xs-6"},void 0,(0,o.Z)(de,{className:"btn-primary btn-register btn-block"},void 0,gettext("Register"))))))}}class he extends ue{render(){return i.Z.get("SETTINGS").DELEGATE_AUTH?(0,o.Z)("div",{className:"nav nav-guest"},void 0,(0,o.Z)("a",{className:"btn navbar-btn btn-default btn-sign-in",href:i.Z.get("SETTINGS").LOGIN_URL},void 0,gettext("Sign in")),ie||(ie=(0,o.Z)("div",{className:"navbar-left"},void 0,(0,o.Z)(j,{})))):(0,o.Z)("div",{className:"nav nav-guest"},void 0,(0,o.Z)("button",{className:"btn navbar-btn btn-default btn-sign-in",onClick:this.showSignInModal,type:"button"},void 0,gettext("Sign in")),(0,o.Z)(de,{className:"navbar-btn btn-primary btn-register"},void 0,gettext("Register")),oe||(oe=(0,o.Z)("div",{className:"navbar-left"},void 0,(0,o.Z)(j,{}))))}}class me extends r().Component{showGuestMenu(){pe.Z.show(ue)}render(){return(0,o.Z)("button",{type:"button",onClick:this.showGuestMenu},void 0,ne||(ne=(0,o.Z)(l.ZP,{size:"64"})))}}var ve,ge,Ze,be=class extends r().Component{constructor(e){super(e),(0,d.Z)(this,"setGravatar",(()=>{this.callApi("gravatar")})),(0,d.Z)(this,"setGenerated",(()=>{this.callApi("generated")})),this.state={isLoading:!1}}callApi(e){if(this.state.isLoading)return!1;this.setState({isLoading:!0}),c.Z.post(this.props.user.api.avatar,{avatar:e}).then((e=>{this.setState({isLoading:!1}),p.Z.success(e.detail),this.props.onComplete(e)}),(e=>{400===e.status?(p.Z.error(e.detail),this.setState({isLoading:!1})):this.props.showError(e)}))}getGravatarButton(){return this.props.options.gravatar?(0,o.Z)(z.Z,{onClick:this.setGravatar,disabled:this.state.isLoading,className:"btn-default btn-block btn-avatar-gravatar"},void 0,gettext("Download my Gravatar")):null}getCropButton(){return this.props.options.crop_src?(0,o.Z)(z.Z,{className:"btn-default btn-block btn-avatar-crop",disabled:this.state.isLoading,onClick:this.props.showCrop},void 0,gettext("Re-crop uploaded image")):null}getUploadButton(){return this.props.options.upload?(0,o.Z)(z.Z,{className:"btn-default btn-block btn-avatar-upload",disabled:this.state.isLoading,onClick:this.props.showUpload},void 0,gettext("Upload new image")):null}getGalleryButton(){return this.props.options.galleries?(0,o.Z)(z.Z,{className:"btn-default btn-block btn-avatar-gallery",disabled:this.state.isLoading,onClick:this.props.showGallery},void 0,gettext("Pick avatar from gallery")):null}getAvatarPreview(){let e={id:this.props.user.id,avatars:this.props.options.avatars};return this.state.isLoading?(0,o.Z)("div",{className:"avatar-preview preview-loading"},void 0,(0,o.Z)(l.ZP,{size:"200",user:e}),re||(re=(0,o.Z)(N.Z,{}))):(0,o.Z)("div",{className:"avatar-preview"},void 0,(0,o.Z)(l.ZP,{size:"200",user:e}))}render(){return(0,o.Z)("div",{className:"modal-body modal-avatar-index"},void 0,(0,o.Z)("div",{className:"row"},void 0,(0,o.Z)("div",{className:"col-md-5"},void 0,this.getAvatarPreview()),(0,o.Z)("div",{className:"col-md-7"},void 0,this.getGravatarButton(),(0,o.Z)(z.Z,{onClick:this.setGenerated,disabled:this.state.isLoading,className:"btn-default btn-block btn-avatar-generate"},void 0,gettext("Generate my individual avatar")),this.getCropButton(),this.getUploadButton(),this.getGalleryButton())))}},fe=s(19755),_e=class extends r().Component{constructor(e){super(e),(0,d.Z)(this,"cropAvatar",(()=>{if(this.state.isLoading)return!1;this.setState({isLoading:!0});let e=this.props.upload?"crop_tmp":"crop_src",t=fe(".crop-form");const s=t.cropit("exportZoom"),a=t.cropit("offset");c.Z.post(this.props.user.api.avatar,{avatar:e,crop:{offset:{x:a.x*s,y:a.y*s},zoom:t.cropit("zoom")*s}}).then((e=>{this.props.onComplete(e),p.Z.success(e.detail)}),(e=>{400===e.status?(p.Z.error(e.detail),this.setState({isLoading:!1})):this.props.showError(e)}))})),this.state={isLoading:!1,deviceRatio:1}}getAvatarSize(){return this.props.upload?this.props.options.crop_tmp.size:this.props.options.crop_src.size}getImagePath(){return this.props.upload?this.props.dataUrl:this.props.options.crop_src.url}componentDidMount(){let e=fe(".crop-form"),t=this.getAvatarSize();const s=e.width();for(;s<t;)t/=2;const a=this.getAvatarSize()/t;e.width(t),e.cropit({width:t,height:t,exportZoom:a,imageState:{src:this.getImagePath()},onImageLoaded:()=>{if(this.props.upload){let t=e.cropit("zoom"),s=e.cropit("imageSize");if(s.width>s.height){let a=(s.width*t-this.getAvatarSize())/-2;e.cropit("offset",{x:a,y:0})}else if(s.width<s.height){let a=(s.height*t-this.getAvatarSize())/-2;e.cropit("offset",{x:0,y:a})}else e.cropit("offset",{x:0,y:0})}else{let t=this.props.options.crop_src.crop;t&&(e.cropit("zoom",t.zoom),e.cropit("offset",{x:t.x,y:t.y}))}}})}componentWillUnmount(){fe(".crop-form").cropit("disable")}render(){return(0,o.Z)("div",{},void 0,ve||(ve=(0,o.Z)("div",{className:"modal-body modal-avatar-crop"},void 0,(0,o.Z)("div",{className:"crop-form"},void 0,(0,o.Z)("div",{className:"cropit-preview"}),(0,o.Z)("input",{type:"range",className:"cropit-image-zoom-input"})))),(0,o.Z)("div",{className:"modal-footer"},void 0,(0,o.Z)("div",{className:"col-md-6 col-md-offset-3"},void 0,(0,o.Z)(z.Z,{onClick:this.cropAvatar,loading:this.state.isLoading,className:"btn-primary btn-block"},void 0,this.props.upload?gettext("Set avatar"):gettext("Crop image")),(0,o.Z)(z.Z,{onClick:this.props.showIndex,disabled:this.state.isLoading,className:"btn-default btn-block"},void 0,gettext("Cancel")))))}},Ne=s(48772),xe=class extends r().Component{constructor(e){super(e),(0,d.Z)(this,"pickFile",(()=>{document.getElementById("avatar-hidden-upload").click()})),(0,d.Z)(this,"uploadFile",(()=>{let e=document.getElementById("avatar-hidden-upload").files[0];if(!e)return;let t=this.validateFile(e);if(t)return void p.Z.error(t);this.setState({image:e,preview:URL.createObjectURL(e),progress:0});let s=new FormData;s.append("avatar","upload"),s.append("image",e),c.Z.upload(this.props.user.api.avatar,s,(e=>{this.setState({progress:e})})).then((e=>{this.setState({options:e,uploaded:e.detail}),p.Z.info(gettext("Your image has been uploaded and you may now crop it."))}),(e=>{400===e.status||413===e.status?(p.Z.error(e.detail),this.setState({isLoading:!1,image:null,progress:0})):this.props.showError(e)}))})),this.state={image:null,preview:null,progress:0,uploaded:null,dataUrl:null}}validateFile(e){if(e.size>this.props.options.upload.limit)return interpolate(gettext("Selected file is too big. (%(filesize)s)"),{filesize:(0,Ne.Z)(e.size)},!0);let t=gettext("Selected file type is not supported.");if(-1===this.props.options.upload.allowed_mime_types.indexOf(e.type))return t;let s=!1,a=e.name.toLowerCase();return this.props.options.upload.allowed_extensions.map((function(e){a.substr(-1*e.length)===e&&(s=!0)})),!s&&t}getUploadRequirements(e){let t=e.allowed_extensions.map((function(e){return e.substr(1)}));return interpolate(gettext("%(files)s files smaller than %(limit)s"),{files:t.join(", "),limit:(0,Ne.Z)(e.limit)},!0)}getUploadButton(){return(0,o.Z)("div",{className:"modal-body modal-avatar-upload"},void 0,(0,o.Z)(z.Z,{className:"btn-pick-file",onClick:this.pickFile},void 0,ge||(ge=(0,o.Z)("div",{className:"material-icon"},void 0,"input")),gettext("Select file")),(0,o.Z)("p",{className:"text-muted"},void 0,this.getUploadRequirements(this.props.options.upload)))}getUploadProgressLabel(){return interpolate(gettext("%(progress)s % complete"),{progress:this.state.progress},!0)}getUploadProgress(){return(0,o.Z)("div",{className:"modal-body modal-avatar-upload"},void 0,(0,o.Z)("div",{className:"upload-progress"},void 0,(0,o.Z)("img",{src:this.state.preview}),(0,o.Z)("div",{className:"progress"},void 0,(0,o.Z)("div",{className:"progress-bar",role:"progressbar","aria-valuenow":"{this.state.progress}","aria-valuemin":"0","aria-valuemax":"100",style:{width:this.state.progress+"%"}},void 0,(0,o.Z)("span",{className:"sr-only"},void 0,this.getUploadProgressLabel())))))}renderUpload(){return(0,o.Z)("div",{},void 0,(0,o.Z)("input",{type:"file",id:"avatar-hidden-upload",className:"hidden-file-upload",onChange:this.uploadFile}),this.state.image?this.getUploadProgress():this.getUploadButton(),(0,o.Z)("div",{className:"modal-footer"},void 0,(0,o.Z)("div",{className:"col-md-6 col-md-offset-3"},void 0,(0,o.Z)(z.Z,{onClick:this.props.showIndex,disabled:!!this.state.image,className:"btn-default btn-block"},void 0,gettext("Cancel")))))}renderCrop(){return(0,o.Z)(_e,{options:this.state.options,user:this.props.user,upload:this.state.uploaded,dataUrl:this.state.preview,onComplete:this.props.onComplete,showError:this.props.showError,showIndex:this.props.showIndex})}render(){return this.state.uploaded?this.renderCrop():this.renderUpload()}},ye=s(69130);class we extends r().Component{constructor(){super(...arguments),(0,d.Z)(this,"select",(()=>{this.props.select(this.props.id)}))}getClassName(){return this.props.selection===this.props.id?this.props.disabled?"btn btn-avatar btn-disabled avatar-selected":"btn btn-avatar avatar-selected":this.props.disabled?"btn btn-avatar btn-disabled":"btn btn-avatar"}render(){return(0,o.Z)("button",{type:"button",className:this.getClassName(),disabled:this.props.disabled,onClick:this.select},void 0,(0,o.Z)("img",{src:this.props.url}))}}class ke extends r().Component{render(){return(0,o.Z)("div",{className:"avatars-gallery"},void 0,(0,o.Z)("h3",{},void 0,this.props.name),(0,o.Z)("div",{className:"avatars-gallery-images"},void 0,(0,ye.Z)(this.props.images,4,null).map(((e,t)=>(0,o.Z)("div",{className:"row"},t,e.map(((e,t)=>(0,o.Z)("div",{className:"col-xs-3"},t,e?r().createElement(we,(0,h.Z)({disabled:this.props.disabled,select:this.props.select,selection:this.props.selection},e)):Ze||(Ze=(0,o.Z)("div",{className:"blank-avatar"}))))))))))}}var Ce,Se,Ee,Le=class extends r().Component{constructor(e){super(e),(0,d.Z)(this,"select",(e=>{this.setState({selection:e})})),(0,d.Z)(this,"save",(()=>{if(this.state.isLoading)return!1;this.setState({isLoading:!0}),c.Z.post(this.props.user.api.avatar,{avatar:"galleries",image:this.state.selection}).then((e=>{this.setState({isLoading:!1}),p.Z.success(e.detail),this.props.onComplete(e),this.props.showIndex()}),(e=>{400===e.status?(p.Z.error(e.detail),this.setState({isLoading:!1})):this.props.showError(e)}))})),this.state={selection:null,isLoading:!1}}render(){return(0,o.Z)("div",{},void 0,(0,o.Z)("div",{className:"modal-body modal-avatar-gallery"},void 0,this.props.options.galleries.map(((e,t)=>(0,o.Z)(ke,{name:e.name,images:e.images,selection:this.state.selection,disabled:this.state.isLoading,select:this.select},t)))),(0,o.Z)("div",{className:"modal-footer"},void 0,(0,o.Z)("div",{className:"row"},void 0,(0,o.Z)("div",{className:"col-md-6 col-md-offset-3"},void 0,(0,o.Z)(z.Z,{onClick:this.save,loading:this.state.isLoading,disabled:!this.state.selection,className:"btn-primary btn-block"},void 0,this.state.selection?gettext("Save choice"):gettext("Select avatar")),(0,o.Z)(z.Z,{onClick:this.props.showIndex,disabled:this.state.isLoading,className:"btn-default btn-block"},void 0,gettext("Cancel"))))))}},Te=s(3784),Pe=s(6935),Oe=s(90287);class Re extends r().Component{getErrorReason(){return this.props.reason?(0,o.Z)("p",{dangerouslySetInnerHTML:{__html:this.props.reason}}):null}render(){return(0,o.Z)("div",{className:"modal-body"},void 0,Ce||(Ce=(0,o.Z)("div",{className:"message-icon"},void 0,(0,o.Z)("span",{className:"material-icon"},void 0,"remove_circle_outline"))),(0,o.Z)("div",{className:"message-body"},void 0,(0,o.Z)("p",{className:"lead"},void 0,this.props.message),this.getErrorReason(),(0,o.Z)("button",{className:"btn btn-default","data-dismiss":"modal",type:"button"},void 0,gettext("Ok"))))}}var Ae,Ie,De,je,ze,Ue,Me,Be,qe,He,Fe,Ye,Ve,Ge,$e=class extends r().Component{constructor(){super(...arguments),(0,d.Z)(this,"showError",(e=>{this.setState({error:e})})),(0,d.Z)(this,"showIndex",(()=>{this.setState({component:be})})),(0,d.Z)(this,"showUpload",(()=>{this.setState({component:xe})})),(0,d.Z)(this,"showCrop",(()=>{this.setState({component:_e})})),(0,d.Z)(this,"showGallery",(()=>{this.setState({component:Le})})),(0,d.Z)(this,"completeFlow",(e=>{Oe.Z.dispatch((0,Pe.n1)(this.props.user,e.avatars)),this.setState({component:be,options:e})}))}componentDidMount(){c.Z.get(this.props.user.api.avatar).then((e=>{this.setState({component:be,options:e,error:null})}),(e=>{this.showError(e)}))}getBody(){return this.state?this.state.error?(0,o.Z)(Re,{message:this.state.error.detail,reason:this.state.error.reason}):(0,o.Z)(this.state.component,{options:this.state.options,user:this.props.user,onComplete:this.completeFlow,showError:this.showError,showIndex:this.showIndex,showCrop:this.showCrop,showUpload:this.showUpload,showGallery:this.showGallery}):Se||(Se=(0,o.Z)(Te.Z,{}))}getClassName(){return this.state&&this.state.error?"modal-dialog modal-message modal-change-avatar":"modal-dialog modal-change-avatar"}render(){return(0,o.Z)("div",{className:this.getClassName(),role:"document"},void 0,(0,o.Z)("div",{className:"modal-content"},void 0,(0,o.Z)("div",{className:"modal-header"},void 0,(0,o.Z)("button",{type:"button",className:"close","data-dismiss":"modal","aria-label":pgettext("modal","Close")},void 0,Ee||(Ee=(0,o.Z)("span",{"aria-hidden":"true"},void 0,"×"))),(0,o.Z)("h4",{className:"modal-title"},void 0,gettext("Change your avatar"))),this.getBody()))}};function We(e){return{user:e.auth.user}}class Qe extends r().Component{changeAvatar(){J.Z.show((0,a.$j)(We)($e))}render(){const{user:e}=this.props;return(0,o.Z)("ul",{className:"dropdown-menu user-dropdown dropdown-menu-right",role:"menu"},void 0,(0,o.Z)("li",{className:"dropdown-header"},void 0,(0,o.Z)("strong",{},void 0,e.username),(0,o.Z)("div",{className:"row user-stats"},void 0,(0,o.Z)("div",{className:"col-sm-3"},void 0,Ae||(Ae=(0,o.Z)("span",{className:"material-icon"},void 0,"message")),e.posts),(0,o.Z)("div",{className:"col-sm-3"},void 0,Ie||(Ie=(0,o.Z)("span",{className:"material-icon"},void 0,"forum")),e.threads),(0,o.Z)("div",{className:"col-sm-3"},void 0,De||(De=(0,o.Z)("span",{className:"material-icon"},void 0,"favorite")),e.followers),(0,o.Z)("div",{className:"col-sm-3"},void 0,je||(je=(0,o.Z)("span",{className:"material-icon"},void 0,"favorite_outline")),e.following))),ze||(ze=(0,o.Z)("li",{className:"divider"})),(0,o.Z)("li",{},void 0,(0,o.Z)("a",{href:e.url},void 0,Ue||(Ue=(0,o.Z)("span",{className:"material-icon"},void 0,"account_circle")),gettext("See your profile"))),(0,o.Z)("li",{},void 0,(0,o.Z)("a",{href:i.Z.get("USERCP_URL")},void 0,Me||(Me=(0,o.Z)("span",{className:"material-icon"},void 0,"done_all")),gettext("Change options"))),(0,o.Z)("li",{},void 0,(0,o.Z)("button",{className:"btn-link",onClick:this.changeAvatar,type:"button"},void 0,Be||(Be=(0,o.Z)("span",{className:"material-icon"},void 0,"portrait")),gettext("Change avatar"))),!!e.acl.can_use_private_threads&&(0,o.Z)("li",{},void 0,(0,o.Z)("a",{href:i.Z.get("PRIVATE_THREADS_URL")},void 0,qe||(qe=(0,o.Z)("span",{className:"material-icon"},void 0,"message")),gettext("Private threads"),(0,o.Z)(Ke,{user:e}))),He||(He=(0,o.Z)("li",{className:"divider"})),(0,o.Z)("li",{className:"dropdown-buttons"},void 0,(0,o.Z)("button",{className:"btn btn-default btn-block",onClick:()=>document.getElementById("hidden-logout-form").submit(),type:"button"},void 0,gettext("Log out"))))}}function Ke(e){let{user:t}=e;return t.unread_private_threads?(0,o.Z)("span",{className:"badge"},void 0,t.unread_private_threads):null}function Je(e){let{user:t}=e;return(0,o.Z)("ul",{className:"ul nav navbar-nav nav-user"},void 0,Fe||(Fe=(0,o.Z)("li",{},void 0,(0,o.Z)(j,{}))),(0,o.Z)(Xe,{user:t}),(0,o.Z)("li",{className:"dropdown"},void 0,(0,o.Z)("a",{"aria-haspopup":"true","aria-expanded":"false",className:"dropdown-toggle","data-toggle":"dropdown",href:t.url,role:"button"},void 0,(0,o.Z)(l.ZP,{user:t,size:"64"})),(0,o.Z)(Qe,{user:t})))}function Xe(e){let{user:t}=e;if(!t.acl.can_use_private_threads)return null;let s=null;return s=t.unread_private_threads?gettext("You have unread private threads!"):gettext("Private threads"),(0,o.Z)("li",{},void 0,(0,o.Z)("a",{className:"navbar-icon",href:i.Z.get("PRIVATE_THREADS_URL"),title:s},void 0,Ye||(Ye=(0,o.Z)("span",{className:"material-icon"},void 0,"message")),t.unread_private_threads>0&&(0,o.Z)("span",{className:"badge"},void 0,t.unread_private_threads)))}function et(e){return{user:e.auth.user}}class tt extends r().Component{showUserMenu(){pe.Z.showConnected("user-menu",(0,a.$j)(et)(Qe))}render(){return(0,o.Z)("button",{type:"button",onClick:this.showUserMenu},void 0,(0,o.Z)(l.ZP,{user:this.props.user,size:"50"}))}}class st extends r().Component{render(){return this.props.isAuthenticated?(0,o.Z)(Je,{user:this.props.user}):Ve||(Ve=(0,o.Z)(he,{}))}}class at extends r().Component{render(){return this.props.isAuthenticated?(0,o.Z)(tt,{user:this.props.user}):Ge||(Ge=(0,o.Z)(me,{}))}}function it(e){return e.auth}var ot=s(4869);i.Z.addInitializer({name:"component:user-menu",initializer:function(){(0,ot.Z)((0,a.$j)(it)(st),"user-menu-mount"),(0,ot.Z)((0,a.$j)(it)(at),"user-menu-compact-mount")},after:"store"})},77031:function(e,t,s){"use strict";var a,i=s(22928),o=s(57588),n=s.n(o),r=s(37424),l=s(4942),d=s(59131),c=s(69987),p=s(94417);const u=(e,t)=>{let s=e;return"rank"===t.component?s+=t.slug:s+=t.component,s+"/"};var h,m,v,g,Z=e=>{let{baseUrl:t,page:s,pages:o}=e;return(0,i.Z)("div",{className:"nav-container"},void 0,(0,i.Z)("div",{className:"dropdown hidden-sm hidden-md hidden-lg"},void 0,(0,i.Z)("button",{className:"btn btn-default btn-block btn-outline dropdown-toggle",type:"button","data-toggle":"dropdown","aria-haspopup":"true","aria-expanded":"false"},void 0,a||(a=(0,i.Z)("span",{className:"material-icon"},void 0,"menu")),s.name),(0,i.Z)("ul",{className:"dropdown-menu stick-to-bottom"},void 0,o.map((e=>{const s=u(t,e);return(0,i.Z)("li",{},s,(0,i.Z)(c.rU,{to:s},void 0,e.name))})))),(0,i.Z)("ul",{className:"nav nav-pills hidden-xs",role:"menu"},void 0,o.map((e=>{const s=u(t,e);return(0,i.Z)(p.Z,{path:s},s,(0,i.Z)(c.rU,{to:s},void 0,e.name))}))))},b=class extends n().Component{getEmptyMessage(){return interpolate(gettext("No users have posted any new messages during last %(days)s days."),{days:this.props.trackedPeriod},!0)}render(){return(0,i.Z)("div",{className:"active-posters-list"},void 0,(0,i.Z)(d.Z,{},void 0,(0,i.Z)(Z,{baseUrl:misago.get("USERS_LIST_URL"),page:this.props.page,pages:misago.get("USERS_LISTS")}),(0,i.Z)("p",{className:"lead"},void 0,this.getEmptyMessage())))}},f=s(19605),_=s(44039),N=class extends n().Component{shouldComponentUpdate(){return!1}getClassName(){return this.props.hiddenOnMobile?"list-group-item hidden-xs hidden-sm":"list-group-item"}render(){return(0,i.Z)("li",{className:this.getClassName()},void 0,h||(h=(0,i.Z)("div",{className:"rank-user-avatar"},void 0,(0,i.Z)("span",{},void 0,(0,i.Z)(f.ZP,{size:"50"})))),(0,i.Z)("div",{className:"rank-user"},void 0,(0,i.Z)("div",{className:"user-name"},void 0,(0,i.Z)("span",{className:"item-title"},void 0,(0,i.Z)("span",{className:"ui-preview-text",style:{width:_.e(30,80)+"px"}},void 0," "))),(0,i.Z)("div",{className:"user-details"},void 0,(0,i.Z)("span",{className:"user-status"},void 0,m||(m=(0,i.Z)("span",{className:"status-icon ui-preview-text"},void 0," ")),(0,i.Z)("span",{className:"status-label ui-preview-text hidden-xs hidden-sm",style:{width:_.e(30,50)+"px"}},void 0," ")),(0,i.Z)("span",{className:"rank-name"},void 0,(0,i.Z)("span",{className:"ui-preview-text",style:{width:_.e(30,50)+"px"}},void 0," ")),(0,i.Z)("span",{className:"user-title hidden-xs hidden-sm"},void 0,(0,i.Z)("span",{className:"ui-preview-text",style:{width:_.e(30,50)+"px"}},void 0," "))),(0,i.Z)("div",{className:"user-compact-stats visible-xs-block"},void 0,(0,i.Z)("span",{className:"rank-position"},void 0,(0,i.Z)("strong",{},void 0,(0,i.Z)("span",{className:"ui-preview-text",style:{width:_.e(20,30)+"px"}},void 0," ")),(0,i.Z)("small",{},void 0,gettext("Rank"))),(0,i.Z)("span",{className:"rank-posts-counted"},void 0,(0,i.Z)("strong",{},void 0,(0,i.Z)("span",{className:"ui-preview-text",style:{width:_.e(20,30)+"px"}},void 0," ")),(0,i.Z)("small",{},void 0,gettext("Ranked posts"))))),(0,i.Z)("div",{className:"rank-position hidden-xs"},void 0,(0,i.Z)("strong",{},void 0,(0,i.Z)("span",{className:"ui-preview-text",style:{width:_.e(20,30)+"px"}},void 0," ")),(0,i.Z)("small",{},void 0,gettext("Rank"))),(0,i.Z)("div",{className:"rank-posts-counted hidden-xs"},void 0,(0,i.Z)("strong",{},void 0,(0,i.Z)("span",{className:"ui-preview-text",style:{width:_.e(20,30)+"px"}},void 0," ")),(0,i.Z)("small",{},void 0,gettext("Ranked posts"))),(0,i.Z)("div",{className:"rank-posts-total hidden-xs"},void 0,(0,i.Z)("strong",{},void 0,(0,i.Z)("span",{className:"ui-preview-text",style:{width:_.e(20,30)+"px"}},void 0," ")),(0,i.Z)("small",{},void 0,gettext("Total posts"))))}},x=class extends n().Component{shouldComponentUpdate(){return!1}render(){return(0,i.Z)("div",{className:"active-posters-list"},void 0,(0,i.Z)(d.Z,{},void 0,(0,i.Z)(Z,{baseUrl:misago.get("USERS_LIST_URL"),page:this.props.page,pages:misago.get("USERS_LISTS")}),(0,i.Z)("p",{className:"lead ui-preview"},void 0,(0,i.Z)("span",{className:"ui-preview-text",style:{width:_.e(50,220)+"px"}},void 0," ")),(0,i.Z)("div",{className:"active-posters ui-preview"},void 0,(0,i.Z)("ul",{className:"list-group"},void 0,[0,1,2].map((e=>(0,i.Z)(N,{hiddenOnMobile:e>0},e)))))))}},y=s(24678),w=s(32233),k=class extends n().Component{getClassName(){return this.props.rank.css_class?"list-group-item list-group-rank-"+this.props.rank.css_class:"list-group-item"}getUserStatus(){return this.props.user.status?(0,i.Z)(y.ZP,{user:this.props.user,status:this.props.user.status},void 0,(0,i.Z)(y.Jj,{user:this.props.user,status:this.props.user.status}),(0,i.Z)(y.pg,{user:this.props.user,status:this.props.user.status,className:"status-label hidden-xs hidden-sm"})):(0,i.Z)("span",{className:"user-status"},void 0,v||(v=(0,i.Z)("span",{className:"status-icon ui-preview-text"},void 0," ")),(0,i.Z)("span",{className:"status-label ui-preview-text hidden-xs hidden-sm",style:{width:_.e(30,50)+"px"}},void 0," "))}getRankName(){if(!this.props.rank.is_tab)return(0,i.Z)("span",{className:"rank-name item-title"},void 0,this.props.rank.name);let e=w.Z.get("USERS_LIST_URL")+this.props.rank.slug+"/";return(0,i.Z)(c.rU,{to:e,className:"rank-name item-title"},void 0,this.props.rank.name)}getUserTitle(){return this.props.user.title?(0,i.Z)("span",{className:"user-title hidden-xs hidden-sm"},void 0,this.props.user.title):null}render(){return(0,i.Z)("li",{className:this.getClassName()},void 0,(0,i.Z)("div",{className:"rank-user-avatar"},void 0,(0,i.Z)("a",{href:this.props.user.url},void 0,(0,i.Z)(f.ZP,{user:this.props.user,size:50,size2x:64}))),(0,i.Z)("div",{className:"rank-user"},void 0,(0,i.Z)("div",{className:"user-name"},void 0,(0,i.Z)("a",{href:this.props.user.url,className:"item-title"},void 0,this.props.user.username)),(0,i.Z)("div",{className:"user-details"},void 0,this.getUserStatus(),this.getRankName(),this.getUserTitle()),(0,i.Z)("div",{className:"user-compact-stats visible-xs-block"},void 0,(0,i.Z)("span",{className:"rank-position"},void 0,(0,i.Z)("strong",{},void 0,"#",this.props.counter),(0,i.Z)("small",{},void 0,gettext("Rank"))),(0,i.Z)("span",{className:"rank-posts-counted"},void 0,(0,i.Z)("strong",{},void 0,this.props.user.meta.score),(0,i.Z)("small",{},void 0,gettext("Ranked posts"))))),(0,i.Z)("div",{className:"rank-position hidden-xs"},void 0,(0,i.Z)("strong",{},void 0,"#",this.props.counter),(0,i.Z)("small",{},void 0,gettext("Rank"))),(0,i.Z)("div",{className:"rank-posts-counted hidden-xs"},void 0,(0,i.Z)("strong",{},void 0,this.props.user.meta.score),(0,i.Z)("small",{},void 0,gettext("Ranked posts"))),(0,i.Z)("div",{className:"rank-posts-total hidden-xs"},void 0,(0,i.Z)("strong",{},void 0,this.props.user.posts),(0,i.Z)("small",{},void 0,gettext("Total posts"))))}},C=class extends n().Component{getLeadMessage(){let e=ngettext("%(posters)s top poster from last %(days)s days.","%(posters)s top posters from last %(days)s days.",this.props.count);return interpolate(e,{posters:this.props.count,days:this.props.trackedPeriod},!0)}render(){return(0,i.Z)("div",{className:"active-posters-list"},void 0,(0,i.Z)(d.Z,{},void 0,(0,i.Z)(Z,{baseUrl:misago.get("USERS_LIST_URL"),page:this.props.page,pages:misago.get("USERS_LISTS")}),(0,i.Z)("p",{className:"lead"},void 0,this.getLeadMessage()),(0,i.Z)("div",{className:"active-posters ui-ready"},void 0,(0,i.Z)("ul",{className:"list-group"},void 0,this.props.users.map(((e,t)=>(0,i.Z)(k,{user:e,rank:e.rank,counter:t+1},e.id)))))))}},S=s(6935),E=s(55547),L=s(90287),T=s(53328),P=class extends n().Component{constructor(e){super(e),(0,l.Z)(this,"update",(e=>{L.Z.dispatch((0,S.ZB)(e.results)),this.setState({isLoaded:!0,trackedPeriod:e.tracked_period,count:e.count})})),w.Z.has("USERS")?this.initWithPreloadedData(w.Z.pop("USERS")):this.initWithoutPreloadedData(),this.startPolling()}initWithPreloadedData(e){this.state={isLoaded:!0,trackedPeriod:e.tracked_period,count:e.count},L.Z.dispatch((0,S.ZB)(e.results))}initWithoutPreloadedData(){this.state={isLoaded:!1}}startPolling(){E.Z.start({poll:"active-posters",url:w.Z.get("USERS_API"),data:{list:"active"},frequency:9e4,update:this.update})}componentDidMount(){T.Z.set({title:this.props.route.extra.name,parent:gettext("Users")})}componentWillUnmount(){E.Z.stop("active-posters")}render(){const e={name:this.props.route.extra.name};return this.state.isLoaded?this.state.count>0?(0,i.Z)(C,{page:e,users:this.props.users,trackedPeriod:this.state.trackedPeriod,count:this.state.count}):(0,i.Z)(b,{page:e,trackedPeriod:this.state.trackedPeriod}):(0,i.Z)(x,{page:e})}},O=class extends n().Component{getClassName(){return this.props.copy&&this.props.copy.length&&1===function(e,t){if(e=(e+"").toLowerCase(),(t=(t+"").toLowerCase()).length<=0)return 0;let s=0,a=0,i=t.length;for(;a=e.indexOf(t,a),a>=0;)s+=1,a+=i;return s}(this.props.copy,"<p")&&-1===this.props.copy.indexOf("<br")?"page-lead lead":"page-lead"}render(){return this.props.copy&&this.props.copy.length?(0,i.Z)("div",{className:this.getClassName(),dangerouslySetInnerHTML:{__html:this.props.copy}}):null}},R=s(40429),A=e=>{let{users:t}=e;return(0,i.Z)(R.Z,{cols:4,isReady:!0,showStatus:!0,users:t})};class I extends n().Component{constructor(){super(...arguments),(0,l.Z)(this,"render",(()=>g||(g=(0,i.Z)(R.Z,{cols:4,isReady:!1}))))}shouldComponentUpdate(){return!1}}var D,j,z,U,M,B,q,H,F,Y=I,V=s(92490),G=e=>{let{users:t}=e;return t.more?(0,i.Z)("p",{},void 0,interpolate(ngettext("There is %(more)s more member with this role.","There are %(more)s more members with this role.",t.more),{more:t.more},!0)):(0,i.Z)("p",{},void 0,gettext("There are no more members with this role."))},$=e=>{let{baseUrl:t,users:s}=e;return(0,i.Z)("div",{className:"misago-pagination"},void 0,s.isLoaded&&s.first?(0,i.Z)(c.rU,{className:"btn btn-default btn-outline btn-icon",to:t,title:gettext("Go to first page")},void 0,D||(D=(0,i.Z)("span",{className:"material-icon"},void 0,"first_page"))):(0,i.Z)("button",{className:"btn btn-default btn-outline btn-icon",title:gettext("Go to first page"),type:"button",disabled:!0},void 0,j||(j=(0,i.Z)("span",{className:"material-icon"},void 0,"first_page"))),s.isLoaded&&s.previous?(0,i.Z)(c.rU,{className:"btn btn-default btn-outline btn-icon",to:t+(s.previous>1?s.previous+"/":""),title:gettext("Go to previous page")},void 0,z||(z=(0,i.Z)("span",{className:"material-icon"},void 0,"chevron_left"))):(0,i.Z)("button",{className:"btn btn-default btn-outline btn-icon",title:gettext("Go to previous page"),type:"button",disabled:!0},void 0,U||(U=(0,i.Z)("span",{className:"material-icon"},void 0,"chevron_left"))),s.isLoaded&&s.next?(0,i.Z)(c.rU,{className:"btn btn-default btn-outline btn-icon",to:t+s.next+"/",title:gettext("Go to next page")},void 0,M||(M=(0,i.Z)("span",{className:"material-icon"},void 0,"chevron_right"))):(0,i.Z)("button",{className:"btn btn-default btn-outline btn-icon",title:gettext("Go to next page"),type:"button",disabled:!0},void 0,B||(B=(0,i.Z)("span",{className:"material-icon"},void 0,"chevron_right"))),s.isLoaded&&s.last?(0,i.Z)(c.rU,{className:"btn btn-default btn-outline btn-icon",to:t+s.last+"/",title:gettext("Go to last page")},void 0,q||(q=(0,i.Z)("span",{className:"material-icon"},void 0,"last_page"))):(0,i.Z)("button",{className:"btn btn-default btn-outline btn-icon",title:gettext("Go to last page"),type:"button",disabled:!0},void 0,H||(H=(0,i.Z)("span",{className:"material-icon"},void 0,"last_page"))))},W=e=>{let{baseUrl:t,users:s}=e;return(0,i.Z)(V.o8,{},void 0,(0,i.Z)(V.Z2,{},void 0,(0,i.Z)(V.Eg,{},void 0,(0,i.Z)($,{baseUrl:t,users:s}))),(0,i.Z)(V.Z2,{auto:!0},void 0,(0,i.Z)(V.Eg,{},void 0,(0,i.Z)(G,{users:s}))))},Q=class extends n().Component{constructor(e){super(e),(0,l.Z)(this,"update",(e=>{L.Z.dispatch((0,S.ZB)(e.results)),e.isLoaded=!0,this.setState(e)})),w.Z.has("USERS")?this.initWithPreloadedData(w.Z.pop("USERS")):this.initWithoutPreloadedData(),this.startPolling(e.params.page||1)}initWithPreloadedData(e){this.state=Object.assign(e,{isLoaded:!0}),L.Z.dispatch((0,S.ZB)(e.results))}initWithoutPreloadedData(){this.state={isLoaded:!1}}startPolling(e){E.Z.start({poll:"rank-users",url:w.Z.get("USERS_API"),data:{rank:this.props.route.rank.id,page:e},frequency:9e4,update:this.update})}componentDidMount(){T.Z.set({title:this.props.route.rank.name,page:this.props.params.page||null,parent:gettext("Users")})}componentWillUnmount(){E.Z.stop("rank-users")}componentWillReceiveProps(e){this.props.params.page!==e.params.page&&(T.Z.set({title:this.props.route.rank.name,page:e.params.page||null,parent:gettext("Users")}),this.setState({isLoaded:!1}),E.Z.stop("rank-users"),this.startPolling(e.params.page))}getClassName(){return this.props.route.rank.css_class?"rank-users-list rank-users-"+this.props.route.rank.css_class:"rank-users-list"}getRankDescription(){return this.props.route.rank.description?(0,i.Z)("div",{className:"rank-description"},void 0,(0,i.Z)(O,{copy:this.props.route.rank.description.html})):null}getComponent(){return this.state.isLoaded?this.state.count>0?(0,i.Z)(A,{users:this.props.users}):(0,i.Z)("p",{className:"lead"},void 0,gettext("There are no users with this rank at the moment.")):F||(F=(0,i.Z)(Y,{}))}render(){return(0,i.Z)("div",{className:this.getClassName()},void 0,(0,i.Z)(d.Z,{},void 0,(0,i.Z)(Z,{baseUrl:w.Z.get("USERS_LIST_URL"),page:{name:this.props.route.rank.name},pages:w.Z.get("USERS_LISTS")}),this.getRankDescription(),this.getComponent(),(0,i.Z)(W,{baseUrl:w.Z.get("USERS_LIST_URL")+this.props.route.rank.slug+"/",users:this.state})))}},K=s(82125),J=s(99755),X=class extends K.Z{render(){return(0,i.Z)("div",{className:"page page-users-lists"},void 0,(0,i.Z)(J.sP,{},void 0,(0,i.Z)(J.mr,{styleName:"users-lists"},void 0,(0,i.Z)(J.gC,{styleName:"users-lists"},void 0,(0,i.Z)("h1",{},void 0,gettext("Users"))))),this.props.children)}};function ee(e){return{tick:e.tick.tick,user:e.auth.user,users:e.users}}function te(){let e=[];return w.Z.get("USERS_LISTS").forEach((function(t){"rank"===t.component?(e.push({path:w.Z.get("USERS_LIST_URL")+t.slug+"/:page/",component:(0,r.$j)(ee)(Q),rank:t}),e.push({path:w.Z.get("USERS_LIST_URL")+t.slug+"/",component:(0,r.$j)(ee)(Q),rank:t})):"active-posters"===t.component&&e.push({path:w.Z.get("USERS_LIST_URL")+t.component+"/",component:(0,r.$j)(ee)(P),extra:{name:t.name}})})),e}var se=s(39633);w.Z.addInitializer({name:"component:users",initializer:function(e){e.has("USERS_LISTS")&&(0,se.Z)({root:w.Z.get("USERS_LIST_URL"),component:X,paths:te()})},after:"store"})},97751:function(e,t,s){"use strict";var a=s(32233),i=s(96142);a.Z.addInitializer({name:"include",initializer:function(e){i.Z.init(e.get("STATIC_URL"))}})},76093:function(e,t,s){"use strict";var a=s(32233),i=s(62833);a.Z.addInitializer({name:"local-storage",initializer:function(){i.Z.init("misago_")}})},19764:function(e,t,s){"use strict";var a=s(32233),i=s(8621);a.Z.addInitializer({name:"dropdown",initializer:function(){let e=document.getElementById("mobile-navbar-dropdown-mount");e&&i.Z.init(e)},before:"store"})},47549:function(e,t,s){"use strict";var a=s(32233),i=s(59801);a.Z.addInitializer({name:"modal",initializer:function(){let e=document.getElementById("modal-mount");e&&i.Z.init(e)},before:"store"})},22331:function(e,t,s){"use strict";var a=s(30381),i=s.n(a),o=s(32233),n=s(19755);o.Z.addInitializer({name:"moment",initializer:function(){i().locale(n("html").attr("lang"))}})},21513:function(e,t,s){"use strict";var a=s(32233),i=s(53328);a.Z.addInitializer({name:"page-title",initializer:function(e){i.Z.init(e.get("SETTINGS").forum_index_title,e.get("SETTINGS").forum_name)}})},98749:function(e,t,s){"use strict";var a=s(32233),i=s(78657),o=s(53904),n=s(55547);a.Z.addInitializer({name:"polls",initializer:function(){n.Z.init(i.Z,o.Z)}})},98251:function(e,t,s){"use strict";var a=s(32233),i=s(78657),o=s(64646),n=s(53904);a.Z.addInitializer({name:"posting",initializer:function(){o.Z.init(i.Z,n.Z,document.getElementById("posting-mount"))}})},6720:function(e,t,s){"use strict";var a=s(32233),i=s(35486),o=s(90287);a.Z.addInitializer({name:"reducer:auth",initializer:function(e){o.Z.addReducer("auth",i.ZP,Object.assign({isAuthenticated:e.get("isAuthenticated"),isAnonymous:!e.get("isAuthenticated"),user:e.get("user")},i.E3))},before:"store"})},10846:function(e,t,s){"use strict";var a=s(32233),i=s(8154),o=s(90287);a.Z.addInitializer({name:"reducer:participants",initializer:function(){let e=null;a.Z.has("THREAD")&&(e=a.Z.get("THREAD").participants),o.Z.addReducer("participants",i.ZP,e||[])},before:"store"})},18255:function(e,t,s){"use strict";var a=s(32233),i=s(59752),o=s(90287);a.Z.addInitializer({name:"reducer:poll",initializer:function(){let e=null;e=a.Z.has("THREAD")&&a.Z.get("THREAD").poll?(0,i.ZB)(a.Z.get("THREAD").poll):{},o.Z.addReducer("poll",i.ZP,e)},before:"store"})},14113:function(e,t,s){"use strict";var a=s(32233),i=s(21981),o=s(90287);a.Z.addInitializer({name:"reducer:posts",initializer:function(){let e=null;e=a.Z.has("POSTS")?(0,i.ZB)(a.Z.get("POSTS")):{isLoaded:!1,isBusy:!1},o.Z.addReducer("posts",i.ZP,e)},before:"store"})},24444:function(e,t,s){"use strict";var a=s(32233),i=s(58598),o=s(90287);a.Z.addInitializer({name:"reducer:profile-details",initializer:function(){let e=null;a.Z.has("PROFILE_DETAILS")&&(e=a.Z.get("PROFILE_DETAILS")),o.Z.addReducer("profile-details",i.ZP,e||{})},before:"store"})},1764:function(e,t,s){"use strict";var a=s(32233),i=s(27519),o=s(90287);a.Z.addInitializer({name:"reducer:profile-hydrate",initializer:function(){a.Z.has("PROFILE")&&o.Z.dispatch((0,i.ZB)(a.Z.get("PROFILE")))},after:"store"})},68351:function(e,t,s){"use strict";var a=s(32233),i=s(27519),o=s(90287);a.Z.addInitializer({name:"reducer:profile",initializer:function(){o.Z.addReducer("profile",i.ZP,{})},before:"store"})},81521:function(e,t,s){"use strict";var a=s(32233),i=s(16427),o=s(90287);a.Z.addInitializer({name:"reducer:search",initializer:function(){o.Z.addReducer("search",i.ZP,Object.assign({},i.E3,{providers:a.Z.get("SEARCH_PROVIDERS")||[],query:a.Z.get("SEARCH_QUERY")||""}))},before:"store"})},19984:function(e,t,s){"use strict";var a=s(32233),i=s(77751),o=s(90287);a.Z.addInitializer({name:"reducer:selection",initializer:function(){o.Z.addReducer("selection",i.ZP,[])},before:"store"})},41229:function(e,t,s){"use strict";var a=s(32233),i=s(27346),o=s(90287);a.Z.addInitializer({name:"reducer:snackbar",initializer:function(){o.Z.addReducer("snackbar",i.ZP,i.E3)},before:"store"})},43589:function(e,t,s){"use strict";var a=s(32233),i=s(7738),o=s(90287);a.Z.addInitializer({name:"reducer:thread",initializer:function(){let e=null;e=a.Z.has("THREAD")?(0,i.ZB)(a.Z.get("THREAD")):{isBusy:!1},o.Z.addReducer("thread",i.ZP,e)},before:"store"})},24108:function(e,t,s){"use strict";var a=s(32233),i=s(61340),o=s(90287);a.Z.addInitializer({name:"reducer:threads",initializer:function(){o.Z.addReducer("threads",i.ZP,[])},before:"store"})},33934:function(e,t,s){"use strict";var a=s(32233),i=s(85586),o=s(90287);a.Z.addInitializer({name:"reducer:tick",initializer:function(){o.Z.addReducer("tick",i.ZP,i.E3)},before:"store"})},85577:function(e,t,s){"use strict";var a=s(32233),i=s(48927),o=s(90287);a.Z.addInitializer({name:"reducer:username-history",initializer:function(){o.Z.addReducer("username-history",i.ZP,[])},before:"store"})},83526:function(e,t,s){"use strict";var a=s(32233),i=s(6935),o=s(90287);a.Z.addInitializer({name:"reducer:users",initializer:function(){o.Z.addReducer("users",i.ZP,[])},before:"store"})},43060:function(e,t,s){"use strict";var a=s(32233),i=s(53904),o=s(90287);a.Z.addInitializer({name:"snackbar",initializer:function(){i.Z.init(o.Z)},after:"store"})},92292:function(e,t,s){"use strict";var a=s(32233),i=s(90287);a.Z.addInitializer({name:"store",initializer:function(){i.Z.init()},before:"_end"})},33409:function(e,t,s){"use strict";var a=s(32233),i=s(85586),o=s(90287);a.Z.addInitializer({name:"tick-start",initializer:function(){window.setInterval((function(){o.Z.dispatch((0,i.bq)())}),5e4)},after:"store"})},31341:function(e,t,s){"use strict";var a=s(32233),i=s(96142),o=s(59940);a.Z.addInitializer({name:"zxcvbn",initializer:function(){o.Z.init(i.Z)}})},35486:function(e,t,s){"use strict";s.d(t,{E3:function(){return i},ZP:function(){return p},r$:function(){return l},w7:function(){return c},zB:function(){return d}});var a=s(6935),i={signedIn:!1,signedOut:!1};const o="PATCH_USER",n="SIGN_IN",r="SIGN_OUT";function l(e){return{type:o,patch:e}}function d(e){return{type:n,user:e}}function c(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return{type:r,soft:e}}function p(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:i,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;switch(t.type){case o:let s=Object.assign({},e);return s.user=Object.assign({},e.user,t.patch),s;case n:return Object.assign({},e,{signedIn:t.user});case r:return Object.assign({},e,{isAuthenticated:!1,isAnonymous:!0,signedOut:!t.soft});case a.oB:if(e.isAuthenticated&&e.user.id===t.userId){let s=Object.assign({},e);return s.user=Object.assign({},e.user,{avatars:t.avatars}),s}return e;case a.D9:if(e.isAuthenticated&&e.user.id===t.userId){let s=Object.assign({},e);return s.user=Object.assign({},e.user,{username:t.username,slug:t.slug}),s}return e;default:return e}}},8154:function(e,t,s){"use strict";s.d(t,{ZP:function(){return o},gx:function(){return i}});const a="REPLACE_PARTICIPANTS";function i(e){return{type:a,state:e}}function o(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return t.type===a?t.state:e}},59752:function(e,t,s){"use strict";s.d(t,{Ar:function(){return u},Od:function(){return m},ZB:function(){return c},ZH:function(){return r},ZP:function(){return v},b9:function(){return l},gx:function(){return h},n6:function(){return p}});var a=s(30381),i=s.n(a);const o="BUSY_POLL",n="RELEASE_POLL",r="REMOVE_POLL",l="REPLACE_POLL",d="UPDATE_POLL";function c(e){let t=!1;for(const s in e.choices)if(e.choices[s].selected){t=!0;break}return Object.assign({},e,{posted_on:i()(e.posted_on),hasSelectedChoices:t,endsOn:e.length?i()(e.posted_on).add(e.length,"days"):null,isBusy:!1})}function p(){return{type:o}}function u(){return{type:n}}function h(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return{type:l,state:t?e:c(e)}}function m(){return{type:r}}function v(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;switch(t.type){case o:return Object.assign({},e,{isBusy:!0});case n:return Object.assign({},e,{isBusy:!1});case r:return{isBusy:!1};case l:return t.state;case d:return Object.assign({},e,t.data);default:return e}}},92747:function(e,t,s){"use strict";s.d(t,{Qu:function(){return n},ZB:function(){return r},ZP:function(){return c},r$:function(){return d}});var a=s(30381),i=s.n(a),o=s(6935);const n="PATCH_POST";function r(e){return Object.assign({},e,{posted_on:i()(e.posted_on),updated_on:i()(e.updated_on),hidden_on:i()(e.hidden_on),attachments:e.attachments?e.attachments.map(l):null,poster:e.poster?(0,o.Ru)(e.poster):null,isSelected:!1,isBusy:!1,isDeleted:!1})}function l(e){return Object.assign({},e,{uploaded_on:i()(e.uploaded_on)})}function d(e,t){return{type:n,post:e,patch:t}}function c(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return t.type===n&&e.id==t.post.id?Object.assign({},e,t.patch):e}},21981:function(e,t,s){"use strict";s.d(t,{R3:function(){return g},Rz:function(){return Z},Vx:function(){return b},Ys:function(){return p},ZB:function(){return m},ZP:function(){return f},_H:function(){return u},kR:function(){return h},zD:function(){return v}});var a=s(92747);const i="APPEND_POSTS",o="SELECT_POST",n="DESELECT_POST",r="DESELECT_POSTS",l="LOAD_POSTS",d="UNLOAD_POSTS",c="UPDATE_POSTS";function p(e){return{type:o,post:e}}function u(e){return{type:n,post:e}}function h(){return{type:r}}function m(e){return Object.assign({},e,{results:e.results.map(a.ZB),isLoaded:!0,isBusy:!1,isSelected:!1})}function v(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return{type:l,state:t?e:m(e)}}function g(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return{type:i,state:t?e:m(e)}}function Z(){return{type:d}}function b(e){return{type:c,update:e}}function f(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;switch(t.type){case o:const s=e.results.map((e=>e.id==t.post.id?Object.assign({},e,{isSelected:!0}):e));return Object.assign({},e,{results:s});case n:const p=e.results.map((e=>e.id==t.post.id?Object.assign({},e,{isSelected:!1}):e));return Object.assign({},e,{results:p});case r:const u=e.results.map((e=>Object.assign({},e,{isSelected:!1})));return Object.assign({},e,{results:u});case i:let h=e.results.slice();const m=e.results.map((e=>e.id));return t.state.results.map((e=>{-1===m.indexOf(e.id)&&h.push(e)})),Object.assign({},t.state,{results:h});case l:return t.state;case d:return Object.assign({},e,{isLoaded:!1});case c:return Object.assign({},e,t.update);case a.Qu:const v=e.results.map((e=>(0,a.ZP)(e,t)));return Object.assign({},e,{results:v});default:return e}}},58598:function(e,t,s){"use strict";s.d(t,{ZP:function(){return o},zD:function(){return i}});const a="LOAD_DETAILS";function i(e){return{type:a,newState:e}}function o(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return t.type===a?t.newState:e}},27519:function(e,t,s){"use strict";s.d(t,{ZB:function(){return l},ZP:function(){return c},r$:function(){return d}});var a=s(30381),i=s.n(a),o=s(6935);const n="HYDRATE_PROFILE",r="PATCH_PROFILE";function l(e){return{type:n,profile:e}}function d(e){return{type:r,patch:e}}function c(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;switch(t.type){case n:return Object.assign({},t.profile,{joined_on:i()(t.profile.joined_on),status:(0,o.$q)(t.profile.status)});case r:return Object.assign({},e,t.patch);case o.oB:return e.id===t.userId?Object.assign({},e,{avatars:t.avatars}):e;case o.D9:return e.id===t.userId?Object.assign({},e,{username:t.username,slug:t.slug}):e;default:return e}}},16427:function(e,t,s){"use strict";s.d(t,{E3:function(){return n},P0:function(){return l},Vx:function(){return r},ZP:function(){return d}});const a="REPLACE_SEARCH",i="UPDATE_SEARCH",o="UPDATE_SEARCH_PROVIDER",n={isLoading:!1,query:"",providers:[]};function r(e){return{type:i,update:e}}function l(e){return{type:o,provider:e}}function d(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;switch(t.type){case a:return t.state;case i:return Object.assign({},e,t.update);case o:return Object.assign({},e,{providers:e.providers.map((e=>e.id===t.provider.id?t.provider:e))});default:return e}}},77751:function(e,t,s){"use strict";s.d(t,{$6:function(){return r},YP:function(){return l},ZP:function(){return c},wc:function(){return d}});var a=s(20370);const i="SELECT_ALL",o="SELECT_NONE",n="SELECT_ITEM";function r(e){return{type:i,items:e}}function l(){return{type:o}}function d(e){return{type:n,item:e}}function c(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;switch(t.type){case i:return t.items;case o:return[];case n:return(0,a.ZN)(e,t.item);default:return e}}},27346:function(e,t,s){"use strict";s.d(t,{E3:function(){return a},OV:function(){return n},ZP:function(){return l},p2:function(){return r}});var a={type:"info",message:"",isVisible:!1};const i="SHOW_SNACKBAR",o="HIDE_SNACKBAR";function n(e,t){return{type:i,message:e,messageType:t}}function r(){return{type:o}}function l(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:a,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return t.type===i?{type:t.messageType,message:t.message,isVisible:!0}:t.type===o?Object.assign({},e,{isVisible:!1}):e}},7738:function(e,t,s){"use strict";s.d(t,{Ar:function(){return h},Vx:function(){return v},ZB:function(){return p},ZP:function(){return Z},gx:function(){return m},n6:function(){return u},y8:function(){return g}});var a=s(30381),i=s.n(a),o=s(59752);const n="BUSY_THREAD",r="RELEASE_THREAD",l="REPLACE_THREAD",d="UPDATE_THREAD",c="UPDATE_THREAD_ACL";function p(e){return Object.assign({},e,{started_on:i()(e.started_on),last_post_on:i()(e.last_post_on),best_answer_marked_on:e.best_answer_marked_on?i()(e.best_answer_marked_on):null,isBusy:!1})}function u(){return{type:n}}function h(){return{type:r}}function m(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return{type:l,state:t?e:p(e)}}function v(e){return{type:d,data:e}}function g(e){return{type:c,data:e}}function Z(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;switch(t.type){case n:return Object.assign({},e,{isBusy:!0});case r:return Object.assign({},e,{isBusy:!1});case o.ZH:return Object.assign({},e,{poll:null});case o.b9:return Object.assign({},e,{poll:t.state});case l:return t.state;case d:return Object.assign({},e,t.data);case c:const s=Object.assign({},e.acl,t.data);return Object.assign({},e,{acl:s});default:return e}}},61340:function(e,t,s){"use strict";s.d(t,{R3:function(){return h},V8:function(){return v},ZB:function(){return g},ZP:function(){return _},l8:function(){return m},r$:function(){return Z}});var a=s(30381),i=s.n(a),o=s(89759);const n="APPEND_THREADS",r="DELETE_THREAD",l="FILTER_THREADS",d="HYDRATE_THREADS",c="PATCH_THREAD",p="SORT_THREADS",u=["can_announce","can_approve","can_close","can_hide","can_move","can_merge","can_pin","can_review"];function h(e,t){return{type:n,items:e,sorting:t}}function m(e){return{type:r,thread:e}}function v(e,t){return{type:l,category:e,categoriesMap:t}}function g(e){return{type:d,items:e}}function Z(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return{type:c,thread:e,patch:t,sorting:s}}function b(e){let t=[];return u.forEach((function(s){e[s]&&t.push(s)})),t}function f(e){return Object.assign({},e,{started_on:i()(e.started_on),last_post_on:i()(e.last_post_on),moderation:b(e.acl)})}function _(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;switch(t.type){case n:return(0,o.Z)(t.items.map(f),e).sort(t.sorting);case r:return e.filter((function(e){return e.id!==t.thread.id}));case l:return e.filter((function(e){const s=t.categoriesMap[e.category];return s.lft>=t.category.lft&&s.rght<=t.category.rght||2==e.weight}));case d:return t.items.map(f);case c:const s=e.map((function(e){return e.id===t.thread.id?Object.assign({},e,t.patch):e}));return t.sorting?s.sort(t.sorting):s;case p:return e.sort(t.sorting);default:return e}}},85586:function(e,t,s){"use strict";s.d(t,{E3:function(){return a},ZP:function(){return n},bq:function(){return o}});var a={tick:0};const i="TICK";function o(){return{type:i}}function n(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:a,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return t.type===i?Object.assign({},e,{tick:e.tick+1}):e}},48927:function(e,t,s){"use strict";s.d(t,{KP:function(){return c},R3:function(){return p},ZB:function(){return u},ZP:function(){return m}});var a=s(30381),i=s.n(a),o=s(6935),n=s(89759);const r="ADD_NAME_CHANGE",l="APPEND_HISTORY",d="HYDRATE_HISTORY";function c(e,t,s){return{type:r,change:e,user:t,changedBy:s}}function p(e){return{type:l,items:e}}function u(e){return{type:d,items:e}}function h(e){return Object.assign({},e,{changed_on:i()(e.changed_on)})}function m(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;switch(t.type){case r:let s=e.slice();return s.unshift({id:Math.floor(Date.now()/1e3),changed_by:t.changedBy,changed_by_username:t.changedBy.username,changed_on:i()(),new_username:t.change.username,old_username:t.user.username}),s;case l:return(0,n.Z)(e,t.items.map(h));case d:return t.items.map(h);case o.oB:return e.map((function(e){return(e=Object.assign({},e)).changed_by&&e.changed_by.id===t.userId&&(e.changed_by=Object.assign({},e.changed_by,{avatars:t.avatars})),e}));case o.D9:return e.map((function(e){return(e=Object.assign({},e)).changed_by&&e.changed_by.id===t.userId&&(e.changed_by=Object.assign({},e.changed_by,{username:t.username,slug:t.slug})),Object.assign({},e)}));default:return e}}},6935:function(e,t,s){"use strict";s.d(t,{$q:function(){return u},D9:function(){return d},R3:function(){return c},Ru:function(){return h},ZB:function(){return p},ZP:function(){return g},_S:function(){return v},n1:function(){return m},oB:function(){return l}});var a=s(30381),i=s.n(a),o=s(89759);const n="APPEND_USERS",r="HYDRATE_USERS",l="UPDATE_AVATAR",d="UPDATE_USERNAME";function c(e){return{type:n,items:e}}function p(e){return{type:r,items:e}}function u(e){return e?Object.assign({},e,{last_click:e.last_click?i()(e.last_click):null,banned_until:e.banned_until?i()(e.banned_until):null}):null}function h(e){return Object.assign({},e,{joined_on:i()(e.joined_on),status:u(e.status)})}function m(e,t){return{type:l,userId:e.id,avatars:t}}function v(e,t,s){return{type:d,userId:e.id,username:t,slug:s}}function g(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;switch(t.type){case n:return(0,o.Z)(e,t.items.map(h));case r:return t.items.map(h);case l:return e.map((function(e){return(e=Object.assign({},e)).id===t.userId&&(e.avatars=t.avatars),e}));default:return e}}},78657:function(e,t,s){"use strict";var a=s(19755);t.Z=new class{constructor(){this._cookieName=null,this._csrfToken=null,this._locks={}}init(e){this._cookieName=e}getCsrfToken(){if(-1!==document.cookie.indexOf(this._cookieName)){let e=new RegExp(this._cookieName+"=([^;]*)"),t=document.cookie.match(e)[0];return t?t.split("=")[1]:null}return null}request(e,t,s){let i=this;return new Promise((function(o,n){let r={url:t,method:e,headers:{"X-CSRFToken":i.getCsrfToken()},data:s?JSON.stringify(s):null,contentType:"application/json; charset=utf-8",dataType:"json",success:function(e){o(e)},error:function(e){let t=e.responseJSON||{};t.status=e.status,0===t.status&&(t.detail=gettext("Lost connection with application.")),404===t.status&&(t.detail&&"NOT FOUND"!==t.detail||(t.detail=gettext("Action link is invalid."))),500!==t.status||t.detail||(t.detail=gettext("Unknown error has occured.")),t.statusText=e.statusText,n(t)}};a.ajax(r)}))}get(e,t,s){if(t&&(e+="?"+a.param(t)),s){let t=this;return this._locks[s]&&(this._locks[s].url=e),this._locks[s]&&this._locks[s].waiter?{then:function(){}}:this._locks[s]&&this._locks[s].wait?(this._locks[s].waiter=!0,new Promise((function(a,i){let o=function(e){t._locks[s].wait?window.setTimeout((function(){o(e)}),300):t._locks[s].url!==e?o(t._locks[s].url):(t._locks[s].waiter=!1,t.request("GET",t._locks[s].url).then((function(i){t._locks[s].url===e?a(i):(t._locks[s].waiter=!0,o(t._locks[s].url))}),(function(a){t._locks[s].url===e?i(a):(t._locks[s].waiter=!0,o(t._locks[s].url))})))};window.setTimeout((function(){o(e)}),300)}))):(this._locks[s]={url:e,wait:!0,waiter:!1},new Promise((function(a,i){t.request("GET",e).then((function(i){t._locks[s].wait=!1,t._locks[s].url===e&&a(i)}),(function(a){t._locks[s].wait=!1,t._locks[s].url===e&&i(a)}))})))}return this.request("GET",e)}post(e,t){return this.request("POST",e,t)}patch(e,t){return this.request("PATCH",e,t)}put(e,t){return this.request("PUT",e,t)}delete(e,t){return this.request("DELETE",e,t)}upload(e,t,s){let i=this;return new Promise((function(o,n){let r={url:e,method:"POST",headers:{"X-CSRFToken":i.getCsrfToken()},data:t,contentType:!1,processData:!1,xhr:function(){let e=new window.XMLHttpRequest;return e.upload.addEventListener("progress",(function(e){e.lengthComputable&&s(Math.round(e.loaded/e.total*100))}),!1),e},success:function(e){o(e)},error:function(e){let t=e.responseJSON||{};t.status=e.status,0===t.status&&(t.detail=gettext("Lost connection with application.")),413!==t.status||t.detail||(t.detail=gettext("Upload was rejected by server as too large.")),404===t.status&&(t.detail&&"NOT FOUND"!==t.detail||(t.detail=gettext("Action link is invalid."))),500!==t.status||t.detail||(t.detail=gettext("Unknown error has occured.")),t.statusText=e.statusText,n(t)}};a.ajax(r)}))}}},98274:function(e,t,s){"use strict";var a=s(35486);t.Z=new class{init(e,t,s){this._store=e,this._local=t,this._modal=s,this.syncSession(),this.watchState()}syncSession(){const e=this._store.getState().auth;e.isAuthenticated?this._local.set("auth",{isAuthenticated:!0,username:e.user.username}):this._local.set("auth",{isAuthenticated:!1})}watchState(){const e=this._store.getState().auth;this._local.watch("auth",(t=>{t.isAuthenticated?this._store.dispatch((0,a.zB)({username:t.username})):e.isAuthenticated&&this._store.dispatch((0,a.w7)())})),this._modal.hide()}signIn(e){this._store.dispatch((0,a.zB)(e)),this._local.set("auth",{isAuthenticated:!0,username:e.username}),this._modal.hide()}signOut(){this._store.dispatch((0,a.w7)()),this._local.set("auth",{isAuthenticated:!1}),this._modal.hide()}softSignOut(){this._store.dispatch((0,a.w7)(!0)),this._local.set("auth",{isAuthenticated:!1}),this._modal.hide()}}},93825:function(e,t,s){"use strict";var a,i=s(22928),o=s(57588),n=s.n(o),r=s(96359);class l{init(e,t,s,a){this._context=e,this._ajax=t,this._include=s,this._snackbar=a}}class d extends l{load(){return new Promise((function(e){e()}))}validator(){return null}component(){return null}}class c extends l{load(){var e=this;return new Promise(((t,s)=>{e._ajax.get(e._context.get("CAPTCHA_API")).then((function(s){e.question=s.question,e.helpText=s.help_text,t()}),(function(){e._snackbar.error(gettext("Failed to load CAPTCHA.")),s()}))}))}validator(){return[]}component(e){return(0,i.Z)(r.Z,{label:this.question,for:"id_captcha",labelClass:e.labelClass||"",controlClass:e.controlClass||"",validation:e.form.state.errors.captcha,helpText:this.helpText||null},void 0,(0,i.Z)("input",{"aria-describedby":"id_captcha_status",className:"form-control",disabled:e.form.state.isLoading,id:"id_captcha",onChange:e.form.bindInput("captcha"),type:"text",value:e.form.state.captcha}))}}class p extends n().Component{componentDidMount(){grecaptcha.render("recaptcha",{sitekey:this.props.siteKey,callback:e=>{this.props.binding({target:{value:e}})}})}render(){return a||(a=(0,i.Z)("div",{id:"recaptcha"}))}}class u extends l{load(){return this._include.include("https://www.google.com/recaptcha/api.js",!0),new Promise((function(e){var t=function(){"undefined"==typeof grecaptcha?window.setTimeout((function(){t()}),200):e()};t()}))}validator(){return[]}component(e){return(0,i.Z)(r.Z,{label:gettext("Please solve the quick test"),for:"id_captcha",labelClass:e.labelClass||"",controlClass:e.controlClass||"",validation:e.form.state.errors.captcha,helpText:gettext("This test helps us prevent automated spam registrations on our site.")},void 0,(0,i.Z)(p,{binding:e.form.bindInput("captcha"),siteKey:this._context.get("SETTINGS").recaptcha_site_key}))}}t.ZP=new class{init(e,t,s,a){switch(e.get("SETTINGS").captcha_type){case"no":this._captcha=new d;break;case"qa":this._captcha=new c;break;case"re":this._captcha=new u}this._captcha.init(e,t,s,a)}load(){return this._captcha.load()}validator(){return this._captcha.validator()}component(e){return this._captcha.component(e)}}},96142:function(e,t,s){"use strict";var a=s(19755);t.Z=new class{init(e){this._staticUrl=e,this._included=[]}include(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];-1===this._included.indexOf(e)&&(this._included.push(e),this._include(e,t))}_include(e,t){a.ajax({url:(t?"":this._staticUrl)+e,cache:!0,dataType:"script"})}}},62833:function(e,t,s){"use strict";let a=window.localStorage;t.Z=new class{init(e){this._prefix=e,this._watchers=[],window.addEventListener("storage",(e=>{let t=JSON.parse(e.newValue);this._watchers.forEach((function(s){s.key===e.key&&e.oldValue!==e.newValue&&s.callback(t)}))}))}set(e,t){a.setItem(this._prefix+e,JSON.stringify(t))}get(e){let t=a.getItem(this._prefix+e);return t?JSON.parse(t):null}watch(e,t){this._watchers.push({key:this._prefix+e,callback:t})}}},8621:function(e,t,s){"use strict";var a=s(4869),i=s(19755);t.Z=new class{init(e){this._element=e,this._component=null}show(e){this._component===e?this.hide():(this._component=e,(0,a.Z)(e,this._element.id),i(this._element).addClass("open"))}showConnected(e,t){this._component===e?this.hide():(this._component=e,(0,a.Z)(t,this._element.id,!0),i(this._element).addClass("open"))}hide(){i(this._element).removeClass("open"),this._component=null}}},59801:function(e,t,s){"use strict";var a=s(73935),i=s.n(a),o=s(4869),n=s(19755);t.Z=new class{init(e){this._element=e,this._modal=n(e).modal({show:!1}),this._modal.on("hidden.bs.modal",(()=>{i().unmountComponentAtNode(this._element)}))}show(e){(0,o.Z)(e,this._element.id),this._modal.modal("show")}hide(){this._modal.modal("hide")}}},53328:function(e,t,s){"use strict";t.Z=new class{init(e,t){this._indexTitle=e,this._forumName=t}set(e){if(!e)return void(document.title=this._indexTitle||this._forumName);"string"==typeof e&&(e={title:e});let t=e.title;e.page>1&&(t+=" ("+interpolate(gettext("page: %(page)s"),{page:e.page},!0)+")"),e.parent&&(t+=" | "+e.parent),document.title=t+" | "+this._forumName}}},55547:function(e,t,s){"use strict";t.Z=new class{init(e,t){this._ajax=e,this._snackbar=t,this._polls={}}start(e){this.stop(e.poll);const t=()=>{this._polls[e.poll]=e,this._ajax.get(e.url,e.data||null).then((s=>{this._polls[e.poll]._stopped||(e.update(s),this._polls[e.poll].timeout=window.setTimeout(t,e.frequency))}),(t=>{this._polls[e.poll]._stopped||(e.error?e.error(t):this._snackbar.apiError(t))}))};e.delayed?this._polls[e.poll]={timeout:window.setTimeout(t,e.frequency)}:t()}stop(e){this._polls[e]&&(window.clearTimeout(this._polls[e].timeout),this._polls[e]._stopped=!0)}}},64646:function(e,t,s){"use strict";var a=s(4942),i=s(57588),o=s.n(i),n=s(73935),r=s.n(n),l=s(78107),d=s(4869);t.Z=new class{constructor(){(0,a.Z)(this,"close",(()=>{this._isOpen&&!this._isClosing&&(this._isClosing=!0,this._mount.classList.remove("show"),window.setTimeout((()=>{r().unmountComponentAtNode(this._mount),this._observer.unobserve(this._mount),this._spacer.style.height="0px;",this._isClosing=!1,this._isOpen=!1,this._mode=null}),300))}))}init(e,t,s){this._ajax=e,this._snackbar=t,this._mount=s,this._mode=null,this._spacer=document.getElementById("posting-spacer"),this._observer=new ResizeObserver((e=>{this._spacer.style.height=e[0].contentRect.height+"px"})),this._isOpen=!1,this._isClosing=!1}isOpen(){return this._isOpen}open(e){if(!1===this._isOpen)this._mode=e.mode,this._isOpen=e.submit,this._realOpen(e);else if(this._isOpen!==e.submit){let t=gettext("You are already working on other message. Do you want to discard it?");window.confirm(t)&&(this._mode=e.mode,this._isOpen=e.submit,this._realOpen(e))}else"REPLY"==this._mode&&"REPLY"==e.mode&&this._realOpen(e)}_realOpen(e){(0,d.Z)(o().createElement(l.ZP,e),this._mount.id),this._mount.classList.add("show"),this._observer.observe(this._mount)}}},53904:function(e,t,s){"use strict";var a=s(27346);t.Z=new class{init(e){this._store=e,this._timeout=null}alert(e,t){this._timeout?(window.clearTimeout(this._timeout),this._store.dispatch((0,a.p2)()),this._timeout=window.setTimeout((()=>{this._timeout=null,this.alert(e,t)}),300)):(this._store.dispatch((0,a.OV)(e,t)),this._timeout=window.setTimeout((()=>{this._store.dispatch((0,a.p2)()),this._timeout=null}),5e3))}info(e){this.alert(e,"info")}success(e){this.alert(e,"success")}warning(e){this.alert(e,"warning")}error(e){this.alert(e,"error")}apiError(e){let t=e.detail;t||(t=404===e.status?gettext("Action link is invalid."):gettext("Unknown error has occured.")),403===e.status&&"Permission denied"===t&&(t=gettext("You don't have permission to perform this action.")),this.error(t)}}},90287:function(e,t,s){"use strict";var a=s(41438);t.Z=new class{constructor(){this._store=null,this._reducers={},this._initialState={}}addReducer(e,t,s){this._reducers[e]=t,this._initialState[e]=s}init(){this._store=(0,a.createStore)((0,a.combineReducers)(this._reducers),this._initialState)}getStore(){return this._store}getState(){return this._store.getState()}dispatch(e){return this._store.dispatch(e)}}},59940:function(e,t,s){"use strict";t.Z=new class{init(e){this._include=e,this._isLoaded=!1}scorePassword(e,t){return this._isLoaded?zxcvbn(e,t).score:0}load(){return this._isLoaded?this._loadedPromise():(this._include.include("misago/js/zxcvbn.js"),this._loadingPromise())}_loadingPromise(){const e=this;return new Promise((function(t,s){var a=function(){let i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;i+=1,i>200?s():"undefined"==typeof zxcvbn?window.setTimeout((function(){a(i)}),200):(e._isLoaded=!0,t())};a()}))}_loadedPromise(){return new Promise((function(e){e()}))}}},93051:function(e,t,s){"use strict";s.d(t,{Z:function(){return g}});var a,i=s(22928),o=s(30381),n=s.n(o),r=s(57588),l=s.n(r),d=s(73935),c=s.n(d),p=s(37424),u=class extends l().Component{getReasonMessage(){return this.props.message.html?(0,i.Z)("div",{className:"lead",dangerouslySetInnerHTML:{__html:this.props.message.html}}):(0,i.Z)("p",{className:"lead"},void 0,this.props.message.plain)}getExpirationMessage(){if(this.props.expires){if(this.props.expires.isAfter(n()())){let e=interpolate(gettext("This ban expires on %(expires_on)s."),{expires_on:this.props.expires.format("LL, LT")},!0),t=interpolate(gettext("This ban expires %(expires_on)s."),{expires_on:this.props.expires.fromNow()},!0);return(0,i.Z)("abbr",{title:e},void 0,t)}return gettext("This ban has expired.")}return gettext("This ban is permanent.")}render(){return(0,i.Z)("div",{className:"page page-error page-error-banned"},void 0,(0,i.Z)("div",{className:"container"},void 0,(0,i.Z)("div",{className:"message-panel"},void 0,a||(a=(0,i.Z)("div",{className:"message-icon"},void 0,(0,i.Z)("span",{className:"material-icon"},void 0,"highlight_off"))),(0,i.Z)("div",{className:"message-body"},void 0,this.getReasonMessage(),(0,i.Z)("p",{className:"message-footnote"},void 0,this.getExpirationMessage())))))}},h=s(32233),m=s(90287);let v=(0,p.$j)((function(e){return e.tick}))(u);function g(e,t){if(c().render((0,i.Z)(p.zt,{store:m.Z.getStore()},void 0,(0,i.Z)(v,{message:e.message,expires:e.expires_on?n()(e.expires_on):null})),document.getElementById("page-mount")),void 0===t||t){let e=h.Z.get("SETTINGS").forum_name;document.title=gettext("You are banned")+" | "+e,window.history.pushState({},"",h.Z.get("BANNED_URL"))}}},69130:function(e,t,s){"use strict";function a(e,t){let s=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=[],i=[];if(e.forEach((function(e){i.push(e),i.length===t&&(a.push(i),i=[])})),!1!==s&&i.length>0&&i.length<t)for(let e=i.length;e<t;e++)i.push(s);return i.length&&a.push(i),a}s.d(t,{Z:function(){return a}})},89759:function(e,t,s){"use strict";function a(e,t){let s=[];return e.concat(t).filter((function(e){return-1===s.indexOf(e.id)&&(s.push(e.id),!0)}))}s.d(t,{Z:function(){return a}})},89627:function(e,t,s){"use strict";s.d(t,{Z:function(){return i}});const a={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#039;"};function i(e){return e.replace(/[&<>"']/g,(function(e){return a[e]}))}},48772:function(e,t,s){"use strict";function a(e){return e>1073741824?i(e/1073741824)+" GB":e>1048576?i(e/1048576)+" MB":e>1024?i(e/1024)+" KB":i(e)+" B"}function i(e){return e.toFixed(1)}s.d(t,{Z:function(){return a}})},4869:function(e,t,s){"use strict";s.d(t,{Z:function(){return l}});var a=s(22928),i=(s(57588),s(73935)),o=s.n(i),n=s(37424),r=s(90287);function l(e,t){let s=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],i=document.getElementById(t),l=e.props?e:(0,a.Z)(e,{});i&&(s?o().render((0,a.Z)(n.zt,{store:r.Z.getStore()},void 0,l),i):o().render(l,i))}},44039:function(e,t,s){"use strict";function a(e,t){return Math.floor(Math.random()*(t-e+1))+e}s.d(t,{e:function(){return a}})},39633:function(e,t,s){"use strict";s.d(t,{Z:function(){return c}});var a=s(22928),i=(s(57588),s(73935)),o=s.n(i),n=s(37424),r=s(69987),l=s(90287);const d=document.getElementById("page-mount");function c(e){let t={component:e.component||null,childRoutes:[]};e.root?t.childRoutes=[{path:e.root,onEnter:function(t,s){s(null,e.paths[0].path)}}].concat(e.paths):t.childRoutes=e.paths,o().render((0,a.Z)(n.zt,{store:l.Z.getStore()},void 0,(0,a.Z)(r.F0,{routes:t,history:r.mW})),d)}},20370:function(e,t,s){"use strict";function a(e,t){if(-1===e.indexOf(t)){let s=e.slice();return s.push(t),s}return e.filter((function(e){return e!==t}))}s.d(t,{ZN:function(){return a}})},55210:function(e,t,s){"use strict";s.d(t,{BS:function(){return p},C1:function(){return n},Do:function(){return d},Ei:function(){return c},HR:function(){return u},Vb:function(){return v},fT:function(){return r},gS:function(){return h},jA:function(){return l},lG:function(){return m}});var a=s(19755);const i=/^(([^<>()[\]\.,;:\s@\"]+(\.[^<>()[\]\.,;:\s@\"]+)*)|(\".+\"))@(([^<>()[\]\.,;:\s@\"]+\.)+[^<>()[\]\.,;:\s@\"]{2,})$/i,o=new RegExp("^[0-9a-z]+$","i");function n(e){return function(t){if(!1===t||null===t||0===a.trim(t).length)return e||gettext("This field is required.")}}function r(e){const t=gettext("You have to accept the terms of service.");return n(e||t)}function l(e){const t=gettext("You have to accept the privacy policy.");return n(e||t)}function d(e){return function(t){if(!i.test(t))return e||gettext("Enter a valid email address.")}}function c(e,t){return function(s){var i="",o=a.trim(s).length;if(o<e)return i=t?t(e,o):ngettext("Ensure this value has at least %(limit_value)s character (it has %(show_value)s).","Ensure this value has at least %(limit_value)s characters (it has %(show_value)s).",e),interpolate(i,{limit_value:e,show_value:o},!0)}}function p(e,t){return function(s){var i="",o=a.trim(s).length;if(o>e)return i=t?t(e,o):ngettext("Ensure this value has at most %(limit_value)s character (it has %(show_value)s).","Ensure this value has at most %(limit_value)s characters (it has %(show_value)s).",e),interpolate(i,{limit_value:e,show_value:o},!0)}}function u(e){return c(e,(function(e){return ngettext("Username must be at least %(limit_value)s character long.","Username must be at least %(limit_value)s characters long.",e)}))}function h(e){return p(e,(function(e){return ngettext("Username cannot be longer than %(limit_value)s character.","Username cannot be longer than %(limit_value)s characters.",e)}))}function m(){return function(e){if(!o.test(a.trim(e)))return gettext("Username can only contain latin alphabet letters and digits.")}}function v(e){return function(t){const s=t.length;if(s<e){const t=ngettext("Valid password must be at least %(limit_value)s character long.","Valid password must be at least %(limit_value)s characters long.",e);return interpolate(t,{limit_value:e,show_value:s},!0)}}}},46700:function(e,t,s){var a={"./af":42786,"./af.js":42786,"./ar":30867,"./ar-dz":14130,"./ar-dz.js":14130,"./ar-kw":96135,"./ar-kw.js":96135,"./ar-ly":56440,"./ar-ly.js":56440,"./ar-ma":47702,"./ar-ma.js":47702,"./ar-sa":16040,"./ar-sa.js":16040,"./ar-tn":37100,"./ar-tn.js":37100,"./ar.js":30867,"./az":31083,"./az.js":31083,"./be":9808,"./be.js":9808,"./bg":68338,"./bg.js":68338,"./bm":67438,"./bm.js":67438,"./bn":8905,"./bn-bd":76225,"./bn-bd.js":76225,"./bn.js":8905,"./bo":11560,"./bo.js":11560,"./br":1278,"./br.js":1278,"./bs":80622,"./bs.js":80622,"./ca":2468,"./ca.js":2468,"./cs":5822,"./cs.js":5822,"./cv":50877,"./cv.js":50877,"./cy":47373,"./cy.js":47373,"./da":24780,"./da.js":24780,"./de":59740,"./de-at":60217,"./de-at.js":60217,"./de-ch":60894,"./de-ch.js":60894,"./de.js":59740,"./dv":5300,"./dv.js":5300,"./el":50837,"./el.js":50837,"./en-au":78348,"./en-au.js":78348,"./en-ca":77925,"./en-ca.js":77925,"./en-gb":22243,"./en-gb.js":22243,"./en-ie":46436,"./en-ie.js":46436,"./en-il":47207,"./en-il.js":47207,"./en-in":44175,"./en-in.js":44175,"./en-nz":76319,"./en-nz.js":76319,"./en-sg":31662,"./en-sg.js":31662,"./eo":92915,"./eo.js":92915,"./es":55655,"./es-do":55251,"./es-do.js":55251,"./es-mx":96112,"./es-mx.js":96112,"./es-us":71146,"./es-us.js":71146,"./es.js":55655,"./et":5603,"./et.js":5603,"./eu":77763,"./eu.js":77763,"./fa":76959,"./fa.js":76959,"./fi":11897,"./fi.js":11897,"./fil":42549,"./fil.js":42549,"./fo":94694,"./fo.js":94694,"./fr":94470,"./fr-ca":63049,"./fr-ca.js":63049,"./fr-ch":52330,"./fr-ch.js":52330,"./fr.js":94470,"./fy":5044,"./fy.js":5044,"./ga":29295,"./ga.js":29295,"./gd":2101,"./gd.js":2101,"./gl":38794,"./gl.js":38794,"./gom-deva":27884,"./gom-deva.js":27884,"./gom-latn":23168,"./gom-latn.js":23168,"./gu":95349,"./gu.js":95349,"./he":24206,"./he.js":24206,"./hi":30094,"./hi.js":30094,"./hr":30316,"./hr.js":30316,"./hu":22138,"./hu.js":22138,"./hy-am":11423,"./hy-am.js":11423,"./id":29218,"./id.js":29218,"./is":90135,"./is.js":90135,"./it":90626,"./it-ch":10150,"./it-ch.js":10150,"./it.js":90626,"./ja":39183,"./ja.js":39183,"./jv":24286,"./jv.js":24286,"./ka":12105,"./ka.js":12105,"./kk":47772,"./kk.js":47772,"./km":18758,"./km.js":18758,"./kn":79282,"./kn.js":79282,"./ko":33730,"./ko.js":33730,"./ku":1408,"./ku.js":1408,"./ky":33291,"./ky.js":33291,"./lb":36841,"./lb.js":36841,"./lo":55466,"./lo.js":55466,"./lt":57010,"./lt.js":57010,"./lv":37595,"./lv.js":37595,"./me":39861,"./me.js":39861,"./mi":35493,"./mi.js":35493,"./mk":95966,"./mk.js":95966,"./ml":87341,"./ml.js":87341,"./mn":5115,"./mn.js":5115,"./mr":10370,"./mr.js":10370,"./ms":9847,"./ms-my":41237,"./ms-my.js":41237,"./ms.js":9847,"./mt":72126,"./mt.js":72126,"./my":56165,"./my.js":56165,"./nb":64924,"./nb.js":64924,"./ne":16744,"./ne.js":16744,"./nl":93901,"./nl-be":59814,"./nl-be.js":59814,"./nl.js":93901,"./nn":83877,"./nn.js":83877,"./oc-lnc":92135,"./oc-lnc.js":92135,"./pa-in":15858,"./pa-in.js":15858,"./pl":64495,"./pl.js":64495,"./pt":89520,"./pt-br":57971,"./pt-br.js":57971,"./pt.js":89520,"./ro":96459,"./ro.js":96459,"./ru":21793,"./ru.js":21793,"./sd":40950,"./sd.js":40950,"./se":10490,"./se.js":10490,"./si":90124,"./si.js":90124,"./sk":64249,"./sk.js":64249,"./sl":14985,"./sl.js":14985,"./sq":51104,"./sq.js":51104,"./sr":49131,"./sr-cyrl":79915,"./sr-cyrl.js":79915,"./sr.js":49131,"./ss":85893,"./ss.js":85893,"./sv":98760,"./sv.js":98760,"./sw":91172,"./sw.js":91172,"./ta":27333,"./ta.js":27333,"./te":23110,"./te.js":23110,"./tet":52095,"./tet.js":52095,"./tg":27321,"./tg.js":27321,"./th":9041,"./th.js":9041,"./tk":19005,"./tk.js":19005,"./tl-ph":75768,"./tl-ph.js":75768,"./tlh":89444,"./tlh.js":89444,"./tr":72397,"./tr.js":72397,"./tzl":28254,"./tzl.js":28254,"./tzm":51106,"./tzm-latn":30699,"./tzm-latn.js":30699,"./tzm.js":51106,"./ug-cn":9288,"./ug-cn.js":9288,"./uk":67691,"./uk.js":67691,"./ur":13795,"./ur.js":13795,"./uz":6791,"./uz-latn":60588,"./uz-latn.js":60588,"./uz.js":6791,"./vi":65666,"./vi.js":65666,"./x-pseudo":14378,"./x-pseudo.js":14378,"./yo":75805,"./yo.js":75805,"./zh-cn":83839,"./zh-cn.js":83839,"./zh-hk":55726,"./zh-hk.js":55726,"./zh-mo":99807,"./zh-mo.js":99807,"./zh-tw":74152,"./zh-tw.js":74152};function i(e){var t=o(e);return s(t)}function o(e){if(!s.o(a,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return a[e]}i.keys=function(){return Object.keys(a)},i.resolve=o,e.exports=i,i.id=46700}},i={};function o(e){var t=i[e];if(void 0!==t)return t.exports;var s=i[e]={id:e,loaded:!1,exports:{}};return a[e].call(s.exports,s,s.exports,o),s.loaded=!0,s.exports}o.m=a,e=[],o.O=function(t,s,a,i){if(!s){var n=1/0;for(c=0;c<e.length;c++){s=e[c][0],a=e[c][1],i=e[c][2];for(var r=!0,l=0;l<s.length;l++)(!1&i||n>=i)&&Object.keys(o.O).every((function(e){return o.O[e](s[l])}))?s.splice(l--,1):(r=!1,i<n&&(n=i));if(r){e.splice(c--,1);var d=a();void 0!==d&&(t=d)}}return t}i=i||0;for(var c=e.length;c>0&&e[c-1][2]>i;c--)e[c]=e[c-1];e[c]=[s,a,i]},o.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(t,{a:t}),t},o.d=function(e,t){for(var s in t)o.o(t,s)&&!o.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:t[s]})},o.f={},o.e=function(e){return Promise.all(Object.keys(o.f).reduce((function(t,s){return o.f[s](e,t),t}),[]))},o.u=function(e){return"hljs.js"},o.miniCssF=function(e){},o.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),o.hmd=function(e){return(e=Object.create(e)).children||(e.children=[]),Object.defineProperty(e,"exports",{enumerable:!0,set:function(){throw new Error("ES Modules may not assign module.exports or exports.*, Use ESM export syntax, instead: "+e.id)}}),e},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t={},s="misago:",o.l=function(e,a,i,n){if(t[e])t[e].push(a);else{var r,l;if(void 0!==i)for(var d=document.getElementsByTagName("script"),c=0;c<d.length;c++){var p=d[c];if(p.getAttribute("src")==e||p.getAttribute("data-webpack")==s+i){r=p;break}}r||(l=!0,(r=document.createElement("script")).charset="utf-8",r.timeout=120,o.nc&&r.setAttribute("nonce",o.nc),r.setAttribute("data-webpack",s+i),r.src=e),t[e]=[a];var u=function(s,a){r.onerror=r.onload=null,clearTimeout(h);var i=t[e];if(delete t[e],r.parentNode&&r.parentNode.removeChild(r),i&&i.forEach((function(e){return e(a)})),s)return s(a)},h=setTimeout(u.bind(null,void 0,{type:"timeout",target:r}),12e4);r.onerror=u.bind(null,r.onerror),r.onload=u.bind(null,r.onload),l&&document.head.appendChild(r)}},o.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.nmd=function(e){return e.paths=[],e.children||(e.children=[]),e},function(){var e;o.g.importScripts&&(e=o.g.location+"");var t=o.g.document;if(!e&&t&&(t.currentScript&&(e=t.currentScript.src),!e)){var s=t.getElementsByTagName("script");s.length&&(e=s[s.length-1].src)}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),o.p=e}(),function(){var e={174:0};o.f.j=function(t,s){var a=o.o(e,t)?e[t]:void 0;if(0!==a)if(a)s.push(a[2]);else{var i=new Promise((function(s,i){a=e[t]=[s,i]}));s.push(a[2]=i);var n=o.p+o.u(t),r=new Error;o.l(n,(function(s){if(o.o(e,t)&&(0!==(a=e[t])&&(e[t]=void 0),a)){var i=s&&("load"===s.type?"missing":s.type),n=s&&s.target&&s.target.src;r.message="Loading chunk "+t+" failed.\n("+i+": "+n+")",r.name="ChunkLoadError",r.type=i,r.request=n,a[1](r)}}),"chunk-"+t,t)}},o.O.j=function(t){return 0===e[t]};var t=function(t,s){var a,i,n=s[0],r=s[1],l=s[2],d=0;if(n.some((function(t){return 0!==e[t]}))){for(a in r)o.o(r,a)&&(o.m[a]=r[a]);if(l)var c=l(o)}for(t&&t(s);d<n.length;d++)i=n[d],o.o(e,i)&&e[i]&&e[i][0](),e[i]=0;return o.O(c)},s=self.webpackChunkmisago=self.webpackChunkmisago||[];s.forEach(t.bind(null,0)),s.push=t.bind(null,s.push.bind(s))}(),o.O(void 0,[736],(function(){return o(32233)})),o.O(void 0,[736],(function(){return o(58339)})),o.O(void 0,[736],(function(){return o(64109)})),o.O(void 0,[736],(function(){return o(46226)})),o.O(void 0,[736],(function(){return o(93240)})),o.O(void 0,[736],(function(){return o(75147)})),o.O(void 0,[736],(function(){return o(4894)})),o.O(void 0,[736],(function(){return o(29223)})),o.O(void 0,[736],(function(){return o(3026)})),o.O(void 0,[736],(function(){return o(94795)})),o.O(void 0,[736],(function(){return o(95563)})),o.O(void 0,[736],(function(){return o(32488)})),o.O(void 0,[736],(function(){return o(11768)})),o.O(void 0,[736],(function(){return o(61323)})),o.O(void 0,[736],(function(){return o(15049)})),o.O(void 0,[736],(function(){return o(61814)})),o.O(void 0,[736],(function(){return o(95920)})),o.O(void 0,[736],(function(){return o(60630)})),o.O(void 0,[736],(function(){return o(72168)})),o.O(void 0,[736],(function(){return o(47806)})),o.O(void 0,[736],(function(){return o(77031)})),o.O(void 0,[736],(function(){return o(97751)})),o.O(void 0,[736],(function(){return o(76093)})),o.O(void 0,[736],(function(){return o(19764)})),o.O(void 0,[736],(function(){return o(47549)})),o.O(void 0,[736],(function(){return o(22331)})),o.O(void 0,[736],(function(){return o(21513)})),o.O(void 0,[736],(function(){return o(98749)})),o.O(void 0,[736],(function(){return o(98251)})),o.O(void 0,[736],(function(){return o(6720)})),o.O(void 0,[736],(function(){return o(10846)})),o.O(void 0,[736],(function(){return o(18255)})),o.O(void 0,[736],(function(){return o(14113)})),o.O(void 0,[736],(function(){return o(24444)})),o.O(void 0,[736],(function(){return o(1764)})),o.O(void 0,[736],(function(){return o(68351)})),o.O(void 0,[736],(function(){return o(81521)})),o.O(void 0,[736],(function(){return o(19984)})),o.O(void 0,[736],(function(){return o(41229)})),o.O(void 0,[736],(function(){return o(43589)})),o.O(void 0,[736],(function(){return o(24108)})),o.O(void 0,[736],(function(){return o(33934)})),o.O(void 0,[736],(function(){return o(85577)})),o.O(void 0,[736],(function(){return o(83526)})),o.O(void 0,[736],(function(){return o(43060)})),o.O(void 0,[736],(function(){return o(92292)})),o.O(void 0,[736],(function(){return o(33409)}));var n=o.O(void 0,[736],(function(){return o(31341)}));n=o.O(n)}();
//# sourceMappingURL=misago.js.map