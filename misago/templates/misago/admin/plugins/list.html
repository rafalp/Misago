{% extends "misago/admin/layout.html" %}
{% load i18n %}


{% block title %}{% trans "Plugins" context "admin plugins" %} | {{ block.super }}{% endblock %}


{% block content %}
<div class="page-header">
  <h1>
    <a href="{{ active_section.link }}">
      {{ active_section.name }}
    </a>
  </h1>
</div>

<div class="card card-admin-table mb-3">
  <table class="table">
    <tr>
      <th style="width: 1px;">&nbsp;</th>
      <th>{% trans "Plugin" context "admin plugins" %}</th>
      <th style="width: 1px;">&nbsp;</th>
    </tr>
    {% for item in plugins %}
      <tr>
        <td class="pr-0 align-top">
          <div {% if item.color %}style="color: {{ item.color }};"{% else %}class="text-muted"{% endif %}>
            <span class="{{ item.icon|default:'fa fa-cube' }}"></span>
          </div>
        </td>
        <td>
          <div class="item-name">
            {{ item.name|default:item.package }}
          </div>
          {% if item.description %}
            <div>
              {{ item.description }}
            </div>
          {% endif %}
          {% if item.manifest_error %}
            <div class="text-danger">
              <em>
                {% blocktrans trimmed with error=item.manifest_error context "admin plugins" %}
                  Invalid manifest: {{ error }}
                {% endblocktrans %}
              </em>
            </div>
          {% elif not item.has_manifest %}
            <div class="text-muted">
              <em>
                {% trans "This plugin does not export any manifest from its misago_plugin.py file." context "admin plugins" %}
              </em>
            </div>
          {% endif %}
          <div class="small">
            <span class="text-muted pr-3">
              {% blocktrans trimmed with dirname=item.dirname context "admin plugins meta" %}
                Directory: {{ dirname }}
              {% endblocktrans %}
            </span>
            <span class="text-muted pr-3">
              {% blocktrans trimmed with package=item.package context "admin plugins meta" %}
                Package: {{ package }}
              {% endblocktrans %}
            </span>
            {% if item.author %}
              <span class="text-muted pr-3">
                {% blocktrans trimmed with author=item.author context "admin plugins meta" %}
                  Author: {{ author }}
                {% endblocktrans %}
              </span>
            {% endif %}
            {% if item.version %}
              <span class="text-muted pr-3">
                {% blocktrans trimmed with version=item.version context "admin plugins meta" %}
                  Version: {{ version }}
                {% endblocktrans %}
              </span>
            {% endif %}
            {% if item.license %}
              <span class="text-muted">
                {% blocktrans trimmed with license=item.license context "admin plugins meta" %}
                  License: {{ license }}
                {% endblocktrans %}
              </span>
            {% endif %}
          </div>
        </td>
        <td>
          {% if item.has_urls %}
            <div class="dropdown">
              <button class="btn btn-light btn-sm dropdown-toggle" type="button" id="item-optioms-{{ item.package }}" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                {% trans "Links" context "admin plugins links" %}
              </button>
              <div class="dropdown-menu dropdown-menu-right" aria-labelledby="item-optioms-{{ item.package }}">
                {% if item.homepage %}
                  <a class="dropdown-item" href="{{ item.homepage.url }}" target="_blank">
                    <small class="text-muted">
                      {% trans "Homepage:" context "admin plugins url" %}
                    </small>
                    <br />
                    {{ item.homepage.netloc }}
                  </a>
                {% endif %}
                {% if item.sponsor %}
                  <a class="dropdown-item" href="{{ item.sponsor.url }}" target="_blank">
                    <small class="text-muted">
                      {% trans "Sponsor:" context "admin plugins url" %}
                    </small>
                    <br />
                    {{ item.sponsor.netloc }}
                  </a>
                {% endif %}
                {% if item.help %}
                  <a class="dropdown-item" href="{{ item.help.url }}" target="_blank">
                    <small class="text-muted">
                      {% trans "Help:" context "admin plugins url" %}
                    </small>
                    <br />
                    {{ item.help.netloc }}
                  </a>
                {% endif %}
                {% if item.bugs %}
                  <a class="dropdown-item" href="{{ item.bugs.url }}" target="_blank">
                    <small class="text-muted">
                      {% trans "Bug reports:" context "admin plugins url" %}
                    </small>
                    <br />
                    {{ item.bugs.netloc }}
                  </a>
                {% endif %}
                {% if item.repo %}
                  <a class="dropdown-item" href="{{ item.repo.url }}" target="_blank">
                    <small class="text-muted">
                      {% trans "Repository:" context "admin plugins url" %}
                    </small>
                    <br />
                    {{ item.repo.netloc }}
                  </a>
                {% endif %}
              </div>
            </div>
          {% endif %}
        </td>
      </tr>
    {% empty %}
      <tr class="blankslate">
        <td colspan="3">{% trans "No plugins are installed on this site." context "admin plugins" %}</td>
      </tr>
    {% endfor %}
  </table>
</div><!-- /.card-admin-table -->
{% endblock content %}
