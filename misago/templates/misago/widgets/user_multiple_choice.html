{% load i18n misago_avatars misago_forms %}
{% with widget=widget.default choices=widget.choices %}
  <ul class="form-chips-control d-js-flex" style="align-items: center;" m-user-multiple-choice>
    {% for choice in choices %}
      <li m-user-multiple-choice-item m-user-id="{{ choice.id }}">
        <input type="hidden" name="{{ widget.name }}" value="{{ choice.slug }}">
        <button class="form-chips-control-item" type="button" aria-label="{% trans 'Remove user from field' context 'user multiple choice delete button' %}">
          <img class="form-chips-control-item-image" src="{{ choice|avatar:32 }}" alt="">
          {{ choice.username }}
          <span class="material-icon">clear</span>
        </button>
      </li>
    {% endfor %}
    <li>
      <input type="text" class="form-chips-control-input" id="{{ widget.attrs.id }}" m-user-multiple-choice-input>
    </li>
  </ul>
  <template id="m-user-multiple-choice-template">
    <li m-user-multiple-choice-item>
      <input type="hidden" name="{{ widget.name }}" value="">
      <button class="form-chips-control-item" type="button" aria-label="{% trans 'Remove user from field' context 'user multiple choice delete button' %}">
        <img class="form-chips-control-item-image" src="" alt="">
        <slot name="username"></slot>
        <span class="material-icon">clear</span>
      </button>
    </li>
  </template>
{% endwith %}
{% with widget=widget.noscript %}
  <noscript>
    <input type="text" class="form-control" id="{{ widget.attrs.id }}" name="{{ widget.name }}" value="{{ widget.value|default:'' }}" {{ widget|requiredhtml }}>
  </noscript>
{% endwith %}